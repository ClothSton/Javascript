function _classPrivateFieldInitSpec(obj, privateMap, value) {_checkPrivateRedeclaration(obj, privateMap);privateMap.set(obj, value);}function _checkPrivateRedeclaration(obj, privateCollection) {if (privateCollection.has(obj)) {throw new TypeError("Cannot initialize the same private elements twice on an object");}}function _classPrivateFieldGet(receiver, privateMap) {var descriptor = _classExtractFieldDescriptor(receiver, privateMap, "get");return _classApplyDescriptorGet(receiver, descriptor);}function _classApplyDescriptorGet(receiver, descriptor) {if (descriptor.get) {return descriptor.get.call(receiver);}return descriptor.value;}function _classPrivateFieldSet(receiver, privateMap, value) {var descriptor = _classExtractFieldDescriptor(receiver, privateMap, "set");_classApplyDescriptorSet(receiver, descriptor, value);return value;}function _classExtractFieldDescriptor(receiver, privateMap, action) {if (!privateMap.has(receiver)) {throw new TypeError("attempted to " + action + " private field on non-instance");}return privateMap.get(receiver);}function _classApplyDescriptorSet(receiver, descriptor, value) {if (descriptor.set) {descriptor.set.call(receiver, value);} else {if (!descriptor.writable) {throw new TypeError("attempted to set read only private field");}descriptor.value = value;}}function _slicedToArray(arr, i) {return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();}function _nonIterableRest() {throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _iterableToArrayLimit(arr, i) {var _i = null == arr ? null : "undefined" != typeof Symbol && arr[Symbol.iterator] || arr["@@iterator"];if (null != _i) {var _s,_e,_x,_r,_arr = [],_n = !0,_d = !1;try {if (_x = (_i = _i.call(arr)).next, 0 === i) {if (Object(_i) !== _i) return;_n = !1;} else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0);} catch (err) {_d = !0, _e = err;} finally {try {if (!_n && null != _i["return"] && (_r = _i["return"](), Object(_r) !== _r)) return;} finally {if (_d) throw _e;}}return _arr;}}function _arrayWithHoles(arr) {if (Array.isArray(arr)) return arr;}function _toConsumableArray(arr) {return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();}function _nonIterableSpread() {throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _unsupportedIterableToArray(o, minLen) {if (!o) return;if (typeof o === "string") return _arrayLikeToArray(o, minLen);var n = Object.prototype.toString.call(o).slice(8, -1);if (n === "Object" && o.constructor) n = o.constructor.name;if (n === "Map" || n === "Set") return Array.from(o);if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);}function _iterableToArray(iter) {if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter);}function _arrayWithoutHoles(arr) {if (Array.isArray(arr)) return _arrayLikeToArray(arr);}function _arrayLikeToArray(arr, len) {if (len == null || len > arr.length) len = arr.length;for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];return arr2;}function ownKeys(object, enumerableOnly) {var keys = Object.keys(object);if (Object.getOwnPropertySymbols) {var symbols = Object.getOwnPropertySymbols(object);enumerableOnly && (symbols = symbols.filter(function (sym) {return Object.getOwnPropertyDescriptor(object, sym).enumerable;})), keys.push.apply(keys, symbols);}return keys;}function _objectSpread(target) {for (var i = 1; i < arguments.length; i++) {var source = null != arguments[i] ? arguments[i] : {};i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {_defineProperty(target, key, source[key]);}) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));});}return target;}function _defineProperty(obj, key, value) {key = _toPropertyKey(key);if (key in obj) {Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true });} else {obj[key] = value;}return obj;}function _get() {if (typeof Reflect !== "undefined" && Reflect.get) {_get = Reflect.get.bind();} else {_get = function _get(target, property, receiver) {var base = _superPropBase(target, property);if (!base) return;var desc = Object.getOwnPropertyDescriptor(base, property);if (desc.get) {return desc.get.call(arguments.length < 3 ? target : receiver);}return desc.value;};}return _get.apply(this, arguments);}function _superPropBase(object, property) {while (!Object.prototype.hasOwnProperty.call(object, property)) {object = _getPrototypeOf(object);if (object === null) break;}return object;}function _inherits(subClass, superClass) {if (typeof superClass !== "function" && superClass !== null) {throw new TypeError("Super expression must either be null or a function");}subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } });Object.defineProperty(subClass, "prototype", { writable: false });if (superClass) _setPrototypeOf(subClass, superClass);}function _setPrototypeOf(o, p) {_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {o.__proto__ = p;return o;};return _setPrototypeOf(o, p);}function _createSuper(Derived) {var hasNativeReflectConstruct = _isNativeReflectConstruct();return function _createSuperInternal() {var Super = _getPrototypeOf(Derived),result;if (hasNativeReflectConstruct) {var NewTarget = _getPrototypeOf(this).constructor;result = Reflect.construct(Super, arguments, NewTarget);} else {result = Super.apply(this, arguments);}return _possibleConstructorReturn(this, result);};}function _possibleConstructorReturn(self, call) {if (call && (_typeof(call) === "object" || typeof call === "function")) {return call;} else if (call !== void 0) {throw new TypeError("Derived constructors may only return object or undefined");}return _assertThisInitialized(self);}function _assertThisInitialized(self) {if (self === void 0) {throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}function _isNativeReflectConstruct() {if (typeof Reflect === "undefined" || !Reflect.construct) return false;if (Reflect.construct.sham) return false;if (typeof Proxy === "function") return true;try {Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));return true;} catch (e) {return false;}}function _getPrototypeOf(o) {_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {return o.__proto__ || Object.getPrototypeOf(o);};return _getPrototypeOf(o);}function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}}function _defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor);}}function _createClass(Constructor, protoProps, staticProps) {if (protoProps) _defineProperties(Constructor.prototype, protoProps);if (staticProps) _defineProperties(Constructor, staticProps);Object.defineProperty(Constructor, "prototype", { writable: false });return Constructor;}function _toPropertyKey(arg) {var key = _toPrimitive(arg, "string");return _typeof(key) === "symbol" ? key : String(key);}function _toPrimitive(input, hint) {if (_typeof(input) !== "object" || input === null) return input;var prim = input[Symbol.toPrimitive];if (prim !== undefined) {var res = prim.call(input, hint || "default");if (_typeof(res) !== "object") return res;throw new TypeError("@@toPrimitive must return a primitive value.");}return (hint === "string" ? String : Number)(input);}function _typeof(obj) {"@babel/helpers - typeof";return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) {return typeof obj;} : function (obj) {return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;}, _typeof(obj);}
/*!
 *  Douzone Enterprise Web Standard (front-end framework) v2.0.230324
 *  Copyright(C) 2014-2017 Douzone BizOn Co., Ltd. All right reserved.
 */
/*
 * UI 컨트롤 공통
 */
(function ($, dews, kendo) {
  if (!kendo) {
    throw "Kendo UI 라이브러리가 필요합니다.";
  }

  var initializers = [],
    readies = [],
    _sample = [],
    _config = [];

  $.extend(true, dews, {
    ready: function ready(func) {
      if ($.type(func) === "function") {
        readies.push(func);
      }
    },
    ui: {
      /**
       * 컨트롤  이니셜라이저를 등록 합니다
       * @param {string} name 컨트롤 이름
       * @param {function} init 초기화 함수
       */
      addControlInitializer: function addControlInitializer(name, init) {
        initializers.push(function (container) {
          return $.Deferred(function (deferred) {
            init(container);

            deferred.resolve(name);
          }).
          done(function (name) {

            //dews.log('## DEWS Controls: ' + name + ' - 초기화 - 완료 ##');
          }).promise();
        });
      },

      /**
       * 비동기 컨트롤 이니셜라이저를 등록 합니다
       * @param {string} name 컨트롤 이름
       * @param {function} init 초기화 함수
       */
      addAsyncControlInitializer: function addAsyncControlInitializer(name, init) {
        initializers.push(init);
      },

      getDialogMaxZIndex: function getDialogMaxZIndex() {
        var zIndex = 0;
        $(
        "body > div:visible.k-popup, body > div:visible.postcode-wrapper, body > div:visible.dews-periodpicker-calendars, " +
        "body > div:visible.dews-monthperiodpicker-calendars, body > div:visible.dews-weekperiodpicker-calendars, " +
        "body > div:visible.k-window").
        each(function (idx, item) {
          var $item = $(item);
          var position = $item.css("position");
          if (position === "absolute" || position === "fixed") {
            if (parseInt($item.css("zIndex"), 10) > zIndex) {
              zIndex = parseInt($item.css("zIndex"), 10);
            }
          }
        });

        return zIndex;
      }
    },
    widget: {
      config: function config(fun) {
        if ($.type(fun) === "function") {
          _config.push(fun);
        }
      },
      sample: function sample(fun) {
        if ($.type(fun) === "function") {
          _sample.push(fun);
        }
      }
    }
  });

  $.extend(true, dews, {
    /**
     * @namespace
     */
    date: {
      /**
       * 날짜 형식의 값에 포맷을 적용합니다.
       * @param {string|date} value 포맷을 적용할 값
       * @param {string} format 포맷 문자열 (D: 날짜(yyyy-MM-dd), Y: 연도(yyyy), M: 년월(yyyy-MM), DT: 날짜+시간(yyyy-MM-dd HH:mm:ss), 생략: D)
       * @returns {string} 포맷이 적용된 날짜 문자열
       */
      format: function format(value, _format) {
        var date;

        if (typeof _format === "undefined") {
          _format = "D";
        }

        if ($.type(value) === "string") {
          date = dews.date.parse(value, _format);

          if ($.type(date) === "null") {
            date = dews.date.parse(value, "yyyyMMdd");
          }
        } else if ($.type(value) === "date") {
          date = value;
        } else {
          return value || "";
        }

        _format = dews.getFormatFromAlias(_format);

        return kendo.toString(date, _format) || "";
      },
      /**
       * 문자열이 날짜 형식에 맞는지 여부를 확인합니다.
       * @param {string} value 검사할 문자열
       * @param {string} [format] 문자열을 검사할 포맷
       */
      validate: function validate(value, format) {
        var valid = false,
          formats = [],
          date;

        if (typeof format === "undefined") {
          format = "D";
        }

        if ($.type(value) === "date") {
          valid = true;
        } else if ($.type(value) === "string") {
          formats.push(dews.getFormatFromAlias(format, true));
          formats.push(dews.getFormatFromAlias(format, false));
        }

        $.each(formats, function (idx, f) {
          date = kendo.parseDate(value, f, dews.localize.getLanguage());

          if (date) {
            // 값으로 들어왔던 문자열과 변환된 문자열이 동일한지 비교한다.
            if (dews.date.format(date, f) === value) {
              valid = true;
              return false;
            }
          }
        });

        return valid;
      },
      /**
       * 문자열을 날자형식으로 변환합니다.
       * @param {string} value 날짜 문자열
       * @param {string} [format] 포맷 문자열 또는 알리아스 (생략시: D)
       */
      parse: function parse(value, format) {
        var valueFormat,
          textFormat,
          date = null;

        if (value) {
          if (typeof format === "undefined") {
            format = "D";
          }

          if (format === "D" || format === "Y" || format === "M" || format === "DT" || format === "T") {
            // 지정한 알리아스가 있을 경우
            valueFormat = dews.getFormatFromAlias(format, true);
            textFormat = dews.getFormatFromAlias(format, false);
          } else {
            valueFormat = format;
            textFormat = format;
          }

          if (format) {
            date = kendo.parseDate(value, valueFormat, dews.localize.getLanguage());

            if (date === null && valueFormat !== textFormat) {
              date = kendo.parseDate(value, textFormat, dews.localize.getLanguage());
            }
          }
        }

        return date;
      },

      /**
       * 날짜 형식의 데이터를 문자열 형식으로 변환합니다.
       * @param {string} value 날짜 형식의 데이터
       * @param {string} format 포맷 문자열 또는 알리아스 (생략시: D)
       */
      toString: function toString(value, format) {
        var valueFormat,
          textFormat,
          string = null;

        if (value) {
          if (typeof format === "undefined") {
            format = "D";
          }

          if (format === "D" || format === "Y" || format === "M" || format === "DT" || format === "T") {
            valueFormat = dews.getFormatFromAlias(format, true);
            textFormat = dews.getFormatFromAlias(format, false);
          } else {
            valueFormat = format;
            textFormat = format;
          }

          if (format) {
            string = kendo.toString(value, valueFormat, dews.localize.getLanguage());

            if (string === null && valueFormat !== textFormat) {
              string = kendo.toString(value, textFormat, dews.localize.getLanguage());
            }
          }
        }

        return string;
      }
    },
    /**
     * @namespace
     */
    ui: {
      /**
       * 날짜 형식의 문자열에 포맷을 적용합니다.
       * @param {string|date} value 날짜 형식의 값
       * @param {string} [format] 포맷문자열(옵션 - 생략시 D)
       */
      formatedDate: function formatedDate(value, format) {
        return dews.date.format(value, format);
      }
    },
    /**
     * 서버 환경 변수를 위한 네임스페이스
     * @namespace
     */
    server: {
      /**
       * 서버 환경 변수를 서버에서 로드합니다.
       */
      loadServerVariables: function loadServerVariables() {
        var url;

        if (dews._environments.useServerVariables) {
          url = dews._environments.serverVariableServiceURL || dews.server._defaultServerVariableServiceURL;

          dews.log("## 서버 환경 변수 로드 URL : " + url + " ##");

          dews.ajax.
          data(url, { async: false }).
          done(function (data) {
            dews.log("## 서버 환경 변수 로드 성공 ##");
            dews.log(JSON.stringify(data));
            // 서버 환경 변수 설정
            dews.server.setServerVariables(data);
          }).
          fail(function (jqXHR) {
            dews.log("## 서버 환경 변수 로드 실패: \n" + JSON.stringify(jqXHR));
          });
        }
      }
    },
    /**
     * 현재 프레임이 메인 프레임인지 여부를 반환합니다.
     * @returns {boolean} 메인 프레임인지 여부
     */
    isMainFrame: function isMainFrame() {
      return dews._environments.mainFrame || false;
    },
    /**
     * 현재 프레임을 메인 프레임으로 설정합니다.
     */
    setMainFrame: function setMainFrame() {
      dews._environments.mainFrame = true;
    },
    /**
     * 메인 프레임의 window 객체를 가져옵니다.
     * @param {object} currentWindow 현재 프레임의 window 객체
     * @returns {object} dews 메인 프레임의 window 객체
     */
    getMainFrameWindowObject: function getMainFrameWindowObject(currentWindow) {
      if (currentWindow.dews && currentWindow.dews.isMainFrame()) {
        return currentWindow;
      } else if (currentWindow !== window.top) {
        return dews.getMainFrameWindowObject(currentWindow.parent); // 메인 프레임이 아니고 부모 프레임이 존재하면 부모 프레임을 검사
      } else {
        return currentWindow; // 어떤 프레임도 메인 프레임이 아닐 경우 현재 프레임 객체를 메인 프레임으로 반환
      }
    },
    /**
     * 포탈에서 Dews 컴포넌트를 초기화합니다.
     * @param {jQuery} $target 타겟 jquery 객체
     */
    callInitUiControls: function callInitUiControls(target) {
      $(document).trigger("inituicontrols", [$(target)]);
    }
  });

  $(window).on("load", function () {
    // 서버 환경 변수 로드를 위한 함수 실행
    dews.server.loadServerVariables();

    // 컨트롤 초기화를 위한 이벤트를 발생시킵니다.
    $(document).trigger("inituicontrols");
    dews.log("## DEWS Controls: inituicontrols 이벤트 - 발생 ##");
  });

  $(window).on("langchange", function (e, lang) {
    var kendoUrl;

    // 표시 언어가 변경될 때
    kendo.culture(lang);

    kendoUrl = dews.url.join(dews._environments.scriptBase || "/scripts/", "kendo/");

    if (lang) {
      kendo.culture(lang);
      // $.getScript 로 수행할 경우 cache 를 활용하지 않으므로 직접 ajax 요청
      $.ajax({
        type: "GET",
        url: dews.url.getAbsoluteUrl(dews.url.join(kendoUrl, "cultures/kendo.culture." + lang + ".min.js")),
        cache: true,
        dataType: "script"
      }).done(function () {
        kendo.culture(lang);
      });
    }
  });

  $(document).ready(function () {
    dews.log("## document ready 실행 ##");
  });

  $(document).on("inituicontrols", function (e, target, dialog) {var preReady = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;
    var inits = [],
      containerName = "",
      context = null,
      callPreReadies = function callPreReadies(context) {
        // dews.preReadies 배열에 등록된 함수들을 모두 실행합니다.
        if (context && $.isArray(dews.preReadies) && dews.preReadies.length > 0) {
          $.each(dews.preReadies, function (idx, item) {
            try {
              if (preReady) {
                item.call(context);
              }
            } catch (e) {
              console.log(e);
            }
          });
        }
      };
    // 위젯 데이터 획득 관련 코드
    var callWidgetReadies = function callWidgetReadies(context) {
      // 샘플 데이터 호출하는 로직
      if (context && $.isArray(_sample)) {
        $.each(_sample, function (idx, value) {
          value.call(context);
        });
      }

      // 환경설정 호출하는 로직
      if (context && $.isArray(_config)) {
        $.each(_config, function (idx, value) {
          context.config.data = value.call(context);
        });

        // 환경설정에 설정된 값이 있을경우 나오는 로직
        if (context.config) {
          if (
          $.type(context.config.params) === "undefined" &&
          Object.keys(context.config.data).length !== 0)
          {
            var params = {};
            $.each(context.config.data.control, function (idx, value) {
              params[value.id] = $.type(value.defaultValue) !== "undefined" ? value.defaultValue : "";
            });
            context.config.params = params;
          }
        }
      }
    };

    if (target instanceof jQuery && target.length > 0) {
      containerName = (target.attr("id") || target.get(0).tagName) + " - ";
    } else if (typeof target === "string") {
      containerName = target + " - ";
    }

    dews.log("## DEWS Controls: inituicontrols 이벤트 - " + containerName + "시작 ##");

    for (var i = 0; i < initializers.length; i++) {
      inits.push(initializers[i](target));
    }

    // jQuery when을 이용해서 컨트롤들이 모두 초기화 된 후 ready를 실행할 수 있도록 한다.
    $.when.apply(null, inits).done(function () {
      if (dialog) {
        // 전달된 파라미터 매개변수가 있을 경우에는 다이얼로그
        context = dialog;

        // 컨텍스트의 인스턴스에 컨트롤 ID 이름과 동일한 속성을 제공한다.
        if (dews.ui.page && $.isFunction(dews.ui.page.makeDialogProperties)) {
          var $target = $(target);
          if ($target.length > 0) {
            dews.ui.page.makeDialogProperties(context, $("*[class^=dews-][id]", $target));
          }
        }

        // dews.preReadies 에 등록된 함수를 모두 실행한다.
        callPreReadies(context);
      } else if (
      $(target).closest(".dews-ui-dashboardviewer").length !== 0 ||
      $(target).closest(".dews-ui-dashboardmodeler").length !== 0 ||
      $(target).closest(".dews-dashboard-dialog").length !== 0)
      {
        // Page Tab이 있을 경우에는 dews.ready의 this를 Page Tab 인스턴스로 설정
        context = dews.ui[$(target).attr("ID")];

        // 컨텍스트의 인스턴스에 컨트롤 ID 이름과 동일한 속성을 제공한다.
        if (context && $.isFunction(context.makeProperties) && $(target) instanceof jQuery) {
          context.makeProperties($("*[class^=dews-][id]", $(target)));
        }

        // dews.preReadies 에 등록된 함수를 모두 실행한다.
        callPreReadies(context);
        // 위젯 데이터 관련 획득
        callWidgetReadies(context);
        _sample = [];
        _config = [];
      } else if (dews.ui.hasOwnProperty("page") && dews.ui.page) {var _$;
        // Page Tab이 있을 경우에는 dews.ready의 this를 Page Tab 인스턴스로 설정
        context = dews.ui.page;

        // 포탈에서 컨텍스트의 인스턴스에 컨트롤 ID 이름과 동일한 속성을 제공한다.
        if (context && (_$ = $(target)) !== null && _$ !== void 0 && _$.hasClass("portal-widget")) {
          makeProperties(context, $("*[class^=dews-][id]", $(target)));
        }

        // 컨텍스트의 인스턴스에 컨트롤 ID 이름과 동일한 속성을 제공한다.
        if (
        context &&
        $.isFunction(context.makeProperties) &&
        target instanceof jQuery &&
        target.hasClass("tab-page"))
        {
          context.makeProperties($("*[class^=dews-][id]", target));
        }

        // dews.preReadies 에 등록된 함수를 모두 실행한다.
        callPreReadies(context);
      }

      dews.log("## DEWS Controls: dews.ready - " + containerName + "실행 ##");
      for (var i = 0; i < readies.length; i++) {
        try {
          readies[i].call(context, target);
        } catch (e) {
          if (console.error) {
            console.error(e);
          }
          if (context) {
            context._error = true;
          }
          dews.log("## DEWS ERROR" + e);
        }
      }

      // grid, treeview, cardlist 포커서블 셋팅
      setDataControlFocus();

      readies = [];
    });

    dews.log("## DEWS Controls: inituicontrols 이벤트 - " + containerName + "종료 ##");
  });

  // kendo ui Calender 버그 수정
  (function () {
    var monthView, i;

    if ($.type(kendo.calendar.views) === "array") {
      for (i = 0; i < kendo.calendar.views.length; i++) {
        if (kendo.calendar.views[i].name === "month") {
          monthView = kendo.calendar.views[i];
          break;
        }
      }

      if (monthView) {
        monthView.title = function (date, min, max, culture) {
          return kendo.toString(date, dews._environments.formats.monthFormat, culture);
        };
      }
    }
  })();

  /*
   * 컨트롤 생성시 사용하는 유틸리티 함수
   */
  $.extend(true, dews.ui, {
    util: {
      /**
       * 컨트롤에 readonly, disabled 등의 속성과 클래스명을 매치시킨다.
       * @param {jQuery} $el 컨트롤의 jQuery 객체
       */
      ConvertClassAndProperty: function ConvertClassAndProperty($el) {
        if ($el.hasClass("readonly") && !$el.prop("readonly")) {
          $el.prop("readonly", true);
        } else if ($el.prop("readonly") && !$el.hasClass("readonly")) {
          $el.addClass("readonly");
        }

        if ($el.hasClass("disabled") && !$el.prop("disabled")) {
          $el.prop("disabled", true);
        } else if ($el.prop("disabled") && !$el.hasClass("disabled")) {
          $el.addClass("disabled");
        }
      }
    }
  });

  /*
   *  그리드, 카드리스트, 트리뷰 focus 관련 함수 설정
   */
  function setDataControlFocus() {
    var $content, dewsControl, dewsElement;

    if (dews.ui.dialogPage) {
      $content = dews.ui.dialogPage.$content;
    } else if (dews.ui.page) {
      $content = dews.ui.page.$content;
    } else {
      $content = $(document);
    }

    $content.find(".dews-data-control").each(function (idx, target) {
      var $item = $(target),
        dewsObj = $item.data("dews-control");

      if (idx === 0) {
        dewsControl = dewsObj;
        dewsElement = $item;
      }

      if (dewsObj.focused) {
        dewsControl = dewsObj;
        dewsElement = $item;
      }

      dewsObj.focused = false;

      if ($.type(dewsObj._grid) !== "undefined") {
        dewsObj._grid.setDisplayOptions({ focusVisible: false });
      }

      dewsObj.on("click", function () {
        removeDataControlFocus(this);
        dewsObj.focused = true;

        if ($.type(dewsObj._grid) !== "undefined") {
          dewsObj._grid.setDisplayOptions({ focusVisible: true });
        }
      });
    });

    if (dewsControl && dewsElement) {
      dewsControl.focused = true;

      if (!dewsElement.hasClass("dews-ui-treeview")) {
        dewsControl.setFocus();
      }
    }
  }

  function removeDataControlFocus(item) {
    var $content;

    if ($(item).closest(".dews-ui-dialog").length !== 0) {
      $content = $(item).closest(".dews-ui-dialog");
    } else if (dews.ui.page) {
      $content = dews.ui.page.$content;
    } else {
      $content = $(document);
    }

    $content.find(".dews-data-control").each(function (idx, target) {
      var $item = $(target),
        dewsObj = $item.data("dews-control");

      dewsObj.focused = false;

      if ($.type(dewsObj._grid) !== "undefined") {
        dewsObj._grid.setDisplayOptions({ focusVisible: false });
      }
    });
  }

  /*
   * 포탈에서 컨텍스트에 설정하기 위해 추가
   * Object.defineProperty 사용 시 인스턴스 재할당이 안돼서 재로드 시 문제가 돼서 사용 불가
   */
  function makeProperties(context, $controls) {
    if ($controls.length > 0) {
      $controls.each(function (idx, item) {
        var $item = $(item);

        // 클래스가 dews-ui- 로 시작하는 dews 컨트롤 루트 요소 일 경우
        if ($item.is("[class*=dews-ui-]")) {
          context[item.id] = context === null || context === void 0 ? void 0 : context.getDewsComponentInstance($item);
        }

        // jQuery 객체에 접근할 수 있는 속성을 추가
        context["$" + item.id] = $item;
      });
    }
  }

  // jQuery 확장
  /**
   * 내부 HTML 내의 공백 문자를 제거합니다.
   * @returns {jQuery}
   */
  $.fn.htmlClean = function () {
    this.contents().
    filter(function () {
      if (this.nodeType != 3) {
        $(this).htmlClean();
        return false;
      } else {
        this.textContent = $.trim(this.textContent);
        return !/\S/.test(this.nodeValue);
      }
    }).
    remove();
    return this;
  };
})(jQuery, window.dews, window.kendo);


/**
 * 일반 DOM 요소에 다국어 적용
 */
(function ($, dews) {
  // 인라인 옵션을 가져옵니다.
  function getInlineOptions($el, codeOptions) {
    var inlineOptions = {};

    // 태그에 포함된 옵션을 가져옵니다.
    if ($el.data("dews-localize-lang")) {
      inlineOptions.lang = $el.data("dews-localize-lang");
    }
    if ($el.data("dews-localize-key")) {
      inlineOptions.key = $el.data("dews-localize-key");
      inlineOptions.alternative = $el.text();
    }

    return inlineOptions;
  }

  // 다국어 처리를 수행합니다.
  function render(self) {
    if (!self.$element.hasClass("dews-ui-multilingual")) {
      self.$element.addClass("dews-ui-multilingual");
    }

    if (self.key && self.alternative) {
      var localized = dews.localize.get(self.alternative, self.key, self.lang);
      self.$element.text(localized);
    }

    if (!self.$element.hasClass("dews-control-activate")) {
      self.$element.addClass("dews-control-activate");
    }
  }

  var Multilingual = function Multilingual($element, opt) {
    var self = this;
    self.$element = $element;

    var options = opt ? opt : getInlineOptions(self.$element);

    self._lang = options.lang;
    self._key = options.key;
    self._alternative = options.alternative;

    Object.defineProperties(self, {
      options: {
        get: function get() {
          return options;
        }
      },
      lang: {
        get: function get() {
          return self._lang;
        },
        set: function set(val) {
          self._lang = val;
          render(self);
        }
      },
      key: {
        get: function get() {
          return self._key;
        },
        set: function set(val) {
          self._key = val;
          render(self);
        }
      },
      alternative: {
        get: function get() {
          return self._alternative;
        },
        set: function set(val) {
          self._alternative = val;
          render(self);
        }
      },
      text: {
        get: function get() {
          return self.$element.text();
        }
      }
    });

    render(self);
  };

  $.extend(true, dews, {
    /**
     * @namespace
     */
    ui: {
      /**
       * 지정한 요소를 다국어 지원 요소로 변경하거나 가져옵니다.
       * @param {string|jQuery} selector 다국어 지원요소로 만들 셀렉터 또는 jQuery 객체
       * @param {object} options 다국어 옵션
       */
      multilingual: function multilingual(selector, options) {
        var $el, label;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var $this = $(this),
            control;

          control = $this.data("dews-control");

          if (!control) {
            control = new Multilingual($this);
            $this.data("dews-control", control);
          }

          label = control;
        });

        return label;
      }
    }
  });

  dews.ui.addControlInitializer("multilingual", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.multilingual($(".dews-ui-multilingual", $container));
  });
})(jQuery, window.dews, window.kendo);


/*
컴포넌트에 공통 포맷 적용하는 함수
 */
(function ($, dews) {
  $.extend(true, dews, {
    mathType: { 1: "round", 2: "ceil", 3: "floor" },

    getPreDefinedFormat: function getPreDefinedFormat($el) {
      var formatAlias,
        page = dews.ui.page;

      if ($el instanceof jQuery) {
        if (typeof $el.data("dews-format-predefined") !== "undefined") {
          if ($el.data("dews-format-predefined") === true) {
            formatAlias = $el.data("dews-format") ? $el.data("dews-format") : $el.data("dews-mask");

            if ($el.is(".dews-ui-numerictextbox")) {
              // 숫자텍스트박스일 경우 object로 return
              return getNumericFormat(formatAlias);
            } else return getFormat(formatAlias);
          }
        } else if ($el.data("dews-predefined") !== "undefined") {
          // textBox(dews-mask), maskedTextBox(dews-secure-mask)
          if ($el.data("dews-predefined") === true) {
            formatAlias = $el.data("dews-secure-mask") ?
            $el.data("dews-secure-mask") :
            $el.data("dews-mask");

            return getFormat(formatAlias);
          }
        }
      } else {
        if ($.type($el.predefined) === "boolean") {
          if ($el.predefined) {
            formatAlias = $el.preFormat;
          }

          if ($el.type === "number") {
            return getNumericFormat(formatAlias);
          } else {
            return getFormat(formatAlias);
          }
        }
      }

      function getFormat(formatAlias) {
        if (page && page.env) {
          if (page.env.hasOwnProperty(formatAlias)) {
            for (var property in page.env) {
              var obj = page.env[property];

              if (obj && property === formatAlias) {
                if (obj.format) {
                  return obj.format;
                }
              }
            }
          } else {
            return false;
          }
        }
      }

      // 숫자텍스트박스일 경우 object로 return
      function getNumericFormat(formatAlias) {
        if (page && page.env) {
          if (page.env.hasOwnProperty(formatAlias)) {
            for (var property in page.env) {
              var obj = page.env[property];

              if (obj && property === formatAlias) {
                if (obj.format) {
                  var formatObj = {};
                  formatObj.format = obj.format;
                  if (obj.value) {
                    formatObj.decimals = parseInt(obj.value, 10);
                  }
                  formatObj.round = dews.mathType[obj.round];

                  return formatObj;
                }
              }
            }
          } else {
            return false;
          }
        }
      }
    },
    getSecureMaskFormat: function getSecureMaskFormat(formatAlias) {
      var page = dews.ui.page;

      if (page && page.env) {
        if (page.env.mask) {
          var obj = page.env.mask[formatAlias];

          if (obj) {
            return obj;
          }
        }
      }
    },
    getCurrencyFormat: function getCurrencyFormat($el) {
      var currency,
        formatData,
        page = dews.ui.page;

      if ($el instanceof jQuery) {
        if (
        typeof $el.data("dews-format-predefined") !== "undefined" &&
        $el.data("dews-format-predefined") === true)
        {
          if (typeof $el.data("dews-currency") !== "undefined") {
            formatData = $el.data("dews-format") ? $el.data("dews-format") : undefined;
            currency = $el.data("dews-currency").toUpperCase();

            return currencyFormat(formatData, currency);
          }
        }
      } else {
        // 그리드
        if ($.type($el.predefined) === "boolean") {
          // predefined가 true
          if ($el.predefined && typeof $el.currency !== "undefined") {
            // 환종별 포맷
            formatData = $el.preFormat; // 'MA0001'
            if ($.type($el.preCurrency) === "string") {
              currency = $el.preCurrency.toUpperCase(); // 'USD'
            }

            return currencyFormat(formatData, currency);
          }
        }
      }

      function currencyFormat(formatData, currency) {
        if (page && page.env) {
          if (page.env.hasOwnProperty(formatData)) {
            var formatObj = page.env[formatData];
            if (
            formatObj.hasOwnProperty("currency") &&
            formatObj.currency !== null &&
            formatObj.currency.hasOwnProperty(currency))
            {
              var currencyValue = formatObj.currency[currency];
              var currencyObj = {};
              if ($.type(currencyValue) === "object") {
                currencyObj.format = currencyValue.format;

                if (currencyValue.value) currencyObj.decimals = parseInt(currencyValue.value, 10);else
                currencyObj.decimals = parseInt(formatObj.value, 10);

                if (currencyValue.round) currencyObj.round = dews.mathType[currencyValue.round];else
                currencyObj.round = dews.mathType[formatObj.round];
              } else {
                currencyObj.format = currencyValue;
                currencyObj.decimals = parseInt(formatObj.value, 10);
                currencyObj.round = dews.mathType[formatObj.round];
              }
              return currencyObj;
            }
          } else {
            return false;
          }
        }
      }
    }
  });
})(jQuery, window.dews);


window.daum = window.daum || {},
function (a) {
  function b() {
    for (var a = 0, b = l.length; b > a; a++)
    document.write('<script charset="UTF-8" type="text/javascript" src="' + (i + l[a]) + '"></script>');
    h = 2;
  }

  function c() {
    for (var a = 0, b = l.length; b > a; a++) {
      var c = document.createElement("script");
      n[l[a]] = !1,
      c.type = "text/javascript",
      c.charset = "utf-8",
      c.src = i + l[a],
      c.onload = function () {
        var b = l[a];
        return function () {
          var a = b;
          n[a] || (n[a] = !0), e() && f();
        };
      }(),
      c.onreadystatechange = function () {
        var b = l[a];
        return function () {
          /loaded|complete/.test(this.readyState) && (n[b] || (n[b] = !0), e() && f());
        };
      }(),
      document.getElementsByTagName("head")[0].appendChild(c);
    }
  }

  function d(a) {
    var b = {};
    return (
      a.replace(/[?&]+([^=&]+)=([^&]*)/gi, function (a, c, d) {
        b[c] = d;
      }),
      b);

  }

  function e() {
    for (var a = 0, b = 0, c = l.length; c > b; b++) n[l[b]] && a++;
    return a === l.length ? !0 : !1;
  }

  function f() {
    for (h = 2; g[0];) g.shift()();
  }
  a.postcode = {};
  var g = [],
    h = 0,
    i = "https:" == location.protocol ? "https:" : "http:",
    j = document.getElementsByTagName("script"),
    k = j[j.length - 1].src;
  j = null;
  var l = ["//s1.daumcdn.net/svc/attach/U03/cssjs/postcode/1495012223804/170517.js"];
  if (/\/map_js_init\/postcode.v2(\.dev){0,1}(\.update){0,1}\.js\b/.test(k)) {
    var m = d(k);
    "false" !== m.autoload && (b(), h = 2);
  }
  var n = {};
  a.postcode.version = "170517",
  a.postcode.load = function (a) {
    if (a && "function" == typeof a)
    switch (g.push(a), h) {
      case 0:
        h = 1, c();
        break;
      case 2:
        f();}

  };
}(window.daum);

(function () {
  /*VERSION:170517*/
  "object" != (typeof JSON === "undefined" ? "undefined" : _typeof(JSON)) && (JSON = {}),
  function () {
    "use strict";

    function f(a) {
      return 10 > a ? "0" + a : a;
    }

    function this_value() {
      return this.valueOf();
    }

    function quote(a) {
      return (
        escapable.lastIndex = 0,
        escapable.test(a) ?
        '"' +
        a.replace(escapable, function (a) {
          var b = meta[a];
          return "string" == typeof b ?
          b :
          "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4);
        }) +
        '"' :
        '"' + a + '"');

    }

    function str(a, b) {
      var c,
        d,
        e,
        f,
        g,
        h = gap,
        i = b[a];
      switch (
      i && "object" == _typeof(i) && "function" == typeof i.toJSON && (i = i.toJSON(a)),
      "function" == typeof rep && (i = rep.call(b, a, i)), _typeof(
      i)) {

        case "string":
          return quote(i);
        case "number":
          return isFinite(i) ? String(i) : "null";
        case "boolean":
        case "null":
          return String(i);
        case "object":
          if (!i) return "null";
          if (gap += indent, g = [], "[object Array]" === Object.prototype.toString.apply(i)) {
            for (f = i.length, c = 0; f > c; c += 1) g[c] = str(c, i) || "null";
            return (
              e =
              0 === g.length ?
              "[]" :
              gap ?
              "[\n" + gap + g.join(",\n" + gap) + "\n" + h + "]" :
              "[" + g.join(",") + "]",
              gap = h,
              e);

          }
          if (rep && "object" == _typeof(rep))
          for (f = rep.length, c = 0; f > c; c += 1)
          "string" == typeof rep[c] && (
          d = rep[c], e = str(d, i), e && g.push(quote(d) + (gap ? ": " : ":") + e));else

          for (d in i)
          Object.prototype.hasOwnProperty.call(i, d) && (
          e = str(d, i), e && g.push(quote(d) + (gap ? ": " : ":") + e));
          return (
            e =
            0 === g.length ?
            "{}" :
            gap ?
            "{\n" + gap + g.join(",\n" + gap) + "\n" + h + "}" :
            "{" + g.join(",") + "}",
            gap = h,
            e);}


    }
    "function" != typeof Date.prototype.toJSON && (
    Date.prototype.toJSON = function () {
      return isFinite(this.valueOf()) ?
      this.getUTCFullYear() +
      "-" +
      f(this.getUTCMonth() + 1) +
      "-" +
      f(this.getUTCDate()) +
      "T" +
      f(this.getUTCHours()) +
      ":" +
      f(this.getUTCMinutes()) +
      ":" +
      f(this.getUTCSeconds()) +
      "Z" :
      null;
    },
    Boolean.prototype.toJSON = this_value,
    Number.prototype.toJSON = this_value,
    String.prototype.toJSON = this_value);
    var cx, escapable, gap, indent, meta, rep;
    "function" != typeof JSON.stringify && (
    escapable =
    /[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
    meta = {
      "\b": "\\b",
      "	": "\\t",
      "\n": "\\n",
      "\f": "\\f",
      "\r": "\\r",
      '"': '\\"',
      "\\": "\\\\"
    },
    JSON.stringify = function (a, b, c) {
      var d;
      if (gap = "", indent = "", "number" == typeof c) for (d = 0; c > d; d += 1) indent += " ";else
      "string" == typeof c && (indent = c);
      if (
      rep = b,
      b && "function" != typeof b && ("object" != _typeof(b) || "number" != typeof b.length))

      throw new Error("JSON.stringify");
      return str("", {
        "": a
      });
    }),
    "function" != typeof JSON.parse && (
    cx =
    /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
    JSON.parse = function (text, reviver) {
      function walk(a, b) {
        var c,
          d,
          e = a[b];
        if (e && "object" == _typeof(e))
        for (c in e)
        Object.prototype.hasOwnProperty.call(e, c) && (
        d = walk(e, c), void 0 !== d ? e[c] = d : delete e[c]);
        return reviver.call(a, b, e);
      }
      var j;
      if (
      text = String(text),
      cx.lastIndex = 0,
      cx.test(text) && (
      text = text.replace(cx, function (a) {
        return "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4);
      })),
      /^[\],:{}\s]*$/.test(
      text.
      replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@").
      replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").
      replace(/(?:^|:|,)(?:\s*\[)+/g, "")))


      return (
        j = eval("(" + text + ")"),
        "function" == typeof reviver ?
        walk(
        {
          "": j
        },
        "") :

        j);

      throw new SyntaxError("JSON.parse");
    });
  }();
  var postcodeUtils = {};
  postcodeUtils.param = function (a) {
    var b,
      c = {};
    if ("" === a[0]) return c;
    for (var d = 0, e = a.length; e > d; d++) {
      b = a[d];
      var f = b.indexOf("="),
        g = [];
      g[0] = b.slice(0, f), g[1] = b.slice(f + 1, b.length);
      try {
        c[g[0]] = decodeURIComponent(g[1].replace(/\+/g, " "));
      } catch (h) {
        c[g[0]] = g[1].replace(/\+/g, " ");
      }
    }
    return c;
  }(window.location.search.substr(1).split("&")),
  postcodeUtils.extend = function () {
    if (0 === arguments.length) return null;
    var a = Array.prototype.slice.call(arguments),
      b = a.shift(),
      c = a.slice(0);
    if (c.length >= 1)
    for (var d = 0, e = c.length; e > d; d++) {
      var f = c[d];
      for (var g in f) f.hasOwnProperty(g) && (b[g] = f[g]);
    }
    return b;
  },
  postcodeUtils.isArray = function (a) {
    var b = window.jQuery;
    if (a) {
      var c = Object.prototype.toString.call(a).toLowerCase();
      if (
      "[object array]" === c ||
      "[object nodelist]" === c ||
      "[object htmlcollection]" === c ||
      b && a instanceof b)

      return !0;
    }
    return !1;
  },
  postcodeUtils.trim = function (a) {
    var b = /\s*((\S+\s*)*)/,
      c = /((\s*\S+)*)\s*/;
    return a.replace(b, "$1").replace(c, "$1");
  },
  postcodeUtils.isUndefined = function (a) {
    return void 0 === a ? !0 : !1;
  },
  postcodeUtils.isNull = function (a) {
    return null === a ? !0 : !1;
  },
  postcodeUtils.isAvailable = function (a) {
    return postcodeUtils.isUndefined(a) || postcodeUtils.isNull(a) || "" === postcodeUtils.trim(a) ? !1 : !0;
  },
  postcodeUtils.event = {
    isTouch: "ontouchstart" in window ? !0 : !1,
    on: function on(a, b, c) {
      a && a.addEventListener ?
      a.addEventListener(b, c, !1) :
      a && a.attachEvent ?
      a.attachEvent("on" + b, c) :
      a && (a["on" + b] = c);
    },
    off: function off(a, b, c) {
      a && a.removeEventListener ?
      a.removeEventListener(b, c, !1) :
      a && a.detachEvent ?
      a.detachEvent("on" + b, c) :
      a && (a["on" + b] = null);
    },
    preventDefault: function preventDefault(a) {
      a.preventDefault ? a.preventDefault() : a.returnValue = !1;
    },
    stopPropagation: function stopPropagation(a) {
      a.stopPropagation ? a.stopPropagation() : a.cancelBubble = !0;
    },
    onTouch: function onTouch(a, b) {
      var c = b ? b.start : null,
        d = b ? b.move : null,
        e = b ? b.end : null,
        f = !1,
        g = !1,
        h = this,
        i = -1,
        j = -1,
        k = 10;
      a && (
      this.on(a, "touchstart", function (a) {
        h.stopPropagation(a);
        var b = a.changedTouches && a.changedTouches[0] || a.touches && a.touches[0] || null;
        i = b && b.pageX, j = b && b.pageY, f = !0, c && "function" == typeof c && c(a);
      }),
      this.on(a, "touchmove", function (a) {
        h.stopPropagation(a);
        var b = a.changedTouches && a.changedTouches[0] || a.touches && a.touches[0] || null,
          c = b && b.pageX,
          e = b && b.pageY,
          f = Math.abs(i - c),
          l = Math.abs(j - e);
        (f >= k || l >= k) && (g = !0, d && "function" == typeof d && d(a));
      }),
      this.on(a, "touchend", function (a) {
        h.stopPropagation(a),
        f && !g ? (f = !1, e && "function" == typeof e && e(a)) : (f = !1, g = !1);
      }));
    }
  },
  postcodeUtils.userAgent = function (a) {
    function b(a) {
      var b = {},
        d = /(dolfin)[ \/]([\w.]+)/.exec(a) ||
        /(chrome)[ \/]([\w.]+)/.exec(a) ||
        /(webkit)(?:.*version)?[ \/]([\w.]+)/.exec(a) ||
        /(opera)(?:.*version)?[ \/]([\w.]+)/.exec(a) ||
        /(msie) ([\w.]+)/.exec(a) ||
        a.indexOf("compatible") < 0 && /(mozilla)(?:.*? rv:([\w.]+))?.*firefox/.exec(a) ||
        /(rv):([\w.]+)/.exec(a) || ["", "unknown"];
      return (
        "webkit" === d[1] ?
        d = /(iphone|ipad|ipod)[\S\s]*os ([\w._\-]+) like/.exec(a) ||
        /(android)[ \/]([\w._\-]+);/.exec(a) || [d[0], "safari", d[2]] :
        "mozilla" === d[1] ?
        d[1] = "firefox" :
        /polaris|natebrowser|([010|011|016|017|018|019]{3}\d{3,4}\d{4}$)/.test(a) ?
        d[1] = "polaris" :
        "rv" === d[1] && (d[1] = "msie"),
        b[d[1]] = !0,
        b.name = d[1],
        b.version = c(d[2]),
        b);

    }

    function c(a) {
      var b = {},
        c = a ? a.split(/\.|-|_/) : ["0", "0", "0"];
      return (
        b.info = c.join("."), b.major = c[0] || "0", b.minor = c[1] || "0", b.patch = c[2] || "0", b);

    }

    function d(a) {
      var b = {},
        c =
        (/android/.test(a) ? "android" : !1) || (
        /like mac os x./.test(a) ? "ios" : !1) || (
        /(mac os)/.test(a) ? "mac" : !1) || (
        /polaris|natebrowser|([010|011|016|017|018|019]{3}\d{3,4}\d{4}$)/.test(a) ? "polaris" : !1) || (
        /(windows)/.test(a) ? "windows" : !1) || (
        /(linux)/.test(a) ? "linux" : !1) || (
        /webos/.test(a) ? "webos" : !1) || (
        /bada/.test(a) ? "bada" : !1) || (
        /(rim|blackberry)/.test(a) ? "blackberry" : !1) ||
        "unknown";
      return b[c] = !0, b.name = c, b;
    }
    var e = a.navigator.userAgent.toString().toLowerCase();
    return {
      ua_string: e,
      browser: b(e),
      os: d(e)
    };
  }(window),
  postcodeUtils.hasErrorInDefaultBrowser = function (a) {
    for (var b = ["lg-f5", "lg-f4", "lg-f3", "d6503"], c = !1, d = 0, e = b.length; e > d; d++)
    if (a.indexOf(b[d]) > -1) {
      c = !0;
      break;
    }
    return c;
  },
  postcodeUtils.isAndroidWebview = function (a) {
    for (var b = ["version/"], c = !1, d = 0, e = b.length; e > d; d++)
    if (a.indexOf(b[d]) > -1) {
      c = !0;
      break;
    }
    return c;
  },
  postcodeUtils.isAndroidNaverWebview = function (a) {
    for (var b = ["naver(inapp;"], c = !1, d = 0, e = b.length; e > d; d++)
    if (a.indexOf(b[d]) > -1) {
      c = !0;
      break;
    }
    return c;
  },
  postcodeUtils.isIOSWebview = function (a) {
    for (var b = ["version/7", "version/8", "version/9", "version/10"], c = 0, d = 0, e = b.length; e > d; d++)
    -1 === a.indexOf(b[d]) && c++;
    return c === b.length;
  },
  postcodeUtils.isDaumapps = function (a) {
    for (var b = ["daumapps"], c = 0, d = 0, e = b.length; e > d; d++) a.indexOf(b[d]) > -1 && c++;
    return c === b.length;
  },
  postcodeUtils.isMobileChrome = function (a) {
    for (var b = ["crios", "chrome"], c = 0, d = 0, e = b.length; e > d; d++) a.indexOf(b[d]) > -1 && c++;
    return c > 0;
  },
  postcodeUtils.encodeData = function (a) {
    var b = "";
    for (var c in a) a.hasOwnProperty(c) && (b += c + "=" + encodeURIComponent(a[c]) + "|");
    return b = b.slice(0, b.length - 1);
  },
  postcodeUtils.decodeData = function (a) {
    if (a && "string" == typeof a) {
      for (var b = {}, c = a.split("|"), d = 0; d < c.length; d++) {
        var e = c[d].split("=");
        b[e[0]] = decodeURIComponent(e[1]);
      }
      return b;
    }
    return null;
  },
  postcodeUtils.getStringByOptions = function (a, b, c) {
    var d = "";
    for (var e in a) a.hasOwnProperty(e) && (d += e + b + a[e], d += c);
    return d = d.slice(0, d.length - 1);
  },
  postcodeUtils.returnEmptyString = function (a) {
    return void 0 === a || null === a ? "" : a;
  },
  postcodeUtils.isHex = function (a) {
    var b = !1;
    if (a) {
      var c = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
      a = a.replace(c, function (a, b, c, d) {
        return b + b + c + c + d + d;
      }),
      b = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.test(a);
    }
    return b;
  },
  postcodeUtils.themeStringify = function (a) {
    var b = "-",
      c = ".",
      d = "_",
      e = "";
    try {
      if (a) {
        for (var f in a)
        if (a.hasOwnProperty(f)) {
          e += f;
          var g = a[f];
          for (var h in g)
          if (g.hasOwnProperty(h)) {
            var i = g[h],
              j = h + d + i.substr(1);
            e += c + j;
          }
          e += b;
        }
        return e = e.substr(0, e.length - 1), encodeURIComponent(e);
      }
    } catch (k) {
      return "";
    }
    return "";
  },
  postcodeUtils.themeParse = function (a) {
    var b = "-",
      c = ".",
      d = "_",
      e = {};
    try {
      if (a) {
        a = decodeURIComponent(a);
        for (var f = a.split(b), g = 0, h = f.length; h > g; g++) {
          var i = f[g].split(c),
            j = i[0];
          i = i.slice(1), e[j] = {};
          for (var k = 0, l = i.length; l > k; k++) {
            var m = i[k].split(d);
            e[j][m[0]] = "#" + m[1];
          }
        }
        return e;
      }
    } catch (n) {
      return null;
    }
    return null;
  };
  var v2 = v2 || {};
  !function (a, b, c, d, e) {
    var f = b,
      g = f.userAgent;
    a.CONT = {
      MIN_WIDTH: 300,
      MIN_HEIGHT: 400,
      DEFAULT_WIDTH: 500,
      DEFAULT_HEIGHT: 500,
      ID_PREFIX: "__daum__",
      EMPTY_FUNCTION: function EMPTY_FUNCTION() {},
      PROTOCOL: "https:" == e.protocol ? "https:" : "http:",
      FRAME_POPUP: "popup",
      FRAME_LAYER: "layer",
      POPUP_CLOSE_STATE: {
        COMPLETE: "COMPLETE_CLOSE",
        FORCE: "FORCE_CLOSE"
      }
    },
    a.MODEL = {
      VIEWER_COUNT: 0,
      ID_MAP: {},
      TARGET_MAP: {},
      POPUP_MAP: {}
    },
    a.viewUtils = function () {
      function b(a, b, d, e, f, h) {
        "msie" !== g.browser.name || 7 !== parseInt(g.browser.version.major, 10) || c.postMessage ?
        "msie" !== g.browser.name ||
        6 !== parseInt(g.browser.version.major, 10) ||
        c.postMessage || (
        h += 60,
        a.document.getElementById(e).style.height = h - 4 + "px",
        a.document.getElementById(e).style.width = b.offsetWidth - 4 + "px",
        b.style.height = h + "px",
        d.style.height = h + "px") : (
        a.document.getElementById(e).style.height = h - 4 + "px",
        a.document.getElementById(e).style.width = b.offsetWidth - 4 + "px",
        b.style.height = h + "px",
        d.style.height = h + "px");
      }

      function e(a, b, c) {
        var d = !1;
        if (a && !isNaN(a)) a = parseInt(a, 10) < c ? c : parseInt(a, 10);else
        if (a && "string" == typeof a) {
          if (/^\d+%$/.test(a)) d = !0;else
          if (/^\d+px$/.test(a)) {
            d = !1;
            var e = parseInt(
            a.replace(/^(\d+)px$/, function (a, b, c) {
              return b;
            }),
            10);

            a = c > e ? c : e;
          } else a = b;} else
        a = b;
        return {
          value: a,
          isFlexible: d
        };
      }

      function h(a) {
        if (a) {
          var b = {
            margin: 0,
            padding: 0,
            height: "100%",
            width: "100%"
          };
          f.event.isTouch ? b["-webkit-overflow-scrolling"] = "touch" : b.overflow = "hidden",
          a.style.cssText = f.getStringByOptions(b, ":", ";");
        }
      }

      function i(a) {
        if (a) {
          var b = {
            margin: 0,
            padding: 0,
            height: "100%"
          };
          f.event.isTouch ? b["-webkit-overflow-scrolling"] = "touch" : b.overflow = "hidden",
          a.style.cssText = f.getStringByOptions(b, ":", ";"),
          a.setAttribute && a.setAttribute("lang", "ko");
        }
      }

      function j(a, b) {
        if (b) {
          var c = null;
          for (var e in q.TARGET_MAP)
          if (a === q.TARGET_MAP[e]) {
            c = e;
            break;
          }
          c && k(a, d.getElementById(c)),
          a ? (
          a.appendChild(b), q.TARGET_MAP[b.id] = a) : (
          d.body.appendChild(b), q.TARGET_MAP[b.id] = d.body);
        }
      }

      function k(a, b) {
        b && (
        a ?
        q.TARGET_MAP[b.id] === a && (a.removeChild(b), q.TARGET_MAP[b.id] = null) : (
        d.body.removeChild(b), q.TARGET_MAP[b.id] = null));
      }

      function l(a, b, c) {
        var d = "",
          e = 2e3,
          f = a + c;
        return f.length > e ? (f = a + b, d = f.length > e ? a : f) : d = f, d;
      }

      function m(a, b) {
        n(a, b) || (
        q.POPUP_MAP[a] || (q.POPUP_MAP[a] = []),
        q.POPUP_MAP[a].push({
          ref: b,
          data: {
            closeCallbackTimer: -1
          }
        }));
      }

      function n(a, b) {
        if (q.POPUP_MAP[a])
        for (var c = q.POPUP_MAP[a], d = 0, e = c.length; e > d; d++) if (b === c[d].ref) return !0;
        return !1;
      }

      function o(a) {
        for (var b in q.POPUP_MAP)
        if (q.POPUP_MAP.hasOwnProperty(b))
        for (var c = q.POPUP_MAP[b], d = 0, e = c.length; e > d; d++)
        if (a === c[d].ref) return c[d];
        return null;
      }

      function p(a) {
        var b =
        "msie" === f.userAgent.browser.name &&
        7 === parseInt(f.userAgent.browser.version.major, 10) ||
        "msie" === f.userAgent.browser.name && 10 === parseInt(f.userAgent.browser.version.major, 10);
        if (b)
        try {
          var c = d.createElement("input");
          c.style.cssText = "width:1px;height:1px;opacity:0;",
          a.document.body.appendChild(c),
          c.focus();
        } catch (e) {}
      }
      var q = a.MODEL;
      return {
        append: j,
        remove: k,
        setPopupMap: m,
        getPopupMap: o,
        setFrameStyle: function setFrameStyle(a, b) {
          i(a), h(b);
        },
        adjustLowIE: b,
        getNormalizeSize: e,
        getValidationUrl: l,
        IE11CompatibleBugFix: p
      };
    }(),
    a.common = function () {
      function b(a) {
        var b = {},
          c = "done" === a.action ? !0 : !1;
        for (var d in a)
        a.hasOwnProperty(d) &&
        "action" !== d && (
        c ? b[d] = a[d] : b[d] = isNaN(a[d]) ? a[d] : parseInt(a[d], 10));
        return b;
      }

      function d(a, b) {
        var c = a + "_" + b,
          d = h.ID_PREFIX + a + "_" + b;
        return i.ID_MAP[c] = d, d;
      }

      function e(a, b) {
        var c = a + "_" + b;
        return i.ID_MAP[c];
      }

      function g(a, d, e) {
        !c.postMessage || "function" != typeof c.postMessage && "object" != _typeof(c.postMessage) ? (
        a.name = "",
        clearInterval(e.timer),
        e.timer = setInterval(function () {
          try {
            if ("" !== a.name) {
              var c = a.name,
                g = f.decodeData(c),
                i = g.action,
                j = b(g);
              d(i, j),
              a.name = "",
              "done" === i &&
              e.autoClose &&
              e.onComplete !== h.EMPTY_FUNCTION && (
              clearInterval(e.timer), e.timer = null);
            }
          } catch (k) {
            clearInterval(e.timer);
          }
        }, 200)) : (
        a.customMessageHandler && f.event.off(a, "message", a.customMessageHandler),
        a.customMessageHandler = function (c) {
          var g = c.data,
            i = f.decodeData(g),
            j = i.action,
            k = b(i);
          d(j, k),
          "done" === j &&
          e.autoClose &&
          e.onComplete !== h.EMPTY_FUNCTION &&
          f.event.off(a, "message", a.customMessageHandler);
        },
        f.event.on(a, "message", a.customMessageHandler));
      }
      var h = a.CONT,
        i = a.MODEL;
      return {
        setReady: g,
        setId: d,
        getId: e
      };
    }();
  }(v2, postcodeUtils, window, document, location);
  var v2 = v2 || {};
  !function (a, b, c, d, e) {
    var f = b,
      g = a.CONT,
      h = a.viewUtils,
      i = a.MODEL,
      j = a.common;
    a.frame = function () {
      function a(a) {
        var b = {
            border: "0 none",
            margin: "0",
            width: "100%",
            height: "100%",
            "min-width": "300px",
            overflow: "hidden",
            padding: "0"
          },
          c = {
            indaum: a.indaum ? "on" : "off",
            banner: a.banner ? "on" : "off",
            mode: a.isViewerMode ? "view" : "transmit",
            amj: a.amj ? "on" : "off",
            vt: a.viewType,
            am: a.autoMapping ? "on" : "off",
            ani: a.animation ? "on" : "off",
            sd: a.shorthand ? "on" : "off",
            plrg: 0 === a.pleaseReadGuide ? "" : a.pleaseReadGuide,
            plrgt: a.pleaseReadGuideTimer,
            hmb: a.hideMapBtn ? "on" : "off",
            heb: a.hideEngBtn ? "on" : "off",
            smh: a.showMoreHName ? "on" : "off",
            us: a.useSuggest ? "on" : "off",
            msi: a.maxSuggestItems,
            ahs: a.autoHiddenSuggest ? "on" : "off",
            whas: a.windowHeightAvailableForSuggest
          };
        a.userQuery && (c.userQuery = a.userQuery, c.cq = a.cq),
        a.region_name && (c.region_name = a.region_name, c.cq = a.cq, c.intsh = a.intsh),
        a.theme &&
        "" !== a.theme.themeStr && (
        c.theme = a.theme.themeStr,
        c.sit = a.theme.sit,
        c.sgit = a.theme.sgit,
        c.sbit = a.theme.sbit,
        c.pit = a.theme.pit,
        c.mit = a.theme.mit,
        c.lcit = a.theme.lcit),
        a.allAddr ? c.zn = "N" : c.zn = "Y";
        var d = q + "&" + f.getStringByOptions(c, "=", "&"),
          e =
          "&" +
          f.getStringByOptions(
          {
            fullpath: r
          },
          "=",
          "&"),

          g =
          "&" +
          f.getStringByOptions(
          {
            fullpath: r + s
          },
          "=",
          "&"),

          i =
          '<iframe frameborder="0" title="우편번호검색프레임" id="' +
          j.setId("viewerFrame", a.viewerNo) +
          '" src="' +
          h.getValidationUrl(d, e, g) +
          '" style="' +
          f.getStringByOptions(b, ":", ";") +
          '"></iframe>';
        return i;
      }

      function b(a) {
        var b = d.createElement("div"),
          c = null;
        return (
          c =
          f.userAgent.os.ios && f.isIOSWebview(f.userAgent.ua_string) ?
          {
            width: a.isFlexibleWidth ? a.width : a.width + "px",
            height: a.isFlexibleHeight ? a.height : a.height + "px",
            "background-color": "#fff",
            "z-index": "0",
            "overflow-x": "hidden",
            "overflow-y": "auto",
            "min-width": "300px",
            margin: "0",
            padding: "0"
          } :
          {
            position: "relative",
            width: a.isFlexibleWidth ? a.width : a.width + "px",
            height: a.isFlexibleHeight ? a.height : a.height + "px",
            "background-color": "#fff",
            "z-index": "0",
            "overflow-x": "hidden",
            "overflow-y": "auto",
            "min-width": "300px",
            margin: "0",
            padding: "0"
          },
          b.style.cssText = f.getStringByOptions(c, ":", ";"),
          b);

      }

      function e() {
        var a = d.createElement("iframe"),
          b = null;
        return (
          b =
          f.userAgent.os.ios && f.isIOSWebview(f.userAgent.ua_string) ?
          {
            width: "100%",
            height: "100%",
            border: "0 none",
            margin: "0",
            padding: "0",
            overflow: "hidden",
            "min-width": "300px"
          } :
          {
            position: "absolute",
            left: "0",
            top: "0",
            width: "100%",
            height: "100%",
            border: "0 none",
            margin: "0",
            padding: "0",
            overflow: "hidden",
            "min-width": "300px"
          },
          a.setAttribute("frameborder", "0"),
          a.style.cssText = f.getStringByOptions(b, ":", ";"),
          a);

      }

      function k(a, c) {
        if (null === q) return alert("POPUP URL을 셋팅해 주세요.");
        var d = b(a),
          g = e();
        return (
          d.id = j.setId("layer", a.viewerNo),
          g.src = "about:blank",
          d.appendChild(g),
          h.append(c, d),
          f.userAgent.os.android && f.isAndroidWebview(f.userAgent.ua_string) ?
          setTimeout(function () {
            l(g, d, a, c);
          }, 300) :
          l(g, d, a, c),
          d);

      }

      function l(b, c, d, e) {
        var f = b.contentWindow;
        f.document.write(a(d)),
        h.setFrameStyle(
        f.document.getElementsByTagName("html")[0],
        f.document.getElementsByTagName("body")[0]),

        j.setReady(
        f,
        function (a, i) {
          "resize" === a ?
          d.onResize !== g.EMPTY_FUNCTION && (
          d.onResize(i),
          h.adjustLowIE(f, b, c, j.getId("viewerFrame", d.viewerNo), i.width, i.height)) :
          "done" === a &&
          d.onComplete !== g.EMPTY_FUNCTION && (
          d.autoClose && (
          h.IE11CompatibleBugFix(f),
          h.remove(e, c),
          d.onClose !== g.EMPTY_FUNCTION && d.onClose(g.POPUP_CLOSE_STATE.COMPLETE)),
          d.onComplete(i));
        },
        d);

      }

      function m(a) {
        if (null === q) return alert("POPUP URL을 셋팅해 주세요.");
        var b = {
            toolbar: "no",
            scrollbars: "no",
            menubar: "no",
            titlebar: "no",
            resizable: "no",
            location: "no",
            status: "no",
            top: isNaN(a.top) ? 200 : a.top,
            left: isNaN(a.left) ? 500 : a.left,
            width: a.isFlexibleWidth ? g.DEFAULT_WIDTH : a.width,
            height: a.isFlexibleHeight ? g.DEFAULT_HEIGHT : a.height
          },
          d = a.popupName || "_blank",
          e = c.open("", d, f.getStringByOptions(b, "=", ","));
        j.setId("popup", a.viewerNo), h.setPopupMap(j.getId("popup", a.viewerNo), e);
        try {
          e.focus();
        } catch (i) {}
        if (a.popupName && o(e), f.userAgent.os.android && f.isAndroidWebview(f.userAgent.ua_string)) {
          var k = f.isAndroidNaverWebview(f.userAgent.ua_string) ? 500 : 300;
          setTimeout(function () {
            n(e, a), p(e, a);
          }, k);
        } else n(e, a), p(e, a);
        return e;
      }

      function n(b, c) {
        var d = b.window;
        d.document.write(a(c)),
        h.setFrameStyle(
        d.document.getElementsByTagName("html")[0],
        d.document.getElementsByTagName("body")[0]);

        try {
          var e = d.document.head || d.document.getElementsByTagName("head")[0];
          if (e) {
            var f = "Daum 우편번호 서비스",
              i = null,
              k = null,
              l = d.document.getElementsByTagName("title")[0];
            l ? (
            e.removeChild(l),
            i = d.document.createElement("title"),
            i.innerHTML = f,
            e.appendChild(i)) : (
            i = d.document.createElement("title"),
            i.innerHTML = f,
            k = d.document.createElement("meta"),
            k.name = "viewport",
            k.content =
            "user-scalable=no,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,width=device-width",
            e.appendChild(i),
            e.appendChild(k));
          }
        } catch (m) {}
        j.setReady(
        d,
        function (a, d) {
          if ("done" === a && c.onComplete !== g.EMPTY_FUNCTION && (c.onComplete(d), c.autoClose))
          if (c.onClose !== g.EMPTY_FUNCTION) {
            var e = h.getPopupMap(b);
            e && clearInterval(e.data.closeCallbackTimer),
            b.close(),
            c.onClose(g.POPUP_CLOSE_STATE.COMPLETE);
          } else b.close();
        },
        c);

      }

      function o(a) {
        var b = a.window,
          c = b.document,
          d = c.body || c.documentElement || null;
        if (d)
        for (var e = c.getElementsByTagName("iframe"), f = 0, g = e.length; g > f; f++) {
          var h = e[f].id || null;
          if (h && "string" == typeof h) {
            var i = c.getElementById(h);
            i && d.removeChild(i);
          }
        }
      }

      function p(a, b) {
        if (b.onClose !== g.EMPTY_FUNCTION) {
          var c = h.getPopupMap(a);
          c && (
          clearInterval(c.data.closeCallbackTimer),
          c.data.closeCallbackTimer = setInterval(function () {
            var d = a.closed === !0 ? !0 : !1;
            d || void 0 !== a.closed || (d = void 0 === a.window || null === a.window ? !0 : !1),
            d && (clearInterval(c.data.closeCallbackTimer), b.onClose(g.POPUP_CLOSE_STATE.FORCE));
          }, 250));
        }
      }
      var q = null,
        r = null,
        s = null;
      return {
        init: function init(a, b, c) {
          q = a, r = b || "", s = c || "";
        },
        popup: {
          create: function create(a) {
            m(a);
          }
        },
        layer: {
          create: function create(a, b) {
            var c = null;
            b && "string" == typeof b ?
            c = d.getElementById(b) :
            b && "object" == _typeof(b) && b.appendChild && (c = b);
            var e = a.viewerNo - 1;
            if (e >= 1) {
              var f = d.getElementById(j.getId("layer", e));
              f && h.remove(c, f);
            }
            var g = j.getId("layer", a.viewerNo);
            (!g || g && !i.TARGET_MAP[g]) && k(a, c);
          }
        }
      };
    }();
  }(v2, postcodeUtils, window, document, location);
  var v2 = v2 || {};
  !function (a, b, c, d, e) {
    var f = b,
      g = "msie" === f.userAgent.browser.name && parseInt(f.userAgent.browser.version.major, 10) <= 6;
    a.themePreprocessor = function () {
      function a(a) {
        for (var b = !1, c = u, d = 0, e = c.length; e > d; d++) {
          var g = c[d],
            h = g.key,
            i = g.match,
            j = a[h];
          if (j && f.isHex(j))
          for (var k = 0, l = i.length; l > k; k++) {
            var m = i[k].split("."),
              n = m[0],
              o = m[1];
            t[n] || (t[n] = {}), t[n][o] = j, b = !0;
          }
        }
        return {
          isValid: b
        };
      }

      function b(a) {
        for (var b = v, d = !1, e = 0, g = b.length; g > e; e++)
        for (var h = b[e], i = h.keys, j = h.match, k = h.modifier, l = 0, m = j.length; m > l; l++) {
          var n = j[l],
            o = n[0].split("."),
            p = o[0],
            q = o[1],
            r = n[1],
            s = c(i, a);
          if (s && f.isHex(s)) {
            var u = k(s, r);
            t[p] || (t[p] = {}), t[p][q] = u;
          }
          d = !0;
        }
        return {
          isValid: d
        };
      }

      function c(a, b) {
        for (var c = "", d = 0, e = a.length; e > d && !(c = b[a[d]]); d++);
        return c;
      }

      function d(a, b) {
        var c = n(a),
          d = n(b),
          e = 0.2,
          f = o(c.r, c.g, c.b),
          g = o(d.r, d.g, d.b);
        Math.abs(f.l - g.l) < e && (
        f.l >= g.l ? (
        g.l -= e - Math.abs(f.l - g.l), g.l = g.l < 0 ? g.l + 1 : g.l) :
        f.l < g.l && (g.l += e - Math.abs(f.l - g.l), g.l = g.l > 1 ? g.l - 1 : g.l));
        var h = p(g.h, g.s, g.l);
        return m(h.r, h.g, h.b);
      }

      function e(a, b) {
        var c = n(a),
          d = o(c.r, c.g, c.b),
          e = b >= 0.5 ? 0.5 : Math.abs(b),
          f = d.l - e < 0 ? d.l + e : d.l - e;
        return {
          h: d.h,
          s: d.s,
          l: f
        };
      }

      function h(a) {
        var b = 0.05,
          c = e(a, b),
          d = p(c.h, c.s, c.l);
        return m(d.r, d.g, d.b);
      }

      function i(a, b) {
        var c = 0.48,
          d = e(a, c),
          f = n(b),
          g = o(f.r, f.g, f.b),
          h = p(g.h, g.s, d.l);
        return m(h.r, h.g, h.b);
      }

      function j(a) {
        var b = a[s.SEARCH_BG],
          c = k(b);
        b = a[s.BG];
        var d = k(b);
        b = a[s.CONTENT_BG];
        var e = k(b);
        b = a[s.PAGE_BG];
        var f = k(b);
        b = a[s.CONTENT_BG];
        var g = k(b);
        b = a[s.CONTENT_BG];
        var h = k(b);
        return {
          search: c,
          suggest: d,
          selectbox: e,
          page: f,
          more: g,
          layerClose: h
        };
      }

      function k(a) {
        var b = 1,
          c = 0;
        if (a && f.isHex(a)) {
          var d = n(a),
            e = o(d.r, d.g, d.b);
          return e.l < 0.5 ? b : c;
        }
        return c;
      }

      function l(a) {
        a = Math.round(a);
        var b = a.toString(16);
        return 1 == b.length ? "0" + b : b;
      }

      function m(a, b, c) {
        return "#" + l(a) + l(b) + l(c);
      }

      function n(a) {
        var b = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
        a = a.replace(b, function (a, b, c, d) {
          return b + b + c + c + d + d;
        });
        var c = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);
        return c ?
        {
          r: parseInt(c[1], 16),
          g: parseInt(c[2], 16),
          b: parseInt(c[3], 16)
        } :
        null;
      }

      function o(a, b, c) {
        a /= 255, b /= 255, c /= 255;
        var d,
          e,
          f = Math.max(a, b, c),
          g = Math.min(a, b, c),
          h = (f + g) / 2;
        if (f === g) d = e = 0;else
        {
          var i = f - g;
          switch (e = h > 0.5 ? i / (2 - f - g) : i / (f + g), f) {
            case a:
              d = (b - c) / i + (c > b ? 6 : 0);
              break;
            case b:
              d = (c - a) / i + 2;
              break;
            case c:
              d = (a - b) / i + 4;}

          d /= 6;
        }
        return {
          h: d,
          s: e,
          l: h
        };
      }

      function p(a, b, c) {
        var d, e, f;
        if (0 === b) d = e = f = c;else
        {
          var g = 0.5 > c ? c * (1 + b) : c + b - c * b,
            h = 2 * c - g;
          d = q(h, g, a + 1 / 3), e = q(h, g, a), f = q(h, g, a - 1 / 3);
        }
        return {
          r: 255 * d,
          g: 255 * e,
          b: 255 * f
        };
      }

      function q(a, b, c) {
        return (
          0 > c && (c += 1),
          c > 1 && (c -= 1),
          1 / 6 > c ? a + 6 * (b - a) * c : 0.5 > c ? b : 2 / 3 > c ? a + (b - a) * (2 / 3 - c) * 6 : a);

      }

      function r(a) {
        var b = {},
          c = !1;
        try {
          if (!g && "object" === _typeof(a).toLowerCase()) {
            for (var d in s)
            if (s[d]) {
              var e = s[d];
              a[e] && f.isHex(a[e]) && (b[e] = a[e]);
            }
            for (var h in b) b.hasOwnProperty(h) && (c = !0);
          }
        } catch (i) {
          c = !1, b = {};
        }
        return {
          isValid: c,
          userData: b
        };
      }
      var s = {
          BG: "bgColor",
          SEARCH_BG: "searchBgColor",
          CONTENT_BG: "contentBgColor",
          PAGE_BG: "pageBgColor",
          TEXT: "textColor",
          QUERY_TEXT: "queryTextColor",
          POSTCODE_TEXT: "postcodeTextColor",
          EMPH_TEXT: "emphTextColor",
          OUTLINE: "outlineColor"
        },
        t = {},
        u = [
        {
          key: s.BG,
          match: ["BODY.bg"]
        },
        {
          key: s.SEARCH_BG,
          match: ["SEARCH.bg"]
        },
        {
          key: s.CONTENT_BG,
          match: [
          "SEARCH_GUIDE.bg",
          "FILTER_ADDRESS.bg",
          "RESULT_ADDRESS.bg",
          "INFO.bg",
          "INFO.iOSTouchGuideBoxBg",
          "LAYER.bg",
          "SUGGEST.bg"]

        },
        {
          key: s.PAGE_BG,
          match: ["PAGING.bg"]
        },
        {
          key: s.TEXT,
          match: [
          "SEARCH_GUIDE.text",
          "FILTER_ADDRESS.text",
          "RESULT_ADDRESS.addrText",
          "RESULT_ADDRESS.engMapBtnText",
          "RESULT_ADDRESS.autoMappingDontknowText",
          "RESULT_ADDRESS.moreRelAddrLabelText",
          "PAGING.curPageNumText",
          "INFO.text",
          "INFO.iOSTouchGuideBoxText",
          "LAYER.text",
          "SUGGEST.text"]

        },
        {
          key: s.QUERY_TEXT,
          match: ["SEARCH.query"]
        },
        {
          key: s.POSTCODE_TEXT,
          match: ["RESULT_ADDRESS.postcode"]
        },
        {
          key: s.EMPH_TEXT,
          match: [
          "INFO.moveDaumMapText",
          "SEARCH_GUIDE.emphText",
          "RESULT_ADDRESS.hangJungDongText",
          "RESULT_ADDRESS.autoMappingGuideText",
          "RESULT_ADDRESS.buildingDetailText",
          "RESULT_ADDRESS.addrTypeLabelText",
          "SUGGEST.emphText"]

        },
        {
          key: s.OUTLINE,
          match: [
          "SEARCH_GUIDE.topInfoBottomLine",
          "RESULT_ADDRESS.outline",
          "RESULT_ADDRESS.dividingLine",
          "RESULT_ADDRESS.relAddrDividingLine",
          "INFO.bottomLine",
          "INFO.iOSTouchGuideBoxOutline",
          "LAYER.outline",
          "SUGGEST.bottomLine",
          "SUGGEST.dividingLine"]

        }],

        v = [
        {
          keys: [s.SEARCH_BG],
          match: [["SEARCH.placeHolder", "#bbb"]],
          modifier: d
        },
        {
          keys: [s.SEARCH_BG],
          match: [["SEARCH.bottomLine", "#363636"]],
          modifier: i
        },
        {
          keys: [s.CONTENT_BG],
          match: [
          ["RESULT_ADDRESS.addrTypeLabelOutline", "#d4e2ef"],
          ["RESULT_ADDRESS.moreRelAddrBtnBg", "#959595"],
          ["RESULT_ADDRESS.engMapBtnDividingLine", "#cfcfcf"]],

          modifier: d
        },
        {
          keys: [s.CONTENT_BG],
          match: [
          ["SUGGEST.itemOver", "#f4f4f4"],
          ["FILTER_ADDRESS.focusBg", "#efefef"]],

          modifier: h
        },
        {
          keys: [s.PAGE_BG],
          match: [["PAGING.totalPageNumText", "#959595"]],
          modifier: d
        },
        {
          keys: [s.BG],
          match: [
          ["LOGO.text", "#888"],
          ["LOGO.logoTextDividingLine", "#dcdcdc"]],

          modifier: d
        },
        {
          keys: [s.TEXT],
          match: [
          ["INFO.exampleText", "#008bd3"],
          ["SEARCH_GUIDE.exampleText", "#008bd3"]],

          modifier: d
        }];

      return {
        getPreprocessResult: function getPreprocessResult(c) {
          var d = r(c);
          if (d.isValid) {
            var e = d.userData;
            t = {};
            var g = a(e),
              h = b(e),
              i = j(e),
              k = g && h;
            if (k)
            return {
              themeStr: f.themeStringify(t),
              sit: i.search,
              sgit: i.suggest,
              sbit: i.selectbox,
              pit: i.page,
              mit: i.more,
              lcit: i.layerClose
            };
          }
          return null;
        }
      };
    }();
  }(v2, postcodeUtils, window, document, location);
  var v2 = v2 || {};
  !function (a, b, c, d, e) {
    function f(a, b) {
      var c = a;
      if (b) {
        var d = b.q,
          e = !0;
        d &&
        "string" == typeof d &&
        "" !== k.trim(d) && (
        c =
        e === !0 ?
        k.extend(a, {
          region_name: encodeURIComponent(d),
          cq: encodeURIComponent(d),
          intsh: "on"
        }) :
        k.extend(a, {
          userQuery: encodeURIComponent(d),
          cq: encodeURIComponent(d)
        }));
      }
      return c;
    }

    function g(a, b) {
      var c = a;
      if (b) {
        var d = b.left,
          e = b.top;
        if (!isNaN(d) && !isNaN(e)) {
          var f = parseInt(d, 10),
            g = parseInt(e, 10);
          c = k.extend(a, {
            left: 0 > f ? 0 : f,
            top: 0 > g ? 0 : g
          });
        }
      }
      return c;
    }

    function h(a, b) {
      var c = a;
      if (b) {
        var d = b.popupName;
        d &&
        "string" == typeof d &&
        "" !== k.trim(d) && (
        c = k.extend(a, {
          popupName: d
        }));
      }
      return c;
    }

    function i(a, b) {
      var c = a;
      if (b) {
        var d = b.autoClose;
        void 0 !== d &&
        null !== d &&
        "boolean" == typeof d && (
        c = k.extend(a, {
          autoClose: d
        }));
      }
      return c;
    }

    function j(a) {
      var b = ++m.VIEWER_COUNT,
        c = {
          width: l.DEFAULT_WIDTH,
          height: l.DEFAULT_HEIGHT,
          top: 50,
          left: 100,
          onComplete: l.EMPTY_FUNCTION,
          oncomplete: l.EMPTY_FUNCTION,
          onResize: l.EMPTY_FUNCTION,
          onresize: l.EMPTY_FUNCTION,
          onClose: l.EMPTY_FUNCTION,
          onclose: l.EMPTY_FUNCTION,
          autoMapping: !0,
          animation: !1,
          shorthand: !0,
          hideMapBtn: !1,
          hideEngBtn: !1,
          showMoreHName: !1,
          pleaseReadGuide: 0,
          pleaseReadGuideTimer: 1.5,
          theme: null,
          allAddr: !1,
          useSuggest: !0,
          maxSuggestItems: 10,
          autoHiddenSuggest: !1,
          windowHeightAvailableForSuggest: 500
        };
      k.extend(c, a, {
        viewerNo: b,
        timer: null,
        isFlexibleWidth: !1,
        isFlexibleHeight: !1,
        isLayerAutoPositioning: !0,
        isLayerDimmedClick: !0,
        indaum: !1,
        isViewerMode: !1,
        viewType: "none",
        banner: !0,
        autoClose: !0,
        amj: !0,
        useSuggest: !0,
        autoHiddenSuggest: !1
      });
      var d = n.getNormalizeSize(c.width, l.DEFAULT_WIDTH, l.MIN_WIDTH),
        e = n.getNormalizeSize(c.height, l.DEFAULT_HEIGHT, l.MIN_HEIGHT);
      if (
      c.width = d.value,
      c.isFlexibleWidth = d.isFlexible,
      c.height = e.value,
      c.isFlexibleHeight = e.isFlexible,
      c.onComplete && "function" == typeof c.onComplete && c.onComplete !== l.EMPTY_FUNCTION ?
      c.onComplete = c.onComplete :
      c.oncomplete && "function" == typeof c.oncomplete && c.oncomplete !== l.EMPTY_FUNCTION ?
      c.onComplete = c.oncomplete : (
      c.onComplete = l.EMPTY_FUNCTION, c.oncomplete = l.EMPTY_FUNCTION, c.isViewerMode = !0),
      c.onResize && "function" == typeof c.onResize && c.onResize !== l.EMPTY_FUNCTION ?
      c.onResize = c.onResize :
      c.onresize && "function" == typeof c.onresize && c.onresize !== l.EMPTY_FUNCTION ?
      c.onResize = c.onresize : (
      c.onResize = l.EMPTY_FUNCTION, c.onresize = l.EMPTY_FUNCTION),
      c.onClose && "function" == typeof c.onClose && c.onClose !== l.EMPTY_FUNCTION ?
      c.onClose = c.onClose :
      c.onclose && "function" == typeof c.onclose && c.onclose !== l.EMPTY_FUNCTION ?
      c.onClose = c.onclose : (
      c.onClose = l.EMPTY_FUNCTION, c.onclose = l.EMPTY_FUNCTION),
      "boolean" != typeof c.autoMapping && (c.autoMapping = !0),
      "boolean" != typeof c.animation && (c.animation = !1),
      "boolean" != typeof c.shorthand && (c.shorthand = !0),
      "boolean" != typeof c.hideMapBtn && (c.hideMapBtn = !1),
      "boolean" != typeof c.hideEngBtn && (c.hideEngBtn = !1),
      "boolean" != typeof c.showMoreHName && (c.showMoreHName = !1),
      "boolean" != typeof c.useSuggest && (c.useSuggest = !0),
      "boolean" != typeof c.autoHiddenSuggest && (c.autoHiddenSuggest = !1),
      isNaN(c.pleaseReadGuide) || "number" != typeof c.pleaseReadGuide ?
      c.pleaseReadGuide = 0 : (
      c.pleaseReadGuide = parseInt(c.pleaseReadGuide, 10),
      c.pleaseReadGuide <= 2 && (c.pleaseReadGuide = 0),
      c.pleaseReadGuide > 20 && (c.pleaseReadGuide = 20)),
      isNaN(c.pleaseReadGuideTimer) || "number" != typeof c.pleaseReadGuideTimer ?
      c.pleaseReadGuideTimer = 1.5 : (
      c.pleaseReadGuideTimer = parseFloat(c.pleaseReadGuideTimer),
      c.pleaseReadGuideTimer <= 0 && (c.pleaseReadGuideTimer = 1.5),
      c.pleaseReadGuideTimer > 60 && (c.pleaseReadGuideTimer = 1.5)),
      isNaN(c.maxSuggestItems) || "number" != typeof c.maxSuggestItems ?
      c.maxSuggestItems = 10 : (
      c.maxSuggestItems = parseInt(c.maxSuggestItems, 10),
      (c.maxSuggestItems < 1 || c.maxSuggestItems > 10) && (c.maxSuggestItems = 10)),
      c.windowHeightAvailableForSuggest = 45 * c.maxSuggestItems + 50,
      c.theme)
      {
        var f = p.getPreprocessResult(c.theme);
        null === f ? c.theme = null : c.theme = f;
      }
      "boolean" != typeof c.allAddr && (c.allAddr = !1), this._opt_ = c;
    }
    var k = b,
      l = a.CONT,
      m = a.MODEL,
      n = a.viewUtils,
      o = a.frame,
      p = a.themePreprocessor,
      q = "https://postcode.map.daum.net/search",
      r = encodeURIComponent(l.PROTOCOL + "//" + e.host),
      s = encodeURIComponent(e.pathname),
      t = encodeURIComponent(e.search),
      u = q + "?origin=" + r;
    o.init(u, s, t),
    j.prototype = {
      open: function open(a) {
        var b = k.extend({}, this._opt_);
        b = f(b, a),
        b = g(b, a),
        b = h(b, a),
        b = i(b, a),
        b = k.extend(b, {
          viewType: "popup"
        }),
        o.popup.create(b);
      },
      embed: function embed(a, b) {
        var c = k.extend({}, this._opt_);
        c = f(c, b),
        c = i(c, b),
        c = k.extend(c, {
          viewType: "layer"
        }),
        o.layer.create(c, a);
      }
    },
    c.daum.Postcode = j;
  }(v2, postcodeUtils, window, document, location);
})();


/*
 * 아코디언
 */
(function ($, dews, kendo) {
  var DEFAULT_ROW = 1;
  var DEFAULT_ITEM_BOOLEAN = false;

  /**
   * 설정 값을  가져옵니다.
   * @param {HTMLElement} list 아코디언 아이템 요소
   * @param {object} arco 아코디언 객체
   */
  var ListItem = function ListItem(list, arco) {
    var self = this,
      $listItem = $(list);
    var options = {};

    self._item = $listItem;
    self.arcodien = arco;
    self._item.opened = DEFAULT_ITEM_BOOLEAN;
    self._item.hidden = DEFAULT_ITEM_BOOLEAN;

    options = getItemOptions($listItem);
    self.options = options;

    self._initItem();
    self._bindEvent();

    return self;
  };

  /**
   * 설정 값을  가져옵니다.
   * @param {jQuery} $listItem 대상 요소의 jQuery 객체
   */
  function getItemOptions($listItem) {
    var $element = $listItem;
    var options = {
      useIcon: DEFAULT_ITEM_BOOLEAN
    };
    //icon 사용 여부 옵션 체크
    if ($element.is('[class*="ico-"]') || $element.data("dews-ico")) {
      options.useIcon = true;
    }
    //open 상태 옵션
    if ($element.data("dews-item-open") && $element.data("dews-item-open") === true) {
      options.openStatus = true;
    }
    //숨김 상태 옵션
    if ($element.data("dews-item-hide") && $element.data("dews-item-hide") === true) {
      options.hideStatus = true;
    }

    return options;
  }

  /**
   * 아코디언 아이템의 구조를 설정합니다.
   * @private
   */
  ListItem.prototype._initItem = function () {
    var self = this;
    var title = self._item.find(">p.dews-arcodien-item-title");
    var content = self._item.find(">div.dews-arcodien-contents");

    // 아코디언 타이틀에 button 쓰려면 button group 쓰고
    // 콘텐츠 영역에도 button group 쓸 일이 있으면 컨텐츠 영역은 꼭 .dews-arcodien-contents에 작성
    var $buttonGroup = self._item.find(">.dews-ui-button-group");
    $buttonGroup === null || $buttonGroup === void 0 ? void 0 : $buttonGroup.remove();
    var innerHTML = self._item.html();

    self._item.empty();

    // 초기 open 상태 값 설정
    if (self.options.openStatus) {
      self._item.opened = true;
    }

    // 초기 숨김 상태 값 설정
    if (self.options.hideStatus) {
      self._item.hidden = true;
    }

    var titleText;
    if (title.length === 0) {
      if (self._item.data("dews-localize-key")) {
        titleText = dews.localize.get(
        self._item.data("dews-item-title"),
        self._item.data("dews-localize-key"),
        self._item.data("dews-localize-lang") || null);

      } else {
        titleText = self._item.data("dews-item-title");
      }

      title = $('<p class="dews-arcodien-item-title">' + titleText + "</p>");
    } else {
      if (self._item.data("dews-localize-key")) {
        title[0].innerText = dews.localize.get(
        title[0].innerText,
        title.data("dews-localize-key"),
        title.data("dews-localize-lang") || null);

      }
      titleText = title[0].innerText;
    }

    self._item.append(title);

    if ($buttonGroup) {
      self._item.append($buttonGroup);
    }

    // 타이틀 길이가 길어지면 말줄임처리되며 툴팁으로 표시
    if (title.get(0)) {
      setLabelTitleWhenEllipsis(title.get(0), titleText);
    }

    if (content.length === 0) {
      var contents = innerHTML.replace(/<p class=\s?(?:"|')dews-arcodien-item-title[^<]+<\/p>/gi, "");
      content = $('<div class="dews-arcodien-contents"/>');
      content.append($(contents));
    }

    self._item.append(content);

    // 아코디언 내 아이템 높이 지정
    setItemHeight(self);

    // 아코디언 내 아이템 타이틀 문구 지정
    if (self._item.data("dews-item-title")) {
      title.innerText = titleText;
    }
    // 아코디언 내 아이템 아이콘 지정
    if (self._item.data("dews-ico")) {
      self._item.addClass(self._item.data("dews-ico"));
    }
    // 아코디언 타이틀 아이콘 공간 설정
    if (self.options.useIcon) {
      title.addClass("icon-space");
    }

    if (this.hasOnlyContent()) {
      this.removeTitleBorder();
    }
  };

  /**
   * 타이틀의 하단 라인과 컨텐츠의 마진을 제거합니다.
   * @private
   */
  ListItem.prototype.removeTitleBorder = function () {
    this._item.addClass('only-content');
  };

  /**
   * 콘텐츠 내부에 하나의 아이템만 있는지 판단합니다.
   * @private
   * @returns {boolean}
   */
  ListItem.prototype.hasOnlyContent = function () {
    return this._item.children('.dews-arcodien-contents').children().length === 1;
  };

  // 지정한 p 요소에 지정한 텍스트의 title 속성을 지정합니다.
  function setLabelTitleWhenEllipsis(p, text) {
    if (p && p.scrollWidth) {
      if (p.scrollWidth > p.offsetWidth) {
        $(p).attr("title", text);
      } else {
        $(p).removeAttr("title");
      }
    }
  }

  /**
   * 아코디언 아이템의 텍스트 값을 설정 및 반환 합니다.
   * @param {string} text 아코디언 아이템 title
   */
  ListItem.prototype.title = function (text) {
    var self = this,
      $p = self._item.find("> p.dews-arcodien-item-title");

    if (text) {
      $p.text(text);

      if ($p.get(0)) {
        setLabelTitleWhenEllipsis($p.get(0), text);
      }
    } else {
      return $p.text();
    }
  };
  /**
   * 아코디언 아이템을 open 합니다.
   */
  ListItem.prototype.open = function () {
    var self = this;

    if (
    self.arcodien.options.useMulti ||
    self.arcodien._element.find("> ul > li.selected > .dews-arcodien-contents").length === 0)
    {
      self.arcodien._open(self);
    } else {
      self.arcodien._element.
      find("> ul > li.selected > .dews-arcodien-contents").
      slideUp(300, "linear", function () {
        self.arcodien._element.find("> ul > li.selected").removeClass("selected");
        self.arcodien._open(self);
      });
    }
  };
  /**
   * 아코디언 아이템을 close 합니다.
   */
  ListItem.prototype.close = function () {
    var self = this;

    self.arcodien._close(self);
  };
  //
  /**
   * 아코디언 아이템의 활성화 여부를 설정합니다
   * @param {boolean} value 아코디언 아이템의 활성화 여부
   */
  ListItem.prototype.enable = function (value) {
    var self = this;

    if ($.type(value) === "undefined") {
      return self._item.attr("disabled");
    } else if ($.type(value) === "boolean") {
      if (value) {
        self._item.attr("disabled", !value);
        self._item.removeClass("dews-state-disabled");
      } else {
        self.close();
        self._item.attr("disabled", !value);
        self._item.addClass("dews-state-disabled");
      }
    }
  };
  /**
   * 아이템 on 이벤트
   */
  ListItem.prototype.on = function () {
    var self = this;

    self._item.
    find("p.dews-arcodien-item-title").
    on.apply(self._item.find("p.dews-arcodien-item-title"), arguments);
  };
  //
  /**
   * 아이템 off 이벤트
   */
  ListItem.prototype.off = function () {
    var self = this;

    self._item.
    find("p.dews-arcodien-item-title").
    off.apply(self._item.find("p.dews-arcodien-item-title"), arguments);
  };
  /**
   * 아코디언 아이템 이벤트
   * @private
   */
  ListItem.prototype._bindEvent = function () {
    var self = this,
      event,
      parameter = {
        item: self,
        status: ""
      };

    // 아코디언 내 아이템 타이틀 클릭 이벤트
    self._item.find("> p.dews-arcodien-item-title").on("click", function (e) {
      if (self._item.hasClass("selected")) {
        parameter.status = "close";
        self.close();
      } else {
        parameter.status = "open";
        self.open();
      }

      event = $.Event("click", parameter);
      self._item.trigger(event);

      e.stopPropagation();
    });

    self._item.on("mouseenter", "p.dews-arcodien-item-title", function (e) {
      var targetLabel = e.currentTarget;
      if (targetLabel.scrollWidth > targetLabel.offsetWidth) {
        if (!$(targetLabel).attr("title")) {
          $(targetLabel).attr("title", targetLabel.innerText);
        }
      }
    });
  };

  /**
   * 아코디언 아이템을 숨깁니다.
   */
  ListItem.prototype.hide = function () {
    var self = this;
    self._item.hidden = true;
    if (self._item.hidden) {
      self._item.css("display", "none");
    }
  };

  /**
   * 아코디언의 숨겨진 아이템을 보여줍니다.
   */
  ListItem.prototype.show = function () {
    var self = this;
    self._item.hidden = false;
    if (self._item) {
      if (!self._item.hidden) {
        self._item.css("display", "");
      }
    }
  };

  /**
   * 아코디언 아이템이 열려있는지 확인합니다.
   */
  ListItem.prototype.isOpened = function () {
    var self = this;
    return self._item.opened;
  };

  /**
   * 아코디언 내 아이템의 길이 설정 (일괄/개별)
   */
  function setItemHeight(self) {
    if (
    self.arcodien.options.useMulti ||
    !self.arcodien.options.useMulti && !self.arcodien._element.data("dews-arcodien-height"))
    {
      // 아코디언 내 아이템 높이 일괄 지정
      if (self.arcodien._element.data("dews-item-height")) {
        self._item.
        find(">div.dews-arcodien-contents").
        css("height", self.arcodien._element.data("dews-item-height") - self._item.height() + "px");
      }
      // 아코디언 내 아이템 높이 개별 지정
      if (self._item.data("dews-item-height")) {
        self._item.
        find(">div.dews-arcodien-contents").
        css("height", self._item.data("dews-item-height") - self._item.height() + "px");
      }
    }
  }

  /**
   * 아코디언의 기본 옵션을 가져옵니다.
   */
  function getOptions($el, opt) {
    var $element = $el,
      options = {
        useMulti: false
      };

    if ($element.data("dews-arcodien-type") === "multiple") {
      options.useMulti = true;
    }

    options = $.extend(true, options, opt);

    return options;
  }

  /**
   * 아코디언 객체
   */
  var Arcodien = function Arcodien($el, opt) {
    var self = this,
      options;

    options = getOptions($el, opt);

    self._element = $el;
    self.options = options;
    self.items = [];

    nthCreate(self);
    // 아코디언 내 아이템에 아이디 값으로 접근 가능
    self.items.getById = function (id) {
      // this는 listItem 객체들이 담겨있는 self.items
      for (var i = 0; i < this.length; i += 1) {
        if (this[i]._item.attr("ID") === id) {
          return this[i];
        }
      }
      return null;
    };

    self._initArcodienHeight();
    self._bindEvent();
    self._initItemOpen();
    self._initItemHide();

    return self;
  };

  /**
   * 아코디언 아이템를 객체화 합니다.
   * @param arcodien {object} arcodien 아코디언 객체
   */
  function nthCreate(arcodien) {
    var self = arcodien;

    for (var i = 0; i < arcodien._element.find("> ul > li").length; i += 1) {
      self.items.push(new ListItem(arcodien._element.find("> ul > li")[i], self));
    }
  }

  /**
   * 아코디언의 길이를 초기화합니다.
   * @private
   */
  Arcodien.prototype._initArcodienHeight = function () {
    var self = this;

    if (self._element.data("dews-arcodien-height")) {
      self._element.css("height", self._element.data("dews-arcodien-height") + "px");
    }
  };

  /**
   * 아코디언에서 설정된 아이템을 열어줍니다.
   * @private
   */
  Arcodien.prototype._initItemOpen = function () {
    var self = this,
      $items = self.items;
    var openItemLength = DEFAULT_ROW;
    var openedItemCount = 0;

    if (self.options.useMulti === true) {
      if ($items.length && $items.length !== 0) openItemLength = $items.length;
    }

    for (var itemOrder = 0; itemOrder < $items.length; itemOrder++) {
      if (openedItemCount < openItemLength) {
        if ($items[itemOrder]._item.opened) {
          self._open($items[itemOrder]);
          openedItemCount++;
        }
      }
    }
  };

  /**
   * 아코디언에서 설정된 아이템을 숨김 처리합니다.
   * @private
   */
  Arcodien.prototype._initItemHide = function () {
    var self = this;
    var itemListLength = DEFAULT_ROW;

    if (self.options.useMulti === true) {
      if (self.items.length && self.items.length !== 0) itemListLength = self.items.length;
    }

    for (var itemOrder = 0; itemOrder < itemListLength; itemOrder++) {
      if (self.items[itemOrder]._item.hidden) {
        self.items[itemOrder].hide();
      }
    }
  };

  /**
   * 아코디언 활성화 유무 설정합니다.
   * @param {boolean} value 아코디언 활성화 여부
   */
  Arcodien.prototype.enable = function (value) {
    var self = this;

    if ($.type(value) === "undefined") {
      return self._element.attr("disabled");
    } else if ($.type(value) === "boolean") {
      if (value) {
        self._element.attr("disabled", !value);
        self._element.removeClass("dews-state-disabled");
      } else {
        self._element.find("> ul > li > .dews-arcodien-contents").css("display", "none");
        self._element.find("> ul > li.selected").removeClass("selected");
        self._element.attr("disabled", !value);
        self._element.addClass("dews-state-disabled");
      }
    }
  };
  /**
   * 아코디언 on 이벤트
   */
  Arcodien.prototype.on = function () {
    var self = this;

    if (arguments[0] === "click") {
      Array.prototype.splice.apply(arguments, [0, 1, "_click"]);
    }

    self._element.on.apply(self._element, arguments);
  };
  /**
   * 아코디언 off 이벤트
   */
  Arcodien.prototype.off = function () {
    var self = this;

    if (arguments[0] === "click") {
      Array.prototype.splice.apply(arguments, [0, 1, "_click"]);
    }

    self._element.off.apply(self._element, arguments);
  };

  /**
   * 아코디언 열기
   * @param {jQuery} item 아코디언 아이템 jQuery 객체
   * @private
   */
  Arcodien.prototype._open = function (item) {
    var self = this,
      $item = item._item;

    var parameter = {
      arcodien: self,
      $arcodien: self._element,
      item: item,
      $item: $item,
      multiple: self.options.useMulti
    };

    var openEvent = $.Event("open", parameter);
    self._element.trigger(openEvent);

    $item.
    not(".dews-state-disabled").
    find("> div.dews-arcodien-contents").
    slideDown(300, "linear", function () {
      $item.addClass("selected");
      $item.opened = true;
      var grid = $item.find(".dews-ui-grid"),
        innerGrid;
      for (var i = 0; i < grid.length; i++) {
        innerGrid = dews.ui.grid($(grid[i]));
        innerGrid._grid.resetSize();
      }
    });
  };

  //
  /**
   * 아코디언 닫기
   * @param {jQuery} item 아코디언 아이템 jQuery 객체
   * @private
   */
  Arcodien.prototype._close = function (item) {
    var self = this;
    var $item = item._item;

    var parameter = {
      arcodien: self,
      $arcodien: self._element,
      item: item,
      $item: $item,
      multiple: self.options.useMulti
    };

    var closeEvent = $.Event("close", parameter);
    self._element.trigger(closeEvent);

    $item.find("> div.dews-arcodien-contents").slideUp(300, "linear", function () {
      $item.removeClass("selected");
      $item.opened = false;
    });
  };

  /**
   * 아코디언 이벤트
   * @private
   */
  Arcodien.prototype._bindEvent = function () {
    var self = this,
      event,
      parameter = {
        arcodien: self,
        openItem: "",
        closeItem: ""
      };

    self._element.on("click", function (e) {
      parameter.openItem = e.item;
      if (self._element.find("li.selected").length !== 0) {
        parameter.closeItem = self.items[self._element.find("li.selected").index()];
      }
      event = $.Event("_click", parameter);
      self._element.trigger(event);

      e.stopPropagation();
    });
  };

  /**
   * 아코디언 모든 아이템 열기
   */
  Arcodien.prototype.openAll = function () {
    //this = arcodien
    var self = this;
    var $contents = self._element.find("> ul > li > .dews-arcodien-contents");

    if (self.options.useMulti || $contents.length === 0) {
      for (var i = 0; i < self.items.length; i += 1) {
        if (!self.items[i]._item.hasClass("selected")) {
          self._open(self.items[i]);
        }
      }
    }
  };

  /**
   * 아코디언 모든 아이템 닫기
   */
  Arcodien.prototype.closeAll = function () {
    var self = this;

    for (var i = 0; i < self.items.length; i += 1) {
      if (self.items[i]._item.hasClass("selected")) {
        self._close(self.items[i]);
      }
    }
  };

  Arcodien.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["click", "open", "close"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "click") {
          self._element.trigger("_click");
        } else {
          self._element.trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  $.extend(true, dews, {
    ui: {
      arcodien: function arcodien(selector, options) {
        var $ctl, arcodien;

        if (selector instanceof jQuery) {
          $ctl = selector;
        } else if ($.type(selector) === "string") {
          $ctl = $(selector);
        } else {
          throw "아코디언을 생성할 대상이 제공되지 않았습니다.";
        }

        $ctl.each(function () {
          var $this = $(this);

          arcodien = $this.data("dews-control");

          if (!arcodien) {
            arcodien = new Arcodien($this, options);

            if (!$this.hasClass("dews-ui-arcodien")) {
              $this.addClass("dews-ui-arcodien");
            }
            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            $this.data("dews-control", arcodien);
          }
        });

        return arcodien;
      }
    }
  });

  dews.ui.addControlInitializer("arcodien", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.arcodien($("div.dews-ui-arcodien", $container));
  });
})(jQuery, window.dews, window.kendo);


/**
 * 컨디션패널
 */
(function ($, dews) {
  var COMPONENT_NAME = "dews-ui-condition-panel";
  var COMPONENT_TYPE = "dews-container-control";
  var ACTIVATED_STATUS = "dews-control-activate";
  var EXPAND_BUTTON_CLASS_NAME = "dews-condition-panel-expand-button";
  var DEFAULT_COLUMN_SIZE = 3; // 기본 컬럼 갯수
  var MAX_COLUMN_SIZE = 5; // 최대 컬럼 갯수
  var MIN_COLUMN_SIZE = 1; // 최소 컬럼 갯수

  /**
   * 컨디션패널에 포함된 항목의 요소를 나타내는 클래스입니다.
   * @constructor
   */
  function PanelItem($li) {
    var self = this;
    self._$element = $li;
    self.label = self._$element.find("> label").get(0);
    self.container = self._$element.find("> span").get(0);
  }

  /**
   * 컨디션패널 항목의 라벨에 설정된 텍스트를 가져오거나 텍스트를 설정합니다.
   * @param text 설정할 라벨의 텍스트 (생략하면 설정되어있는 텍스트를 가져옵니다.)
   * @returns {string | undefined}
   */
  PanelItem.prototype.text = function (text) {
    var self = this;

    if (typeof text === "undefined") {
      return $(self.label).text();
    } else {
      $(self.label).text(text);
      setLabelTitleWhenEllipsis(self.label, text);
    }
  };

  // 기본 옵션 값
  var defaultOptions = {
    columns: DEFAULT_COLUMN_SIZE,
    collapsed: true,
    labelAlign: "right"
  };

  // HTML 요소에 지정된 옵션을 가져옵니다.
  function getInlineOptions($el) {
    var options = {};
    /*
     * data-dews-columns: 컬럼 개수 (MIN_COLUMN_SIZE ~ MAX_COLUMN_SIZE) - 기본값: 3
     * data-dews-label-width: 라벨 영역의 너비 - 기본값: 스타일시트에 정의된 값
     * data-dews-item-width: 컨디션 패널 개별 항목의 영역 너비 (라벨 너비 + 컨트롤 영역 너비) - 기본값: 스타일시트에 정의된 값
     * data-dews-optional-collapsed: 초기화 시 옵션 영역 접혀있는지 여부 (true/false) - 기본값: true
     * data-dews-label-align: 라벨의 텍스트 정렬 방식 (left, center, right) - 기본값: right
     * data-dews-required-check: 필수 입력 항목일 경우 엔터키 입력시 다음 항목 이동 사용 여부 선택
     */

    if ($el.data("dews-columns")) {
      options.columns = parseInt($el.data("dews-columns"), 10);
    }
    if ($el.data("dews-label-width")) {
      options.labelWidth = parseInt($el.data("dews-label-width"), 10);
    }
    if ($el.data("dews-item-width")) {
      options.itemWidth = parseInt($el.data("dews-item-width"), 10);
    }
    if (typeof $el.data("dews-optional-collapsed") !== "undefined") {
      options.collapsed = /true/i.test($el.data("dews-optional-collapsed"));
    }
    if ($el.data("dews-label-align")) {
      options.labelAlign = $el.data("dews-label-align");
    }
    if ($el.data("dews-required-check")) {
      options.requiredCheck = $el.data("dews-required-check");
    }

    return options;
  }

  // 컨디션패널을 생성합니다.
  function createPanel(panel) {
    var $form;
    var formName = "dews-condition-panel-form";

    // 이미 생성되어 있다면 생성 로직을 태우지 않습니다.
    if (panel.$element.hasClass(COMPONENT_TYPE)) {
      return;
    }

    // 스크립트 코드에서 동적으로 생성되었다면 컴포넌트 기본 클래스를 추가해줌
    if (!panel.$element.hasClass(COMPONENT_NAME)) {
      panel.$element.addClass(COMPONENT_NAME);
    }

    if (
    panel._options.columns &&
    panel._options.columns >= MIN_COLUMN_SIZE &&
    panel.options.columns <= MAX_COLUMN_SIZE)
    {
      panel.$element.addClass("col-" + panel._options.columns.toString());
    } else {
      throw "컨디션패널의 컬럼 갯수가 잘못 지정되었습니다.";
    }

    // 라벨의 정렬 너비
    switch (panel._options.labelAlign) {
      case "center":
        panel.$element.
        find("ul.required-area > li > label, ul.optional-area > li > label").
        css("textAlign", "center");
        break;
      case "left":
        panel.$element.
        find("ul.required-area > li > label, ul.optional-area > li > label").
        css("textAlign", "left");
        break;
      case "right":
        panel.$element.
        find("ul.required-area > li > label, ul.optional-area > li > label").
        css("textAlign", "right");
        break;
      default:
        break;}


    // 폼 요소를 확인하고 누락되어 있다면 추가합니다.
    $form = panel.$element.find("> ." + formName);

    if ($form.length === 0) {
      // 기존 코드에는 .dews-condition-panel-form 을 기본으로 요구하였으므로 하위호환성 확보
      $form = $('<form class="' + formName + '"></form>');
      $form.append(panel.$element.find("> ul").detach());
      panel.$element.append($form);
    }

    $form.on("submit", function (e) {
      e.preventDefault();
    }); // Enter 키에 의한 폼 submit 방지

    panel.$element.addClass(COMPONENT_TYPE);

    panel.$element.find("ul").each(function (idx, item) {
      var $ul = $(item);
      var requiredAreaName = "required-area";
      var optionalAreaName = "optional-area";

      if (idx === 0) {
        if (!$ul.hasClass(requiredAreaName)) {
          $ul.addClass(requiredAreaName);
        }
      } else {
        if (!$ul.hasClass(optionalAreaName)) {
          $ul.addClass(optionalAreaName);
        }
      }

      retouchItems(panel, $ul);
    });

    // 항목 너비가 지정되어 있다면 컨테이너의 상태에 따라 재계산하여 설정
    dews.ready(function () {
      if (panel._options.itemWidth) {
        var itemRightMargin = parseInt(panel.$element.find("li").eq(0).css("margin-right"), 10);
        var containerPaddingLeft = parseInt(panel.$element.find("ul").eq(0).css("padding-left"), 10);
        var containerPaddingRight = parseInt(panel.$element.find("ul").eq(0).css("padding-right"), 10);
        var borderWidth = parseInt(panel.$element.css("border-width"), 10);
        var itemGroupMinWidth =
        panel._options.itemWidth * panel._options.columns + (panel._options.columns - 1) * itemRightMargin;
        var containerMinWidth =
        itemGroupMinWidth + containerPaddingLeft + containerPaddingRight + borderWidth * 2;
        var liWidth = panel._options.itemWidth;
        var columnsNum;
        if (panel.$element.data("dews-columns")) {
          columnsNum = panel.$element.data("dews-columns");
        }
        var ulMinWidth =
        (liWidth + itemRightMargin) * columnsNum + containerPaddingLeft + containerPaddingRight;

        panel.$element.find("ul").css({ minWidth: ulMinWidth });
        panel.$element.css({ minWidth: containerMinWidth });
      }
    });

    // 컴포넌트 보이기
    panel.$element.addClass(ACTIVATED_STATUS);
  }

  // 컨디션 패널 항목 아이템이 지정한 대로 출력될 수 있도록 후처리를 실시합니다.
  function retouchItems(panel, $ul) {
    var $items = $ul.children("li");
    var $items2 = $ul.children("li:not(.transparency)");
    var emptyLITemplate = '<li class="dews-condition-panel-item-transparency"></li>';
    var colsRegex = /col-(\d+)\s?/;
    var options = panel._options;

    $items.each(function (idx, item) {
      var $item = $(item),
        $empty,
        $label;
      var matches, cols, itemSpace;
      matches = colsRegex.exec(item.className);

      // 병합이 되는 셀이 있는 지 확인하고 처리합니다.
      if ($.isArray(matches) && matches[1]) {
        cols = parseInt(matches[1], 10);
        for (var i = 0; i < cols - 1; i++) {
          $empty = $(emptyLITemplate);
          $empty.addClass("transparency"); // TODO: 하위 호환성을 위해 추가하였으나 제거할 것
          $item.after($empty);
        }
      }

      // itemWidth 또는 labelWidth 로 너비가 지정된 경우
      // itemWidth 처리
      if (options.itemWidth) {
        itemSpace = parseInt($item.css("margin-right").replace("px", ""));
        $item.css({
          width: options.itemWidth * (cols || 1) + itemSpace * ((cols || 1) - 1) + "px"
        });
      }

      $label = $item.children("label");
      // labelWidth 처리
      if (options.labelWidth) {
        $label.css({ width: options.labelWidth + "px" });
      }
      // 라벨 문자열 다국어 적용
      if ($label) {
        $label.each(function (idx, label) {
          if ($(label).data("dews-localize-key")) {
            $(label).text(dews.localize.get($(label).text(), $(label).data("dews-localize-key")));
          }
        });
      }

      // ellipsis(말줄임표)가 적용되었는지를 판단하여 title 을 이용하여 툴팁이 뜰 수 있게함
      if ($label.get(0)) {
        setLabelTitleWhenEllipsis($label.get(0), $label.text());
      }

      // 컨디션패널 항목을 items 에 추가
      panel.items.push(new PanelItem($item));
    });

    var sum = 0;

    $items2.each(function (idx, item) {
      var $item = $(item),
        $empty;
      var panelCols = panel.options.columns;
      // 병합이 되는 셀이 있는 지 확인하고 처리합니다.
      var matches = colsRegex.exec(item.className);

      if ($.isArray(matches) && matches[1]) {
        var cols = parseInt(matches[1], 10);
      } else {
        cols = 1;
      }

      var beforeSum = sum;
      sum = sum + cols;

      if (sum === panelCols) {
        sum = 0;
      } else if (sum > panelCols) {
        for (var j = 0; j < panelCols - beforeSum; j++) {
          $empty = $(emptyLITemplate);
          $empty.addClass("transparency");
          $item.before($empty);
        }

        sum = cols;
      }
    });
  }

  // 지정한 label 요소에 지정한 텍스트의 title 속성을 지정합니다.
  function setLabelTitleWhenEllipsis(label, text) {
    if (label && label.scrollWidth) {
      if (label.scrollWidth > label.offsetWidth) {
        $(label).attr("title", text);
      } else {
        $(label).removeAttr("title");
      }
    }
  }

  // 옵션 영역 보기 버튼 추가 여부를 판단하고 처리합니다.
  function createOptionsExpandButton(panel) {
    var $optional,
      $button,
      collapsedCssName = "collapsed",
      expandedCssName = "expanded";

    $optional = panel.$element.find(".optional-area");
    if ($optional.length > 0 && $optional.find("> li").length > 0) {
      $button = panel.$element.find("." + EXPAND_BUTTON_CLASS_NAME);
      panel.$element.addClass("expandable");

      if ($button.length === 0) {
        $button = $('<button type="button"></button>');
        $button.addClass(EXPAND_BUTTON_CLASS_NAME);
        $button.on("click", function (e) {
          e.preventDefault();
          // 옵션 영역을 토글 시킵니다.
          expandOptionalArea(panel, panel._options.collapsed);
        });
        panel.$element.append($button);
      }

      // 옵션 영역이 열려있는지 닫혀있는지로 버튼 및 옵션 영역 숨기기 처리
      if (panel._options.collapsed) {
        $button.addClass(collapsedCssName);
        $optional.hide();
      } else {
        $button.addClass(expandedCssName);
        $optional.show();
      }
    }
  }

  // 옵션 영역을 열거나 닫습니다.
  function expandOptionalArea(panel, expand) {
    var $button = panel.$element.find("." + EXPAND_BUTTON_CLASS_NAME),
      $optional = panel.$element.find(".optional-area"),
      collapsedCssName = "collapsed",
      expandedCssName = "expanded",
      evt;

    if (expand && panel._options.collapsed) {
      $button.removeClass(collapsedCssName).addClass(expandedCssName);
      $optional.slideDown(400, function () {
        resetGridSize(panel);
        /* 2021-05-14 KHJ
         * expandedSlideComplete 이벤트 호출 추가
         */
        var evtComplete = new $.Event("expandedSlideComplete");
        evtComplete.panel = panel;
        panel.$element.trigger(evtComplete);
      }).removeClass(collapsedCssName).addClass(expandedCssName);
      panel._options.collapsed = false;
      evt = new $.Event("expanded");
      evt.panel = panel;
      panel.$element.trigger(evt);
    } else if (!expand && !panel._options.collapsed) {
      $button.removeClass(expandedCssName).addClass(collapsedCssName);
      $optional.slideUp(400, function () {
        resetGridSize(panel);

        /* 2021-05-14 KHJ
         * collapsedSlideComplete 이벤트 호출 추가
         */
        var evtComplete = new $.Event("collapsedSlideComplete");
        evtComplete.panel = panel;
        panel.$element.trigger(evtComplete);
      }).removeClass(expandedCssName).addClass(collapsedCssName);
      panel._options.collapsed = true;
      evt = new $.Event("collapsed");
      evt.panel = panel;
      panel.$element.trigger(evt);
    }
  }

  // 윈도우에서 컨디션패널의 옵션영역이 열리고 닫힐 때 페이지 영역이 길어지면서
  // 우측에 스크롤이 생기는데, 그러면서 그리드의 너비가 안맞음
  function resetGridSize(panel) {
    var $page;

    if (dews.ui.dialogPage && panel.$element.closest(dews.ui.dialogPage.$content).length) {
      $page = dews.ui.dialogPage.$content;
    } else if (dews.ui.page && panel.$element.closest(dews.ui.page.$content).length) {
      $page = dews.ui.page.$content;
    } else {
      $page = $(document);
    }

    $.each($page.find(".dews-ui-grid"), function (idx, grid) {
      var grid = dews.ui.grid($(grid));
      grid._grid.resetSize();
    });
  }
  /**
   * 컨디션패널을 생성하기 위한 클래스
   * @param {HTMLElement} element 컨디션패널 요소
   * @param {object} options 컨디션패널 옵션
   * @constructor
   */
  var ConditionPanel = function ConditionPanel(element, options) {
    var self = this;

    // 대상 요소 저장
    self._element = element;
    self.$element = $(element);

    // 생성 옵션 결정
    var inlineOptions = getInlineOptions(self.$element);
    self.options = $.extend({}, defaultOptions, inlineOptions, options);
    self._options = $.extend(true, {}, self.options);

    // 개별 요소에 대한 접근
    self.items = [];
    self.listItems = self.items; // 하위호환성을 위해서 listItems 로도 items 노출
    self.items.getById = function (id) {
      // 아이디를 이용하여 개별 항목 가져오기
      var result;

      $.each(self.items, function (idx, item) {
        if (item._$element.attr("id") === id) {
          result = item;
          return false;
        }
      });

      return result;
    };

    self.tracked = false;
    self._onegrid = self._isOneGrid();

    self._bindEvent();

    dews.ready(function () {
      if (!self.tracked) {
        self._trackChanges();
        self._applyFocusManager();
        self.tracked = true;
      }
    });

    return self;
  };

  ConditionPanel.prototype._bindEvent = function () {
    var self = this;

    self.$element.on("mouseenter", "label", function (e) {
      var targetLabel = e.currentTarget;
      if (targetLabel.scrollWidth > targetLabel.offsetWidth) {
        if (!$(targetLabel).attr("title")) {
          $(targetLabel).attr("title", targetLabel.innerText);
        }
      }
    });
  };

  /**
   * 내부 컴포넌트들의 change 이벤트가 발생하면 컨디셤패널에서도 change 이벤트가 발생하도록 처리합니다.
   */
  ConditionPanel.prototype._trackChanges = function () {
    var self = this;
    var $el = self.$element;
    var evt;
    $el.find("*[class^=dews-ui-].dews-form-control").each(function (idx, target) {
      var $item = $(target);
      var dewsObj = $item.data("dews-control");
      if (dewsObj && $.isFunction(dewsObj.on)) {
        dewsObj.on("change", function (e) {
          if (!self.binding) {
            evt = new $.Event("_change");
            evt.source = dewsObj;
            evt.$source = $item;
            $el.trigger(evt);

            if ($item.attr("class").match(/periodpicker|codepicker/) !== null) {
              // _change 로 이벤트 발생되는 컴포넌트 들 중복 발생 막기.
              e.stopPropagation();
            }
          }
        });
      }
    });
  };

  /**
   * 옵션 영역이 열려있는지 여부를 가져오거나 옵션 영역을 열거나 닫습니다.
   * @param expand {boolean} 옵션 영역을 열지 여부 (true: 열림, false: 닫힘)
   * @returns {boolean|undefined} 매개변수의 제공에 따라 현재 옵션 영역이 열렸는지 여부를 반환하거나 undefined 를 반환합니다.
   */
  ConditionPanel.prototype.expandOptional = function (expand) {
    var self = this;

    if (typeof expand === "undefined") {
      // 현재 옵션 영역이 열려있는지를 반환
      return !self._options.collapsed;
    } else {
      // 값이 들어온 경우에는 옵션 영역을 열거나 닫음
      expandOptionalArea(self, expand);
    }
  };

  /**
   * 내부 컴포넌트에서 엔터키를 입력 했을때 컴포넌트가 포커스 전환이 이워질 수 있도록 합니다.
   * @private
   */
  ConditionPanel.prototype._applyFocusManager = function () {
    var self = this;
    var $el = $(self._element);
    var controls = [];

    // $el.on('keydown', function (e) {
    //    if (e.keyCode === 113) {
    //        e.target.blur();
    //    }
    // });

    // 다음 포커스 대상 컨트롤을 가져옵니다.
    var getNextControl = function getNextControl(current) {
      var idx;
      var next;

      for (var i = 0; i < controls.length; i++) {
        if (controls[i].dewsObj === current) {
          idx = i;
          break;
        }
      }

      if (idx >= 0 && idx < controls.length) {
        while (!next) {
          idx++;

          if (
          controls[idx] &&
          controls[idx].dewsObj &&
          $.isFunction(controls[idx].dewsObj.canFocusable) &&
          controls[idx].dewsObj.canFocusable() &&
          controls[idx].$ul.is(":visible"))
          {
            next = controls[idx].dewsObj;
          }

          if (idx >= controls.length) {
            break;
          }
        }
      }

      return next;
    };

    // 이전 포커스 대상 컨트롤을 가져옵니다.
    var getBeforeControl = function getBeforeControl(current) {
      var idx;
      var before;

      for (var i = 0; i < controls.length; i++) {
        if (controls[i].dewsObj === current) {
          idx = i;
          break;
        }
      }

      if (idx >= 0 && idx < controls.length) {
        while (!before) {
          idx--;

          if (
          controls[idx] &&
          controls[idx].dewsObj &&
          $.isFunction(controls[idx].dewsObj.canFocusable) &&
          controls[idx].dewsObj.canFocusable() &&
          controls[idx].$ul.is(":visible"))
          {
            before = controls[idx].dewsObj;
          }

          if (idx <= -1) {
            break;
          }
        }
      }

      return before;
    };

    $el.find("*[class^=dews-ui-].dews-form-control").each(function (idx, target) {
      var $item = $(target);
      var $ul = $item.closest("ul");

      var dewsObj = $item.data("dews-control");

      if (dewsObj && $.isFunction(dewsObj.applyPanelFocus)) {
        // 각 컨트롤에 엔터키 처리를 하도록 설정합니다.
        dewsObj.applyPanelFocus(self.options.requiredCheck);

        dewsObj.on("nextFocus", function (e) {
          var next = getNextControl(e.control);

          if (next) {
            next.focus();
          } else {
            // 마지막 컨트롤에서 엔터키가 입력되면 포커스 처리가 끝났다는 이벤트를 발생시킴
            $el.trigger("lastFocus");
          }
        });

        if ($.type(dewsObj._element) !== "undefined" || $.type(dewsObj.target) !== "undefined") {
          if (
          $(dewsObj._element).hasClass("dews-ui-codepicker") ||
          $(dewsObj.target).hasClass("dews-ui-multicodepicker"))
          {
            // setData를 한 상황인지 || esc를 누르고 나간 상황인지 확인
            dewsObj.on("codedialogclosed", function (e) {
              if (dewsObj.options.moveFocus === true) {
                var next = getNextControl(dewsObj);
                if (next) {
                  if (dewsObj._focusMove === true) {
                    next.focus();
                    delete dewsObj._focusMove;
                  }
                }
              }
            });
          }
        }

        dewsObj.on("beforeFocus", function (e) {
          var before = getBeforeControl(e.control);

          if (before) {
            before.focus();
          }
        });

        controls.push({ dewsObj: dewsObj, $ul: $ul });
      }
    });
  };

  ConditionPanel.prototype.on = function () {
    var self = this;
    var $panel = $(self._element);

    switch (arguments[0]) {
      case "change":
        Array.prototype.splice.apply(arguments, [0, 1, "_change"]);
        $panel.on.apply($panel, arguments);
        break;
      default:
        $panel.on.apply($panel, arguments);
        break;}

  };

  /**
   * 컨디션패널을 작성합니다.
   * @private
   */
  ConditionPanel.prototype._render = function () {
    var self = this;

    // 컨디션패널의 래퍼인 컨테이너를 생성합니다.
    // self._createContainer();
    createPanel(self);

    // 컨디션패널 열기/닫기 버튼을 생성합니다.
    // self._createButton();
    createOptionsExpandButton(self);
  };

  /**
   * 컨디션패널의 validation 체크를 합니다.
   * @param options
   */
  ConditionPanel.prototype.validate = function (options) {
    var self = this;
    var $el = $(self._element);
    var result = true;
    var defOptions = { tooltip: true };
    var firstControlFlag = false;
    var firstControl;

    options = $.extend({}, defOptions, options);

    $el.find("*[class^=dews-ui-].dews-form-control.required").each(function (idx, target) {
      var $item = $(target);
      var dewsObj = $item.data("dews-control");
      var $ul = $item.closest("ul");
      var $li = $item.closest("li");

      if ($ul.is(":visible") && $li.is(":visible")) {
        if ($.isFunction(dewsObj.validate)) {
          if (!dewsObj.validate()) {
            // 폼패널, 컨디션패널의 validate 호출 시 검증에 걸린 첫번째 컨트롤에 포커싱
            if (dews._environments.panelValidateFocus) {
              if (!firstControlFlag) {
                firstControl = dewsObj;
                firstControlFlag = true;
              }

              if (firstControl && $.isFunction(firstControl.focus)) {
                firstControl.focus();
              }
            }

            if (options.tooltip) {
              if (options.message) {
                dews.ui.tooltip.show($item, {
                  type: "required",
                  text: options.message
                });
              } else {
                dews.ui.tooltip.show($item, {
                  type: "required"
                });
              }
            }
            result = false;
            // return result; // break 처리
          }
        }
      }
    });

    return result;
  };

  /**
   * 컨디션패널의 serialize 합니다.
   */
  ConditionPanel.prototype.serialize = function () {
    var self = this;
    var $el = $(self._element);
    var value;
    var $dfr = $.Deferred();

    $dfr.done(function () {
      $el.find("*[class^=dews-ui-][id].dews-form-control").each(function (idx, target) {
        var $item = $(target);

        var dewsObj = $item.data("dews-control");

        if (dewsObj && $.isFunction(dewsObj.serializeForPanel)) {
          var obj = dewsObj.serializeForPanel();

          if (obj) {
            value = value || {};

            $.extend(true, value, obj);
          }
        }
      });
    });

    if (self.tracked) {
      $dfr.resolve();
    } else {
      var interval = setInterval(function () {
        if (self.tracked) {
          clearInterval(interval);
          $dfr.resolve();
        }
      }, 100);
    }

    return value;
  };
  /**
   * 컨디션패널의 focus 합니다.
   */
  ConditionPanel.prototype.focus = function () {
    var self = this;
    var $el = $(self._element);
    var $dfr = $.Deferred();

    $dfr.done(function () {
      $el.find("*[class^=dews-ui-].dews-form-control").each(function (idx, target) {
        var $item = $(target);
        var $li = $item.closest("li");

        if ($li.is(":visible")) {
          var dewsObj = $item.data("dews-control");

          if (dewsObj && $.isFunction(dewsObj.canFocusable)) {
            dewsObj.focus();
            return false;
          }
        }
      });
    });

    if (self.tracked) {
      $dfr.resolve();
    } else {
      var interval = setInterval(function () {
        if (self.tracked) {
          clearInterval(interval);
          $dfr.resolve();
        }
      }, 100);
    }
  };

  /**
   * JSON 데이터로 컨디션 패널 내의 컴포넌트들에 데이터를 바인딩합니다.
   * @param data
   */
  ConditionPanel.prototype.bindData = function (data) {
    var self = this;
    var $el = self.$element;

    self.binding = true;
    if (data) {
      $el.find("*[class^=dews-ui-][id].dews-form-control").each(function (idx, target) {
        var $item = $(target);
        var dewsObj = $item.data("dews-control");
        if (dewsObj && $.isFunction(dewsObj.bindFromPanel)) {
          dewsObj.bindFromPanel(data);
        }
      });
    }
    self.binding = false;
  };

  /**
   * 그리드 등의 데이터 출력 컴포넌트에 데이터를 현재 데이터를 반영합니다.
   * @param target 그리드 등의 데이터 출력 컴포넌트
   */
  ConditionPanel.prototype.bindTo = function (target) {
    var self = this;
    var instance, data;
    if (target instanceof jQuery) {
      instance = target.data("dews-control");
    } else {
      instance = target;
    }

    if (instance && $.isFunction(instance.updateRowFromPanel)) {
      data = self.serialize();

      if (data) {
        instance.updateRowFromPanel.call(instance, data);
      }
    } else {
      console.log(
      "# ConditionPanel 의 데이터를 원본 데이터소스로 바인딩하는데 실패하였습니다. #",
      target,
      instance);

    }
  };

  /**
   * 컨디션패널에 설정된 옵션을 가져옵니다.
   * @returns {object} 옵션 설정값
   */
  ConditionPanel.prototype.getOptions = function () {
    return this.options;
  };

  /**
   * 컨디션패널에서 자동화 인쇄 관련 데이터를 가져옵니다.
   * @return {Array} 컨디션패널 내 값이 존재하는 데이터 반환
   * @private
   */
  ConditionPanel.prototype._getParamsForPrint = function () {
    var self = this,
      $el = self.$element,
      printData = [];

    $el.find("*[class^=dews-ui-].dews-form-control").each(function (idx, target) {
      var $item = $(target),
        dewsObj = $item.data("dews-control"),
        data = {};

      if (dewsObj) {
        data = dewsObj._getPrintData();

        if (data) {
          data.optional = $item.closest("ul").hasClass("required-area") ? false : true;
          data.label = $item.closest("li").find("> label").text();
          printData.push(data);
        }
      }
    });

    return printData;
  };

  ConditionPanel.prototype.raiseEvent = function (event) {
    var self = this,
      $panel = $(self._element),
      eventArray = [
      "lastFocus",
      "expanded",
      "expandedSlideComplete",
      "collapsed",
      "collapsedSlideComplete",
      "change"];


    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "change") {
          $panel.trigger("_change");
        } else {
          $panel.trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  ConditionPanel.prototype._isOneGrid = function () {
    var self = this;
    var oneGridData = dews.ui.page.onegridData;

    if (!oneGridData) {
      return false;
    }

    if (oneGridData.editable) {
      return true;
    }

    if (Array.isArray(oneGridData.items)) {var _dews$ui$dialogPage;
      var TYPE = self.$element.closest((_dews$ui$dialogPage = dews.ui.dialogPage) === null || _dews$ui$dialogPage === void 0 ? void 0 : _dews$ui$dialogPage.$content).length === 0 ? "CONDITION" : "D_CONDITION";
      var id = self.$element.attr("id");
      var item = oneGridData.items.some(function (i) {return i.type === TYPE && i.id === id;});
      return !!item;
    }
    return false;
  };

  $.extend(true, dews, {
    /**
     * @namespace
     */
    ui: {
      /**
       * 지정한 요소를 컨디션패널로 만들거나 가져옵니다.
       * @param {string|jQuery} selector 컨디션패널로 만들 셀렉터 또는 jQuery 객체
       * @param {object} options 컨디션패널 옵션
       * @returns {object|Array} 컨디션패널 인스턴스
       */
      conditionpanel: function conditionpanel(selector, options) {
        var $el, obj;

        obj = [];

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {var _conditionpanel;
          var conditionpanel,
            element = this;

          if ($(element).data("dews-control")) {
            conditionpanel = $(element).data("dews-control");
          } else {
            conditionpanel = new ConditionPanel(element, options);
            conditionpanel._render();

            $(element).data("dews-control", conditionpanel);
          }
          obj.push(conditionpanel);

          if ((_conditionpanel = conditionpanel) !== null && _conditionpanel !== void 0 && _conditionpanel._onegrid) {
            conditionpanel.onegrid = dews.ui.Onegrid(element, conditionpanel);
          }
        });

        return obj.length == 1 ? obj[0] : obj;
      }
    }
  });

  dews.ui.addControlInitializer("conditionpanel", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }
    dews.ui.conditionpanel($(".dews-ui-condition-panel, .dews-condition-panel", $container));
  });
})(jQuery, window.dews);


/*
 * 폼 패널
 */
(function ($, dews) {
  var COMPONENT_NAME = "dews-ui-form-panel";
  var COMPONENT_TYPE = "dews-container-control";
  var ACTIVATED_STATUS = "dews-control-activate";
  var DEFAULT_COLUMN_SIZE = 2;
  var MAX_COLUMN_SIZE = 4;
  var MIN_COLUMN_SIZE = 1;

  /**
   * 폼패널에 포함된 항목의 요소를 나타내는 클래스입니다.
   * @param $li 폼패널 항목이 되는 LI 요소의 JQuery 객체입니다.
   * @constructor
   */
  function PanelItem($li) {
    var self = this;
    self._$element = $li;
    self.label = self._$element.find("> label").get(0);
    self.container = self._$element.find("> span").get(0);
  }

  /**
   * 폼패널 항목의 라벨에 설정된 텍스트를 가져오거나 설정합니다.
   * @param text {string} 설정할 라벨의 텍스트 (생략하면 설정된 텍스트를 가져옵니다.)
   * @returns {string | undefined}
   */
  PanelItem.prototype.text = function (text) {
    var self = this;

    if (typeof text === "undefined") {
      return $(self.label).text();
    } else {
      $(self.label).text(text);
      setLabelTitleWhenEllipsis(self.label, text);
    }
  };

  // 기본 옵션 값
  var defaultOptions = {
    columns: DEFAULT_COLUMN_SIZE,
    labelAlign: "right"
  };

  // HTML 요소에 지정된 옵션을 JSON 형태로 가져옵니다.
  function getInlineOptions($el) {
    var options = {};
    /*
     * data-dews-columns: 컬럼 개수 (MIN_COLUMN_SIZE ~ MAX_COLUMN_SIZE) - 기본값: 3
     * data-dews-label-width: 라벨 영역의 너비 - 기본값: 스타일시트에 정의된 값
     * data-dews-item-width: 폼패널 개별 항목의 영역 너비 (라벨 너비 + 컴포넌트 영역 너비) - 기본값: 스타일시트에 정의된 값
     * data-dews-label-align: 라벨의 텍스트 정렬 방식 (left, center, right) - 기본값: right
     * data-dews-required-check: 필수 입력 항목일 경우 엔터키 입력시 다음 항목 이동 사용 여부 선택
     */

    if ($el.data("dews-columns")) {
      options.columns = parseInt($el.data("dews-columns"), 10);
    }
    if ($el.data("dews-label-width")) {
      options.labelWidth = parseInt($el.data("dews-label-width"), 10);
    }
    if ($el.data("dews-item-width")) {
      options.itemWidth = parseInt($el.data("dews-item-width"), 10);
    }
    if ($el.data("dews-label-align")) {
      options.labelAlign = $el.data("dews-label-align");
    }
    if ($el.data("dews-required-check")) {
      options.requiredCheck = $el.data("dews-required-check");
    }

    return options;
  }

  // 폼 패널을 생성합니다.
  function createPanel(panel) {
    var $form;
    var formName = "dews-form-panel-form";

    // 이미 생성되어 있다면 생성 로직을 생략
    if (panel.$element.hasClass(COMPONENT_TYPE)) {
      return;
    }

    // 기본 컴포넌트 클래스가 지정되지 않았다면 추가
    if (!panel.$element.hasClass(COMPONENT_NAME)) {
      panel.$element.addClass(COMPONENT_NAME);
    }

    if (
    panel._options.columns &&
    panel._options.columns >= MIN_COLUMN_SIZE &&
    panel._options.columns <= MAX_COLUMN_SIZE)
    {
      panel.$element.addClass("col-" + panel._options.columns.toString());
    } else {
      throw "폼패널의 컬럼 갯수가 잘못 지정되었습니다.";
    }

    // 폼 요소가 누락되어 있다면 추가함
    $form = panel.$element.find("> ." + formName);

    if ($form.length === 0) {
      // 기존 코드에는 .dews-form-panel-form 을 기본적으로 요구하였으므로 하위호환성 확보
      $form = $('<form class="' + formName + '"></form>');

      for (var i = 0; i < panel.$element.children().length;) {
        if (
        panel.$element.children().eq(i).prop("tagName") === "UL" ||
        panel.$element.children().eq(i).hasClass("dews-ui-title"))
        {
          $form.append(panel.$element.children().eq(i).detach());
        } else {
          i++;
        }
      }

      panel.$element.append($form);
    }

    $form.on("submit", function (e) {
      e.preventDefault();
    }); // Enter 키에 의한 폼 submit 방지

    panel.$element.addClass(COMPONENT_TYPE);

    panel.$element.find("ul").each(function (idx, item) {
      var $ul = $(item);
      retouchItems(panel, $ul);
    });

    // 라벨의 정렬 처리
    switch (panel._options.labelAlign) {
      case "center":
        panel.$element.find("> .dews-form-panel-form > ul > li > label").css("text-align", "center");
        break;
      case "left":
        panel.$element.find("> .dews-form-panel-form > ul > li > label").css("text-align", "left");
        break;
      case "right":
        panel.$element.find("> .dews-form-panel-form > ul > li > label").css("text-align", "right");
        break;
      default:
        break;}


    // 항목의 너비가 지정되어 있다면 컨테이너의 상태에 따라 재계산하여 설정
    if (panel._options.itemWidth) {
      var $firstItem = panel.$element.find("li").eq(0);
      var itemLeftMargin = parseInt($firstItem.css("margin-right"), 10);
      var itemRightMargin = parseInt($firstItem.css("margin-left"), 10);
      var containerPaddingLeft = parseInt($firstItem.css("padding-left"), 10);
      var containerPaddingRight = parseInt($firstItem.css("padding-right"), 10);
      var borderLeftWidth = parseInt(panel.$element.css("border-left-width"), 10);
      var borderRightWidth = parseInt(panel.$element.css("border-right-width"), 10);
      var itemGroupMinWidth =
      panel._options.itemWidth * panel._options.columns +
      (panel._options.columns - 1) * (itemLeftMargin + itemRightMargin);
      var containerMinWidth =
      itemGroupMinWidth + containerPaddingLeft + containerPaddingRight + borderLeftWidth + borderRightWidth;

      panel.$element.css({ minWidth: containerMinWidth });
      panel.$element.find("ul").css({ minWidth: itemGroupMinWidth });
    }

    // 컴포넌트 보이기
    panel.$element.addClass(ACTIVATED_STATUS);
  }

  // 폼패널 항목 아이템이 지정한 대로 출력될 수 있도록 후처리를 실시합니다.
  function retouchItems(panel, $ul) {
    var $items = $ul.children("li");
    var $items2 = $ul.children("li:not(.transparency)");
    var emptyLITemplate = '<li class="dews-form-panel-item-transparency"></li>';
    var colsRegex = /col-(\d+)\s?/;
    var options = panel._options;

    $items.each(function (idx, item) {
      var $item = $(item);
      var $empty, $label;
      var matches, cols, itemSpaceLeft, itemSpaceRight;

      // 병합된 셀이 있는지 확인하고 처리함
      matches = colsRegex.exec(item.className);
      if ($.isArray(matches) && matches[1]) {
        cols = parseInt(matches[1], 10);
        for (var i = 0; i < cols - 1; i++) {
          $empty = $(emptyLITemplate);
          $empty.addClass("transparency"); // TODO: 하위호환성을 위해 추가하였으나 범용 클래스명이므로 제거할 것
          $item.after($empty);
        }
      }

      // itemWidth 또는 labelWidth 로 너비가 지정된 경우
      // itemWidth 처리
      if (options.labelWidth) {
        itemSpaceLeft = parseInt($item.css("margin-left"));
        itemSpaceRight = parseInt($item.css("margin-right"));
        $item.css({
          width:
          options.itemWidth * (cols || 1) + (itemSpaceLeft + itemSpaceRight) * ((cols || 1) - 1) + "px"
        });
      }

      $label = $item.children("label");
      // labelWidth 처리
      if (options.labelWidth) {
        $label.css({ width: options.labelWidth + "px" });
      }
      // 라벨 문자열 다국어 적용
      if ($label) {
        $label.each(function (idx, label) {
          if ($(label).data("dews-localize-key")) {
            $(label).text(dews.localize.get($(label).text(), $(label).data("dews-localize-key")));
          }
        });
      }

      // ellipsis(말줄임표)가 적용되었는지를 판단하여 title 속성을 이용해 툴팁 제공
      if ($label.get(0)) {
        setLabelTitleWhenEllipsis($label.get(0), $label.text());
      }

      // 폼패널 항목을 items 속성에 추가
      panel.items.push(new PanelItem($item));
    });

    var sum = 0;

    $items2.each(function (idx, item) {
      var $item = $(item),
        $empty;
      var panelCols = panel.options.columns;
      // 병합이 되는 셀이 있는 지 확인하고 처리합니다.
      var matches = colsRegex.exec(item.className);

      if ($.isArray(matches) && matches[1]) {
        var cols = parseInt(matches[1], 10);
      } else {
        cols = 1;
      }

      var beforeSum = sum;
      sum = sum + cols;

      if (sum === panelCols) {
        sum = 0;
      } else if (sum > panelCols) {
        for (var j = 0; j < panelCols - beforeSum; j++) {
          $empty = $(emptyLITemplate);
          $empty.addClass("transparency");
          $item.before($empty);
        }

        sum = cols;
      }
    });
  }

  // 라벨에 설정하는 텍스트의 길이가 라벨의 길이보다 길 경우 title 속성으로 툴팁이 나올 수 있도록 합니다.
  function setLabelTitleWhenEllipsis(label, text) {
    if (label && label.scrollWidth) {
      if (label.scrollWidth > label.offsetWidth) {
        $(label).attr("title", text);
      } else {
        $(label).removeAttr("title");
      }
    }
  }

  /**
   * 폼패널을 생성하기 위한 클래스
   * @param $element {JQuery} 폼패널 생성 대상 요소
   * @param options 폼패널 옵션
   * @constructor
   */
  function FormPanel($element, options) {
    var self = this;

    // 대상 요소 지정
    self.$element = $element;

    // 생성 옵션 결정
    var inlineOptions = getInlineOptions(self.$element);
    self.options = $.extend({}, defaultOptions, inlineOptions, options);
    self._options = $.extend(true, {}, self.options);

    // 개별요소에 대한 접근
    self.items = [];
    self.listItems = self.items; // 하위호환성을 위해서 listItems 로도 items 를 노출
    self.items.getById = function (id) {
      // 아이디를 이용하여 개별항목 가져오기
      var result;

      $.each(self.items, function (idx, item) {
        if (item._$element.attr("id") === id) {
          result = item;
          return false;
        }
      });

      return result;
    };

    self.tracked = false;
    self._onegrid = this._isOneGrid();

    self._bindEvent();

    dews.ready(function () {
      if (!self.tracked) {
        self._trackChanges();
        self._applyFocusManager();
        self.tracked = true;
      }
    });

    // 폼패널 생성
    createPanel(self);

    return self;
  }

  FormPanel.prototype._bindEvent = function () {
    var self = this;

    self.$element.on("mouseenter", "label", function (e) {
      var targetLabel = e.currentTarget;
      if (targetLabel.scrollWidth > targetLabel.offsetWidth) {
        if (!$(targetLabel).attr("title")) {
          $(targetLabel).attr("title", targetLabel.innerText);
        }
      }
    });
  };

  /**
   * 내부 컴포넌트들 내부에서 change 이벤트가 발생하면 폼패널에서도 change 이벤트가 발생하도록 처리합니다.
   * @private
   */
  FormPanel.prototype._trackChanges = function () {
    var self = this;
    var $el = self.$element;
    var evt;

    $el.find("*[class^=dews-ui-].dews-form-control").each(function (idx, target) {
      var $item = $(target);

      var dewsObj = $item.data("dews-control");

      if (dewsObj && $.isFunction(dewsObj.on)) {
        // 컨트롤의 change 이벤트를 중계하도록 합니다.
        dewsObj.on("change", function () {
          // 데이터에 대한 바인딩이 일어나는 중이 아니라 컨트롤에서 변경이 일어날 경우에만 이벤트를 발생시킨다.
          if (!self.binding) {
            evt = new $.Event("_change");
            evt.source = dewsObj;
            evt.$source = $item;
            $el.trigger(evt);
          }
        });
      }
    });
  };

  /**
   * 내부 컴포넌트에서 엔터키를 입력했을때 컴포넌트가 포커스 전환이 이워질 수 있도록 합니다.
   * @private
   */
  FormPanel.prototype._applyFocusManager = function () {
    var self = this;
    var $el = self.$element;
    var controls = [];

    // 다음 포커스 대상 컨트롤을 가져옵니다.
    var getNextControl = function getNextControl(current) {
      var idx = controls.indexOf(current);
      var next;

      if (idx >= 0 && idx < controls.length) {
        while (!next) {
          idx++;

          if (controls[idx] && $.isFunction(controls[idx].canFocusable) && controls[idx].canFocusable()) {
            next = controls[idx];
          }

          if (idx >= controls.length) {
            break;
          }
        }
      }

      return next;
    };

    // 이전 포커스 대상 컨트롤을 가져옵니다.
    var getBeforeControl = function getBeforeControl(current) {
      var idx = controls.indexOf(current);
      var before;

      if (idx >= 0 && idx < controls.length) {
        while (!before) {
          idx--;

          if (controls[idx] && $.isFunction(controls[idx].canFocusable) && controls[idx].canFocusable()) {
            before = controls[idx];
          }

          if (idx <= -1) {
            break;
          }
        }
      }

      return before;
    };

    $el.find("*[class^=dews-ui-].dews-form-control").each(function (idx, target) {
      var $item = $(target);

      var dewsObj = $item.data("dews-control");

      if (dewsObj && $.isFunction(dewsObj.applyPanelFocus)) {
        // 각 컨트롤에 엔터키 처리를 하도록 설정합니다.
        dewsObj.applyPanelFocus(self.options.requiredCheck);

        dewsObj.on("nextFocus", function (e) {
          var next = getNextControl(e.control);

          if (next) {
            next.focus();
          } else {
            // 마지막 컨트롤에서 엔터키가 입력되면 포커스 처리가 끝났다는 이벤트를 발생시킴
            $el.trigger("lastFocus");
          }
        });

        if ($.type(dewsObj._element) !== "undefined" || $.type(dewsObj.target) !== "undefined") {
          if (
          $(dewsObj._element).hasClass("dews-ui-codepicker") ||
          $(dewsObj.target).hasClass("dews-ui-multicodepicker"))
          {
            // setData를 한 상황인지 || esc를 누르고 나간 상황인지 확인
            dewsObj.on("codedialogclosed", function (e) {
              if (dewsObj.options.moveFocus === true) {
                var next = getNextControl(dewsObj);
                if (next) {
                  if (dewsObj._focusMove === true) {
                    next.focus();
                    delete dewsObj._focusMove;
                  }
                }
              }
            });
          }
        }

        dewsObj.on("beforeFocus", function (e) {
          var before = getBeforeControl(e.control);

          if (before) {
            before.focus();
          }
        });
        controls.push(dewsObj);
      }
    });
  };

  FormPanel.prototype.on = function () {
    var self = this;
    var $panel = self.$element;

    switch (arguments[0]) {
      case "change":
        Array.prototype.splice.apply(arguments, [0, 1, "_change"]);
        $panel.on.apply($panel, arguments);
        break;
      default:
        $panel.on.apply($panel, arguments);
        break;}

  };

  /**
   * 폼패널의 validation 체크를 합니다.
   * @param options
   */
  FormPanel.prototype.validate = function (options) {
    var self = this;
    var $el = self.$element;
    var result = true;
    var defOptions = { tooltip: true };
    var isElementVisible = $el.is(":visible");
    var firstControlFlag = false;
    var firstControl;

    options = $.extend({}, defOptions, options);

    $el.find("*[class^=dews-ui-].dews-form-control").each(function (idx, target) {
      var $item = $(target);
      var dewsObj = $item.data("dews-control");
      var isRequiredControl = $item.hasClass("required");

      if (
      dewsObj && (
      $.isFunction(dewsObj.hasValidationHandler) && dewsObj.hasValidationHandler() || isRequiredControl) &&
      $.isFunction(dewsObj._visibleCheckFromPanel) &&
      dewsObj._visibleCheckFromPanel())
      {
        if ($.isFunction(dewsObj.validate)) {
          var validationResult = dewsObj.validate();
          if (!validationResult) {
            if (isElementVisible && isRequiredControl && options.tooltip) {
              // 폼패널, 컨디션패널의 validate 호출 시 검증에 걸린 첫번째 컨트롤에 포커싱
              if (dews._environments.panelValidateFocus) {
                if (!firstControlFlag) {
                  firstControl = dewsObj;
                  firstControlFlag = true;
                }

                if (firstControl && $.isFunction(firstControl.focus)) {
                  firstControl.focus();
                }
              }

              if (options.message) {
                dews.ui.tooltip.show($item, {
                  type: "required",
                  text: options.message
                });
              } else {
                dews.ui.tooltip.show($item, {
                  type: "required"
                });
              }
            }
            result = false;
          }
        }
      }
    });

    return result;
  };

  /**
   * 폼패널의 컨트롤 들의 데이터를 serialize 합니다.
   */
  FormPanel.prototype.serialize = function () {
    var self = this;
    var $el = self.$element;
    var value;

    $el.find("*[class^=dews-ui-][id].dews-form-control").each(function (idx, target) {
      var $item = $(target);
      var dewsObj = $item.data("dews-control");

      if (dewsObj && $.isFunction(dewsObj.serializeForPanel)) {
        var obj = dewsObj.serializeForPanel();

        if (obj) {
          value = value || {};

          $.extend(true, value, obj);
        }
      }
    });

    return value;
  };

  /**
   * 폼 패널에 포커스를 설정합니다.
   */
  FormPanel.prototype.focus = function () {
    var self = this;
    var $el = self.$element;

    $el.find("*[class^=dews-ui-].dews-form-control").each(function (idx, target) {
      var $item = $(target);
      var $li = $item.closest("li");

      if ($li.is(":visible")) {
        var dewsObj = $item.data("dews-control");

        if (dewsObj && $.isFunction(dewsObj.canFocusable)) {
          dewsObj.focus();
          return false;
        }
      }
    });
  };

  /**
   * JSON 데이터로 폼 패널 내의 컴포넌트 들에 데이터를 바인딩 합니다.
   * @param data
   */
  FormPanel.prototype.bindData = function (data) {
    var self = this;
    var $el = self.$element;

    self.binding = true; // 바인딩 중

    if (data) {
      $el.find("*[class^=dews-ui-][id].dews-form-control").each(function (idx, target) {
        var $item = $(target);

        var dewsObj = $item.data("dews-control");

        if (dewsObj && $.isFunction(dewsObj.bindFromPanel)) {
          dewsObj.bindFromPanel(data);
        }
      });
    }

    self.binding = false; // 바인딩 끝
  };

  /**
   * 그리드 등의 데이터 출력 컴포넌트에 데이터를 현재 데이터를 반영합니다.
   * @param target 그리드 등의 데이터 출력 컴포넌트
   */
  FormPanel.prototype.bindTo = function (target) {
    var self = this;
    var instance, data;

    if (target instanceof jQuery) {
      instance = target.data("dews-control");
    } else {
      instance = target;
    }

    if (instance && $.isFunction(instance.updateRowFromPanel)) {
      data = self.serialize();

      if (data) {
        instance.updateRowFromPanel.call(instance, data);
      }
    } else {
      console.log("# FormPanel 의 데이터를 원본 데이터소스로 바인딩하는데 실패하였습니다. #", target, instance);
    }
  };

  // 이전 API 호환을 위해 남겨둠
  FormPanel.prototype.bindGrid = function (grid) {
    this.bindTo(grid);
  };

  // 이전 API 호환을 위해 남겨둠
  FormPanel.prototype.bindCardList = function (cardlist) {
    this.bindTo(cardlist);
  };

  FormPanel.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change", "lastFocus"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "change") {
          self.$element.trigger("_change");
        } else {
          self.$element.trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  FormPanel.prototype._isOneGrid = function () {
    var self = this;
    var isOneGrid = false;
    var oneGridData = dews.ui.page.onegridData;
    var id = self.$element.attr("id");
    if (oneGridData) {var _dews$ui$dialogPage2;
      var TYPE = self.$element.closest((_dews$ui$dialogPage2 = dews.ui.dialogPage) === null || _dews$ui$dialogPage2 === void 0 ? void 0 : _dews$ui$dialogPage2.$content).length === 0 ? "FORM" : "D_FORM";

      if (oneGridData.editable) {
        isOneGrid = true;
      } else {
        if (Array.isArray(oneGridData.items)) {
          var item = oneGridData.items.some(function (oneGridItems) {
            return oneGridItems.type === TYPE && oneGridItems.id === id;
          });
          if (item) {
            isOneGrid = true;
          }
        }
      }
    }
    return isOneGrid;
  };

  dews = $.extend(true, dews, {
    ui: {
      formpanel: function formpanel(selector) {
        var $panel, panel;

        if (selector instanceof jQuery) {
          $panel = selector;
        } else if ($.type(selector) === "string") {
          $panel = $(selector);
        } else {
          throw "대상이 지정되지 않았습니다.";
        }

        $panel.each(function () {
          var $ctrl = $(this);
          var element = this;

          panel = $ctrl.data("dews-control");

          if (!panel) {
            panel = new FormPanel($ctrl);

            if (!$ctrl.hasClass("dews-ui-form-panel")) {
              $ctrl.addClass("dews-ui-form-panel");
            }
            if (!$ctrl.hasClass("dews-form-panel")) {
              $ctrl.addClass("dews-form-panel");
            }

            $ctrl.data("dews-control", panel);

            if (panel._onegrid) {
              panel.onegrid = dews.ui.Onegrid(element, panel);
            }
          }
        });

        return panel;
      }
    }
  });

  dews.ui.addControlInitializer("formpanel", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    // TODO: dews-form-panel 로만 초기화하도록 되어 있어 추가하였으나 dews-ui-form-panel 로만 초기화 시켜도록 변경되어야 함
    dews.ui.formpanel($("div.dews-form-panel, div.dews-ui-form-panel", $container));
  });
})(jQuery, window.dews || {});


(function () {
  // src/js/dataSource/BaseDataProvider.js
  var BaseDataProvider = /*#__PURE__*/function () {"use strict";
    function BaseDataProvider(dataProvider, options) {_classCallCheck(this, BaseDataProvider);
      var self = this;
      var opt;
      opt = this.setDataSourceOptions(options);
      opt.rollback = dataProvider.savePoint();
      dataProvider.setFields(opt.field);
      dataProvider.setOptions(opt);
      self.dataProvider = dataProvider;
      self.options = opt;
      self.id = opt.id;
    }_createClass(BaseDataProvider, [{ key: "setDataSourceOptions", value:
      function setDataSourceOptions(options) {
        var UUIDFlag = false;
        var opt = options;
        if (opt.schema && opt.schema.model.fields) {
          var field = [];
          for (var i = 0; i < opt.schema.model.fields.length; i += 1) {
            if (opt.schema.model.fields[i].fieldName === "__UUID") {
              UUIDFlag = true;
            }
            opt.schema.model.fields[i].fieldName = opt.schema.model.fields[i].field;
            if (opt.schema.model.fields[i].type) {
              if (opt.schema.model.fields[i].type.toLowerCase() === "string") {
                opt.schema.model.fields[i].dataType = "text";
                delete opt.schema.model.fields[i].type;
              } else {
                opt.schema.model.fields[i].dataType = opt.schema.model.fields[i].type;
              }
            } else if (!opt.schema.model.fields[i].dataType) {
              opt.schema.model.fields[i].dataType = "text";
            }
            if (opt.schema.model.fields[i].dataType.toLowerCase() === "string") {
              opt.schema.model.fields[i].dataType = "text";
            }
            field.push(opt.schema.model.fields[i]);
          }
          if (!UUIDFlag) {
            field.splice(0, 0, {
              field: "__UUID",
              fieldName: "__UUID",
              dataType: "text"
            });
          }
          opt.schema.model.fields = opt.field = field;
        }
        return opt;
      } }, { key: "removeLineDataSources", value:
      function removeLineDataSources(dataSource) {
        if (dataSource.options.master) {
          for (var i = 0; i < Object.keys(dataSource.options.master).length; i += 1) {
            dataSource.options.master[Object.keys(dataSource.options.master)[i]].options.lineDataSources = {};
            if (dataSource.options.master[Object.keys(dataSource.options.master)[i]]) {
              this.removeLineDataSources(dataSource.options.master[Object.keys(dataSource.options.master)[i]]);
            }
          }
        }
      } }, { key: "at", value:
      function at(row) {
        return this.dataProvider.getJsonRow(row);
      } }, { key: "setOptions", value:
      function setOptions(options) {
        var self = this,opt;
        opt = $.extend(true, this.options, options);
        self.options = opt;
        self.dataProvider.setOptions(opt);
      } }, { key: "setFields", value:
      function setFields(fields) {
        var self = this;
        self.options.schema.model.fields = fields;
        self.options = this.setDataSourceOptions(self.options);
        self.dataProvider.setFields([]);
        self.dataProvider.setFields(self.options.field);
      } }, { key: "hasDirty", value:
      function hasDirty(target) {
        var self = this,range = true,result = false;
        if ($.type(target) === "boolean") {
          range = target;
        }
        if (range) {
          if ($.type(self.options.detailDataSource) !== "undefined") {
            result = self.options.detailDataSource.hasDirty(range);
            if (result) {
              return result;
            } else if (self.getDirtyDataCount() > 0) {
              result = true;
            }
          } else {
            if (self.getDirtyDataCount() > 0) {
              result = true;
            }
          }
        } else {
          if (self.getDirtyDataCount() > 0) {
            result = true;
          }
        }
        return result;
      } }, { key: "getParentData", value:
      function getParentData() {
        var self = this;
        if (self.options.detail) {
          var masterDataSource,master_uid,master_data = [],rowData;
          masterDataSource = self.options.masterDataSource;
          master_uid = self.options._muid;
          if (masterDataSource.options.detail && masterDataSource.options.lineDataSources) {
            var masterLineDataSources = Object.values(masterDataSource.options.lineDataSources);
            for (var inx = 0; inx < masterLineDataSources.length; inx++) {
              master_data = master_data.concat(masterLineDataSources[inx].data());
            }
          } else {
            master_data = masterDataSource.data();
          }
          for (var i = 0; i < master_data.length; i++) {
            if (master_uid === master_data[i]._uid) {
              rowData = master_data[i];
              break;
            }
          }
          return rowData;
        }
      } }, { key: "getUpdatedCells", value:
      function getUpdatedCells(dataIndex) {
        var self = this;
        return self.dataProvider.getUpdatedCells(dataIndex);
      } }, { key: "isDataLoading", value:
      function isDataLoading() {
        var self = this,result = false;
        if (self.options.loadingData) {
          result = true;
        }
        return result;
      } }]);return BaseDataProvider;}();


  // src/js/dataSource/DataProvider.js
  var DataProvider = /*#__PURE__*/function (_BaseDataProvider) {"use strict";_inherits(DataProvider, _BaseDataProvider);var _super = _createSuper(DataProvider);
    function DataProvider(options) {_classCallCheck(this, DataProvider);
      var dataProvider = new RealGridJS.LocalDataProvider();return _super.call(this,
      dataProvider, options);
    }_createClass(DataProvider, [{ key: "setDataSourceOptions", value:
      function setDataSourceOptions(options) {
        var defaultOptions = {
          _destroy: [],
          params: "",
          restoreMode: "auto",
          async: true,
          paging: false,
          pagingType: "background",
          pagingCount: 1e3
        };
        if (typeof (options === null || options === void 0 ? void 0 : options.paging) === "string") {
          options.pagingType = options.paging;
          options.paging = true;
        }
        var opt = $.extend(true, defaultOptions, options);
        return _get(_getPrototypeOf(DataProvider.prototype), "setDataSourceOptions", this).call(this, opt);
      } }, { key: "saveAll", value:
      function saveAll(url, options, encode) {
        var self = this,opt,data,batchData,dfr = $.Deferred();
        data = self.dataProvider.getJsonRows(0, -1);
        batchData = {};
        batchData[self.options.id] = data;
        opt = $.extend(
        true,
        {},
        {
          type: "POST",
          data: { rows: JSON.stringify(batchData) }
        },
        options);

        dews.api.post(url, opt, encode).done(function (result) {
          if (self.options.lineDataSources) {
            $.each(self.options.lineDataSources, function (idx, item) {
              item.options._destroy = [];
              item.dataProvider.clearRowStates();
            });
          } else {
            self.options._destroy = [];
            self.dataProvider.clearRowStates();
          }
          dfr.resolve(result);
        }).fail(function (jqXHR, status, msg, data2) {
          dfr.reject(msg);
        });
        return dfr;
      } }, { key: "read", value:
      function read() {var _options$transport;
        var self = this,options = self.options,url = (_options$transport = options.transport) === null || _options$transport === void 0 ? void 0 : _options$transport.read.url,deferred = $.Deferred();
        options._destroy = [];
        this.removeLineDataSources(self);
        if (url) {
          request();
        } else if (options.data) {
          bindLocalData();
        }
        return deferred.promise();
        function getParameter() {
          var data = self.options.transport.read.data;
          var param = typeof data === "function" ? data() : data !== null && data !== void 0 ? data : "";
          if (self.options.paging) {
            if (param === "") {
              param = {};
            }
            if (typeof self.options.index === "undefined") {
              self.options.index = 0;
              self.options.pagingStart = 0;
            }
            param.paging = true;
            param.pagingStart = parseInt(self.options.pagingStart);
            param.pagingCount = parseInt(self.options.pagingCount);
            if (param.pagingStart === 0) {
              self.options.index = 0;
              delete self.options.pagingScrollEnd;
            }
          }
          return param;
        }
        function getUrl() {
          return typeof url === "function" ? url.call(self) : url;
        }
        function isEncode() {
          var encode;
          if (!self.options._isEncode || $.type(self.options.transport.read.data) === "function") {
            encode = self.options.transport.read.encode;
          }
          return encode;
        }
        function request() {
          var type = self.options.transport.read.type;
          var method = type ? type.toLowerCase() : "get";
          var data = getParameter();
          var url2 = getUrl();
          var encode = isEncode();
          self.options.loadingData = true;
          dews.api[method](url2, { data: data, async: self.options.async }, encode).done(function (result, state, json, resultAll) {
            self.dataSourceRead(self, result, data, resultAll);
            deferred.resolve();
          }).fail(function (e) {
            if (self.options.error && $.type(self.options.error) === "function") {
              self.options.error.call(self, e.responseJSON);
            }
            delete self.options.loadingData;
            deferred.reject.apply(deferred, e.responseJSON);
          }).always(function () {
            self.options._isEncode = true;
          });
        }
        function bindLocalData() {
          self.dataProvider.clearRowStates();
          self.dataProvider.setRows(self.options.data);
          self.options.rollback = self.dataProvider.savePoint();
          deferred.resolve();
        }
      } }, { key: "dataSourceRead", value:
      function dataSourceRead(self, result, data, resultAll) {
        if ($.type(result) === "object" && result.hasOwnProperty("data")) {
          self.options.data = result.data;
        } else {
          self.options.data = result;
        }
        if (data.paging) {
          if (resultAll && resultAll.hasOwnProperty("current")) {
            self.options.pagingStart = parseInt(resultAll.current) + 1;
            if (resultAll.hasOwnProperty("total") && resultAll.total) {
              self.options.totalCount = parseInt(resultAll.total);
            }
            self.options.totalLength = Math.ceil(self.options.totalCount / self.options.pagingCount);
          }
          if (self.options.index === 0 || self.options.pagingType === "scroll" && $.type(self.options.bottom) === "undefined") {
            self.dataProvider.clearRows();
          }
          self.dataProvider.beginUpdate();
          self.dataProvider.addRows(self.options.data);
          self.dataProvider.clearRowStates();
          self.options.rollback = self.dataProvider.savePoint();
          self.dataProvider.endUpdate();
          if (self.options.pagingType === "scroll" && self.options.totalLength - 1 === self.options.index) {
            self.options.pagingScrollEnd = true;
          }
          if (self.options.index === self.options.totalLength - 1 || self.options.totalLength === 0) {
            delete self.options.index;
            delete self.options.totalLength;
            delete self.options.loadingData;
            delete self.options.totalCount;
            delete self.options.pagingStart;
          } else if (self.options.pagingType === "background") {
            self.options.index++;
            self.read();
          } else {
            self.options.index++;
            delete self.options.loadingData;
            delete self.options.bottom;
          }
        } else {
          delete self.options.loadingData;
          self.dataProvider.clearRowStates();
          self.dataProvider.setRows(self.options.data);
          self.options.rollback = self.dataProvider.savePoint();
        }
      } }, { key: "getDirtyData", value:
      function getDirtyData() {
        var self = this,currentData = {
            Added: [],
            Updated: [],
            Deleted: []
          },i,j,k,l;
        if (self.dataProvider.getStateRows("created")) {
          for (i = 0; i < self.dataProvider.getStateRows("created").length; i += 1) {
            currentData.Added.push(self.dataProvider.getJsonRow(self.dataProvider.getStateRows("created")[i]));
          }
        }
        if (self.dataProvider.getStateRows("updated")) {
          for (j = 0; j < self.dataProvider.getStateRows("updated").length; j += 1) {
            currentData.Updated.push(self.dataProvider.getJsonRow(self.dataProvider.getStateRows("updated")[j]));
          }
        }
        for (k = 0; k < self.options._destroy.length; k += 1) {
          currentData.Deleted.push(self.options._destroy[k]);
        }
        if (self.options.detail && self.options.lineDataSources) {
          for (l = 0; l < Object.keys(self.options.lineDataSources).length; l += 1) {
            var lineDataSource = self.options.lineDataSources[Object.keys(self.options.lineDataSources)[l]];
            if (lineDataSource.dataProvider.getStateRows("created")) {
              for (i = 0; i < lineDataSource.dataProvider.getStateRows("created").length; i += 1) {
                var create = lineDataSource.dataProvider.getJsonRow(
                lineDataSource.dataProvider.getStateRows("created")[i]);

                create._huid = Object.keys(self.options.lineDataSources)[l];
                currentData.Added.push(create);
              }
            }
            if (lineDataSource.dataProvider.getStateRows("updated")) {
              for (j = 0; j < lineDataSource.dataProvider.getStateRows("updated").length; j += 1) {
                var update = lineDataSource.dataProvider.getJsonRow(
                lineDataSource.dataProvider.getStateRows("updated")[j]);

                update._huid = Object.keys(self.options.lineDataSources)[l];
                currentData.Updated.push(update);
              }
            }
            for (k = 0; k < lineDataSource.options._destroy.length; k += 1) {
              var del = lineDataSource.options._destroy[k];
              del._huid = Object.keys(self.options.lineDataSources)[l];
              currentData.Deleted.push(del);
            }
          }
        }
        return currentData;
      } }, { key: "getDirtyDataCount", value:
      function getDirtyDataCount() {
        var self = this,count = 0,i,j,k,l;
        if (self.dataProvider.getStateRows("created")) {
          for (i = 0; i < self.dataProvider.getStateRows("created").length; i += 1) {
            count += 1;
          }
        }
        if (self.dataProvider.getStateRows("updated")) {
          for (j = 0; j < self.dataProvider.getStateRows("updated").length; j += 1) {
            count += 1;
          }
        }
        for (k = 0; k < self.options._destroy.length; k += 1) {
          count += 1;
        }
        if (self.options.detail && self.options.lineDataSources) {
          for (l = 0; l < Object.keys(self.options.lineDataSources).length; l += 1) {
            var lineDataSource = self.options.lineDataSources[Object.keys(self.options.lineDataSources)[l]];
            if (lineDataSource.dataProvider.getStateRows("created")) {
              for (i = 0; i < lineDataSource.dataProvider.getStateRows("created").length; i += 1) {
                count += 1;
              }
            }
            if (lineDataSource.dataProvider.getStateRows("updated")) {
              for (j = 0; j < lineDataSource.dataProvider.getStateRows("updated").length; j += 1) {
                count += 1;
              }
            }
            for (k = 0; k < lineDataSource.options._destroy.length; k += 1) {
              count += 1;
            }
          }
        }
        return count;
      } }, { key: "batchSave", value:
      function batchSave(url, options, encode) {
        var self = this,data,opt,batchData,dfr = $.Deferred();
        data = self.getDirtyData();
        batchData = {};
        batchData[self.options.id] = data;
        opt = $.extend(
        true,
        {},
        {
          type: "POST",
          data: { rows: JSON.stringify(batchData) }
        },
        options);

        dews.api.post(url, opt, encode).done(function (result) {
          if (self.options.lineDataSources) {
            $.each(self.options.lineDataSources, function (idx, item) {
              item.options._destroy = [];
              item.dataProvider.clearRowStates();
            });
          } else {
            self.options._destroy = [];
            self.dataProvider.clearRowStates();
          }
          dfr.resolve(result);
        }).fail(function (jqXHR, status, msg, data2) {
          dfr.reject(msg);
        });
        return dfr;
      } }, { key: "data", value:
      function data(_data) {
        var self = this;
        if (_data) {
          self.options.data = _data;
          self.dataProvider.setRows(self.options.data);
          self.options.rollback = self.dataProvider.savePoint();
          self.options._destroy = [];
        } else {
          return self.dataProvider.getJsonRows(0, -1);
        }
      } }, { key: "add", value:
      function add(value) {
        this.dataProvider.addRow(value);
      } }, { key: "insert", value:
      function insert(row, value) {
        this.dataProvider.insertRow(row, value);
      } }, { key: "remove", value:
      function remove(row) {
        this.dataProvider.removeRow(row);
      } }, { key: "get", value:
      function get(value) {
        var self = this,data = self.data(),dataItem = [],id = "";
        if (self.options.schema && self.options.schema.model && self.options.schema.model.id) {
          id = self.options.schema.model.id;
        }
        if (id) {
          for (var i = 0; i < data.length; i += 1) {
            if (data[i][id] === value) {
              dataItem = data[i];
              break;
            }
          }
        }
        return dataItem;
      } }, { key: "_dataChange", value:
      function _dataChange(page) {
        var self = this,parameter = {
            dataSource: self,
            isChange: false
          },event = new $.Event("dataChange", parameter);
        self.options._dataChange = true;
        self.dataProvider.onRowDeleted = function () {
          if (self.hasDirty(true)) {
            event.isChange = true;
          } else {
            event.isChange = false;
          }
          if ($.type(arguments[0]) === "boolean") {
            event.isChange = arguments[0];
          }
          page.$content.trigger(event);
        };
        self.dataProvider.onRowInserted = function () {
          if (self.hasDirty(true)) {
            event.isChange = true;
          } else {
            event.isChange = false;
          }
          if ($.type(arguments[0]) === "boolean") {
            event.isChange = arguments[0];
          }
          page.$content.trigger(event);
        };
        self.dataProvider.onRowUpdated = function () {
          if (self.hasDirty(true)) {
            event.isChange = true;
          } else {
            event.isChange = false;
          }
          if ($.type(arguments[0]) === "boolean") {
            event.isChange = arguments[0];
          }
          page.$content.trigger(event);
        };
        self.dataProvider.onRowStatesCleared = function () {
          if (self.hasDirty(true)) {
            event.isChange = true;
          } else {
            event.isChange = false;
          }
          if ($.type(arguments[0]) === "boolean") {
            event.isChange = arguments[0];
          }
          page.$content.trigger(event);
        };
      } }, { key: "_detailDataChange", value:
      function _detailDataChange() {
        var self = this;
        self.options._dataChange = true;
        self.dataProvider.onRowDeleted = function () {
          if (self.options.parentDataSource) {
            self.options.parentDataSource.dataProvider.onRowDeleted.call(self.options.parentDataSource);
          } else {
            if (self.getDirtyDataCount() > 0) {
              if (self.options.masterDataSource.options.grid) {
                self.options.masterDataSource.dataProvider.onRowDeleted.call(
                self.options.masterDataSource,
                true);

              } else {
                self.options.masterDataSource.trigger("change", true);
              }
            } else {
              if (self.options.masterDataSource.options.grid) {
                self.options.masterDataSource.dataProvider.onRowDeleted.call(self.options.masterDataSource);
              } else {
                self.options.masterDataSource.trigger("change");
              }
            }
          }
        };
        self.dataProvider.onRowUpdated = function () {
          if (self.options.parentDataSource) {
            self.options.parentDataSource.dataProvider.onRowUpdated.call(self.options.parentDataSource);
          } else {
            if (self.getDirtyDataCount() > 0) {
              if (self.options.masterDataSource.options.grid) {
                self.options.masterDataSource.dataProvider.onRowUpdated.call(
                self.options.masterDataSource,
                true);

              } else {
                self.options.masterDataSource.trigger("change", true);
              }
            } else {
              if (self.options.masterDataSource.options.grid) {
                self.options.masterDataSource.dataProvider.onRowUpdated.call(self.options.masterDataSource);
              } else {
                self.options.masterDataSource.trigger("change");
              }
            }
          }
        };
        self.dataProvider.onRowInserted = function () {
          if (self.options.parentDataSource) {
            self.options.parentDataSource.dataProvider.onRowInserted.call(self.options.parentDataSource);
          } else {
            if (self.getDirtyDataCount() > 0) {
              if (self.options.masterDataSource.options.grid) {
                self.options.masterDataSource.dataProvider.onRowInserted.call(
                self.options.masterDataSource,
                true);

              } else {
                self.options.masterDataSource.trigger("change", true);
              }
            } else {
              if (self.options.masterDataSource.options.grid) {
                self.options.masterDataSource.dataProvider.onRowInserted.call(self.options.masterDataSource);
              } else {
                self.options.masterDataSource.trigger("change");
              }
            }
          }
        };
        self.dataProvider.onRowStatesCleared = function () {
          if (self.options.parentDataSource) {
            self.options.parentDataSource.dataProvider.onRowStatesCleared.call(self.options.parentDataSource);
          } else {
            if (self.getDirtyDataCount() > 0) {
              if (self.options.masterDataSource.options.grid) {
                if ($.type(self.options.masterDataSource.dataProvider.onRowStatesCleared) !== "undefined") {
                  self.options.masterDataSource.dataProvider.onRowStatesCleared.call(
                  self.options.masterDataSource,
                  true);

                } else {
                  self.options.masterDataSource.dataProvider.onRowStatesChanged.call(
                  self.options.masterDataSource,
                  true);

                }
              } else {
                self.options.masterDataSource.trigger("change", true);
              }
            } else {
              if (self.options.masterDataSource.options.grid) {
                if ($.type(self.options.masterDataSource.dataProvider.onRowStatesCleared) !== "undefined") {
                  self.options.masterDataSource.dataProvider.onRowStatesCleared.call(
                  self.options.masterDataSource);

                } else {
                  self.options.masterDataSource.dataProvider.onRowStatesChanged.call(
                  self.options.masterDataSource);

                }
              } else {
                self.options.masterDataSource.trigger("change");
              }
            }
          }
        };
      } }]);return DataProvider;}(BaseDataProvider);


  // src/js/dataSource/DevDataSource.js
  function DevDataSource(options) {
    var self = this,opt;
    var devDataSource;
    var storeData = [];
    var defaultOpt = {
      store: storeData
    };
    opt = $.extend(true, defaultOpt, options);
    devDataSource = new DevExpress.data.PivotGridDataSource(opt);
    self.devDataSource = devDataSource;
    self.options = opt;
    self.id = opt.id;
    return self;
  }
  DevDataSource.prototype.read = function () {
    var self = this,data = "",url;
    if (self.options.transport && self.options.transport.read.url) {
      if (self.options.transport.read.data) {
        data = $.type(self.options.transport.read.data) === "function" ? self.options.transport.read.data() : self.options.transport.read.data;
      }
      if ($.type(self.options.transport.read.url) === "function") {
        url = self.options.transport.read.url.call(self);
      } else {
        url = self.options.transport.read.url;
      }
      if ($.type(self.options.transport.read.type) === "undefined" || self.options.transport.read.type.toLowerCase() === "get") {
        dews.api.get(url, {
          data: data,
          async: self.options.async
        }).done(function (result) {
          if ($.type(result) === "object" && result.hasOwnProperty("data")) {
            self.options.data = result.data;
          } else {
            self.options.data = result;
          }
          self.devDataSource._store._dataSource._store._array = self.options.data;
          self.devDataSource.reload();
        }).fail(function (e, xhr) {
          if (self.options.error && $.type(self.options.error) === "function") {
            self.options.error.call(self, e.responseJSON);
          }
        });
      } else {
        dews.api.post(url, {
          data: data,
          async: self.options.async
        }).done(function (result) {
          if ($.type(result) === "object" && result.hasOwnProperty("data")) {
            self.options.data = result.data;
          } else {
            self.options.data = result;
          }
          self.devDataSource._store._dataSource._store._array = self.options.data;
          self.devDataSource.reload();
        }).fail(function (e, xhr) {
          if (self.options.error && $.type(self.options.error) === "function") {
            self.options.error.call(self, e.responseJSON);
          }
        });
      }
    } else if (self.options.data) {
      self.devDataSource._store._dataSource._store._array = self.options.data;
      self.devDataSource.reload();
    }
  };
  DevDataSource.prototype.get = function (value) {
    var self = this,data = self.data(),dataItem = [],id = "";
    if (self.options.schema && self.options.schema.model && self.options.schema.model.id) {
      id = self.options.schema.model.id;
    }
    if (id) {
      for (var i = 0; i < data.length; i += 1) {
        if (data[i][id] === value) {
          dataItem = data[i];
          break;
        }
      }
    }
    return dataItem;
  };
  DevDataSource.prototype.data = function (data) {
    var self = this;
    if (data) {
      self.options.data = data;
      self.devDataSource._store._dataSource._store._array = self.options.data;
      self.devDataSource.reload();
    } else {
      return self.options.data;
    }
  };

  // src/js/dataSource/dews.ui.dataSource.js
  (function ($2, dews2, kendo) {
    var defaultOptions = {};
    function getOptions(source) {
      var result = {};
      if (source) {
        if (!source.hasOwnProperty("data")) {
          $2.extend(true, result, {
            batch: true,
            transport: {
              read: {
                cache: false
              }
            },
            schema: {
              data: function data(_data2) {
                var result2 = [];
                dews2.log("## dews.ui.dataSource + ajax - result ##");
                dews2.log(_data2);
                if (_data2) {
                  if (_data2.hasOwnProperty("state")) {
                    if (_data2.state === "success") {
                      result2 = _data2.data;
                    } else if (_data2.state === "error" && typeof source.error !== "undefined") {
                      source.error.call(this, _data2, _data2.message);
                    }
                  }
                }
                if (result2 === null) {
                  result2 = [];
                }
                return result2;
              }
            }
          });
        }
        if (source.hasOwnProperty("schema") && source.schema.hasOwnProperty("model") && !source.schema.model.hasOwnProperty("id")) {
          source.schema.model.id = "_uid_";
        }
        var errorHandler = function errorHandler(e) {
          if (typeof e !== "undefined" && e.xhr && e.xhr.statusCode) {
            var evt = new $2.Event(e.xhr.statusText.toLowerCase());
            evt.code = e.xhr.status;
            $2(dews2.ajax).trigger(evt);
          }
        };
        if (source.hasOwnProperty("error")) {
          var srcHandler = source.error;
          source.error = function (e) {
            errorHandler(e);
            srcHandler(e);
          };
        } else {
          source.error = errorHandler;
        }
        if (source.paging) {
          source.pageSize = 100;
          source.schema.total = "total";
          if (!source.pagingCount) {
            source.pagingCount = 500;
          }
          if ($2.type(source.paging) === "string") {
            source.pagingType = source.paging;
            source.paging = true;
            if (source.pagingType === "scroll") {
              source.serverPaging = true;
              source.transport.parameterMap = function (data) {
                data.paging = true;
                data.pagingStart = data.skip;
                data.pagingCount = source.pagingCount;
                this.options.pageRead = true;
                if (data.skip === 0) {
                  this.options.pagingStart = 0;
                } else if (data.skip > this.options.pagingStart) {
                  this.options.pagingStart += source.pagingCount;
                }
                return data;
              };
            }
          } else {
            source.pagingType = "background";
          }
        }
      }
      $2.extend(true, result, defaultOptions, source);
      return result;
    }
    dews2 = $2.extend(true, dews2, {
      ui: {
        dataSource: function dataSource(id, options, container) {
          var dataSource,$container = $2(document),dtpye = "";
          if (options && options.hasOwnProperty("grid") && options.grid === true) {
            options.id = id;
            dataSource = new DataProvider(options);
            $container.data("dews-datasource-" + id, dataSource);
          } else if (options && options.hasOwnProperty("grid") && options.grid === "pivot") {
            options.id = id;
            dataSource = new DevDataSource(options);
            $container.data("dews-datasource-" + id, dataSource);
          } else {
            if (options) {
              options.id = id;
              options = getOptions(options);
              dataSource = new kendo.data.DataSource(options);
              dataSource.id = id;
              $container.data("dews-datasource-" + id, dataSource);
              dews2.log("## dews.ui.dataSource: " + id + " \uC0DD\uC131 ##");
              dews2.log(dataSource.data());
            } else {
              dataSource = $container.data("dews-datasource-" + id);
            }
            return dataSource;
          }
          return dataSource;
        }
      }
    });
    function readDataSource(self, result, data, resultAll) {
      if (!self.options.data) {
        self.options.data = [];
      }
      if ($2.type(result) === "object" && result.hasOwnProperty("data")) {
        self.options.data = self.options.data.concat(result.data);
      } else {
        self.options.data = self.options.data.concat(result);
      }
      if (resultAll.paging) {
        self.options.loadingData = true;
        if (resultAll && resultAll.hasOwnProperty("current")) {
          self.options.pagingStart = parseInt(resultAll.current) + 1;
          if (resultAll.hasOwnProperty("total") && $2.type(resultAll.total) === "number") {
            self.options.totalCount = parseInt(resultAll.total);
          }
          self.options.totalLength = Math.ceil(self.options.totalCount / self.options.pagingCount);
        }
        if (self.options.index === self.options.totalLength - 1 || self.options.totalLength === 0) {
          self.data(self.options.data);
          if (self.options.sortData && self.options.sortData.length !== self.options.data.length) {
            var column = self.options.sortCoulumn;
            self.options.sortData = self.data().slice();
            self.options.sortData.sort(function (a, b) {
              if (a[column].localeCompare) {
                return a[column].localeCompare(b[column]);
              }
              return a[column] < b[column] ? -1 : a[column] > b[column] ? 1 : 0;
            });
          }
          delete self.options.index;
          delete self.options.totalLength;
          delete self.options.totalCount;
          delete self.options.pagingStart;
          delete self.options.loadingData;
          delete self.options.data;
        } else {
          self.data(self.options.data);
          self.options.index++;
          self.read();
        }
      }
    }
    kendo.data.DataSource.fn.read = function (data) {
      var that = this,params = that._params(data);
      var deferred = $2.Deferred();
      that._destroyed = [];
      if (that.options.master) {
        for (var i = 0; i < Object.keys(that.options.master).length; i += 1) {
          that.options.master[Object.keys(that.options.master)[i]].options.lineDataSources = {};
          that.options.master[Object.keys(that.options.master)[i]].read();
        }
      }
      if (that.options.paging) {
        if ($2.type(that.options.index) === "undefined") {
          that.options.index = 0;
          that.options.pagingStart = 0;
          that.options.loadingData = true;
        }
        params.paging = true;
        params.pagingStart = parseInt(that.options.pagingStart);
        params.pagingCount = parseInt(that.options.pagingCount);
        if (that.options.index === 0) {
          var event = that._events.change;
          if (event && event.length !== 0) {
            that.unbind("change");
            that.data([]);
            for (var i = 0; i < event.length; i++) {
              that.bind("change", event[i]);
            }
          }
        }
      }
      if (that.options.paging && that.options.pagingType === "background") {
        var url;
        if ($2.type(that.options.transport.read.url) === "function") {
          url = that.options.transport.read.url.call(that);
        } else {
          url = that.options.transport.read.url;
        }
        if (that.options.transport && that.options.transport.read.url) {
          if (that.options.transport.read.data) {
            var param = $2.type(that.options.transport.read.data) === "function" ? that.options.transport.read.data() : that.options.transport.read.data;
            params = $2.extend(true, {}, param, params);
          }
        }
        if ($2.type(that.options.transport.read.type) === "undefined" || that.options.transport.read.type.toLowerCase() === "get") {
          dews2.api.get(url, {
            data: params,
            async: true
          }).done(function (result, state, json, resultAll) {
            readDataSource(that, result, data, resultAll);
          }).fail(function (e, xhr) {
            if (that.options.error && $2.type(that.options.error) === "function") {
              that.options.error.call(that, e.responseJSON);
            }
          });
        } else {
          dews2.api.post(url, {
            data: params,
            async: true
          }).done(function (result, state, json, resultAll) {
            readDataSource(that, result, data, resultAll);
          }).fail(function (e, xhr) {
            if (that.options.error && $2.type(that.options.error) === "function") {
              that.options.error.call(that, e.responseJSON);
            }
          });
        }
      } else {
        that._queueRequest(params, function () {
          var isPrevented = that.trigger("requestStart", {
            type: "read"
          });
          if (!isPrevented) {var _that$options$transpo, _that$options$transpo2, _that$options$transpo3, _that$options$transpo4;
            that.trigger("progress");
            that._ranges = [];
            that.trigger("reset");
            var encodeArr = (_that$options$transpo = that.options.transport) === null || _that$options$transpo === void 0 ? void 0 : (_that$options$transpo2 = _that$options$transpo.read) === null || _that$options$transpo2 === void 0 ? void 0 : _that$options$transpo2.encode;
            var encode = (encodeArr === null || encodeArr === void 0 ? void 0 : encodeArr.length) > 0;
            var encodeData = {};
            var url2 = (_that$options$transpo3 = that.options.transport) === null || _that$options$transpo3 === void 0 ? void 0 : (_that$options$transpo4 = _that$options$transpo3.read) === null || _that$options$transpo4 === void 0 ? void 0 : _that$options$transpo4.url;
            if (encode) {
              var getEncodeData = function getEncodeData(param3, encodeArr2) {
                var encodeData2 = {};var _loop = function _loop(field)
                {
                  var value = param3[field];
                  encodeArr2.forEach(function (encodeField) {
                    if (field === encodeField) {
                      encodeData2[field] = "enc(\"".concat(dews2.fn.util.enCodeAES256(value), "\")");
                    }
                  });
                };for (var field in param3) {_loop(field);}
                return encodeData2;
              };
              if (that.options.transport && that.options.transport.read.url) {
                if (that.options.transport.read.data) {
                  var param2 = $2.type(that.options.transport.read.data) === "function" ? that.options.transport.read.data() : that.options.transport.read.data;
                  if (!that.options._isEncode) {
                    encodeData = getEncodeData(param2, encodeArr);
                  } else if ($2.type(that.options.transport.read.data) === "function") {
                    encodeData = getEncodeData(param2, encodeArr);
                  }
                  params = $2.extend(true, {}, param2, encodeData, params);
                }
              }
              that.options._isEncode = true;
            }
            if (that.online()) {
              that.transport.read({
                data: params,
                encode: encode,
                originUrl: url2,
                success: function success(data2) {
                  if (that.options.paging && that.options.pagingType === "scroll") {
                    if (data2.hasOwnProperty("total") && data2.total) {
                      that.reader.total = function () {
                        return parseInt(data2.total, 10);
                      };
                      that.options.totalCount = parseInt(data2.total);
                    }
                    that.options.totalLength = Math.ceil(
                    that.options.totalCount / that.options.pagingCount);

                  }
                  that.success(data2);
                  deferred.resolve();
                },
                error: function error() {
                  var args = Array.prototype.slice.call(arguments);
                  that.error.apply(that, args);
                  deferred.reject.apply(deferred, args);
                }
              });
            } else if (that.options.offlineStorage != null) {
              that.success(that.offlineData());
              deferred.resolve();
            }
          } else {
            that._dequeueRequest();
            deferred.resolve(isPrevented);
          }
        });
      }
      return deferred.promise();
    };
    kendo.data.DataSource.prototype.isDataLoading = function () {
      var self = this,result = false;
      if (self.options.loadingData) {
        result = true;
      }
      return result;
    };
    kendo.data.DataSource.prototype.batchSave = function (url, options, encode) {
      var self = this,opt,data,batchData;
      data = self.getDirtyData();
      batchData = {};
      batchData[self.options.id] = data;
      opt = $2.extend(
      true,
      {},
      {
        type: "POST",
        data: { rows: JSON.stringify(batchData) }
      },
      options);

      return dews2.api.post(url, opt, encode).done(function (result) {
        if (self.options.lineDataSources) {
          $2.each(self.options.lineDataSources, function (idx, item) {
            item.read();
          });
        } else {
          self.read();
        }
        if (options && options.hasOwnProperty("callback") && $2.type(options.callback) === "function") {
          options.callback.call(this, result);
        }
      }).fail(function (jqXHR, status, msg, data2) {
        if (options && options.hasOwnProperty("error") && $2.type(options.error) === "function") {
          options.error.call(this, msg, data2, status, jqXHR);
        }
      });
    };
    kendo.data.DataSource.prototype.saveAll = function (url, options, encode) {
      var self = this,opt,data,batchData;
      data = self.data();
      batchData = {};
      batchData[self.options.id] = data;
      opt = $2.extend(
      true,
      {},
      {
        type: "POST",
        data: { rows: JSON.stringify(batchData) }
      },
      options);

      return dews2.api.post(url, opt, encode).done(function (result) {
        if (self.options.lineDataSources) {
          $2.each(self.options.lineDataSources, function (idx, item) {
            item.read();
          });
        } else {
          self.read();
        }
        if (options && options.hasOwnProperty("callback") && $2.type(options.callback) === "function") {
          options.callback.call(this, result);
        }
      }).fail(function (jqXHR, status, msg, data2) {
        if (options && options.hasOwnProperty("error") && $2.type(options.error) === "function") {
          options.error.call(this, msg, data2, status, jqXHR);
        }
      });
    };
    kendo.data.DataSource.prototype.getDirtyData = function () {
      var self = this,currentData = self._data,newRecords = [],updateRecords = [],deleteRecords = [],data,i,l;
      if (self.options.detail && self.options.lineDataSources) {
        for (l = 0; l < Object.keys(self.options.lineDataSources).length; l += 1) {
          var lineDataSource = self.options.lineDataSources[Object.keys(self.options.lineDataSources)[l]];
          for (i = 0; i < lineDataSource._data.length; i++) {
            if (lineDataSource._data[i].isNew && lineDataSource._data[i].isNew()) {
              newRecords.push(lineDataSource._data[i].toJSON());
            } else if (lineDataSource._data[i].dirty) {
              updateRecords.push(lineDataSource._data[i].toJSON());
            }
          }
          for (i = 0; i < lineDataSource._destroyed.length; i++) {
            deleteRecords.push(lineDataSource._destroyed[i].toJSON());
          }
        }
      } else {
        for (i = 0; i < currentData.length; i++) {
          if (currentData[i].isNew && currentData[i].isNew()) {
            newRecords.push(currentData[i].toJSON());
          } else if (currentData[i].dirty) {
            updateRecords.push(currentData[i].toJSON());
          }
        }
        for (i = 0; i < self._destroyed.length; i++) {
          deleteRecords.push(self._destroyed[i].toJSON());
        }
      }
      data = {};
      $2.extend(data, { Updated: updateRecords }, { Deleted: deleteRecords }, { Added: newRecords });
      return data;
    };
    kendo.data.DataSource.prototype.getDirtyDataCount = function () {
      var self = this,datas = self.data(),count = 0,i = 0,l = 0;
      if (self.options.detail && self.options.lineDataSources) {
        for (l = 0; l < Object.keys(self.options.lineDataSources).length; l += 1) {
          var lineDataSource = self.options.lineDataSources[Object.keys(self.options.lineDataSources)[l]];
          for (i = 0; i < lineDataSource._data.length; i++) {
            if (lineDataSource._data[i].isNew && lineDataSource._data[i].isNew()) {
              count++;
            } else if (lineDataSource._data[i].dirty) {
              count++;
            }
          }
          count += lineDataSource._destroyed.length;
        }
      } else {
        for (i = 0; i < datas.length; i++) {
          if (datas[i].isNew && datas[i].isNew()) {
            count++;
          } else if (datas[i].dirty) {
            count++;
          }
        }
        count += self._destroyed.length;
      }
      return count;
    };
    kendo.data.DataSource.prototype._dataChange = function (page) {
      var self = this,parameter = {
          dataSource: self,
          isChange: false
        },event = new $2.Event("dataChange", parameter);
      self.options._dataChange = true;
      self.bind("change", function () {
        if (self.hasDirty()) {
          event.isChange = true;
        } else {
          event.isChange = false;
        }
        if ($2.type(arguments[0]) === "boolean") {
          event.isChange = arguments[0];
        }
        page.$content.trigger(event);
      });
    };
    kendo.data.DataSource.prototype._detailDataChange = function () {
      var self = this;
      self.options._dataChange = true;
      self.bind("change", function (e) {
        if (self.options.parentDataSource) {
          self.options.parentDataSource.trigger("change");
        } else {
          if (self.getDirtyDataCount() > 0) {
            if (self.options.masterDataSource.options.grid) {
              if (e.action === "itemchange") {
                self.options.masterDataSource.dataProvider.onRowUpdated.call(
                self.options.masterDataSource,
                true);

              } else if (e.action === "add") {
                self.options.masterDataSource.dataProvider.onRowInserted.call(
                self.options.masterDataSource,
                true);

              } else if (e.action === "remove") {
                self.options.masterDataSource.dataProvider.onRowDeleted.call(
                self.options.masterDataSource,
                true);

              } else {
                if ($2.type(self.options.masterDataSource.dataProvider.onRowStatesCleared) !== "undefined") {
                  self.options.masterDataSource.dataProvider.onRowStatesCleared.call(
                  self.options.masterDataSource,
                  true);

                } else {
                  self.options.masterDataSource.dataProvider.onRowStatesChanged.call(
                  self.options.masterDataSource,
                  true);

                }
              }
            } else {
              self.options.masterDataSource.trigger("change", true);
            }
          } else {
            if (self.options.masterDataSource.options.grid) {
              if (e.action === "itemchange") {
                self.options.masterDataSource.dataProvider.onRowUpdated.call(self.options.masterDataSource);
              } else if (e.action === "add") {
                self.options.masterDataSource.dataProvider.onRowInserted.call(
                self.options.masterDataSource);

              } else if (e.action === "remove") {
                self.options.masterDataSource.dataProvider.onRowDeleted.call(self.options.masterDataSource);
              } else {
                if ($2.type(self.options.masterDataSource.dataProvider.onRowStatesCleared) !== "undefined") {
                  self.options.masterDataSource.dataProvider.onRowStatesCleared.call(
                  self.options.masterDataSource);

                } else {
                  self.options.masterDataSource.dataProvider.onRowStatesChanged.call(
                  self.options.masterDataSource);

                }
              }
            } else {
              self.options.masterDataSource.trigger("change");
            }
          }
        }
      });
    };
    kendo.data.DataSource.prototype.hasDirty = function (target) {
      var self = this,range = true,result = false;
      if ($2.type(target) === "boolean") {
        range = target;
      }
      if (range) {
        if ($2.type(self.options.detailDataSource) !== "undefined") {
          result = self.options.detailDataSource.hasDirty(range);
          if (result) {
            return result;
          } else if (self.getDirtyDataCount() > 0) {
            result = true;
          }
        } else {
          if (self.getDirtyDataCount() > 0) {
            result = true;
          }
        }
      } else {
        if (self.getDirtyDataCount() > 0) {
          result = true;
        }
      }
      return result;
    };
  })(jQuery, window.dews || {}, window.kendo);
})();


(function () {
  // src/js/dataSource/BaseDataProvider.js
  var BaseDataProvider = /*#__PURE__*/function () {"use strict";
    function BaseDataProvider(dataProvider, options) {_classCallCheck(this, BaseDataProvider);
      var self = this;
      var opt;
      opt = this.setDataSourceOptions(options);
      opt.rollback = dataProvider.savePoint();
      dataProvider.setFields(opt.field);
      dataProvider.setOptions(opt);
      self.dataProvider = dataProvider;
      self.options = opt;
      self.id = opt.id;
    }_createClass(BaseDataProvider, [{ key: "setDataSourceOptions", value:
      function setDataSourceOptions(options) {
        var UUIDFlag = false;
        var opt = options;
        if (opt.schema && opt.schema.model.fields) {
          var field = [];
          for (var i = 0; i < opt.schema.model.fields.length; i += 1) {
            if (opt.schema.model.fields[i].fieldName === "__UUID") {
              UUIDFlag = true;
            }
            opt.schema.model.fields[i].fieldName = opt.schema.model.fields[i].field;
            if (opt.schema.model.fields[i].type) {
              if (opt.schema.model.fields[i].type.toLowerCase() === "string") {
                opt.schema.model.fields[i].dataType = "text";
                delete opt.schema.model.fields[i].type;
              } else {
                opt.schema.model.fields[i].dataType = opt.schema.model.fields[i].type;
              }
            } else if (!opt.schema.model.fields[i].dataType) {
              opt.schema.model.fields[i].dataType = "text";
            }
            if (opt.schema.model.fields[i].dataType.toLowerCase() === "string") {
              opt.schema.model.fields[i].dataType = "text";
            }
            field.push(opt.schema.model.fields[i]);
          }
          if (!UUIDFlag) {
            field.splice(0, 0, {
              field: "__UUID",
              fieldName: "__UUID",
              dataType: "text"
            });
          }
          opt.schema.model.fields = opt.field = field;
        }
        return opt;
      } }, { key: "removeLineDataSources", value:
      function removeLineDataSources(dataSource) {
        if (dataSource.options.master) {
          for (var i = 0; i < Object.keys(dataSource.options.master).length; i += 1) {
            dataSource.options.master[Object.keys(dataSource.options.master)[i]].options.lineDataSources = {};
            if (dataSource.options.master[Object.keys(dataSource.options.master)[i]]) {
              this.removeLineDataSources(dataSource.options.master[Object.keys(dataSource.options.master)[i]]);
            }
          }
        }
      } }, { key: "at", value:
      function at(row) {
        return this.dataProvider.getJsonRow(row);
      } }, { key: "setOptions", value:
      function setOptions(options) {
        var self = this,opt;
        opt = $.extend(true, this.options, options);
        self.options = opt;
        self.dataProvider.setOptions(opt);
      } }, { key: "setFields", value:
      function setFields(fields) {
        var self = this;
        self.options.schema.model.fields = fields;
        self.options = this.setDataSourceOptions(self.options);
        self.dataProvider.setFields([]);
        self.dataProvider.setFields(self.options.field);
      } }, { key: "hasDirty", value:
      function hasDirty(target) {
        var self = this,range = true,result = false;
        if ($.type(target) === "boolean") {
          range = target;
        }
        if (range) {
          if ($.type(self.options.detailDataSource) !== "undefined") {
            result = self.options.detailDataSource.hasDirty(range);
            if (result) {
              return result;
            } else if (self.getDirtyDataCount() > 0) {
              result = true;
            }
          } else {
            if (self.getDirtyDataCount() > 0) {
              result = true;
            }
          }
        } else {
          if (self.getDirtyDataCount() > 0) {
            result = true;
          }
        }
        return result;
      } }, { key: "getParentData", value:
      function getParentData() {
        var self = this;
        if (self.options.detail) {
          var masterDataSource,master_uid,master_data = [],rowData;
          masterDataSource = self.options.masterDataSource;
          master_uid = self.options._muid;
          if (masterDataSource.options.detail && masterDataSource.options.lineDataSources) {
            var masterLineDataSources = Object.values(masterDataSource.options.lineDataSources);
            for (var inx = 0; inx < masterLineDataSources.length; inx++) {
              master_data = master_data.concat(masterLineDataSources[inx].data());
            }
          } else {
            master_data = masterDataSource.data();
          }
          for (var i = 0; i < master_data.length; i++) {
            if (master_uid === master_data[i]._uid) {
              rowData = master_data[i];
              break;
            }
          }
          return rowData;
        }
      } }, { key: "getUpdatedCells", value:
      function getUpdatedCells(dataIndex) {
        var self = this;
        return self.dataProvider.getUpdatedCells(dataIndex);
      } }, { key: "isDataLoading", value:
      function isDataLoading() {
        var self = this,result = false;
        if (self.options.loadingData) {
          result = true;
        }
        return result;
      } }]);return BaseDataProvider;}();


  // src/js/dataSource/TreeDataProvider.js
  var TreeDataProvider = /*#__PURE__*/function (_BaseDataProvider2) {"use strict";_inherits(TreeDataProvider, _BaseDataProvider2);var _super2 = _createSuper(TreeDataProvider);
    function TreeDataProvider(options) {_classCallCheck(this, TreeDataProvider);
      var dataProvider = new RealGridJS.LocalTreeDataProvider();return _super2.call(this,
      dataProvider, options);
    }_createClass(TreeDataProvider, [{ key: "setDataSourceOptions", value:
      function setDataSourceOptions(options) {var _options$schema, _options$schema$model;
        var defaultOptions = {
          _destroy: [],
          params: "",
          restoreMode: "auto",
          async: true,
          childrenField: "items"
        };
        if ((_options$schema = options.schema) !== null && _options$schema !== void 0 && (_options$schema$model = _options$schema.model) !== null && _options$schema$model !== void 0 && _options$schema$model.childrenField) {
          options.childrenField = options.schema.model.childrenField;
        }
        var opt = $.extend(true, defaultOptions, options);
        return _get(_getPrototypeOf(TreeDataProvider.prototype), "setDataSourceOptions", this).call(this, opt);
      } }, { key: "read", value:
      function read() {var _self$options$transpo;
        var self = this,options = self.options,url = (_self$options$transpo = self.options.transport) === null || _self$options$transpo === void 0 ? void 0 : _self$options$transpo.read.url,deferred = $.Deferred();
        options._destroy = [];
        this.removeLineDataSources(self);
        if (url) {
          request();
        } else if (options.data) {
          bindLocalData();
        }
        return deferred.promise();
        function getUrl() {
          return typeof url === "function" ? url.call(self) : url;
        }
        function request() {
          var type = self.options.transport.read.type;
          var method = type ? type.toLowerCase() : "get";
          var param = getParameter();
          var url2 = getUrl();
          self.options.loadingData = true;
          dews.api[method](url2, { data: param, async: self.options.async }).done(function (result) {
            delete self.options.loadingData;
            var resultData = {};
            if ($.type(result) === "object" && result.hasOwnProperty("data")) {
              resultData[self.options.childrenField] = result.data;
              self.options.data = resultData;
            } else {
              resultData[self.options.childrenField] = result;
              self.options.data = resultData;
            }
            self.dataProvider.clearRowStates();
            self.dataProvider.setJsonRows(resultData, self.options.childrenField, "", "");
            self.options.rollback = self.dataProvider.savePoint();
            deferred.resolve();
          }).fail(function (e, xhr) {
            if (self.options.error && $.type(self.options.error) === "function") {
              self.options.error.call(self, e.responseJSON);
            }
            deferred.reject.apply(deferred, e.responseJSON);
          });
        }
        function getParameter() {
          var data = self.options.transport.read.data;
          return typeof data === "function" ? data() : data !== null && data !== void 0 ? data : "";
        }
        function bindLocalData() {
          var resultData = {};
          if ($.type(self.options.data) === "array") {
            resultData[self.options.childrenField] = self.options.data;
          } else {
            resultData = self.options.data;
          }
          self.dataProvider.clearRowStates();
          self.dataProvider.setJsonRows(resultData, self.options.childrenField, "", "");
          self.options.rollback = self.dataProvider.savePoint();
          deferred.resolve();
        }
      } }, { key: "data", value:
      function data(_data3) {
        var self = this,resultData = {};
        if ($.type(_data3) === "array") {
          resultData[self.options.childrenField] = _data3;
          self.options.data = resultData;
          self.dataProvider.setJsonRows(resultData, self.options.childrenField, "", "");
          self.options.rollback = self.dataProvider.savePoint();
          self.options._destroy = [];
        } else {
          return self.dataProvider.getJsonRows(-1, true, self.options.childrenField, "");
        }
      } }, { key: "getDirtyData", value:
      function getDirtyData() {
        var self = this,currentData = {
            Added: [],
            Updated: [],
            Deleted: []
          },i,j,k,l;
        if (self.dataProvider.getStateRows("created")) {
          for (i = 0; i < self.dataProvider.getStateRows("created").length; i += 1) {
            var createData = self.dataProvider.getJsonRow(self.dataProvider.getStateRows("created")[i]),createParentId = self.dataProvider.getParent(self.dataProvider.getStateRows("created")[i]);
            createData.__parent = self.dataProvider.getJsonRow(createParentId);
            createData.__sequence;
            $.each(self.dataProvider.getChildren(createParentId), function (index, rowId) {
              if (self.dataProvider.getStateRows("created")[i] === rowId) {
                createData.__sequence = index;
              }
            });
            currentData.Added.push(createData);
          }
        }
        if (self.dataProvider.getStateRows("updated")) {
          for (j = 0; j < self.dataProvider.getStateRows("updated").length; j += 1) {
            var updatedData = self.dataProvider.getJsonRow(self.dataProvider.getStateRows("updated")[j]),updatedParentId = self.dataProvider.getParent(self.dataProvider.getStateRows("updated")[j]);
            updatedData.__parent = self.dataProvider.getJsonRow(updatedParentId);
            updatedData.__sequence;
            $.each(self.dataProvider.getChildren(updatedParentId), function (index, rowId) {
              if (self.dataProvider.getStateRows("updated")[j] === rowId) {
                updatedData.__sequence = index;
              }
            });
            currentData.Updated.push(updatedData);
          }
        }
        for (k = 0; k < self.options._destroy.length; k += 1) {
          currentData.Deleted.push(self.options._destroy[k]);
        }
        if (self.options.detail && self.options.lineDataSources) {
          for (l = 0; l < Object.keys(self.options.lineDataSources).length; l += 1) {
            var lineDataSource = self.options.lineDataSources[Object.keys(self.options.lineDataSources)[l]];
            if (lineDataSource.dataProvider.getStateRows("created")) {
              for (i = 0; i < lineDataSource.dataProvider.getStateRows("created").length; i += 1) {
                createData = lineDataSource.dataProvider.getJsonRow(
                lineDataSource.dataProvider.getStateRows("created")[i]),
                createParentId = lineDataSource.dataProvider.getParent(
                self.dataProvider.getStateRows("created")[i]);

                createData.__parent = lineDataSource.dataProvider.getJsonRow(createParentId);
                createData.__sequence;
                $.each(lineDataSource.dataProvider.getChildren(createParentId), function (index, rowId) {
                  if (lineDataSource.dataProvider.getStateRows("created")[i] === rowId) {
                    createData.__sequence = index;
                  }
                });
                createData._huid = Object.keys(self.options.lineDataSources)[l];
                currentData.Added.push(createData);
              }
            }
            if (lineDataSource.dataProvider.getStateRows("updated")) {
              for (j = 0; j < lineDataSource.dataProvider.getStateRows("updated").length; j += 1) {
                var updatedData = lineDataSource.dataProvider.getJsonRow(
                  lineDataSource.dataProvider.getStateRows("updated")[j]),
                  updatedParentId = lineDataSource.dataProvider.getParent(
                  lineDataSource.dataProvider.getStateRows("updated")[j]);

                updatedData.__parent = lineDataSource.dataProvider.getJsonRow(updatedParentId);
                updatedData.__sequence;
                $.each(lineDataSource.dataProvider.getChildren(updatedParentId), function (index, rowId) {
                  if (lineDataSource.dataProvider.getStateRows("updated")[j] === rowId) {
                    updatedData.__sequence = index;
                  }
                });
                updatedData._huid = Object.keys(lineDataSource.options.lineDataSources)[l];
                currentData.Updated.push(updatedData);
              }
            }
            for (k = 0; k < lineDataSource.options._destroy.length; k += 1) {
              var del = lineDataSource.options._destroy[k];
              del._huid = Object.keys(self.options.lineDataSources)[l];
              currentData.Deleted.push(del);
            }
          }
        }
        return currentData;
      } }, { key: "getDirtyDataCount", value:
      function getDirtyDataCount() {
        var self = this,count = 0,i,j,k;
        if (self.dataProvider.getStateRows("created")) {
          for (i = 0; i < self.dataProvider.getStateRows("created").length; i += 1) {
            count += 1;
          }
        }
        if (self.dataProvider.getStateRows("updated")) {
          for (j = 0; j < self.dataProvider.getStateRows("updated").length; j += 1) {
            count += 1;
          }
        }
        for (k = 0; k < self.options._destroy.length; k += 1) {
          count += 1;
        }
        if (self.options.detail && self.options.lineDataSources) {
          for (var l = 0; l < Object.keys(self.options.lineDataSources).length; l += 1) {
            var lineDataSource = self.options.lineDataSources[Object.keys(self.options.lineDataSources)[l]];
            if (lineDataSource.dataProvider.getStateRows("created")) {
              for (i = 0; i < lineDataSource.dataProvider.getStateRows("created").length; i += 1) {
                count += 1;
              }
            }
            if (lineDataSource.dataProvider.getStateRows("updated")) {
              for (j = 0; j < lineDataSource.dataProvider.getStateRows("updated").length; j += 1) {
                count += 1;
              }
            }
            for (k = 0; k < lineDataSource.options._destroy.length; k += 1) {
              count += 1;
            }
          }
        }
        return count;
      } }, { key: "batchSave", value:
      function batchSave(url, options) {
        var self = this,data = self.getDirtyData(),opt,batchData = {},dfr = $.Deferred();
        batchData[self.options.id] = data;
        opt = $.extend(
        true,
        {},
        {
          type: "POST",
          data: { rows: JSON.stringify(batchData) }
        },
        options);

        dews.api.post(url, opt).done(function (result) {
          self.options._destroy = [];
          self.dataProvider.clearRowStates();
          dfr.resolve(result);
        }).fail(function (jqXHR, status, msg, data2) {
          dfr.reject(msg);
        });
        return dfr;
      } }, { key: "saveAll", value:
      function saveAll(url, options) {
        var self = this,opt,data = self.dataProvider.getJsonRows(-1, true, self.options.childrenField, ""),batchData = {},dfr = $.Deferred();
        batchData[self.options.id] = data;
        opt = $.extend(
        true,
        {},
        {
          type: "POST",
          data: { rows: JSON.stringify(batchData) }
        },
        options);

        dews.api.post(url, opt).done(function (result) {
          self.options._destroy = [];
          self.dataProvider.clearRowStates();
          dfr.resolve(result);
        }).fail(function (jqXHR, status, msg, data2) {
          dfr.reject(msg);
        });
        return dfr;
      } }, { key: "_dataChange", value:
      function _dataChange(page) {
        var self = this,parameter = {
            dataSource: self,
            isChange: false
          },event = new $.Event("dataChange", parameter);
        self.dataProvider.onRowAdded = function () {
          if (self.hasDirty(true)) {
            event.isChange = true;
          } else {
            event.isChange = false;
          }
          if ($.type(arguments[0]) === "boolean") {
            event.isChange = arguments[0];
          }
          page.$content.trigger(event);
        };
        self.dataProvider.onRowDeleted = function () {
          if (self.hasDirty(true)) {
            event.isChange = true;
          } else {
            event.isChange = false;
          }
          if ($.type(arguments[0]) === "boolean") {
            event.isChange = arguments[0];
          }
          page.$content.trigger(event);
        };
        self.dataProvider.onRowUpdated = function () {
          if (self.hasDirty(true)) {
            event.isChange = true;
          } else {
            event.isChange = false;
          }
          if ($.type(arguments[0]) === "boolean") {
            event.isChange = arguments[0];
          }
          page.$content.trigger(event);
        };
        self.dataProvider.onRowStatesChanged = function () {
          if (self.hasDirty(true)) {
            event.isChange = true;
          } else {
            event.isChange = false;
          }
          if ($.type(arguments[0]) === "boolean") {
            event.isChange = arguments[0];
          }
          page.$content.trigger(event);
        };
      } }, { key: "_detailDataChange", value:
      function _detailDataChange() {
        var self = this;
        self.options._dataChange = true;
        self.dataProvider.onRowDeleted = function () {
          if (self.options.parentDataSource) {
            self.options.parentDataSource.dataProvider.onRowDeleted.call(self.options.parentDataSource);
          } else {
            if (self.getDirtyDataCount() > 0) {
              if (self.options.masterDataSource.options.grid) {
                self.options.masterDataSource.dataProvider.onRowDeleted.call(
                self.options.masterDataSource,
                true);

              } else {
                self.options.masterDataSource.trigger("change", true);
              }
            } else {
              if (self.options.masterDataSource.options.grid) {
                self.options.masterDataSource.dataProvider.onRowDeleted.call(self.options.masterDataSource);
              } else {
                self.options.masterDataSource.trigger("change");
              }
            }
          }
        };
        self.dataProvider.onRowUpdated = function () {
          if (self.options.parentDataSource) {
            self.options.parentDataSource.dataProvider.onRowUpdated.call(self.options.parentDataSource);
          } else {
            if (self.getDirtyDataCount() > 0) {
              if (self.options.masterDataSource.options.grid) {
                self.options.masterDataSource.dataProvider.onRowUpdated.call(
                self.options.masterDataSource,
                true);

              } else {
                self.options.masterDataSource.trigger("change", true);
              }
            } else {
              if (self.options.masterDataSource.options.grid) {
                self.options.masterDataSource.dataProvider.onRowUpdated.call(self.options.masterDataSource);
              } else {
                self.options.masterDataSource.trigger("change");
              }
            }
          }
        };
        self.dataProvider.onRowInserted = function () {
          if (self.options.parentDataSource) {
            self.options.parentDataSource.dataProvider.onRowInserted.call(self.options.parentDataSource);
          } else {
            if (self.getDirtyDataCount() > 0) {
              if (self.options.masterDataSource.options.grid) {
                self.options.masterDataSource.dataProvider.onRowInserted.call(
                self.options.masterDataSource,
                true);

              } else {
                self.options.masterDataSource.trigger("change", true);
              }
            } else {
              if (self.options.masterDataSource.options.grid) {
                self.options.masterDataSource.dataProvider.onRowInserted.call(self.options.masterDataSource);
              } else {
                self.options.masterDataSource.trigger("change");
              }
            }
          }
        };
        self.dataProvider.onRowStatesChanged = function () {
          if (self.options.parentDataSource) {
            self.options.parentDataSource.dataProvider.onRowStatesChanged.call(self.options.parentDataSource);
          } else {
            if (self.getDirtyDataCount() > 0) {
              if (self.options.masterDataSource.options.grid) {
                if ($.type(self.options.masterDataSource.dataProvider.onRowStatesCleared) !== "undefined") {
                  self.options.masterDataSource.dataProvider.onRowStatesCleared.call(
                  self.options.masterDataSource,
                  true);

                } else {
                  self.options.masterDataSource.dataProvider.onRowStatesChanged.call(
                  self.options.masterDataSource,
                  true);

                }
              } else {
                self.options.masterDataSource.trigger("change", true);
              }
            } else {
              if (self.options.masterDataSource.options.grid) {
                if ($.type(self.options.masterDataSource.dataProvider.onRowStatesCleared) !== "undefined") {
                  self.options.masterDataSource.dataProvider.onRowStatesCleared.call(
                  self.options.masterDataSource);

                } else {
                  self.options.masterDataSource.dataProvider.onRowStatesChanged.call(
                  self.options.masterDataSource);

                }
              } else {
                self.options.masterDataSource.trigger("change");
              }
            }
          }
        };
      } }]);return TreeDataProvider;}(BaseDataProvider);


  // src/js/dataSource/dews.ui.treedatasource.js
  (function ($2, dews2, kendo) {
    var defaultOptions = {};
    function getOptions(source) {
      var result = {};
      if (source) {
        if (!source.hasOwnProperty("data")) {
          $2.extend(true, result, {
            batch: true,
            transport: {
              read: {
                cache: false
              }
            },
            schema: {
              data: function data(_data4) {
                var result2 = [];
                dews2.log("## dews.ui.dataSource + ajax - result ##");
                dews2.log(_data4);
                if (_data4) {
                  if (_data4.hasOwnProperty("state")) {
                    if (_data4.state === "success") {
                      result2 = _data4.data;
                    } else if (_data4.state === "error" && typeof source.error !== "undefined") {
                      source.error.call(this, _data4, _data4.message);
                    }
                  }
                }
                if (result2 === null) {
                  result2 = [];
                }
                return result2;
              }
            }
          });
        }
        if (source.hasOwnProperty("schema") && source.schema.hasOwnProperty("model") && !source.schema.model.hasOwnProperty("id")) {
          source.schema.model.id = "_uid_";
        }
        var errorHandler = function errorHandler(e) {
          if (typeof e !== "undefined" && e.xhr && e.xhr.statusCode) {
            var evt = new $2.Event(e.xhr.statusText.toLowerCase());
            evt.code = e.xhr.status;
            $2(dews2.ajax).trigger(evt);
          }
        };
        if (source.hasOwnProperty("error")) {
          var srcHandler = source.error;
          source.error = function (e) {
            errorHandler(e);
            srcHandler(e);
          };
        } else {
          source.error = errorHandler;
        }
      }
      $2.extend(true, result, defaultOptions, source);
      return result;
    }
    dews2 = $2.extend(true, dews2, {
      ui: {
        treeDataSource: function treeDataSource(id, options, container) {
          var dataSource,$container = $2(document);
          if (options && options.hasOwnProperty("grid") && options.grid) {
            options.tree = true;
            options.id = id;
            dataSource = new TreeDataProvider(options);
            $container.data("dews-treedatasource-" + id, dataSource);
          } else {
            if (options) {
              options.tree = true;
              options.id = id;
              options = getOptions(options);
              dataSource = new kendo.data.HierarchicalDataSource(options);
              dataSource.id = id;
              $container.data("dews-treedatasource-" + id, dataSource);
              dews2.log("## dews.ui.dataSource: " + id + " \uC0DD\uC131 ##");
              dews2.log(dataSource.data());
            } else {
              dataSource = $container.data("dews-treedatasource-" + id);
            }
          }
          return dataSource;
        }
      }
    });
    kendo.data.HierarchicalDataSource.prototype.batchSave = function (url, options) {
      var self = this,opt,data,batchData;
      data = self.getDirtyData();
      batchData = {};
      batchData[self.options.id] = data;
      opt = $2.extend(
      true,
      {},
      {
        type: "POST",
        data: { rows: JSON.stringify(batchData) }
      },
      options);

      return dews2.api.post(url, opt).done(function (result) {
        if (self.options.lineDataSources) {
          $2.each(self.options.lineDataSources, function (idx, item) {
            item.read();
          });
        } else {
          self.read();
        }
        if (options && options.hasOwnProperty("callback") && $2.type(options.callback) === "function") {
          options.callback.call(this, result);
        }
      }).fail(function (jqXHR, status, msg, data2) {
        if (options && options.hasOwnProperty("error") && $2.type(options.error) === "function") {
          options.error.call(this, msg, data2, status, jqXHR);
        }
      });
    };
    kendo.data.HierarchicalDataSource.prototype.saveAll = function (url, options) {
      var self = this,opt,data,batchData;
      data = self.data();
      batchData = {};
      batchData[self.options.id] = data;
      opt = $2.extend(
      true,
      {},
      {
        type: "POST",
        data: { rows: JSON.stringify(batchData) }
      },
      options);

      return dews2.api.post(url, opt).done(function (result) {
        if (self.options.lineDataSources) {
          $2.each(self.options.lineDataSources, function (idx, item) {
            item.read();
          });
        } else {
          self.read();
        }
        if (options && options.hasOwnProperty("callback") && $2.type(options.callback) === "function") {
          options.callback.call(this, result);
        }
      }).fail(function (jqXHR, status, msg, data2) {
        if (options && options.hasOwnProperty("error") && $2.type(options.error) === "function") {
          options.error.call(this, msg, data2, status, jqXHR);
        }
      });
    };
    function equal(x, y) {
      if (x === y) {
        return true;
      }
      var xtype = $2.type(x),ytype = $2.type(y),field;
      if (xtype !== ytype) {
        return false;
      }
      if (xtype === "date") {
        return x.getTime() === y.getTime();
      }
      if (xtype !== "object" && xtype !== "array") {
        return false;
      }
      for (field in x) {
        if (!equal(x[field], y[field])) {
          return false;
        }
      }
      return true;
    }
    kendo.data.Model.fn.set = function (field, value, initiator) {
      var self = this;
      var dirty = self.dirty;
      if (self.editable(field)) {
        value = self._parse(field, value);
        if (!equal(value, self.get(field))) {
          if (field === "expanded" || field === "selected") {
            self.dirty = dirty;
          } else {
            self.dirty = true;
          }
          self.dirtyFields[field] = true;
          if (kendo.data.ObservableObject.fn.set.call(self, field, value, initiator) && !dirty) {
            self.dirty = dirty;
            if (!self.dirty) {
              self.dirtyFields[field] = false;
            }
          }
        }
      }
    };
    kendo.data.HierarchicalDataSource.prototype.getDirtyData = function () {
      var self = this,currentData = self._data,deleteRecords = [],data = {},i;
      data = dirtyData(currentData);
      for (i = 0; i < self._destroyed.length; i++) {
        deleteRecords.push(self._destroyed[i].toJSON());
      }
      $2.extend(data, { Deleted: deleteRecords });
      return data;
    };
    function dirtyData(currentData) {
      var data = { Updated: [], Added: [] },childData = {};
      var newRecords = [],updateRecords = [];
      for (var i = 0; i < currentData.length; i++) {
        if (currentData[i].hasChildren) {
          if (currentData[i].isNew && currentData[i].isNew()) {
            newRecords.push(currentData[i].toJSON());
          } else if (currentData[i].dirty) {
            updateRecords.push(currentData[i].toJSON());
          }
          childData = dirtyData(currentData[i].children.data());
          $2.merge(data.Updated, childData.Updated);
          $2.merge(data.Added, childData.Added);
        } else {
          if (currentData[i].isNew && currentData[i].isNew()) {
            newRecords.push(currentData[i].toJSON());
          } else if (currentData[i].dirty) {
            updateRecords.push(currentData[i].toJSON());
          }
        }
      }
      $2.merge(data.Updated, updateRecords);
      $2.merge(data.Added, newRecords);
      return data;
    }
    kendo.data.HierarchicalDataSource.prototype.getDirtyDataCount = function () {
      var self = this,datas = self.data(),count = 0,i = 0;
      count = dirtyDataCount(datas);
      count += self._destroyed.length;
      return count;
    };
    function dirtyDataCount(datas) {
      var count = 0;
      var childCount = 0;
      for (var i = 0; i < datas.length; i++) {
        if (datas[i].hasChildren) {
          if (datas[i].isNew && datas[i].isNew()) {
            count++;
          } else if (datas[i].dirty) {
            count++;
          }
          count += childCount = dirtyDataCount(datas[i].children.data());
        } else {
          if (datas[i].isNew && datas[i].isNew()) {
            count++;
          } else if (datas[i].dirty) {
            count++;
          }
        }
      }
      return count;
    }
  })(jQuery, window.dews || {}, window.kendo || {});
})();


(function () {
  // src/js/grid/api/Api.js
  var Api = /*#__PURE__*/function () {"use strict";function Api() {_classCallCheck(this, Api);}_createClass(Api, [{ key: "setFocus", value:
      function setFocus() {
        dews.ui.gridUtil.setFocus(this);
      } }, { key: "getColumns", value:
      function getColumns() {
        return this.options._originColumns;
      } }, { key: "getColumnByField", value:
      function getColumnByField(field) {
        return this.getColumns().filter(function (col) {
          return col.field === field;
        })[0];
      } }, { key: "setFooterOptions", value:
      function setFooterOptions(fieldName, options) {
        var self = this;
        if (options) {
          if ($.type(options.align) !== "undefined") {
            switch (options.align.toLowerCase()) {
              case "left":
                options.align = "near";
                break;
              case "right":
                options.align = "far";
                break;
              default:
                options.align = "center";
                break;}

          }
          options.styles = {
            textAlignment: options.align ? options.align : "right"
          };
        }
        self._grid.setColumnProperty(self._grid.columnByField(fieldName), "footer", options);
      } }, { key: "showTooltip", value:
      function showTooltip(itemIndex, column, options) {
        dews.ui.gridUtil.showTooltip(this, itemIndex, column, options);
      } }, { key: "isCheckedRow", value:
      function isCheckedRow(row) {
        return dews.ui.gridUtil.isCheckedRow(this, row);
      } }, { key: "clearRows", value:
      function clearRows() {
        dews.ui.gridUtil.clearRows(this);
      } }, { key: "cancelChanges", value:
      function cancelChanges() {
        var self = this;
        var dataSource = self.options.dataSource;
        dataSource.dataProvider.rollback(dataSource.options.rollback);
        if (dataSource.options.data && dataSource.options.data.length === 0) {
          dataSource.dataProvider.clearRows();
        }
      } }, { key: "cancelRow", value:
      function cancelRow(index, addDataCancel) {
        var self = this,data = self.options.dataSource.dataProvider;
        dews.ui.gridUtil.cancelRow(self, data, index, addDataCancel);
      } }, { key: "cancelCell", value:
      function cancelCell() {
      } }]);return Api;}();


  // src/js/grid/excel/ExcelExporter.js
  function ExcelExporter() {
  }
  ExcelExporter.prototype["export"] = function (options, grids) {
    var self = this;
    self.grid = grids;
    self.options = exportInitialOptions(options);
    if (self.options.useExcelDownloadRecord) {
      self.grid._useExcelDownloadRecord = self.options.useExcelDownloadRecord;
    }
    if (self.grid._useExcelDownloadRecord) {
      var recordDialog = dews.ui.dialog("H_CM_PRINTREASON_INFO_C", {
        url: "~/codehelp/CI/H_CM_PRINTREASON_INFO_C",
        iframe: false,
        buttons: "applyAndClose",
        width: 560,
        height: 537,
        size: "medium",
        initData: {
          code: "H_CM_PRINTREASON_INFO_C",
          MENU_CD: dews.ui.page.menu.id,
          GRID_CD: self.grid.userOptions._dewsGridID
        },
        ok: function ok() {
          Array.isArray(self.grid) ? self.multiSheetExcelExport() : self.oneSheetExcelExport();
        }
      });
      recordDialog.open();
    } else {
      Array.isArray(self.grid) ? self.multiSheetExcelExport() : self.oneSheetExcelExport();
    }
  };
  ExcelExporter.prototype.oneSheetExcelExport = function () {
    var self = this;
    var opt2 = self.options;
    removeGridCellStyles(self.grid);
    self.grid._grid.exportGrid(opt2);
    restoreGridCellStyles(self.grid);
  };
  ExcelExporter.prototype.multiSheetExcelExport = function () {
    var self = this;
    var opt2 = self.options;
    for (var i = 0; i < self.grid.length; i++) {
      removeGridCellStyles(self.grid[i]);
      opt2.exportGrids[i].grid = self.grid[i]._grid;
    }
    RealGridJS.exportGrid(opt2);
    for (var j = 0; j < self.grid.length; j++) {
      restoreGridCellStyles(self.grid[j]);
    }
  };
  function removeGridCellStyles(grid2) {
    if (grid2._grid.getSelectOptions().style !== "none") {
      grid2._grid.clearCellStyles();
    }
  }
  function restoreGridCellStyles(grid2) {
    var currentCell = grid2._grid.getCurrent();
    var rowIndex = currentCell.dataRow;
    var fieldIndex = currentCell.fieldIndex;
    var background = grid2.options.gridStyle.selection.focusBackgroundColor;
    if (typeof grid2.columns[currentCell.column] !== "undefined" && typeof grid2.columns[currentCell.column].attributes !== "undefined") {
      if (grid2.columns[currentCell.column].attributes["class"] === "required") {
        background = grid2.options.gridStyle.body.requiredFocusBackground;
      } else if (grid2.columns[currentCell.column].attributes["class"] === "readonly") {
        background = grid2.options.gridStyle.body.readonlyFocusBackground;
      }
    }
    if (grid2._grid.getSelectOptions().style !== "none") {
      grid2._grid.addCellStyle(
      "selection",
      {
        editable: false,
        background: background
      },
      true);

      grid2._grid.setCellStyle(rowIndex, fieldIndex, "selection");
    }
  }
  function exportInitialOptions(options) {var _dews$_environments;
    var defaultOptions2 = {
      type: "excel",
      applyDynamicStyles: true,
      allPages: true,
      target: "local",
      showProgress: true,
      progressMessage: dews.localize.get("\uC5D1\uC140 \uB0B4\uBCF4\uB0B4\uAE30 \uC911\uC785\uB2C8\uB2E4.", "dews_\uC5D1\uC140 \uB0B4\uBCF4\uB0B4\uAE30 \uC911\uC785\uB2C8\uB2E4."),
      numberCallback: function numberCallback(itemIndex, column, value) {
        return value;
      }
    };
    if (_typeof(options) === "object") {
      options.allItems = options.allPages || false;
    }
    var newOptions = $.extend(true, {}, defaultOptions2, options);
    if ((_dews$_environments = dews._environments) !== null && _dews$_environments !== void 0 && _dews$_environments.drmCreateDownload) {
      newOptions.target = "remote";
      newOptions.url = "/drmService/excel/create";
    }
    return newOptions;
  }

  // src/js/grid/excel/ExcelImporter.js
  var defaultOptions = {
    file: void 0,
    headerRowSize: 1
  };
  function ExcelImporter(grid2, options) {
    this.grid = grid2;
    this.options = configureInitialOptions(options);
  }
  ExcelImporter.prototype["import"] = function () {
    var self = this;
    var $dfd = $.Deferred();
    if (self.options.file.length !== 1) {
      $dfd.reject(new Error("\uD30C\uC77C\uC774 \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uAC70\uB098 \uC911\uBCF5 \uC81C\uACF5\uB418\uC5C8\uC2B5\uB2C8\uB2E4."));
    }
    var file = self.options.file[0];
    loadExcelLibrary().done(function () {
      self.loadExcelWorkbook(file).done(function (workbook) {
        if (opt.sheetName && !workbook.SheetNames.some(function (name) {
          return name === opt.sheetName;
        })) {
          $dfd.reject(new Error("\uC5D1\uC140 \uD30C\uC77C\uC5D0 \uC9C0\uC815\uD55C \uC774\uB984\uC758 \uC2DC\uD2B8\uAC00 \uC874\uC7AC\uD558\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4."));
        }
        var worksheet = self.options.sheetName ? workbook.Sheets[self.options.sheetName] : workbook.Sheets[workbook.SheetNames[0]];
        var importData = self.workSheetToImportData(worksheet);
      }).fail(function (err) {
        $dfd.reject(err);
      });
    }).fail(function () {
      $dfd.reject(new Error("\uC5D1\uC140 \uB77C\uC774\uBE0C\uB7EC\uB9AC\uC758 \uB85C\uB4DC\uAC00 \uC2E4\uD328\uD558\uC600\uC2B5\uB2C8\uB2E4."));
    });
    return $dfd.promise();
  };
  ExcelImporter.prototype.loadExcelWorkbook = function (file) {
    var self = this;
    var $dfd = $.Deferred();
    if (dews._environments.drm && dews._environments.drm.use) {
      self.extractDigitalRestrictions(file).done(function (extractedArray) {
        var workbook = XLSX.read(extractedArray, {
          type: "array",
          cellDates: true
        });
        $dfd.resolve(workbook);
      }).fail(function (err) {
        $dfd.reject(err);
      });
    } else {
      var reader = new FileReader();
      reader.onload = function (e) {
        var data = new Uint8Array(e.target.result);
        var workbook = XLSX.read(data, { type: "array", cellDates: true });
        $dfd.resolve(workbook);
      };
      reader.onerror = function () {
        $dfd.reject(new Error("\uD30C\uC77C\uC744 \uC77D\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."));
      };
      reader.readAsArrayBuffer(file);
    }
    return $dfd.promise();
  };
  ExcelImporter.prototype.extractDigitalRestrictions = function (file) {
    var $dfd = $.Deferred();
    if (dews._environments.drm && dews._environments.drm.url) {
      var url = dews._environments.drm.url;
      var token = dews.ui.page ? JSON.parse(dews.ui.page.token).access_token : "";
      var formData = new FormData();
      formData.append("token", token);
      formData.append("file", file);
      var xhr = new XMLHttpRequest();
      xhr.open("POST", url, true);
      xhr.responseType = "arraybuffer";
      xhr.addEventListener("load", function () {
        if (this.status === 200) {
          var data = new Uint8Array(this.response);
          $dfd.resolve(data);
        } else if (this.status === 204) {
          $dfd.reject(new Error("\uD30C\uC77C\uC5D0 \uB300\uD55C DRM \uD574\uC81C\uAC00 \uC2E4\uD328\uD558\uC600\uC2B5\uB2C8\uB2E4."));
        } else if (this.status === 401) {
          $dfd.reject(new Error("DRM \uD574\uC81C \uC11C\uBE44\uC2A4\uC5D0 \uC720\uD6A8\uD558\uC9C0 \uC54A\uC740 \uD1A0\uD070\uC774 \uC804\uB2EC\uB418\uC5C8\uC2B5\uB2C8\uB2E4."));
        } else {
          $dfd.reject(new Error("DRM \uD574\uC81C \uC11C\uBE44\uC2A4\uC5D0\uC11C \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4."));
        }
      });
      xhr.addEventListener("error", function () {
        $dfd.reject(new Error("DRM \uD574\uC81C \uC11C\uBE44\uC2A4\uB97C \uD638\uCD9C\uD558\uB294 \uC911 \uC54C\uC218 \uC5C6\uB294 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4."));
      });
      xhr.send(formData);
    } else {
      $dfd.reject(new Error("DRM \uD574\uC81C\uB97C \uC704\uD55C \uC11C\uBE44\uC2A4\uAC00 \uC81C\uACF5\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4."));
    }
    return $dfd.promise();
  };
  ExcelImporter.prototype.workSheetToImportData = function (worksheet) {
    var self = this;
    var importData, rawData;
    if (typeof self.options.rawConverter === "function") {
      rawData = XLSX.utils.sheet_to_json(worksheet, { header: 1, raw: true });
      importData = opt.rawConverter.call(this.grid, rawData);
    } else {
      if (self.options.titleDepth > 1) {
      } else {
      }
    }
    return importData;
  };
  function loadExcelLibrary() {
    return dews.ajax.script(dews._environments.scriptBase + "xlsx.js", {
      once: true
    });
  }
  function configureInitialOptions(options) {
    var newOptions = $.extend(true, {}, defaultOptions, options);
    if (typeof newOptions.titleDepth === "undefined") {
      newOptions.headerRowSize = newOptions.titleDepth;
      delete newOptions.titleDepth;
    }
    return newOptions;
  }

  // src/js/grid/column/customizingColumn.js
  function customizingColumn(columns, opt2, grid2) {
    if (columns && opt2.dataSource && opt2.dataSource.options.field) {
      var dataSource = opt2.dataSource.options;
      opt2.columnsDepth = opt2.columnsDepth + 1;
      var d = opt2.columnsDepth;
      $.each(columns, function (i) {
        if ($.type(columns[i]) !== "undefined") {
          columns[i].fieldName = columns[i].field;
          if ($.type(columns[i].editable) === "undefined") {
            columns[i].editable = true;
          }
          if ($.type(columns[i].field) !== "undefined") {
            columns[i].name = columns[i].field;
          }
          for (var f = 0; f < dataSource.field.length; f += 1) {
            if (columns[i].fieldName === dataSource.field[f].fieldName) {
              opt2.fieldIndex = f;
              break;
            }
            if (f === dataSource.field.length - 1) {
              opt2.fieldIndex = void 0;
            }
          }
          if ($.type(columns[i].styles) === "undefined") {
            columns[i].styles = {};
          }
          if ($.type(opt2.fieldIndex) !== "undefined" && $.type(dataSource.field[opt2.fieldIndex].styles) === "undefined") {
            dataSource.field[opt2.fieldIndex].styles = {};
          }
          if ($.type(columns[i].editor) === "undefined") {
            columns[i].editor = {
              type: "text"
            };
          }
          if ($.type(columns[i].width) === "undefined" && opt2.display.fitStyle === "fill") {
            columns[i].fillWidth = 1;
          }
          if ($.type(columns[i].width) !== "undefined" && dews.ui.gridUtil.gridStyle.fontSize !== 12) {
            var fontSize = dews.ui.gridUtil.gridStyle.fontSize;
            switch (fontSize) {
              case 15:
                columns[i].width = Math.floor(1.25 * columns[i].width);
                break;
              case 18:
                columns[i].width = Math.floor(1.5 * columns[i].width);
                break;
              case 24:
                columns[i].width = Math.floor(2 * columns[i].width);
                break;
              case 30:
                columns[i].width = Math.floor(2.5 * columns[i].width);
                break;}

          }
          if (columns[i].title) {
            columns[i].header = $.extend(true, columns[i].header, {
              text: columns[i].title,
              fixedHeight: opt2.display.rowIndex
            });
          } else {
            columns[i].header = {
              text: " "
            };
          }
          if (columns[i].headerCheck === true || _typeof(columns[i].headerCheck) === "object") {
            columns[i].header.checkLocation = typeof columns[i].headerCheck.location === "undefined" ? "right" : columns[i].headerCheck.location;
            grid2._grid.setColumnHeaderOptions({
              checkVisibility: "visible",
              imageCheckHandle: true,
              checkImages: {
                none: opt2.gridStyle.body.unCheckImg,
                hoveredNone: opt2.gridStyle.body.unCheckImg,
                fill: opt2.gridStyle.body.checkedImg,
                hoveredFill: opt2.gridStyle.body.checkedImg
              }
            });
          } else {
            columns[i].header.checkLocation = "none";
            grid2._grid.setColumnHeaderOptions({
              checkVisibility: "hidden",
              imageCheckHandle: false
            });
          }
          if ($.type(opt2.styles) !== "undefined" && $.type(opt2.styles.textAlign) !== "undefined") {
            columns[i].align = opt2.styles.textAlign;
          } else if ($.type(columns[i].align) === "undefined") {
            columns[i].align = "center";
          }
          if (columns[i].align) {
            var align;
            if (columns[i].align === "right") {
              align = "far";
            } else if (columns[i].align === "left") {
              align = "near";
            } else {
              align = "center";
            }
            columns[i].styles.textAlignment = align;
          }
          grid2._filterManager.columnOptionConvert(columns[i]);
          if (columns[i].formats) {
            if ($.type(columns[i].formats.type) === "undefined") {
              columns[i].formats.type = "text";
            }
            switch (columns[i].formats.type.toUpperCase()) {
              case "DATE":
                if (columns[i].formats.predefined === true) {
                  if ($.type(columns[i].formats.preFormat) === "undefined") {
                    columns[i].formats.preFormat = columns[i].formats.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].formats);
                  if (preDefinedFormat) {
                    columns[i].formats.format = preDefinedFormat;
                  } else {
                    columns[i].formats.format = dews._environments.formats.dateFormat;
                  }
                }
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                columns[i].styles.datetimeFormat = $.type(columns[i].formats.format) === "undefined" ? dews._environments.formats.dateFormat : columns[i].formats.format;
                break;
              case "LINK":
                columns[i].renderer = $.extend(true, columns[i].renderer, {
                  type: "link",
                  url: dews.url.getAbsoluteUrl("${" + columns[i].field + "}"),
                  showUrl: false,
                  useMenu: $.type(columns[i].formats.useMenu) === "boolean" ? columns[i].formats.useMenu : false,
                  cursor: "pointer"
                });
                break;
              case "MASK":
                var mask = columns[i].formats.format,replace = "",exp = "(",regchar = "",regcount = 1,expcount = 0;
                var predefined = columns[i].formats.predefined;
                var secureFormat = columns[i].formats.secureFormat;
                if (predefined) {
                  exp = "(.*)$";
                  replace = function replace(match) {
                    var groups = Array.prototype.splice.call(arguments, 1);
                    var orgValue = groups[groups.length - 1];
                    var chgValue = orgValue;
                    var secureMask = dews.getSecureMaskFormat(secureFormat);
                    if (mask && mask !== "") {
                      chgValue = dews.string.secureMask(chgValue, mask, false);
                    }
                    if (secureMask) {
                      chgValue = dews.string.secureMask(chgValue, secureFormat, true);
                    }
                    return chgValue;
                  };
                } else if (!predefined && secureFormat && secureFormat !== "") {
                  exp = "(.*)$";
                  replace = function replace(match) {
                    var groups = Array.prototype.splice.call(arguments, 1);
                    var orgValue = groups[groups.length - 1];
                    var chgValue = orgValue;
                    if (mask && mask !== "") {
                      chgValue = dews.string.secureMask(chgValue, mask, false);
                    }
                    if (secureFormat.match(/[,]/g) && secureFormat.match(/[,]/g).length > 1) {
                      chgValue = dews.string.secureMask(chgValue, secureFormat, false);
                    }
                    return chgValue;
                  };
                } else if (mask && mask !== "") {
                  for (var m = 0; m < mask.length; m += 1) {
                    if (mask[m] !== regchar && regchar === "*") {
                      exp += "{" + expcount + "})(";
                      expcount = 0;
                      regcount++;
                    }
                    switch (mask[m]) {
                      case "0":
                      case "9":
                        if (expcount === 0) {
                          exp += "\\d";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}\\d";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "#":
                        if (expcount === 0) {
                          exp += "\\d";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}\\d";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "L":
                        if (expcount === 0) {
                          exp += "[a-zA-Z]";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}[a-zA-Z]";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "?":
                        if (expcount === 0) {
                          exp += "[a-zA-Z]";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}[a-zA-Z]";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "&":
                        if (expcount === 0) {
                          exp += "\\S";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}\\S";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "C":
                        if (expcount === 0) {
                          exp += ".";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}.";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "A":
                      case "a":
                        if (expcount === 0) {
                          exp += "[a-zA-Z0-9]";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}[a-zA-Z0-9]";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "*":
                        if (expcount === 0) {
                          exp += "[a-zA-Z0-9]";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "})([a-zA-Z0-9]";
                          replace += "$" + regcount;
                          expcount = 0;
                          regcount++;
                        }
                        replace += "*";
                        regchar = mask[m];
                        expcount++;
                        break;
                      default:
                        if (mask[m] !== "*") {
                          replace += "$" + regcount + mask[m];
                        }
                        exp += "{" + expcount + "})(";
                        expcount = 0;
                        regcount++;
                        break;}

                    if (m === mask.length - 1) {
                      exp += "{" + expcount + "})";
                      if (regchar !== "*") {
                        replace += "$" + regcount;
                      }
                    }
                  }
                } else {
                  exp = "(.*)$";
                  replace = function replace(match) {
                    var groups = Array.prototype.splice.call(arguments, 1);
                    var orgValue = groups[groups.length - 1];
                    return orgValue;
                  };
                }
                columns[i].displayRegExp = exp;
                columns[i].displayReplace = replace;
                break;
              case "NUMBER":
                if (columns[i].formats.predefined === true) {
                  if ($.type(columns[i].formats.preFormat) === "undefined") {
                    columns[i].formats.preFormat = columns[i].formats.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].formats);
                  if ($.type(preDefinedFormat) === "object") {
                    columns[i].formats.round = preDefinedFormat.round;
                    preDefinedFormat = preDefinedFormat.format;
                  }
                  if (typeof columns[i].formats.currency === "string") {
                    columns[i].formats.preCurrency = columns[i].formats.currency;
                    preDefinedFormat = dews.getCurrencyFormat(columns[i].formats);
                    if ($.type(preDefinedFormat) === "object") {
                      columns[i].formats.round = preDefinedFormat.round;
                      preDefinedFormat = preDefinedFormat.format;
                    }
                  } else if (typeof columns[i].formats.currency === "function") {
                    delete columns[i].formats.round;
                    columns[i].formats.preCurrency = "";
                    columns[i].displayCallback = function (realgrid, index, value) {
                      var dewsGrid = $(realgrid._gv._container._containerDiv).closest(".dews-data-control").data("dews-control");
                      var dewsParams = {
                        grid: dewsGrid,
                        row: {
                          index: index.itemIndex,
                          data: dewsGrid.dataItem(index.itemIndex)
                        },
                        cell: {
                          field: index.column,
                          data: dewsGrid.getCellValue(index.itemIndex, index.column)
                        }
                      };
                      var dewsCol = dewsGrid.columns[index.column];
                      dewsCol.formats.preCurrency = dewsCol.formats.currency.call(
                      dewsCol,
                      dewsParams);

                      var env = dews.ui.page && dews.ui.page.env && dews.ui.page.env[dewsCol.formats.preFormat];
                      var predefinedFormat = dews.getCurrencyFormat(dewsCol.formats),formats = "#,###.##",round2 = "round";
                      if (env) {
                        formats = env.format;
                        round2 = dews.mathType[env.round];
                      }
                      if ($.type(predefinedFormat) === "object") {
                        formats = predefinedFormat.format;
                        round2 = $.type(predefinedFormat.round) === "string" ? predefinedFormat.round : round2;
                      } else if ($.type(predefinedFormat) === "string") {
                        formats = predefinedFormat;
                      }
                      if (round2 !== "round") {
                        if (formats.split(".").length === 2) {
                          var sosu = Math.pow(10, formats.split(".")[1].length);
                          if (round2 === "ceil") {
                            value = Math.ceil(value * sosu) / sosu;
                          } else {
                            value = Math.floor(value * sosu) / sosu;
                          }
                        }
                      }
                      var oldFormats = dewsGrid._grid.getColumnProperty(dewsCol.name, "excelFormat");
                      if (!oldFormats) {
                        dewsGrid._grid.setColumnProperty(dewsCol.name, "excelFormat", formats);
                      }
                      return dews.number.format(value, formats);
                    };
                  }
                  if (preDefinedFormat) {
                    columns[i].formats.format = preDefinedFormat;
                  } else {
                    columns[i].formats.format = "#,##0.##";
                  }
                }
                if ($.type(columns[i].formats.abs) === "boolean" && columns[i].formats.abs) {
                  columns[i].dynamicStyles = [
                  {
                    criteria: "value<0",
                    styles: {
                      foreground: $.type(columns[i].formats.negative) === "undefined" ? "#e62324" : columns[i].formats.negative,
                      numberFormat: columns[i].formats.format + ";a"
                    }
                  }];

                  if ($.type(columns[i].formats.positive) !== "undefined") {
                    columns[i].dynamicStyles.push({
                      criteria: "value>=0",
                      styles: {
                        foreground: columns[i].formats.positive,
                        numberFormat: columns[i].formats.format + ";a"
                      }
                    });
                  }
                }
                if (columns[i].formats.negativeColor) {var _dews$ui$page;
                  var useNegativeColor = false;
                  var MA00041 = (_dews$ui$page = dews.ui.page) === null || _dews$ui$page === void 0 ? void 0 : _dews$ui$page.env["MA00041"];
                  if (MA00041) {
                    useNegativeColor = MA00041.value === "2";
                  }
                  if (useNegativeColor) {
                    columns[i].dynamicStyles = [
                    {
                      criteria: "value<0",
                      styles: {
                        foreground: "#e62324"
                      }
                    }];

                  }
                }
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].dataType = "number";
                  dataSource.field[opt2.fieldIndex].min = columns[i].formats.min;
                  dataSource.field[opt2.fieldIndex].max = columns[i].formats.max;
                  dataSource.field[opt2.fieldIndex].styles.numberFormat = $.type(columns[i].formats.format) === "undefined" ? "#,##0.##" : columns[i].formats.format;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "number";
                  dataSource.schema.model.fields[opt2.fieldIndex].numberFormat = $.type(columns[i].formats.format) === "undefined" ? "#,##0.##" : columns[i].formats.format;
                }
                if ($.type(columns[i].formats.round) === "undefined" || columns[i].formats.round === "round") {
                  if ($.type(columns[i].formats.currency) !== "function") {
                    columns[i].styles.numberFormat = columns[i].formats.format;
                  }
                } else if (columns[i].formats.round === "ceil") {
                  columns[i].styles.numberFormat = columns[i].formats.format + ";;;c";
                } else if (columns[i].formats.round === "floor") {
                  columns[i].styles.numberFormat = columns[i].formats.format + ";;;f";
                }
                break;
              case "CHECK":
                columns[i].renderer = {
                  type: "check",
                  shape: "box",
                  editable: false,
                  startEditOnClick: true,
                  trueValues: $.type(columns[i].formats.trueValue) === "undefined" ? "true" : columns[i].formats.trueValue,
                  falseValues: $.type(columns[i].formats.falseValue) === "undefined" ? "false" : columns[i].formats.falseValue,
                  trueImage: opt2.gridStyle.body.checkedImg,
                  falseImage: opt2.gridStyle.body.unCheckImg,
                  labelPosition: "none",
                  showInnerFocus: false
                };
                columns[i].editable = false;
                columns[i].styles.figureBackground = "#ff4995ff";
                break;
              case "DATASOURCE":
                columns[i].values = [];
                columns[i].labels = [];
                columns[i].lookupDisplay = true;
                break;
              case "IMAGE":
                columns[i].editable = false;
                columns[i].renderer = {
                  type: "image",
                  smoothing: true
                };
                columns[i].styles.contentFit = "auto";
                break;
              case "TIME":
                if (columns[i].formats.predefined === true) {
                  if ($.type(columns[i].formats.preFormat) === "undefined") {
                    columns[i].formats.preFormat = columns[i].formats.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].formats);
                  if (preDefinedFormat) {
                    columns[i].formats.format = preDefinedFormat;
                  } else {
                    columns[i].formats.format = "HH:mm:ss";
                  }
                }
                var time = columns[i].formats.format,timeReg = "";
                if (/HH/gi.test(time)) {
                  timeReg = time.replace(/HH/gi, "$1");
                }
                if (/mm/gi.test(time)) {
                  timeReg = timeReg.replace(/mm/gi, "$2");
                }
                if (/ss/gi.test(time)) {
                  timeReg = timeReg.replace(/ss/gi, "$3");
                }
                columns[i].displayRegExp = /([0-1]\d|2[0-3])([0-5]\d)([0-5]\d)?/gi;
                columns[i].displayReplace = timeReg;
                break;
              case "PASSWORD":
                var format = columns[i].formats.format;
                columns[i].displayRegExp = /^.*$/gi;
                columns[i].displayReplace = format;
                break;
              case "MONTH":
                if (columns[i].formats.predefined === true) {
                  if ($.type(columns[i].formats.preFormat) === "undefined") {
                    columns[i].formats.preFormat = columns[i].formats.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].formats);
                  if (preDefinedFormat) {
                    columns[i].formats.format = preDefinedFormat;
                  } else {
                    columns[i].formats.format = dews._environments.formats.dateFormat;
                  }
                }
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                columns[i].styles.datetimeFormat = $.type(columns[i].formats.format) === "undefined" ? dews._environments.formats.monthFormat : columns[i].formats.format;
                break;
              case "FUNCTION":
                columns[i].displayCallback = function (realgrid, index, value) {
                  var dewsGrid = $(realgrid._gv._container._containerDiv).closest(".dews-data-control").data("dews-control");
                  var dewsParams = {
                    grid: dewsGrid,
                    row: {
                      index: index.itemIndex,
                      data: dewsGrid.dataItem(index.itemIndex)
                    },
                    cell: {
                      field: index.column,
                      data: dewsGrid.getCellValue(index.itemIndex, index.column)
                    }
                  };
                  return dewsGrid.columns[index.column].formats.format.call(dewsGrid, value, dewsParams);
                };
                break;
              case "BAR":
                var barRenderer = grid2._columnRenderer.getBarRenderer(columns[i]);
                $.extend(true, columns[i], barRenderer);
                break;
              case "SIGNAL":
                var signalRenderer = grid2._columnRenderer.getSignalRenderer(columns[i]);
                $.extend(true, columns[i], signalRenderer);
                break;}

          }
          if (columns[i].editor) {
            var editorAlign = "center";
            if (columns[i].styles.textAlignment) {
              editorAlign = columns[i].styles.textAlignment;
            }
            if ($.type(columns[i].editor.type) === "undefined") {
              columns[i].editor.type = "string";
            }
            if (typeof columns[i].editable === "boolean" && !columns[i].editable && columns[i].editor.type.toLowerCase() !== "check") {
              columns[i].editor.editable = columns[i].editable;
            } else {
              var userColumn;
              if (columns[i].editor.type.toLowerCase() === "check") {
                userColumn = findUserOptionsColumn2(grid2.userOptions.columns, columns[i].field);
              }
              if (userColumn && userColumn.editable !== void 0 && !userColumn.editable) {
                columns[i].editor.editable = columns[i].editable;
              } else {
                if ($.type(columns[i].editor.editable) === "boolean" || $.type(columns[i].editor.editable) === "function") {
                  columns[i].editable = columns[i].editor.editable;
                } else if ($.type(columns[i].editor.editable) === "undefined") {
                  columns[i].editor.editable = columns[i].editable;
                }
              }
            }
            columns[i].editor.textAlignment = editorAlign;
            columns[i].buttonVisibility = "hidden";
            columns[i].editButtonVisibility = "hidden";
            switch (columns[i].editor.type.toUpperCase()) {
              case "DROPDOWN":
              case "COMBO":
                var values = columns[i].editor.dataValueField,labels = columns[i].editor.dataTextField,datasource = columns[i].editor.dataSource;
                columns[i].values = [];
                columns[i].labels = [];
                columns[i].editButtonVisibility = "visible";
                if (columns[i].editor.type.toUpperCase() === "DROPDOWN") {
                  columns[i].editor.textReadOnly = true;
                  if (columns[i].editor.autoOpen) {
                    columns[i].editor.autoOpen = true;
                  }
                  columns[i].editor.useNumkey = $.type(columns[i].editor.useNumkey) === "boolean" ? columns[i].editor.useNumkey : true;
                } else {
                  columns[i].editor.textReadOnly = false;
                }
                columns[i].editor.type = "dropDown";
                columns[i].lookupDisplay = true;
                columns[i].editor.dropdowncount = 3;
                if ($.type(columns[i].editor.dataSource) === "function") {
                  datasource = columns[i].editor.dataSource.call(grid2, {
                    grid: grid2,
                    row: {
                      index: 0,
                      data: {
                        labels: "",
                        values: ""
                      }
                    }
                  });
                  if ($.type(columns[i].editor.dataTextField) === "undefined") {
                    columns[i].labelField = labels;
                  } else {
                    columns[i].labelField = columns[i].editor.textField;
                  }
                }
                if (typeof columns[i].editor.dataSelectable === "string") {
                  columns[i].editor.dataSelectable = {
                    field: columns[i].editor.dataSelectable,
                    trueValue: true,
                    falseValue: false
                  };
                }
                var dataSelectable = columns[i].editor.dataSelectable;
                columns[i].editor.values = [];
                columns[i].editor.labels = [];
                if (datasource && datasource.transport && datasource.transport.data && datasource.transport.data.length > 0) {
                  var transportData = datasource.transport.data;
                  for (var j = 0; j < datasource.transport.data.length; j += 1) {
                    columns[i].values.push(transportData[j][values]);
                    columns[i].labels.push(transportData[j][labels]);
                    if (dataSelectable && transportData[j][dataSelectable.field] !== dataSelectable.falseValue) {
                      columns[i].editor.values.push(datasource.transport.data[j][values]);
                      columns[i].editor.labels.push(datasource.transport.data[j][labels]);
                    }
                  }
                }
                break;
              case "NUMBER":
                if (columns[i].editor.predefined === true) {
                  if ($.type(columns[i].editor.preFormat) === "undefined") {
                    columns[i].editor.preFormat = columns[i].editor.format;
                  }
                  var preDefinedFormat;
                  if ($.type(columns[i].editor.currency) === "undefined") {
                    preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                  } else if ($.type(columns[i].editor.currency) === "string") {
                    columns[i].editor.preCurrency = columns[i].editor.currency;
                    preDefinedFormat = dews.getCurrencyFormat(columns[i].editor);
                  }
                  if ($.type(preDefinedFormat) === "object") {
                    preDefinedFormat = preDefinedFormat.format;
                  }
                  if (preDefinedFormat) {
                    columns[i].editor.format = preDefinedFormat;
                  } else {
                    columns[i].editor.format = "#,##0.##";
                  }
                } else {
                  columns[i].editor.format = columns[i].editor.format ? columns[i].editor.format : "#,##0.##";
                }
                var decimalPlaceRegex = /[^.]*$/;
                var includesDot = columns[i].editor.format.indexOf(".");
                var formatLetters = includesDot !== -1 ? decimalPlaceRegex.exec(columns[i].editor.format)[0] : "";
                var formatLettersLength = formatLetters.length;
                var formatLetter = formatLettersLength > 0 ? formatLetters.charAt(formatLettersLength - 1) : "#";
                var decimalLength, intLength, maxLength;
                if (typeof columns[i].editor.maxLength === "string") {
                  maxLength = columns[i].editor.maxLength;
                } else if (typeof columns[i].editor.__maxLength === "string") {
                  maxLength = columns[i].editor.__maxLength;
                }
                if ($.type(maxLength) === "string") {
                  var maxLengthRegex = /^(\d+)(?:,(\d+))?$/;
                  var matchArray = maxLengthRegex.exec(maxLength);
                  columns[i].editor.__maxLength = maxLength;
                  if (matchArray && matchArray.length > 0) {
                    intLength = parseInt(matchArray[1], 10);
                    try {
                      if (intLength > 15) {
                        throw "\uC22B\uC790\uD14D\uC2A4\uD2B8\uBC15\uC2A4 maxLength \uC18D\uC131\uC758 \uC124\uC815 \uAC00\uB2A5\uD55C \uCD5C\uB300\uAC12\uC740 15\uC785\uB2C8\uB2E4.";
                      }
                      if (matchArray[2]) {
                        var newFormat;
                        decimalLength = parseInt(matchArray[2], 10);
                        intLength = intLength - decimalLength;
                        if (intLength <= 0) {
                          throw "\uC22B\uC790\uD14D\uC2A4\uD2B8\uBC15\uC2A4 maxLength \uC18D\uC131\uC758 \uC124\uC815\uAC12\uC740 \uC815\uC218\uBD80\uC758 \uC22B\uC790\uAC00 \uC18C\uC218\uBD80\uC758 \uC22B\uC790\uBCF4\uB2E4 \uCEE4\uC57C\uD569\uB2C8\uB2E4.";
                        }
                        if (formatLettersLength > decimalLength) {
                          newFormat = (includesDot !== -1 ? columns[i].editor.format.replace(decimalPlaceRegex, "") : columns[i].editor.format + ".") + formatLetters.substr(0, decimalLength);
                        } else if (formatLettersLength < decimalLength) {
                          newFormat = (includesDot !== -1 ? columns[i].editor.format.replace(decimalPlaceRegex, "") : columns[i].editor.format + ".") + formatLetters + formatLetter.repeat(decimalLength - formatLettersLength);
                        } else {
                          newFormat = columns[i].editor.format;
                        }
                        columns[i].editor.format = newFormat;
                      } else {
                        columns[i].editor.format = columns[i].editor.format.split(".")[0];
                      }
                    } catch (e) {
                      intLength = 15 - formatLettersLength;
                      console.error(e);
                    }
                    columns[i].editor.maxIntegerLength = intLength;
                  }
                  columns[i].editor.maxLength = 0;
                } else if (typeof maxLength === "undefined") {
                  columns[i].editor.maxIntegerLength = 15 - formatLettersLength;
                }
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].dataType = "number";
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "number";
                  dataSource.field[opt2.fieldIndex].min = columns[i].editor.min;
                  dataSource.field[opt2.fieldIndex].max = columns[i].editor.max;
                }
                columns[i].editor.editFormat = $.type(columns[i].editor.format) === "undefined" ? "#,##0.##" : columns[i].editor.format;
                columns[i].editor.increaseValue = $.type(columns[i].editor.increaseValue) === "undefined" ? 1e3 : parseFloat(columns[i].editor.increaseValue);
                columns[i].editor.increaseType = $.type(columns[i].editor.increaseType) === "undefined" ? "multiple" : columns[i].editor.increaseType;
                break;
              case "STRING":
                columns[i].editor.type = "text";
                break;
              case "DATE":
                if (columns[i].editor.predefined === true) {
                  if ($.type(columns[i].editor.preFormat) === "undefined") {
                    columns[i].editor.preFormat = columns[i].editor.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                  if (preDefinedFormat) {
                    columns[i].editor.format = preDefinedFormat;
                  } else {
                    columns[i].editor.format = dews._environments.formats.dateFormat;
                  }
                }
                columns[i].editor.maxDate = new Date(9999, 12, 0);
                columns[i].editor.minDate = new Date(1e3, 0, 1);
                columns[i].editor.yearDisplayFormat = "{Y}" + dews.localize.get("\uB144", "dews_\uB144Y");
                columns[i].editor.months = dews.localize.getMonth();
                columns[i].editor.weekDays = dews.localize.getDays();
                columns[i].editor.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.dateFormat : columns[i].editor.format;
                columns[i].styles.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.dateFormat : columns[i].editor.format;
                columns[i].editor.mask = {
                  editMask: $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.dateFormat.replace(/[A-z\\s]/gi, "9") : columns[i].editor.format.replace(/[A-z\\s]/gi, "9"),
                  includedFormat: true
                };
                columns[i].editButtonVisibility = "visible";
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                break;
              case "READONLY":
                columns[i].readOnly = true;
                columns[i].editable = false;
                break;
              case "MASK":
              case "TIME":
                var editMask = columns[i].editor.format;
                if (editMask) {
                  for (var em = 0; em < editMask.length; em += 1) {
                    switch (editMask[em]) {
                      case "L":
                      case "?":
                      case "#":
                      case "&":
                        editMask = editMask.replace(editMask[em], "a");
                        break;
                      case "A":
                      case "a":
                        editMask = editMask.replace(editMask[em], "*");
                        break;
                      case "H":
                      case "m":
                      case "s":
                        editMask = editMask.replace(editMask[em], "0");
                        break;}

                  }
                }
                if (columns[i].editor.type.toUpperCase() === "TIME") {
                  columns[i].editor.type = "time";
                  if (columns[i].editor.predefined === true) {
                    if ($.type(columns[i].editor.preFormat) === "undefined") {
                      columns[i].editor.preFormat = columns[i].editor.format;
                    }
                    var preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                    if (preDefinedFormat) {
                      editMask = preDefinedFormat;
                    } else {
                      editMask = "HH:mm:ss";
                    }
                  }
                  var secondValue = false;
                  if (typeof columns[i].editor.secondValue === "boolean" && columns[i].editor.secondValue === true) {
                    secondValue = true;
                  }
                  columns[i].button = "image";
                  columns[i].buttonVisibility = "visible";
                  if ($.type(columns[i].editor.editable) === "boolean" && !columns[i].editor.editable) {
                    columns[i].buttonVisibility = "hidden";
                  }
                  var clockIcon = dews._environments.scriptBase + "realgrid/assets/comp-icon-clock.png";
                  columns[i].imageButtons = {
                    width: 24,
                    height: 22,
                    images: [
                    {
                      name: "timebutton",
                      up: clockIcon,
                      hover: clockIcon,
                      down: clockIcon
                    }]

                  };
                  if ($("#" + grid2._grid.name + "_time").length === 0) {
                    var timepicker = $('<input class="dews-ui-timepicker">');
                    timepicker.prop("id", grid2._grid.name + "_time");
                    $("body").after(timepicker);
                    columns[i].timepicker = dews.ui.timepicker(timepicker, {
                      secondValue: secondValue
                    });
                    $("body").after(columns[i].timepicker.timeView.ul.parent(".k-list-container"));
                  } else {
                    columns[i].timepicker = dews.ui.timepicker($("#" + grid2._grid.name + "_time"));
                  }
                  columns[i].timepicker.wrapper.css({
                    display: "none",
                    height: opt2.display.rowHeight
                  });
                } else {
                  columns[i].editor.type = "text";
                }
                if ($.type(editMask) === "function") {
                  columns[i].editor.mask = {
                    allowEmpty: true
                  };
                } else {
                  if (editMask !== "") {
                    columns[i].editor.mask = {
                      editMask: editMask,
                      allowEmpty: true
                    };
                  }
                }
                break;
              case "CODEPICKER":
                columns[i].editor.firstClick = true;
                columns[i].button = "image";
                columns[i].buttonVisibility = "visible";
                if ($.type(columns[i].editor.editable) === "boolean") {
                  if (!columns[i].editor.editable) {
                    columns[i].buttonVisibility = "hidden";
                  }
                }
                columns[i].imageButtons = {
                  width: 24,
                  height: 22,
                  images: [
                  {
                    name: "codepickerbutton",
                    up: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
                    hover: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
                    down: dews._environments.scriptBase + "realgrid/assets/search_ico.png"
                  }]

                };
                opt2._grid = true;
                columns[i].codeOption = {
                  field: columns[i].field,
                  code: columns[i].editor.helpCode,
                  codeField: columns[i].editor.codeField,
                  textField: columns[i].editor.textField,
                  gridCodeField: columns[i].editor.gridCodeField,
                  gridTextField: columns[i].editor.gridTextField,
                  params: columns[i].editor.helpParams,
                  size: columns[i].editor.helpSize,
                  title: columns[i].editor.helpTitle,
                  mode: "single",
                  width: columns[i].editor.helpWidth,
                  height: columns[i].editor.helpHeight,
                  initData: columns[i].editor.initData,
                  callback: columns[i].editor.callback,
                  custom: columns[i].editor.helpCustom || false,
                  viewUrl: columns[i].editor.helpViewUrl,
                  apiUrl: columns[i].editor.helpApiUrl,
                  moveFocus: $.type(columns[i].editor.moveFocus) === "boolean" ? columns[i].editor.moveFocus : true,
                  useAjax: $.type(columns[i].editor.useAjax) === "boolean" ? columns[i].editor.useAjax : true,
                  validation: $.type(columns[i].editor.validation) === "boolean" ? columns[i].editor.validation : true,
                  value: {}
                };
                break;
              case "BUTTON":
                columns[i].buttonVisibility = "always";
                if ($.type(columns[i].editor.align) !== "undefined") {
                  switch (columns[i].editor.align.toLowerCase()) {
                    case "left":
                      columns[i].editor.align = "near";
                      break;
                    case "right":
                      columns[i].editor.align = "far";
                      break;}

                }
                columns[i].renderer = {
                  type: "imageButtons",
                  showText: true,
                  width: $.type(columns[i].editor.buttonWidth) === "undefined" ? 50 : columns[i].editor.buttonWidth,
                  height: $.type(columns[i].editor.buttonHeight) === "undefined" ? 25 : columns[i].editor.buttonHeight,
                  images: {
                    up: columns[i].editor.basicImg,
                    hover: columns[i].editor.hoverImg,
                    down: columns[i].editor.clickImg,
                    width: $.type(columns[i].editor.buttonWidth) === "undefined" ? 50 : columns[i].editor.buttonWidth
                  },
                  alignment: columns[i].editor.align ? columns[i].editor.align : "center",
                  margin: columns[i].editor.align === "far" ? -4 : 0
                };
                break;
              case "CHECK":
                columns[i].renderer = {
                  type: "check",
                  shape: "box",
                  editable: $.type(columns[i].editor.editable) === "boolean" ? columns[i].editor.editable : true,
                  startEditOnClick: true,
                  trueValues: $.type(columns[i].editor.trueValue) === "undefined" ? "true" : columns[i].editor.trueValue,
                  falseValues: $.type(columns[i].editor.falseValue) === "undefined" ? "false" : columns[i].editor.falseValue,
                  trueImage: opt2.gridStyle.body.checkedImg,
                  falseImage: opt2.gridStyle.body.unCheckImg,
                  labelPosition: "none",
                  showInnerFocus: false
                };
                columns[i].editable = false;
                columns[i].styles.figureBackground = "#ff4995ff";
                break;
              case "ZIPCODEPICKER":
                columns[i].button = "image";
                columns[i].buttonVisibility = "visible";
                if ($.type(columns[i].editor.editable) === "boolean" && !columns[i].editor.editable) {
                  columns[i].buttonVisibility = "hidden";
                }
                columns[i].imageButtons = {
                  width: 24,
                  height: 22,
                  images: [
                  {
                    name: "zipcodepickerbutton",
                    up: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
                    hover: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
                    down: dews._environments.scriptBase + "realgrid/assets/search_ico.png"
                  }]

                };
                opt2._grid = true;
                columns[i].codeOption = {
                  field: columns[i].field,
                  addressType: $.type(columns[i].editor.addressType) === "undefined" ? "zipcode" : columns[i].editor.addressType,
                  callback: columns[i].editor.callback
                };
                break;
              case "MULTILINE":
                columns[i].editor.type = "multiline";
                columns[i].styles.textWrap = "explicit";
                break;
              case "MONTH":
                if (columns[i].editor.predefined === true) {
                  if ($.type(columns[i].editor.preFormat) === "undefined") {
                    columns[i].editor.preFormat = columns[i].editor.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                  if (preDefinedFormat) {
                    columns[i].editor.format = preDefinedFormat;
                  } else {
                    columns[i].editor.format = dews._environments.formats.monthFormat;
                  }
                }
                columns[i].editor.minDate = new Date(1900, 0, 1);
                columns[i].editor.maxDate = new Date(2100, 12, 0);
                columns[i].editor.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.monthFormat : columns[i].editor.format;
                columns[i].styles.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.monthFormat : columns[i].editor.format;
                columns[i].editor.mask = {
                  editMask: $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.monthFormat.replace(/[A-z\\s]/gi, "9") : columns[i].editor.format.replace(/[A-z\\s]/gi, "9"),
                  includedFormat: true
                };
                columns[i].button = "image";
                columns[i].buttonVisibility = "visible";
                if ($.type(columns[i].editor.editable) === "boolean" && !columns[i].editor.editable) {
                  columns[i].buttonVisibility = "hidden";
                }
                columns[i].imageButtons = {
                  width: 24,
                  height: 22,
                  images: [
                  {
                    name: "monthbutton",
                    up: dews._environments.scriptBase + "realgrid/assets/calendar_up.png",
                    hover: dews._environments.scriptBase + "realgrid/assets/calendar_hover.png",
                    down: dews._environments.scriptBase + "realgrid/assets/calendar_down.png"
                  }]

                };
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                if ($("#" + grid2._grid.name + "_month").length === 0) {
                  var monthpicker = $('<input class="dews-ui-monthpicker">');
                  monthpicker.prop("id", grid2._grid.name + "_month");
                  $("body").after(monthpicker);
                  columns[i].monthpicker = dews.ui.monthpicker(monthpicker);
                  $("body").after(columns[i].monthpicker.dateView.div);
                } else {
                  columns[i].monthpicker = dews.ui.monthpicker($("#" + grid2._grid.name + "_month"));
                }
                columns[i].monthpicker.wrapper.css({
                  display: "none",
                  height: opt2.display.rowHeight
                });
                break;
              case "YEAR":
                if (columns[i].editor.predefined === true) {
                  if ($.type(columns[i].editor.preFormat) === "undefined") {
                    columns[i].editor.preFormat = columns[i].editor.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                  if (preDefinedFormat) {
                    columns[i].editor.format = preDefinedFormat;
                  } else {
                    columns[i].editor.format = dews._environments.formats.yearFormat;
                  }
                }
                columns[i].editor.minDate = new Date(1900, 0, 1);
                columns[i].editor.maxDate = new Date(2100, 12, 0);
                columns[i].editor.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.yearFormat : columns[i].editor.format;
                columns[i].styles.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.yearFormat : columns[i].editor.format;
                columns[i].editor.mask = {
                  editMask: $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.yearFormat.replace(/[A-z\\s]/gi, "9") : columns[i].editor.format.replace(/[A-z\\s]/gi, "9"),
                  includedFormat: true
                };
                columns[i].button = "image";
                columns[i].buttonVisibility = "visible";
                if ($.type(columns[i].editor.editable) === "boolean" && !columns[i].editor.editable) {
                  columns[i].buttonVisibility = "hidden";
                }
                columns[i].imageButtons = {
                  width: 24,
                  height: 22,
                  images: [
                  {
                    name: "yearbutton",
                    up: dews._environments.scriptBase + "realgrid/assets/calendar_up.png",
                    hover: dews._environments.scriptBase + "realgrid/assets/calendar_hover.png",
                    down: dews._environments.scriptBase + "realgrid/assets/calendar_down.png"
                  }]

                };
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.yearValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.yearValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                if ($("#" + grid2._grid.name + "_year").length === 0) {
                  var yearpicker = $('<input class="dews-ui-yearpicker">');
                  yearpicker.prop("id", grid2._grid.name + "_year");
                  $("body").after(yearpicker);
                  columns[i].yearpicker = dews.ui.yearpicker(yearpicker, {});
                  $("body").after(columns[i].yearpicker.dateView.div);
                } else {
                  columns[i].yearpicker = dews.ui.yearpicker($("#" + grid2._grid.name + "_year"));
                }
                columns[i].yearpicker.wrapper.css({
                  display: "none",
                  height: opt2.display.rowHeight
                });
                break;}

          }
          if (columns[i].attributes) {
            if (columns[i].attributes["class"] === "required" || columns[i].attributes["class"] === "none") {
              columns[i].styles.background = columns[i].attributes["class"] === "required" ? opt2.gridStyle.body.requiredBackground : opt2.gridStyle.body.background;
              columns[i].readOnly = false;
              if (columns[i].editor && columns[i].editor.type && columns[i].editor.type.toUpperCase() === "DROPDOWN" && grid2.userOptions) {
                var currentColumn = findUserOptionsColumn2(grid2.userOptions.columns, columns[i].field);
                columns[i].editor.textReadOnly = currentColumn && currentColumn.editor && currentColumn.editor.type && currentColumn.editor.type.toUpperCase() === "COMBO" ? false : true;
              }
            } else if (columns[i].attributes["class"] === "readonly") {
              columns[i].styles.background = opt2.gridStyle.body.readonlyBackground;
              columns[i].readOnly = true;
              columns[i].editable = false;
            }
          }
          if (columns[i].footer) {
            opt2.footer.visible = true;
            if (opt2.multiFooterCnt > 1) {
              opt2.footer.count = opt2.multiFooterCnt;
              opt2.footer.minHeight = 32 * opt2.multiFooterCnt;
              var multiFooterArray = [];
              if ($.type(columns[i].footer) === "object") {
                multiFooterArray.push(columns[i].footer);
              } else if ($.type(columns[i].footer) === "array") {
                multiFooterArray = columns[i].footer;
              }
              var footerStyles = [];
              var footerExpression = [];
              var footerPreCurrency = [];
              var footerPreFormat = [];
              var footerText = [];
              for (var footerIdx = 0; footerIdx < multiFooterArray.length; footerIdx++) {
                footerStyles.push({});
                if (multiFooterArray[footerIdx].text) {
                  footerText[footerIdx] = multiFooterArray[footerIdx].text;
                }
                if (multiFooterArray[footerIdx].styles === void 0) {
                  var footerAlign = "center";
                  if (columns[i].styles.textAlignment) {
                    footerAlign = columns[i].styles.textAlignment;
                  }
                  footerStyles[footerIdx].textAlignment = footerAlign;
                }
                if ($.type(multiFooterArray[footerIdx].align) !== "undefined") {
                  switch (multiFooterArray[footerIdx].align.toLowerCase()) {
                    case "left":
                      footerStyles[footerIdx].textAlignment = "near";
                      break;
                    case "right":
                      footerStyles[footerIdx].textAlignment = "far";
                      break;
                    default:
                      footerStyles[footerIdx].textAlignment = "center";
                      break;}

                }
                if (multiFooterArray[footerIdx].type) {
                  if ($.type(opt2.fieldIndex) !== "undefined" && multiFooterArray[footerIdx].type.toLowerCase() !== "count") {
                    dataSource.field[opt2.fieldIndex].dataType = "number";
                    dataSource.schema.model.fields[opt2.fieldIndex].dataType = "number";
                  }
                  footerExpression[footerIdx] = multiFooterArray[footerIdx].type;
                  footerStyles[footerIdx].numberFormat = $.type(multiFooterArray[footerIdx].format) === "undefined" ? "#,##0.##" : multiFooterArray[footerIdx].format;
                  if (multiFooterArray[footerIdx].predefined === true) {
                    if ($.type(footerPreFormat[footerIdx]) === "undefined" || footerPreFormat[footerIdx].preFormat !== footerPreFormat[footerIdx].format) {
                      footerPreFormat[footerIdx] = multiFooterArray[footerIdx].format;
                      multiFooterArray[footerIdx].preFormat = multiFooterArray[footerIdx].format;
                    }
                    var preDefinedFormat = dews.getPreDefinedFormat(multiFooterArray[footerIdx]);
                    if ($.type(multiFooterArray[footerIdx].currency) !== "undefined") {
                      if ($.type(multiFooterArray[footerIdx].currency) === "string") {
                        footerPreCurrency[footerIdx] = multiFooterArray[footerIdx].currency;
                        multiFooterArray[footerIdx].preCurrency = multiFooterArray[footerIdx].currency;
                        preDefinedFormat = dews.getCurrencyFormat(multiFooterArray[footerIdx]);
                        if (preDefinedFormat) {
                          var round = $.type(preDefinedFormat.round) === "string" ? preDefinedFormat.round : "round";
                          if (round !== "round") {
                            if (preDefinedFormat.format.split(".").length === 2) {
                              if (round === "ceil") {
                                preDefinedFormat.format += ";;;c";
                              } else {
                                preDefinedFormat.format += ";;;f";
                              }
                            }
                          }
                        }
                      } else if ($.type(multiFooterArray[footerIdx].currency) === "function") {
                        footerPreCurrency[footerIdx] = "";
                        multiFooterArray[footerIdx].preCurrency = "";
                        grid2._grid._gv._footer._cell.__proto__.value = _displayFooterText();
                      }
                    }
                    if ($.type(preDefinedFormat) === "object") {
                      preDefinedFormat = preDefinedFormat.format;
                    }
                    if (preDefinedFormat) {
                      footerStyles[footerIdx].numberFormat = preDefinedFormat;
                    } else {
                      footerStyles[footerIdx].numberFormat = "#,##0.##";
                    }
                  }
                }
                if (multiFooterArray[footerIdx].prefix) {
                  footerStyles[footerIdx].prefix = multiFooterArray[footerIdx].prefix;
                }
                if (multiFooterArray[footerIdx].suffix) {
                  footerStyles[footerIdx].suffix = multiFooterArray[footerIdx].suffix;
                }
              }
              columns[i].footer.styles = footerStyles;
              columns[i].footer.expression = footerExpression;
              columns[i].footer.preCurrency = footerPreCurrency;
              columns[i].footer.preFormat = footerPreFormat;
              columns[i].footer.text = footerText;
            } else {
              opt2.footer.count = 1;
              if (columns[i].footer.styles === void 0) {
                var footerAlign = "center";
                if (columns[i].styles.textAlignment) {
                  footerAlign = columns[i].styles.textAlignment;
                }
                columns[i].footer.styles = {
                  textAlignment: footerAlign
                };
              }
              if ($.type(columns[i].footer.align) !== "undefined") {
                switch (columns[i].footer.align.toLowerCase()) {
                  case "left":
                    columns[i].footer.styles.textAlignment = "near";
                    break;
                  case "right":
                    columns[i].footer.styles.textAlignment = "far";
                    break;
                  default:
                    columns[i].footer.styles.textAlignment = "center";
                    break;}

              }
              if (columns[i].footer.type) {
                if ($.type(opt2.fieldIndex) !== "undefined" && columns[i].footer.type.toLowerCase() !== "count") {
                  dataSource.field[opt2.fieldIndex].dataType = "number";
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "number";
                }
                columns[i].footer.expression = columns[i].footer.type;
                columns[i].footer.styles.numberFormat = $.type(columns[i].footer.format) === "undefined" ? "#,##0.##" : columns[i].footer.format;
                if (columns[i].footer.predefined === true) {
                  if ($.type(columns[i].footer.preFormat) === "undefined" || columns[i].footer.preFormat !== columns[i].footer.format) {
                    columns[i].footer.preFormat = columns[i].footer.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].footer);
                  if ($.type(columns[i].footer.currency) !== "undefined") {
                    if ($.type(columns[i].footer.currency) === "string") {
                      columns[i].footer.preCurrency = columns[i].footer.currency;
                      preDefinedFormat = dews.getCurrencyFormat(columns[i].footer);
                      if (preDefinedFormat) {
                        var round = $.type(preDefinedFormat.round) === "string" ? preDefinedFormat.round : "round";
                        if (round !== "round") {
                          if (preDefinedFormat.format.split(".").length === 2) {
                            if (round === "ceil") {
                              preDefinedFormat.format += ";;;c";
                            } else {
                              preDefinedFormat.format += ";;;f";
                            }
                          }
                        }
                      }
                    } else if ($.type(columns[i].footer.currency) === "function") {
                      columns[i].footer.preCurrency = "";
                      grid2._grid._gv._footer._cell.__proto__.value = _displayFooterText();
                    }
                  }
                  if ($.type(preDefinedFormat) === "object") {
                    preDefinedFormat = preDefinedFormat.format;
                  }
                  if (preDefinedFormat) {
                    columns[i].footer.styles.numberFormat = preDefinedFormat;
                  } else {
                    columns[i].footer.styles.numberFormat = "#,##0.##";
                  }
                }
              }
              if (columns[i].footer.group) {
                columns[i].footer.groupExpression = columns[i].footer.group.type;
                if (columns[i].footer.group.text) {
                  columns[i].footer.groupText = columns[i].footer.group.text;
                }
              }
              if (columns[i].footer.prefix) {
                columns[i].footer.styles.prefix = columns[i].footer.prefix;
              }
              if (columns[i].footer.suffix) {
                columns[i].footer.styles.suffix = columns[i].footer.suffix;
              }
            }
          }
          if (columns[i].suffix) {
            columns[i].styles.suffix = columns[i].suffix;
          }
          if (columns[i].prefix) {
            columns[i].styles.prefix = columns[i].prefix;
          }
          if ($.type(columns[i].style) === "function") {
            opt2.styleColumn.push(columns[i].field);
          }
          if ($.type(columns[i].grouping) === "boolean" && columns[i].grouping) {
            columns[i].type = "group";
            columns[i].orientation = "vertical";
            opt2.grouping = true;
            opt2.groupCol = columns[i].columns.length;
            if (opt2.groupCol > opt2.maxGroupCol) {
              opt2.maxGroupCol = opt2.groupCol;
            }
          }
          if ($.type(columns[i].multiColumnHeight) !== "undefined") {
            if ($.type(columns[i].multiColumnHeight) === "number") {
              columns[i].multiColumnHeight = {
                header: columns[i].multiColumnHeight,
                row: columns[i].multiColumnHeight
              };
            }
          } else {
            columns[i].multiColumnHeight = {};
          }
          if ($.type(columns[i].multiColumnHeight.header) === "number") {
            columns[i].header.fillHeight = columns[i].multiColumnHeight.header;
            columns[i].header.minHeight = columns[i].multiColumnHeight.header;
            columns[i].header.fixedHeight = columns[i].multiColumnHeight.header;
          } else if ($.type(columns[i].multiColumnHeight.header) === "undefined") {
            columns[i].header.fillHeight = opt2.header.minHeight;
            columns[i].header.minHeight = opt2.header.minHeight;
            columns[i].header.fixedHeight = opt2.header.minHeight;
          }
          if ($.type(columns[i].multiColumnHeight.row) === "number") {
            columns[i].height = columns[i].multiColumnHeight.row;
            columns[i].fillHeight = columns[i].multiColumnHeight.row;
            columns[i].minHeight = columns[i].multiColumnHeight.row;
            columns[i].fixedHeight = columns[i].multiColumnHeight.row;
          } else if ($.type(columns[i].multiColumnHeight.row) === "undefined") {
            columns[i].fillHeight = opt2.display.rowHeight;
            columns[i].minHeight = opt2.display.rowHeight;
            columns[i].fixedHeight = opt2.display.rowHeight;
          }
          if (columns[i].columns) {
            columns[i].type = "group";
            if (!columns[i].hideChildHeaders) {
              opt2.depth += 1;
            }
            if ($.type(columns[i].name) === "undefined") {
              if (columns[0].field === "__UUID") {
                columns[i].name = "_he@der_name_" + d + (i - 1);
              } else {
                columns[i].name = "_he@der_name_" + d + i;
              }
            }
            if ($.type(columns[i].visible) === "boolean") {
              if (grid2._hideChildrenColumns && grid2._hideChildrenColumns[columns[i].name]) {
                columns[i].visible = false;
              } else {
                columns[i].header.visible = columns[i].visible;
              }
            } else if (columns[i].visible === "hideChildren") {
              columns[i].visible = false;
            }
            customizingColumn(columns[i].columns, opt2, grid2);
          } else {
            if (opt2.depth > opt2.maxDepth) {
              opt2.maxDepth = opt2.depth;
            }
            opt2.depth = 1;
          }
          if ($.type(columns[i].merge) !== "undefined") {
            if ($.type(columns[i].merge.verticalTop) === "boolean" && columns[i].merge.verticalTop) {
              columns[i].equalBlank = true;
            } else {
              columns[i].mergeRule = {};
              if ($.type(columns[i].merge) === "boolean") {
                columns[i].mergeRule.criteria = columns[i].merge ? "value" : "";
              } else if ($.type(columns[i].merge) === "string") {
                columns[i].mergeRule.criteria = "values['" + columns[i].merge + "'] + value";
              } else if ($.type(columns[i].merge) === "object") {
                opt2.display.showInnerFocus = $.type(columns[i].merge.innerFocus) === "undefined" ? true : columns[i].merge.innerFocus;
                columns[i].mergeRule.criteria = $.type(columns[i].merge.referenceField) !== "undefined" ? "values['" + columns[i].merge.referenceField + "'] + value" : "value";
              }
            }
          }
        }
      });
      opt2.columns = columns;
      opt2.dataSource.options = dataSource;
      grid2.dataSource = opt2.dataSource;
    }
    return opt2;
  }
  function findUserOptionsColumn2(columns, fieldName, userColumn) {
    if (!columns)
    return null;
    for (var index = 0; index < columns.length; index++) {
      if (userColumn === void 0) {
        if (columns[index].field === fieldName) {
          userColumn = columns[index];
        } else if (columns[index].columns) {
          userColumn = findUserOptionsColumn2(columns[index].columns, fieldName, userColumn);
        }
      }
    }
    return userColumn;
  }
  function _displayFooterText() {
    return function () {
      var grid2 = $(this._index._column.grid()._container._containerDiv).closest(".dews-data-control").data("dews-control");
      if (grid2 === void 0 || grid2 === null) {
        return null;
      }
      var cols = grid2.columns;
      var col = grid2.columns[this._index._column._fieldName];
      var fieldName = this._index._column._fieldName;
      if (col.footer && col.footer.predefined && col.footer.format && col.footer.currency && $.type(col.footer.currency) === "function") {
        var params = {
          grid: grid2,
          column: cols
        };
        col.footer.preCurrency = col.footer.currency.call(grid2, params);
        grid2._innerOptions.columns.some(function (value, idx) {
          if (value.fieldName === fieldName) {
            grid2._innerOptions.columns[idx].footer.preCurrency = col.footer.preCurrency;
          }
        });
        var env = dews.ui.page && dews.ui.page.env && dews.ui.page.env[col.footer.preFormat];
        var predefinedFormat = dews.getCurrencyFormat(col.footer);
        var formats = "#,###.##";
        var round = "round";
        if (env) {
          formats = env.format;
          round = dews.mathType[env.round];
        }
        if ($.type(predefinedFormat) === "object") {
          formats = predefinedFormat.format;
          round = $.type(predefinedFormat.round) === "string" ? predefinedFormat.round : round;
        } else if ($.type(predefinedFormat) === "string") {
          formats = predefinedFormat;
        }
        if (round !== "round") {
          if (formats.split(".").length === 2) {
            if (round === "ceil") {
              formats += ";;;c";
            } else {
              formats += ";;;f";
            }
          }
        }
        var column = grid2._grid.columnByField(this._index._column._fieldName);
        var numberFormat = grid2._grid.getColumnProperty(column, "footer").styles.numberFormat;
        if (numberFormat !== formats) {
          grid2._grid.setColumnProperty(column, "footer", {
            styles: {
              numberFormat: formats
            }
          });
        }
      }
      if (col.footer && col.footer.length > 1) {
        var fieldName = this._index._column._fieldName;
        var columnIndex = grid2.options.columns.findIndex(function (column2) {
          return column2.field === fieldName;
        });
        for (var footerIdx = 0; footerIdx < col.footer.length; footerIdx++) {
          if (col.footer[footerIdx].predefined && col.footer[footerIdx].format && col.footer[footerIdx].currency && $.type(col.footer[footerIdx].currency) === "function") {
            var params = {
              grid: grid2,
              column: cols
            };
            col.footer[footerIdx].preCurrency = col.footer[footerIdx].currency.call(grid2, params);
            var env = dews.ui.page && dews.ui.page.env && dews.ui.page.env[col.footer[footerIdx].preFormat];
            var predefinedFormat = dews.getCurrencyFormat(col.footer[footerIdx]);
            var formats = "#,###.##";
            var round = "round";
            if (env) {
              formats = env.format;
              round = dews.mathType[env.round];
            }
            if ($.type(predefinedFormat) === "object") {
              formats = predefinedFormat.format;
              round = $.type(predefinedFormat.round) === "string" ? predefinedFormat.round : round;
            } else if ($.type(predefinedFormat) === "string") {
              formats = predefinedFormat;
            }
            if (round !== "round") {
              if (formats.split(".").length === 2) {
                if (round === "ceil") {
                  formats += ";;;c";
                } else {
                  formats += ";;;f";
                }
              }
            }
            grid2.options.columns[columnIndex].footer.styles[footerIdx].numberFormat = formats;
          }
        }
        grid2._grid.setColumnProperty(grid2._grid.columnByField(this._index._column._fieldName), "footer", {
          styles: grid2.options.columns[columnIndex].footer.styles
        });
      }
      return this._value;
    };
  }

  // src/js/grid/realgrid/dataProvider.js
  function setRow(grid2, rows) {
    return function (data, start, count) {
      var self = this;
      grid2.options.dataBounding = true;
      grid2.options.data = data;
      grid2.options._UUID = {};
      if (grid2.options.rowDynamic.length !== 0) {
        grid2.options.rowDynamic = [];
      }
      if (!self._checkClientState())
      return;
      start = arguments.length > 1 ? start : 0;
      count = arguments.length > 2 ? count : -1;
      if (count === 0) {
        return;
      }
      self.refreshFieldFormats();
      self.beginUpdate();
      try {
        self.$_clearRows();
        var checkSt = self.isCheckStates();
        var filters = self._filters;
        var len, end, n, r, i, row;
        if (data && (len = data.length) > 0 && start < len) {
          start = Math.max(0, start);
          if (count < 0) {
            count = len;
          } else {
            count = Math.min(count, len - start);
          }
          if (filters) {
            self._values.length = self._rowIds.length = self._rowStates.length = count;
            filters.prepare(self);
            end = len;
            r = n = 0;
            for (i = start; i < end && r < count; i++) {
              row = data[i];
              if (!$.isArray(row)) {
                row = objectToRow(self, grid2, row, i, end);
              }
              if (filters.select(n++, row)) {
                self._internalSetRow(r++, row, checkSt);
              }
            }
            self._values.length = self._rowIds.length = self._rowStates.length = r;
          } else {
            end = Math.min(len, start + count);
            if (end > start) {
              self._values.length = self._rowIds.length = self._rowStates.length = end - start;
              r = 0;
              for (i = start; i < end; i++) {
                row = data[i];
                if (!$.isArray(row)) {
                  row = objectToRow(self, grid2, row, i, end);
                }
                self._internalSetRow(r++, row, checkSt);
              }
            }
          }
        }
      } finally {
        self.endUpdate(false);
      }
      self.tags().setRows();
      self._fireRefresh();
      self._fireRowCountChanged();
      if (data && data.length === 0 && grid2.options.dataBounding) {
        grid2._grid.onCurrentChanging.call(grid2, grid2._grid, grid2._grid.getCurrent(), grid2._grid.getCurrent());
        grid2._grid.onCurrentChanged.call(grid2, grid2._grid, grid2._grid.getCurrent());
      }
      if (data.length > 0 && grid2._grid.getCurrent().dataRow === -1 && grid2.options.dataBounding) {
        grid2._grid.onCurrentChanging.call(grid2, grid2._grid, grid2._grid.getCurrent(), grid2._grid.getCurrent());
        grid2._grid.onCurrentChanged.call(grid2, grid2._grid, grid2._grid.getCurrent(), grid2._grid.getCurrent());
      }
    };
  }
  function insertRows(grid2, rows) {
    return function (row, rows2, start, count, rowEvents, itemIndex) {
      var self = this;
      if ($.type(grid2.options._UUID) === "undefined") {
        grid2.options._UUID = {};
      }
      start = arguments.length > 2 ? start : 0;
      count = arguments.length > 3 ? count : -1;
      rowEvents = arguments.length > 4 ? rowEvents : false;
      var len;
      if (!rows2 || (len = rows2.length) < 1) {
        if (!grid2.dataSource.options.paging) {
          return;
        }
      }
      var i, end, r, v;
      count = count < 0 ? len : Math.min(len, count);
      if (count == 0) {
        if (!grid2.dataSource.options.paging) {
          return;
        }
      }
      self._checkClientState();
      if (row < 0 || row > this._values.length) {
        throw new RangeError("row is out of bounds:" + row);
      }
      self.refreshFieldFormats();
      start = Math.max(0, start);
      end = Math.min(len, start + count);
      if (rowEvents) {
        r = row;
        for (i = start; i < end; i++) {
          if (self._fireRowInserting(r)) {
            v = rows2[i];
            if (!_isArray(v)) {
              v = objectToRow(self, grid2, v, i, end);
            }
            self._internalInsertRow(r, v);
            self.tags().insertRow(r);
            self._fireRowInserted(r);
            self._fireRowCountChanged();
            r++;
          }
        }
      } else {
        r = row;
        for (i = start; i < end; i++, r++) {
          v = rows2[i];
          if ($.type(v) !== "array") {
            v = objectToRow(self, grid2, v, i, end);
          }
          self._internalInsertRow(r, v);
        }
        self.tags().insertRows(row, count = end - start);
        self._fireRowsInserted(row, count, itemIndex);
        self._fireRowCountChanged();
      }
      if (grid2.options.dataSource.options.paging && grid2.options.dataSource.options.pagingType === "background") {
        var progress,progressID = grid2.$element.attr("id") + "largeData";
        if (row + rows2.length > 0) {
          if (grid2.options.dataSource.options.index === 0) {
            progress = dews.ui.progress(progressID, {
              total: grid2.options.dataSource.options.totalCount,
              textTemplate: dews.localize.get("\uB370\uC774\uD130\uB97C \uBD88\uB7EC\uC624\uACE0 \uC788\uC2B5\uB2C8\uB2E4.", "dews_\uB370\uC774\uD130\uB97C \uBD88\uB7EC\uC624\uACE0 \uC788\uC2B5\uB2C8\uB2E4.") + " <strong>#=percent#</strong>",
              target: grid2.$element,
              _paging: true
            });
          }
          progress = dews.ui.progress(progressID);
          progress.setCurrent(row + rows2.length);
        }
      }
      if (grid2.options.dataSource.options.paging) {
        grid2.options.dataBounding = true;
        grid2._grid.onCurrentChanging.call(grid2, grid2._grid, grid2._grid.getCurrent(), grid2._grid.getCurrent());
        grid2._grid.onCurrentChanged.call(grid2, grid2._grid, grid2._grid.getCurrent());
      }
    };
  }
  function insertRow(grid2) {
    return function (row, values, itemIndex) {
      var self = this;
      if ($.type(grid2.options._UUID) === "undefined") {
        grid2.options._UUID = {};
      }
      if (!self._checkClientState())
      return false;
      if (row < 0 || row > self._values.length) {
        throw new RangeError("row is out of bounds:" + row);
      }
      this.refreshFieldFormats();
      if (values && self._fireRowInserting(row, values)) {
        grid2._filterManager.validateFilterRowData(values);
        if ($.type(values) !== "array") {
          values = objectToRow(self, grid2, values, row, row + 1);
        }
        self._internalInsertRow(row, values);
        self.tags().insertRow(row);
        self._fireRowInserted(row, itemIndex);
        self._fireRowCountChanged();
        return true;
      }
      return false;
    };
  }
  function objectToRow(self, gridObj, values, index, endLength) {
    var row = [];
    var grid2 = gridObj;
    grid2._grid.setAllCheck(false);
    if ($.type(values.__UUID) === "undefined") {
      $.extend(true, values, { __UUID: dews.createUUid(guid()) });
    }
    if (values) {
      var i,fld,columns,column,length = endLength - 1,cnt = self.fieldCount();
      for (i = 0; i < cnt; i++) {
        fld = self.getOrgFieldName(i);
        columns = grid2.columns[fld];
        if (columns && columns.formats && columns.formats.type.toLowerCase() === "datasource") {
          var colFormatsDataSource = columns.formats.dataSource,fetchDataSource;
          if (colFormatsDataSource && index === 0) {
            colFormatsDataSource.col = columns;
            colFormatsDataSource.fetch(function () {
              fetchDataSource = this;
            }).done(function () {
              var column2 = grid2._grid.columnByField(fetchDataSource.col.field);
              var values2 = [],labels = [];
              var colFormatsDataSourceData = fetchDataSource.col.formats.dataSource.data();
              if (colFormatsDataSourceData.length > 0) {
                for (var k = 0; k < colFormatsDataSourceData.length; k++) {
                  values2.push(
                  colFormatsDataSourceData[k][fetchDataSource.col.formats.dataValueField]);

                  labels.push(colFormatsDataSourceData[k][fetchDataSource.col.formats.dataTextField]);
                }
              }
              column2.labels = labels;
              column2.values = values2;
              grid2._grid.setColumn(column2);
              grid2._grid.setColumnProperty(column2, "width", column2.width);
              delete fetchDataSource.col;
            });
          }
        }
        if (values.hasOwnProperty(fld)) {
          row[i] = values[fld];
        }
        if (columns && columns.editor && columns.editor.type.toLowerCase() === "dropdown") {
          var col, fetchData, datasource;
          if ($.type(columns.editor.dataSource) === "function") {
            col = grid2._grid.columnByField(columns.fieldName);
            datasource = columns.editor.dataSource;
            var e = {
              grid: grid2,
              row: {
                index: index,
                data: values
              }
            };
            datasource = columns.editor.dataSource.call(grid2, e);
            col.values = [];
            col.labels = [];
            if (_typeof(col.editor) !== "object") {
              col.editor = {
                type: "dropDown",
                values: [],
                labels: []
              };
            }
            if (_typeof(datasource.column) !== "object") {
              datasource.column = {};
            }
            datasource.col = col;
            datasource.fetch(function () {
              fetchData = this;
            }).done(function () {
              if (fetchData.col) {
                var dropdownColumn = grid2.columns[fetchData.col.fieldName];
                $.each(fetchData.data(), function (idx, data) {
                  if (dropdownColumn.editor.dataSelectable && data[dropdownColumn.editor.dataSelectable.field] !== dropdownColumn.editor.dataSelectable.falseValue) {
                    fetchData.col.editor.values.push(data[dropdownColumn.editor.dataValueField]);
                    fetchData.col.editor.labels.push(data[dropdownColumn.editor.dataTextField]);
                  }
                  fetchData.col.values.push(data[dropdownColumn.editor.dataValueField]);
                  fetchData.col.labels.push(data[dropdownColumn.editor.dataTextField]);
                });
                if ($.type(dropdownColumn.editor.textField) === "undefined") {
                  fetchData.col.labelField = dropdownColumn.editor.dataTextField;
                } else {
                  fetchData.col.labelField = dropdownColumn.editor.textField;
                }
                fetchData.col.lookupDisplay = true;
                grid2._grid.setColumn(fetchData.col);
                fetchData.transport.data = fetchData.data();
                delete fetchData.col;
              }
            });
          } else if ($.type(columns.editor.dataSource) !== "function" && index === 0) {
            col = grid2._grid.columnByField(columns.fieldName);
            datasource = columns.editor.dataSource;
            col.values = [];
            col.labels = [];
            if (_typeof(col.editor) !== "object") {
              col.editor = {
                type: "dropDown",
                values: [],
                labels: []
              };
            }
            datasource.col = col;
            datasource.fetch(function () {
              fetchData = this;
            }).done(function () {
              var dropdownColumn = grid2.columns[fetchData.col.fieldName];
              $.each(fetchData.data(), function (idx, data) {
                if (dropdownColumn.editor.dataSelectable && data[dropdownColumn.editor.dataSelectable.field] !== dropdownColumn.editor.dataSelectable.falseValue) {
                  fetchData.col.editor.values.push(data[dropdownColumn.editor.dataValueField]);
                  fetchData.col.editor.labels.push(data[dropdownColumn.editor.dataTextField]);
                }
                fetchData.col.values.push(data[dropdownColumn.editor.dataValueField]);
                fetchData.col.labels.push(data[dropdownColumn.editor.dataTextField]);
              });
              fetchData.col.lookupDisplay = true;
              grid2._grid.setColumn(fetchData.col);
              fetchData.transport.data = fetchData.data();
              delete fetchData.col;
            });
          }
        }
      }
    }
    if ($.type(grid2.options._UUID) === "undefined") {
      grid2.options._UUID = {};
    }
    grid2.options._UUID[values["__UUID"]] = values;
    return row;
  }
  function setJsonRows(treeGrid, rows) {
    return function (data, children, prop, image) {
      var self = this,previous = treeGrid._grid.getCurrent().itemIndex,items = data[children];
      treeGrid.options.dataBounding = true;
      treeGrid.options.data = data;
      treeGrid.options.__UUID = {};
      if (treeGrid.options.rowDynamic.length !== 0) {
        treeGrid.options.rowDynamic = [];
      }
      if (!this._checkClientState())
      return;
      if (rows) {
        this.beginUpdate();
        try {
          this._clearRows();
          this.refreshFieldFormats();
          var source = this._jsonTreeRows;
          source.__proto__.$_buildTree = $_buildTree();
          this._rowCount = source.load(null, data, children, this.getFieldIndex(prop), this.getFieldIndex(image));
        } finally {
          this.endUpdate(false);
        }
      }
      this._tags.setRows();
      this._fireReset();
      this._fireRowCountChanged();
      function $_buildTree() {
        return function (provider, parent, source2, rowsProp, childrenField, iconField) {
          function build(self2, p, rows2, fldNames2) {
            var flds = fldNames2.length;
            for (var i = 0, cnt = rows2.length; i < cnt; i++) {
              var obj = rows2[i];
              var vals = new Array(flds);
              $.extend(true, obj, {
                __UUID: dews.createUUid(guid())
              });
              for (var c = 0; c < flds; c++) {
                var fld = fldNames2[c];
                var column = treeGrid.columns[fld];
                if (obj.hasOwnProperty(fld)) {
                  vals[c] = obj[fld];
                  if (fld === "__UUID")
                  treeGrid.options.__UUID[obj[fld]] = obj;
                  if (column && column.editor && column.editor.type.toLowerCase() === "dropdown") {
                    var col, fetchData, datasource;
                    if ($.type(column.editor.dataSource) === "function") {
                      col = treeGrid._grid.columnByField(column.fieldName);
                      datasource = column.editor.dataSource;
                      var e = {
                        grid: treeGrid,
                        row: {
                          index: i,
                          data: obj
                        }
                      };
                      datasource = column.editor.dataSource.call(treeGrid, e);
                      col.values = [];
                      col.labels = [];
                      if (_typeof(col.editor) !== "object") {
                        col.editor = {
                          type: "dropDown",
                          values: [],
                          labels: []
                        };
                      }
                      datasource.col = col;
                      datasource.fetch(function () {
                        fetchData = this;
                      }).done(function () {
                        if (fetchData.col) {
                          var dropdownColumn = treeGrid.columns[fetchData.col.fieldName];
                          $.each(fetchData.data(), function (idx, data2) {
                            fetchData.col.values.push(
                            data2[dropdownColumn.editor.dataValueField]);

                            fetchData.col.labels.push(
                            data2[dropdownColumn.editor.dataTextField]);

                            if (dropdownColumn.editor.dataSelectable && data2[dropdownColumn.editor.dataSelectable.field] !== dropdownColumn.editor.dataSelectable.falseValue) {
                              fetchData.col.editor.values.push(
                              data2[dropdownColumn.editor.dataValueField]);

                              fetchData.col.editor.labels.push(
                              data2[dropdownColumn.editor.dataTextField]);

                            }
                          });
                          if ($.type(dropdownColumn.editor.textField) === "undefined") {
                            fetchData.col.labelField = dropdownColumn.editor.dataTextField;
                          } else {
                            fetchData.col.labelField = dropdownColumn.editor.textField;
                          }
                          fetchData.col.lookupDisplay = true;
                          treeGrid._grid.setColumn(fetchData.col);
                          fetchData.transport.data = fetchData.data();
                          delete fetchData.col;
                        }
                      });
                    } else if ($.type(column.editor.dataSource) !== "function" && i === 0) {
                      col = treeGrid._grid.columnByField(column.fieldName);
                      datasource = column.editor.dataSource;
                      col.values = [];
                      col.labels = [];
                      if (_typeof(col.editor) !== "object") {
                        col.editor = {
                          type: "dropDown",
                          values: [],
                          labels: []
                        };
                      }
                      datasource.col = col;
                      datasource.fetch(function () {
                        fetchData = this;
                      }).done(function () {
                        var dropdownColumn = treeGrid.columns[fetchData.col.fieldName];
                        $.each(fetchData.data(), function (idx, data2) {
                          if (dropdownColumn.editor.dataSelectable && data2[dropdownColumn.editor.dataSelectable.field] !== dropdownColumn.editor.dataSelectable.falseValue) {
                            fetchData.col.editor.values.push(
                            data2[dropdownColumn.editor.dataValueField]);

                            fetchData.col.editor.labels.push(
                            data2[dropdownColumn.editor.dataTextField]);

                          }
                          fetchData.col.values.push(
                          data2[dropdownColumn.editor.dataValueField]);

                          fetchData.col.labels.push(
                          data2[dropdownColumn.editor.dataTextField]);

                        });
                        fetchData.col.lookupDisplay = true;
                        treeGrid._grid.setColumn(fetchData.col);
                        fetchData.transport.data = fetchData.data();
                        delete fetchData.col;
                      });
                    }
                  }
                }
              }
              var row = self2._addRow(parent, p, childrenField, iconField, vals);
              if (obj.hasOwnProperty(rowsProp)) {
                var arr = obj[rowsProp];
                if (Array.isArray(arr) && arr.length > 0)
                build(self2, row, arr, fldNames2);
              }
            }
          }
          var fldNames = provider.getOrgFieldNames();
          build(this, parent, source2, fldNames);
        };
      }
      if ((items && items.length === 0 || previous === treeGrid._grid.getCurrent().itemIndex) && treeGrid.options.dataBounding) {
        treeGrid._grid.onCurrentChanging.call(
        treeGrid,
        treeGrid._grid,
        treeGrid._grid.getCurrent(),
        treeGrid._grid.getCurrent());

        treeGrid._grid.onCurrentChanged.call(treeGrid, treeGrid._grid, treeGrid._grid.getCurrent());
      }
      return this._rowCount;
    };
  }
  function createRow(treeGrid, orgCreateRow) {
    return function (values, iconIndex, hasChildren) {
      var self = this;
      treeGrid._filterManager.validateFilterRowData(values);
      var row = orgCreateRow.call(self, values, iconIndex, hasChildren);
      if (Array.isArray(row._values))
      row._values.splice(0, 1, dews.createUUid(guid()));
      var fldNames = this.getOrgFieldNames();
      for (var c = 0; c < fldNames.length; c++) {
        var fld = fldNames[c];
        var column = treeGrid.columns[fld];
        if (column && column.editor && column.editor.type.toLowerCase() === "dropdown") {
          var col, fetchData, datasource;
          if ($.type(column.editor.dataSource) === "function") {
            col = treeGrid._grid.columnByField(column.fieldName);
            datasource = column.editor.dataSource;
            var e = {
              grid: treeGrid,
              row: {
                index: row._rowId,
                data: row._values
              }
            };
            datasource = column.editor.dataSource.call(treeGrid, e);
            col.values = [];
            col.labels = [];
            datasource.col = col;
            datasource.fetch(function () {
              fetchData = this;
            }).done(function () {
              var dropdownColumn = treeGrid.columns[fetchData.col.fieldName];
              $.each(fetchData.data(), function (idx, data) {
                fetchData.col.values.push(data[dropdownColumn.editor.dataValueField]);
                fetchData.col.labels.push(data[dropdownColumn.editor.dataTextField]);
              });
              if ($.type(dropdownColumn.editor.textField) === "undefined") {
                fetchData.col.labelField = dropdownColumn.editor.dataTextField;
              } else {
                fetchData.col.labelField = dropdownColumn.editor.textField;
              }
              fetchData.col.lookupDisplay = true;
              treeGrid._grid.setColumn(fetchData.col);
              fetchData.transport.data = fetchData.data();
              delete fetchData.col;
            });
          } else if ($.type(column.editor.dataSource) !== "function") {
            col = treeGrid._grid.columnByField(column.fieldName);
            datasource = column.editor.dataSource;
            col.values = [];
            col.labels = [];
            datasource.col = col;
            datasource.fetch(function () {
              fetchData = this;
            }).done(function () {
              var dropdownColumn = treeGrid.columns[fetchData.col.fieldName];
              $.each(fetchData.data(), function (idx, data) {
                fetchData.col.values.push(data[dropdownColumn.editor.dataValueField]);
                fetchData.col.labels.push(data[dropdownColumn.editor.dataTextField]);
              });
              fetchData.col.lookupDisplay = true;
              treeGrid._grid.setColumn(fetchData.col);
              fetchData.transport.data = fetchData.data();
              delete fetchData.col;
            });
          }
        }
      }
      return row;
    };
  }
  function guid() {
    return "xxxxxxxx-xxxx-4xxx-9xxx-xxxxxxxxxxxx".replace(/[xy]/g, function (c) {
      var r = Math.random() * 16 | 0,v = c == "x" ? r : r & 3 | 8;
      return v.toString(16);
    });
  }

  // src/js/grid/api/gridAPI.js
  var GridAPI = /*#__PURE__*/function (_Api) {"use strict";_inherits(GridAPI, _Api);var _super3 = _createSuper(GridAPI);function GridAPI() {_classCallCheck(this, GridAPI);return _super3.apply(this, arguments);}_createClass(GridAPI, [{ key: "addRow", value:
      function addRow(param) {
        var self = this,dataRow,obj = {
            editing: true
          },displayColumns = self.options.displayColumns;
        if ($.type(param) === "object") {
          obj.row = $.type(param.index) === "number" ? param.index : void 0;
          obj.editing = $.type(param.editing) === "boolean" ? param.editing : true;
        } else if ($.type(param) === "number") {
          obj.row = param;
        }
        if ($.type(self.options.dataBounding) === "boolean" && !self.options.dataBounding) {
          self.options.dataBounding = true;
        }
        if ($.type(self._grid.getGroupFields()) !== "array") {
          self.options.add = true;
        }
        self._grid.commit();
        self._grid.setOptions({ edit: { insertable: true, appendable: true } });
        if ($.type(self.options.dataSource) !== "undefined" && self.options.dataSource.dataProvider.getRowCount() === 0) {
          self.options.dataSource.add({});
          delete self.options.dataBounding;
        } else if ($.type(obj.row) === "number") {
          if (self.options.dataSource.dataProvider.getRowCount() <= obj.row) {
            self.options.dataSource.dataProvider.addRow({});
          } else {
            self._grid.beginInsertRow(obj.row);
            self._grid.commit(true);
            self.options.insert = true;
          }
        } else {
          self.options.dataSource.dataProvider.addRow({});
        }
        self._grid.setOptions({ edit: { insertable: false, appendable: false } });
        dataRow = self._grid.getItemIndex(self.options.dataSource.dataProvider.getRowCount() - 1);
        if ($.type(self._grid.getGroupFields()) === "array") {
          self.options.add = true;
        }
        if ($.type(obj.row) !== "undefined") {
          dataRow = obj.row;
        }
        if (self._grid.getEditOptions().editable) {
          var parameter = {
            grid: self,
            row: {
              index: dataRow,
              data: self._grid.getValues(dataRow)
            },
            cell: {
              field: ""
            }
          };
          var editor;
          for (var i = 0; i < self.options.displayColumns.length; i += 1) {
            if ($.type(displayColumns[i].editor.editable) === "function") {
              editor = displayColumns[i].editor.editable.call(self, parameter);
            } else {
              editor = displayColumns[i].editor.editable;
            }
            parameter.cell.field = displayColumns[i].field;
            if (editor && self._grid.getColumnProperty(displayColumns[i].field, "visible")) {
              if (displayColumns[i].fieldName === self._grid.getCurrent().fieldName && self.options.insert) {
                delete self.options.insert;
              }
              if ($.type(displayColumns[i].editor.editable) === "function" && displayColumns[i].editor.editable.call(self, parameter)) {
                if (self._grid.getColumnProperty(displayColumns[i].field, "editor").toLowerCase() === "codepicker") {
                  self._grid.setColumnProperty(displayColumns[i].field, "buttonVisibility", "visible");
                }
                self._grid.setCurrent({
                  itemIndex: dataRow,
                  columns: displayColumns[i].field,
                  dataRow: self._grid.getDataRow(dataRow),
                  fieldIndex: i,
                  fieldName: displayColumns[i].field
                });
                if (obj.editing) {
                  setTimeout(function () {
                    self._grid.showEditor();
                  });
                }
                break;
              } else if ($.type(displayColumns[i].editor.editable) === "boolean") {
                self._grid.setCurrent({
                  itemIndex: dataRow,
                  columns: displayColumns[i].field,
                  dataRow: self._grid.getDataRow(dataRow),
                  fieldIndex: i,
                  fieldName: displayColumns[i].field
                });
                if (obj.editing) {
                  setTimeout(function () {
                    self._grid.showEditor();
                  });
                }
                break;
              }
            }
            if (displayColumns.length - 1 === i) {
              delete self.options.insert;
              self._grid.setCurrent({
                itemIndex: dataRow,
                columns: self._grid.getCurrent().column,
                dataRow: self._grid.getDataRow(dataRow),
                fieldIndex: self._grid.getCurrent().fieldIndex,
                fieldName: self._grid.getCurrent().fieldName
              });
            }
          }
        } else {
          delete self.options.insert;
          self._grid.setCurrent({
            itemIndex: dataRow,
            columns: self._grid.getCurrent().column,
            dataRow: self._grid.getDataRow(dataRow),
            fieldIndex: self._grid.getCurrent().fieldIndex,
            fieldName: self._grid.getCurrent().fieldName
          });
        }
      } }, { key: "removeRow", value:
      function removeRow(row) {
        var self = this,event,parameter,rows = [],dynamicRow = [];
        var dataProvider = self.options.dataSource.dataProvider;
        if ($.type(row) === "array") {
          rows = row;
        } else {
          rows.push(row);
        }
        rows.sort(function (a, b) {
          return a - b;
        });
        var colLength = self._grid.getColumns().length,colList = self._grid.getDisplayColumns(),codepickerVal = {},codepickerField = [],isCodepicker = false;
        for (var i = 0; i < colLength; i++) {
          if (self._grid.getColumnProperty(colList[i], "editor") === "codepicker" && self.columns[colList[i]].codeOption && self.columns[colList[i]].codeOption.value !== void 0) {
            isCodepicker = true;
            if (Object.keys(self.columns[colList[i]].codeOption.value).length > -1) {
              codepickerVal = self.columns[colList[i]].codeOption.value;
              codepickerField.push(colList[i]);
            }
          }
        }
        if (rows[0] > -1 && self._grid._dataSource.getJsonRow(self._grid.getDataRow(rows[0]))) {
          var setCriteriaIndex = function setCriteriaIndex(value) {
              var removeIndex = findCriteriaIndex(value);
              if (removeIndex > -1) {
                self.options.rowDynamic.splice(removeIndex, 1);
                self.options.rowDynamic = self.options.rowDynamic.map(function (row2) {
                  var dataRow = Number(row2.criteria.replace(/[^0-9]/g, ""));
                  row2.criteria = dataRow > value ? "(dataRow = " + (dataRow - 1) + ")" : row2.criteria;
                  return row2;
                });
              }
            },findCriteriaIndex = function findCriteriaIndex(value) {
              return self.options.rowDynamic.findIndex(function (row2) {
                var dataRow = Number(row2.criteria.replace(/[^0-9]/g, ""));
                return dataRow === value;
              });
            };
          parameter = {
            grid: self,
            row: {
              data: self.dataItems(rows),
              index: rows
            }
          };
          event = new $.Event("rowRemove", parameter);
          self.$element.trigger(event);
          if (self.options.rowDynamic.length !== 0) {
            for (var d = 0; d < self.options.rowDynamic.length; d += 1) {
              var criteria = self.options.rowDynamic[d].criteria.replace("(dataRow = ", "");
              criteria = parseInt(criteria.replace(")", ""));
              dynamicRow.push(criteria);
            }
          }
          for (var j = rows.length - 1; j >= 0; j -= 1) {
            if (dynamicRow.length !== 0) {
              setCriteriaIndex(self.getDataIndexFromItemIndex(rows[j]));
              self._grid.setStyles({
                body: {
                  dynamicStyles: self.options.rowDynamic
                }
              });
            }
            if (dataProvider.getRowState(self._grid.getDataRow(rows[j])) !== "created") {
              self.options.dataSource.options._destroy.push(
              dataProvider.getJsonRow(self._grid.getDataRow(rows[j])));

            }
            if (rows[j] <= self.select()) {
              self.options.remove = true;
            }
            var delDataIndex = self._grid.getDataRow(rows[j]);
            dataProvider.removeRow(delDataIndex);
            if (isCodepicker) {
              for (var k = 0; k < codepickerField.length; k++) {
                var val = self.columns[codepickerField[k]].codeOption.value;
                delete val[delDataIndex];
                self.columns[codepickerField[k]].codeOption.value = rearrange(val, dataProvider.getRowCount());
              }
            }
          }
        }
        function rearrange(value, length) {
          var values = [],rearrangeVal = {};
          for (i in value) {
            values.push(value[i]);
          }
          for (var l = 0; l < length; l++) {
            rearrangeVal[l] = values[l];
          }
          return rearrangeVal;
        }
      } }, { key: "cancelRow", value:
      function cancelRow(addDataCancel) {
        var self = this,current = self._grid.getCurrent().dataRow;
        _get(_getPrototypeOf(GridAPI.prototype), "cancelRow", this).call(this, current, addDataCancel);
      } }, { key: "cancelCell", value:
      function cancelCell() {
        var self = this,column = self._grid.getCurrent().column.toUpperCase(),row = self._grid.getCurrent().dataRow,dataSource = self.options.dataSource,fieldIndex = 0,originData;
        if (dataSource && dataSource.dataProvider) {
          fieldIndex = dataSource.dataProvider._dp._fieldNames.indexOf(column);
          originData = $.type(dataSource.dataProvider._dp._orgValues[row]) === "undefined" ? dataSource.dataProvider._dp._values[row] : dataSource.dataProvider._dp._orgValues[row];
          if (dataSource.dataProvider.getRowState(row) === "created") {
            self._grid.setValue(row, column, void 0);
          } else if ($.type(originData) !== "undefined") {
            self._grid.setValue(row, column, originData[fieldIndex]);
          }
        }
      } }, { key: "dataItem", value:
      function dataItem(row) {
        var self = this,data = self._grid.getValues(row);
        if (data) {
          delete data.__rowId;
        }
        return data;
      } }, { key: "dataItems", value:
      function dataItems(row) {
        var self = this,datasource = [],rowCount;
        if (self.options.dataSource && $.type(row) !== "undefined") {
          rowCount = self.options.dataSource.dataProvider.getRowCount();
          if ($.type(row) === "number" && row > -1) {
            return row >= rowCount ? null : self.options.dataSource.at(self._grid.getValues(row).__rowId);
          } else if (row.length > 0 && $.type(row) === "array") {
            $.each(row, function (index, data) {
              datasource.push(
              row >= rowCount ? null : self.options.dataSource.at(self._grid.getValues(data).__rowId));

            });
          }
          return datasource;
        } else {
          return self.options.dataSource.data();
        }
      } }, { key: "editCell", value:
      function editCell() {
        this._grid.showEditor();
      } }, { key: "commitCell", value:
      function commitCell() {
        this._grid.commitEditor();
        this._grid.commit(true);
      } }, { key: "closeCell", value:
      function closeCell() {
        this._grid.cancelEditor();
        this._grid.cancel();
      } }, { key: "getCellValue", value:
      function getCellValue(row, field) {
        return this._grid.getValue(row, field);
      } }, { key: "getEditCellValue", value:
      function getEditCellValue() {
        return this._grid.getEditValue();
      } }, { key: "setCellValue", value:
      function setCellValue(row, field, value, isSave, isCallback) {
        var self = this;
        var previous = self._grid.getValue(row, field);
        var onEditCell = true;
        var column = self.columns[field];
        var dataIndex;
        var _row = Array.isArray(row) ? row : [row];
        _row.forEach(function (itemIndex) {
          if (itemIndex !== -1) {var _column$editor;
            self._grid.setValue(itemIndex, field, value);
            if ((column === null || column === void 0 ? void 0 : (_column$editor = column.editor) === null || _column$editor === void 0 ? void 0 : _column$editor.type) === "codepicker") {
              dataIndex = self.getDataIndexFromItemIndex(itemIndex);
              column.codeOption.value[dataIndex] = dews.ui.gridUtil._codeOptionValue("", "", value);
            }
          }
        });
        if (typeof isSave === "boolean") {
          onEditCell = isSave;
        }
        if (value !== previous && self._grid.columnByField(field) !== null) {
          self._grid.onCellEdited.call(
          self,
          self._grid,
          row,
          row,
          self._grid.columnByField(field).dataIndex,
          onEditCell);

        }
        self._grid.commit();
        self.options.commit = true;
        if (typeof isCallback === "boolean" && isCallback) {
          _row.forEach(function (itemIndex) {
            var index = {
              itemIndex: itemIndex,
              dataRow: self.getDataIndexFromItemIndex(itemIndex),
              fieldName: field
            };
            self._codepickerCallbackCall(self, index, column);
          });
        }
      } }, { key: "_codepickerCallbackCall", value:
      function _codepickerCallbackCall(self, index, column) {var _column$editor2, _column$editor2$type;
        if ((column === null || column === void 0 ? void 0 : (_column$editor2 = column.editor) === null || _column$editor2 === void 0 ? void 0 : (_column$editor2$type = _column$editor2.type) === null || _column$editor2$type === void 0 ? void 0 : _column$editor2$type.toLowerCase()) === "codepicker") {
          var codeOption = column.codeOption;
          if (typeof self.options.callback === "function") {
            delete self.options.callback;
          }
          if (column.editor.callback) {
            self.options.callback = column.editor.callback;
          }
          if (typeof column.editor.helpParams === "function") {
            codeOption.params = column.editor.helpParams.call(self, {
              data: self._innerOptions._gridType === "GRID" ? self.dataItem(index.itemIndex) : self.dataItem(index.dataRow)
            });
          } else {
            codeOption.params = column.editor.helpParams;
          }
          var keyword = self._grid.getValue(index.itemIndex, column.field);
          codeOption.params = $.extend(true, codeOption.params, { keyword: keyword });
          codeOption.callbacks = function (data) {
            if (typeof data !== "undefined") {
              if (Array.isArray(data) && data.length !== 1 || !codeOption.useAjax) {
                self._grid.onImageButtonClicked.call(self, self._grid, index.itemIndex, column);
              } else {
                if (self.options._grid === true && typeof self.options._gridCallback === "function") {
                  self.options._gridCallback(data, column, index.itemIndex);
                  delete codeOption.codesearch;
                  if (codeOption.moveFocus) {
                    dews.ui.gridUtil.nextFocus(self, index);
                  }
                }
              }
            } else {
              self._grid.onImageButtonClicked.call(self, self._grid, index.itemIndex, column);
            }
          };
          delete codeOption.callback;
          var helpEvent = new $.Event("codesearch", codeOption);
          self.$element.closest(".dews-data-control").trigger(helpEvent);
        }
      } }, { key: "setCheck", value:
      function setCheck(index, value, flag) {
        var self = this;
        if ($.type(index) === "number") {
          self._grid.checkItem(index, value, false, flag);
        } else if ($.type(index) === "array") {
          self._grid.checkItems(index, value, flag);
        }
      } }, { key: "setDisableCheck", value:
      function setDisableCheck(index, _boolean) {
        var self = this,row = [],bool = false;
        if ($.type(index) === "number") {
          row.push(index);
        } else if ($.type(index) === "array") {
          row = index;
        }
        if ($.type(_boolean) === "boolean") {
          bool = !_boolean;
        }
        for (var i = 0; i < row.length; i++) {
          self._grid.setCheckable(row[i], bool);
        }
      } }, { key: "setHeaderCheck", value:
      function setHeaderCheck(_boolean2) {
        this._grid.setAllCheck(_boolean2);
        this._grid.checkAll(_boolean2);
      } }, { key: "getCheckedRows", value:
      function getCheckedRows() {
        return dews.ui.gridUtil.getCheckedRows(this);
      } }, { key: "getCheckedValues", value:
      function getCheckedValues(field) {
        return dews.ui.gridUtil.getCheckedValues(this, field);
      } }, { key: "getCheckedIndex", value:
      function getCheckedIndex() {
        return this._grid.getCheckedItems();
      } }, { key: "getCheckedDataIndex", value:
      function getCheckedDataIndex() {
        return this._grid.getCheckedRows();
      } }, { key: "showColumn", value:
      function showColumn(field) {
        dews.ui.gridUtil.showColumn(this, field);
      } }, { key: "hideColumn", value:
      function hideColumn(field) {
        dews.ui.gridUtil.hideColumn(this, field);
      } }, { key: "refresh", value:
      function refresh() {
        this._grid.refresh();
      } }, { key: "showProgress", value:
      function showProgress() {
        dews.ui.loading.show({
          type: "tiny",
          text: dews.localize.get("\uB370\uC774\uD130 \uB85C\uB529 \uC911 \uC785\uB2C8\uB2E4.", "dews_\uB370\uC774\uD130 \uB85C\uB529 \uC911 \uC785\uB2C8\uB2E4.")
        });
      } }, { key: "hideProgress", value:
      function hideProgress() {
        dews.ui.loading.hide();
      } }, { key: "saveAsExcel", value:
      function saveAsExcel(options) {
        var self = this;
        var exporter = new ExcelExporter();
        exporter["export"](options, self);
      } }, { key: "importExcel", value:
      function importExcel(option) {
        var self = this,opt2 = {
            sheetName: void 0,
            fillData: "replace",
            fileDialog: false,
            mapping: {},
            result: {
              totalCount: 0,
              success: {
                count: 0,
                data: []
              },
              fail: {
                count: 0,
                data: []
              }
            }
          };
        var $inputFileElement = self.$element.find("> .dews-grid-excel-import-file"),fileList,$dfd = $.Deferred();
        opt2 = $.extend(true, opt2, option);
        if (opt2.fileDialog) {
          if ($inputFileElement.length === 0) {
            $inputFileElement = $('<input type="file" class="dews-grid-excel-import-file" style="display: none">');
            self.$element.append($inputFileElement);
            $inputFileElement.change(function (e) {
              fileList = e.target.files;
              opt2.file = fileList;
              loadExcelScript(self, opt2).done(function (result) {
                $inputFileElement.remove();
                $dfd.resolveWith(self, [result]);
              }).fail(function (result) {
                $inputFileElement.remove();
                $dfd.rejectWith(self, [result]);
              });
            });
          }
          $inputFileElement.trigger("click");
          return $dfd;
        } else {
          return loadExcelScript(self, opt2);
        }
        function loadExcelScript(grid2, options) {
          var self2 = grid2,opt3 = options,deferred = $.Deferred(),link = dews._environments.scriptBase + "xlsx.js";
          dews.ajax.script(link, { once: true }).done(function () {
            if ($.type(opt3.file) === "undefined") {
              return;
            }
            var files = opt3.file;
            if (files.length === 0) {
              deferred.rejectWith(self2, new Error("\uD30C\uC77C\uC744 \uC77D\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."));
            }
            var file = files[0];
            var excelImporter = new ExcelImporter(self2, opt3);
            excelImporter.loadExcelWorkbook(file).done(function (workbook) {
              opt3.sheetName = opt3.sheetName === void 0 ? workbook.SheetNames[0] : opt3.sheetName;
              var sheetsDataObj = workbook.Sheets[opt3.sheetName];
              for (var key in sheetsDataObj) {
                if (sheetsDataObj[key].t === "d") {
                  var dateValue = sheetsDataObj[key].v;
                  dateValue.setSeconds(dateValue.getSeconds() + 52);
                }
              }
              var output = to_json(workbook);
              self2.options.dataSource.dataProvider.fillJsonData(output[opt3.sheetName], {
                fillMode: opt3.fillData
              });
              if (opt3.result.fail.count === opt3.result.totalCount) {
                deferred.rejectWith(self2, [opt3.result]);
              } else {
                deferred.resolveWith(self2, [opt3.result]);
              }
            }).fail(function (err) {
              deferred.rejectWith(self2, err);
            });
            function fixdata(data) {
              var o = "",l = 0,w = 10240;
              for (; l < data.byteLength / w; ++l) {
                o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w, l * w + w)));
              }
              o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w)));
              return o;
            }
            function to_json(workbook) {
              var result = {},setData,roa,datas = [];
              !option.titleDepth ? option.titleDepth = 1 : option.titleDepth;
              var headerSize = option.titleDepth - 1;
              var makeJson = XLSX.utils.make_json(workbook.Sheets[opt3.sheetName], { header: 1, raw: true });
              var header = [],data = [];
              if ($.type(option.rawConverter) === "function") {
                result[opt3.sheetName] = option.rawConverter.call(self2, makeJson) || [];
                datas = result[opt3.sheetName];
                setData = result;
              } else {
                if (Object.keys(opt3.mapping).length === 0) {
                  setMapping(self2.options.columns);
                }
                if (option.titleDepth === 1) {
                  roa = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[opt3.sheetName], { raw: true });
                  result[opt3.sheetName] = roa;
                } else if (option.titleDepth > 1) {
                  for (var h = 0; h < makeJson[0].length; h++) {
                    header.push(void 0);
                  }
                  for (var j = 0; j <= headerSize; j++) {
                    for (var i = 0; i < makeJson[j].length; i++) {
                      if ($.type(makeJson[j][i]) !== "undefined") {
                        header.splice(i, 1, makeJson[j][i]);
                      }
                    }
                  }
                  $.each(header, function (headerIndex, headerName) {
                    var mappingList = Object.keys(opt3.mapping);
                    var matchIndex;
                    var matchField;
                    $.each(mappingList, function (mappingIndex, mappingValue) {
                      var mappingColumn = opt3.mapping[mappingValue];
                      if (mappingColumn === headerName) {
                        matchIndex = mappingIndex;
                        matchField = mappingValue;
                        return false;
                      }
                    });
                    if (matchField !== void 0 && matchField !== null) {
                      header[headerIndex] = {
                        title: headerName,
                        field: matchField,
                        index: matchIndex,
                        isMatch: true
                      };
                      opt3.mapping[matchField] = {
                        title: headerName,
                        field: matchField,
                        index: matchIndex,
                        isMatch: true
                      };
                    }
                  });
                  $.each(makeJson.slice(option.titleDepth), function (idx, array) {
                    var obj = {};
                    $.each(array, function (index, cell) {
                      var matchHeader = header[index];
                      if (matchHeader && matchHeader.isMatch) {
                        obj[matchHeader.field] = cell;
                      }
                    });
                    data.push(obj);
                  });
                  if (data.length > 0) {
                    result[opt3.sheetName] = data;
                  }
                }
                setData = result;
                Object.size = function (obj) {
                  var size = 0,key;
                  var bool = 0;
                  for (key in obj) {
                    if (obj.hasOwnProperty(key))
                    size++;
                    if (!obj[key])
                    bool++;
                  }
                  return size !== bool;
                };
                for (var i = 0; i <= setData[opt3.sheetName].length - 1; i++) {
                  var rows = mapping(setData[opt3.sheetName][i], setData[opt3.sheetName], i);
                  var check;
                  check = Object.size(rows);
                  if ($.type(rows) === "object" && check || $.type(rows) === "boolean" && rows) {
                    datas.push(rows);
                    opt3.result.success.data.push(result[opt3.sheetName][i]);
                    opt3.result.success.count++;
                  } else if ($.type(rows) === "boolean" && !rows) {
                    opt3.result.fail.data.push(result[opt3.sheetName][i]);
                    opt3.result.fail.count++;
                  }
                }
              }
              opt3.result.totalCount = setData[opt3.sheetName].length;
              setData[opt3.sheetName] = datas;
              return setData;
            }
            function mapping(row, total, index) {
              var data = {},originRow = row;
              for (var j = 0; j <= Object.keys(opt3.mapping).length - 1; j++) {
                var dataValue;
                if (option.titleDepth === 1) {
                  dataValue = originRow[opt3.mapping[Object.keys(opt3.mapping)[j]]];
                } else if (option.titleDepth > 1) {
                  dataValue = originRow[opt3.mapping[Object.keys(opt3.mapping)[j]].field];
                }
                data[Object.keys(opt3.mapping)[j]] = dataValue;
              }
              if ($.type(opt3.convertor) === "function") {
                data = opt3.convertor.call(self2, data);
              }
              if ($.type(opt3.validator) === "function") {
                var validte = opt3.validator.call(self2, data);
                if ($.type(validte) === "boolean" && !validte) {
                  return false;
                }
              }
              if ($.type(opt3.dupCheck) === "array" && opt3.dupCheck.length !== 0) {
                var keys = opt3.dupCheck,totals = total.slice(),dupData = [];
                totals.filter(function (row2) {
                  var dupCount = 0;
                  $.each(keys, function (idx, value) {
                    var dataValue2;
                    if (option.titleDepth === 1) {
                      dataValue2 = row2[opt3.mapping[value]];
                    } else if (option.titleDepth > 1) {
                      dataValue2 = row2[opt3.mapping[value].field];
                    }
                    if (data[value] === dataValue2) {
                      dupCount++;
                    }
                  });
                  if (dupCount === opt3.dupCheck.length) {
                    dupData.push(row2);
                  }
                });
                if (dupData.length > 0 && dupData[0] !== row) {
                  return false;
                }
              }
              if (Object.keys(data).length !== 0) {
                return data;
              }
            }
            function setMapping(col) {
              var columns = col;
              for (var k = 0; k <= columns.length - 1; k++) {
                if ($.type(columns[k].field) !== "undefined") {
                  opt3.mapping[columns[k].field] = columns[k].title;
                }
                if (columns[k].columns) {
                  setMapping(columns[k].columns);
                }
              }
              if (opt3.mapping.hasOwnProperty("__UUID")) {
                delete opt3.mapping.__UUID;
              }
            }
          });
          return deferred;
        }
      } }, { key: "setColumns", value:
      function setColumns(columns) {
        var self = this;
        var UUIDFlag = false;
        $.each(columns, function (idx, column) {
          if (column.field === "__UUID") {
            UUIDFlag = true;
            return false;
          }
        });
        self.options._originColumns = [].concat(columns);
        if (!UUIDFlag && columns) {
          columns.splice(0, 0, {
            field: "__UUID",
            fieldName: "__UUID",
            name: "__UUID",
            visible: false,
            header: { text: " " }
          });
        }
        self.options.styleColumn = [];
        __initialize(self);
        var result = this._getOptionsThatConvertColumns(columns, self.options, self);
        dews.ui.gridUtil.setColumns(self, result);
        self._filterManager.setFilterActions(self);
        self._setCriteria();
      } }, { key: "setColumn", value:
      function setColumn(columnFieldName, nextColumnOption) {
        var self = this,prevColumn,nextColumn,newColumn,columns = self.options.columns,result;
        delete nextColumnOption.field;
        if (nextColumnOption.width) {
          self._grid.setColumnProperty(columnFieldName, "width", nextColumnOption.width);
          delete nextColumnOption.width;
        }
        if (nextColumnOption.visible) {
          self._grid.setColumnProperty(columnFieldName, "visible", nextColumnOption.visible);
        }
        var userColumn;
        if ($.type(self.userOptions.columns) === "array") {
          userColumn = findUserOptionsColumn3(self.userOptions.columns, columnFieldName);
        }
        userColumn = $.extend(true, userColumn, nextColumnOption);
        if (nextColumnOption.editable !== void 0 && (nextColumnOption.editor === void 0 || nextColumnOption.editor.editable === void 0)) {
          if (userColumn.editor === void 0 || userColumn.editor.editable === void 0) {
            $.extend(true, nextColumnOption, {
              editor: { editable: nextColumnOption.editable }
            });
          } else if (userColumn.editor && userColumn.editor.editable !== void 0) {
            $.extend(true, nextColumnOption, {
              editor: { editable: userColumn.editor.editable }
            });
          }
        }
        if (nextColumnOption.editable === void 0 && nextColumnOption.editor && nextColumnOption.editor.editable !== void 0) {
          if (userColumn !== void 0 && userColumn.editable !== void 0) {
            $.extend(true, nextColumnOption, { editable: userColumn.editable });
          } else {
            $.extend(true, nextColumnOption, {
              editable: self.options.editable
            });
          }
        }
        findColumnAndExtend(columns);
        self.options.styleColumn = [];
        __initialize(self);
        result = this._getOptionsThatConvertColumns(columns, self.options, self);
        dews.ui.gridUtil._setColumns(self, result);
        prevColumn = self._grid.columnByName(columnFieldName);
        nextColumn = self.columns[columnFieldName];
        if (nextColumn && nextColumn.labels && nextColumn.values && nextColumn.editor && nextColumn.editor.type === "dropDown" && prevColumn) {
          prevColumn.labels = [];
          prevColumn.values = [];
        }
        newColumn = $.extend(true, {}, prevColumn, nextColumn);
        self._grid.setColumn(newColumn);
        self._filterManager.setFilterActions(self);
        self._setCriteria();
        function findColumnAndExtend(columns2) {
          for (var i = 0; i < columns2.length; i++) {
            if (columns2[i].columns) {
              findColumnAndExtend(columns2[i].columns);
            } else {
              if (columns2[i].fieldName && columns2[i].fieldName === columnFieldName) {
                $.extend(true, columns2[i], nextColumnOption);
              }
            }
          }
        }
      } }, { key: "select", value:
      function select(row, field) {
        var self = this,column = self._grid.getCurrent().column;
        if (row !== void 0) {
          if ($.type(field) !== "undefined") {
            column = field;
          }
          self._grid.setCurrent({
            itemIndex: row,
            column: column,
            dataRow: row
          });
        } else {
          if (self.options.dataBounding && self.options.dataSource.data().length !== 0) {
            return 0;
          } else {
            return self._grid.getCurrent().itemIndex;
          }
        }
      } }, { key: "multiSelect", value:
      function multiSelect(startItem, endItem, startColumn, endColumn) {
        return dews.ui.gridUtil.multiSelect(this, startItem, endItem, startColumn, endColumn);
      } }, { key: "setFixedOptions", value:
      function setFixedOptions(fixedOption) {
        this._grid.setFixedOptions(fixedOption);
      } }, { key: "sort", value:
      function sort(options) {
        dews.ui.gridUtil.sort(this, options);
      } }, { key: "setContextMenu", value:
      function setContextMenu(options) {
        dews.ui.gridUtil.setContextMenu(this, options);
      } }, { key: "setDataSource", value:
      function setDataSource(datasource) {
        var self = this;
        self._grid.setAllCheck(false);
        self.options.dataSource = datasource;
        self.options.styleColumn = [];
        __initialize(self);
        self.options = this._getOptionsThatConvertColumns(self.options.columns, self.options, self);
        delete self.options.fieldIndex;
        self.options.dataSource.dataProvider._dp.setRows = setRow(
        self,
        self.options.dataSource.dataProvider._dp.setRows);

        self.options.dataSource.dataProvider._dp.insertRows = insertRows(
        self,
        self.options.dataSource.dataProvider._dp.insertRows);

        self.options.dataSource.dataProvider._dp.insertRow = insertRow(
        self,
        self.options.dataSource.dataProvider._dp.insertRow);

        self._grid.setDataProvider(self.options.dataSource.dataProvider);
        self._grid.setColumns(self.options.columns);
        self._grid.setHeader({
          height: self.options.maxDepth * self.options.header.minHeight
        });
        if (self.options.grouping) {
          self.options.display.rowHeight = self.options.display.minHeight * self.options.maxGroupCol;
        }
        if (self.options.dataSource && self.options.dataSource.options.group) {
          self.options.group = self.options.dataSource.options.group;
        }
        if (typeof self.options.group !== "undefined") {
          setGroup(self._grid, self.options);
        }
        self._grid.setOptions(self.options);
        if ($.type(self.options.dataSource.options.detail) === "boolean") {
          var length = self.dataSource.dataProvider.getRowCount();
          $.each(self.dataItems(), function (idx, value) {
            objectToRow(self.options.dataSource.dataProvider._dp, self, value, idx, length);
          });
        }
        if (self._onegrid && self._onegrid._onegrid) {
          if (self._onegrid.loadData) {
            self._onegrid.loadColumns = dews.ui.gridUtil.setDisplayIndexColumns(
            self,
            self.userOptions.columns,
            self._onegrid.loadData);

          } else {
            self._onegrid.loadColumns = dews.ui.gridUtil.setDisplayColumns(self, self._grid.getDisplayColumns());
          }
        }
        self._filterManager.setFilterActions(self);
        self._setCriteria();
      } }, { key: "updateRow", value:
      function updateRow(row, data) {
        dews.ui.gridUtil.updateRow(this, row, data);
      } }, { key: "setOptions", value:
      function setOptions(options) {
        var self = this;
        var dispCols = self._grid.saveColumnLayout();
        self.userOptions = $.extend(true, self.userOptions, options);
        options = $.extend(true, {}, self.options, options);
        self.options = getOptions(self, options);
        self._grid.setOptions(self.options);
        self.columns = {};
        dews.ui.gridUtil._setColumns(self, self.options.columns);
        self._filterManager.setFilterActions(self);
        self._grid.setColumnLayout(dispCols);
        if (typeof self.options.group !== "undefined") {
          setGroup(self._grid, self.options);
        }
      } }, { key: "on", value:
      function on() {
        var self = this;
        self.$element.on.apply(self.$element, arguments);
      } }, { key: "off", value:
      function off() {
        var self = this;
        if (arguments[0] === "all") {
          self.$element.off();
        } else {
          self.$element.off.apply(self.$element, arguments);
        }
      } }, { key: "searchCell", value:
      function searchCell(options) {
        var self = this,opt2 = {
            select: true,
            partialMatch: true,
            caseMatch: false
          };
        if ($.type(options) === "undefined") {
          return;
        }
        opt2.startItemIndex = options.startIndex === void 0 ? 0 : options.startIndex;
        opt2 = $.extend(true, opt2, options);
        opt2.caseSensitive = opt2.caseMatch;
        if (self._grid.searchCell(opt2)) {
          return self._grid.searchCell(opt2).itemIndex;
        }
      } }, { key: "getCurrentColumn", value:
      function getCurrentColumn() {
        return this._grid.getCurrent().column;
      } }, { key: "getRowState", value:
      function getRowState(index) {
        return dews.ui.gridUtil.getRowState(this, index);
      } }, { key: "setDetail", value:
      function setDetail(target) {
        dews.ui.gridUtil.setDetail(this, target);
      } }, { key: "setDetailGrid", value:
      function setDetailGrid(detailGrid) {
        this.setDetail(detailGrid);
      } }, { key: "validate", value:
      function validate(opt2) {
        var self = this,validate = {
            result: true,
            fields: []
          },gridDatas = self.options.dataSource.data(),required = [],columns;
        if ($.type(opt2) === "function") {
          var funParams = {
            grid: self,
            row: {
              index: 0,
              data: ""
            },
            cell: {
              field: "",
              data: ""
            }
          };
          $.each(gridDatas, function (idx, rowData) {
            funParams.row.index = idx;
            funParams.row.data = rowData;
            $.each(self._grid.getDisplayColumns(), function (index, column2) {
              funParams.cell.field = column2;
              funParams.cell.data = rowData[column2];
              if (!opt2.call(self, funParams)) {
                validate.fields.push({ columnName: column2, rowIndex: idx });
                validate.result = false;
              }
            });
          });
        } else {
          var options = $.extend(
          true,
          {
            mode: $.type(opt2) === "boolean" ? opt2 : false,
            showTooltip: false
          },
          opt2);

          for (var i = 0; i < self._grid.getColumnNames().length; i += 1) {
            columns = self.columns[self._grid.getColumnNames()[i]];
            if (columns && $.type(columns.field) !== "undefined") {
              if (columns.attributes && columns.attributes["class"] === "required") {
                required.push(columns.field);
              }
            }
          }
          $.each(gridDatas, function (idx, datas) {
            var rowState = self.getRowState(idx);
            if (options.mode && rowState !== "updated" && rowState !== "added")
            return true;
            $.each(required, function (reqIdx, reqData) {
              var colData = datas[reqData];
              if ($.type(colData) === "number" && colData === 0) {
              } else if (!colData) {
                validate.result = false;
                validate.fields.push({
                  columnName: reqData,
                  rowIndex: idx,
                  validate: "required"
                });
              }
            });
          });
          if (!validate.result) {
            if (options.showTooltip) {
              var itemIndex = validate.itemIndex = validate.fields[0].rowIndex;
              var column = validate.column = validate.fields[0].columnName;
              self.showTooltip(itemIndex, column, {
                type: "required",
                position: "top",
                text: dews.localize.get("\uD544\uC218 \uC785\uB825 \uD56D\uBAA9\uC785\uB2C8\uB2E4.", "dews_\uD544\uC218 \uC785\uB825 \uD56D\uBAA9\uC785\uB2C8\uB2E4.")
              });
            }
          }
        }
        return validate;
      } }, { key: "setRowStyle", value:
      function setRowStyle(row, style, _colorLine) {
        dews.ui.gridUtil.setRowStyle(this, row, style, _colorLine);
      } }, { key: "setStyles", value:
      function setStyles(styles) {
        var self = this;
        self.options.styles = styles;
        self.options = _setStyles(self._grid, self.options);
        self._grid.setOptions(self.options);
      } }, { key: "resetRowStyle", value:
      function resetRowStyle(row) {
        dews.ui.gridUtil.resetRowStyle(this, row);
      } }, { key: "lastEditCell", value:
      function lastEditCell() {
        var self = this,current = self._grid.getCurrent(),displayColumn = self.options.displayColumns,displayIndex = self._grid.getColumnProperty(current.column, "displayIndex"),value = false,editParams = {
            grid: self,
            row: {
              index: current.itemIndex,
              data: self.dataItem(current.itemIndex)
            },
            cell: {
              field: ""
            }
          };
        return dews.ui.gridUtil.lastEditCell(self, displayColumn, displayIndex, value, editParams);
      } }, { key: "getSummary", value:
      function getSummary(field, cal) {
        var self = this,calculate = cal || "SUM";
        return self._grid.getSummary(field, calculate);
      } }, { key: "setRowState", value:
      function setRowState(index, state) {
        dews.ui.gridUtil.setRowState(this, index, state);
      } }, { key: "setHeight", value:
      function setHeight(height) {
        dews.ui.gridUtil.setHeight(this, height);
      } }, { key: "setRowHeight", value:
      function setRowHeight(opt2, itemIndex, height) {
        return dews.ui.gridUtil.setRowHeight(this, opt2, itemIndex, height);
      } }, { key: "setMaxLength", value:
      function setMaxLength(field, length) {
        dews.ui.gridUtil.setMaxLength(this, field, length);
      } }, { key: "setHeaderCheckVisible", value:
      function setHeaderCheckVisible(visible) {
        dews.ui.gridUtil.setHeaderCheckVisible(this, visible);
      } }, { key: "getParentData", value:
      function getParentData() {
        return dews.ui.gridUtil.getParentData(this);
      } }, { key: "getChildData", value:
      function getChildData(index, gridId) {
        return dews.ui.gridUtil.getChildData(this, index, gridId);
      } }, { key: "getChildDataSource", value:
      function getChildDataSource(arg1, arg2) {
        return dews.ui.gridUtil.getChildDataSource(this, arg1, arg2);
      } }, { key: "_getExcelUrlForPrint", value:
      function _getExcelUrlForPrint(menuName, options) {
        return dews.ui.gridUtil._getExcelUrlForPrint(this, menuName, options);
      } }, { key: "sortDataItems", value:
      function sortDataItems(index) {
        var self = this;
        var sortDatas = [];
        if ($.type(index) === "array") {
          $.each(index, function (count, idx) {
            if ($.type(self.dataItem(idx)) !== "null") {
              sortDatas.push(self.dataItem(idx));
            }
          });
        } else if ($.type(index) === "undefined") {
          for (var i = 0; i < self._grid.getItemCount(); i++) {
            if ($.type(self.dataItem(i)) !== "null") {
              sortDatas.push(self.dataItem(i));
            }
          }
        }
        return sortDatas;
      } }, { key: "setGroup", value:
      function setGroup(group) {
        var self = this,groups = [];
        if ($.type(group) === "array") {
          $.each(group, function (idx, value) {
            groups.push(value.field);
          });
        }
        self._grid.groupBy(groups);
        self._grid.setSortingOptions({
          handleVisibility: self.userOptions.sortable !== false && groups.length === 0 ? "visible" : "hidden"
        });
      } }, { key: "enable", value:
      function enable(_boolean3) {
        dews.ui.gridUtil.enable(this, _boolean3);
      } }, { key: "setColumnHeaderCheck", value:
      function setColumnHeaderCheck(field, bool) {
        var self = this;
        self._grid.setColumn($.extend(true, self._grid.columnByField(field), { checked: bool }));
      } }, { key: "addColumn", value:
      function addColumn(column, insertField) {
        var self = this,options = self.options;
        options.columns.push(column);
        var UUIDFlag = false;
        $.each(options.columns, function (idx, col) {
          if (col.field === "__UUID") {
            UUIDFlag = true;
          }
        });
        if (!UUIDFlag && options.columns) {
          options.columns.splice(0, 0, {
            field: "__UUID",
            fieldName: "__UUID",
            name: "__UUID",
            visible: false,
            header: { text: " " }
          });
        }
        self.options.styleColumn = [];
        __initialize(self);
        options = this._getOptionsThatConvertColumns(options.columns, options, self);
        dews.ui.gridUtil.addColumn(self, options.columns[options.columns.length - 1], insertField);
        if (column && column.formats && column.formats.type && column.formats.type.toLowerCase() === "datasource") {
          var colFormatsDataSource = column.formats.dataSource,fetchDataSource;
          if (colFormatsDataSource) {
            colFormatsDataSource.col = column;
            colFormatsDataSource.fetch(function () {
              fetchDataSource = this;
            }).done(function () {
              var currentColumn = self._grid.columnByField(fetchDataSource.col.field);
              var values = [],labels = [];
              var colFormatsDataSourceData = fetchDataSource.col.formats.dataSource.data();
              if (colFormatsDataSourceData.length > 0) {
                for (var k = 0; k < colFormatsDataSourceData.length; k++) {
                  values.push(colFormatsDataSourceData[k][fetchDataSource.col.formats.dataValueField]);
                  labels.push(colFormatsDataSourceData[k][fetchDataSource.col.formats.dataTextField]);
                }
              }
              currentColumn.labels = labels;
              currentColumn.values = values;
              self._grid.setColumn(currentColumn);
              self._grid.setColumnProperty(currentColumn, "width", currentColumn.width);
              delete fetchDataSource.col;
            });
          }
        }
        self._setCriteria();
      } }, { key: "deleteColumn", value:
      function deleteColumn(column) {
        dews.ui.gridUtil.deleteColumn(this, column);
      } }, { key: "getByUUID", value:
      function getByUUID() {
        var self = this,data = self.dataItem(self.select());
        if (data) {
          return data["__UUID"];
        }
      } }, { key: "bindPanel", value:
      function bindPanel(panel) {
        dews.ui.gridUtil.bindPanel(this, panel);
      } }, { key: "updateRowFromPanel", value:
      function updateRowFromPanel(data) {
        var self = this;
        if (data) {
          Object.keys(data).forEach(function (key) {
            if (self.options.dataSource.dataProvider.getFieldIndex(key) !== -1) {
              self._grid.setValue(self.select(), key, data[key]);
            }
          });
        }
      } }, { key: "setCellStyle", value:
      function setCellStyle(index, field, styles) {
        dews.ui.gridUtil.setCellStyle(this, index, field, styles);
      } }, { key: "disableActiveEditor", value:
      function disableActiveEditor(_boolean4) {
        var self = this,column,columns,visible,styles,options = {},background;
        column = self.getCurrentColumn();
        columns = self.columns[column];
        styles = self._grid.getCellApplyStyles(self._grid.getCurrent().dataRow, column);
        if (self._grid.getSelectOptions().style !== "none") {
          background = self.options.gridStyle.selection.focusBackgroundColor;
          if ($.type(columns) !== "undefined" && $.type(columns.attributes) !== "undefined") {
            if (columns.attributes["class"] === "required") {
              background = self.options.gridStyle.body.requiredFocusBackground;
            } else if (columns.attributes["class"] === "readonly") {
              background = self.options.gridStyle.body.readonlyFocusBackground;
            }
          }
          options = {
            background: background
          };
          self._grid.removeCellStyles(["selection"]);
        }
        if (($.type(styles.editable) === "undefined" || styles.editable) && !_boolean4) {
          options.editable = false;
        }
        self._grid.addCellStyle("selection", options, true);
        self._grid.setCellStyle(self._grid.getCurrent().dataRow, column, "selection");
        self._grid.setColumnProperty(column, "editable", _boolean4);
        switch (columns.editor.type.toLowerCase()) {
          case "codepicker":
          case "zipcodepicker":
          case "time":
          case "month":
          case "year":
            visible = _boolean4 ? "visible" : "hidden";
            self._grid.setColumnProperty(column, "buttonVisibility", visible);
            break;
          case "check":
            var options2 = self._grid.getColumnProperty(columns.name, "renderer");
            self._grid.setColumnProperty(columns.name, "renderer", $.extend(true, options2, { editable: _boolean4 }));
            break;}

      } }, { key: "isFilteredColumn", value:
      function isFilteredColumn(column) {
        return this._grid.isFiltered(column);
      } }, { key: "setSelectedStyle", value:
      function setSelectedStyle(opt2) {
        dews.ui.gridUtil.setSelectedStyle(this, opt2);
      } }, { key: "getItemIndexFromDataIndex", value:
      function getItemIndexFromDataIndex(dataIndex) {
        return dews.ui.gridUtil.getItemIndexFromDataIndex(this, dataIndex);
      } }, { key: "getDataIndexFromItemIndex", value:
      function getDataIndexFromItemIndex(itemIndex) {
        return dews.ui.gridUtil.getDataIndexFromItemIndex(this, itemIndex);
      } }, { key: "getDynamicColumn", value:
      function getDynamicColumn(field) {
        return dews.ui.gridUtil.getDynamicColumn(this, field);
      } }, { key: "deleteNote", value:
      function deleteNote(options) {
        return dews.ui.gridUtil.deleteNote(this, options);
      } }, { key: "setDisabledNoteRows", value:
      function setDisabledNoteRows(dataIndex) {
        return dews.ui.gridUtil.setDisabledNoteRows(this, dataIndex);
      } }, { key: "getGridNoteInfo", value:
      function getGridNoteInfo(itemIndex) {
        return dews.ui.gridUtil.getGridNoteInfo(this, itemIndex);
      } }]);return GridAPI;}(Api);

  function __initialize(grid2) {
    if (grid2._filterManager) {
      grid2._filterManager._columns = {};
      grid2._filterManager._options.filter.useColumns = [];
    }
  }
  function findUserOptionsColumn3(columns, fieldName, userColumn) {
    if (!columns)
    return null;
    for (var index = 0; index < columns.length; index++) {
      if (userColumn === void 0) {
        if (columns[index].field === fieldName) {
          userColumn = columns[index];
        } else if (columns[index].columns) {
          userColumn = findUserOptionsColumn3(columns[index].columns, fieldName, userColumn);
        }
      }
    }
    return userColumn;
  }
  function _setStyles(grid2, options) {
    var self = grid2,opt2 = options;
    return opt2 = dews.ui.gridUtil.setStyles(self, opt2);
  }
  function getOptions(self, options) {
    var grid2 = self._grid,opt2,defaultOptions2 = {
        panel: {
          visible: false
        },
        checkBar: {
          visible: true,
          checkImageUrl: options.gridStyle.checkBar.checkedImg,
          unCheckImageUrl: options.gridStyle.checkBar.unCheckImg,
          headCheckImageUrl: options.gridStyle.checkBar.checkedImg,
          headUnCheckImageUrl: options.gridStyle.checkBar.unCheckImg
        },
        stateBar: {
          visible: false
        },
        header: {
          minHeight: options.gridStyle.header.height,
          heightFill: "fixed"
        },
        footer: {
          visible: false,
          height: options.gridStyle.footer.height,
          minHeight: options.gridStyle.footer.height
        },
        indicator: {
          visible: true,
          headText: "No",
          footText: " "
        },
        edit: {
          insertable: false,
          appendable: false,
          editable: false,
          crossWhenExitLast: true,
          showInvalidFormatMessage: false,
          enterToTab: true,
          checkDiff: true,
          skipReadOnly: false
        },
        display: {
          fitStyle: "even",
          showEmptyMessage: false,
          emptyMessage: "",
          showEmptyImage: true,
          rowHeight: options.gridStyle.body.height,
          minHeight: options.gridStyle.body.height,
          focusColor: options.gridStyle.selection.focusBorderColor,
          focusBorderWidth: "2px",
          innerFocusColor: options.gridStyle.selection.focusBorderColor,
          showInnerFocus: true,
          columnMovable: options.movable ? options.movable : false,
          columnResizable: true,
          editingMergedRow: false,
          editItemMerging: true,
          heightMeasurer: "fixed",
          wheelEventPropagate: false
        },
        copy: {
          singleMode: false,
          copyDisplayText: true
        },
        paste: {
          singleMode: false,
          checkReadOnly: true,
          noEditEvent: true,
          numberChars: [",", " "]
        },
        select: {
          style: "block"
        },
        sorting: {
          enabled: true,
          style: "exclusive",
          keepFocusedRow: true
        },
        fixed: {
          colBarWidth: 1,
          rowBarHeight: 1
        },
        filtering: {
          imageHandle: true,
          handleImages: {
            fill: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png",
            hoveredNone: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-off.png",
            hoveredFill: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png"
          }
        },
        dataBounding: false,
        rowDynamic: [],
        autoBind: true,
        depth: 1,
        columnsDepth: 0,
        maxDepth: 1,
        grouping: false,
        groupCol: 1,
        maxGroupCol: 1,
        context: true,
        editSkip: false,
        copyMode: "row",
        sortMode: "explicit",
        isVisible: true,
        fillWidth: true,
        images: [],
        displayColumns: [],
        _originColumns: [],
        multiFooterCnt: 1,
        shiftCheck: dews._environments.gridShiftCheck,
        detailGrid: {
          addedRowDataSourceRead: true
        }
      };
    opt2 = $.extend(true, defaultOptions2, options);
    opt2._originColumns = [].concat(opt2.columns);
    if ($.type(opt2.rowNo) !== "undefined") {
      if ($.type(opt2.rowNo) === "object") {
        opt2.indicator.visible = true;
        opt2.indicator.headText = $.type(opt2.rowNo.text) === "undefined" ? opt2.indicator.headText : opt2.rowNo.text;
        opt2.indicator.width = $.type(opt2.rowNo.width) === "undefined" ? 40 : opt2.rowNo.width;
      } else if ($.type(opt2.rowNo) === "boolean") {
        opt2.indicator.visible = opt2.rowNo;
      }
    }
    if ($.type(opt2.selectable) !== "undefined") {
      if (opt2.selectable === true) {
        opt2.display.rowFocusVisible = true;
        opt2.display.rowFocusBackground = opt2.gridStyle.selectionBackground;
      } else if (opt2.selectable === false) {
        opt2.display.rowFocusVisible = false;
        delete opt2.display.rowFocusBackground;
      }
    }
    if ($.type(opt2.sortable) !== "undefined") {
      if (opt2.sortable === "multiple") {
        opt2.sorting.style = "inclusive";
        opt2.sorting.enabled = true;
      } else {
        opt2.sorting.enabled = opt2.sortable;
      }
    }
    if ($.type(opt2.sort) !== "undefined") {
      opt2.sorting.sort = opt2.sort;
    }
    if ($.type(opt2.rowEditable) !== "undefined") {
      opt2.edit.rowEditable = opt2.rowEditable;
    }
    if ($.type(opt2.editable) !== "undefined") {
      opt2.edit.editable = opt2.editable;
    }
    if ($.type(opt2.checkable) !== "undefined") {
      opt2.checkBar.visible = opt2.checkable;
    }
    if ($.type(opt2.stateColumn) === "boolean") {
      opt2.stateBar.visible = opt2.stateColumn;
    }
    if ($.type(opt2.readOnly) !== "undefined") {
      opt2.edit.readOnly = opt2.readOnly;
    }
    if ($.type(opt2.editSkip) === "boolean" && opt2.editSkip) {
      opt2.editSkip = true;
      opt2.edit.skipReadOnly = true;
    }
    if ($.type(opt2.noData) === "boolean") {
      opt2.display.showEmptyMessage = opt2.noData;
      opt2.display.showEmptyImage = opt2.noDataImage || opt2.display.showEmptyImage;
      if (opt2.display.showEmptyMessage && $.type(opt2.noDataMessage) !== "undefined") {
        opt2.display.emptyMessage = opt2.noDataMessage;
      } else {
        opt2.display.emptyMessage = dews.localize.get("\uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.", "dews_\uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");
      }
    }
    if (!opt2.fillWidth) {
      opt2.display.fitStyle = "none";
    }
    if ($.type(opt2.resizable) === "boolean") {
      opt2.display.columnResizable = opt2.resizable;
    }
    if ($.type(opt2.editingMergedRow) !== "undefined") {
      opt2.display.editItemMerging = opt2.editingMergedRow;
    }
    if ($.type(opt2.pasteMode) !== "undefined") {
      opt2.paste.singleMode = opt2.pasteMode === "cell";
    }
    if (opt2.selectionMode === "cell") {
      opt2.select.style = "none";
    } else {
      opt2.select.style = "block";
    }
    if (typeof opt2.filter === "boolean") {
      opt2.filter.use = opt2.filter;
    } else if (_typeof(opt2.filter) === "object") {
      if (opt2.filter.iconVisible) {
        opt2.filtering.handleImages = {
          none: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-off.png",
          fill: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png",
          hoveredNone: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-off.png",
          hoveredFill: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png"
        };
      } else {
        opt2.filtering.handleImages = {
          none: "",
          fill: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png",
          hoveredNone: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-off.png",
          hoveredFill: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png"
        };
      }
    }
    opt2 = _setStyles(grid2, opt2);
    var UUIDFlag = false;
    $.each(opt2.columns, function (idx, column) {
      if (column.field === "__UUID") {
        UUIDFlag = true;
        return false;
      }
    });
    if (!UUIDFlag && opt2.columns) {
      opt2.columns.splice(0, 0, {
        field: "__UUID",
        fieldName: "__UUID",
        name: "__UUID",
        visible: false,
        header: { text: " " }
      });
    }
    opt2.styleColumn = [];
    __initialize(self);
    opt2 = customizingColumn(opt2.columns, opt2, self);
    delete opt2.fieldIndex;
    grid2.setColumns(opt2.columns);
    grid2.setHeader({ height: opt2.maxDepth * opt2.header.minHeight });
    grid2.setFooter({
      minHeight: opt2.footer.minHeight,
      height: opt2.footer.minHeight
    });
    if (opt2.grouping) {
      opt2.display.rowHeight = opt2.display.minHeight * opt2.maxGroupCol;
    }
    if (opt2.dataSource && opt2.dataSource.options.group) {
      opt2.group = opt2.dataSource.options.group;
    }
    if (typeof opt2.group !== "undefined") {
      setGroup(grid2, opt2);
    }
    return opt2;
  }
  function setGroup(grid2, opt2) {var _opt2$group;
    var group = (_opt2$group = opt2.group) === null || _opt2$group === void 0 ? void 0 : _opt2$group.map(function (g) {return g.field;});
    grid2.groupBy(group);
    var groupOption = {};
    if (typeof opt2.groupHeaderTemplate !== "undefined") {
      var state = opt2.groupHeaderTemplate;
      var index = 0;
      if (typeof opt2.groupHeaderColumn !== "undefined") {
        for (var g = 0; g < grid2.getDisplayColumns().length; g += 1) {
          if (opt2.groupHeaderColumn === grid2.getDisplayColumns()[g]) {
            index = g + 1;
            break;
          }
        }
        var groupText = opt2.columns[index].header.text;
        groupOption.headerCallback = function (groupModel, grid3) {
          var dataProvider = grid3.getDataSource();
          var replaceState = state;
          if (/\${title}/.test(replaceState)) {
            replaceState = replaceState.replace(/\${title}/gi, groupText);
          }
          if (/\${field}/.test(replaceState)) {
            replaceState = replaceState.replace(/\${field}/gi, opt2.groupHeaderColumn);
          }
          if (/\${value}/.test(replaceState)) {
            replaceState = replaceState.replace(
            /\${value}/gi,
            dataProvider.getValue(groupModel.firstItem.dataRow, opt2.groupHeaderColumn));

          }
          if (/\${count}/.test(replaceState)) {
            replaceState = replaceState.replace(/\${count}/gi, groupModel.dataRows.length);
          }
          return replaceState;
        };
        groupOption.headerStatement = null;
      } else {
        for (var _g = 0; _g < grid2.getDisplayColumns().length; _g++) {
          for (var r = 0; r < group.length; r++) {
            if (group[r] === grid2.getDisplayColumns()[_g]) {
              index = _g + 1;
              break;
            }
          }
        }
        if (/\${title}/.test(state)) {
          state = state.replace(/\${title}/gi, "${columnHeader}");
        }
        if (/\${field}/.test(state)) {
          state = state.replace(/\${field}/gi, "${groupField}");
        }
        if (/\${value}/.test(state)) {
          state = state.replace(/\${value}/gi, "${groupValue}");
        }
        if (/\${count}/.test(state)) {
          state = state.replace(/\${count}/gi, "${rowCount}");
        }
        groupOption.headerStatement = state;
      }
    }
    if (typeof opt2.dataSource.options.userGroup !== "undefined" && opt2.dataSource.options.userGroup) {
      groupOption.mergeMode = true;
      groupOption.collapsedAdornments = "footer";
      groupOption.expandedAdornments = "footer";
      opt2.panel.visible = true;
    }
    groupOption["levels"] = setGroupLevelColor(group.length);
    grid2.setRowGroup(groupOption);
    grid2.setSortingOptions({
      handleVisibility: "hidden"
    });
    function setGroupLevelColor(groupCnt) {
      var groupLevelStyles = [];
      for (var i = 1; i < groupCnt + 1; i++) {
        var levelColor = "rgba(0, 85, 170, ".concat(0.12 * i, ")");
        groupLevelStyles.push({
          headerStyles: {
            background: levelColor,
            fontBold: true
          },
          headerBarStyles: {
            background: levelColor
          },
          barStyles: {
            background: levelColor
          }
        });
      }
      return groupLevelStyles;
    }
  }

  // src/js/grid/api/TreeGridAPI.js
  var TreeGridAPI = /*#__PURE__*/function (_Api2) {"use strict";_inherits(TreeGridAPI, _Api2);var _super4 = _createSuper(TreeGridAPI);function TreeGridAPI() {_classCallCheck(this, TreeGridAPI);return _super4.apply(this, arguments);}_createClass(TreeGridAPI, [{ key: "showTooltip", value:
      function showTooltip(itemIndex, column, options) {
        var index = this._grid.getItemIndex(itemIndex);
        _get(_getPrototypeOf(TreeGridAPI.prototype), "showTooltip", this).call(this, index, column, options);
      } }, { key: "cancelRow", value:
      function cancelRow() {
        var self = this,current = self._grid.getCurrent(),rowId = self._grid.getDataRow(current.itemIndex);
        _get(_getPrototypeOf(TreeGridAPI.prototype), "cancelRow", this).call(this, rowId);
      } }, { key: "cancelCell", value:
      function cancelCell() {
        var self = this,column = self._grid.getCurrent().column.toUpperCase(),row = self._grid.getDataRow(self._grid.getCurrent().itemIndex),dataSource = self.options.dataSource,fieldIndex = 0,originData;
        if (dataSource && dataSource.dataProvider && dataSource.dataProvider._dp._rowMap[row]) {
          fieldIndex = dataSource.dataProvider._dp._fieldNames.indexOf(column);
          originData = $.type(dataSource.dataProvider._dp._rowMap[row]._orgValues) === "null" ? dataSource.dataProvider._dp._rowMap[row]._values : dataSource.dataProvider._dp._rowMap[row]._orgValues;
          if ($.type(originData) !== "null") {
            self._grid.setValue(self._grid.getCurrent().itemIndex, column, originData[fieldIndex]);
          } else if (dataSource.dataProvider.getRowState(row) === "created") {
            self._grid.setValue(self._grid.getItemIndex(row), column, void 0);
          }
        }
      } }, { key: "saveAsExcel", value:
      function saveAsExcel(options) {
        var self = this;
        if (options.excelDownloadExpandAll === true) {
          self._grid.expandAll();
        }
        var exporter = new ExcelExporter();
        exporter["export"](options, self);
      } }]);return TreeGridAPI;}(Api);


  // src/js/grid/column/treegridCustomizingColumn.js
  function treeCustomizingColumn(columns, opt2, treeGrid) {
    if (columns && opt2.dataSource && opt2.dataSource.options.field) {
      var dataSource = opt2.dataSource.options;
      opt2.columnsDepth = opt2.columnsDepth + 1;
      var d = opt2.columnsDepth;
      if (columns && $.type(treeGrid.multiHeaderFlag) === "undefined" && columns[0].field !== "__UUID") {
        columns.splice(0, 0, {
          field: "__UUID",
          fieldName: "__UUID",
          name: "__UUID",
          visible: false,
          header: { text: " " }
        });
      } else {
        delete treeGrid.multiHeaderFlag;
      }
      $.each(columns, function (i) {
        if ($.type(columns[i]) !== "undefined") {
          columns[i].fieldName = columns[i].field;
          if ($.type(columns[i].editable) === "undefined") {
            columns[i].editable = true;
          }
          if ($.type(columns[i].field) !== "undefined") {
            columns[i].name = columns[i].field;
          }
          for (var f = 0; f < dataSource.field.length; f += 1) {
            if (columns[i].fieldName === dataSource.field[f].fieldName) {
              opt2.fieldIndex = f;
              break;
            }
            if (f === dataSource.field.length - 1) {
              opt2.fieldIndex = void 0;
            }
          }
          if ($.type(columns[i].styles) === "undefined") {
            columns[i].styles = {};
          }
          if ($.type(opt2.fieldIndex) !== "undefined" && $.type(dataSource.field[opt2.fieldIndex].styles) === "undefined") {
            dataSource.field[opt2.fieldIndex].styles = {};
          }
          if ($.type(columns[i].editor) === "undefined") {
            columns[i].editor = {
              type: "text"
            };
          }
          if ($.type(columns[i].width) === "undefined" && opt2.display.fitStyle === "fill") {
            columns[i].fillWidth = 1;
          }
          if ($.type(columns[i].width) !== "undefined" && dews.ui.gridUtil.gridStyle.fontSize !== 12) {
            var fontSize = dews.ui.gridUtil.gridStyle.fontSize;
            switch (fontSize) {
              case 15:
                columns[i].width = Math.floor(1.25 * columns[i].width);
                break;
              case 18:
                columns[i].width = Math.floor(1.5 * columns[i].width);
                break;
              case 24:
                columns[i].width = Math.floor(2 * columns[i].width);
                break;
              case 30:
                columns[i].width = Math.floor(2.5 * columns[i].width);
                break;}

          }
          if (columns[i].title) {
            columns[i].header = $.extend(true, columns[i].header, {
              text: columns[i].title,
              fixedHeight: opt2.display.rowIndex
            });
          } else {
            columns[i].header = {
              text: " "
            };
          }
          if (columns[i].headerCheck === true || _typeof(columns[i].headerCheck) === "object") {
            columns[i].header.checkLocation = typeof columns[i].headerCheck.location === "undefined" ? "right" : columns[i].headerCheck.location;
            treeGrid._grid.setColumnHeaderOptions({
              checkVisibility: "visible",
              imageCheckHandle: true,
              checkImages: {
                none: opt2.gridStyle.body.unCheckImg,
                hoveredNone: opt2.gridStyle.body.unCheckImg,
                fill: opt2.gridStyle.body.checkedImg,
                hoveredFill: opt2.gridStyle.body.checkedImg
              }
            });
          } else {
            columns[i].header.checkLocation = "none";
            treeGrid._grid.setColumnHeaderOptions({
              checkVisibility: "hidden",
              imageCheckHandle: false
            });
          }
          if ($.type(opt2.styles) !== "undefined" && $.type(opt2.styles.textAlign) !== "undefined") {
            columns[i].align = opt2.styles.textAlign;
          } else if ($.type(columns[i].align) === "undefined") {
            columns[i].align = "center";
          }
          if (columns[i].align) {
            var align;
            if (columns[i].align === "right") {
              align = "far";
            } else if (columns[i].align === "left") {
              align = "near";
            } else {
              align = "center";
            }
            columns[i].styles.textAlignment = align;
          }
          treeGrid._filterManager.columnOptionConvert(columns[i]);
          if (columns[i].formats) {
            if ($.type(columns[i].formats.type) === "undefined") {
              columns[i].formats.type = "text";
            }
            switch (columns[i].formats.type.toUpperCase()) {
              case "DATE":
                if (columns[i].formats.predefined === true) {
                  if ($.type(columns[i].formats.preFormat) === "undefined") {
                    columns[i].formats.preFormat = columns[i].formats.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].formats);
                  if (preDefinedFormat) {
                    columns[i].formats.format = preDefinedFormat;
                  } else {
                    columns[i].formats.format = dews._environments.formats.dateFormat;
                  }
                }
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                columns[i].styles.datetimeFormat = $.type(columns[i].formats.format) === "undefined" ? dews._environments.formats.dateFormat : columns[i].formats.format;
                break;
              case "LINK":
                columns[i].renderer = $.extend(true, columns[i].renderer, {
                  type: "link",
                  url: dews.url.getAbsoluteUrl("${" + columns[i].field + "}"),
                  showUrl: false,
                  useMenu: $.type(columns[i].formats.useMenu) === "boolean" ? columns[i].formats.useMenu : false,
                  cursor: "pointer"
                });
                break;
              case "MASK":
                var mask = columns[i].formats.format,replace = "",exp = "(",regchar = "",regcount = 1,expcount = 0;
                var predefined = columns[i].formats.predefined;
                var predefined = columns[i].formats.predefined;
                var secureFormat = columns[i].formats.secureFormat;
                if (predefined) {
                  exp = "(.*)$";
                  replace = function replace(match) {
                    var groups = Array.prototype.splice.call(arguments, 1);
                    var orgValue = groups[groups.length - 1];
                    var chgValue = orgValue;
                    var secureMask = dews.getSecureMaskFormat(secureFormat);
                    if (mask && mask !== "") {
                      chgValue = dews.string.secureMask(chgValue, mask, false);
                    }
                    if (secureMask) {
                      chgValue = dews.string.secureMask(chgValue, secureFormat, true);
                    }
                    return chgValue;
                  };
                } else if (!predefined && secureFormat && secureFormat !== "") {
                  exp = "(.*)$";
                  replace = function replace(match) {
                    var groups = Array.prototype.splice.call(arguments, 1);
                    var orgValue = groups[groups.length - 1];
                    var chgValue = orgValue;
                    if (mask && mask !== "") {
                      chgValue = dews.string.secureMask(chgValue, mask, false);
                    }
                    if (secureFormat.match(/[,]/g) && secureFormat.match(/[,]/g).length > 1) {
                      chgValue = dews.string.secureMask(chgValue, secureFormat, false);
                    }
                    return chgValue;
                  };
                } else if (mask && mask !== "") {
                  for (var m = 0; m < mask.length; m += 1) {
                    if (mask[m] !== regchar && regchar === "*") {
                      exp += "{" + expcount + "})(";
                      expcount = 0;
                      regcount++;
                    }
                    switch (mask[m]) {
                      case "0":
                      case "9":
                        if (expcount === 0) {
                          exp += "\\d";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}\\d";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "#":
                        if (expcount === 0) {
                          exp += "\\d";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}\\d";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "L":
                        if (expcount === 0) {
                          exp += "[a-zA-Z]";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}[a-zA-Z]";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "?":
                        if (expcount === 0) {
                          exp += "[a-zA-Z]";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}[a-zA-Z]";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "&":
                        if (expcount === 0) {
                          exp += "\\S";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}\\S";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "C":
                        if (expcount === 0) {
                          exp += ".";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}.";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "A":
                      case "a":
                        if (expcount === 0) {
                          exp += "[a-zA-Z0-9]";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}[a-zA-Z0-9]";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "*":
                        if (expcount === 0) {
                          exp += "[a-zA-Z0-9]";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "})([a-zA-Z0-9]";
                          replace += "$" + regcount;
                          expcount = 0;
                          regcount++;
                        }
                        replace += "*";
                        regchar = mask[m];
                        expcount++;
                        break;
                      default:
                        if (mask[m] !== "*") {
                          replace += "$" + regcount + mask[m];
                        }
                        exp += "{" + expcount + "})(";
                        expcount = 0;
                        regcount++;
                        break;}

                    if (m === mask.length - 1) {
                      exp += "{" + expcount + "})";
                      if (regchar !== "*") {
                        replace += "$" + regcount;
                      }
                    }
                  }
                } else {
                  exp = "(.*)$";
                  replace = function replace(match) {
                    var groups = Array.prototype.splice.call(arguments, 1);
                    var orgValue = groups[groups.length - 1];
                    return orgValue;
                  };
                }
                columns[i].displayRegExp = exp;
                columns[i].displayReplace = replace;
                break;
              case "NUMBER":
                if (columns[i].formats.predefined === true) {
                  if ($.type(columns[i].formats.preFormat) === "undefined") {
                    columns[i].formats.preFormat = columns[i].formats.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].formats);
                  if ($.type(preDefinedFormat) === "object") {
                    columns[i].formats.round = preDefinedFormat.round;
                    preDefinedFormat = preDefinedFormat.format;
                  }
                  if (typeof columns[i].formats.currency === "string") {
                    columns[i].formats.preCurrency = columns[i].formats.currency;
                    preDefinedFormat = dews.getCurrencyFormat(columns[i].formats);
                    if ($.type(preDefinedFormat) === "object") {
                      columns[i].formats.round = preDefinedFormat.round;
                      preDefinedFormat = preDefinedFormat.format;
                    }
                  } else if (typeof columns[i].formats.currency === "function") {
                    delete columns[i].formats.round;
                    columns[i].formats.preCurrency = "";
                    columns[i].displayCallback = function (realgrid, index, value2) {
                      var dewsTreeGrid = $(realgrid._gv._container._containerDiv).closest(".dews-data-control").data("dews-control");
                      var dewsParams = {
                        treegrid: dewsTreeGrid,
                        row: {
                          index: index.dataRow,
                          data: dewsTreeGrid.dataItem(index.dataRow)
                        },
                        cell: {
                          field: index.column,
                          data: dewsTreeGrid.getCellValue(index.dataRow, index.column)
                        }
                      };
                      var dewsCol = dewsTreeGrid.columns[index.column];
                      dewsCol.formats.preCurrency = dewsCol.formats.currency.call(
                      dewsCol,
                      dewsParams);

                      var env = dews.ui.page && dews.ui.page.env && dews.ui.page.env[dewsCol.formats.preFormat];
                      var predefinedFormat = dews.getCurrencyFormat(dewsCol.formats),formats = "#,###.##",round2 = "round";
                      if (env) {
                        formats = env.format;
                        round2 = dews.mathType[env.round];
                      }
                      if ($.type(predefinedFormat) === "object") {
                        formats = predefinedFormat.format;
                        round2 = $.type(predefinedFormat.round) === "string" ? predefinedFormat.round : round2;
                      } else if ($.type(predefinedFormat) === "string") {
                        formats = predefinedFormat;
                      }
                      if (round2 !== "round") {
                        if (formats.split(".").length === 2) {
                          var sosu = Math.pow(10, formats.split(".")[1].length);
                          if (round2 === "ceil") {
                            value2 = Math.ceil(value2 * sosu) / sosu;
                          } else {
                            value2 = Math.floor(value2 * sosu) / sosu;
                          }
                        }
                      }
                      var oldFormats = dewsTreeGrid._grid.getColumnProperty(
                      dewsCol.name,
                      "excelFormat");

                      if (!oldFormats) {
                        dewsTreeGrid._grid.setColumnProperty(dewsCol.name, "excelFormat", formats);
                      }
                      return dews.number.format(value2, formats);
                    };
                  }
                  if (preDefinedFormat) {
                    columns[i].formats.format = preDefinedFormat;
                  } else {
                    columns[i].formats.format = "#,##0.##";
                  }
                }
                if ($.type(columns[i].formats.abs) === "boolean" && columns[i].formats.abs) {
                  columns[i].dynamicStyles = [
                  {
                    criteria: "value<0",
                    styles: {
                      foreground: $.type(columns[i].formats.negative) === "undefined" ? "#e62324" : columns[i].formats.negative,
                      numberFormat: columns[i].formats.format + ";a"
                    }
                  }];

                  if ($.type(columns[i].formats.positive) !== "undefined") {
                    columns[i].dynamicStyles.push({
                      criteria: "value>=0",
                      styles: {
                        foreground: columns[i].formats.positive,
                        numberFormat: columns[i].formats.format + ";a"
                      }
                    });
                  }
                }
                if (columns[i].formats.negativeColor) {var _dews$ui$page2;
                  var useNegativeColor = false;
                  var MA00041 = (_dews$ui$page2 = dews.ui.page) === null || _dews$ui$page2 === void 0 ? void 0 : _dews$ui$page2.env["MA00041"];
                  if (MA00041) {
                    useNegativeColor = MA00041.value === "2";
                  }
                  if (useNegativeColor) {
                    columns[i].dynamicStyles = [
                    {
                      criteria: "value<0",
                      styles: {
                        foreground: "#e62324"
                      }
                    }];

                  }
                }
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].dataType = "number";
                  dataSource.field[opt2.fieldIndex].min = columns[i].formats.min;
                  dataSource.field[opt2.fieldIndex].max = columns[i].formats.max;
                  dataSource.field[opt2.fieldIndex].styles.numberFormat = $.type(columns[i].formats.format) === "undefined" ? "#,##0.##" : columns[i].formats.format;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "number";
                  dataSource.schema.model.fields[opt2.fieldIndex].numberFormat = $.type(columns[i].formats.format) === "undefined" ? "#,##0.##" : columns[i].formats.format;
                }
                if ($.type(columns[i].formats.round) === "undefined" || columns[i].formats.round === "round") {
                  if ($.type(columns[i].formats.currency) !== "function") {
                    columns[i].styles.numberFormat = columns[i].formats.format;
                  }
                } else if (columns[i].formats.round === "ceil") {
                  columns[i].styles.numberFormat = columns[i].formats.format + ";;;c";
                } else if (columns[i].formats.round === "floor") {
                  columns[i].styles.numberFormat = columns[i].formats.format + ";;;f";
                }
                break;
              case "CHECK":
                columns[i].renderer = {
                  type: "check",
                  shape: "box",
                  editable: false,
                  startEditOnClick: true,
                  trueValues: $.type(columns[i].formats.trueValue) === "undefined" ? "true" : columns[i].formats.trueValue,
                  falseValues: $.type(columns[i].formats.falseValue) === "undefined" ? "false" : columns[i].formats.falseValue,
                  trueImage: opt2.gridStyle.body.checkedImg,
                  falseImage: opt2.gridStyle.body.unCheckImg,
                  labelPosition: "none",
                  showInnerFocus: false
                };
                columns[i].editable = false;
                columns[i].styles.figureBackground = "#ff4995ff";
                break;
              case "DATASOURCE":
                var value = columns[i].formats.dataValueField,label = columns[i].formats.dataTextField,cfDataSource = columns[i].formats.dataSource,cfDataSourceData;
                columns[i].values = [];
                columns[i].labels = [];
                columns[i].lookupDisplay = true;
                if (cfDataSource) {
                  cfDataSource.fetch().done(function () {
                    var values2 = [],labels2 = [],column = treeGrid._grid.columnByField(columns[i].field);
                    cfDataSourceData = cfDataSource.data();
                    if (cfDataSourceData.length > 0) {
                      for (var k = 0; k < cfDataSourceData.length; k++) {
                        values2.push(cfDataSourceData[k][value]);
                        labels2.push(cfDataSourceData[k][label]);
                      }
                    }
                    if (!column) {
                      column = columns[i];
                    }
                    column.values = values2;
                    column.labels = labels2;
                    treeGrid._grid.setColumn(column);
                  });
                }
                break;
              case "IMAGE":
                columns[i].editable = false;
                columns[i].renderer = {
                  type: "image",
                  smoothing: true
                };
                columns[i].styles.contentFit = "auto";
                break;
              case "TIME":
                if (columns[i].formats.predefined === true) {
                  if ($.type(columns[i].formats.preFormat) === "undefined") {
                    columns[i].formats.preFormat = columns[i].formats.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].formats);
                  if (preDefinedFormat) {
                    columns[i].formats.format = preDefinedFormat;
                  } else {
                    columns[i].formats.format = "HH:mm:ss";
                  }
                }
                var time = columns[i].formats.format,timeReg = "";
                if (/HH/gi.test(time)) {
                  timeReg = time.replace(/HH/gi, "$1");
                }
                if (/mm/gi.test(time)) {
                  timeReg = timeReg.replace(/mm/gi, "$2");
                }
                if (/ss/gi.test(time)) {
                  timeReg = timeReg.replace(/ss/gi, "$3");
                }
                columns[i].displayRegExp = /([0-1]\d|2[0-3])([0-5]\d)([0-5]\d)?/gi;
                columns[i].displayReplace = timeReg;
                break;
              case "PASSWORD":
                var format = columns[i].formats.format;
                columns[i].displayRegExp = /([a-z0-9#?!@$%^~&*-]+)/gi;
                columns[i].displayReplace = format;
                break;
              case "MONTH":
                if (columns[i].formats.predefined === true) {
                  if ($.type(columns[i].formats.preFormat) === "undefined") {
                    columns[i].formats.preFormat = columns[i].formats.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].formats);
                  if (preDefinedFormat) {
                    columns[i].formats.format = preDefinedFormat;
                  } else {
                    columns[i].formats.format = dews._environments.formats.monthFormat;
                  }
                }
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                columns[i].styles.datetimeFormat = $.type(columns[i].formats.format) === "undefined" ? dews._environments.formats.monthFormat : columns[i].formats.format;
                break;
              case "YEAR":
                if (columns[i].formats.predefined === true) {
                  if ($.type(columns[i].formats.preFormat) === "undefined") {
                    columns[i].formats.preFormat = columns[i].formats.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].formats);
                  if (preDefinedFormat) {
                    columns[i].formats.format = preDefinedFormat;
                  } else {
                    columns[i].formats.format = dews._environments.formats.yearFormat;
                  }
                }
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.yearValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.yearValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                columns[i].styles.datetimeFormat = $.type(columns[i].formats.format) === "undefined" ? dews._environments.formats.yearFormat : columns[i].formats.format;
                break;
              case "FUNCTION":
                columns[i].displayCallback = function (realgrid, index, value2) {
                  var dewsTreeGrid = $(realgrid._gv._container._containerDiv).closest(".dews-data-control").data("dews-control");
                  var dewsParams = {
                    grid: dewsTreeGrid,
                    row: {
                      index: index.dataRow,
                      data: dewsTreeGrid.dataItem(index.dataRow)
                    },
                    cell: {
                      field: index.column,
                      data: dewsTreeGrid.getCellValue(index.dataRow, index.column)
                    }
                  };
                  return dewsTreeGrid.columns[index.column].formats.format.call(
                  dewsTreeGrid,
                  value2,
                  dewsParams);

                };
                break;
              case "BAR":
                var barRenderer = grid._columnRenderer.getBarRenderer(columns[i]);
                $.extend(true, columns[i], barRenderer);
                break;
              case "SIGNAL":
                var signalRenderer = grid._columnRenderer.getSignalRenderer(columns[i]);
                $.extend(true, columns[i], signalRenderer);
                break;}

          }
          if (columns[i].editor) {
            var editorAlign = "center";
            if (columns[i].styles.textAlignment) {
              editorAlign = columns[i].styles.textAlignment;
            }
            if ($.type(columns[i].editor.type) === "undefined") {
              columns[i].editor.type = "string";
            }
            if (typeof columns[i].editable === "boolean" && !columns[i].editable && columns[i].editor.type.toLowerCase() !== "check") {
              columns[i].editor.editable = columns[i].editable;
            } else {
              var userColumn;
              if (columns[i].editor.type.toLowerCase() === "check") {
                userColumn = findUserOptionsColumn4(treeGrid.userOptions.columns, columns[i].field);
              }
              if (userColumn && userColumn.editable !== void 0 && !userColumn.editable) {
                columns[i].editor.editable = columns[i].editable;
              } else {
                if ($.type(columns[i].editor.editable) === "boolean" || $.type(columns[i].editor.editable) === "function") {
                  columns[i].editable = columns[i].editor.editable;
                } else if ($.type(columns[i].editor.editable) === "undefined") {
                  columns[i].editor.editable = columns[i].editable;
                }
              }
            }
            columns[i].editor.textAlignment = editorAlign;
            columns[i].buttonVisibility = "hidden";
            columns[i].editButtonVisibility = "hidden";
            switch (columns[i].editor.type.toUpperCase()) {
              case "DROPDOWN":
              case "COMBO":
                var values = columns[i].editor.dataValueField,labels = columns[i].editor.dataTextField,datasource = columns[i].editor.dataSource;
                columns[i].values = [];
                columns[i].labels = [];
                columns[i].editButtonVisibility = "visible";
                if (columns[i].editor.type.toUpperCase() === "DROPDOWN") {
                  columns[i].editor.textReadOnly = true;
                  if (columns[i].editor.autoOpen) {
                    columns[i].editor.autoOpen = true;
                  }
                  columns[i].editor.useNumkey = $.type(columns[i].editor.useNumkey) === "boolean" ? columns[i].editor.useNumkey : true;
                } else {
                  columns[i].editor.textReadOnly = false;
                }
                columns[i].editor.type = "dropDown";
                columns[i].lookupDisplay = true;
                columns[i].editor.dropdowncount = 3;
                if ($.type(columns[i].editor.dataSource) === "function") {
                  datasource = columns[i].editor.dataSource.call(treeGrid, {
                    treeGrid: treeGrid,
                    row: {
                      index: 0,
                      data: {
                        labels: "",
                        values: ""
                      }
                    }
                  });
                  if ($.type(columns[i].editor.textField) === "undefined") {
                    columns[i].labelField = labels;
                  } else {
                    columns[i].labelField = columns[i].editor.textField;
                  }
                }
                if (typeof columns[i].editor.dataSelectable === "string") {
                  columns[i].editor.dataSelectable = {
                    field: columns[i].editor.dataSelectable,
                    trueValue: true,
                    falseValue: false
                  };
                }
                var dataSelectable = columns[i].editor.dataSelectable;
                columns[i].editor.values = [];
                columns[i].editor.labels = [];
                if (datasource && datasource.transport && datasource.transport.data && datasource.transport.data.length > 0) {
                  var transportData = datasource.transport.data;
                  for (var j = 0; j < transportData.length; j += 1) {
                    columns[i].values.push(transportData[j][values]);
                    columns[i].labels.push(transportData[j][labels]);
                    if (dataSelectable && transportData[j][dataSelectable.field] !== dataSelectable.falseValue) {
                      columns[i].editor.values.push(transportData[j][values]);
                      columns[i].editor.labels.push(transportData[j][labels]);
                    }
                  }
                }
                break;
              case "NUMBER":
                if (columns[i].editor.predefined === true) {
                  if ($.type(columns[i].editor.preFormat) === "undefined") {
                    columns[i].editor.preFormat = columns[i].editor.format;
                  }
                  var preDefinedFormat;
                  if ($.type(columns[i].editor.currency) === "undefined") {
                    preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                  } else if ($.type(columns[i].editor.currency) === "string") {
                    columns[i].editor.preCurrency = columns[i].editor.currency;
                    preDefinedFormat = dews.getCurrencyFormat(columns[i].editor);
                  }
                  if ($.type(preDefinedFormat) === "object") {
                    preDefinedFormat = preDefinedFormat.format;
                  }
                  if (preDefinedFormat) {
                    columns[i].editor.format = preDefinedFormat;
                  } else {
                    columns[i].editor.format = "#,##0.##";
                  }
                } else {
                  columns[i].editor.format = columns[i].editor.format ? columns[i].editor.format : "#,##0.##";
                }
                var decimalPlaceRegex = /[^.]*$/;
                var includesDot = columns[i].editor.format.indexOf(".");
                var formatLetters = includesDot !== -1 ? decimalPlaceRegex.exec(columns[i].editor.format)[0] : "";
                var formatLettersLength = formatLetters.length;
                var formatLetter = formatLettersLength > 0 ? formatLetters.charAt(formatLettersLength - 1) : "#";
                var decimalLength, intLength, maxLength;
                if (typeof columns[i].editor.maxLength === "string") {
                  maxLength = columns[i].editor.maxLength;
                } else if (typeof columns[i].editor.__maxLength === "string") {
                  maxLength = columns[i].editor.__maxLength;
                }
                if ($.type(maxLength) === "string") {
                  var maxLengthRegex = /^(\d+)(?:,(\d+))?$/;
                  var matchArray = maxLengthRegex.exec(maxLength);
                  columns[i].editor.__maxLength = maxLength;
                  if (matchArray && matchArray.length > 0) {
                    intLength = parseInt(matchArray[1], 10);
                    try {
                      if (intLength > 15) {
                        throw "\uC22B\uC790\uD14D\uC2A4\uD2B8\uBC15\uC2A4 maxLength \uC18D\uC131\uC758 \uC124\uC815 \uAC00\uB2A5\uD55C \uCD5C\uB300\uAC12\uC740 15\uC785\uB2C8\uB2E4.";
                      }
                      if (matchArray[2]) {
                        var newFormat;
                        decimalLength = parseInt(matchArray[2], 10);
                        intLength = intLength - decimalLength;
                        if (intLength <= 0) {
                          throw "\uC22B\uC790\uD14D\uC2A4\uD2B8\uBC15\uC2A4 maxLength \uC18D\uC131\uC758 \uC124\uC815\uAC12\uC740 \uC815\uC218\uBD80\uC758 \uC22B\uC790\uAC00 \uC18C\uC218\uBD80\uC758 \uC22B\uC790\uBCF4\uB2E4 \uCEE4\uC57C\uD569\uB2C8\uB2E4.";
                        }
                        if (formatLettersLength > decimalLength) {
                          newFormat = (includesDot !== -1 ? columns[i].editor.format.replace(decimalPlaceRegex, "") : columns[i].editor.format + ".") + formatLetters.substr(0, decimalLength);
                        } else if (formatLettersLength < decimalLength) {
                          newFormat = (includesDot !== -1 ? columns[i].editor.format.replace(decimalPlaceRegex, "") : columns[i].editor.format + ".") + formatLetters + formatLetter.repeat(decimalLength - formatLettersLength);
                        } else {
                          newFormat = columns[i].editor.format;
                        }
                        columns[i].editor.format = newFormat;
                      } else {
                        columns[i].editor.format = columns[i].editor.format.split(".")[0];
                      }
                    } catch (e) {
                      intLength = 15 - formatLettersLength;
                      console.error(e);
                    }
                    columns[i].editor.maxIntegerLength = intLength;
                  }
                  columns[i].editor.maxLength = 0;
                } else if (typeof maxLength === "undefined") {
                  columns[i].editor.maxIntegerLength = 15 - formatLettersLength;
                }
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].dataType = "number";
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "number";
                  dataSource.field[opt2.fieldIndex].min = columns[i].editor.min;
                  dataSource.field[opt2.fieldIndex].max = columns[i].editor.max;
                }
                columns[i].editor.editFormat = $.type(columns[i].editor.format) === "undefined" ? "#,##0.##" : columns[i].editor.format;
                columns[i].editor.increaseValue = $.type(columns[i].editor.increaseValue) === "undefined" ? 1e3 : parseFloat(columns[i].editor.increaseValue);
                columns[i].editor.increaseType = $.type(columns[i].editor.increaseType) === "undefined" ? "multiple" : columns[i].editor.increaseType;
                break;
              case "STRING":
                columns[i].editor.type = "text";
                break;
              case "DATE":
                if (columns[i].editor.predefined === true) {
                  if ($.type(columns[i].editor.preFormat) === "undefined") {
                    columns[i].editor.preFormat = columns[i].editor.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                  if (preDefinedFormat) {
                    columns[i].editor.format = preDefinedFormat;
                  } else {
                    columns[i].editor.format = dews._environments.formats.dateFormat;
                  }
                }
                columns[i].editor.maxDate = new Date(9999, 12, 0);
                columns[i].editor.minDate = new Date(1e3, 0, 1);
                columns[i].editor.yearDisplayFormat = "{Y}" + dews.localize.get("\uB144", "dews_\uB144Y");
                columns[i].editor.months = dews.localize.getMonth();
                columns[i].editor.weekDays = dews.localize.getDays();
                columns[i].editor.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.dateFormat : columns[i].editor.format;
                columns[i].styles.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.dateFormat : columns[i].editor.format;
                columns[i].editor.mask = {
                  editMask: $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.dateFormat.replace(/[A-z\\s]/gi, "9") : columns[i].editor.format.replace(/[A-z\\s]/gi, "9"),
                  includedFormat: true
                };
                columns[i].editButtonVisibility = "visible";
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                break;
              case "READONLY":
                columns[i].readOnly = true;
                columns[i].editable = false;
                break;
              case "MASK":
              case "TIME":
                var editMask = columns[i].editor.format;
                if (editMask) {
                  for (var em = 0; em < editMask.length; em += 1) {
                    switch (editMask[em]) {
                      case "L":
                      case "?":
                      case "#":
                      case "&":
                        editMask = editMask.replace(editMask[em], "a");
                        break;
                      case "A":
                      case "a":
                        editMask = editMask.replace(editMask[em], "*");
                        break;
                      case "H":
                      case "m":
                      case "s":
                        editMask = editMask.replace(editMask[em], "0");
                        break;}

                  }
                }
                if (columns[i].editor.type.toUpperCase() === "TIME") {
                  columns[i].editor.type = "time";
                  if (columns[i].editor.predefined === true) {
                    if ($.type(columns[i].editor.preFormat) === "undefined") {
                      columns[i].editor.preFormat = columns[i].editor.format;
                    }
                    var preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                    if (preDefinedFormat) {
                      editMask = preDefinedFormat;
                    } else {
                      editMask = "HH:mm:ss";
                    }
                  }
                  var secondValue = false;
                  if (typeof columns[i].editor.secondValue === "boolean" && columns[i].editor.secondValue === true) {
                    secondValue = true;
                  }
                  columns[i].button = "image";
                  columns[i].buttonVisibility = "visible";
                  if ($.type(columns[i].editor.editable) === "boolean" && !columns[i].editor.editable) {
                    columns[i].buttonVisibility = "hidden";
                  }
                  var clockIcon = dews._environments.scriptBase + "realgrid/assets/comp-icon-clock.png";
                  columns[i].imageButtons = {
                    width: 24,
                    height: 22,
                    images: [
                    {
                      name: "timebutton",
                      up: clockIcon,
                      hover: clockIcon,
                      down: clockIcon
                    }]

                  };
                  if ($("#" + treeGrid._grid.name + "_time").length === 0) {
                    var timepicker = $('<input class="dews-ui-timepicker">');
                    timepicker.prop("id", treeGrid._grid.name + "_time");
                    $("body").after(timepicker);
                    columns[i].timepicker = dews.ui.timepicker(timepicker, {
                      secondValue: secondValue
                    });
                    $("body").after(columns[i].timepicker.timeView.ul.parent(".k-list-container"));
                  } else {
                    columns[i].timepicker = dews.ui.timepicker($("#" + treeGrid._grid.name + "_time"));
                  }
                  columns[i].timepicker.wrapper.css({
                    display: "none",
                    height: opt2.display.rowHeight
                  });
                } else {
                  columns[i].editor.type = "text";
                }
                if ($.type(editMask) === "function") {
                  columns[i].editor.mask = {
                    allowEmpty: true
                  };
                } else {
                  if (editMask !== "") {
                    columns[i].editor.mask = {
                      editMask: editMask,
                      allowEmpty: true
                    };
                  }
                }
                break;
              case "CODEPICKER":
                columns[i].editor.firstClick = true;
                columns[i].button = "image";
                columns[i].buttonVisibility = "visible";
                if ($.type(columns[i].editor.editable) === "boolean") {
                  if (!columns[i].editor.editable) {
                    columns[i].buttonVisibility = "hidden";
                  }
                }
                columns[i].imageButtons = {
                  width: 24,
                  height: 22,
                  images: [
                  {
                    name: "codepickerbutton",
                    up: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
                    hover: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
                    down: dews._environments.scriptBase + "realgrid/assets/search_ico.png"
                  }]

                };
                opt2._grid = true;
                columns[i].codeOption = {
                  field: columns[i].field,
                  code: columns[i].editor.helpCode,
                  codeField: columns[i].editor.codeField,
                  textField: columns[i].editor.textField,
                  gridCodeField: columns[i].editor.gridCodeField,
                  gridTextField: columns[i].editor.gridTextField,
                  params: columns[i].editor.helpParams,
                  size: columns[i].editor.helpSize,
                  title: columns[i].editor.helpTitle,
                  mode: "single",
                  width: columns[i].editor.helpWidth,
                  height: columns[i].editor.helpHeight,
                  initData: columns[i].editor.initData,
                  callback: columns[i].editor.callback,
                  custom: columns[i].editor.helpCustom || false,
                  viewUrl: columns[i].editor.helpViewUrl,
                  apiUrl: columns[i].editor.helpApiUrl,
                  moveFocus: $.type(columns[i].editor.moveFocus) === "boolean" ? columns[i].editor.moveFocus : true,
                  useAjax: $.type(columns[i].editor.useAjax) === "boolean" ? columns[i].editor.useAjax : true,
                  validation: $.type(columns[i].editor.validation) === "boolean" ? columns[i].editor.validation : true,
                  value: {}
                };
                break;
              case "BUTTON":
                columns[i].buttonVisibility = "always";
                if ($.type(columns[i].editor.align) !== "undefined") {
                  switch (columns[i].editor.align.toLowerCase()) {
                    case "left":
                      columns[i].editor.align = "near";
                      break;
                    case "right":
                      columns[i].editor.align = "far";
                      break;}

                }
                columns[i].renderer = {
                  type: "imageButtons",
                  showText: true,
                  width: $.type(columns[i].editor.buttonWidth) === "undefined" ? 50 : columns[i].editor.buttonWidth,
                  height: $.type(columns[i].editor.buttonHeight) === "undefined" ? 25 : columns[i].editor.buttonHeight,
                  images: {
                    up: columns[i].editor.basicImg,
                    hover: columns[i].editor.hoverImg,
                    down: columns[i].editor.clickImg,
                    width: $.type(columns[i].editor.buttonWidth) === "undefined" ? 50 : columns[i].editor.buttonWidth
                  },
                  alignment: columns[i].editor.align ? columns[i].editor.align : "center",
                  margin: columns[i].editor.align === "far" ? -4 : 0
                };
                break;
              case "CHECK":
                columns[i].renderer = {
                  type: "check",
                  shape: "box",
                  editable: $.type(columns[i].editor.editable) === "boolean" ? columns[i].editor.editable : true,
                  startEditOnClick: true,
                  trueValues: $.type(columns[i].editor.trueValue) === "undefined" ? "true" : columns[i].editor.trueValue,
                  falseValues: $.type(columns[i].editor.falseValue) === "undefined" ? "false" : columns[i].editor.falseValue,
                  trueImage: opt2.gridStyle.body.checkedImg,
                  falseImage: opt2.gridStyle.body.unCheckImg,
                  labelPosition: "none",
                  showInnerFocus: false
                };
                columns[i].editable = false;
                columns[i].styles.figureBackground = "#ff4995ff";
                break;
              case "ZIPCODEPICKER":
                columns[i].button = "image";
                columns[i].buttonVisibility = "visible";
                if ($.type(columns[i].editor.editable) === "boolean" && !columns[i].editor.editable) {
                  columns[i].buttonVisibility = "hidden";
                }
                columns[i].imageButtons = {
                  width: 24,
                  height: 22,
                  images: [
                  {
                    name: "zipcodepickerbutton",
                    up: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
                    hover: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
                    down: dews._environments.scriptBase + "realgrid/assets/search_ico.png"
                  }]

                };
                opt2._grid = true;
                columns[i].codeOption = {
                  field: columns[i].field,
                  addressType: $.type(columns[i].editor.addressType) === "undefined" ? "zipcode" : columns[i].editor.addressType,
                  callback: columns[i].editor.callback
                };
                break;
              case "MULTILINE":
                columns[i].editor.type = "multiline";
                columns[i].styles.textWrap = "explicit";
                break;
              case "MONTH":
                if (columns[i].editor.predefined === true) {
                  if ($.type(columns[i].editor.preFormat) === "undefined") {
                    columns[i].editor.preFormat = columns[i].editor.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                  if (preDefinedFormat) {
                    columns[i].editor.format = preDefinedFormat;
                  } else {
                    columns[i].editor.format = dews._environments.formats.monthFormat;
                  }
                }
                columns[i].editor.minDate = new Date(1900, 0, 1);
                columns[i].editor.maxDate = new Date(2100, 12, 0);
                columns[i].editor.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.monthFormat : columns[i].editor.format;
                columns[i].styles.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.monthFormat : columns[i].editor.format;
                columns[i].editor.mask = {
                  editMask: $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.monthFormat.replace(/[A-z\\s]/gi, "9") : columns[i].editor.format.replace(/[A-z\\s]/gi, "9"),
                  includedFormat: true
                };
                columns[i].button = "image";
                columns[i].buttonVisibility = "visible";
                if ($.type(columns[i].editor.editable) === "boolean" && !columns[i].editor.editable) {
                  columns[i].buttonVisibility = "hidden";
                }
                columns[i].imageButtons = {
                  width: 24,
                  height: 22,
                  images: [
                  {
                    name: "monthbutton",
                    up: dews._environments.scriptBase + "realgrid/assets/calendar_up.png",
                    hover: dews._environments.scriptBase + "realgrid/assets/calendar_hover.png",
                    down: dews._environments.scriptBase + "realgrid/assets/calendar_down.png"
                  }]

                };
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                if ($("#" + treeGrid._grid.name + "_month").length === 0) {
                  var monthpicker = $('<input class="dews-ui-monthpicker">');
                  monthpicker.prop("id", treeGrid._grid.name + "_month");
                  $("body").after(monthpicker);
                  columns[i].monthpicker = dews.ui.monthpicker(monthpicker);
                  $("body").after(columns[i].monthpicker.dateView.div);
                } else {
                  columns[i].monthpicker = dews.ui.monthpicker($("#" + treeGrid._grid.name + "_month"));
                }
                columns[i].monthpicker.wrapper.css({
                  display: "none",
                  height: opt2.display.rowHeight
                });
                break;
              case "YEAR":
                if (columns[i].editor.predefined === true) {
                  if ($.type(columns[i].editor.preFormat) === "undefined") {
                    columns[i].editor.preFormat = columns[i].editor.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                  if (preDefinedFormat) {
                    columns[i].editor.format = preDefinedFormat;
                  } else {
                    columns[i].editor.format = dews._environments.formats.yearFormat;
                  }
                }
                columns[i].editor.minDate = new Date(1900, 0, 1);
                columns[i].editor.maxDate = new Date(2100, 12, 0);
                columns[i].editor.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.yearFormat : columns[i].editor.format;
                columns[i].styles.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.yearFormat : columns[i].editor.format;
                columns[i].editor.mask = {
                  editMask: $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.yearFormat.replace(/[A-z\\s]/gi, "9") : columns[i].editor.format.replace(/[A-z\\s]/gi, "9"),
                  includedFormat: true
                };
                columns[i].button = "image";
                columns[i].buttonVisibility = "visible";
                if ($.type(columns[i].editor.editable) === "boolean" && !columns[i].editor.editable) {
                  columns[i].buttonVisibility = "hidden";
                }
                columns[i].imageButtons = {
                  width: 24,
                  height: 22,
                  images: [
                  {
                    name: "yearbutton",
                    up: dews._environments.scriptBase + "realgrid/assets/calendar_up.png",
                    hover: dews._environments.scriptBase + "realgrid/assets/calendar_hover.png",
                    down: dews._environments.scriptBase + "realgrid/assets/calendar_down.png"
                  }]

                };
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.yearValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.yearValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                if ($("#" + treeGrid._grid.name + "_year").length === 0) {
                  var yearpicker = $('<input class="dews-ui-yearpicker">');
                  yearpicker.prop("id", treeGrid._grid.name + "_year");
                  $("body").after(yearpicker);
                  columns[i].yearpicker = dews.ui.yearpicker(yearpicker);
                  $("body").after(columns[i].yearpicker.dateView.div);
                } else {
                  columns[i].yearpicker = dews.ui.yearpicker($("#" + treeGrid._grid.name + "_year"));
                }
                columns[i].yearpicker.wrapper.css({
                  display: "none",
                  height: opt2.display.rowHeight
                });
                break;}

          }
          if (columns[i].attributes) {
            if (columns[i].attributes["class"] === "required" || columns[i].attributes["class"] === "none") {
              columns[i].styles.background = columns[i].attributes["class"] === "required" ? opt2.gridStyle.body.requiredBackground : opt2.gridStyle.body.background;
              columns[i].readOnly = false;
              if (columns[i].editor && columns[i].editor.type && columns[i].editor.type.toUpperCase() === "DROPDOWN" && treeGrid.userOptions) {
                var currentColumn = findUserOptionsColumn4(treeGrid.userOptions.columns, columns[i].field);
                columns[i].editor.textReadOnly = currentColumn && currentColumn.editor && currentColumn.editor.type && currentColumn.editor.type.toUpperCase() === "COMBO" ? false : true;
              }
            } else if (columns[i].attributes["class"] === "readonly") {
              columns[i].styles.background = opt2.gridStyle.body.readonlyBackground;
              columns[i].readOnly = true;
              columns[i].editable = false;
            }
          }
          if (columns[i].footer) {
            opt2.footer.visible = true;
            if (opt2.multiFooterCnt > 1) {
              opt2.footer.count = opt2.multiFooterCnt;
              opt2.footer.minHeight = 32 * opt2.multiFooterCnt;
              var multiFooterArray = [];
              if ($.type(columns[i].footer) === "object") {
                multiFooterArray.push(columns[i].footer);
              } else if ($.type(columns[i].footer) === "array") {
                multiFooterArray = columns[i].footer;
              }
              var footerStyles = [];
              var footerExpression = [];
              var footerPreCurrency = [];
              var footerPreFormat = [];
              var footerText = [];
              for (var footerIdx = 0; footerIdx < multiFooterArray.length; footerIdx++) {
                footerStyles.push({});
                if (multiFooterArray[footerIdx].text) {
                  footerText[footerIdx] = multiFooterArray[footerIdx].text;
                }
                if (multiFooterArray[footerIdx].styles === void 0) {
                  var footerAlign = "center";
                  if (columns[i].styles.textAlignment) {
                    footerAlign = columns[i].styles.textAlignment;
                  }
                  footerStyles[footerIdx].textAlignment = footerAlign;
                }
                if ($.type(multiFooterArray[footerIdx].align) !== "undefined") {
                  switch (multiFooterArray[footerIdx].align.toLowerCase()) {
                    case "left":
                      footerStyles[footerIdx].textAlignment = "near";
                      break;
                    case "right":
                      footerStyles[footerIdx].textAlignment = "far";
                      break;
                    default:
                      footerStyles[footerIdx].textAlignment = "center";
                      break;}

                }
                if (multiFooterArray[footerIdx].type) {
                  if ($.type(opt2.fieldIndex) !== "undefined" && multiFooterArray[footerIdx].type.toLowerCase() !== "count") {
                    dataSource.field[opt2.fieldIndex].dataType = "number";
                    dataSource.schema.model.fields[opt2.fieldIndex].dataType = "number";
                  }
                  footerExpression[footerIdx] = multiFooterArray[footerIdx].type;
                  footerStyles[footerIdx].numberFormat = $.type(multiFooterArray[footerIdx].format) === "undefined" ? "#,##0.##" : multiFooterArray[footerIdx].format;
                  if (multiFooterArray[footerIdx].predefined === true) {
                    if ($.type(footerPreFormat[footerIdx]) === "undefined" || footerPreFormat[footerIdx].preFormat !== footerPreFormat[footerIdx].format) {
                      footerPreFormat[footerIdx] = multiFooterArray[footerIdx].format;
                      multiFooterArray[footerIdx].preFormat = multiFooterArray[footerIdx].format;
                    }
                    var preDefinedFormat = dews.getPreDefinedFormat(multiFooterArray[footerIdx]);
                    if ($.type(multiFooterArray[footerIdx].currency) !== "undefined") {
                      if ($.type(multiFooterArray[footerIdx].currency) === "string") {
                        footerPreCurrency[footerIdx] = multiFooterArray[footerIdx].currency;
                        multiFooterArray[footerIdx].preCurrency = multiFooterArray[footerIdx].currency;
                        preDefinedFormat = dews.getCurrencyFormat(multiFooterArray[footerIdx]);
                        if (preDefinedFormat) {
                          var round = $.type(preDefinedFormat.round) === "string" ? preDefinedFormat.round : "round";
                          if (round !== "round") {
                            if (preDefinedFormat.format.split(".").length === 2) {
                              if (round === "ceil") {
                                preDefinedFormat.format += ";;;c";
                              } else {
                                preDefinedFormat.format += ";;;f";
                              }
                            }
                          }
                        }
                      } else if ($.type(multiFooterArray[footerIdx].currency) === "function") {
                        footerPreCurrency[footerIdx] = "";
                        multiFooterArray[footerIdx].preCurrency = "";
                        treeGrid._grid._gv._footer._cell.__proto__.value = _displayFooterText2();
                      }
                    }
                    if ($.type(preDefinedFormat) === "object") {
                      preDefinedFormat = preDefinedFormat.format;
                    }
                    if (preDefinedFormat) {
                      footerStyles[footerIdx].numberFormat = preDefinedFormat;
                    } else {
                      footerStyles[footerIdx].numberFormat = "#,##0.##";
                    }
                  }
                }
                if (multiFooterArray[footerIdx].prefix) {
                  footerStyles[footerIdx].prefix = multiFooterArray[footerIdx].prefix;
                }
                if (multiFooterArray[footerIdx].suffix) {
                  footerStyles[footerIdx].suffix = multiFooterArray[footerIdx].suffix;
                }
              }
              columns[i].footer.styles = footerStyles;
              columns[i].footer.expression = footerExpression;
              columns[i].footer.preCurrency = footerPreCurrency;
              columns[i].footer.preFormat = footerPreFormat;
              columns[i].footer.text = footerText;
            } else {
              opt2.footer.count = 1;
              if (columns[i].footer.styles === void 0) {
                var footerAlign = "center";
                if (columns[i].styles.textAlignment) {
                  footerAlign = columns[i].styles.textAlignment;
                }
                columns[i].footer.styles = {
                  textAlignment: footerAlign
                };
              }
              if ($.type(columns[i].footer.align) !== "undefined") {
                switch (columns[i].footer.align.toLowerCase()) {
                  case "left":
                    columns[i].footer.styles.textAlignment = "near";
                    break;
                  case "right":
                    columns[i].footer.styles.textAlignment = "far";
                    break;
                  default:
                    columns[i].footer.styles.textAlignment = "center";
                    break;}

              }
              if (columns[i].footer.type) {
                if ($.type(opt2.fieldIndex) !== "undefined" && columns[i].footer.type.toLowerCase() !== "count") {
                  dataSource.field[opt2.fieldIndex].dataType = "number";
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "number";
                }
                columns[i].footer.expression = columns[i].footer.type;
                columns[i].footer.styles.numberFormat = $.type(columns[i].footer.format) === "undefined" ? "#,##0.##" : columns[i].footer.format;
                if (columns[i].footer.predefined === true) {
                  if ($.type(columns[i].footer.preFormat) === "undefined" || columns[i].footer.preFormat !== columns[i].footer.format) {
                    columns[i].footer.preFormat = columns[i].footer.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].footer);
                  if ($.type(columns[i].footer.currency) !== "undefined") {
                    if ($.type(columns[i].footer.currency) === "string") {
                      columns[i].footer.preCurrency = columns[i].footer.currency;
                      preDefinedFormat = dews.getCurrencyFormat(columns[i].footer);
                      if (preDefinedFormat) {
                        var round = $.type(preDefinedFormat.round) === "string" ? preDefinedFormat.round : "round";
                        if (round !== "round") {
                          if (preDefinedFormat.format.split(".").length === 2) {
                            if (round === "ceil") {
                              preDefinedFormat.format += ";;;c";
                            } else {
                              preDefinedFormat.format += ";;;f";
                            }
                          }
                        }
                      }
                    } else if ($.type(columns[i].footer.currency) === "function") {
                      columns[i].footer.preCurrency = "";
                      treeGrid._grid._gv._footer._cell.__proto__.value = _displayFooterText2();
                    }
                  }
                  if ($.type(preDefinedFormat) === "object") {
                    preDefinedFormat = preDefinedFormat.format;
                  }
                  if (preDefinedFormat) {
                    columns[i].footer.styles.numberFormat = preDefinedFormat;
                  } else {
                    columns[i].footer.styles.numberFormat = "#,##0.##";
                  }
                }
              }
              if (columns[i].footer.prefix) {
                columns[i].footer.styles.prefix = columns[i].footer.prefix;
              }
              if (columns[i].footer.suffix) {
                columns[i].footer.styles.suffix = columns[i].footer.suffix;
              }
            }
          }
          if (columns[i].suffix) {
            columns[i].styles.suffix = columns[i].suffix;
          }
          if (columns[i].prefix) {
            columns[i].styles.prefix = columns[i].prefix;
          }
          if ($.type(columns[i].style) === "function") {
            opt2.styleColumn.push(columns[i].field);
          }
          if ($.type(columns[i].grouping) === "boolean" && columns[i].grouping) {
            columns[i].type = "group";
            columns[i].orientation = "vertical";
            opt2.grouping = true;
            opt2.groupCol = columns[i].columns.length;
            if (opt2.groupCol > opt2.maxGroupCol) {
              opt2.maxGroupCol = opt2.groupCol;
            }
          }
          if ($.type(columns[i].multiColumnHeight) !== "undefined") {
            if ($.type(columns[i].multiColumnHeight) === "number") {
              columns[i].multiColumnHeight = {
                header: columns[i].multiColumnHeight,
                row: columns[i].multiColumnHeight
              };
            }
          } else {
            columns[i].multiColumnHeight = {};
          }
          if ($.type(columns[i].multiColumnHeight.header) === "number") {
            columns[i].header.fillHeight = columns[i].multiColumnHeight.header;
            columns[i].header.minHeight = columns[i].multiColumnHeight.header;
            columns[i].header.fixedHeight = columns[i].multiColumnHeight.header;
          } else if ($.type(columns[i].multiColumnHeight.header) === "undefined") {
            columns[i].header.fillHeight = opt2.header.minHeight;
            columns[i].header.minHeight = opt2.header.minHeight;
            columns[i].header.fixedHeight = opt2.header.minHeight;
          }
          if ($.type(columns[i].multiColumnHeight.row) === "number") {
            columns[i].height = columns[i].multiColumnHeight.row;
            columns[i].fillHeight = columns[i].multiColumnHeight.row;
            columns[i].minHeight = columns[i].multiColumnHeight.row;
            columns[i].fixedHeight = columns[i].multiColumnHeight.row;
          } else if ($.type(columns[i].multiColumnHeight.row) === "undefined") {
            columns[i].fillHeight = opt2.display.rowHeight;
            columns[i].minHeight = opt2.display.rowHeight;
            columns[i].fixedHeight = opt2.display.rowHeight;
          }
          if (columns[i].columns) {
            columns[i].type = "group";
            if (!columns[i].hideChildHeaders) {
              opt2.depth += 1;
            }
            if ($.type(columns[i].name) === "undefined") {
              if (columns[0].field === "__UUID") {
                columns[i].name = "_he@der_name_" + d + (i - 1);
              } else {
                columns[i].name = "_he@der_name_" + d + i;
              }
            }
            if ($.type(columns[i].visible) === "boolean") {
              columns[i].header.visible = columns[i].visible;
              delete columns[i].visible;
            }
            treeGrid.multiHeaderFlag = true;
            treeCustomizingColumn(columns[i].columns, opt2, treeGrid);
          } else {
            if (opt2.depth > opt2.maxDepth) {
              opt2.maxDepth = opt2.depth;
            }
            opt2.depth = 1;
          }
        }
      });
      opt2.columns = columns;
      opt2.dataSource.options = dataSource;
      treeGrid.dataSource = opt2.dataSource;
    }
    return opt2;
  }
  function findUserOptionsColumn4(columns, fieldName, userColumn) {
    if (!columns)
    return null;
    for (var index = 0; index < columns.length; index++) {
      if (userColumn === void 0) {
        if (columns[index].field === fieldName) {
          userColumn = columns[index];
        } else if (columns[index].columns) {
          userColumn = findUserOptionsColumn4(columns[index].columns, fieldName, userColumn);
        }
      }
    }
    return userColumn;
  }
  function _displayFooterText2() {
    return function () {
      var grid2 = $(this._index._column.grid()._container._containerDiv).closest(".dews-data-control").data("dews-control");
      if (grid2 === void 0 || grid2 === null) {
        return null;
      }
      var cols = grid2.columns;
      var col = grid2.columns[this._index._column._fieldName];
      var params = {
        grid: grid2,
        column: cols
      };
      if (col.footer && col.footer.currency && $.type(col.footer.currency) === "function") {
        col.footer.preCurrency = col.footer.currency.call(grid2, params);
        var env = dews.ui.page && dews.ui.page.env && dews.ui.page.env[col.footer.preFormat];
        var predefinedFormat = dews.getCurrencyFormat(col.footer);
        var formats = "#,###.##";
        var round = "round";
        if (env) {
          formats = env.format;
          round = dews.mathType[env.round];
        }
        if ($.type(predefinedFormat) === "object") {
          formats = predefinedFormat.format;
          round = $.type(predefinedFormat.round) === "string" ? predefinedFormat.round : round;
        } else if ($.type(predefinedFormat) === "string") {
          formats = predefinedFormat;
        }
        if (round !== "round") {
          if (formats.split(".").length === 2) {
            if (round === "ceil") {
              formats += ";;;c";
            } else {
              formats += ";;;f";
            }
          }
        }
        var column = grid2._grid.columnByField(this._index._column._fieldName);
        var numberFormat = grid2._grid.getColumnProperty(column, "footer").styles.numberFormat;
        if (numberFormat !== formats) {
          grid2._grid.setColumnProperty(column, "footer", {
            styles: {
              numberFormat: formats
            }
          });
        }
      }
      if (col.footer && col.footer.length > 1) {
        var fieldName = this._index._column._fieldName;
        var columnIndex = grid2.options.columns.findIndex(function (column2) {
          return column2.field === fieldName;
        });
        for (var footerIdx = 0; footerIdx < col.footer.length; footerIdx++) {
          if (col.footer[footerIdx].predefined && col.footer[footerIdx].format && col.footer[footerIdx].currency && $.type(col.footer[footerIdx].currency) === "function") {
            var params = {
              grid: grid2,
              column: cols
            };
            col.footer[footerIdx].preCurrency = col.footer[footerIdx].currency.call(grid2, params);
            var env = dews.ui.page && dews.ui.page.env && dews.ui.page.env[col.footer[footerIdx].preFormat];
            var predefinedFormat = dews.getCurrencyFormat(col.footer[footerIdx]);
            var formats = "#,###.##";
            var round = "round";
            if (env) {
              formats = env.format;
              round = dews.mathType[env.round];
            }
            if ($.type(predefinedFormat) === "object") {
              formats = predefinedFormat.format;
              round = $.type(predefinedFormat.round) === "string" ? predefinedFormat.round : round;
            } else if ($.type(predefinedFormat) === "string") {
              formats = predefinedFormat;
            }
            if (round !== "round") {
              if (formats.split(".").length === 2) {
                if (round === "ceil") {
                  formats += ";;;c";
                } else {
                  formats += ";;;f";
                }
              }
            }
            grid2.options.columns[columnIndex].footer.styles[footerIdx].numberFormat = formats;
          }
        }
        grid2._grid.setColumnProperty(grid2._grid.columnByField(this._index._column._fieldName), "footer", {
          styles: grid2.options.columns[columnIndex].footer.styles
        });
      }
      return this._value;
    };
  }

  // src/js/grid/dialog/GridDebugDialog.js
  var GridDebugDialog = /*#__PURE__*/function () {"use strict";




















    function GridDebugDialog(grid2) {_classCallCheck(this, GridDebugDialog);_defineProperty(this, "html", "\n            <div class=\"dews-dialog-contents-area\">\n                <div class=\"dews-ui-form-panel\" style=\"border-width: 0px\">\n                    <ul>\n                        <li>\n                            <label>GridID</label>\n                            <input type=\"text\" id=\"gridID\" class=\"dews-ui-textbox\" readonly=\"readonly\">\n                        </li>\n                        <li>\n                            <label>RowState</label>\n                            <input type=\"text\" id=\"gridRowState\" class=\"dews-ui-textbox\" readonly=\"readonly\">\n                        </li>\n                    </ul>\n                </div>\n                <div class=\"dews-ui-container-panel\" data-dews-fit-bottom=\"true\">\n                    <div class=\"dews-container-item\">\n                        <div id=\"grid\" class=\"dews-ui-grid\">\n                    </div>\n                </div>\n            </div> ");
      this.grid = grid2;
    }_createClass(GridDebugDialog, [{ key: "open", value:
      function open() {
        var self = this;
        var grid2 = this.grid;
        var dialog = dews.ui.dialog("dewsGridDebugDialog", {
          content: this.html,
          buttons: "close",
          title: "Grid Debug Dialog",
          size: "large",
          open: openHandler
        });
        dialog.setInitData(grid2);
        dialog.open();
        function openHandler() {
          dews.ready(function () {
            var self2 = this;
            var grid3 = dialog.getInitData();
            var fields = grid3.dataSource.options.field;
            var columns = grid3.columns;
            var type = grid3.gridType;
            var dataIdx = type === "GRID" ? grid3.getDataIndexFromItemIndex(grid3.select()) : grid3.select();
            var gridDataItem = grid3.dataSource.at(dataIdx);
            var data = [];
            if (fields) {
              fields.forEach(function (field) {
                var fieldName = field.field;
                if (!(fieldName.toUpperCase().indexOf("UID") !== -1)) {
                  var col = columns[fieldName];
                  var item = {
                    field: fieldName || "",
                    dataType: field.dataType === "text" ? "string" : field.dataType || "",
                    title: col ? col.title || "" : "",
                    value: gridDataItem[fieldName] || "",
                    isVisible: col ? typeof col.visible === "boolean" ? col.visible : true : false
                  };
                  data.push(item);
                }
              });
            }
            self2.gridID.text(grid3.$element.parent().attr("id"));
            self2.gridRowState.text(grid3.getRowState(grid3.select()));
            var dataSource = dews.ui.dataSource("gridDataSource", {
              grid: true,
              data: data,
              schema: {
                model: {
                  id: "field",
                  fields: [
                  { field: "title" },
                  { field: "field" },
                  { field: "value" },
                  { field: "dataType" },
                  { field: "isVisible", type: "boolean" }]

                }
              }
            });
            var debugGrid = dews.ui.grid(self2.$grid, {
              dataSource: dataSource,
              autoBind: true,
              checkable: false,
              columns: [
              {
                field: "title",
                title: "Title",
                align: "left",
                width: 150
              },
              {
                field: "field",
                title: "Field",
                align: "left",
                width: 200
              },
              {
                field: "value",
                title: "Value",
                align: "left",
                width: 150
              },
              {
                field: "dataType",
                title: "DataType",
                align: "left",
                width: 100
              }],

              dataBound: function dataBound(e) {
                var grid4 = e.grid;
                var index = [];
                var style = {
                  background: grid4.options.gridStyle.emphasizeColor1
                };
                var length = e.grid.dataItems().length;
                for (var i = 0; i < length; i += 1) {
                  if (!grid4.dataItem(i).isVisible) {
                    index.push(i);
                  }
                }
                grid4.setRowStyle(index, style);
              }
            });
          });
        }
      } }]);return GridDebugDialog;}();


  // src/js/grid/event/Event.js
  var Event = /*#__PURE__*/function () {"use strict";
    function Event(grid2) {_classCallCheck(this, Event);
      this.grid = grid2;
    }_createClass(Event, [{ key: "initialize", value:
      function initialize() {
        var self = this.grid;
        this._setCallBacks();
        self.$element.on("keyDown", this._keyDownHandler.bind(this));
      } }, { key: "_setCallBacks", value:
      function _setCallBacks() {
        var self = this.grid;
        self._grid.onSorting = function (grid2, fields) {
          var fieldName;
          if (fields.length > 0) {
            var selectFieldIndex = fields.length === 1 ? fields : fields.at(-1);
            fieldName = grid2._dataSource.getFieldName(selectFieldIndex);
          }
          self.onSortingData = _objectSpread(_objectSpread({},
          grid2.getCurrent()),
          fieldName && { fieldName: fieldName });

        };
        self._grid.onSortingChanged = function (grid2) {
          if (self.onSortingData) {
            var name = self.onSortingData.fieldName;
            grid2.setCurrent(_objectSpread({
              dataRow: self.onSortingData.dataRow },
            name && { fieldName: self.onSortingData.fieldName }));

            delete self.onSortingData;
          }
        };
      } }, { key: "_keyDownHandler", value:
      function _keyDownHandler(e) {
        var self = this.grid;
        if (self.options.context) {
          if (e.ctrl && e.shift && e.keyCode === 70) {
            openQuickFilter();
            return;
          }
        }
        if (self.options.context) {
          if (e.ctrl && e.keyCode === 70) {
            searchGrid();
          }
        }
        if (self.select() > -1) {
          if (e.alt && e.shift && e.keyCode === 68) {
            openDebugDialog();
          }
        }
        function openQuickFilter() {
          var quickFilter;
          self.options.contextMenu.some(function (item) {
            if (item.id === "quick_filter") {
              quickFilter = item;
              return true;
            }
          });
          if (quickFilter) {
            var enable = quickFilter.display.bind()();
            if (enable) {
              quickFilter.handler.bind()();
            }
          }
          e.stopPropagation();
          e.preventDefault();
        }
        function searchGrid() {
          var searchContextMenu, menuIndex;
          self.options.contextMenu.some(function (item, idx) {
            if (item.id === "search_text") {
              menuIndex = idx;
              return true;
            }
          });
          if (menuIndex !== void 0) {
            searchContextMenu = self.options.contextMenu[menuIndex];
            searchContextMenu.display.call(self);
            searchContextMenu.handler.call(self, { grid: self });
          }
          e.stopPropagation();
          e.preventDefault();
        }
        function openDebugDialog() {
          var gridDebugView = new GridDebugDialog(self);
          gridDebugView.open();
          e.preventDefault();
          e.stopPropagation();
        }
      } }]);return Event;}();


  // src/js/grid/dialog/ColumnDialog.js
  function ColumnDialog(grid2) {
    this.grid = grid2;
    this._init();
    this._bindEvent();
  }
  ColumnDialog.prototype._init = function () {
    var grid2 = this.grid;
    var dlgID;
    grid2._onegrid.saveColumns = grid2._onegrid.loadColumns.slice(0);
    dlgID = grid2.$element[0].id + "column_dialog";
    this.content = createElement(this);
    this.options = getOptions2(this);
    this.columnDialog = dews.ui.dialog(dlgID, this.options.dialogOptions);
  };
  ColumnDialog.prototype._bindEvent = function () {
    var dlgSelf = this;
    if (dlgSelf.grid._onegrid.editType !== "C") {
      dlgSelf.content.find(".dews-grid-column-item").on("mouseover", function (e) {
        if ($(this).find(".hover").length === 0) {
          $(this).addClass("hover");
        }
        e.stopPropagation();
      }).on("mouseout", function (e) {
        $(this).removeClass("hover");
        e.stopPropagation();
      });
      dlgSelf.content.find(".item-list.left").on("mousedown", function (e) {
        var $targetElement = $(this).closest(".dews-grid-column-item");
        var $dragElement = $targetElement.clone(),$parentUlElement = $targetElement.parent();
        var dragElementWidth, dragElementOffset;
        $targetElement.find("> .item-list-wrapper").css("visibility", "hidden");
        if ($targetElement.find("> .dews-grid-columns-list.sub").length > 0) {
          $targetElement.find("> .dews-grid-columns-list.sub").css("visibility", "hidden");
        }
        $targetElement.addClass("transparency");
        $dragElement.css("display", "none");
        $targetElement.parent().append($dragElement);
        $dragElement.addClass("dragging");
        dragElementWidth = $targetElement.css("width");
        $dragElement.css("position", "absolute");
        $dragElement.css("display", "block");
        $dragElement.css("width", dragElementWidth);
        $dragElement.css("z-index", 110);
        var targetElementOffset = $targetElement.offset();
        $dragElement.offset(targetElementOffset);
        dragElementOffset = targetElementOffset;
        $dragElement.startX = e.clientX - dragElementOffset.left;
        $dragElement.startY = e.clientY - dragElementOffset.top;
        if ($targetElement.parent().hasClass("sub") && $targetElement.parent().closest(".dews-grid-column-item").hasClass("hover")) {
          $targetElement.parent().closest(".dews-grid-column-item").removeClass("hover");
        }
        $targetElement.siblings(".dews-grid-column-item").not(".dragging").addClass("draggable");
        $targetElement.addClass("current");
        var $dropLine = $('<div class="drop-line"><span class="ico-drag-round"></span></div>');
        $dropLine.css("visibility", "hidden");
        $parentUlElement.append($dropLine);
        $dropLine.css("width", dragElementWidth);
        $(document.body).on("mousemove", $dragElement, dragMousemove).on("mouseup", $dragElement, dragMouseup);
        e.stopPropagation();
        e.preventDefault();
      });
    }
    var $buttonGroup = dlgSelf.content.eq(1);
    $buttonGroup.find("> .save-btn").on("click", function () {
      var liList = dlgSelf.columnDialog.$content.find("ul").not(".sub").find("> li");
      if (fixedVerification(liList)) {
        dews.confirm(dews.localize.get("\uC800\uC7A5\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?", "dews_\uC800\uC7A5\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")).yes(function () {
          var saveColumns = dlgSelf.grid._onegrid.saveColumns,saveObj;
          saveColumns = setSaveColumns(saveColumns, liList);
          dlgSelf.grid._onegrid.saveColumns = saveColumns;
          saveObj = setSaveData(dlgSelf.grid, saveColumns);
          saveObj.useColumns = setUseData(dlgSelf, saveColumns);
          dlgSelf.grid._onegrid.saveData = saveObj.columns;
          if (!saveObj.fixed) {
            saveObj.fixed = { colCount: 0, rightColCount: 0 };
          }
          dlgSelf.grid._onegrid.fixed = saveObj.fixed;
          dlgSelf.grid._onegrid._event = "save";
          var parameter = {
            moduleID: dews.ui.page.menu.module,
            menuID: dews.ui.page.menu.id,
            type: dlgSelf.grid._onegrid._onegridType,
            id: dlgSelf.grid._onegrid._gridID,
            content: saveObj
          };
          dews.ui.page._onegridSave(parameter);
          dlgSelf.columnDialog.ok(dlgSelf.grid._onegrid);
        }).no(function () {
        });
      } else {
        dews.alert(
        dews.localize.get(
        "\uACE0\uC815 \uC5EC\uBD80\uAC00 \uC815\uC0C1\uC801\uC73C\uB85C \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.",
        "dews_\uACE0\uC815 \uC5EC\uBD80\uAC00 \uC815\uC0C1\uC801\uC73C\uB85C \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4."),

        "warning").
        done(function () {
        });
      }
    });
    $buttonGroup.find("> .reset-btn").on("click", function () {
      dews.confirm(dews.localize.get("\uCD08\uAE30\uD654\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?", "dews_\uCD08\uAE30\uD654\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")).yes(function () {
        var onegridType = dlgSelf.grid._onegrid._onegridType;
        dlgSelf.grid._onegrid.saveData = null;
        dlgSelf.grid._onegrid.fixed = { colCount: 0, rightColCount: 0 };
        var parameter = {
          moduleID: dews.ui.page.menu.module,
          menuID: dews.ui.page.menu.id,
          type: onegridType,
          id: dlgSelf.grid._onegrid._gridID
        };
        dews.ui.page._onegridReset(parameter).done(function (oneGridData) {
          dlgSelf.grid._onegrid.loadData = null;
          if (oneGridData.items && oneGridData.items.length > 0) {
            var oneGridItems = oneGridData.items;
            var gridItem = oneGridItems.filter(function (oneGridItems2) {
              return oneGridItems2.type === onegridType && oneGridItems2.id === dlgSelf.grid._onegrid._gridID;
            });
            if (gridItem.length > 0 && gridItem[0].content) {
              dlgSelf.grid._onegrid.saveData = gridItem[0].content.columns;
              if (oneGridData.authority === 3) {
                dlgSelf.grid._onegrid.loadData = gridItem[0].content.useColumns;
              } else {
                dlgSelf.grid._onegrid.loadData = gridItem[0].content.columns;
              }
              $.extend(true, dlgSelf.grid._onegrid.fixed, gridItem[0].content.fixed);
            }
          } else {
            $.extend(true, dlgSelf.grid._onegrid.fixed, dlgSelf.grid.options.fixed);
          }
          dlgSelf.columnDialog.ok(dlgSelf.grid._onegrid);
        });
      }).no(function () {
      });
    });
    $buttonGroup.find("> .cancel-btn").on("click", function () {
      dlgSelf.columnDialog.cancel();
    });
    function dragMousemove(e) {
      var $dragElement = e.data;
      var $targetElement = $(".transparency");
      var $parentUlElement = $targetElement.closest("ul.dews-grid-columns-list");
      var $wrapper = $(".dews-grid-columns-wrapper");
      var $firstUlElement = $wrapper.find("> .dews-grid-columns-list");
      var parentUlElementOffset = $parentUlElement.offset();
      var wrapperElementOffset = $wrapper.offset();
      var scrollTop, $dropLine;
      $dragElement.css("top", e.clientY - $dragElement.startY - parentUlElementOffset.top + "px");
      $dragElement.css("left", e.clientX - $dragElement.startX - parentUlElementOffset.left + "px");
      scrollTop = $wrapper.scrollTop();
      $dropLine = $parentUlElement.find("> .drop-line");
      if (e.clientY + $dragElement.height() - $dragElement.startY > wrapperElementOffset.top + 490) {
        $dropLine.css("visibility", "hidden");
        if ($firstUlElement.height() + 20 > $wrapper.height() + scrollTop) {
          $wrapper.scrollTop(scrollTop + 7);
        }
      } else if (e.clientY - $dragElement.startY < wrapperElementOffset.top) {
        $dropLine.css("visibility", "hidden");
        if (scrollTop !== 0) {
          $wrapper.scrollTop(scrollTop - 7);
        }
      }
      var currentElement,currentElementLength,$currentElement = $parentUlElement.find("> .current");
      var currentElementOffset, currentElementHeight;
      if (navigator.appName === "Netscape" && navigator.userAgent.toLowerCase().indexOf("trident") !== -1 || navigator.userAgent.toLowerCase().indexOf("msie") !== -1 || navigator.userAgent.toLowerCase().indexOf("edge") !== -1) {
        var nodeList = document.msElementsFromPoint(e.clientX, e.clientY);
        currentElement = Array.prototype.slice.call(nodeList);
      } else {
        currentElement = document.elementsFromPoint(e.clientX, e.clientY);
      }
      currentElementLength = currentElement.length;
      for (var i = 0; i < currentElementLength; i++) {
        var $el = $(currentElement[i]);
        if ($el.hasClass("draggable")) {
          if (!$el.hasClass("current")) {
            $currentElement.removeClass("current");
            $el.addClass("current");
            $currentElement = $el;
            break;
          }
        }
      }
      currentElementOffset = $currentElement.offset();
      currentElementHeight = $currentElement.height();
      if (e.clientY <= parentUlElementOffset.top + $parentUlElement.height() + 10 && e.clientY >= parentUlElementOffset.top) {
        if ($dragElement.hasClass("noDrop")) {
          $dragElement.removeClass("noDrop");
        }
        if (!$currentElement.hasClass("transparency")) {
          if (currentElementOffset.top + currentElementHeight / 2 >= e.clientY) {
            if (!$currentElement.prev().hasClass("transparency")) {
              $dropLine.offset({
                top: currentElementOffset.top - 5,
                left: currentElementOffset.left
              });
              if ($dropLine.css("visibility") === "hidden") {
                $dropLine.css("visibility", "visible");
              }
            } else {
              if ($dropLine.css("visibility") === "visible") {
                $dropLine.css("visibility", "hidden");
              }
            }
          } else if (currentElementOffset.top + currentElementHeight / 2 < e.clientY) {
            if (!$currentElement.next().hasClass("transparency")) {
              $dropLine.offset({
                top: currentElementOffset.top + currentElementHeight + 5,
                left: currentElementOffset.left
              });
              if ($dropLine.css("visibility") === "hidden") {
                $dropLine.css("visibility", "visible");
              }
            } else {
              if ($dropLine.css("visibility") === "visible") {
                $dropLine.css("visibility", "hidden");
              }
            }
          }
        }
      } else {
        if (!$dragElement.hasClass("noDrop")) {
          $dragElement.addClass("noDrop");
        }
        if ($dropLine.css("visibility") === "visible") {
          $dropLine.css("visibility", "hidden");
        }
      }
      e.stopPropagation();
      e.preventDefault();
    }
    function dragMouseup(e) {
      var $targetElement = $(this).find(".dews-grid-column-item.transparency");
      var $parentUlElement = $targetElement.parent(),parentUlElementOffset = $parentUlElement.offset(),$currentElement = $parentUlElement.find(".current");
      var $dropLine = $(this).find(".drop-line");
      var currentElementOffset, currentElementHeight, $prevElement, $nextElement;
      if (!$currentElement.hasClass("transparency") && $currentElement.length > 0) {
        $prevElement = $currentElement.prev();
        $nextElement = $currentElement.next();
        currentElementOffset = $currentElement.offset();
        currentElementHeight = $currentElement.height();
        if (e.clientY <= parentUlElementOffset.top + $parentUlElement.height() + 10 && e.clientY >= parentUlElementOffset.top) {
          if (currentElementOffset.top + currentElementHeight / 2 >= e.clientY) {
            if (!$prevElement.hasClass("transparency")) {
              $currentElement.before($targetElement);
            }
          } else if (currentElementOffset.top + currentElementHeight / 2 < e.clientY) {
            if (!$nextElement.hasClass("transparency")) {
              $currentElement.after($targetElement);
            }
          }
        }
        var $nextUlElement = $targetElement.find("> .dews-grid-columns-list.sub");
        var $targetElementCheckBox = $targetElement.find("> .item-list-wrapper .column-item-fix .dews-ui-checkbox");
        var $targetElementVisibleBox = $targetElement.find(
        "> .item-list-wrapper .column-item-visible .dews-ui-checkbox");

        if ($dropLine.css("visibility") === "visible") {
          if ($targetElementCheckBox[0].checked) {
            if ($targetElement.prev().length > 0 && !$targetElement.next().hasClass("dragging") && !$targetElement.prev().find("> .item-list-wrapper .column-item-fix .dews-ui-checkbox")[0].checked && !$targetElement.next().find("> .item-list-wrapper .column-item-fix .dews-ui-checkbox")[0].checked) {
              $targetElementCheckBox[0].checked = false;
              $targetElement.data("column-fixed-type", null);
              if ($nextUlElement.length > 0) {
                changeChildrenChecked($nextUlElement, "fix", false);
              }
            }
          } else {
            if ($targetElement.prev().length === 0) {
              if ($targetElement.next().find("> .item-list-wrapper .column-item-fix .dews-ui-checkbox")[0].checked) {
                if ($targetElementVisibleBox[0].checked === true) {
                  $targetElementCheckBox[0].checked = true;
                  $targetElement.data(
                  "column-fixed-type",
                  $targetElement.next().data("column-fixed-type"));

                  if ($nextUlElement.length > 0) {
                    changeChildrenChecked($nextUlElement, "fix", true);
                  }
                }
              }
            } else if ($targetElement.next().hasClass("dragging")) {
              if ($targetElement.prev().find("> .item-list-wrapper .column-item-fix .dews-ui-checkbox")[0].checked) {
                if ($targetElementVisibleBox[0].checked === true) {
                  $targetElementCheckBox[0].checked = true;
                  $targetElement.data(
                  "column-fixed-type",
                  $targetElement.prev().data("column-fixed-type"));

                  if ($nextUlElement.length > 0) {
                    changeChildrenChecked($nextUlElement, "fix", true);
                  }
                }
              }
            } else {
              if ($targetElement.prev().find("> .item-list-wrapper .column-item-fix .dews-ui-checkbox")[0].checked && $targetElement.next().find("> .item-list-wrapper .column-item-fix .dews-ui-checkbox")[0].checked) {
                if ($targetElementVisibleBox[0].checked === true) {
                  $targetElementCheckBox[0].checked = true;
                  $targetElement.data(
                  "column-fixed-type",
                  $targetElement.next().data("column-fixed-type"));

                  if ($nextUlElement.length > 0) {
                    changeChildrenChecked($nextUlElement, "fix", true);
                  }
                }
              }
            }
          }
        }
      }
      $currentElement.removeClass("current");
      e.data.removeClass("dragging");
      e.data.remove();
      $targetElement.removeClass("transparency");
      $targetElement.find("> .item-list-wrapper").css("visibility", "");
      if ($targetElement.find("> .dews-grid-columns-list.sub").length > 0) {
        $targetElement.find("> .dews-grid-columns-list.sub").css("visibility", "visible");
      }
      $targetElement.siblings(".dews-grid-column-item").removeClass("draggable");
      $dropLine.remove();
      $(this).off("mousemove", dragMousemove).off("mouseup", dragMouseup);
      e.stopPropagation();
    }
  };
  function getOptions2(columnDialog) {
    var opt2 = {};
    opt2.dialogOptions = {
      title: dews.localize.get("\uCEEC\uB7FC \uC5D0\uB514\uD130", "dews_\uCEEC\uB7FC \uC5D0\uB514\uD130"),
      size: "large",
      height: 570,
      width: 800,
      content: columnDialog.content
    };
    opt2.dialogOptions.open = columnDialogOpen;
    opt2.dialogOptions.ok = function (e) {
      var baseColumns = Array.prototype.slice.call(columnDialog.grid._onegrid.baseColumns);
      var setInitColumns;
      if (e.saveData) {
        setInitColumns = dews.ui.gridUtil.setInitColumns(baseColumns, e.saveData);
      } else {
        setInitColumns = columnDialog.grid._onegrid.baseColumns;
      }
      columnDialog.grid.setColumns(setInitColumns);
      if (e.saveData) {
        columnDialog.grid._onegrid.loadData = e.saveData;
        columnDialog.grid._onegrid.loadColumns = dews.ui.gridUtil.setDisplayIndexColumns(
        columnDialog.grid,
        baseColumns,
        e.saveData);

      }
      columnDialog.grid._grid.setFixedOptions(columnDialog.grid._onegrid.fixed);
      if (columnDialog.grid.options.autoBind) {
        columnDialog.grid.dataSource.read();
      }
    };
    return opt2;
  }
  function createElement(columnDialog) {
    var grid2 = columnDialog.grid;
    var $content, $wrapper, $buttonGroup, $resetBtn, $saveBtn, $cancelBtn;
    $buttonGroup = $('<div class="dews-dialog-button-group bottom"></div>');
    $resetBtn = $(
    '<button id="reset-btn" class="dews-ui-button reset-btn">' + dews.localize.get("\uCD08\uAE30\uD654", "dews_\uCD08\uAE30\uD654") + "</button>");

    $saveBtn = $(
    '<button id="save-btn" class="dews-ui-button save-btn">' + dews.localize.get("\uC800\uC7A5", "dews_\uC800\uC7A5") + "</button>");

    $cancelBtn = $(
    '<button id="cancel-btn" class="dews-ui-button cancel-btn">' + dews.localize.get("\uCDE8\uC18C", "dews_\uCDE8\uC18C") + "</button>");

    $buttonGroup.append($resetBtn).append($saveBtn).append($cancelBtn);
    $content = $('<div class="dews-dialog-contents-area"></div>');
    $wrapper = $('<div class="dews-grid-columns-wrapper"></div>');
    $wrapper.append(createListHtml(grid2, grid2._onegrid.loadColumns, false));
    $content.append($wrapper);
    $content = $content.add($buttonGroup);
    return $content;
  }
  function createListHtml(grid2, columns, sub) {
    var $ulTag, $liTag;
    $ulTag = $('<ul class="dews-grid-columns-list"></ul>');
    if (sub) {
      $ulTag.addClass("sub");
    }
    for (var i = 0; i < columns.length; i++) {
      if (columns[i].name === "__UUID") {
        continue;
      }
      $liTag = createLiHtml(grid2, columns[i]);
      $liTag.attr("data-column-field", columns[i].name);
      if (columns[i].columns) {
        var $createListTag = createListHtml(grid2, columns[i].columns, true);
        $liTag.append($createListTag);
        if ($createListTag.find(".required").length > 0) {
          $liTag.find("> .item-list-wrapper .column-item-visible .dews-ui-checkbox").attr("disabled", "disabled");
        }
      } else {
        $liTag.find("> .item-list-wrapper").addClass("only");
      }
      if (sub) {
        var $inputFixed = $liTag.find(".column-item-fix > .dews-ui-checkbox");
        $inputFixed.prop("disabled", true);
      } else {
        if (columns[i]._fixed) {
          if (columns[i]._fixed.type === "fixed") {
            $liTag.find(".column-item-fix > .dews-ui-checkbox").attr("checked", true);
            $liTag.data("column-fixed-type", "fixed");
          }
        }
      }
      $ulTag.append($liTag);
    }
    return $ulTag;
  }
  function createLiHtml(grid2, column) {
    var $liTag, $itemListWrapper, $itemListRight, $itemListLeft, $icoRowmove, $columnItemTitle, $columnItemWidth, $columnItemVisible, $columnItemFix, $labelTitle, $labelWidth, $labelVisible, $labelFixed, $labelPx, $inputWidth, $inputVisible, $inputFixed;
    $liTag = $('<li class="dews-grid-column-item"></li>');
    $itemListWrapper = $('<span class="item-list-wrapper"></span>');
    $itemListRight = $('<span class="item-list right"></span>');
    $itemListLeft = $('<span class="item-list left"></span>');
    $icoRowmove = $('<span class="ico-rowmove"></span>');
    $columnItemTitle = $('<span class="column-item-list column-item-title"></span>');
    $labelTitle = $('<label class="column-item-label title">' + column.header.text + "</label>");
    $columnItemWidth = $('<span class="column-item-list column-item-width"></span>');
    $labelWidth = $('<label class="column-item-label width">' + dews.localize.get("\uB108\uBE44", "dews_\uB108\uBE44") + "</label>");
    $inputWidth = $(
    '<input type="text" class="dews-ui-numerictextbox" value="' + column.width + '" style="width: 40px">');

    $labelPx = $('<label class="column-item-label px">px</label>');
    $columnItemVisible = $('<span class="column-item-list column-item-visible"></span>');
    $labelVisible = $(
    '<label class="column-item-label visible">' + dews.localize.get("\uCD9C\uB825\uC5EC\uBD80", "dews_\uCD9C\uB825\uC5EC\uBD80") + "</label>");

    $inputVisible = $('<input type="checkbox" class="dews-ui-checkbox small-toggle">');
    $columnItemFix = $('<span class="column-item-list column-item-fix"></span>');
    $labelFixed = $(
    '<label class="column-item-label fixed">' + dews.localize.get("\uACE0\uC815\uC5EC\uBD80", "dews_\uACE0\uC815\uC5EC\uBD80") + "</label>");

    $inputFixed = $('<input type="checkbox" class="dews-ui-checkbox small-toggle">');
    if (grid2.columns[column.name] && grid2.columns[column.name].attributes && grid2.columns[column.name].attributes["class"] === "required") {
      $inputVisible.attr("disabled", "disabled");
      $liTag.addClass("required");
    }
    if (column.visible !== false) {
      $inputVisible.attr("checked", true);
    } else {
      $inputFixed.attr("disabled", "disabled");
      $liTag.data("column-fixed-type", "disabled");
    }
    if (grid2._onegrid.editType === "C") {
      $inputVisible.attr("disabled", "disabled");
      $inputFixed.attr("disabled", "disabled");
    }
    $liTag.append(
    $itemListWrapper.append(
    $itemListRight.append($columnItemWidth.append($labelWidth).append($inputWidth).append($labelPx)).append($columnItemVisible.append($labelVisible).append($inputVisible)).append($columnItemFix.append($labelFixed).append($inputFixed))).
    append($itemListLeft.append($icoRowmove).append($columnItemTitle.append($labelTitle))));

    return $liTag;
  }
  function columnDialogOpen() {
    dews.ready(function () {
      var dlgSelf = this;
      var updateColumnData = {};
      dlgSelf.$content.find(".column-item-width .dews-ui-numerictextbox").on("change", function (e) {
        var target = e.target;
        var columnField = $(target).closest(".dews-grid-column-item").data("column-field");
        updateColumnData[columnField] = updateColumnData[columnField] ? updateColumnData[columnField] : {};
        updateColumnData[columnField].width = $(e.target).val();
      });
      dlgSelf.$content.find(".column-item-visible .dews-ui-checkbox").on("change", function (e) {
        var target = e.target;
        var $targetLiElement = $(target).closest(".dews-grid-column-item");
        var $targetItemElement = $(target).closest(".item-list-wrapper");
        var $nextUlElement = $targetItemElement.next("ul");
        var columnField = $targetLiElement.data("column-field");
        var $targetElementFixedCheckBox = $targetItemElement.find(".column-item-fix .dews-ui-checkbox");
        updateColumnData[columnField] = updateColumnData[columnField] ? updateColumnData[columnField] : {};
        updateColumnData[columnField].visible = this.checked;
        if ($nextUlElement.length > 0) {
          changeChildrenChecked($nextUlElement, "visible", target.checked);
        }
        changeParentChecked($targetLiElement, target.checked);
        if ($targetLiElement.parent().not(".sub").length > 0) {
          if (this.checked === false) {
            $targetElementFixedCheckBox.attr("disabled", true);
            $targetElementFixedCheckBox.attr("checked", false);
            $targetLiElement.data("column-fixed-type", "disabled");
          } else {
            $targetElementFixedCheckBox.attr("disabled", false);
            $targetLiElement.data("column-fixed-type", "null");
          }
        }
      });
      dlgSelf.$content.find(".column-item-fix .dews-ui-checkbox").on("change", function (e) {
        var target = e.target;
        var $targetLiElement = $(target).closest(".dews-grid-column-item");
        var $targetItemElement = $(target).closest(".item-list-wrapper");
        var $nextUlElement = $targetItemElement.next("ul");
        var fixedType = $targetLiElement.data("column-fixed-type");
        if (target.checked) {
          $targetLiElement.data("column-fixed-type", "fixed");
        } else {
          $targetLiElement.data("column-fixed-type", null);
        }
        if ($nextUlElement.length > 0) {
          changeChildrenChecked($nextUlElement, "fix", target.checked);
        }
      });
    });
  }
  function changeParentChecked($element, isChecked) {
    var $parentElement = $element.parent();
    var $parentLiElement = $parentElement.closest(".dews-grid-column-item");
    if ($parentElement.hasClass("sub")) {
      if (isChecked && $parentLiElement.find("> .item-list-wrapper .column-item-visible .dews-ui-checkbox")[0].checked !== isChecked) {
        $parentLiElement.find("> .item-list-wrapper .column-item-visible .dews-ui-checkbox")[0].checked = isChecked;
        if ($parentLiElement.parent().hasClass("sub")) {
          changeParentChecked($parentLiElement, isChecked);
        }
      } else {
        var visibleCheckList = $element.siblings("li").find("> .item-list-wrapper .column-item-visible .dews-ui-checkbox");
        for (var i = 0; i < visibleCheckList.length; i++) {
          if (visibleCheckList[i].checked !== isChecked) {
            break;
          }
          if (i === visibleCheckList.length - 1) {
            $parentLiElement.find("> .item-list-wrapper .column-item-visible .dews-ui-checkbox")[0].checked = isChecked;
            if ($parentLiElement.parent().hasClass("sub")) {
              changeParentChecked($parentLiElement, isChecked);
            }
          }
        }
      }
    }
  }
  function changeChildrenChecked($element, type, isChecked) {
    var changeElements = $element.find(".column-item-" + type + " .dews-ui-checkbox");
    for (var i = 0; i < changeElements.length; i++) {
      changeElements[i].checked = isChecked;
    }
  }
  function setUseData(grid2, columns) {
    var useData = [],data,fixed = { colCount: 0, rightColCount: 0 };
    for (var i = 0; i < columns.length; i++) {
      data = {
        field: columns[i].name,
        width: columns[i].width,
        isVisible: columns[i].visible
      };
      if (columns[i].columns) {
        data.columns = setUseData(grid2, columns[i].columns);
      }
      useData.push(data);
    }
    return useData;
  }
  function setSaveData(grid2, columns, sub) {
    var saveData = [],useData = [],data,fixed = { colCount: 0, rightColCount: 0 };
    for (var i = 0; i < columns.length; i++) {
      data = {
        field: columns[i].name,
        width: columns[i].width,
        isVisible: columns[i].visible
      };
      if (columns[i].columns) {
        data.columns = setSaveData(grid2, columns[i].columns, "sub");
      }
      if (sub !== "sub" && columns[i]._fixed) {
        if (columns[i]._fixed.type === "left") {
          fixed.colCount++;
        } else if (columns[i]._fixed.type === "right") {
          fixed.rightColCount++;
        }
      }
      saveData.push(data);
    }
    if (sub === "sub") {
      return saveData;
    } else {
      var saveObj = { columns: saveData };
      if (fixed.colCount > 0 || fixed.rightColCount > 0) {
        saveObj.fixed = fixed;
      }
      return saveObj;
    }
  }
  function setSaveColumns(columns, liElementList) {
    for (var i = 0; i < liElementList.length; i++) {
      var $liElement = liElementList.eq(i);
      var index, column;
      columns.some(function (c, idx) {
        if (c.name === $liElement.data("columnField")) {
          index = idx;
        }
      });
      if (typeof index === "number") {
        column = columns[index];
        if ($liElement.find("> ul.sub").length > 0) {
          setSaveColumns(column.columns, $liElement.find("> ul.sub >li"));
        }
        var $widthElement = $liElement.find("> .item-list-wrapper .column-item-width .dews-ui-numerictextbox");
        var $visibleElement = $liElement.find("> .item-list-wrapper .column-item-visible .dews-ui-checkbox");
        column.width = parseInt($widthElement.val());
        column.displayWidth = column.width;
        column.visible = $visibleElement[0].checked;
        if ($liElement.data("column-fixed-type")) {
          column._fixed = column._fixed ? column._fixed : {};
          column._fixed.type = $liElement.data("column-fixed-align");
        } else {
          if (column._fixed) {
            delete column._fixed;
          }
        }
        var s = columns.splice(index, 1);
        columns.splice(i, 0, s[0]);
      }
    }
    return columns;
  }
  function fixedVerification(liList) {
    var enableFixedLiList = [];
    for (var i = 0; i < liList.length; i++) {
      if (liList.eq(i).data("column-fixed-type") !== "disabled") {
        liList.eq(i).data("column-fixed-align", null);
        enableFixedLiList.push(liList.eq(i));
      }
    }
    var rightFixedFlag = true,leftFixedFlag = true;
    for (var j = enableFixedLiList.length - 1; j > -1; j--) {
      if (enableFixedLiList[j].data("column-fixed-type") === "fixed") {
        if (rightFixedFlag) {
          enableFixedLiList[j].data("column-fixed-align", "right");
        } else {
          if (enableFixedLiList[0].data("column-fixed-type") === "fixed") {
            break;
          } else {
            return false;
          }
        }
      } else {
        rightFixedFlag = false;
      }
    }
    for (var k = 0; k < enableFixedLiList.length; k++) {
      if (enableFixedLiList[k].data("column-fixed-type") === "fixed") {
        if (leftFixedFlag) {
          if (enableFixedLiList[k].data("column-fixed-align") === "right") {
            break;
          } else {
            enableFixedLiList[k].data("column-fixed-align", "left");
          }
        } else {
          if (enableFixedLiList[k].data("column-fixed-align") === "right") {
            break;
          } else {
            return false;
          }
        }
      } else {
        leftFixedFlag = false;
      }
    }
    return true;
  }

  // src/js/grid/event/gridEvent.js
  var GridEvent = /*#__PURE__*/function (_Event) {"use strict";_inherits(GridEvent, _Event);var _super5 = _createSuper(GridEvent);
    function GridEvent(grid2) {var _this;_classCallCheck(this, GridEvent);
      _this = _super5.call(this, grid2);
      _this.grid = grid2;return _this;
    }_createClass(GridEvent, [{ key: "initialize", value:
      function initialize() {
        _get(_getPrototypeOf(GridEvent.prototype), "initialize", this).call(this);
        this._bindEvent();
      } }, { key: "_bindEvent", value:
      function _bindEvent() {
        var self = this.grid;
        var observer = new MutationObserver(function (mutations) {
          mutations.forEach(function (mutation) {
            if (mutation.attributeName === "style") {
              if (/display:\s?none/i.test(mutation.oldValue)) {
                if ($(mutation.target).is(":visible")) {
                  self._grid.resetSize();
                }
              }
            } else if (mutation.attributeName === "class") {
              if ($(mutation.target).is(":visible")) {
                self._grid.resetSize();
              }
            }
          });
        });
        self.$element.parentsUntil("body").each(function (idx, item) {
          observer.observe(item, {
            attributes: true,
            attributeOldValue: true,
            attributeFilter: ["style", "class"]
          });
        });
        if (dews.app && dews.app.menuSectionResized) {
          dews.app.menuSectionResized.on(function () {
            self._grid.resetSize();
          });
        }
        self._grid.onColumnHeaderClicked = function (grid2, column, rightClicked) {
          var parameter = {
            grid: self,
            cell: {
              field: column.fieldName
            }
          };
          var headerClicked = new $.Event("headerClicked", parameter);
          self.$element.trigger(headerClicked);
        };
        self._grid.onImageButtonClicked = function (grid2, itemIndex, column, buttonIndex, name) {
          var parameter = {
            grid: self,
            row: {
              index: itemIndex,
              data: self.dataItem(itemIndex)
            },
            cell: {
              field: column.fieldName,
              data: self.getCellValue(itemIndex, column.fieldName)
            }
          };
          dews.ui.gridUtil.onImageButtonClicked(self, itemIndex, column, parameter);
        };
        self.options._gridCallback = function (data, column, index) {
          dews.ui.gridUtil._gridCallback(self, data, column, index);
        };
        self._grid.onLinkableCellClicked = function (grid2, index, url) {
          var linkUrl = self.dataItem(index.itemIndex)[self.columns[index.column].formats.urlField],parameter = {
              grid: self,
              row: {
                index: index.itemIndex,
                data: self.dataItem(index.itemIndex)
              },
              cell: {
                field: index.column,
                data: self.getCellValue(index.itemIndex, index.column)
              }
            };
          dews.ui.gridUtil.onLinkableCellClicked(self, index, linkUrl, parameter);
        };
        self._grid.onShowEditor = function (id, index) {
          var parameter = {
            grid: self,
            row: {
              index: index.dataRow === -1 ? index.itemIndex : index.dataRow
            },
            cell: {
              field: index.fieldName
            }
          };
          window.addEventListener("scroll", windowScroll);
          return dews.ui.gridUtil.onShowEditor(self, id, index, parameter);
        };
        self._grid.onHideEditor = function (grid2, index) {
          if (self.options.commit) {
            dews.ui.gridUtil.onHideEditor(self, grid2, index);
            window.removeEventListener("scroll", windowScroll);
          }
          setTimeout(function () {var _self$columns$fieldNa, _self$columns$fieldNa2, _self$columns$fieldNa3;
            var fieldName = index.fieldName;
            if (((_self$columns$fieldNa = self.columns[fieldName]) === null || _self$columns$fieldNa === void 0 ? void 0 : (_self$columns$fieldNa2 = _self$columns$fieldNa.editor) === null || _self$columns$fieldNa2 === void 0 ? void 0 : (_self$columns$fieldNa3 = _self$columns$fieldNa2.type) === null || _self$columns$fieldNa3 === void 0 ? void 0 : _self$columns$fieldNa3.toLowerCase()) === "codepicker") {
              $(window).trigger("enableMainArea");
            }
          }, 300);
          self.options.commit = false;
        };
        self._grid.onColumnCheckedChanged = function (grid2, column, check) {
          var params = {
              grid: self,
              cell: {
                field: column.fieldName
              },
              checked: check
            },i = 0;
          if (column.editorOptions && column.editorOptions.type.toLowerCase() === "check") {
            var dataItems = self.sortDataItems(),rowCount = dataItems.length,userColumn = findUserOptionsColumn5(self.userOptions.columns, column.fieldName),checkValue = check;
            if (check && column.editorOptions && column.editorOptions.trueValue) {
              checkValue = column.editorOptions.trueValue;
            } else if (!check && column.editorOptions && column.editorOptions.falseValue) {
              checkValue = column.editorOptions.falseValue;
            }
            self.options.dataSource.dataProvider.beginUpdate();
            try {
              for (i = 0; i < rowCount; i++) {
                var editParams = {
                  grid: self,
                  row: {
                    index: i,
                    data: dataItems[i]
                  },
                  cell: {
                    field: column.fieldName
                  }
                };
                var cellEditable = true;
                if (self.options.rowEditable !== void 0) {
                  cellEditable = self.options.rowEditable.call(self, editParams);
                }
                if (userColumn !== void 0 && userColumn !== null) {
                  if (cellEditable && userColumn.editable === false) {
                    cellEditable = false;
                  }
                  if (cellEditable && userColumn.editor !== void 0 && typeof userColumn.editor.editable === "function") {
                    cellEditable = userColumn.editor.editable.call(self, editParams);
                  }
                  if (cellEditable && userColumn.editor !== void 0 && typeof userColumn.editor.editable === "boolean" && userColumn.editor.editable === false) {
                    cellEditable = false;
                  }
                }
                if (cellEditable) {
                  self._grid.setValue(i, column.fieldName, checkValue);
                }
              }
            } finally {
              self.options.dataSource.dataProvider.endUpdate();
            }
          }
          var event = $.Event("columnHeaderCheck", params);
          self.$element.trigger(event);
        };
        self._grid.onCellEdited = function (grid2, itemIndex, dataRow, field) {
          var fields = self.options.dataSource.dataProvider.getFieldName(field);
          var column = dews.ui.gridUtil.findColumn(self.options.columns, fields);
          if (column && column.editor && column.editor.type.toLowerCase() === "time") {
            if (grid2.getEditingItem() && grid2.getEditingItem().values[column.fieldName]) {
              if (!column.displayRegExp.test(grid2.getEditingItem().values[column.fieldName])) {
                self.setCellValue(dataRow, column.fieldName, "");
              }
            }
          }
          var useCodesearch = self._useCodesearch;
          self.options.commit = true;
          grid2.commit(true);
          self.editable = false;
          if (column && column.editor && column.editor.type.toLowerCase() === "dropdown" && $.type(column.editor.dataSource) === "function") {
            var col = self._grid.columnByField(column.fieldName),e = {
                grid: self,
                row: {
                  data: self.dataItem(dataRow),
                  index: dataRow
                }
              },datasource = column.editor.dataSource.call(self, e);
            col.values = [];
            col.labels = [];
            if (typeof col.editor === "string" && col.editor === "dropDown") {
              col.editor = {
                type: "dropDown",
                values: [],
                labels: []
              };
            }
            if (datasource && datasource.transport && datasource.transport.data && datasource.transport.data.length > 0) {
              var index = {
                  itemIndex: itemIndex,
                  dataRow: dataRow,
                  fieldIndex: field,
                  column: column.field,
                  fieldName: column.field
                },editResult = {
                  text: "",
                  value: self.getCellValue(dataRow, column.field)
                };
              for (var l = 0; l < datasource.transport.data.length; l += 1) {
                col.values.push(datasource.transport.data[l][column.editor.dataValueField]);
                col.labels.push(datasource.transport.data[l][column.editor.dataTextField]);
                if (column.editor.dataSelectable && datasource.transport.data[l][column.editor.dataSelectable.field] !== column.editor.dataSelectable.falseValue) {
                  col.editor.values.push(datasource.transport.data[l][column.editor.dataValueField]);
                  col.editor.labels.push(datasource.transport.data[l][column.editor.dataTextField]);
                }
                if (datasource.transport.data[l][column.editor.dataValueField] === editResult.value) {
                  editResult.text = datasource.transport.data[l][column.editor.dataTextField];
                }
              }
              if ($.type(column.editor.textField) === "undefined") {
                col.labelField = column.editor.dataTextField;
              } else {
                col.labelField = column.editor.textField;
              }
              col.lookupDisplay = true;
              self._grid.setColumn(col);
              self._grid.onGetEditValue.call(self, self._grid, index, editResult);
            }
          }
          var event,parameter,subSave = true;
          if ($.type(arguments[4]) === "boolean") {
            subSave = arguments[4];
          }
          parameter = {
            grid: self,
            row: {
              index: itemIndex,
              data: self.dataItem(itemIndex)
            },
            codesearch: $.type(self._useCodesearch) === "undefined" ? false : useCodesearch,
            cell: {
              field: $.type(column) === "undefined" ? fields : column.field
            }
          };
          if (subSave) {
            event = new $.Event("save", parameter);
            self.$element.trigger(event);
          }
          delete self._useCodesearch;
        };
        self._grid.onSelectionEnded = function (grid2) {
          if (dews.ui.page.option === void 0 && dews.ui.page.useGridNote === "Y") {
            var selectDataIndex = grid2.getSelection().startRow;
            noteMain(grid2, selectDataIndex);
          }
        };
        self._grid.onCurrentRowChanged = function (grid2, oldIndex, newIndex) {
          if (self.options.dataBounding || oldIndex === newIndex || $.type(self.options.add) === "boolean" || newIndex === -1 && self.options.master || $.type(self.options.remove) === "boolean") {
            self._grid.onCurrentChanging.call(self, self._grid, self._grid.getCurrent(), self._grid.getCurrent());
            self.options.rowChange = true;
            self._grid.onCurrentChanged.call(self, self._grid, self._grid.getCurrent());
          }
        };
        self._grid.onCurrentChanging = function (grid2, oldIndex, newIndex) {
          if (typeof self.options.insert === "undefined") {var _columns$editor, _columns$editor$type, _columns$editor2, _columns$editor2$mask, _columns$editor3, _filterArr2;
            var getDataItem = function getDataItem(oldIndex2) {
              var dataProvider = grid2._dataSource;
              if (dataProvider.getRowCount() === 0) {
                return;
              }
              if (grid2.isGrouped() && oldIndex2.dataRow === 1) {
                return;
              }
              return self.dataItem(oldIndex2.itemIndex);
            };
            var dataRow = newIndex.dataRow;
            if (self._grid.getItemCount() === 0 && oldIndex.itemIndex >= 0) {
              return;
            }
            self.options.rowChange = false;
            if (newIndex.dataRow === -1 ? oldIndex.itemIndex !== newIndex.itemIndex : oldIndex.dataRow !== newIndex.dataRow) {
              self.options.rowChange = true;
            }
            self.options.isDataBound = self.options.dataBounding === true;
            self.options.previousData = getDataItem(oldIndex);
            self.options.previous = oldIndex;
            if (oldIndex.dataRow !== -1 && self.focused) {
              self.setFocus();
            }
            if (newIndex.dataRow === -1) {
              if (self._grid.getItemState(newIndex.itemIndex) === "appending") {
                self._grid.commit(true);
                dataRow = newIndex.itemIndex;
              }
            }
            var columns = self.columns[newIndex.fieldName];
            var filterArr;
            if (grid2.getColumnProperty(newIndex.column, "editor") && newIndex.fieldIndex !== -1 && self.dataItem(newIndex.itemIndex)) {
              if (columns !== null && columns !== void 0 && columns.editor && self.options.dataSource) {var _filterArr;
                var editor;
                var rowEditable;
                var visible;
                var parameter = {
                  grid: self,
                  row: {
                    index: dataRow,
                    data: self._grid.getValues(newIndex.itemIndex)
                  },
                  cell: {
                    field: newIndex.fieldName
                  }
                };
                filterArr = newIndex !== null && newIndex !== void 0 && newIndex.fieldName ? self._grid.getActiveColumnFilters(newIndex.fieldName, true) : null;
                if (grid2.getSortedFields() !== null || ((_filterArr = filterArr) === null || _filterArr === void 0 ? void 0 : _filterArr.length) > 0) {
                  parameter.row.index = newIndex.itemIndex;
                  parameter.row.data = self._grid.getValues(newIndex.itemIndex);
                }
                if (typeof columns.editable === "boolean" && !columns.editable && columns.editor.type.toLowerCase() !== "check") {
                  editor = columns.editable;
                } else {
                  editor = typeof columns.editor.editable === "function" ? columns.editor.editable.call(self, parameter) : columns.editor.editable;
                }
                columns.editor.editResult = editor;
                rowEditable = typeof self.options.rowEditable === "function" ? self.options.rowEditable.call(self, parameter) : self.options.rowEditable;
                self.rowEditable = rowEditable;
                if (self.options.editable) {
                  if (typeof rowEditable === "boolean") {
                    columns.editor.flag = rowEditable !== true;
                  }
                  if (columns.editable && typeof columns.editor.editable === "function" && editor) {
                    grid2.setColumnProperty(newIndex.fieldName, "editable", editor);
                  }
                }
                switch (columns.editor.type.toLowerCase()) {
                  case "codepicker":
                  case "zipcodepicker":
                  case "time":
                  case "month":
                  case "year":
                    visible = "visible";
                    if (!editor) {
                      visible = "hidden";
                      if (columns.cellDynamic) {
                        var betweenStr = function betweenStr(str, char1, char2) {
                          return str.split(char1).join("").split(char2).join("");
                        };
                        columns.cellDynamic.forEach(function (dynamic) {
                          var criteria = betweenStr(dynamic.criteria, "(", ")");
                          var field = betweenStr(
                          criteria.split("=")[0].match(/\'.*\'/gi)[0],
                          "'",
                          "'");

                          var value = betweenStr(criteria.split("=")[1].trim(), "'", "'");
                          var data = self.dataItem(dataRow);
                          if (data[field] === value) {
                            if (dynamic.styles.editable) {
                              visible = "visible";
                            }
                          }
                        });
                      }
                    }
                    if (rowEditable === false) {
                      visible = "hidden";
                    }
                    if (!self.options.edit.editable) {
                      visible = "hidden";
                    }
                    columns.buttonVisibility = visible;
                    self._grid.setColumnProperty(columns.name, "buttonVisibility", visible);
                    break;}

                if (columns.editor.type.toLowerCase() === "check") {
                  var options = self._grid.getColumnProperty(columns.name, "renderer");
                  if (typeof rowEditable === "boolean" && rowEditable === false) {
                    self._grid.setColumnProperty(
                    columns.name,
                    "renderer",
                    $.extend(true, options, {
                      editable: rowEditable
                    }));

                  } else {
                    self._grid.setColumnProperty(
                    columns.name,
                    "renderer",
                    $.extend(true, options, { editable: editor }));

                  }
                }
                if (columns.editable && editor) {
                  if (typeof self.options.rowEditable === "undefined" || rowEditable || rowEditable !== false) {
                    self._grid.setColumnProperty(columns.name, "editable", true);
                  } else {
                    self._grid.setColumnProperty(columns.name, "editable", false);
                  }
                } else {
                  self._grid.setColumnProperty(columns.name, "editable", false);
                }
              }
            }
            if ((columns === null || columns === void 0 ? void 0 : (_columns$editor = columns.editor) === null || _columns$editor === void 0 ? void 0 : (_columns$editor$type = _columns$editor.type) === null || _columns$editor$type === void 0 ? void 0 : _columns$editor$type.toLowerCase()) === "dropdown" && typeof columns.editor.dataSource === "function" && self.dataItem(newIndex.itemIndex)) {
              var col = self._grid.columnByField(columns.fieldName);
              var e = {
                grid: self,
                row: {
                  index: newIndex.dataRow,
                  data: self.dataItem(newIndex.dataRow)
                }
              };
              var datasource = columns.editor.dataSource.call(self, e);
              col.values = [];
              col.labels = [];
              if (typeof col.editor === "string" && col.editor === "dropDown") {
                col.editor = {
                  type: "dropDown",
                  values: [],
                  labels: []
                };
              }
              datasource.fetch(function () {
                $.each(datasource.data(), function (idx, value) {
                  col.values.push(value[columns.editor.dataValueField]);
                  col.labels.push(value[columns.editor.dataTextField]);
                  if (columns.editor.dataSelectable && value[columns.editor.dataSelectable.field] !== columns.editor.dataSelectable.falseValue) {
                    col.editor.values.push(value[columns.editor.dataValueField]);
                    col.editor.labels.push(value[columns.editor.dataTextField]);
                  }
                });
                col.labelField = typeof columns.editor.textField === "undefined" ? columns.editor.dataTextField : columns.editor.textField;
                col.lookupDisplay = true;
                self._grid.setColumn(col);
              });
            }
            if (columns !== null && columns !== void 0 && (_columns$editor2 = columns.editor) !== null && _columns$editor2 !== void 0 && (_columns$editor2$mask = _columns$editor2.mask) !== null && _columns$editor2$mask !== void 0 && _columns$editor2$mask.allowEmpty && typeof columns.editor.format === "function" && self.dataItem(newIndex.itemIndex)) {
              var maskParams = {
                grid: self,
                row: {
                  index: newIndex.dataRow,
                  data: self.dataItem(newIndex.dataRow)
                },
                cell: {
                  field: newIndex.column,
                  data: self.getCellValue(newIndex.dataRow, newIndex.column)
                }
              };
              var maskEditFormat = columns.editor.format.call(self, maskParams);
              if (typeof maskEditFormat === "string" && maskEditFormat !== "") {
                self._grid.setColumnProperty(self._grid.columnByField(columns.field), "editorOptions", {
                  mask: { editMask: maskEditFormat }
                });
              } else {
                self._grid.setColumnProperty(self._grid.columnByField(columns.field), "editorOptions", {
                  mask: null
                });
              }
            }
            if ((columns === null || columns === void 0 ? void 0 : (_columns$editor3 = columns.editor) === null || _columns$editor3 === void 0 ? void 0 : _columns$editor3.type) === "number" && typeof columns.editor.currency === "function" && self.dataItem(newIndex.itemIndex)) {var _dews$ui$page3;
              var params = {
                grid: self,
                row: {
                  index: newIndex.itemIndex,
                  data: self.dataItem(newIndex.itemIndex)
                },
                cell: {
                  field: newIndex.column,
                  data: self.getCellValue(newIndex.itemIndex, newIndex.column)
                }
              };
              columns.editor.preCurrency = columns.editor.currency.call(self, params);
              var env = ((_dews$ui$page3 = dews.ui.page) === null || _dews$ui$page3 === void 0 ? void 0 : _dews$ui$page3.env) && dews.ui.page.env[columns.editor.preFormat];
              var currencyFormat = dews.getCurrencyFormat(columns.editor);
              var formats = "#,###.##";
              if (env) {
                formats = env.format;
              }
              if (_typeof(currencyFormat) === "object") {
                formats = currencyFormat.format;
              }
              var columnInfo = self._grid.columnByField(columns.field);
              var editorOptions = self._grid.getColumnProperty(columnInfo, "editorOptions", true);
              editorOptions.editFormat = formats;
              self._grid.setColumnProperty(columnInfo, "editorOptions", editorOptions);
            }
            var column = self.options.columns;
            if (self.options.dataBounding) {
              var dataBoundParameter = {
                grid: self,
                row: {
                  data: self.options.dataSource.data()
                },
                column: column
              };
              if (self.options.dataSource.options.paging) {
                dataBoundParameter.paging = true;
                dataBoundParameter.page = {};
                dataBoundParameter.page.startIndex = self.options.dataSource.options.pagingStart;
                if (self.options.dataSource.options.data) {
                  dataBoundParameter.page.endIndex = self.options.dataSource.options.pagingStart + self.options.dataSource.options.data.length - 1;
                } else {
                  dataBoundParameter.page.endIndex = self.options.dataSource.options.pagingStart - 1;
                }
                dataBoundParameter.page.totalCount = self.options.dataSource.options.totalCount;
              }
              var dataBoundEvent = new $.Event("dataBound", dataBoundParameter);
              self.$element.trigger(dataBoundEvent);
              delete self.options.dataBounding;
              delete self._innerOptions.dataBounding;
              self._setCriteria();
              if (self.options.note) {
                self._gridNote.boundingDraw(grid2, self, dataBoundParameter);
              }
              for (var key in self.columns) {
                var _col = self.columns[key];
                if (_col.codeOption) {
                  _col.codeOption.value = {};
                }
              }
            }
            if (typeof self.options.previousData === "undefined") {
              self.options.previousData = "";
            }
            if (typeof self.options.previous === "undefined") {
              self.options.previous = newIndex;
            }
            var nIndex = self._grid.getGroupFields() && self._grid.getGroupFields().length !== 0 ? newIndex.itemIndex : newIndex.dataRow;
            var changingParameter = {
              grid: self,
              isDataBound: self.options.isDataBound,
              row: {
                next: {
                  index: newIndex.dataRow,
                  data: self.dataItem(newIndex.itemIndex)
                },
                isChange: self.options.rowChange,
                index: oldIndex.dataRow !== -1 ? oldIndex.dataRow : oldIndex.itemIndex,
                data: self.dataItem(oldIndex.dataRow)
              },
              cell: {
                next: {
                  field: newIndex.fieldName,
                  data: void 0
                },
                field: oldIndex.fieldName
              }
            };
            if (self._grid.getGroupFields() === null || self._grid.getGroupFields().length === 0) {
              changingParameter.cell.data = self._grid.getValue(oldIndex.dataRow, oldIndex.fieldName);
            }
            if (_typeof(self.dataItem(newIndex.itemIndex)) === "object") {
              try {
                if (self._grid.isGroupItem(newIndex.itemIndex) === true) {
                  changingParameter.cell.next.data = void 0;
                } else {
                  changingParameter.cell.next.data = self._grid.getValue(
                  newIndex.itemIndex,
                  newIndex.fieldName);

                }
              } catch (e) {
                changingParameter.cell.next.data = void 0;
              }
            }
            filterArr = newIndex !== null && newIndex !== void 0 && newIndex.fieldName ? self._grid.getActiveColumnFilters(newIndex.fieldName, true) : null;
            if (grid2.getSortedFields() !== null || ((_filterArr2 = filterArr) === null || _filterArr2 === void 0 ? void 0 : _filterArr2.length) > 0) {
              changingParameter.row.next.index = newIndex.itemIndex;
              changingParameter.row.next.data = self.dataItem(newIndex.itemIndex);
              changingParameter.row.index = oldIndex.itemIndex;
              changingParameter.row.data = getDataItem(oldIndex);
              if (oldIndex.itemIndex !== -1 && oldIndex.dataRow === -1) {
                changingParameter.cell.data = void 0;
              } else if (self._grid._dataSource.getRowCount() === 0) {
                changingParameter.cell.data = void 0;
              } else {
                changingParameter.cell.data = self._grid.getValue(oldIndex.itemIndex, oldIndex.fieldName);
              }
            }
            var _event = new $.Event("changing", changingParameter);
            self.$element.trigger(_event);
            if (_event.isDefaultPrevented()) {
              return false;
            }
          }
        };
        self._grid.onCurrentChanged = function (grid2, newIndex) {
          if ($.type(self.options.insert) === "undefined") {
            var index = newIndex.dataRow;
            var filterArr;
            if (self._grid.getItemCount() === 0 && newIndex.itemIndex >= 0) {
              return;
            }
            if (newIndex.itemIndex !== -1 && self.options.add && !self.options.filterClearing) {
              if (self.options.dataSource) {
                var addParameter, addEvent;
                addParameter = {
                  grid: self,
                  row: {
                    index: newIndex.itemIndex,
                    data: self.dataItem(self.select())
                  }
                };
                self._grid.commit(true);
                addEvent = new $.Event("rowAdd", addParameter);
                self.$element.trigger(addEvent);
              }
              delete self.options.add;
            }
            var parameter = {
              grid: self,
              isDataBound: self.options.isDataBound,
              row: {
                index: newIndex.itemIndex,
                data: self.dataItem(newIndex.itemIndex),
                isChange: self.options.rowChange,
                previous: {
                  index: self.options.previous.dataRow !== -1 ? self.options.previous.dataRow : self.options.previous.itemIndex,
                  data: self.dataItem(self.options.previous.dataRow)
                }
              },
              cell: {
                field: newIndex.fieldName,
                data: void 0,
                previous: {
                  field: self.options.previous.fieldName
                }
              }
            };
            if ($.type(self._grid.getGroupFields()) === "null" || self._grid.getGroupFields().length === 0) {
              parameter.cell.previous.data = self._grid.getValue(
              self.options.previous.dataRow,
              self.options.previous.fieldName);

            }
            if ($.type(self.dataItem(newIndex.itemIndex)) === "object") {
              try {
                if (self._grid.isGroupItem(newIndex.itemIndex) === true) {
                  parameter.cell.data = void 0;
                } else {
                  parameter.cell.data = self._grid.getValue(newIndex.itemIndex, newIndex.fieldName);
                }
              } catch (e) {
                parameter.cell.data = void 0;
              }
            }
            if (newIndex && newIndex.fieldName) {
              filterArr = self._grid.getActiveColumnFilters(newIndex.fieldName, true);
            } else {
              filterArr = null;
            }
            if ($.type(grid2.getSortedFields()) !== "null" || filterArr && filterArr.length > 0) {
              parameter.row.index = newIndex.itemIndex;
              parameter.row.data = self.dataItem(newIndex.itemIndex);
              parameter.row.previous.index = self.options.previous.itemIndex;
              parameter.row.previous.data = self.dataItem(self.options.previous.itemIndex);
              if (self.options.previous.itemIndex !== -1 && self.options.previous.dataRow === -1) {
                parameter.cell.previous.data = self._grid.getValue(
                self.options.previous.dataRow,
                self.options.previous.fieldName);

              } else {
                parameter.cell.previous.data = self._grid.getValue(
                self.options.previous.itemIndex,
                self.options.previous.fieldName);

              }
            }
            var event = new $.Event("change", parameter);
            self.$element.trigger(event);
            delete self.options.isDataBound;
            if (self._grid.getCurrent().dataRow === -1 && $.type(self._grid.getGroupFields()) === "null") {
              if (self._grid.getItemState(newIndex.itemIndex) === "appending") {
                self._grid.commit(true);
                index = self._grid.getCurrent().dataRow;
              } else {
                self._grid.removeCellStyles(["selection"]);
                return;
              }
            }
            if (self._grid.getSelectOptions().style !== "none") {
              var ids = ["selection"];
              self._grid.removeCellStyles(ids);
              var background = self.options.gridStyle.selection.focusBackgroundColor;
              if ($.type(self.columns[newIndex.column]) !== "undefined" && $.type(self.columns[newIndex.column].attributes) !== "undefined") {
                if (self.columns[newIndex.column].attributes["class"] === "required") {
                  background = self.options.gridStyle.body.requiredFocusBackground;
                } else if (self.columns[newIndex.column].attributes["class"] === "readonly") {
                  background = self.options.gridStyle.body.readonlyFocusBackground;
                }
              }
              if (self._grid.getCellStyle(index, newIndex.fieldIndex) === "editable") {
                self._grid.addCellStyle(
                "selection",
                {
                  editable: false,
                  background: background
                },
                true);

                self._grid.setCellStyle(index, newIndex.fieldIndex, "selection");
              } else {
                self._grid.addCellStyle(
                "selection",
                {
                  background: background
                },
                true);

                self._grid.setCellStyle(index, newIndex.fieldIndex, "selection");
              }
            } else {
              self._grid.removeCellStyles(["selection"]);
            }
            if (dews.ui.page && dews.ui.page.hasUserGuide) {
              if ($.isFunction(dews.ui.page.focusGuideItem) && newIndex.column) {
                dews.ui.page.focusGuideItem("#" + newIndex.column);
              }
            }
            var column = self.columns[newIndex.fieldName];
            if (column && column.editor) {
              if (column.editor.type.toLowerCase() === "dropdown" && column.editor.editResult && column.editor.autoOpen === true) {
                self.editCell();
              }
            }
          } else {
            delete self.options.insert;
          }
          delete self.options.remove;
        };
        self._grid.onValidateColumn = function (grid2, column, inserting, value) {
          var event,parameter = {
              grid: self,
              cell: {
                field: column.fieldName,
                data: value
              },
              row: {
                index: self._grid.getCurrent().itemIndex
              }
            };
          if (column.fieldName === grid2.getCurrent().fieldName) {
            event = new $.Event("validationCheck", parameter);
            self.$element.trigger(event);
          }
        };
        self._grid.onContextMenuPopup = function (grid2, x, y, elementName) {
          var contextPosition = self.optionAdaptor._styleCreator.theme === "posco" ? "HeaderCell" : "DataCell";
          if (elementName === contextPosition && self.options.dataSource) {
            var currentCell = grid2.mouseToIndex(x, y),parameter = {
                grid: self,
                row: {
                  index: currentCell.itemIndex,
                  data: self.dataItem(currentCell.itemIndex)
                },
                cell: {
                  field: currentCell.fieldName,
                  data: grid2.getValue(currentCell.itemIndex, currentCell.fieldName)
                }
              };
            dews.ui.gridUtil.onContextMenuPopup(self, currentCell, parameter);
          } else {
            return false;
          }
        };
        self._grid.onContextMenuItemClicked = function (grid2, label, index) {
          if (self.options.dataSource) {
            var parameter = {
              grid: self,
              row: {
                index: index.itemIndex,
                data: self.options.dataSource.at(self._grid.getValues(index.itemIndex).__rowId)
              },
              cell: {
                field: index.fieldName,
                data: grid2.getValue(index.itemIndex, index.fieldName)
              }
            };
            dews.ui.gridUtil.onContextMenuItemClicked(self, index, label, parameter);
          }
        };
        self._grid.onItemChecked = function (grid2, itemIndex, checked) {
          var event;
          var parameter = {
            grid: self,
            row: {
              index: itemIndex,
              data: self.dataItem(itemIndex)
            },
            cell: {
              isClicked: checked,
              header: {
                isClicked: false
              }
            }
          };
          event = new $.Event("selected", parameter);
          self.$element.trigger(event);
        };
        self._grid.onItemsChecked = function (grid2, items, checked) {
          var event;
          var parameter;
          parameter = {
            grid: self,
            row: {
              index: items,
              data: self.dataItems(items)
            },
            cell: {
              isClicked: checked,
              header: {
                isClicked: false
              }
            }
          };
          if (checked || self.options.shiftCheck) {
            event = new $.Event("selected", parameter);
            self.$element.trigger(event);
          }
        };
        self._grid.onItemAllChecked = function (grid2, checked) {
          var checkedIndex = self.getCheckedIndex();
          var event;
          var parameter = {
            grid: self,
            row: {
              index: checkedIndex,
              data: self.dataItems()
            },
            cell: {
              isClicked: checked,
              header: {
                isClicked: true
              }
            }
          };
          event = new $.Event("selected", parameter);
          self.$element.trigger(event);
        };
        self._grid.onGetEditValue = function (grid2, index, editResult) {
          dews.ui.gridUtil.onGetEditValue(self, index, editResult);
        };
        self._grid.onDataCellClicked = function (grid2, index) {
          var parameter = {
            grid: self,
            row: {
              index: index.itemIndex,
              data: self.dataItem(index.itemIndex)
            },
            cell: {
              field: index.fieldName,
              data: self.getCellValue(index.itemIndex, index.fieldName)
            }
          };
          var event = new $.Event("clicked", parameter);
          self.$element.trigger(event);
        };
        self._grid.onDataCellDblClicked = function (grid2, index) {
          var dblParameter = {
            grid: self,
            row: {
              index: index.itemIndex,
              data: self.dataItem(index.itemIndex)
            },
            cell: {
              field: index.fieldName,
              data: self.getCellValue(index.itemIndex, index.fieldName)
            }
          };
          var dblEvent = new $.Event("dblClicked", dblParameter);
          self.$element.trigger(dblEvent);
        };
        self._grid.onKeyDown = function (grid2, key, ctrl, shift, alt) {
          var currentColumn = self._grid.getCurrent().column;
          var currentIndex = self._grid.getCurrent().dataRow;
          if (key === 13 && self.options.requiredCheck && self.columns[currentColumn].attributes && self.columns[currentColumn].attributes["class"] === "required" && !self.getCellValue(currentIndex, currentColumn)) {
            return false;
          }
          if (key === 13 && self.columns[currentColumn].editor.type.toLowerCase() === "codepicker" && self.columns[currentColumn].codeOption.codesearch && $.type(self._grid.getEditValue()) === "undefined") {
            return false;
          }
          var parameter = {
              grid: self,
              keyCode: key,
              row: {
                index: self._grid.getCurrent().itemIndex
              },
              cell: {
                field: self._grid.getCurrent().column
              },
              ctrl: ctrl,
              shift: shift,
              alt: alt
            },event = $.Event("keyDown", parameter);
          self.$element.trigger(event);
          if (event.isDefaultPrevented()) {
            return false;
          }
          if (self._grid.getCheckBar().visible && self._grid.isCheckable(self._grid.getCurrent().itemIndex) && key === 32) {
            if (self._grid.isCheckedRow(self._grid.getCurrent().dataRow)) {
              self._grid.checkRow(self._grid.getCurrent().dataRow, false, false);
            } else {
              self._grid.checkRow(self._grid.getCurrent().dataRow, true, false);
            }
            return false;
          }
          var current = self._grid.getCurrent(),rowIndex = current.itemIndex,rowData = self.dataItem(rowIndex),editParams = {
              grid: self,
              row: {
                index: rowIndex,
                data: rowData
              },
              cell: {
                field: ""
              }
            };
          if ($.type(self._grid.getEditValue()) === "undefined" && $.type(self.options.editSkip) !== "undefined" && self.options.editSkip) {
            var disPlayColumn = self.options.displayColumns,index = 0,i = 0,column;
            $.each(self.options.displayColumns, function (idx, column2) {
              if (column2.field === current.column) {
                index = idx;
              }
            });
            if (key === 13 || !shift && key === 9) {
              for (var j = rowIndex; j < self.dataItems().length; j += 1) {
                editParams.row.index = j;
                editParams.row.data = self.dataItem(j);
                for (i = index + 1; i < disPlayColumn.length; i += 1) {
                  editParams.cell.field = disPlayColumn[i].field;
                  column = self.columns[disPlayColumn[i].field];
                  var condition;
                  if (column.editable) {
                    condition = $.type(self.options.rowEditable) !== "undefined" ? !column.editor.flag ? !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable")) || !($.type(self.options.rowEditable) === "function" ? self.options.rowEditable.call(self, editParams) : self.options.rowEditable) : !self.options.rowEditable.call(self, editParams) : !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable"));
                  } else {
                    condition = true;
                  }
                  if (!condition) {
                    if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                      self._grid.setCurrent({
                        itemIndex: j,
                        columns: column.fieldName,
                        dataRow: j,
                        fieldIndex: i,
                        fieldName: column.fieldName
                      });
                      return false;
                    }
                  } else if (i === disPlayColumn.length - 1 && j === self.dataItems().length - 1) {
                    if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                      self.commitCell();
                      return false;
                    }
                  }
                }
                index = -1;
              }
            } else if (key === 39 && index !== disPlayColumn.length - 1) {
              for (i = index + 1; i < disPlayColumn.length; i += 1) {
                editParams.cell.field = disPlayColumn[i].field;
                column = self.columns[disPlayColumn[i].field];
                var condition;
                if (column.editable) {
                  condition = $.type(self.options.rowEditable) !== "undefined" ? !column.editor.flag ? !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable")) || !($.type(self.options.rowEditable) === "function" ? self.options.rowEditable.call(self, editParams) : self.options.rowEditable) : !self.options.rowEditable.call(self, editParams) : !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable"));
                } else {
                  condition = true;
                }
                if (!condition) {
                  if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                    self._grid.setCurrent({
                      itemIndex: self._grid.getCurrent().itemIndex,
                      columns: column.fieldName,
                      dataRow: self._grid.getCurrent().dataRow,
                      fieldIndex: i,
                      fieldName: column.fieldName
                    });
                    return false;
                  } else if (i === disPlayColumn.length - 1) {
                    if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                      return false;
                    }
                  }
                } else if (i === disPlayColumn.length - 1) {
                  return false;
                }
              }
            } else if (key === 37 && index !== 0) {
              for (i = index - 1; i >= 0; i -= 1) {
                editParams.cell.field = disPlayColumn[i].field;
                column = self.columns[disPlayColumn[i].field];
                var condition;
                if (column.editable) {
                  condition = $.type(self.options.rowEditable) !== "undefined" ? !column.editor.flag ? !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable")) || !($.type(self.options.rowEditable) === "function" ? self.options.rowEditable.call(self, editParams) : self.options.rowEditable) : !self.options.rowEditable.call(self, editParams) : !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable"));
                } else {
                  condition = true;
                }
                if (!condition) {
                  if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                    self._grid.setCurrent({
                      itemIndex: self._grid.getCurrent().itemIndex,
                      columns: column.fieldName,
                      dataRow: self._grid.getCurrent().dataRow,
                      fieldIndex: i,
                      fieldName: column.fieldName
                    });
                    return false;
                  } else if (i === 0) {
                    if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                      return false;
                    }
                  }
                } else if (i === 0) {
                  return false;
                }
              }
            }
          }
          if (key === 27) {
            if (dews.ui.dialogPage && $.type(self._grid.getEditValue()) === "undefined") {
              dews.ui.dialogPage.dialog._close(false);
            }
          }
          if (shift && key === 9) {
            if (self.options.editSkip) {
              for (var row = rowIndex; row >= 0; row -= 1) {
                editParams.row.index = row;
                editParams.row.data = self.dataItem(row);
                for (i = index - 1; i >= 0; i -= 1) {
                  editParams.cell.field = disPlayColumn[i].field;
                  column = self.columns[disPlayColumn[i].field];
                  var condition = $.type(self.options.rowEditable) !== "undefined" ? !column.editor.flag ? !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable")) || !($.type(self.options.rowEditable) === "function" ? self.options.rowEditable.call(self, editParams) : self.options.rowEditable) : !self.options.rowEditable.call(self, editParams) : !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable"));
                  if (!condition) {
                    if (column.editor && $.type(column.editor.editable) === "function" && column.editor.editable.call(self, editParams)) {
                      if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                        self.select(row, column.fieldName);
                        return false;
                      }
                    } else if (column.editor && $.type(column.editor.editable) === "boolean") {
                      if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                        self.select(row, column.fieldName);
                        return false;
                      }
                    }
                  }
                }
                index = self.options.displayColumns.length;
              }
            }
          }
        };
        self._grid.onKeyUp = function (grid2, key, ctrl, shift, alt) {
          var params;
          if (self.dataItem(self._grid.getCurrent().itemIndex) !== null) {
            params = {
              grid: self,
              row: {
                index: self._grid.getCurrent().itemIndex,
                data: self.dataItem(self._grid.getCurrent().itemIndex)
              },
              cell: {
                field: self._grid.getCurrent().column,
                data: self.getCellValue(self._grid.getCurrent().itemIndex, self._grid.getCurrent().column)
              },
              keyCode: key,
              ctrl: ctrl,
              shift: shift,
              alt: alt
            };
          }
          var event = $.Event("keyUp", params);
          self.$element.trigger(event);
          if (key === 37 || key === 38 || key === 39 || key === 40) {
            if (dews.ui.page.option === void 0 && dews.ui.page.useGridNote === "Y") {
              self._grid.onSelectionEnded.call(self, self._grid);
            }
          }
        };
        self._grid.setPasteOptions({
          eventEachRow: true
        });
        self._grid.onEditRowPasted = function (grid2, itemIndex, dataRow, fields, oldValues, newValues) {
          var className = ".dews-ui-grid";
          newValues = newValues.filter(function (value) {return value !== void 0;});
          var isCell = true;
          var copyData = self.clipboard.copyData;
          if (copyData.length < 2) {
            copyData = copyData.toString().split("\n");
          }
          self.clipboard.length = copyData.length;
          if (fields.length > 1 || copyData.length > 1) {
            isCell = false;
          }
          for (var i = 0; i < fields.length; i++) {
            var _newValues = newValues.slice(i, i + 1),fieldName = grid2._dataSource.getOrgFieldName(fields[i]),fieldIndex = fields[i];
            dews.ui.gridUtil.onEditRowPasted(self, itemIndex, fieldName, fieldIndex, _newValues, className, isCell);
          }
          addRowEvent();
          function addRowEvent() {
            if (!self.options.pastingAtNewRow) {
              return;
            }
            if (self.options.dataSource) {
              var addParameter = {
                grid: self,
                row: {
                  index: itemIndex,
                  data: self.dataItem(itemIndex)
                }
              };
              self._grid.commit(true);
              var addEvent = new $.Event("rowAdd", addParameter);
              try {
                self.$element.trigger(addEvent);
              } catch (e) {
                console.log(e);
              }
            }
            delete self.options.pastingAtNewRow;
          }
        };
        self._grid.onCopy = function (grid2, range, event) {
          self.clipboard = {
            grid: self,
            itemIndex: {
              start: range.startItem,
              end: range.endItem
            },
            column: {
              start: range.startColumn,
              end: range.endColumn
            },
            range: range,
            values: self._grid.getSelectionData()
          };
          var copyEvent = new $.Event("onCopy", self.clipboard);
          self.$element.trigger(copyEvent);
          if (copyEvent.isDefaultPrevented()) {
            return false;
          }
        };
        self._grid.onPaste = function (grid2, index, event) {
          var getText = $.type(event.clipboardData) === "undefined" ? window.clipboardData.getData("Text") : event.clipboardData.getData("Text");
          var checkLastNewLine = getText.substr(getText.length - 2) === "\r\n";
          if (checkLastNewLine) {
            getText = getText.substring(0, getText.length - 2);
          }
          var doubleData = getText.split("\r\n");
          for (var i = 0; i < doubleData.length; i++) {
            doubleData[i] = doubleData[i].split("	");
          }
          var pastingParams = {
            grid: self,
            copyData: doubleData,
            start: {
              index: index.itemIndex,
              column: index.column
            }
          };
          self.clipboard = {
            copyData: doubleData,
            cnt: 0
          };
          var pastingEvent = new $.Event("pasting", pastingParams);
          self.$element.trigger(pastingEvent);
          if (pastingEvent.isDefaultPrevented()) {
            return false;
          }
          var pasteResult = dews.ui.gridUtil.onPaste(self, index, event);
          return pasteResult;
        };
        self._grid.onScrollToBottom = function () {
          var dataSource = self.options.dataSource;
          if (dataSource && dataSource.options.pagingType === "scroll") {
            dataSource.options.bottom = true;
            var eventParameter = {
                grid: self
              },scrollToBottomEvent;
            scrollToBottomEvent = new $.Event("scrollToBottom", eventParameter);
            self.$element.trigger(scrollToBottomEvent);
            if (dataSource.options.pagingScrollEnd !== true && dataSource.options.totalCount) {
              dataSource.read();
            } else {
              dews.ui.loading.hide();
            }
          }
        };
        self._grid.onPasted = function (grid2) {
          var start,end,rows = [],result,columns = [],isSelectionColumn = false,startColumn,endColumn,selectionColumns;
          selectionColumns = self._grid.getSelection();
          start = selectionColumns !== null ? selectionColumns.startItem : self._grid.getCurrent().itemIndex;
          end = selectionColumns !== null ? selectionColumns.endItem : self._grid.getCurrent().itemIndex;
          startColumn = selectionColumns !== null ? selectionColumns.startColumn : "";
          endColumn = selectionColumns !== null ? selectionColumns.endColumn : "";
          for (var i = start; i <= end; i++) {
            rows.push(i);
          }
          if (selectionColumns === null) {
            columns.push(self._grid.getCurrent().fieldName);
          } else {
            var displayColumns = self._grid.getDisplayColumns();
            result = getSelectionColumns(displayColumns, startColumn, endColumn, isSelectionColumn);
            columns = result.columns;
          }
          if (self.options.copyMode === "row") {
            $.each(rows, function (index, row) {
              $.each(columns, function (idx, column) {
                var editParams = {
                  grid: self,
                  row: {
                    index: row,
                    data: self.dataItem(row)
                  },
                  cell: {
                    field: column,
                    data: self.getCellValue(row, column)
                  }
                };
                if (self.columns[column] && (!self.columns[column].editable || $.type(self.columns[column].editor.editable) === "function" && !self.columns[column].editor.editable.call(self, editParams))) {
                }
              });
            });
          }
          var eventParameter = {
            grid: self,
            columns: columns,
            rows: rows
          };
          grid2.commit();
          var pastedEvent = new $.Event("pasted", eventParameter);
          self.$element.trigger(pastedEvent);
        };
        self._grid.onCellPasting = function (grid2, index) {
          if (!self.options.pasteAddRowEvent) {
            return true;
          }
          if (index.itemIndex === -1 || index.dataRow === -1) {
            self.options.pastingAtNewRow = true;
          }
          return true;
        };
        self.$element.on("changing", function (e) {
          if (self.options.changing && $.type(self.options.changing) === "function" && e.grid) {
            self.options.changing.call(self, e);
          }
        });
        self.$element.on("change", function (e) {
          if (self.options.change && $.type(self.options.change) === "function" && e.grid) {
            self.options.change.call(self, e);
          }
        });
        self.$element.on("save", function (e) {
          if (self.options.save && $.type(self.options.save) === "function" && e.grid) {
            self.options.save.call(self, e);
          }
        });
        self.$element.on("validationCheck", function (e) {
          if (self.options.validationCheck && $.type(self.options.validationCheck) === "function" && e.grid) {
            self.options.validationCheck.call(self, e);
          }
        });
        self.$element.on("dataBound", function (e) {
          if (self.options.dataBound && $.type(self.options.dataBound) === "function" && e.grid) {
            self.options.dataBound.call(self, e);
          }
        });
        self.$element.on("rowAdd", function (e) {
          if (self.options.rowAdd && $.type(self.options.rowAdd) === "function" && e.grid) {
            self.options.rowAdd.call(self, e);
          }
        });
        self.$element.on("rowRemove", function (e) {
          if (self.options.rowRemove && $.type(self.options.rowRemove) === "function" && e.grid) {
            self.options.rowRemove.call(self, e);
          }
        });
        self.$element.on("cellEditing", function (e) {
          if (self.options.cellEditing && $.type(self.options.cellEditing) === "function" && e.grid) {
            self.options.editValue = self.options.cellEditing.call(self, e);
          }
        });
        self.$element.on("selected", function (e) {
          if (self.options.selected && $.type(self.options.selected) === "function" && e.grid) {
            self.options.selected.call(self, e);
          }
        });
        self.$element.on("clicked", function (e) {
          if (self.options.clicked && $.type(self.options.clicked) === "function" && e.grid) {
            self.options.clicked.call(self, e);
          }
        });
        self.$element.on("dblClicked", function (e) {
          if (self.options.dblClicked && $.type(self.options.dblClicked) === "function" && e.grid) {
            self.options.dblClicked.call(self, e);
          }
        });
        self.$element.on("keyDown", function (e) {
          if (self.options.keyDown && $.type(self.options.keyDown) === "function" && e.grid) {
            self.options.keyDown.call(self, e);
          }
        });
        self.$element.on("headerClicked", function (e) {
          if (self.options.headerClicked && $.type(self.options.headerClicked) === "function" && e.grid) {
            self.options.headerClicked.call(self, e);
          }
        });
        self.$element.on("codedialog", function (e) {
          if (self.options.codedialog && $.type(self.options.codedialog) === "function") {
            self.options.codedialog.call(self, e);
          }
        });
        self.$element.on("columnHeaderCheck", function (e) {
          if (self.options.columnHeaderCheck && $.type(self.options.columnHeaderCheck) === "function") {
            self.options.columnHeaderCheck.call(self, e);
          }
        });
        self.$element.on("keyUp", function (e) {
          if (self.options.keyUp && $.type(self.options.keyUp) === "function") {
            self.options.keyUp.call(self, e);
          }
        });
        self.$element.on("scrollToBottom", function (e) {
          if (self.options.scrollToBottom && $.type(self.options.scrollToBottom) === "function" && e.grid) {
            self.options.scrollToBottom.call(self, e);
          }
        });
        self.$element.on("onCopy", function (e) {
          if (self.options.onCopy && $.type(self.options.onCopy) === "function" && e.grid) {
            self.options.onCopy.call(self, e);
          }
        });
        self.$element.on("pasted", function (e) {
          if (self.options.pasted && $.type(self.options.pasted) === "function" && e.grid) {
            self.options.pasted.call(self, e);
          }
        });
        self.$element.on("pasting", function (e) {
          if (self.options.pasting && $.type(self.options.pasting) === "function" && e.grid) {
            self.options.pasting.call(self, e);
          }
        });
        self.$element.on("mouseup", function (e) {
          if (e.altKey && self.options.useSimpleCalculator !== false) {
            dews.ui.gridUtil.openSimpleCalculatorDialog(self);
          }
        });
        self.$element.on("filtered", function (e) {
          if (self.options.filtered && $.type(self.options.filtered) === "function" && e.grid) {
            self.options.filtered.call(self, e);
          }
        });
        function windowScroll(e) {
          if ($(e.target).closest(document.body).length !== 0) {
            self.commitCell();
          }
        }
        function noteMain(grid2, dataIndex) {
          if (dataIndex === null || dataIndex < 0) {
            return null;
          }
          var disabledRows = self._gridNote.disabledRow;
          var disabled = false;
          if (disabledRows) {
            if (typeof disabledRows === "number") {
              disabled = disabledRows === dataIndex ? true : false;
            } else {
              disabled = disabledRows.indexOf(dataIndex) !== -1;
            }
          }
          var itemIndex = self.getItemIndexFromDataIndex(dataIndex);
          var noteOpt = self.options.note;
          var key;
          if (self.getRowState(itemIndex) === "added" || !noteOpt || disabled) {
            key = {
              gridNoteKey: "",
              gridCode: "",
              menuCode: "",
              userInfo: {
                insertId: "",
                insertIp: "",
                insertDate: "",
                updateId: "",
                updateIp: "",
                updateDate: ""
              }
            };
          } else {
            var selectRowDS = grid2._dataSource.getJsonRow(dataIndex);
            var noteKey = dews.ui.gridUtil._getGridNoteInfo(self, itemIndex);
            key = {
              gridNoteKey: noteKey.gridNoteKey,
              gridCode: noteKey.gridCode,
              menuCode: noteKey.menuCode,
              userInfo: {
                insertId: selectRowDS.INSERT_ID,
                insertIp: selectRowDS.INSERT_IP,
                insertDate: selectRowDS.INSERT_DTS,
                updateId: selectRowDS.UPDATE_ID,
                updateIp: selectRowDS.UPDATE_IP,
                updateDate: selectRowDS.UPDATE_DTS
              }
            };
          }
          dews.ui.page.gridNote.setGridNoteData(self, key);
        }
        $(window).on("mousedown", function (e) {
          var target = $(e.target).closest(".dews-ui-grid"),grid2 = self.$element.closest(".dews-ui-grid"),inGrid = false;
          if (grid2.length !== 0 && grid2.offset().left - window.pageXOffset < e.clientX && grid2.offset().left + grid2.width() - window.pageXOffset > e.clientX && grid2.offset().top - window.pageYOffset < e.clientY && grid2.offset().top + grid2.height() - window.pageYOffset > e.clientY) {
            inGrid = true;
          }
          if ($(e.target).closest(document.body).length === 0) {
            inGrid = true;
          }
          if (target.length === 0 && !inGrid) {
            self.commitCell();
            self.editable = false;
          }
          if (target.length !== 0 && target.children().attr("ID") !== self._grid.name) {
            self.commitCell();
            self.editable = false;
          }
        });
        self.$element.on("click", function (e) {
          var grid2 = self.options.$content.find(".dews-ui-grid");
          if (e.target.tagName !== "INPUT" && e.target.tagName !== "TEXTAREA" && self._grid.mouseToIndex(e.offsetX, e.offsetY).itemIndex === -1) {
            self.commitCell();
            self.editable = false;
          }
        });
        self.$element.on("keyDown", function (e) {
          if (self.options.columns) {
            var column = self.columns[self._grid.getCurrent().fieldName];
            if (column && column.editor) {
              if (column.editor.type.toLowerCase() === "codepicker" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (column.codeOption.validation) {
                  var codeOptionVal = column.codeOption.value[self.getDataIndexFromItemIndex(self.select())];
                  if (($.type(codeOptionVal) === "undefined" || codeOptionVal.value === "" || codeOptionVal.value === void 0) && self._grid.getCurrent().dataRow !== -1) {
                    var currentValue2 = self.getCellValue(
                    self._grid.getCurrent().itemIndex,
                    column.fieldName);

                    column.codeOption.value[self.getDataIndexFromItemIndex(self.select())] = dews.ui.gridUtil._codeOptionValue("", "", currentValue2);
                  }
                }
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
                if (e.keyCode === 13 && $.type(self._grid.getEditValue()) !== "undefined" && self._grid.getEditValue() !== "") {
                  self.commitCell();
                  e.preventDefault();
                }
                if (e.ctrl && e.keyCode === 86) {
                  self._useCodesearch = true;
                }
                if ($(".dews-loading-bg").length > 0) {
                  e.preventDefault();
                }
              }
              if (self._grid._gv._editController._editor && column.editor.type.toLowerCase() === "date") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1 && self._grid.getColumnProperty(column.fieldName, "editable")) {
                  self.editCell();
                  self._grid._gv._editController._editor.dropDown();
                  e.stopPropagation();
                  e.preventDefault();
                }
                if (e.keyCode === 13 && self._grid._gv._editController._editor._datetimeFormat && self._grid.getEditValue() === self._grid._gv._editController._editor._datetimeFormat.replace(/[A-z]/gi, "_") && ($.type(self._grid.getValue(self.select(), self.getCurrentColumn())) === "undefined" || self._grid.getValue(self.select(), self.getCurrentColumn()) === null)) {
                  self.closeCell();
                  self.setCellValue(self.select(), self.getCurrentColumn(), new Date());
                }
              }
              if (column.editor.type.toLowerCase() === "number" && self._grid.getColumnProperty(column.fieldName, "editable")) {
                if (e.keyCode === 107) {
                  var oldVal = self._grid.getEditValue();
                  if (oldVal) {
                    e.preventDefault();
                    var currentValue = oldVal.replace(/,/g, ""),resultValue = 0;
                    if (column.editor.increaseType === "plus") {
                      resultValue = parseFloat(currentValue) + parseFloat(column.editor.increaseValue);
                    } else {
                      resultValue = parseFloat(currentValue) * parseFloat(column.editor.increaseValue);
                    }
                    if (column.editor.maxIntegerLength > Math.ceil(resultValue).toString().length) {
                      self.$element.find("#" + self._grid.name + "_number").val(dews.number.format(resultValue.toString(), column.editor.format));
                      self._grid._gv._editController.onEditorChange.call(
                      self._grid._gv._editController,
                      self._grid._gv._editController._editIndex);

                    }
                  } else {
                    e.preventDefault();
                    self._grid.showEditor();
                  }
                }
              }
              if (self._grid._gv._editController._editor && column.editor.type.toLowerCase() === "dropdown") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1 && self._grid.getColumnProperty(column.fieldName, "editable")) {
                  self.editCell();
                  self._grid._gv._editController._editor.dropDown();
                  e.stopPropagation();
                  e.preventDefault();
                }
                if (self._grid._gv._editController._editor.isVisible() && column.editor.textReadOnly) {
                  if (e.keyCode >= 49 && e.keyCode <= 57 || e.keyCode >= 97 && e.keyCode <= 105 && column.editor.useNumkey) {
                    var number = e.keyCode >= 49 && e.keyCode <= 57 ? e.keyCode - 49 : e.keyCode - 97;
                    if (column.editor && column.editor.dataSelectable) {
                      if (column.editor.values.length > number) {
                        self.setCellValue(
                        self.select(),
                        column.fieldName,
                        column.editor.values[number]);

                        e.preventDefault();
                      }
                    } else {
                      if (column.values.length > number) {
                        self.setCellValue(self.select(), column.fieldName, column.values[number]);
                        e.preventDefault();
                      }
                    }
                  }
                }
              }
              if (column.editor.type.toLowerCase() === "zipcodepicker" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
              }
              if (column.editor.type.toLowerCase() === "month" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
                if (e.keyCode === 13) {
                  if (self._grid._gv._editController._editor._datetimeFormat && self._grid.getEditValue() === self._grid._gv._editController._editor._datetimeFormat.replace(/[A-z]/gi, "_") && ($.type(self._grid.getValue(self.select(), self.getCurrentColumn())) === "undefined" || self._grid.getValue(self.select(), self.getCurrentColumn()) === null)) {
                    self.commitCell();
                    self.setCellValue(self.select(), self.getCurrentColumn(), new Date());
                  } else if (column.monthpicker.dateView._value && column.monthpicker.dateView._value.toString() !== column.monthpicker.dateView._current.toString()) {
                    self.commitCell();
                    self.setCellValue(
                    self.select(),
                    self.getCurrentColumn(),
                    new Date(column.monthpicker.dateView._current));

                  }
                }
                if (e.keyCode < 41 && e.keyCode > 36 && $.type(self._grid.getEditValue()) !== "undefined") {
                  e.preventDefault();
                  column.monthpicker.kendoInstance._keydown(e);
                }
              }
              if (column.editor.type.toLowerCase() === "year" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
                if (e.keyCode === 13) {
                  if (self._grid._gv._editController._editor._datetimeFormat && self._grid.getEditValue() === self._grid._gv._editController._editor._datetimeFormat.replace(/[A-z]/gi, "_") && ($.type(self._grid.getValue(self.select(), self.getCurrentColumn())) === "undefined" || self._grid.getValue(self.select(), self.getCurrentColumn()) === null)) {
                    self.commitCell();
                    self.setCellValue(self.select(), self.getCurrentColumn(), new Date());
                    column.yearpicker.kendoInstance._keydown(e);
                  } else if (column.yearpicker.dateView._value && column.yearpicker.dateView._value.toString() !== column.yearpicker.dateView._current.toString()) {
                    self.commitCell();
                    self.setCellValue(
                    self.select(),
                    self.getCurrentColumn(),
                    new Date(column.yearpicker.dateView._current));

                    column.yearpicker.kendoInstance._keydown(e);
                  }
                }
                if (e.keyCode < 41 && e.keyCode > 36 && $.type(self._grid.getEditValue()) !== "undefined") {
                  e.preventDefault();
                  column.yearpicker.kendoInstance._keydown(e);
                }
              }
              if (column.editor.type.toLowerCase() === "time" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
                if (e.keyCode === 13) {
                  column.timepicker.kendoInstance._keydown(e);
                  self.commitCell();
                }
                if (e.keyCode < 41 && e.keyCode > 36 && $.type(self._grid.getEditValue()) !== "undefined") {
                  e.preventDefault();
                  column.timepicker.kendoInstance._keydown(e);
                }
              }
            }
          }
        });
        if (self.options.dataSource && self.options.dataSource.dataProvider) {
          self.options.dataSource.dataProvider._dp.setRows = setRow(
          self,
          self.options.dataSource.dataProvider._dp.setRows);

          self.options.dataSource.dataProvider._dp.insertRows = insertRows(
          self,
          self.options.dataSource.dataProvider._dp.insertRows);

          self.options.dataSource.dataProvider._dp.insertRow = insertRow(
          self,
          self.options.dataSource.dataProvider._dp.insertRow);

        }
        self._grid._gv._container._defaultTool._checkCellClicked = function (cell, event) {
          var grid2 = this.grid();
          var dewsGrid = $(grid2._container._containerDiv).closest(".dews-data-control").data("dews-control");
          if (grid2.editOptions().isCheckable()) {
            var checkBar = grid2.checkBar();
            var item = cell.item();
            if (event && event.shiftKey && this._prevCheckIndex && !checkBar.isExclusive() && dewsGrid.options.shiftCheck) {
              var prevItem = this._prevCheckIndex.item();
              var idx1 = Math.min(prevItem._index, item._index),idx2 = Math.max(prevItem._index, item._index),itemIndicies = [];
              for (var idx = idx1; idx <= idx2; idx++) {
                item = grid2.getItem(idx);
                item.isCheckable() && item.dataRow() >= 0 && itemIndicies.push(item);
              }
              itemIndicies.length > 0 && grid2.itemSource().checkItems(itemIndicies, prevItem.isChecked(), true);
            } else {
              if (item.isCheckable() && (checkBar.isShowGroup() || item.dataRow() >= 0)) {
                grid2.makeItemVisible(item.index());
                grid2.itemSource().checkItem(item, !item.isChecked(), checkBar.isExclusive(), true);
              }
            }
          }
        };
        if (dews.ui.page.onegridData && dews.ui.page.onegridData.editable) {
          self.$element.find(".dews-grid-edit-button").on("click", function (e) {
            var fixedOptions = self._grid.getFixedOptions();
            var fixedColumns = dews.ui.gridUtil.getFixedColumns(self);
            self._onegrid.fixed = {
              colCount: fixedOptions.colCount,
              rightColCount: fixedOptions.rightColCount,
              leftColumns: fixedColumns.leftColumns,
              rightColumns: fixedColumns.rightColumns
            };
            self._onegrid.loadColumns = dews.ui.gridUtil.setOnegridDialogColumns(self, self._onegrid.loadColumns);
            var dlg = new ColumnDialog(self);
            dlg.columnDialog.open();
          });
        }
        self._grid._gv._clipboardManager.$_convertValue = dews.ui.gridUtil.extend__$_convertValue(
        self._grid._gv._clipboardManager.$_convertValue);

        self._grid._gv._clipboardManager.$_pasteSingleCell = dews.ui.gridUtil.extend__$_pasteSingleCell(
        self._grid._gv._clipboardManager.$_pasteSingleCell,
        self._grid._gv._clipboardManager);

        self._grid._gv._clipboardManager.$_cellWritable = dews.ui.gridUtil.extend__$_cellWritable(
        self._grid._gv._clipboardManager.$_cellWritable,
        self._grid._gv._clipboardManager);

      } }]);return GridEvent;}(Event);

  function findUserOptionsColumn5(columns, fieldName, userColumn) {
    if (!columns)
    return null;
    for (var index = 0; index < columns.length; index++) {
      if (userColumn === void 0) {
        if (columns[index].field === fieldName) {
          userColumn = columns[index];
        } else if (columns[index].columns) {
          userColumn = findUserOptionsColumn5(columns[index].columns, fieldName, userColumn);
        }
      }
    }
    return userColumn;
  }
  function getSelectionColumns(cols, start, end, isSelectionColumn) {
    var result = {
      columns: [],
      isSelectionColumn: isSelectionColumn
    };
    for (var i = 0; i < cols.length; i++) {
      var col = cols[i];
      isSelectionColumn = !isSelectionColumn && start === col ? true : isSelectionColumn;
      if (col.columns) {
        var c = getSelectionColumns(col.columns, start, end, isSelectionColumn);
        isSelectionColumn = c.isSelectionColumn;
        var column = {
          field: col.name,
          columns: c.columns
        };
        if (c.columns.length > 0) {
          result.columns.push(column);
        }
      } else if (isSelectionColumn) {
        result.columns.push(col);
      }
      isSelectionColumn = isSelectionColumn && end === col ? false : isSelectionColumn;
    }
    result.isSelectionColumn = isSelectionColumn;
    return result;
  }

  // src/js/grid/event/treeGridEvent.js
  var TreeGridEvent = /*#__PURE__*/function (_Event2) {"use strict";_inherits(TreeGridEvent, _Event2);var _super6 = _createSuper(TreeGridEvent);
    function TreeGridEvent(grid2) {_classCallCheck(this, TreeGridEvent);return _super6.call(this,
      grid2);
    }_createClass(TreeGridEvent, [{ key: "initialize", value:
      function initialize() {
        _get(_getPrototypeOf(TreeGridEvent.prototype), "initialize", this).call(this);
        this._bindEvent();
      } }, { key: "_bindEvent", value:
      function _bindEvent() {
        var self = this.grid;
        var observer = new MutationObserver(function (mutations) {
          mutations.forEach(function (mutation) {
            if (mutation.attributeName === "style") {
              if (/display:\s?none/i.test(mutation.oldValue)) {
                if ($(mutation.target).is(":visible")) {
                  self._grid.resetSize();
                }
              }
            } else if (mutation.attributeName === "class") {
              if ($(mutation.target).is(":visible")) {
                self._grid.resetSize();
              }
            }
          });
        });
        self.$element.parentsUntil("body").each(function (idx, item) {
          observer.observe(item, {
            attributes: true,
            attributeOldValue: true,
            attributeFilter: ["style", "class"]
          });
        });
        if (dews.app && dews.app.menuSectionResized) {
          dews.app.menuSectionResized.on(function () {
            self._grid.resetSize();
          });
        }
        if (self.options.dataSource && self.options.dataSource.dataProvider) {
          self.options.dataSource.dataProvider._dp.setJsonRows = setJsonRows(
          self,
          self.options.dataSource.dataProvider._dp.setJsonRows);

          self.options.dataSource.dataProvider._dp.createRow = createRow(
          self,
          self.options.dataSource.dataProvider._dp.createRow);

        }
        self._grid.onImageButtonClicked = function (treeGrid, itemIndex, column, buttonIndex, name) {
          var parameter = {
            treegrid: self,
            row: {
              index: self._grid.getDataRow(itemIndex),
              data: self.dataItem(self._grid.getDataRow(itemIndex))
            },
            cell: {
              field: column.fieldName,
              data: self.getCellValue(self._grid.getDataRow(itemIndex), column.fieldName)
            }
          };
          dews.ui.gridUtil.onImageButtonClicked(self, itemIndex, column, parameter);
        };
        self.options._gridCallback = function (data, column, index) {
          dews.ui.gridUtil._gridCallback(self, data, column, index);
        };
        self._grid.onLinkableCellClicked = function (treeGrid, index, url) {
          var linkUrl = self.dataItem(index.dataRow)[self.columns[index.column].formats.urlField],parameter = {
              treegrid: self,
              row: {
                index: index.dataRow,
                data: self.dataItem(index.dataRow)
              },
              cell: {
                field: index.column,
                data: self.getCellValue(index.dataRow, index.column)
              }
            };
          dews.ui.gridUtil.onLinkableCellClicked(self, index, linkUrl, parameter);
        };
        self._grid.onShowEditor = function (id, index) {
          var parameter = {
            treegrid: self,
            row: {
              index: index.dataRow === -1 ? index.itemIndex : index.dataRow
            },
            cell: {
              field: index.fieldName
            }
          };
          window.addEventListener("scroll", windowScroll);
          return dews.ui.gridUtil.onShowEditor(self, id, index, parameter);
        };
        self._grid.onHideEditor = function (treeGrid, index) {
          if (self.options.commit) {
            dews.ui.gridUtil.onHideEditor(self, treeGrid, index);
            window.removeEventListener("scroll", windowScroll);
          }
          setTimeout(function () {var _self$columns$fieldNa4, _self$columns$fieldNa5, _self$columns$fieldNa6;
            var fieldName = index.fieldName;
            if (((_self$columns$fieldNa4 = self.columns[fieldName]) === null || _self$columns$fieldNa4 === void 0 ? void 0 : (_self$columns$fieldNa5 = _self$columns$fieldNa4.editor) === null || _self$columns$fieldNa5 === void 0 ? void 0 : (_self$columns$fieldNa6 = _self$columns$fieldNa5.type) === null || _self$columns$fieldNa6 === void 0 ? void 0 : _self$columns$fieldNa6.toLowerCase()) === "codepicker") {
              $(window).trigger("enableMainArea");
            }
          }, 300);
          self.options.commit = false;
        };
        self._grid.onSelectionEnded = function (treeGrid) {
          if (dews.ui.page.option === void 0 && dews.ui.page.useGridNote === "Y") {
            var selectDataIndex = treeGrid.getSelection().startRow;
            noteMain(treeGrid, selectDataIndex);
          }
        };
        self._grid.onCurrentRowChanged = function (treeGrid, oldIndex, newIndex) {
          if (self.options.dataBounding || self.options.master && newIndex === -1 || $.type(self.options.remove) === "boolean") {
            self._grid.onCurrentChanging.call(self, self._grid, self._grid.getCurrent(), self._grid.getCurrent());
            self.options.rowChange = true;
            self._grid.onCurrentChanged.call(self, self._grid, self._grid.getCurrent());
          }
        };
        self._grid.onCurrentChanging = function (treeGrid, oldIndex, newIndex) {var _columns$editor4, _columns$editor4$type, _columns$editor5, _columns$editor5$mask, _columns$editor6;
          var dataRow = self._grid.getDataRow(newIndex.itemIndex);
          self.options.rowChange = false;
          if (newIndex.dataRow === -1 ? oldIndex.itemIndex !== newIndex.itemIndex : oldIndex.dataRow !== newIndex.dataRow) {
            self.options.rowChange = true;
          }
          self.options.isDataBound = self.options.dataBounding === true;
          self.options.previousData = self.dataItem(self._grid.getDataRow(oldIndex.itemIndex));
          self.options.previous = oldIndex;
          if (oldIndex.dataRow !== -1 && self.focused) {
            self.setFocus();
          }
          if (newIndex.dataRow === -1) {
            if (self._grid.getItemState(newIndex.itemIndex) === "appending") {
              self.commitCell();
              dataRow = newIndex.itemIndex;
            }
          }
          var columns = self.columns[newIndex.fieldName];
          var filterArr;
          if (treeGrid.getColumnProperty(newIndex.column, "editor") && newIndex.fieldIndex !== -1 && self.dataItem(dataRow)) {
            if (columns !== null && columns !== void 0 && columns.editor && self.options.dataSource) {var _filterArr3;
              var editor;
              var visible;
              var rowEditable;
              var parameter = {
                treegrid: self,
                row: {
                  index: dataRow,
                  data: self.dataItem(dataRow)
                },
                cell: {
                  field: newIndex.fieldName
                }
              };
              filterArr = newIndex !== null && newIndex !== void 0 && newIndex.fieldName ? self._grid.getActiveColumnFilters(newIndex.fieldName, true) : null;
              if (treeGrid.getSortedFields() !== null || ((_filterArr3 = filterArr) === null || _filterArr3 === void 0 ? void 0 : _filterArr3.length) > 0) {
                parameter.row.index = newIndex.itemIndex;
                parameter.row.data = self._grid.getValues(newIndex.itemIndex);
              }
              if (typeof columns.editable === "boolean" && !columns.editable && columns.editor.type.toLowerCase() !== "check") {
                editor = columns.editable;
              } else {
                editor = typeof columns.editor.editable === "function" ? columns.editor.editable.call(self, parameter) : columns.editor.editable;
              }
              columns.editor.editResult = editor;
              rowEditable = typeof self.options.rowEditable === "function" ? self.options.rowEditable.call(self, parameter) : self.options.rowEditable;
              self.rowEditable = rowEditable;
              if (self.options.editable) {
                if (typeof rowEditable === "boolean") {
                  columns.editor.flag = rowEditable !== true;
                }
                if (columns.editable && typeof columns.editor.editable === "function" && editor) {
                  self._grid.setColumnProperty(newIndex.fieldName, "editable", editor);
                }
              }
              switch (columns.editor.type.toLowerCase()) {
                case "codepicker":
                case "zipcodepicker":
                case "time":
                case "month":
                case "year":
                  visible = "visible";
                  if (!editor) {
                    visible = "hidden";
                  }
                  if (rowEditable === false) {
                    visible = "hidden";
                  }
                  if (!self.options.edit.editable) {
                    visible = "hidden";
                  }
                  columns.buttonVisibility = visible;
                  self._grid.setColumnProperty(columns.name, "buttonVisibility", visible);
                  break;}

              if (columns.editor.type.toLowerCase() === "check") {
                var options = self._grid.getColumnProperty(columns.name, "renderer");
                if (typeof rowEditable === "boolean" && rowEditable === false) {
                  self._grid.setColumnProperty(
                  columns.name,
                  "renderer",
                  $.extend(true, options, { editable: rowEditable }));

                } else {
                  self._grid.setColumnProperty(
                  columns.name,
                  "renderer",
                  $.extend(true, options, { editable: editor }));

                }
              }
              if (columns.editable && editor) {
                if (typeof self.options.rowEditable === "undefined" || rowEditable || rowEditable !== false) {
                  self._grid.setColumnProperty(columns.name, "editable", true);
                } else {
                  self._grid.setColumnProperty(columns.name, "editable", false);
                }
              } else {
                self._grid.setColumnProperty(columns.name, "editable", false);
              }
            }
          }
          if ((columns === null || columns === void 0 ? void 0 : (_columns$editor4 = columns.editor) === null || _columns$editor4 === void 0 ? void 0 : (_columns$editor4$type = _columns$editor4.type) === null || _columns$editor4$type === void 0 ? void 0 : _columns$editor4$type.toLowerCase()) === "dropdown" && typeof columns.editor.dataSource === "function" && self.dataItem(dataRow)) {var _datasource$transport, _datasource$transport2;
            var col = self._grid.columnByField(columns.fieldName);
            var e = {
              treegrid: self,
              row: {
                index: dataRow,
                data: self.dataItem(dataRow)
              }
            };
            var datasource = columns.editor.dataSource.call(self, e);
            col.values = [];
            col.labels = [];
            if (typeof col.editor === "string" && col.editor === "dropDown") {
              col.editor = {
                type: "dropDown",
                values: [],
                labels: []
              };
            }
            if ((datasource === null || datasource === void 0 ? void 0 : (_datasource$transport = datasource.transport) === null || _datasource$transport === void 0 ? void 0 : (_datasource$transport2 = _datasource$transport.data) === null || _datasource$transport2 === void 0 ? void 0 : _datasource$transport2.length) > 0) {
              for (var l = 0; l < datasource.transport.data.length; l += 1) {
                col.values.push(datasource.transport.data[l][columns.editor.dataValueField]);
                col.labels.push(datasource.transport.data[l][columns.editor.dataTextField]);
                if (columns.editor.dataSelectable && datasource.transport.data[l][columns.editor.dataSelectable.field] !== columns.editor.dataSelectable.falseValue) {
                  col.editor.values.push(datasource.transport.data[l][columns.editor.dataValueField]);
                  col.editor.labels.push(datasource.transport.data[l][columns.editor.dataTextField]);
                }
              }
              col.labelField = typeof columns.editor.textField === "undefined" ? columns.editor.dataTextField : columns.editor.textField;
              col.lookupDisplay = true;
              self._grid.setColumn(col);
            } else {
              var fetchData;
              datasource.col = col;
              datasource.fetch(function () {
                fetchData = this;
              }).done(function () {
                var dropdownColumn = self.columns[fetchData.col.fieldName];
                $.each(fetchData.data(), function (idx, data) {
                  fetchData.col.values.push(data[dropdownColumn.editor.dataValueField]);
                  fetchData.col.labels.push(data[dropdownColumn.editor.dataTextField]);
                  if (dropdownColumn.editor.dataSelectable && data[dropdownColumn.editor.dataSelectable.field] !== dropdownColumn.editor.dataSelectable.falseValue) {
                    fetchData.col.editor.values.push(data[dropdownColumn.editor.dataValueField]);
                    fetchData.col.editor.labels.push(data[dropdownColumn.editor.dataTextField]);
                  }
                });
                fetchData.col.labelField = typeof dropdownColumn.editor.textField === "undefined" ? dropdownColumn.editor.dataTextField : dropdownColumn.editor.textField;
                fetchData.col.lookupDisplay = true;
                self._grid.setColumn(fetchData.col);
                fetchData.transport.data = fetchData.data();
                delete fetchData.col;
              });
            }
          }
          if (columns !== null && columns !== void 0 && (_columns$editor5 = columns.editor) !== null && _columns$editor5 !== void 0 && (_columns$editor5$mask = _columns$editor5.mask) !== null && _columns$editor5$mask !== void 0 && _columns$editor5$mask.allowEmpty && typeof columns.editor.format === "function" && self.dataItem(newIndex.dataRow)) {
            var maskParams = {
              grid: self,
              row: {
                index: newIndex.dataRow,
                data: self.dataItem(newIndex.dataRow)
              },
              cell: {
                field: newIndex.column,
                data: self.getCellValue(newIndex.dataRow, newIndex.column)
              }
            };
            var maskEditFormat = columns.editor.format.call(self, maskParams);
            if (typeof maskEditFormat === "string" && maskEditFormat !== "") {
              self._grid.setColumnProperty(self._grid.columnByField(columns.field), "editorOptions", {
                mask: { editMask: maskEditFormat }
              });
            } else {
              self._grid.setColumnProperty(self._grid.columnByField(columns.field), "editorOptions", {
                mask: null
              });
            }
          }
          if ((columns === null || columns === void 0 ? void 0 : (_columns$editor6 = columns.editor) === null || _columns$editor6 === void 0 ? void 0 : _columns$editor6.type) === "number" && typeof columns.editor.currency === "function" && self.dataItem(newIndex.itemIndex + 1)) {var _dews$ui$page4;
            var params = {
              grid: self,
              row: {
                index: newIndex.dataRow,
                data: self.dataItem(newIndex.dataRow)
              },
              cell: {
                field: newIndex.column,
                data: self.getCellValue(newIndex.dataRow, newIndex.column)
              }
            };
            columns.editor.preCurrency = columns.editor.currency.call(self, params);
            var env = ((_dews$ui$page4 = dews.ui.page) === null || _dews$ui$page4 === void 0 ? void 0 : _dews$ui$page4.env) && dews.ui.page.env[columns.editor.preFormat];
            var currencyFormat = dews.getCurrencyFormat(columns.editor);
            var formats = "#,###.##";
            if (env) {
              formats = env.format;
            }
            if (_typeof(currencyFormat) === "object") {
              formats = currencyFormat.format;
            }
            var columnInfo = self._grid.columnByField(columns.field);
            var editorOptions = self._grid.getColumnProperty(columnInfo, "editorOptions", true);
            editorOptions.editFormat = formats;
            self._grid.setColumnProperty(columnInfo, "editorOptions", editorOptions);
          }
          var column = self.options.columns;
          if (self.options.dataBounding) {
            var dataBoundParameter = {
              treegrid: self,
              row: {
                data: self.options.dataSource.data()
              },
              column: column
            };
            var dataBoundEvent = new $.Event("dataBound", dataBoundParameter);
            self.$element.trigger(dataBoundEvent);
            delete self.options.dataBounding;
            self._setCriteria();
            if (self.options.note) {
              self._gridNote.boundingDraw(treeGrid, self, dataBoundParameter);
            }
          }
          if (typeof self.options.previousData === "undefined") {
            self.options.previousData = "";
          }
          if (typeof self.options.previous === "undefined") {
            self.options.previous = newIndex;
          }
          var changingParameter = {
            treegrid: self,
            isDataBound: self.options.isDataBound,
            row: {
              next: {
                index: newIndex.dataRow,
                data: self.dataItem(dataRow)
              },
              isChange: self.options.rowChange,
              index: oldIndex.dataRow !== -1 ? oldIndex.dataRow : oldIndex.itemIndex,
              data: self.dataItem(oldIndex.dataRow)
            },
            cell: {
              next: {
                field: newIndex.fieldName,
                data: self._grid.getValue(dataRow, newIndex.fieldName)
              },
              field: oldIndex.fieldName
            }
          };
          var event = new $.Event("changing", changingParameter);
          self.$element.trigger(event);
          if (event.isDefaultPrevented()) {
            return false;
          }
        };
        self._grid.onCurrentChanged = function (treeGrid, newIndex) {
          var index = self._grid.getDataRow(newIndex.itemIndex);
          if ($.type(self.options.add) === "boolean" && self.options.add && !self.options.filterClearing) {
            if (self.options.dataSource) {
              var addParameter, addEvent;
              addParameter = {
                treegrid: self,
                row: {
                  index: newIndex.dataRow,
                  data: self.dataItem(self.select())
                }
              };
              addEvent = new $.Event("rowAdd", addParameter);
              self.$element.trigger(addEvent);
              self.options.add = false;
            }
          }
          var data;
          if (newIndex.itemIndex > -1 && newIndex.fieldIndex > -1) {
            data = self._grid.getValue(newIndex.itemIndex, newIndex.fieldName);
          }
          var parameter = {
            treegrid: self,
            isDataBound: self.options.isDataBound,
            row: {
              index: index,
              data: self.dataItem(index),
              isChange: self.options.rowChange,
              previous: {
                index: self.options.previous.dataRow,
                data: self.dataItem(self.options.previous.dataRow)
              }
            },
            cell: {
              field: newIndex.fieldName,
              data: data,
              previous: {
                field: self.options.previous.fieldName
              }
            }
          };
          var event = new $.Event("change", parameter);
          $("#" + treeGrid.name).trigger(event);
          delete self.options.isDataBound;
          if (dews.ui.page && dews.ui.page.hasUserGuide) {
            if ($.isFunction(dews.ui.page.focusGuideItem) && newIndex.column) {
              dews.ui.page.focusGuideItem("#" + newIndex.column);
            }
          }
          if (self._grid.getSelectOptions().style !== "none") {
            var ids = ["selection"];
            self._grid.removeCellStyles(ids);
            var background = self.options.gridStyle.selection.focusBackgroundColor;
            if ($.type(self.columns[newIndex.column]) !== "undefined" && $.type(self.columns[newIndex.column].attributes) !== "undefined") {
              if (self.columns[newIndex.column].attributes["class"] === "required") {
                background = self.options.gridStyle.body.requiredFocusBackground;
              } else if (self.columns[newIndex.column].attributes["class"] === "readonly") {
                background = self.options.gridStyle.body.readonlyFocusBackground;
              }
            }
            if (self._grid.getCellStyle(index, newIndex.fieldIndex) === "editable") {
              self._grid.addCellStyle(
              "selection",
              {
                editable: false,
                background: background
              },
              true);

              self._grid.setCellStyle(index, newIndex.fieldIndex, "selection");
            } else {
              self._grid.addCellStyle(
              "selection",
              {
                background: background
              },
              true);

              self._grid.setCellStyle(index, newIndex.fieldIndex, "selection");
            }
          } else {
            self._grid.removeCellStyles(["selection"]);
          }
          var column = self.columns[newIndex.fieldName];
          if (column && column.editor) {
            if (column.editor.type.toLowerCase() === "dropdown" && column.editor.editResult && column.editor.autoOpen === true) {
              self.editCell();
            }
          }
        };
        self._grid.onCellEdited = function (treeGrid, itemIndex, dataRow, field) {
          var fields = self.options.dataSource.dataProvider.getFieldName(field);
          var column = dews.ui.gridUtil.findColumn(self.options.columns, fields);
          if (column && column.editor && column.editor.type.toLowerCase() === "time") {
            if (treeGrid.getEditingItem() && treeGrid.getEditingItem().values[column.fieldName]) {
              if (!column.displayRegExp.test(treeGrid.getEditingItem().values[column.fieldName])) {
                self.options.commit = true;
                self._grid.commit();
                self.setCellValue(dataRow, column.fieldName, "");
              }
            }
          }
          self.options.commit = true;
          self._grid.commit();
          self.editable = false;
          if (column && column.editor && column.editor.type.toLowerCase() === "dropdown" && $.type(column.editor.dataSource) === "function") {
            var col = self._grid.columnByField(column.fieldName),e = {
                treegrid: self,
                row: {
                  data: self.dataItem(dataRow),
                  index: dataRow
                }
              },datasource = column.editor.dataSource.call(self, e);
            col.values = [];
            col.labels = [];
            if (typeof col.editor === "string" && col.editor === "dropDown") {
              col.editor = {
                type: "dropDown",
                values: [],
                labels: []
              };
            }
            if (datasource && datasource.transport && datasource.transport.data && datasource.transport.data.length > 0) {
              var index = {
                  itemIndex: itemIndex,
                  dataRow: dataRow,
                  fieldIndex: field,
                  column: column.field,
                  fieldName: column.field
                },editResult = {
                  text: "",
                  value: self.getCellValue(dataRow, column.field)
                };
              for (var l = 0; l < datasource.transport.data.length; l += 1) {
                col.values.push(datasource.transport.data[l][column.editor.dataValueField]);
                col.labels.push(datasource.transport.data[l][column.editor.dataTextField]);
                if (column.editor.dataSelectable && datasource.transport.data[l][column.editor.dataSelectable.field] !== column.editor.dataSelectable.falseValue) {
                  col.editor.values.push(datasource.transport.data[l][column.editor.dataValueField]);
                  col.editor.labels.push(datasource.transport.data[l][column.editor.dataTextField]);
                }
                if (datasource.transport.data[l][column.editor.dataValueField] === editResult.value) {
                  editResult.text = datasource.transport.data[l][column.editor.dataTextField];
                }
              }
              if ($.type(column.editor.textField) === "undefined") {
                col.labelField = column.editor.dataTextField;
              } else {
                col.labelField = column.editor.textField;
              }
              col.lookupDisplay = true;
              self._grid.setColumn(col);
              self._grid.onGetEditValue.call(self, self._grid, index, editResult);
            }
          }
          var event,parameter,subSave = true;
          if ($.type(arguments[4]) === "boolean") {
            subSave = arguments[4];
          }
          parameter = {
            treegrid: self,
            row: {
              index: self._grid.getDataRow(itemIndex),
              data: self.dataItem(self._grid.getDataRow(itemIndex))
            },
            cell: {
              field: $.type(column) === "undefined" ? fields : column.field
            }
          };
          if ($.type(arguments[4]) === "boolean") {
            subSave = arguments[4];
          }
          if (subSave) {
            if (parameter.row.index === -1 && parameter.row.data === void 0) {
              parameter.row.index = dataRow;
              parameter.row.data = self.dataItem(dataRow);
            }
            event = new $.Event("save", parameter);
            $("#" + treeGrid.name).trigger(event);
          }
        };
        self._grid.onValidateColumn = function (treeGrid, column, inserting, value) {
          var event,parameter = {
              treegrid: self,
              cell: {
                field: column.fieldName,
                data: value
              },
              row: {
                index: self._grid.getCurrent().itemIndex
              }
            };
          if (column.fieldName === treeGrid.getCurrent().fieldName) {
            event = new $.Event("validationCheck", parameter);
            $("#" + treeGrid.name).trigger(event);
          }
        };
        self._grid.onContextMenuPopup = function (treeGrid, x, y, elementName) {
          if (elementName === "DataCell" && self.options.dataSource) {
            var currentCell = treeGrid.mouseToIndex(x, y),displayIndex = [],items = [],dataRow = self._grid.getDataRow(currentCell.dataRow),parameter = {
                treegrid: self,
                row: {
                  index: dataRow,
                  data: self.dataItem(dataRow)
                },
                cell: {
                  field: currentCell.fieldName,
                  data: treeGrid.getValue(dataRow, currentCell.fieldName)
                }
              };
            dews.ui.gridUtil.onContextMenuPopup(self, currentCell, parameter);
          } else {
            return false;
          }
        };
        self._grid.onContextMenuItemClicked = function (treeGrid, label, index) {
          if (self.options.dataSource) {
            var rowId = self._grid.getDataRow(index.itemIndex);
            var parameter = {
              treegrid: self,
              row: {
                index: rowId,
                data: self.dataItem(rowId)
              },
              cell: {
                field: index.fieldName,
                data: treeGrid.getValue(index.dataRow, index.fieldName)
              }
            };
            dews.ui.gridUtil.onContextMenuItemClicked(self, index, label, parameter);
          }
        };
        self._grid.onItemChecked = function (treeGrid, itemIndex, checked) {
          var dataIndex = self._grid.getDataRow(itemIndex);
          var event;
          var parameter = {
            treegrid: self,
            row: {
              index: dataIndex,
              data: self.dataItem(dataIndex)
            },
            cell: {
              isClicked: checked,
              header: {
                isClicked: false
              }
            }
          };
          if (self.options.childNodesCheck) {
            self._grid.checkChildren(itemIndex, checked, true, false, true, true);
          }
          event = new $.Event("selected", parameter);
          self.$element.trigger(event);
        };
        self._grid.onItemsChecked = function (treeGrid, items, checked) {
          var checkedItemIndex = [];
          var event;
          var parameter;
          $.each(items, function (index, data) {
            checkedItemIndex.push(self._grid.getDataRow(data));
          });
          parameter = {
            treegrid: self,
            row: {
              index: checkedItemIndex,
              data: self.dataItems(checkedItemIndex)
            },
            cell: {
              isClicked: checked,
              header: {
                isClicked: false
              }
            }
          };
          if (checked || self.options.shiftCheck) {
            event = new $.Event("selected", parameter);
            self.$element.trigger(event);
          }
        };
        self._grid.onItemAllChecked = function (treeGrid, checked) {
          var checkedIndex = self.getCheckedIndex();
          var event;
          var parameter = {
            treegrid: self,
            row: {
              index: checkedIndex,
              data: self.dataItems()
            },
            cell: {
              isClicked: checked,
              header: {
                isClicked: true
              }
            }
          };
          event = new $.Event("selected", parameter);
          self.$element.trigger(event);
        };
        self._grid.onGetEditValue = function (treeGrid, index, editResult) {
          dews.ui.gridUtil.onGetEditValue(self, index, editResult);
        };
        self._grid.onDataCellClicked = function (treeGrid, index) {
          var dataRow = self._grid.getDataRow(index.itemIndex),parameter = {
              treegrid: self,
              row: {
                index: dataRow,
                data: self.dataItem(dataRow)
              },
              cell: {
                field: index.fieldName,
                data: self.getCellValue(dataRow, index.fieldName)
              }
            };
          var event = new $.Event("clicked", parameter);
          self.$element.trigger(event);
        };
        self._grid.onDataCellDblClicked = function (treeGrid, index) {
          var dataRow = self._grid.getDataRow(index.itemIndex),dblParameter = {
              treegrid: self,
              row: {
                index: dataRow,
                data: self.dataItem(dataRow)
              },
              cell: {
                field: index.fieldName,
                data: self.getCellValue(dataRow, index.fieldName)
              }
            };
          var dblEvent = new $.Event("dblClicked", dblParameter);
          self.$element.trigger(dblEvent);
        };
        self._grid.onKeyDown = function (treeGrid, key, ctrl, shift, alt) {
          var currentColumn = self._grid.getCurrent().column;
          var currentIndex = self._grid.getCurrent().dataRow;
          if (key === 13 && self.options.requiredCheck && self.columns[currentColumn].attributes && self.columns[currentColumn].attributes["class"] === "required" && !self.getCellValue(currentIndex, currentColumn)) {
            return false;
          }
          if (key === 13 && self.columns[currentColumn].editor.type.toLowerCase() === "codepicker" && self.columns[currentColumn].codeOption.codesearch && $.type(self._grid.getEditValue()) === "undefined") {
            return false;
          }
          var parameter = {
              treegrid: self,
              keyCode: key,
              row: {
                index: self._grid.getDataRow(self._grid.getCurrent().itemIndex)
              },
              cell: {
                field: self._grid.getCurrent().column
              },
              ctrl: ctrl,
              shift: shift,
              alt: alt
            },event = $.Event("keyDown", parameter);
          self.$element.trigger(event);
          if (event.isDefaultPrevented()) {
            return false;
          }
          if (self._grid.getCheckBar().visible && self._grid.isCheckable(self._grid.getItemIndex(self.select())) && key === 32) {
            if (self._grid.isCheckedRow(self.select())) {
              self._grid.checkRow(self.select(), false, false);
            } else {
              self._grid.checkRow(self.select(), true, false);
            }
            return false;
          }
          var current = self._grid.getCurrent(),rowIndex = self._grid.getDataRow(current.itemIndex),rowData = self.dataItem(rowIndex),editParams = {
              grid: self,
              row: {
                index: rowIndex,
                data: rowData
              },
              cell: {
                field: ""
              }
            };
          if ($.type(self.options.editSkip) !== "undefined" && self.options.editSkip) {
            var disPlayColumn = self.options.displayColumns,i = 0,column,index = 0;
            $.each(disPlayColumn, function (idx, column2) {
              if (column2.field === current.column) {
                index = idx;
              }
            });
            if (key === 13 || !shift && key === 9) {
              for (var j = current.itemIndex; j < self._grid.getItemCount(); j += 1) {
                editParams.row.index = rowIndex;
                editParams.row.data = self.dataItem(self._grid.getDataRow(j));
                for (i = index + 1; i < disPlayColumn.length; i += 1) {
                  editParams.cell.field = disPlayColumn[i].fieldName;
                  column = self.columns[disPlayColumn[i].fieldName];
                  var condition;
                  if (column.editable) {
                    condition = $.type(self.options.rowEditable) !== "undefined" ? !column.editor.flag ? !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable")) || !($.type(self.options.rowEditable) === "function" ? self.options.rowEditable.call(self, editParams) : self.options.rowEditable) : !self.options.rowEditable.call(self, editParams) : !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable"));
                  } else {
                    condition = true;
                  }
                  if (!condition) {
                    if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                      self._grid.setCurrent({
                        itemIndex: j,
                        columns: column.fieldName,
                        dataRow: j,
                        fieldIndex: i,
                        fieldName: column.fieldName
                      });
                      return false;
                    }
                  } else if (i === disPlayColumn.length && j === self._grid.getItemCount() - 1) {
                    if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                      self.commitCell();
                      return false;
                    }
                  }
                }
                index = -1;
              }
            } else if (key === 39 && index !== disPlayColumn.length - 1) {
              for (i = index + 1; i < disPlayColumn.length; i += 1) {
                editParams.cell.field = disPlayColumn[i].fieldName;
                column = self.columns[disPlayColumn[i].fieldName];
                var condition;
                if (column.editable) {
                  condition = $.type(self.options.rowEditable) !== "undefined" ? !column.editor.flag ? !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable")) || !($.type(self.options.rowEditable) === "function" ? self.options.rowEditable.call(self, editParams) : self.options.rowEditable) : !self.options.rowEditable.call(self, editParams) : !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable"));
                } else {
                  condition = true;
                }
                if (!condition) {
                  if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                    self._grid.setCurrent({
                      itemIndex: self._grid.getCurrent().itemIndex,
                      columns: column.fieldName,
                      dataRow: self._grid.getCurrent().dataRow,
                      fieldIndex: i,
                      fieldName: column.fieldName
                    });
                    return false;
                  } else if (i === disPlayColumn.length - 1) {
                    if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                      return false;
                    }
                  }
                } else if (i === disPlayColumn.length - 1) {
                  return false;
                }
              }
            } else if (key === 37 && index !== 0) {
              for (i = index - 1; i >= 0; i -= 1) {
                editParams.cell.field = disPlayColumn[i].fieldName;
                column = self.columns[disPlayColumn[i].fieldName];
                var condition;
                if (column.editable) {
                  condition = $.type(self.options.rowEditable) !== "undefined" ? !column.editor.flag ? !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable")) || !($.type(self.options.rowEditable) === "function" ? self.options.rowEditable.call(self, editParams) : self.options.rowEditable) : !self.options.rowEditable.call(self, editParams) : !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable"));
                } else {
                  condition = true;
                }
                if (!condition) {
                  if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                    self._grid.setCurrent({
                      itemIndex: self._grid.getCurrent().itemIndex,
                      columns: column.fieldName,
                      dataRow: self._grid.getCurrent().dataRow,
                      fieldIndex: i,
                      fieldName: column.fieldName
                    });
                    return false;
                  } else if (i === 0) {
                    if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                      return false;
                    }
                  }
                } else if (i === 0) {
                  return false;
                }
              }
            }
          }
          if (shift && key === 9) {
            if (self.options.editSkip) {
              for (var row = self._grid.getItemIndex(rowIndex); row >= 0; row -= 1) {
                editParams.row.index = row;
                editParams.row.data = self.dataItem(self._grid.getDataRow(row));
                for (i = index - 1; i >= 0; i -= 1) {
                  editParams.cell.field = disPlayColumn[i].field;
                  column = self.columns[disPlayColumn[i].fieldName];
                  var condition;
                  if (column.editable) {
                    condition = $.type(self.options.rowEditable) !== "undefined" ? !column.editor.flag ? !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable")) || !($.type(self.options.rowEditable) === "function" ? self.options.rowEditable.call(self, editParams) : self.options.rowEditable) : !self.options.rowEditable.call(self, editParams) : !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable"));
                  } else {
                    condition = true;
                  }
                  if (!condition) {
                    if (column.editor && $.type(column.editor.editable) === "function" && column.editor.editable.call(self, editParams)) {
                      if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                        self._grid.setCurrent({
                          itemIndex: row,
                          fieldName: column.fieldName
                        });
                        return false;
                      }
                    } else if (column.editor && $.type(column.editor.editable) === "boolean") {
                      if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                        self._grid.setCurrent({
                          itemIndex: row,
                          fieldName: column.fieldName
                        });
                        return false;
                      }
                    }
                  }
                }
                index = self.options.displayColumns.length;
              }
            }
          }
        };
        self._grid.onKeyUp = function (treeGrid, key, ctrl, shift, alt) {
          var params = {
            grid: self,
            row: {
              index: self._grid.getCurrent().dataRow,
              data: self.dataItem(self._grid.getCurrent().dataRow)
            },
            cell: {
              field: self._grid.getCurrent().column,
              data: self.getCellValue(self._grid.getCurrent().dataRow, self._grid.getCurrent().column)
            },
            keyCode: key,
            ctrl: ctrl,
            shift: shift,
            alt: alt
          };
          var event = $.Event("keyUp", params);
          self.$element.trigger(event);
          if (key === 37 || key === 38 || key === 39 || key === 40) {
            if (dews.ui.page.option === void 0 && dews.ui.page.useGridNote === "Y") {
              self._grid.onSelectionEnded.call(self, self._grid);
            }
          }
        };
        self._grid.onTreeItemExpanding = function (treeGrid, itemIndex, rowId) {
          var params = {
            treegrid: self,
            row: {
              index: itemIndex + 1,
              data: self.dataItem(rowId)
            }
          };
          var event = new $.Event("expanding", params);
          self.$element.trigger(event);
        };
        self._grid.onTreeItemExpanded = function (treeGrid, itemIndex, rowId) {
          var newIndex = self._grid.getCurrent(),columns = self.columns[newIndex.fieldName];
          var filterArr;
          if (treeGrid.getColumnProperty(newIndex.column, "editor") && newIndex.fieldIndex !== -1 && self.dataItem(self.select())) {
            if (columns && columns.editor && columns.editor.editable && self.options.dataSource) {
              var editor,visible,parameter = {
                  treegrid: self,
                  row: {
                    index: self.select(),
                    data: self.dataItem(self.select())
                  },
                  cell: {
                    field: newIndex.fieldName
                  }
                };
              if (newIndex && newIndex.fieldName) {
                filterArr = self._grid.getActiveColumnFilters(newIndex.fieldName, true);
              } else {
                filterArr = null;
              }
              if ($.type(treeGrid.getSortedFields()) !== "null" || filterArr && filterArr.length > 0) {
                parameter.row.index = newIndex.itemIndex;
                parameter.row.data = self._grid.getValues(newIndex.itemIndex);
              }
              if ($.type(columns.editor.editable) === "function") {
                editor = columns.editor.editable.call(self, parameter);
              } else {
                editor = columns.editor.editable;
              }
              if (columns.editor.type.toLowerCase() === "codepicker") {
                visible = "visible";
                if (!editor) {
                  visible = "hidden";
                }
                columns.buttonVisibility = visible;
                self._grid.setColumnProperty(columns.name, "buttonVisibility", visible);
              }
              if (!editor) {
                self._grid.addCellStyle(
                "editable",
                {
                  editable: false
                },
                true);

                self._grid.setCellStyles(newIndex.dataRow, newIndex.fieldName, "editable");
              }
            }
          }
          var params = {
            treegrid: self,
            row: {
              index: itemIndex + 1,
              data: self.dataItem(rowId)
            }
          };
          var event = new $.Event("expanded", params);
          self.$element.trigger(event);
        };
        self._grid.onTreeItemCollapsing = function (treeGrid, itemIndex, rowId) {
          var params = {
            treegrid: self,
            row: {
              index: itemIndex + 1,
              data: self.dataItem(rowId)
            }
          };
          var event = new $.Event("collapsing", params);
          self.$element.trigger(event);
        };
        self._grid.onTreeItemCollapsed = function (treeGrid, itemIndex, rowId) {
          var params = {
            treegrid: self,
            row: {
              index: itemIndex + 1,
              data: self.dataItem(rowId)
            }
          };
          var event = new $.Event("collapsed", params);
          self.$element.trigger(event);
        };
        self._grid.setPasteOptions({
          eventEachRow: true
        });
        self._grid.onEditRowPasted = function (grid2, itemIndex, dataRow, fields, oldValues, newValues) {
          var className = ".dews-ui-treegrid";
          newValues = newValues.filter(function (value) {return value !== void 0;});
          var isCell = true;
          var copyData = self.clipboard.copyData;
          if (copyData.length < 2) {
            copyData = copyData.toString().split("\n");
          }
          self.clipboard.length = copyData.length;
          if (fields.length > 1 || copyData.length > 1) {
            isCell = false;
          }
          for (var i = 0; i < fields.length; i++) {
            var _newValues = newValues.slice(i, i + 1),fieldName = grid2._dataSource.getOrgFieldName(fields[i]),fieldIndex = fields[i];
            dews.ui.gridUtil.onEditRowPasted(self, itemIndex, fieldName, fieldIndex, _newValues, className, isCell);
          }
        };
        self._grid.onCopy = function (grid2, range, event) {
          self.clipboard = {
            grid: self,
            itemIndex: {
              start: range.startItem,
              end: range.endItem
            },
            column: {
              start: range.startColumn,
              end: range.endColumn
            },
            values: self._grid.getSelectionData()
          };
        };
        self._grid.onPaste = function (grid2, index, event) {
          var getText = $.type(event.clipboardData) === "undefined" ? window.clipboardData.getData("Text") : event.clipboardData.getData("Text");
          var checkLastNewLine = getText.substr(getText.length - 2) === "\r\n";
          if (checkLastNewLine) {
            getText = getText.substring(0, getText.length - 2);
          }
          var doubleData = getText.split("\r\n");
          for (var i = 0; i < doubleData.length; i++) {
            doubleData[i] = doubleData[i].split("	");
          }
          var pastingParams = {
            treegrid: self,
            copyData: doubleData,
            start: {
              index: index.dataRow,
              column: index.column
            }
          };
          self.clipboard = {
            copyData: doubleData,
            cnt: 0
          };
          var pastingEvent = new $.Event("pasting", pastingParams);
          self.$element.trigger(pastingEvent);
          if (pastingEvent.isDefaultPrevented()) {
            return false;
          }
          var returnValue = dews.ui.gridUtil.onPaste(self, index, event);
          return returnValue;
        };
        self._grid.onColumnHeaderClicked = function (grid2, column, rightClicked) {
          var parameter = {
            treegrid: self,
            cell: {
              field: column.fieldName
            }
          };
          var headerClicked = new $.Event("headerClicked", parameter);
          self.$element.trigger(headerClicked);
        };
        self._grid.onColumnCheckedChanged = function (grid2, column, check) {
          var params = {
              treegrid: self,
              cell: {
                field: column.fieldName
              },
              checked: check
            },i = 0,data = self.options.dataSource;
          if (column.editorOptions && column.editorOptions.type.toLowerCase() === "check") {
            var dataItems = self.sortDataItems(),rowCount = dataItems.length,userColumn = findUserOptionsColumn(self.userOptions.columns, column.fieldName),checkValue = check;
            if (check && column.editorOptions && column.editorOptions.trueValue) {
              checkValue = column.editorOptions.trueValue;
            } else if (!check && column.editorOptions && column.editorOptions.falseValue) {
              checkValue = column.editorOptions.falseValue;
            }
            self.options.dataSource.dataProvider.beginUpdate();
            try {
              for (i = 0; i < rowCount; i++) {
                var editParams = {
                  grid: self,
                  row: {
                    index: i + 1,
                    data: dataItems[i]
                  },
                  cell: {
                    field: column.fieldName
                  }
                };
                var cellEditable = true;
                if (self.options.rowEditable !== void 0) {
                  cellEditable = self.options.rowEditable.call(self, editParams);
                }
                if (userColumn !== void 0 && userColumn !== null) {
                  if (cellEditable && userColumn.editable === false) {
                    cellEditable = false;
                  }
                  if (cellEditable && userColumn.editor !== void 0 && typeof userColumn.editor.editable === "function") {
                    cellEditable = userColumn.editor.editable.call(self, editParams);
                  }
                  if (cellEditable && userColumn.editor !== void 0 && typeof userColumn.editor.editable === "boolean" && userColumn.editor.editable === false) {
                    cellEditable = false;
                  }
                }
                if (cellEditable) {
                  self._grid.setValue(i, column.fieldName, checkValue);
                }
              }
            } finally {
              self.options.dataSource.dataProvider.endUpdate(false);
            }
          }
          var event = $.Event("columnHeaderCheck", params);
          self.$element.trigger(event);
        };
        self._grid.onPasted = function (grid2) {
          var start,end,rows = [],result,columns = [],isSelectionColumn = false,startColumn,endColumn,selectionColumns;
          selectionColumns = self._grid.getSelection();
          start = selectionColumns !== null ? selectionColumns.startItem : self._grid.getCurrent().itemIndex;
          end = selectionColumns !== null ? selectionColumns.endItem : self._grid.getCurrent().itemIndex;
          startColumn = selectionColumns !== null ? selectionColumns.startColumn : "";
          endColumn = selectionColumns !== null ? selectionColumns.endColumn : "";
          for (var i = start; i <= end; i++) {
            rows.push(self._grid.getDataRow(i));
          }
          if (selectionColumns === null) {
            columns.push(self._grid.getCurrent().fieldName);
          } else {
            var displayColumns = self._grid.getDisplayColumns();
            result = getSelectionColumns2(displayColumns, startColumn, endColumn, isSelectionColumn);
            columns = result.columns;
          }
          if (self.options.copyMode === "row") {
            $.each(rows, function (index, row) {
              $.each(columns, function (idx, column) {
                var editParams = {
                  grid: self,
                  row: {
                    index: row,
                    data: self.dataItem(row)
                  },
                  cell: {
                    field: column,
                    data: self.getCellValue(row, column)
                  }
                };
                if (!self.columns[column].editable || $.type(self.columns[column].editor.editable) === "function" && !self.columns[column].editor.editable.call(self, editParams)) {
                }
              });
            });
          }
          var eventParameter = {
            treegrid: self,
            columns: columns,
            rows: rows
          };
          self._grid.commit();
          var pastedEvent = new $.Event("pasted", eventParameter);
          self.$element.trigger(pastedEvent);
        };
        if (self.options.dataSource && self.options.dataSource.dataProvider) {
          self.options.dataSource.dataProvider.onRowAdded = function (dataProvider, rowId) {
            self.expand(rowId, false);
            self._grid.setCurrent({
              itemIndex: self._grid.getItemIndex(rowId),
              column: self._grid.getCurrent().column,
              dataRow: rowId
            });
          };
        }
        self.$element.on("dataBound", function (e) {
          if (self.options.dataBound && $.type(self.options.dataBound) === "function" && e.treegrid) {
            self.options.dataBound.call(self, e);
          }
        });
        self.$element.on("changing", function (e) {
          if (self.options.changing && $.type(self.options.changing) === "function" && e.treegrid) {
            self.options.changing.call(self, e);
          }
        });
        self.$element.on("change", function (e) {
          if (self.options.change && $.type(self.options.change) === "function" && e.treegrid) {
            self.options.change.call(self, e);
          }
        });
        self.$element.on("rowAdd", function (e) {
          if (self.options.rowAdd && $.type(self.options.rowAdd) === "function" && e.treegrid) {
            self.options.rowAdd.call(self, e);
          }
        });
        self.$element.on("rowRemove", function (e) {
          if (self.options.rowRemove && $.type(self.options.rowRemove) === "function" && e.treegrid) {
            self.options.rowRemove.call(self, e);
          }
        });
        self.$element.on("save", function (e) {
          if (self.options.save && $.type(self.options.save) === "function" && e.treegrid) {
            self.options.save.call(self, e);
          }
        });
        self.$element.on("validationCheck", function (e) {
          if (self.options.validationCheck && $.type(self.options.validationCheck) === "function" && e.treegrid) {
            self.options.validationCheck.call(self, e);
          }
        });
        self.$element.on("cellEditing", function (e) {
          if (self.options.cellEditing && $.type(self.options.cellEditing) === "function" && e.treegrid) {
            self.options.editValue = self.options.cellEditing.call(self, e);
          }
        });
        self.$element.on("selected", function (e) {
          if (self.options.selected && $.type(self.options.selected) === "function" && e.treegrid) {
            self.options.selected.call(self, e);
          }
        });
        self.$element.on("clicked", function (e) {
          if (self.options.clicked && $.type(self.options.clicked) === "function" && e.treegrid) {
            self.options.clicked.call(self, e);
          }
        });
        self.$element.on("dblClicked", function (e) {
          if (self.options.dblClicked && $.type(self.options.dblClicked) === "function" && e.treegrid) {
            self.options.dblClicked.call(self, e);
          }
        });
        self.$element.on("keyDown", function (e) {
          if (self.options.keyDown && $.type(self.options.keyDown) === "function" && e.treegrid) {
            self.options.keyDown.call(self, e);
          }
        });
        self.$element.on("headerClicked", function (e) {
          if (self.options.headerClicked && $.type(self.options.headerClicked) === "function" && e.treegrid) {
            self.options.headerClicked.call(self, e);
          }
        });
        self.$element.on("codedialog", function (e) {
          if (self.options.codedialog && $.type(self.options.codedialog) === "function") {
            self.options.codedialog.call(self, e);
          }
        });
        self.$element.on("columnHeaderCheck", function (e) {
          if (self.options.columnHeaderCheck && $.type(self.options.columnHeaderCheck) === "function") {
            self.options.columnHeaderCheck.call(self, e);
          }
        });
        self.$element.on("keyUp", function (e) {
          if (self.options.keyUp && $.type(self.options.keyUp) === "function") {
            self.options.keyUp.call(self, e);
          }
        });
        self.$element.on("pasted", function (e) {
          if (self.options.pasted && $.type(self.options.pasted) === "function" && e.treegrid) {
            self.options.pasted.call(self, e);
          }
        });
        self.$element.on("pasting", function (e) {
          if (self.options.pasting && $.type(self.options.pasting) === "function" && e.treegrid) {
            self.options.pasting.call(self, e);
          }
        });
        self.$element.on("mouseup", function (e) {
          if (e.altKey && self.options.useSimpleCalculator !== false) {
            dews.ui.gridUtil.openSimpleCalculatorDialog(self);
          }
        });
        self.$element.on("filtered", function (e) {
          if (self.options.filtered && $.type(self.options.filtered) === "function" && e.treegrid) {
            self.options.filtered.call(self, e);
          }
        });
        self.$element.on("expanding", function (e) {
          if (self.options.expanding && $.type(self.options.expanding) === "function" && e.treegrid) {
            self.options.expanding.call(self, e);
          }
        });
        self.$element.on("expanded", function (e) {
          if (self.options.expanded && $.type(self.options.expanded) === "function" && e.treegrid) {
            self.options.expanded.call(self, e);
          }
        });
        self.$element.on("collapsing", function (e) {
          if (self.options.collapsing && $.type(self.options.collapsing) === "function" && e.treegrid) {
            self.options.collapsing.call(self, e);
          }
        });
        self.$element.on("collapsed", function (e) {
          if (self.options.collapsed && $.type(self.options.collapsed) === "function" && e.treegrid) {
            self.options.collapsed.call(self, e);
          }
        });
        function windowScroll(e) {
          if ($(e.target).closest(document.body).length !== 0) {
            self.commitCell();
          }
        }
        function noteMain(treeGrid, dataIndex) {
          if (dataIndex === null || dataIndex < 0) {
            return null;
          }
          var disabledRows = self._gridNote.disabledRow;
          var disabled = false;
          if (disabledRows) {
            if (typeof disabledRows === "number") {
              disabled = disabledRows === dataIndex ? true : false;
            } else {
              disabled = disabledRows.indexOf(dataIndex) !== -1;
            }
          }
          var itemIndex = self.getItemIndexFromDataIndex(dataIndex);
          var noteOpt = self.options.note;
          var key;
          if (self.getRowState(itemIndex) === "added" || !noteOpt || disabled) {
            key = {
              gridNoteKey: "",
              gridCode: "",
              menuCode: "",
              userInfo: {
                insertId: "",
                insertIp: "",
                insertDate: "",
                updateId: "",
                updateIp: "",
                updateDate: ""
              }
            };
          } else {
            var selectRowDS = treeGrid._dataSource.getJsonRow(dataIndex);
            var noteKey = dews.ui.gridUtil._getGridNoteInfo(self, dataIndex);
            key = {
              gridNoteKey: noteKey.gridNoteKey,
              gridCode: noteKey.gridCode,
              menuCode: noteKey.menuCode,
              userInfo: {
                insertId: selectRowDS.INSERT_ID,
                insertIp: selectRowDS.INSERT_IP,
                insertDate: selectRowDS.INSERT_DTS,
                updateId: selectRowDS.UPDATE_ID,
                updateIp: selectRowDS.UPDATE_IP,
                updateDate: selectRowDS.UPDATE_DTS
              }
            };
          }
          dews.ui.page.gridNote.setGridNoteData(self, key);
        }
        $(window).on("click", function (e) {
          var target = $(e.target).closest(".dews-ui-treegrid"),treeGrid = self.$element.closest(".dews-ui-treegrid"),inTreeGrid = false;
          if (treeGrid.length !== 0 && treeGrid.offset().left - window.pageXOffset < e.clientX && treeGrid.offset().left + treeGrid.width() - window.pageXOffset > e.clientX && treeGrid.offset().top - window.pageYOffset < e.clientY && treeGrid.offset().top + treeGrid.height() - window.pageYOffset > e.clientY) {
            inTreeGrid = true;
          }
          if ($(e.target).closest(document.body).length === 0) {
            inTreeGrid = true;
          }
          if (target.length === 0 && !inTreeGrid) {
            self.commitCell();
            self.editable = false;
          }
          if (target.length !== 0 && target.children().attr("ID") !== self._grid.name) {
            self.commitCell();
            self.editable = false;
          }
        });
        self.$element.on("click", function (e) {
          var grid2 = self.options.$content.find(".dews-ui-treegrid");
          if (e.target.tagName !== "INPUT" && e.target.tagName !== "TEXTAREA" && self._grid.mouseToIndex(e.offsetX, e.offsetY).itemIndex === -1) {
            self.commitCell();
            self.editable = false;
          }
        });
        self.$element.on("keyDown", function (e) {
          if (self.options.columns) {
            var column = self.columns[self._grid.getCurrent().fieldName];
            if (column && column.editor) {
              if (column.editor.type.toLowerCase() === "codepicker" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (column.codeOption.validation) {
                  if ($.type(column.codeOption.value[self._grid.getCurrent().itemIndex]) === "undefined") {
                    var currentValue2 = self._grid.getValue(
                    self._grid.getCurrent().itemIndex,
                    column.fieldName);

                    column.codeOption.value[self._grid.getCurrent().itemIndex] = dews.ui.gridUtil._codeOptionValue("", "", currentValue2);
                  }
                }
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
                if (e.keyCode === 13 && $.type(self._grid.getEditValue()) !== "undefined" && self._grid.getEditValue() !== "") {
                  self.commitCell();
                  e.preventDefault();
                }
              }
              if (self._grid._gv._editController._editor && column.editor.type.toLowerCase() === "date") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1 && self._grid.getColumnProperty(column.fieldName, "editable")) {
                  self.editCell();
                  self._grid._gv._editController._editor.dropDown();
                  e.stopPropagation();
                  e.preventDefault();
                }
                if (e.keyCode === 13 && self._grid._gv._editController._editor._datetimeFormat && self._grid.getEditValue() === self._grid._gv._editController._editor._datetimeFormat.replace(/[A-z]/gi, "_") && ($.type(self._grid.getValue(self._grid.getCurrent().itemIndex, self.getCurrentColumn())) === "undefined" || self._grid.getValue(self._grid.getCurrent().itemIndex, self.getCurrentColumn()) === null)) {
                  self.closeCell();
                  self._grid.setValue(self._grid.getCurrent().itemIndex, self.getCurrentColumn(), new Date());
                }
              }
              if (column.editor.type.toLowerCase() === "number") {
                if (e.keyCode === 107) {
                  if ($.type(self._grid.getEditValue()) !== "undefined") {
                    e.preventDefault();
                    var currentValue = self._grid.getEditValue().replace(/,/g, ""),resultValue = 0;
                    if (column.editor.increaseType === "plus") {
                      resultValue = parseFloat(currentValue) + parseFloat(column.editor.increaseValue);
                    } else {
                      resultValue = parseFloat(currentValue) * parseFloat(column.editor.increaseValue);
                    }
                    self.$element.find("#" + self._grid.name + "_number").val(dews.number.format(resultValue.toString(), column.editor.format));
                    self._grid._gv._editController.onEditorChange.call(
                    self._grid._gv._editController,
                    self._grid._gv._editController._editIndex);

                  } else {
                    e.preventDefault();
                    self._grid.showEditor();
                  }
                }
              }
              if (self._grid._gv._editController._editor && column.editor.type.toLowerCase() === "dropdown") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1 && self._grid.getColumnProperty(column.fieldName, "editable")) {
                  self.editCell();
                  self._grid._gv._editController._editor.dropDown();
                  e.stopPropagation();
                  e.preventDefault();
                }
                if (self._grid._gv._editController._editor.isVisible() && column.editor.textReadOnly && column.editor.useNumkey) {
                  if (e.keyCode >= 49 && e.keyCode <= 57 || e.keyCode >= 97 && e.keyCode <= 105) {
                    var number = e.keyCode >= 49 && e.keyCode <= 57 ? e.keyCode - 49 : e.keyCode - 97;
                    if (column.editor && column.editor.dataSelectable) {
                      if (column.editor.values.length > number) {
                        self.setCellValue(
                        self.select(),
                        column.fieldName,
                        column.editor.values[number]);

                        e.preventDefault();
                      }
                    } else {
                      if (column.values.length > number) {
                        self.setCellValue(self.select(), column.fieldName, column.values[number]);
                        e.preventDefault();
                      }
                    }
                  }
                }
              }
              if (column.editor.type.toLowerCase() === "zipcodepicker" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
              }
              if (column.editor.type.toLowerCase() === "month" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
                if (e.keyCode === 13) {
                  if (self._grid._gv._editController._editor._datetimeFormat && self._grid.getEditValue() === self._grid._gv._editController._editor._datetimeFormat.replace(/[A-z]/gi, "_") && ($.type(
                  self._grid.getValue(self._grid.getCurrent().itemIndex, self.getCurrentColumn())) ===
                  "undefined" || self._grid.getValue(self._grid.getCurrent().itemIndex, self.getCurrentColumn()) === null)) {
                    self.commitCell();
                    self.setCellValue(self.select(), self.getCurrentColumn(), new Date());
                  } else if (column.monthpicker.dateView._value && column.monthpicker.dateView._value.toString() !== column.monthpicker.dateView._current.toString()) {
                    self.commitCell();
                    self.setCellValue(
                    self.select(),
                    self.getCurrentColumn(),
                    new Date(column.monthpicker.dateView._current));

                  }
                }
                if (e.keyCode < 41 && e.keyCode > 36 && $.type(self._grid.getEditValue()) !== "undefined") {
                  e.preventDefault();
                  column.monthpicker.kendoInstance._keydown(e);
                }
              }
              if (column.editor.type.toLowerCase() === "year" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
                if (e.keyCode === 13) {
                  if (self._grid._gv._editController._editor._datetimeFormat && self._grid.getEditValue() === self._grid._gv._editController._editor._datetimeFormat.replace(/[A-z]/gi, "_") && ($.type(
                  self._grid.getValue(self._grid.getCurrent().itemIndex, self.getCurrentColumn())) ===
                  "undefined" || self._grid.getValue(self._grid.getCurrent().itemIndex, self.getCurrentColumn()) === null)) {
                    self.commitCell();
                    self.setCellValue(self.select(), self.getCurrentColumn(), new Date());
                    column.yearpicker.kendoInstance._keydown(e);
                  } else if (column.yearpicker.dateView._value && column.yearpicker.dateView._value.toString() !== column.yearpicker.dateView._current.toString()) {
                    self.commitCell();
                    self.setCellValue(
                    self.select(),
                    self.getCurrentColumn(),
                    new Date(column.yearpicker.dateView._current));

                    column.yearpicker.kendoInstance._keydown(e);
                  }
                }
                if (e.keyCode < 41 && e.keyCode > 36 && $.type(self._grid.getEditValue()) !== "undefined") {
                  e.preventDefault();
                  column.yearpicker.kendoInstance._keydown(e);
                }
              }
              if (column.editor.type.toLowerCase() === "time" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
                if (e.keyCode === 13) {
                  column.timepicker.kendoInstance._keydown(e);
                  self.commitCell();
                }
                if (e.keyCode < 41 && e.keyCode > 36 && $.type(self._grid.getEditValue()) !== "undefined") {
                  e.preventDefault();
                  column.timepicker.kendoInstance._keydown(e);
                }
              }
            }
          }
        });
        self._grid._gv._container._defaultTool._checkCellClicked = function (cell, event) {
          var grid2 = this.grid();
          var dewsGrid = $(grid2._container._containerDiv).closest(".dews-data-control").data("dews-control");
          if (grid2.editOptions().isCheckable()) {
            var checkBar = grid2.checkBar();
            var item = cell.item();
            if (event && event.shiftKey && this._prevCheckIndex && !checkBar.isExclusive() && dewsGrid.options.shiftCheck) {
              var prevItem = this._prevCheckIndex.item();
              var idx1 = Math.min(prevItem._index, item._index),idx2 = Math.max(prevItem._index, item._index),itemIndicies = [];
              for (var idx = idx1; idx <= idx2; idx++) {
                item = grid2.getItem(idx);
                item.isCheckable() && item.dataRow() >= 0 && itemIndicies.push(item);
              }
              itemIndicies.length > 0 && grid2.itemSource().checkItems(itemIndicies, prevItem.isChecked(), true);
            } else {
              if (item.isCheckable() && (checkBar.isShowGroup() || item.dataRow() >= 0)) {
                grid2.makeItemVisible(item.index());
                grid2.itemSource().checkItem(item, !item.isChecked(), checkBar.isExclusive(), true);
              }
            }
          }
        };
        if (dews.ui.page.onegridData && dews.ui.page.onegridData.editable) {
          self.$element.find(".dews-grid-edit-button").on("click", function (e) {
            var fixedOptions = self._grid.getFixedOptions();
            var fixedColumns = dews.ui.gridUtil.getFixedColumns(self);
            self._onegrid.fixed = {
              colCount: fixedOptions.colCount,
              rightColCount: fixedOptions.rightColCount,
              leftColumns: fixedColumns.leftColumns,
              rightColumns: fixedColumns.rightColumns
            };
            self._onegrid.loadColumns = dews.ui.gridUtil.setOnegridDialogColumns(self, self._onegrid.loadColumns);
            var dlg = new ColumnDialog(self);
            dlg.columnDialog.open();
          });
        }
        self._grid._gv._clipboardManager.$_convertValue = dews.ui.gridUtil.extend__$_convertValue(
        self._grid._gv._clipboardManager.$_convertValue);

      } }]);return TreeGridEvent;}(Event);

  function getSelectionColumns2(cols, start, end, isSelectionColumn) {
    var result = {
      columns: [],
      isSelectionColumn: isSelectionColumn
    };
    for (var i = 0; i < cols.length; i++) {
      var col = cols[i];
      isSelectionColumn = !isSelectionColumn && start === col ? true : isSelectionColumn;
      if (col.columns) {
        var c = getSelectionColumns2(col.columns, start, end, isSelectionColumn);
        isSelectionColumn = c.isSelectionColumn;
        var column = {
          field: col.name,
          columns: c.columns
        };
        if (c.columns.length > 0) {
          result.columns.push(column);
        }
      } else if (isSelectionColumn) {
        result.columns.push(col);
      }
      isSelectionColumn = isSelectionColumn && end === col ? false : isSelectionColumn;
    }
    result.isSelectionColumn = isSelectionColumn;
    return result;
  }

  // src/js/grid/base/gridBase.js
  var GRID = "GRID";
  var TREE_GRID = "TREEGRID";
  var DewsGrid = /*#__PURE__*/function () {"use strict";



    function DewsGrid($element) {_classCallCheck(this, DewsGrid);_defineProperty(this, "_grid", void 0);_defineProperty(this, "gridType", void 0);_defineProperty(this, "event", void 0);
      this.selector = $element;
      this.id = $element.attr("ID");
    }_createClass(DewsGrid, [{ key: "initializeGrid", value:
      function initializeGrid() {
        this.gridType = GRID;
        this.event = new GridEvent(this);
        Object.setPrototypeOf(DewsGrid.prototype, GridAPI.prototype);
      } }, { key: "initializeTreeGrid", value:
      function initializeTreeGrid() {
        this.gridType = TREE_GRID;
        this.event = new TreeGridEvent(this);
        Object.setPrototypeOf(DewsGrid.prototype, TreeGridAPI.prototype);
      } }, { key: "controlAuthority", value:
      function controlAuthority(options) {
        if (dews.ui.dialogPage) {
          return;
        }
        if (dews.ui.page) {var _dews$ui$page$control;
          var gridAuthority = (_dews$ui$page$control = dews.ui.page.controlAuthority) === null || _dews$ui$page$control === void 0 ? void 0 : _dews$ui$page$control.grid;
          if (gridAuthority) {
            var id = this.id;
            var mainGrid = gridAuthority[id];
            if (mainGrid) {
              setAuthColumn(mainGrid, options.columns);
            }
          }
        }
        function setAuthColumn(mainGrid, columns) {
          $.each(columns, function (idx, column) {
            if (mainGrid[column.field]) {
              $.extend(true, column, mainGrid[column.field]);
            }
            if ($.type(column.columns) !== "undefined") {
              setAuthColumn(mainGrid, column.columns);
            }
          });
        }
      } }, { key: "useCssStyle", value:
      function useCssStyle() {
        var self = this;
        self._grid.setEditorOptions({
          useCssStylePopupMenu: true,
          useCssStyleDropDownList: true
        });
        self._grid.setDisplayOptions({ useCssStyleProgress: true });
      } }]);return DewsGrid;}();

  DewsGrid.prototype._bindEvent = function () {
    this.event.initialize();
  };
  DewsGrid.prototype._setOneGridData = function () {
    var self = this;
    var oneGridData = dews.ui.page.onegridData;
    setTimeout(function () {
      if (oneGridData && self._onegrid._onegrid) {
        if (self._onegrid.loadData) {
          self._onegrid.loadColumns = dews.ui.gridUtil.setDisplayIndexColumns(
          self,
          self.options.columns,
          self._onegrid.loadData);

        } else {
          self._onegrid.loadColumns = dews.ui.gridUtil.setDisplayColumns(self, self._grid.getDisplayColumns());
        }
      }
    });
  };
  DewsGrid.prototype._getOptionsThatConvertColumns = function (column, opt2, grid2) {
    if (this.gridType === "GRID") {
      return customizingColumn(column, opt2, grid2);
    }
    return treeCustomizingColumn(column, opt2, grid2);
  };
  DewsGrid.prototype._createOneGridButton = function (element) {
    var oneGridData = dews.ui.page.onegridData;
    var id = this.id;
    if (oneGridData !== null && oneGridData !== void 0 && oneGridData.editable && id !== "__filter_layer_grid__") {
      var $columnDialogBtn = $("<button class=\"dews-grid-edit-button\" type=\"button\">\n                    <span class=\"ico-edit\"></span>Edit\n                  </button>");




      element.prepend($columnDialogBtn);
    }
  };
  DewsGrid.prototype._initOneGrid = function () {
    var self = this;
    var id = this.id;
    var selector = this.selector;
    var oneGridData = dews.ui.page.onegridData;
    var gridType = this.gridType;
    self.userOptions._dewsGridID = id;
    if (oneGridData) {
      if (!self._onegrid) {
        self._onegrid = {};
      }
      self._onegrid.editType = oneGridData.editType;
      self._onegrid.baseColumns = $.extend(true, [], self.userOptions.columns);
      self._onegrid._gridID = id;
      if (dews.ui.dialogPage && selector.closest(dews.ui.dialogPage.$content).length) {
        self._onegrid._onegridType = "D_" + gridType;
        var dlgID = dews.ui.dialogPage.id;
        if (id.indexOf(dlgID) < 0) {
          self._onegrid._gridID = dlgID + "-" + id;
        }
      } else {
        self._onegrid._onegridType = gridType;
      }
      self._onegrid._gridType = gridType;
      if (oneGridData.editable || Array.isArray(oneGridData.items)) {
        dews.ui.gridUtil.notExistFieldNaming(self._onegrid.baseColumns, 1);
      }
      if (oneGridData.editable) {
        dews.ui.gridUtil.initOneGridOptions(self, oneGridData, self.userOptions);
        self._onegrid._onegrid = true;
      } else {
        if (Array.isArray(oneGridData.items)) {
          var isGrid = oneGridData.items.some(function (oneGridItems) {
            return oneGridItems.type === self._onegrid._onegridType && oneGridItems.id === self._onegrid._gridID;
          });
          if (isGrid) {
            dews.ui.gridUtil.initOneGridOptions(self, oneGridData, self.userOptions);
            self._onegrid._onegrid = true;
          } else {
            self._onegrid._onegrid = false;
          }
        }
      }
    }
  };

  // src/js/grid/column/ColumnRenderer.js
  function ColumnRenderer() {
  }
  ColumnRenderer.prototype.getBarRenderer = function (column) {
    if (!column)
    return null;
    var f = column.formats;
    if (!f)
    return null;
    var styleCreator = dews.ui.grid.StyleCreator.getInstance();
    var defaultMinimum = 0;
    var defaultMaximum = 100;
    var defaultShowLabel = true;
    var defaultStartingPoint = "left";
    var defaultColor = styleCreator.gridStyle.themeColorLight1;
    var defaultAngle = 0;
    var defaultTextAlignment = "center";
    var defaultLineAlignment = "middle";
    var defaultPadding = 6;
    var defaultSize = "100%";
    var ds = column.dynamicStyles;
    if (ds) {
      $.each(ds, function (idx, item) {
        var style = item.styles;
        var startColor2 = checkNullOrType(style.startColor, "string", defaultColor);
        var endColor2 = checkNullOrType(style.endColor, "string", defaultColor);
        var angle2 = checkNullOrType(style.angle, "number", defaultAngle);
        var size2 = checkNullOrType(style.size, "number", defaultSize);
        style.figureBackground = dews.string.format("linear, {0}, {1}, {2}", startColor2, endColor2, angle2);
        delete style.startColor;
        delete style.endColor;
        delete style.angle;
        style.figureSize = dews.string.format("{0}%", size2);
        delete style.size;
      });
    }
    var startColor = checkNullOrType(f.startColor, "string", defaultColor);
    var endColor = checkNullOrType(f.endColor, "string", defaultColor);
    var angle = checkNullOrType(f.angle, "number", defaultAngle);
    var size = checkNullOrType(f.size, "number", defaultSize);
    var textAlignment = checkNullOrType(f.textAlignment, "string", defaultTextAlignment);
    var lineAlignment = checkNullOrType(f.lineAlignment, "string", defaultLineAlignment);
    textAlignment = convertHorizontalAlignment(textAlignment);
    lineAlignment = convertVerticalAlignment(lineAlignment);
    var returnRenderer = {
      renderer: {
        type: "bar",
        minimum: checkNullOrType(f.minimum, "number", defaultMinimum),
        maximum: checkNullOrType(f.maximum, "number", defaultMaximum),
        showLabel: checkNullOrType(f.showLabel, "boolean", defaultShowLabel),
        origin: checkNullOrType(f.startingPoint, "string", defaultStartingPoint)
      },
      styles: {
        figureBackground: dews.string.format("linear, {0}, {1}, {2}", startColor, endColor, angle),
        textAlignment: textAlignment,
        lineAlignment: lineAlignment,
        paddingLeft: checkNullOrType(f.paddingLeft, "number", defaultPadding),
        paddingRight: checkNullOrType(f.paddingRight, "number", defaultPadding),
        paddingTop: checkNullOrType(f.paddingTop, "number", defaultPadding),
        paddingBottom: checkNullOrType(f.paddingBottom, "number", defaultPadding),
        figureSize: dews.string.format("{0}%", size)
      }
    };
    if (typeof f.displayCallback === "function")
    returnRenderer.displayCallback = f.displayCallback;
    return returnRenderer;
  };
  ColumnRenderer.prototype.getSignalRenderer = function (column) {
    if (!column)
    return null;
    var f = column.formats;
    if (!f)
    return null;
    var styleCreator = dews.ui.grid.StyleCreator.getInstance();
    var defaultBarCount = 10;
    var defaultColor = styleCreator.gridStyle.themeColorLight1;
    var defaultState = "value";
    var ds = column.dynamicStyles;
    if (ds) {
      $.each(ds, function (idx, item) {
        var style = item.styles;
        var color = checkNullOrType(style.color, "string", defaultColor);
        var state = checkNullOrType(style.state, "string", defaultState);
        style.figureBackground = color;
        delete style.color;
        style.figureState = Number(state);
        delete style.state;
      });
    }
    return {
      renderer: {
        type: "signal",
        barCount: checkNullOrType(f.barCount, "number", defaultBarCount)
      },
      styles: {
        figureBackground: checkNullOrType(f.color, "string", defaultColor),
        figureState: checkNullOrType(f.state, "string", defaultState)
      }
    };
  };
  function checkNullOrType(value, type, defaultValue) {
    if (value === null || value === void 0 || _typeof(value) !== type)
    return defaultValue;else

    return value;
  }
  function convertHorizontalAlignment(value) {
    switch (value.toLowerCase()) {
      case "left":
        return "near";
      case "right":
        return "far";
      case "center":
        return "center";
      default:
        return value;}

  }
  function convertVerticalAlignment(value) {
    switch (value.toLowerCase()) {
      case "top":
        return "near";
      case "bottom":
        return "far";
      case "middle":
        return "center";
      default:
        return value;}

  }

  // src/js/grid/note/GridNote.js
  function GridNote() {
  }
  GridNote.prototype.initialize = function (grid2, option, e, noteIndex) {
    var noteColumn, rendererType;
    noteColumn = setNoteIconColumn(grid2, option);
    rendererType = setRendererType(noteColumn);
    noteIndex.forEach(function (index) {
      NoteFlag(grid2, noteColumn, index, rendererType, true);
    });
  };
  GridNote.prototype.renderIcon = function (grid2, itemIndex, _isNote) {
    if (!grid2.options.note)
    return null;
    var noteColumn, rendererType;
    noteColumn = setNoteIconColumn(grid2, grid2.options.note);
    rendererType = setRendererType(noteColumn);
    NoteFlag(grid2, noteColumn, grid2.getDataIndexFromItemIndex(itemIndex), rendererType, _isNote);
  };
  GridNote.prototype.boundingDraw = function (gridView, grid2, dataBoundParameter) {
    var arr = gridView.name.split("_");
    var gridKey = arr[arr.length - 1];
    var noteIndex = [],memoIndex = [],clrArr = [];
    if (dews.ui.page.option === void 0 && dews.ui.page.useGridNote === "Y") {
      dews.api.get(dews.url.getApiUrl("CM", "GridNoteService", "gridList"), {
        async: false,
        data: {
          gridCode: gridKey,
          menuCode: dews.ui.page.menu.id
        }
      }).done(function (data) {
        var gridList = data;
        if (gridList.length < 1) {
          return null;
        }
        gridList.forEach(function (v) {
          var gridNoteKey = v.gridNoteKey.split("|");
          var obj = {};
          gridNoteKey.forEach(function (currentValue) {
            var valueKey = currentValue.split(":")[0];
            obj[valueKey] = currentValue.substr(valueKey.length + 1);
          });
          Object.keys(obj).forEach(function (key) {
            if (grid2.columns[key] && grid2.columns[key].formats && grid2.columns[key].formats.type === "date") {
              obj[key] = get_date_str(new Date(obj[key]));
            }
          });
          var noteI = gridView._dataSource.searchDataRow({
            fields: Object.keys(obj),
            values: Object.values(obj)
          });
          if (noteI > -1) {
            noteIndex.push(noteI);
            if (v.existGdntTxt === "Y") {
              memoIndex.push(noteI);
            }
            clrArr[grid2.getItemIndexFromDataIndex(noteI)] = v.glcCode;
          }
          grid2._colorLine.useColorLine = v.glcUseYn;
        });
      }).fail(function (e, xhr) {
        console.log(e);
      });
      memoIndex = _toConsumableArray(new Set(memoIndex));
      for (var i = 0; i < clrArr.length; i++) {
        if (clrArr[i] === void 0) {
          clrArr[i] = null;
        }
      }
      if (grid2.options.note && $.type(grid2.options.note) === "object") {
        grid2._gridNote.initialize(grid2, grid2.options.note, dataBoundParameter, memoIndex);
        grid2._colorLine.initialize(grid2, clrArr, dataBoundParameter);
      }
    }
  };
  function NoteFlag(grid2, column, rowIndex, _renderer, _isNote) {
    if (!column)
    return null;
    var styles = {
      iconLocation: "left",
      iconAlignment: "left",
      paddingLeft: column.align === "left" ? 6 : 0,
      paddingTop: 0,
      iconIndex: -1
    };
    var renderType = {
      type: _renderer
    };
    var imgs = new RealGridJS.ImageList("_noteIcon", dews._environments.scriptBase + "realgrid/assets/");
    imgs.addUrls(["ico-pin-memo.png"]);
    grid2._grid.registerImageList(imgs);
    grid2._grid.setColumnProperty(column.field, "imageList", "_noteIcon");
    grid2._grid.setColumnProperty(column.field, "renderer", renderType);
    grid2._grid.setColumnProperty(column.field, "styles", styles);
    styles.iconIndex = _isNote ? 0 : -1;
    if (column.align === "left") {
      styles.paddingLeft = _isNote ? 0 : 6;
    }
    var iconIndex = grid2.options._gridType === "GRID" ? grid2.getItemIndexFromDataIndex(rowIndex) : rowIndex;
    grid2.setCellStyle(iconIndex, column.field, styles, true);
  }
  function setNoteIconColumn(grid2, option) {
    var markFieldNote, noteColumn;
    if (option.markField) {
      markFieldNote = option.markField;
    } else {
      if ($.type(grid2._grid.getDisplayColumns()[0]) !== "string") {
        markFieldNote = grid2._grid.getDisplayColumns()[0].columns[0];
      } else {
        markFieldNote = grid2._grid.getDisplayColumns()[0];
      }
    }
    noteColumn = grid2.columns[markFieldNote];
    return noteColumn;
  }
  function setRendererType(noteColumn) {
    var _renderer,rendererType = ["LINK", "CHECK", "IMAGE", "BAR", "SIGNAL", "BUTTON"];
    if (noteColumn.editor || noteColumn.formats) {
      var columnType = (noteColumn.editor || noteColumn.formats).type.toUpperCase();
      _renderer = rendererType.indexOf(columnType) !== -1 ? "multiIcon" : "icon";
    }
    return _renderer;
  }
  function get_date_str(date) {
    var sYear = date.getFullYear();
    var sMonth = date.getMonth() + 1;
    var sDate = date.getDate();
    sMonth = sMonth > 9 ? sMonth.toString() : "0" + sMonth;
    sDate = sDate > 9 ? sDate.toString() : "0" + sDate;
    return sYear + sMonth + sDate;
  }

  // src/js/grid/note/ColorLine.js
  function ColorLine() {
  }
  ColorLine.prototype.initialize = function (grid2, clrArr, e) {
    var data = e.row.data;
    if (!data)
    return null;
    grid2._colorLine.rowDynamic = [];
    for (var i = 0; i < Object.keys(clrArr).length; i++) {
      grid2._colorLine.addColorLine(grid2, Object.values(clrArr)[i], Object.keys(clrArr)[i]);
    }
  };
  ColorLine.prototype.addColorLine = function (grid2, color, rowIndex) {
    if (color === null) {
      return null;
    }
    rowIndex = grid2.getDataIndexFromItemIndex(rowIndex);
    grid2._grid.setStyles({
      body: {
        line: "#00ffffff"
      }
    });
    grid2.setRowStyle(
    rowIndex,
    {
      borderBottom: color
    },
    true);

  };
  ColorLine.prototype.removeColorLine = function (grid2, rowIndex) {
    rowIndex = grid2.getDataIndexFromItemIndex(rowIndex);
    grid2.resetRowStyle(rowIndex);
  };
  ColorLine.prototype.activateColorLine = function (grid2) {
    grid2._colorLine.useColorLine = "Y";
    grid2._grid.setStyles({
      body: {
        dynamicStyles: grid2.options.rowDynamic
      }
    });
  };
  ColorLine.prototype.disabledColorLine = function (grid2) {
    grid2._colorLine.useColorLine = "N";
    var colorLineStyles = grid2._colorLine.rowDynamic;
    var gridStyles = grid2.options.rowDynamic;
    var extraStyle = [];
    gridStyles.forEach(function (v) {
      if (!(colorLineStyles.indexOf(v) !== -1)) {
        extraStyle.push(v);
      }
    });
    grid2._grid.setStyles({
      body: {
        dynamicStyles: extraStyle
      }
    });
  };

  // src/js/grid/customTheme/posco.js
  var setPOSCO = /*#__PURE__*/_createClass(function setPOSCO() {"use strict";_classCallCheck(this, setPOSCO);});

  setPOSCO.prototype.style = function () {
    return {
      body: {
        height: 24,
        paddingLeft: 10,
        paddingRight: 10,
        requiredBackground: "#f4fcfd",
        requiredFocusBackground: "#f4fcfd",
        selectedBackground: "#ff696969",
        checkedImg: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAMAAAC67D+PAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAABpUExURRVSoRNSohVRoBRSogBSpgBRpgBRpQ5cqx9nsQFTphJerJCz2Ja42gRVqAJUpzl5uh1msA9cq5G02cPW6jp5ugRVp5a4263H46C+3sHV6Tt6uwBQpSJpsq/I48vb7Tt6uhVgrR5msP///2A+C0oAAAADdFJOU4v1jJrT6kwAAAABYktHRCJdZVysAAAAB3RJTUUH5wMVBBwLkV5w7gAAAFFJREFUCNctzUcWgEAIA1AQBnvvjvX+l3TiM6u/IIGI5QsTsSLOlEkgi5NUAp1alhdlYFU3bdcPGjhO87JuHnT7cV6m+t3eD6qCMfMghv8X0QugKgMopiPBGAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0wMy0yMVQwNDoyODowNCswMDowMJOr+/0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjMtMDMtMjFUMDQ6Mjg6MDQrMDA6MDDi9kNBAAAAKHRFWHRkYXRlOnRpbWVzdGFtcAAyMDIzLTAzLTIxVDA0OjI4OjExKzAwOjAwK3FNpwAAAABJRU5ErkJggg==",
        unCheckImg: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKBAMAAAB/HNKOAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAASUExURdvh6+Hm7tzh6+Lm7v39/v///00AeYoAAAADdFJOU4v1jJrT6kwAAAABYktHRAX4b+nHAAAAB3RJTUUH5wMVBBwLkV5w7gAAAB9JREFUCNdjYDQ2NhZgEAkNDXVkMAWSwQRIiEqQLiEAiGkNKYmpiRAAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDMtMjFUMDQ6Mjg6MDMrMDA6MDBWDMVzAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTAzLTIxVDA0OjI4OjAzKzAwOjAwJ1F9zwAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyMy0wMy0yMVQwNDoyODoxMSswMDowMCtxTacAAAAASUVORK5CYII="
      },
      indicator: {
        head: {
          fontBold: false
        },
        fontBold: false,
        background: "#f0f0f0",
        hoveredBackground: "#f0f0f0",
        selectedBackground: "#f0f0f0",
        focusBorderColor: "#000000"
      },
      fixed: {
        paddingLeft: 10,
        paddingRight: 10
      },
      header: {
        height: 28,
        fontBold: false,
        paddingLeft: 10,
        paddingRight: 10,
        hoveredBackground: "rgba(67,144,244,0.1)",
        group: {
          paddingLeft: 10,
          paddingRight: 10
        },
        summary: {
          paddingLeft: 10,
          paddingRight: 10
        }
      },
      footer: {
        height: 28,
        paddingLeft: 10,
        paddingRight: 10
      },
      rowGroup: {
        footer: {
          paddingLeft: 10,
          paddingRight: 10
        }
      },
      scrollBar: {
        background: "#f1f1f1",
        thumb: "#c1c1c1",
        button: {
          background: "#f1f1f1"
        }
      },
      selection: {
        focusBorderColor: "",
        focusBackgroundColor: "",
        selectedBackground: "#000000"
      },
      tree: {
        expander: {
          figureBackground: "#1e52a0"
        }
      }
    };
  };
  setPOSCO.prototype.option = function () {
    return {
      checkBar: {
        width: 28,
        drawCheckBox: false,
        checkImageUrl: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAMAAAC67D+PAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAABpUExURRVSoRNSohVRoBRSogBSpgBRpgBRpQ5cqx9nsQFTphJerJCz2Ja42gRVqAJUpzl5uh1msA9cq5G02cPW6jp5ugRVp5a4263H46C+3sHV6Tt6uwBQpSJpsq/I48vb7Tt6uhVgrR5msP///2A+C0oAAAADdFJOU4v1jJrT6kwAAAABYktHRCJdZVysAAAAB3RJTUUH5wMVBBwLkV5w7gAAAFFJREFUCNctzUcWgEAIA1AQBnvvjvX+l3TiM6u/IIGI5QsTsSLOlEkgi5NUAp1alhdlYFU3bdcPGjhO87JuHnT7cV6m+t3eD6qCMfMghv8X0QugKgMopiPBGAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0wMy0yMVQwNDoyODowNCswMDowMJOr+/0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjMtMDMtMjFUMDQ6Mjg6MDQrMDA6MDDi9kNBAAAAKHRFWHRkYXRlOnRpbWVzdGFtcAAyMDIzLTAzLTIxVDA0OjI4OjExKzAwOjAwK3FNpwAAAABJRU5ErkJggg==",
        unCheckImageUrl: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKBAMAAAB/HNKOAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAASUExURdvh6+Hm7tzh6+Lm7v39/v///00AeYoAAAADdFJOU4v1jJrT6kwAAAABYktHRAX4b+nHAAAAB3RJTUUH5wMVBBwLkV5w7gAAAB9JREFUCNdjYDQ2NhZgEAkNDXVkMAWSwQRIiEqQLiEAiGkNKYmpiRAAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDMtMjFUMDQ6Mjg6MDMrMDA6MDBWDMVzAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTAzLTIxVDA0OjI4OjAzKzAwOjAwJ1F9zwAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyMy0wMy0yMVQwNDoyODoxMSswMDowMCtxTacAAAAASUVORK5CYII=",
        headCheckImageUrl: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAMAAAC67D+PAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAABpUExURRVSoRNSohVRoBRSogBSpgBRpgBRpQ5cqx9nsQFTphJerJCz2Ja42gRVqAJUpzl5uh1msA9cq5G02cPW6jp5ugRVp5a4263H46C+3sHV6Tt6uwBQpSJpsq/I48vb7Tt6uhVgrR5msP///2A+C0oAAAADdFJOU4v1jJrT6kwAAAABYktHRCJdZVysAAAAB3RJTUUH5wMVBBwLkV5w7gAAAFFJREFUCNctzUcWgEAIA1AQBnvvjvX+l3TiM6u/IIGI5QsTsSLOlEkgi5NUAp1alhdlYFU3bdcPGjhO87JuHnT7cV6m+t3eD6qCMfMghv8X0QugKgMopiPBGAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0wMy0yMVQwNDoyODowNCswMDowMJOr+/0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjMtMDMtMjFUMDQ6Mjg6MDQrMDA6MDDi9kNBAAAAKHRFWHRkYXRlOnRpbWVzdGFtcAAyMDIzLTAzLTIxVDA0OjI4OjExKzAwOjAwK3FNpwAAAABJRU5ErkJggg==",
        headUnCheckImageUrl: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKBAMAAAB/HNKOAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAASUExURdvh6+Hm7tzh6+Lm7v39/v///00AeYoAAAADdFJOU4v1jJrT6kwAAAABYktHRAX4b+nHAAAAB3RJTUUH5wMVBBwLkV5w7gAAAB9JREFUCNdjYDQ2NhZgEAkNDXVkMAWSwQRIiEqQLiEAiGkNKYmpiRAAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDMtMjFUMDQ6Mjg6MDMrMDA6MDBWDMVzAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTAzLTIxVDA0OjI4OjAzKzAwOjAwJ1F9zwAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyMy0wMy0yMVQwNDoyODoxMSswMDowMCtxTacAAAAASUVORK5CYII="
      },
      indicator: {
        headText: "NO"
      }
    };
  };

  // src/js/grid/dews.ui.grid.js
  var Grid = /*#__PURE__*/function (_DewsGrid) {"use strict";_inherits(Grid, _DewsGrid);var _super7 = _createSuper(Grid);
    function Grid(selector, options) {var _dews$ui$page5;var _this2;_classCallCheck(this, Grid);
      _this2 = _super7.call(this, selector, options);
      var self = _assertThisInitialized(_this2),option,realGrid,realGridID,id = selector.attr("ID");
      _this2.initializeGrid();
      _this2.controlAuthority(options);
      option = $.extend(true, {}, options);
      self.userOptions = $.extend(true, {}, options);
      self._innerOptions = {};
      _this2._initOneGrid();
      var gridOptionAdaptor = new dews.ui.grid.GridOptionAdaptor("GRID");
      _this2.optionAdaptor = gridOptionAdaptor;
      var styleCreator = dews.ui.grid.StyleCreator.getInstance();
      self._filterManager = new dews.ui.grid.FilterManager(self, "GRID");
      gridOptionAdaptor._filterManager = self._filterManager;
      self._columnRenderer = new ColumnRenderer();
      gridOptionAdaptor._columnRenderer = self._columnRenderer;
      self._gridNote = new GridNote();
      gridOptionAdaptor._gridNote = self._gridNote;
      self._colorLine = new ColorLine();
      gridOptionAdaptor._colorLine = self._colorLine;
      self._innerOptions = gridOptionAdaptor.convert(self.userOptions);
      if (styleCreator.theme === "posco") {
        var customOption = new setPOSCO();
        self._innerOptions = $.extend(true, self._innerOptions, customOption.option());
      }
      var _columnAdaptor = new dews.ui.grid.ColumnAdaptor();
      if (typeof option.columns !== "undefined") {
        _columnAdaptor.uuidCreator(option.columns);
      }
      self.dataSource = self._innerOptions.dataSource;
      dews.ui.gridUtil.gridStyle = styleCreator.gridStyle;
      realGrid = $("<div></div>");
      if (dews.ui.dialogPage && selector.closest(dews.ui.dialogPage.$content).length) {
        self._innerOptions.$content = dews.ui.dialogPage.$content;
        realGridID = dews.ui.dialogPage.id + "_" + id;
      } else if (dews.ui.page && selector.closest(dews.ui.page.$content).length) {
        self._innerOptions.$content = dews.ui.page.$content;
        realGridID = dews.ui.page.id + "_" + id;
      } else {
        self._innerOptions.$content = $(document);
        realGridID = "child_" + id;
      }
      realGridID = realGridID.replace(/ /gi, "");
      realGrid.attr("ID", realGridID);
      $("#" + id, self._innerOptions.$content).append(realGrid);
      if (self.userOptions.height) {
        realGrid.css("height", self.userOptions.height + "px");
      } else {
        realGrid.css("height", "635px");
      }
      self._grid = new RealGridJS.GridView(realGridID);
      self._grid.name = realGridID;
      self.$element = $("#" + self._grid.name);
      $.extend(true, option, self._innerOptions);
      option._originColumns = [].concat(option.columns);
      _this2._createOneGridButton(realGrid);
      if (typeof self.userOptions.rowStyle === "function") {
        self._innerOptions.gridStyle.body.dynamicStyles = function (grids, index) {
          var grid2 = $(grids._gv._container._containerDiv).closest(".dews-data-control").data("dews-control");
          var params = {
            grid: grid2,
            row: {
              index: index.dataRow,
              data: grid2.dataItem(index.dataRow)
            }
          };
          var style = $.extend(true, {}, grid2.userOptions.rowStyle.call(grid2, params));
          if (style.color) {
            style.foreground = style.color;
          }
          if (style.textAlign) {
            switch (style.textAlign) {
              case "left":
                style.textAlignment = "near";
                break;
              case "right":
                style.textAlignment = "far";
                break;
              case "center":
                style.textAlignment = "center";
                break;}

          }
          if (style.verticalAlign) {
            switch (style.verticalAlign.toLowerCase()) {
              case "top":
                style.lineAlignment = "near";
                break;
              case "bottom":
                style.lineAlignment = "far";
                break;
              case "middle":
                style.lineAlignment = "center";
                break;}

          }
          return style;
        };
      }
      self._grid.setStyles(self._innerOptions.gridStyle);
      setRealGridColumns(self, self._innerOptions.columns, self._innerOptions);
      $.extend(true, option, self._innerOptions);
      self._grid.setColumns(self._innerOptions.columns);
      self._grid.setHeader({
        height: self._innerOptions.maxDepth * self._innerOptions.header.minHeight
      });
      self._grid.setFooter({
        minHeight: self._innerOptions.footer.minHeight,
        height: self._innerOptions.footer.minHeight
      });
      if (self.userOptions.dataSource && self.userOptions.dataSource.dataProvider) {
        self.userOptions.dataSource.dataProvider.setFields(self.userOptions.dataSource.options.field);
        self._grid.setDataProvider(self.userOptions.dataSource.dataProvider);
      }
      if (typeof self._innerOptions.group !== "undefined") {
        setGroup2(self._grid, self._innerOptions);
      }
      self._grid.setOptions(self._innerOptions);
      self.options = option;
      self.focused = false;
      self.columns = {};
      if (self._innerOptions.columns) {
        dews.ui.gridUtil._setColumns(self, option.columns);
      }
      self._setOneGridData();
      self.useCssStyle();
      self._filterManager.setFilterActions(self);
      if (self._innerOptions.filter.use) {
        self._grid.onFilterActionClicked = function (_grid, column, action, x, y) {
          if ($(".dews-grid-user-filter-layer").length > 0) {
            return false;
          }
          if (action === column + "_filterAction") {
            self._filterManager.createFilterLayer(column, x, y);
          }
        };
        var filterBeforeDataIndex = -1;
        self._grid.onFiltering = function (grid2) {
          var itemIndex = self.select();
          var dataIndex = self.getDataIndexFromItemIndex(itemIndex);
          filterBeforeDataIndex = dataIndex;
        };
        self._grid.onFilteringChanged = function (grid2, column) {
          if (column) {
            var itemIndex = self.select();
            var dataIndex = self.getDataIndexFromItemIndex(itemIndex);
            if (filterBeforeDataIndex != dataIndex) {
              grid2.onCurrentChanged.call(self, grid2, grid2.getCurrent());
            }
          }
        };
      }
      if (_typeof(self._innerOptions._sortOrderBy) === "object") {
        self._grid.orderBy(self._innerOptions._sortOrderBy.field, self._innerOptions._sortOrderBy.dir);
      }
      self._bindEvent();
      selector.data("dews-control", self);
      if (self._innerOptions.dataSource && self._innerOptions.autoBind) {
        self._innerOptions.dataSource.read();
      }
      if (self._innerOptions.context !== false) {
        self.setContextMenu(self.options.context);
        self._innerOptions.contextMenu = self.options.contextMenu;
      }
      setTimeout(function () {
        self._grid.resetSize();
      }, 100);
      if (self.options.columns) {
        dews.ui.gridUtil.displayColumns(self, self._grid.getDisplayColumns());
      }
      if (((_dews$ui$page5 = dews.ui.page) === null || _dews$ui$page5 === void 0 ? void 0 : _dews$ui$page5.useGridNote) === "Y" && self.options.note) {
        var tabPanel = self.$element.closest(".dews-ui-tab-panel").data("dews-control");
        if (tabPanel) {
          tabPanel.on("change", function () {var _dews$ui$page$gridNot;
            (_dews$ui$page$gridNot = dews.ui.page.gridNote) === null || _dews$ui$page$gridNot === void 0 ? void 0 : _dews$ui$page$gridNot.close();
          });
        }
      }return _this2;
    }_createClass(Grid, [{ key: "_setCriteria", value:
      function _setCriteria() {
        var self = this;
        $.each(self.options.styleColumn, function (idx, column) {
          var fieldName = self._grid.columnByField(column);
          self.columns[column].criteriaFunction = {
            criteria: function criteria(grids, index, value) {
              var grid2 = $(grids._gv._container._containerDiv).closest(".dews-data-control").data("dews-control");
              if (!grid2) {
                return false;
              }
              var dynamicParam = {
                grid: grid2,
                row: {
                  index: index.itemIndex,
                  data: grid2.dataItem(index.itemIndex)
                },
                cell: {
                  field: index.column,
                  data: value
                }
              };
              var style = $.extend(true, {}, grid2.columns[index.column].style.call(grid2, dynamicParam));
              if (style.color) {
                style.foreground = style.color;
              }
              if (style.textAlign) {
                switch (style.textAlign) {
                  case "left":
                    style.textAlignment = "near";
                    break;
                  case "right":
                    style.textAlignment = "far";
                    break;
                  case "center":
                    style.textAlignment = "center";
                    break;}

              }
              if (style.verticalAlign) {
                switch (style.verticalAlign.toLowerCase()) {
                  case "top":
                    style.lineAlignment = "near";
                    break;
                  case "bottom":
                    style.lineAlignment = "far";
                    break;
                  case "middle":
                    style.lineAlignment = "center";
                    break;}

              }
              if (style.icon && style.icon.image) {
                var image;
                if (grid2.options.iconImagelist) {
                  image = grid2.options.iconImagelist;
                } else {
                  image = new RealGridJS.ImageList("iconImage", "");
                }
                if (grid2.options.images.indexOf(style.icon.image) !== -1) {
                } else {
                  grid2.options.images.push(style.icon.image);
                }
                style = $.extend(true, {}, style, {
                  iconIndex: style.icon.image,
                  iconOffset: 0,
                  iconPadding: 5,
                  iconAlignment: "center",
                  iconLocation: style.icon.position || "left"
                });
                image.addUrls(grid2.options.images);
                grid2._grid.registerImageList(image);
                grid2.columns[index.column].imageList = "iconImage";
                grid2.options.iconImagelist = image;
              } else if (grid2.columns[index.column].imageList === "iconImage") {
                style = $.extend(true, {}, style, {
                  iconIndex: -1
                });
              }
              if (style.header) {
                var styles = $.extend(true, {}, style.header);
                if (style.header.color) {
                  styles.foreground = style.header.color;
                }
                if (style.header.selectedColor) {
                  styles.selectedForeground = style.header.selectedColor;
                }
                if (style.header.hoveredColor) {
                  styles.hoveredForeground = style.header.hoveredColor;
                }
                self._grid.setColumnProperty(fieldName, "header", {
                  styles: styles
                });
              }
              return style;
            }
          };
          self._grid.setColumnProperty(fieldName, "dynamicStyles", [self.columns[column].criteriaFunction]);
          var renderer = self._grid.getColumnProperty(fieldName, "renderer");
          if (!renderer) {
            self._grid.setColumnProperty(self._grid.columnByField(column), "renderer", { type: "icon" });
          }
        });
      } }, { key: "controlAuthority", value:
      function controlAuthority(options) {var _dews$ui$page6, _dews$ui$page6$author;
        _get(_getPrototypeOf(Grid.prototype), "controlAuthority", this).call(this, options);
        var self = this;
        var id = this.id;
        if (Array.isArray((_dews$ui$page6 = dews.ui.page) === null || _dews$ui$page6 === void 0 ? void 0 : (_dews$ui$page6$author = _dews$ui$page6.authority) === null || _dews$ui$page6$author === void 0 ? void 0 : _dews$ui$page6$author.menuExportControl)) {
          var _useExcelDownloadRecord = false;
          dews.ui.page.authority.menuExportControl.filter(function (controlObj) {
            if (controlObj.grid === id) {
              _useExcelDownloadRecord = controlObj.ctrl;
            }
          });
          self._useExcelDownloadRecord = _useExcelDownloadRecord;
        }
      } }]);return Grid;}(DewsGrid);

  function setRealGridColumns(grid2, columns, innerOptions) {
    $.each(columns, function (index) {
      var column = columns[index];
      if (column.headerCheck) {
        grid2._grid.setColumnHeaderOptions({
          checkVisibility: "visible",
          imageCheckHandle: true,
          checkImages: {
            none: innerOptions.gridStyle.body.unCheckImg,
            hoveredNone: innerOptions.gridStyle.body.unCheckImg,
            fill: innerOptions.gridStyle.body.checkedImg,
            hoveredFill: innerOptions.gridStyle.body.checkedImg
          }
        });
      }
      if (column.editor) {
        var columnEditorType;
        if (column.editor.type) {
          columnEditorType = column.editor.type.toUpperCase();
        }
        if (columnEditorType === "DROPDOWN" || columnEditorType === "COMBO") {
          var dataSource = column.editor.dataSource,values = column.editor.dataValueField,labels = column.editor.dataTextField;
          column.values = [];
          column.labels = [];
          column.editButtonVisibility = "visible";
          if (typeof column.editor.dataSource === "function") {
            dataSource = column.editor.dataSource.call(grid2, {
              grid: grid2,
              row: {
                index: 0,
                data: {
                  labels: "",
                  values: ""
                }
              }
            });
          }
          var dataSelectable = column.editor.dataSelectable;
          column.editor.values = [];
          column.editor.labels = [];
          if (dataSource && dataSource.transport && dataSource.transport.data && dataSource.transport.data.length > 0) {
            var transportData = dataSource.transport.data;
            for (var j = 0; j < dataSource.transport.data.length; j += 1) {
              column.values.push(transportData[j][values]);
              column.labels.push(transportData[j][labels]);
              if (dataSelectable && transportData[j][dataSelectable.field] !== dataSelectable.falseValue) {
                column.editor.values.push(dataSource.transport.data[j][values]);
                column.editor.labels.push(dataSource.transport.data[j][labels]);
              }
            }
          }
        } else if (columnEditorType === "TIME") {
          if ($("#" + grid2._grid.name + "_time").length === 0) {
            var timePicker = $('<input class="dews-ui-timepicker">');
            timePicker.prop("id", grid2._grid.name + "_time");
            $("body").after(timePicker);
            column.timepicker = dews.ui.timepicker(timePicker, {
              secondValue: column._secondValue
            });
            $("body").after(column.timepicker.timeView.ul.parent(".k-list-container"));
          } else {
            column.timepicker = dews.ui.timepicker($("#" + grid2._grid.name + "_time"));
          }
          column.timepicker.wrapper.css({
            display: "none",
            height: innerOptions.display.rowHeight
          });
        } else if (columnEditorType === "MONTH") {
          if ($("#" + grid2._grid.name + "_month").length === 0) {
            var monthPicker = $('<input class="dews-ui-monthpicker">');
            monthPicker.prop("id", grid2._grid.name + "_month");
            $("body").after(monthPicker);
            column.monthpicker = dews.ui.monthpicker(monthPicker);
            $("body").after(column.monthpicker.dateView.div);
          } else {
            column.monthpicker = dews.ui.monthpicker($("#" + grid2._grid.name + "_month"));
          }
          column.monthpicker.wrapper.css({
            display: "none",
            height: innerOptions.display.rowHeight
          });
        } else if (columnEditorType === "YEAR") {
          if ($("#" + grid2._grid.name + "_year").length === 0) {
            var yearpicker = $('<input class="dews-ui-yearpicker">');
            yearpicker.prop("id", grid2._grid.name + "_year");
            $("body").after(yearpicker);
            column.yearpicker = dews.ui.yearpicker(yearpicker);
            $("body").after(column.yearpicker.dateView.div);
          } else {
            column.yearpicker = dews.ui.yearpicker($("#" + grid2._grid.name + "_year"));
          }
          column.yearpicker.wrapper.css({
            display: "none",
            height: innerOptions.display.rowHeight
          });
        }
      }
      if (column.footer) {
        var columnFooterArray = [];
        if (_typeof(column.footer) === "object") {
          columnFooterArray.push(column.footer);
        } else if (Array.isArray(column.footer)) {
          columnFooterArray = column.footer;
        }
        for (var footerIdx = 0; footerIdx < columnFooterArray.length; footerIdx++) {
          if (columnFooterArray[footerIdx].expression) {
            if (columnFooterArray[footerIdx].predefined === true) {
              if (typeof columnFooterArray[footerIdx].preCurrency === "function") {
                columnFooterArray[footerIdx].preCurrency = "";
                grid2._grid._gv._footer._cell.__proto__.value = _displayFooterText3();
              }
            }
            if (columnFooterArray[footerIdx].expression === "sum") {
              grid2._grid._gv._rowGroup._footerCell.__proto__.value = _displayGroupFooterText();
            }
          }
        }
      }
      if (Array.isArray(column.columns)) {
        setRealGridColumns(grid2, column.columns, innerOptions);
      }
    });
  }
  function _displayFooterText3() {
    return function () {
      var grid2 = $(this._index._column.grid()._container._containerDiv).closest(".dews-data-control").data("dews-control");
      if (grid2 === void 0 || grid2 === null) {
        return null;
      }
      var cols = grid2.columns;
      var col = grid2.columns[this._index._column._fieldName];
      var fieldName = this._index._column._fieldName;
      if (col.footer && col.footer.predefined && col.footer.format && col.footer.currency && $.type(col.footer.currency) === "function") {
        var params = {
          grid: grid2,
          column: cols
        };
        col.footer.preCurrency = col.footer.currency.call(grid2, params);
        grid2._innerOptions.columns.some(function (value, idx) {
          if (value.fieldName === fieldName) {
            grid2._innerOptions.columns[idx].footer.preCurrency = col.footer.preCurrency;
          }
        });
        var env = dews.ui.page && dews.ui.page.env && dews.ui.page.env[col.footer.preFormat];
        var predefinedFormat = dews.getCurrencyFormat(col.footer);
        var formats = "#,###.##";
        var round = "round";
        if (env) {
          formats = env.format;
          round = dews.mathType[env.round];
        }
        if ($.type(predefinedFormat) === "object") {
          formats = predefinedFormat.format;
          round = $.type(predefinedFormat.round) === "string" ? predefinedFormat.round : round;
        } else if ($.type(predefinedFormat) === "string") {
          formats = predefinedFormat;
        }
        if (round !== "round") {
          if (formats.split(".").length === 2) {
            if (round === "ceil") {
              formats += ";;;c";
            } else {
              formats += ";;;f";
            }
          }
        }
        var column = grid2._grid.columnByField(this._index._column._fieldName);
        var numberFormat = grid2._grid.getColumnProperty(column, "footer").styles.numberFormat;
        if (numberFormat !== formats) {
          grid2._grid.setColumnProperty(column, "footer", {
            styles: {
              numberFormat: formats
            }
          });
        }
      }
      if (col.footer && col.footer.length > 1) {
        var fieldName = this._index._column._fieldName;
        var columnIndex = grid2.options.columns.findIndex(function (column2) {
          return column2.field === fieldName;
        });
        for (var footerIdx = 0; footerIdx < col.footer.length; footerIdx++) {
          if (col.footer[footerIdx].predefined && col.footer[footerIdx].format && col.footer[footerIdx].currency && $.type(col.footer[footerIdx].currency) === "function") {
            var params = {
              grid: grid2,
              column: cols
            };
            col.footer[footerIdx].preCurrency = col.footer[footerIdx].currency.call(grid2, params);
            var env = dews.ui.page && dews.ui.page.env && dews.ui.page.env[col.footer[footerIdx].preFormat];
            var predefinedFormat = dews.getCurrencyFormat(col.footer[footerIdx]);
            var formats = "#,###.##";
            var round = "round";
            if (env) {
              formats = env.format;
              round = dews.mathType[env.round];
            }
            if ($.type(predefinedFormat) === "object") {
              formats = predefinedFormat.format;
              round = $.type(predefinedFormat.round) === "string" ? predefinedFormat.round : round;
            } else if ($.type(predefinedFormat) === "string") {
              formats = predefinedFormat;
            }
            if (round !== "round") {
              if (formats.split(".").length === 2) {
                if (round === "ceil") {
                  formats += ";;;c";
                } else {
                  formats += ";;;f";
                }
              }
            }
            grid2.options.columns[columnIndex].footer.styles[footerIdx].numberFormat = formats;
          }
        }
        grid2._grid.setColumnProperty(grid2._grid.columnByField(this._index._column._fieldName), "footer", {
          styles: grid2.options.columns[columnIndex].footer.styles
        });
      }
      return this._value;
    };
  }
  function _displayGroupFooterText() {
    return function () {
      if (isNaN(this._value) && $.type(this._value) === "number") {
        this._value = 0;
      }
      return this._value;
    };
  }
  function setGroup2(grid2, opt2) {var _opt2$group2;
    var group = (_opt2$group2 = opt2.group) === null || _opt2$group2 === void 0 ? void 0 : _opt2$group2.map(function (g) {return g.field;});
    grid2.groupBy(group);
    var groupOption = {};
    if (typeof opt2.groupHeaderTemplate !== "undefined") {
      var state = opt2.groupHeaderTemplate;
      var index = 0;
      if (typeof opt2.groupHeaderColumn !== "undefined") {
        for (var g = 0; g < grid2.getDisplayColumns().length; g += 1) {
          if (opt2.groupHeaderColumn === grid2.getDisplayColumns()[g]) {
            index = g + 1;
            break;
          }
        }
        var groupText = opt2.columns[index].header.text;
        groupOption.headerCallback = function (groupModel, grid3) {
          var dataProvider = grid3.getDataSource();
          var replaceState = state;
          if (/\${title}/.test(replaceState)) {
            replaceState = replaceState.replace(/\${title}/gi, groupText);
          }
          if (/\${field}/.test(replaceState)) {
            replaceState = replaceState.replace(/\${field}/gi, opt2.groupHeaderColumn);
          }
          if (/\${value}/.test(replaceState)) {
            replaceState = replaceState.replace(
            /\${value}/gi,
            dataProvider.getValue(groupModel.firstItem.dataRow, opt2.groupHeaderColumn));

          }
          if (/\${count}/.test(replaceState)) {
            replaceState = replaceState.replace(/\${count}/gi, groupModel.dataRows.length);
          }
          return replaceState;
        };
        groupOption.headerStatement = null;
      } else {
        for (var _g2 = 0; _g2 < grid2.getDisplayColumns().length; _g2++) {
          for (var r = 0; r < group.length; r++) {
            if (group[r] === grid2.getDisplayColumns()[_g2]) {
              index = _g2 + 1;
              break;
            }
          }
        }
        if (/\${title}/.test(state)) {
          state = state.replace(/\${title}/gi, "${columnHeader}");
        }
        if (/\${field}/.test(state)) {
          state = state.replace(/\${field}/gi, "${groupField}");
        }
        if (/\${value}/.test(state)) {
          state = state.replace(/\${value}/gi, "${groupValue}");
        }
        if (/\${count}/.test(state)) {
          state = state.replace(/\${count}/gi, "${rowCount}");
        }
        groupOption.headerStatement = state;
      }
    }
    if (typeof opt2.dataSource.options.userGroup !== "undefined" && opt2.dataSource.options.userGroup) {
      groupOption.mergeMode = true;
      groupOption.collapsedAdornments = "footer";
      groupOption.expandedAdornments = "footer";
      opt2.panel.visible = true;
    }
    groupOption["levels"] = setGroupLevelColor(group.length);
    grid2.setRowGroup(groupOption);
    grid2.setSortingOptions({
      handleVisibility: "hidden"
    });
    function setGroupLevelColor(groupCnt) {
      var groupLevelStyles = [];
      for (var i = 1; i < groupCnt + 1; i++) {
        var levelColor = "rgba(0, 85, 170, ".concat(0.12 * i, ")");
        groupLevelStyles.push({
          headerStyles: {
            background: levelColor,
            fontBold: true
          },
          headerBarStyles: {
            background: levelColor
          },
          barStyles: {
            background: levelColor
          }
        });
      }
      return groupLevelStyles;
    }
  }
  dews = $.extend(true, dews, {
    ui: {
      grid: function grid(selector, options) {
        var $el, grid2, $content;
        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          if (dews.ui.dialogPage) {
            $content = dews.ui.dialogPage.$content;
          } else if (dews.ui.page) {
            $content = dews.ui.page.$content;
          } else {
            $content = $(document);
          }
          $el = $(selector, $content);
        }
        if ($.type($el) === "undefined") {
          return;
        }
        $el.each(function () {
          var gridView,$this = $(this);
          gridView = $this.data("dews-control");
          if (!gridView) {
            if ($.type(options) === "undefined") {
              options = {};
            }
            if (!$this.hasClass("dews-data-control")) {
              $this.addClass("dews-data-control");
            }
            RealGridJS.setRootContext(dews._environments.scriptBase + "realgrid");
            gridView = new Grid($el, options);
            $this.data("dews-control", gridView);
          }
          grid2 = gridView;
        });
        return grid2;
      }
    }
  });
})();


(function () {
  // src/js/grid/api/Api.js
  var Api = /*#__PURE__*/function () {"use strict";function Api() {_classCallCheck(this, Api);}_createClass(Api, [{ key: "setFocus", value:
      function setFocus() {
        dews.ui.gridUtil.setFocus(this);
      } }, { key: "getColumns", value:
      function getColumns() {
        return this.options._originColumns;
      } }, { key: "getColumnByField", value:
      function getColumnByField(field) {
        return this.getColumns().filter(function (col) {
          return col.field === field;
        })[0];
      } }, { key: "setFooterOptions", value:
      function setFooterOptions(fieldName, options) {
        var self = this;
        if (options) {
          if ($.type(options.align) !== "undefined") {
            switch (options.align.toLowerCase()) {
              case "left":
                options.align = "near";
                break;
              case "right":
                options.align = "far";
                break;
              default:
                options.align = "center";
                break;}

          }
          options.styles = {
            textAlignment: options.align ? options.align : "right"
          };
        }
        self._grid.setColumnProperty(self._grid.columnByField(fieldName), "footer", options);
      } }, { key: "showTooltip", value:
      function showTooltip(itemIndex, column, options) {
        dews.ui.gridUtil.showTooltip(this, itemIndex, column, options);
      } }, { key: "isCheckedRow", value:
      function isCheckedRow(row) {
        return dews.ui.gridUtil.isCheckedRow(this, row);
      } }, { key: "clearRows", value:
      function clearRows() {
        dews.ui.gridUtil.clearRows(this);
      } }, { key: "cancelChanges", value:
      function cancelChanges() {
        var self = this;
        var dataSource = self.options.dataSource;
        dataSource.dataProvider.rollback(dataSource.options.rollback);
        if (dataSource.options.data && dataSource.options.data.length === 0) {
          dataSource.dataProvider.clearRows();
        }
      } }, { key: "cancelRow", value:
      function cancelRow(index, addDataCancel) {
        var self = this,data = self.options.dataSource.dataProvider;
        dews.ui.gridUtil.cancelRow(self, data, index, addDataCancel);
      } }, { key: "cancelCell", value:
      function cancelCell() {
      } }]);return Api;}();


  // src/js/grid/excel/ExcelExporter.js
  function ExcelExporter() {
  }
  ExcelExporter.prototype["export"] = function (options, grids) {
    var self = this;
    self.grid = grids;
    self.options = exportInitialOptions(options);
    if (self.options.useExcelDownloadRecord) {
      self.grid._useExcelDownloadRecord = self.options.useExcelDownloadRecord;
    }
    if (self.grid._useExcelDownloadRecord) {
      var recordDialog = dews.ui.dialog("H_CM_PRINTREASON_INFO_C", {
        url: "~/codehelp/CI/H_CM_PRINTREASON_INFO_C",
        iframe: false,
        buttons: "applyAndClose",
        width: 560,
        height: 537,
        size: "medium",
        initData: {
          code: "H_CM_PRINTREASON_INFO_C",
          MENU_CD: dews.ui.page.menu.id,
          GRID_CD: self.grid.userOptions._dewsGridID
        },
        ok: function ok() {
          Array.isArray(self.grid) ? self.multiSheetExcelExport() : self.oneSheetExcelExport();
        }
      });
      recordDialog.open();
    } else {
      Array.isArray(self.grid) ? self.multiSheetExcelExport() : self.oneSheetExcelExport();
    }
  };
  ExcelExporter.prototype.oneSheetExcelExport = function () {
    var self = this;
    var opt2 = self.options;
    removeGridCellStyles(self.grid);
    self.grid._grid.exportGrid(opt2);
    restoreGridCellStyles(self.grid);
  };
  ExcelExporter.prototype.multiSheetExcelExport = function () {
    var self = this;
    var opt2 = self.options;
    for (var i = 0; i < self.grid.length; i++) {
      removeGridCellStyles(self.grid[i]);
      opt2.exportGrids[i].grid = self.grid[i]._grid;
    }
    RealGridJS.exportGrid(opt2);
    for (var j = 0; j < self.grid.length; j++) {
      restoreGridCellStyles(self.grid[j]);
    }
  };
  function removeGridCellStyles(grid2) {
    if (grid2._grid.getSelectOptions().style !== "none") {
      grid2._grid.clearCellStyles();
    }
  }
  function restoreGridCellStyles(grid2) {
    var currentCell = grid2._grid.getCurrent();
    var rowIndex = currentCell.dataRow;
    var fieldIndex = currentCell.fieldIndex;
    var background = grid2.options.gridStyle.selection.focusBackgroundColor;
    if (typeof grid2.columns[currentCell.column] !== "undefined" && typeof grid2.columns[currentCell.column].attributes !== "undefined") {
      if (grid2.columns[currentCell.column].attributes["class"] === "required") {
        background = grid2.options.gridStyle.body.requiredFocusBackground;
      } else if (grid2.columns[currentCell.column].attributes["class"] === "readonly") {
        background = grid2.options.gridStyle.body.readonlyFocusBackground;
      }
    }
    if (grid2._grid.getSelectOptions().style !== "none") {
      grid2._grid.addCellStyle(
      "selection",
      {
        editable: false,
        background: background
      },
      true);

      grid2._grid.setCellStyle(rowIndex, fieldIndex, "selection");
    }
  }
  function exportInitialOptions(options) {var _dews$_environments2;
    var defaultOptions2 = {
      type: "excel",
      applyDynamicStyles: true,
      allPages: true,
      target: "local",
      showProgress: true,
      progressMessage: dews.localize.get("\uC5D1\uC140 \uB0B4\uBCF4\uB0B4\uAE30 \uC911\uC785\uB2C8\uB2E4.", "dews_\uC5D1\uC140 \uB0B4\uBCF4\uB0B4\uAE30 \uC911\uC785\uB2C8\uB2E4."),
      numberCallback: function numberCallback(itemIndex, column, value) {
        return value;
      }
    };
    if (_typeof(options) === "object") {
      options.allItems = options.allPages || false;
    }
    var newOptions = $.extend(true, {}, defaultOptions2, options);
    if ((_dews$_environments2 = dews._environments) !== null && _dews$_environments2 !== void 0 && _dews$_environments2.drmCreateDownload) {
      newOptions.target = "remote";
      newOptions.url = "/drmService/excel/create";
    }
    return newOptions;
  }

  // src/js/grid/excel/ExcelImporter.js
  var defaultOptions = {
    file: void 0,
    headerRowSize: 1
  };
  function ExcelImporter(grid2, options) {
    this.grid = grid2;
    this.options = configureInitialOptions(options);
  }
  ExcelImporter.prototype["import"] = function () {
    var self = this;
    var $dfd = $.Deferred();
    if (self.options.file.length !== 1) {
      $dfd.reject(new Error("\uD30C\uC77C\uC774 \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uAC70\uB098 \uC911\uBCF5 \uC81C\uACF5\uB418\uC5C8\uC2B5\uB2C8\uB2E4."));
    }
    var file = self.options.file[0];
    loadExcelLibrary().done(function () {
      self.loadExcelWorkbook(file).done(function (workbook) {
        if (opt.sheetName && !workbook.SheetNames.some(function (name) {
          return name === opt.sheetName;
        })) {
          $dfd.reject(new Error("\uC5D1\uC140 \uD30C\uC77C\uC5D0 \uC9C0\uC815\uD55C \uC774\uB984\uC758 \uC2DC\uD2B8\uAC00 \uC874\uC7AC\uD558\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4."));
        }
        var worksheet = self.options.sheetName ? workbook.Sheets[self.options.sheetName] : workbook.Sheets[workbook.SheetNames[0]];
        var importData = self.workSheetToImportData(worksheet);
      }).fail(function (err) {
        $dfd.reject(err);
      });
    }).fail(function () {
      $dfd.reject(new Error("\uC5D1\uC140 \uB77C\uC774\uBE0C\uB7EC\uB9AC\uC758 \uB85C\uB4DC\uAC00 \uC2E4\uD328\uD558\uC600\uC2B5\uB2C8\uB2E4."));
    });
    return $dfd.promise();
  };
  ExcelImporter.prototype.loadExcelWorkbook = function (file) {
    var self = this;
    var $dfd = $.Deferred();
    if (dews._environments.drm && dews._environments.drm.use) {
      self.extractDigitalRestrictions(file).done(function (extractedArray) {
        var workbook = XLSX.read(extractedArray, {
          type: "array",
          cellDates: true
        });
        $dfd.resolve(workbook);
      }).fail(function (err) {
        $dfd.reject(err);
      });
    } else {
      var reader = new FileReader();
      reader.onload = function (e) {
        var data = new Uint8Array(e.target.result);
        var workbook = XLSX.read(data, { type: "array", cellDates: true });
        $dfd.resolve(workbook);
      };
      reader.onerror = function () {
        $dfd.reject(new Error("\uD30C\uC77C\uC744 \uC77D\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."));
      };
      reader.readAsArrayBuffer(file);
    }
    return $dfd.promise();
  };
  ExcelImporter.prototype.extractDigitalRestrictions = function (file) {
    var $dfd = $.Deferred();
    if (dews._environments.drm && dews._environments.drm.url) {
      var url = dews._environments.drm.url;
      var token = dews.ui.page ? JSON.parse(dews.ui.page.token).access_token : "";
      var formData = new FormData();
      formData.append("token", token);
      formData.append("file", file);
      var xhr = new XMLHttpRequest();
      xhr.open("POST", url, true);
      xhr.responseType = "arraybuffer";
      xhr.addEventListener("load", function () {
        if (this.status === 200) {
          var data = new Uint8Array(this.response);
          $dfd.resolve(data);
        } else if (this.status === 204) {
          $dfd.reject(new Error("\uD30C\uC77C\uC5D0 \uB300\uD55C DRM \uD574\uC81C\uAC00 \uC2E4\uD328\uD558\uC600\uC2B5\uB2C8\uB2E4."));
        } else if (this.status === 401) {
          $dfd.reject(new Error("DRM \uD574\uC81C \uC11C\uBE44\uC2A4\uC5D0 \uC720\uD6A8\uD558\uC9C0 \uC54A\uC740 \uD1A0\uD070\uC774 \uC804\uB2EC\uB418\uC5C8\uC2B5\uB2C8\uB2E4."));
        } else {
          $dfd.reject(new Error("DRM \uD574\uC81C \uC11C\uBE44\uC2A4\uC5D0\uC11C \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4."));
        }
      });
      xhr.addEventListener("error", function () {
        $dfd.reject(new Error("DRM \uD574\uC81C \uC11C\uBE44\uC2A4\uB97C \uD638\uCD9C\uD558\uB294 \uC911 \uC54C\uC218 \uC5C6\uB294 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4."));
      });
      xhr.send(formData);
    } else {
      $dfd.reject(new Error("DRM \uD574\uC81C\uB97C \uC704\uD55C \uC11C\uBE44\uC2A4\uAC00 \uC81C\uACF5\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4."));
    }
    return $dfd.promise();
  };
  ExcelImporter.prototype.workSheetToImportData = function (worksheet) {
    var self = this;
    var importData, rawData;
    if (typeof self.options.rawConverter === "function") {
      rawData = XLSX.utils.sheet_to_json(worksheet, { header: 1, raw: true });
      importData = opt.rawConverter.call(this.grid, rawData);
    } else {
      if (self.options.titleDepth > 1) {
      } else {
      }
    }
    return importData;
  };
  function loadExcelLibrary() {
    return dews.ajax.script(dews._environments.scriptBase + "xlsx.js", {
      once: true
    });
  }
  function configureInitialOptions(options) {
    var newOptions = $.extend(true, {}, defaultOptions, options);
    if (typeof newOptions.titleDepth === "undefined") {
      newOptions.headerRowSize = newOptions.titleDepth;
      delete newOptions.titleDepth;
    }
    return newOptions;
  }

  // src/js/grid/column/customizingColumn.js
  function customizingColumn(columns, opt2, grid2) {
    if (columns && opt2.dataSource && opt2.dataSource.options.field) {
      var dataSource = opt2.dataSource.options;
      opt2.columnsDepth = opt2.columnsDepth + 1;
      var d = opt2.columnsDepth;
      $.each(columns, function (i) {
        if ($.type(columns[i]) !== "undefined") {
          columns[i].fieldName = columns[i].field;
          if ($.type(columns[i].editable) === "undefined") {
            columns[i].editable = true;
          }
          if ($.type(columns[i].field) !== "undefined") {
            columns[i].name = columns[i].field;
          }
          for (var f = 0; f < dataSource.field.length; f += 1) {
            if (columns[i].fieldName === dataSource.field[f].fieldName) {
              opt2.fieldIndex = f;
              break;
            }
            if (f === dataSource.field.length - 1) {
              opt2.fieldIndex = void 0;
            }
          }
          if ($.type(columns[i].styles) === "undefined") {
            columns[i].styles = {};
          }
          if ($.type(opt2.fieldIndex) !== "undefined" && $.type(dataSource.field[opt2.fieldIndex].styles) === "undefined") {
            dataSource.field[opt2.fieldIndex].styles = {};
          }
          if ($.type(columns[i].editor) === "undefined") {
            columns[i].editor = {
              type: "text"
            };
          }
          if ($.type(columns[i].width) === "undefined" && opt2.display.fitStyle === "fill") {
            columns[i].fillWidth = 1;
          }
          if ($.type(columns[i].width) !== "undefined" && dews.ui.gridUtil.gridStyle.fontSize !== 12) {
            var fontSize = dews.ui.gridUtil.gridStyle.fontSize;
            switch (fontSize) {
              case 15:
                columns[i].width = Math.floor(1.25 * columns[i].width);
                break;
              case 18:
                columns[i].width = Math.floor(1.5 * columns[i].width);
                break;
              case 24:
                columns[i].width = Math.floor(2 * columns[i].width);
                break;
              case 30:
                columns[i].width = Math.floor(2.5 * columns[i].width);
                break;}

          }
          if (columns[i].title) {
            columns[i].header = $.extend(true, columns[i].header, {
              text: columns[i].title,
              fixedHeight: opt2.display.rowIndex
            });
          } else {
            columns[i].header = {
              text: " "
            };
          }
          if (columns[i].headerCheck === true || _typeof(columns[i].headerCheck) === "object") {
            columns[i].header.checkLocation = typeof columns[i].headerCheck.location === "undefined" ? "right" : columns[i].headerCheck.location;
            grid2._grid.setColumnHeaderOptions({
              checkVisibility: "visible",
              imageCheckHandle: true,
              checkImages: {
                none: opt2.gridStyle.body.unCheckImg,
                hoveredNone: opt2.gridStyle.body.unCheckImg,
                fill: opt2.gridStyle.body.checkedImg,
                hoveredFill: opt2.gridStyle.body.checkedImg
              }
            });
          } else {
            columns[i].header.checkLocation = "none";
            grid2._grid.setColumnHeaderOptions({
              checkVisibility: "hidden",
              imageCheckHandle: false
            });
          }
          if ($.type(opt2.styles) !== "undefined" && $.type(opt2.styles.textAlign) !== "undefined") {
            columns[i].align = opt2.styles.textAlign;
          } else if ($.type(columns[i].align) === "undefined") {
            columns[i].align = "center";
          }
          if (columns[i].align) {
            var align;
            if (columns[i].align === "right") {
              align = "far";
            } else if (columns[i].align === "left") {
              align = "near";
            } else {
              align = "center";
            }
            columns[i].styles.textAlignment = align;
          }
          grid2._filterManager.columnOptionConvert(columns[i]);
          if (columns[i].formats) {
            if ($.type(columns[i].formats.type) === "undefined") {
              columns[i].formats.type = "text";
            }
            switch (columns[i].formats.type.toUpperCase()) {
              case "DATE":
                if (columns[i].formats.predefined === true) {
                  if ($.type(columns[i].formats.preFormat) === "undefined") {
                    columns[i].formats.preFormat = columns[i].formats.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].formats);
                  if (preDefinedFormat) {
                    columns[i].formats.format = preDefinedFormat;
                  } else {
                    columns[i].formats.format = dews._environments.formats.dateFormat;
                  }
                }
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                columns[i].styles.datetimeFormat = $.type(columns[i].formats.format) === "undefined" ? dews._environments.formats.dateFormat : columns[i].formats.format;
                break;
              case "LINK":
                columns[i].renderer = $.extend(true, columns[i].renderer, {
                  type: "link",
                  url: dews.url.getAbsoluteUrl("${" + columns[i].field + "}"),
                  showUrl: false,
                  useMenu: $.type(columns[i].formats.useMenu) === "boolean" ? columns[i].formats.useMenu : false,
                  cursor: "pointer"
                });
                break;
              case "MASK":
                var mask = columns[i].formats.format,replace = "",exp = "(",regchar = "",regcount = 1,expcount = 0;
                var predefined = columns[i].formats.predefined;
                var secureFormat = columns[i].formats.secureFormat;
                if (predefined) {
                  exp = "(.*)$";
                  replace = function replace(match) {
                    var groups = Array.prototype.splice.call(arguments, 1);
                    var orgValue = groups[groups.length - 1];
                    var chgValue = orgValue;
                    var secureMask = dews.getSecureMaskFormat(secureFormat);
                    if (mask && mask !== "") {
                      chgValue = dews.string.secureMask(chgValue, mask, false);
                    }
                    if (secureMask) {
                      chgValue = dews.string.secureMask(chgValue, secureFormat, true);
                    }
                    return chgValue;
                  };
                } else if (!predefined && secureFormat && secureFormat !== "") {
                  exp = "(.*)$";
                  replace = function replace(match) {
                    var groups = Array.prototype.splice.call(arguments, 1);
                    var orgValue = groups[groups.length - 1];
                    var chgValue = orgValue;
                    if (mask && mask !== "") {
                      chgValue = dews.string.secureMask(chgValue, mask, false);
                    }
                    if (secureFormat.match(/[,]/g) && secureFormat.match(/[,]/g).length > 1) {
                      chgValue = dews.string.secureMask(chgValue, secureFormat, false);
                    }
                    return chgValue;
                  };
                } else if (mask && mask !== "") {
                  for (var m = 0; m < mask.length; m += 1) {
                    if (mask[m] !== regchar && regchar === "*") {
                      exp += "{" + expcount + "})(";
                      expcount = 0;
                      regcount++;
                    }
                    switch (mask[m]) {
                      case "0":
                      case "9":
                        if (expcount === 0) {
                          exp += "\\d";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}\\d";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "#":
                        if (expcount === 0) {
                          exp += "\\d";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}\\d";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "L":
                        if (expcount === 0) {
                          exp += "[a-zA-Z]";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}[a-zA-Z]";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "?":
                        if (expcount === 0) {
                          exp += "[a-zA-Z]";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}[a-zA-Z]";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "&":
                        if (expcount === 0) {
                          exp += "\\S";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}\\S";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "C":
                        if (expcount === 0) {
                          exp += ".";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}.";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "A":
                      case "a":
                        if (expcount === 0) {
                          exp += "[a-zA-Z0-9]";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}[a-zA-Z0-9]";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "*":
                        if (expcount === 0) {
                          exp += "[a-zA-Z0-9]";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "})([a-zA-Z0-9]";
                          replace += "$" + regcount;
                          expcount = 0;
                          regcount++;
                        }
                        replace += "*";
                        regchar = mask[m];
                        expcount++;
                        break;
                      default:
                        if (mask[m] !== "*") {
                          replace += "$" + regcount + mask[m];
                        }
                        exp += "{" + expcount + "})(";
                        expcount = 0;
                        regcount++;
                        break;}

                    if (m === mask.length - 1) {
                      exp += "{" + expcount + "})";
                      if (regchar !== "*") {
                        replace += "$" + regcount;
                      }
                    }
                  }
                } else {
                  exp = "(.*)$";
                  replace = function replace(match) {
                    var groups = Array.prototype.splice.call(arguments, 1);
                    var orgValue = groups[groups.length - 1];
                    return orgValue;
                  };
                }
                columns[i].displayRegExp = exp;
                columns[i].displayReplace = replace;
                break;
              case "NUMBER":
                if (columns[i].formats.predefined === true) {
                  if ($.type(columns[i].formats.preFormat) === "undefined") {
                    columns[i].formats.preFormat = columns[i].formats.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].formats);
                  if ($.type(preDefinedFormat) === "object") {
                    columns[i].formats.round = preDefinedFormat.round;
                    preDefinedFormat = preDefinedFormat.format;
                  }
                  if (typeof columns[i].formats.currency === "string") {
                    columns[i].formats.preCurrency = columns[i].formats.currency;
                    preDefinedFormat = dews.getCurrencyFormat(columns[i].formats);
                    if ($.type(preDefinedFormat) === "object") {
                      columns[i].formats.round = preDefinedFormat.round;
                      preDefinedFormat = preDefinedFormat.format;
                    }
                  } else if (typeof columns[i].formats.currency === "function") {
                    delete columns[i].formats.round;
                    columns[i].formats.preCurrency = "";
                    columns[i].displayCallback = function (realgrid, index, value) {
                      var dewsGrid = $(realgrid._gv._container._containerDiv).closest(".dews-data-control").data("dews-control");
                      var dewsParams = {
                        grid: dewsGrid,
                        row: {
                          index: index.itemIndex,
                          data: dewsGrid.dataItem(index.itemIndex)
                        },
                        cell: {
                          field: index.column,
                          data: dewsGrid.getCellValue(index.itemIndex, index.column)
                        }
                      };
                      var dewsCol = dewsGrid.columns[index.column];
                      dewsCol.formats.preCurrency = dewsCol.formats.currency.call(
                      dewsCol,
                      dewsParams);

                      var env = dews.ui.page && dews.ui.page.env && dews.ui.page.env[dewsCol.formats.preFormat];
                      var predefinedFormat = dews.getCurrencyFormat(dewsCol.formats),formats = "#,###.##",round2 = "round";
                      if (env) {
                        formats = env.format;
                        round2 = dews.mathType[env.round];
                      }
                      if ($.type(predefinedFormat) === "object") {
                        formats = predefinedFormat.format;
                        round2 = $.type(predefinedFormat.round) === "string" ? predefinedFormat.round : round2;
                      } else if ($.type(predefinedFormat) === "string") {
                        formats = predefinedFormat;
                      }
                      if (round2 !== "round") {
                        if (formats.split(".").length === 2) {
                          var sosu = Math.pow(10, formats.split(".")[1].length);
                          if (round2 === "ceil") {
                            value = Math.ceil(value * sosu) / sosu;
                          } else {
                            value = Math.floor(value * sosu) / sosu;
                          }
                        }
                      }
                      var oldFormats = dewsGrid._grid.getColumnProperty(dewsCol.name, "excelFormat");
                      if (!oldFormats) {
                        dewsGrid._grid.setColumnProperty(dewsCol.name, "excelFormat", formats);
                      }
                      return dews.number.format(value, formats);
                    };
                  }
                  if (preDefinedFormat) {
                    columns[i].formats.format = preDefinedFormat;
                  } else {
                    columns[i].formats.format = "#,##0.##";
                  }
                }
                if ($.type(columns[i].formats.abs) === "boolean" && columns[i].formats.abs) {
                  columns[i].dynamicStyles = [
                  {
                    criteria: "value<0",
                    styles: {
                      foreground: $.type(columns[i].formats.negative) === "undefined" ? "#e62324" : columns[i].formats.negative,
                      numberFormat: columns[i].formats.format + ";a"
                    }
                  }];

                  if ($.type(columns[i].formats.positive) !== "undefined") {
                    columns[i].dynamicStyles.push({
                      criteria: "value>=0",
                      styles: {
                        foreground: columns[i].formats.positive,
                        numberFormat: columns[i].formats.format + ";a"
                      }
                    });
                  }
                }
                if (columns[i].formats.negativeColor) {var _dews$ui$page7;
                  var useNegativeColor = false;
                  var MA00041 = (_dews$ui$page7 = dews.ui.page) === null || _dews$ui$page7 === void 0 ? void 0 : _dews$ui$page7.env["MA00041"];
                  if (MA00041) {
                    useNegativeColor = MA00041.value === "2";
                  }
                  if (useNegativeColor) {
                    columns[i].dynamicStyles = [
                    {
                      criteria: "value<0",
                      styles: {
                        foreground: "#e62324"
                      }
                    }];

                  }
                }
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].dataType = "number";
                  dataSource.field[opt2.fieldIndex].min = columns[i].formats.min;
                  dataSource.field[opt2.fieldIndex].max = columns[i].formats.max;
                  dataSource.field[opt2.fieldIndex].styles.numberFormat = $.type(columns[i].formats.format) === "undefined" ? "#,##0.##" : columns[i].formats.format;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "number";
                  dataSource.schema.model.fields[opt2.fieldIndex].numberFormat = $.type(columns[i].formats.format) === "undefined" ? "#,##0.##" : columns[i].formats.format;
                }
                if ($.type(columns[i].formats.round) === "undefined" || columns[i].formats.round === "round") {
                  if ($.type(columns[i].formats.currency) !== "function") {
                    columns[i].styles.numberFormat = columns[i].formats.format;
                  }
                } else if (columns[i].formats.round === "ceil") {
                  columns[i].styles.numberFormat = columns[i].formats.format + ";;;c";
                } else if (columns[i].formats.round === "floor") {
                  columns[i].styles.numberFormat = columns[i].formats.format + ";;;f";
                }
                break;
              case "CHECK":
                columns[i].renderer = {
                  type: "check",
                  shape: "box",
                  editable: false,
                  startEditOnClick: true,
                  trueValues: $.type(columns[i].formats.trueValue) === "undefined" ? "true" : columns[i].formats.trueValue,
                  falseValues: $.type(columns[i].formats.falseValue) === "undefined" ? "false" : columns[i].formats.falseValue,
                  trueImage: opt2.gridStyle.body.checkedImg,
                  falseImage: opt2.gridStyle.body.unCheckImg,
                  labelPosition: "none",
                  showInnerFocus: false
                };
                columns[i].editable = false;
                columns[i].styles.figureBackground = "#ff4995ff";
                break;
              case "DATASOURCE":
                columns[i].values = [];
                columns[i].labels = [];
                columns[i].lookupDisplay = true;
                break;
              case "IMAGE":
                columns[i].editable = false;
                columns[i].renderer = {
                  type: "image",
                  smoothing: true
                };
                columns[i].styles.contentFit = "auto";
                break;
              case "TIME":
                if (columns[i].formats.predefined === true) {
                  if ($.type(columns[i].formats.preFormat) === "undefined") {
                    columns[i].formats.preFormat = columns[i].formats.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].formats);
                  if (preDefinedFormat) {
                    columns[i].formats.format = preDefinedFormat;
                  } else {
                    columns[i].formats.format = "HH:mm:ss";
                  }
                }
                var time = columns[i].formats.format,timeReg = "";
                if (/HH/gi.test(time)) {
                  timeReg = time.replace(/HH/gi, "$1");
                }
                if (/mm/gi.test(time)) {
                  timeReg = timeReg.replace(/mm/gi, "$2");
                }
                if (/ss/gi.test(time)) {
                  timeReg = timeReg.replace(/ss/gi, "$3");
                }
                columns[i].displayRegExp = /([0-1]\d|2[0-3])([0-5]\d)([0-5]\d)?/gi;
                columns[i].displayReplace = timeReg;
                break;
              case "PASSWORD":
                var format = columns[i].formats.format;
                columns[i].displayRegExp = /^.*$/gi;
                columns[i].displayReplace = format;
                break;
              case "MONTH":
                if (columns[i].formats.predefined === true) {
                  if ($.type(columns[i].formats.preFormat) === "undefined") {
                    columns[i].formats.preFormat = columns[i].formats.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].formats);
                  if (preDefinedFormat) {
                    columns[i].formats.format = preDefinedFormat;
                  } else {
                    columns[i].formats.format = dews._environments.formats.dateFormat;
                  }
                }
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                columns[i].styles.datetimeFormat = $.type(columns[i].formats.format) === "undefined" ? dews._environments.formats.monthFormat : columns[i].formats.format;
                break;
              case "FUNCTION":
                columns[i].displayCallback = function (realgrid, index, value) {
                  var dewsGrid = $(realgrid._gv._container._containerDiv).closest(".dews-data-control").data("dews-control");
                  var dewsParams = {
                    grid: dewsGrid,
                    row: {
                      index: index.itemIndex,
                      data: dewsGrid.dataItem(index.itemIndex)
                    },
                    cell: {
                      field: index.column,
                      data: dewsGrid.getCellValue(index.itemIndex, index.column)
                    }
                  };
                  return dewsGrid.columns[index.column].formats.format.call(dewsGrid, value, dewsParams);
                };
                break;
              case "BAR":
                var barRenderer = grid2._columnRenderer.getBarRenderer(columns[i]);
                $.extend(true, columns[i], barRenderer);
                break;
              case "SIGNAL":
                var signalRenderer = grid2._columnRenderer.getSignalRenderer(columns[i]);
                $.extend(true, columns[i], signalRenderer);
                break;}

          }
          if (columns[i].editor) {
            var editorAlign = "center";
            if (columns[i].styles.textAlignment) {
              editorAlign = columns[i].styles.textAlignment;
            }
            if ($.type(columns[i].editor.type) === "undefined") {
              columns[i].editor.type = "string";
            }
            if (typeof columns[i].editable === "boolean" && !columns[i].editable && columns[i].editor.type.toLowerCase() !== "check") {
              columns[i].editor.editable = columns[i].editable;
            } else {
              var userColumn;
              if (columns[i].editor.type.toLowerCase() === "check") {
                userColumn = findUserOptionsColumn2(grid2.userOptions.columns, columns[i].field);
              }
              if (userColumn && userColumn.editable !== void 0 && !userColumn.editable) {
                columns[i].editor.editable = columns[i].editable;
              } else {
                if ($.type(columns[i].editor.editable) === "boolean" || $.type(columns[i].editor.editable) === "function") {
                  columns[i].editable = columns[i].editor.editable;
                } else if ($.type(columns[i].editor.editable) === "undefined") {
                  columns[i].editor.editable = columns[i].editable;
                }
              }
            }
            columns[i].editor.textAlignment = editorAlign;
            columns[i].buttonVisibility = "hidden";
            columns[i].editButtonVisibility = "hidden";
            switch (columns[i].editor.type.toUpperCase()) {
              case "DROPDOWN":
              case "COMBO":
                var values = columns[i].editor.dataValueField,labels = columns[i].editor.dataTextField,datasource = columns[i].editor.dataSource;
                columns[i].values = [];
                columns[i].labels = [];
                columns[i].editButtonVisibility = "visible";
                if (columns[i].editor.type.toUpperCase() === "DROPDOWN") {
                  columns[i].editor.textReadOnly = true;
                  if (columns[i].editor.autoOpen) {
                    columns[i].editor.autoOpen = true;
                  }
                  columns[i].editor.useNumkey = $.type(columns[i].editor.useNumkey) === "boolean" ? columns[i].editor.useNumkey : true;
                } else {
                  columns[i].editor.textReadOnly = false;
                }
                columns[i].editor.type = "dropDown";
                columns[i].lookupDisplay = true;
                columns[i].editor.dropdowncount = 3;
                if ($.type(columns[i].editor.dataSource) === "function") {
                  datasource = columns[i].editor.dataSource.call(grid2, {
                    grid: grid2,
                    row: {
                      index: 0,
                      data: {
                        labels: "",
                        values: ""
                      }
                    }
                  });
                  if ($.type(columns[i].editor.dataTextField) === "undefined") {
                    columns[i].labelField = labels;
                  } else {
                    columns[i].labelField = columns[i].editor.textField;
                  }
                }
                if (typeof columns[i].editor.dataSelectable === "string") {
                  columns[i].editor.dataSelectable = {
                    field: columns[i].editor.dataSelectable,
                    trueValue: true,
                    falseValue: false
                  };
                }
                var dataSelectable = columns[i].editor.dataSelectable;
                columns[i].editor.values = [];
                columns[i].editor.labels = [];
                if (datasource && datasource.transport && datasource.transport.data && datasource.transport.data.length > 0) {
                  var transportData = datasource.transport.data;
                  for (var j = 0; j < datasource.transport.data.length; j += 1) {
                    columns[i].values.push(transportData[j][values]);
                    columns[i].labels.push(transportData[j][labels]);
                    if (dataSelectable && transportData[j][dataSelectable.field] !== dataSelectable.falseValue) {
                      columns[i].editor.values.push(datasource.transport.data[j][values]);
                      columns[i].editor.labels.push(datasource.transport.data[j][labels]);
                    }
                  }
                }
                break;
              case "NUMBER":
                if (columns[i].editor.predefined === true) {
                  if ($.type(columns[i].editor.preFormat) === "undefined") {
                    columns[i].editor.preFormat = columns[i].editor.format;
                  }
                  var preDefinedFormat;
                  if ($.type(columns[i].editor.currency) === "undefined") {
                    preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                  } else if ($.type(columns[i].editor.currency) === "string") {
                    columns[i].editor.preCurrency = columns[i].editor.currency;
                    preDefinedFormat = dews.getCurrencyFormat(columns[i].editor);
                  }
                  if ($.type(preDefinedFormat) === "object") {
                    preDefinedFormat = preDefinedFormat.format;
                  }
                  if (preDefinedFormat) {
                    columns[i].editor.format = preDefinedFormat;
                  } else {
                    columns[i].editor.format = "#,##0.##";
                  }
                } else {
                  columns[i].editor.format = columns[i].editor.format ? columns[i].editor.format : "#,##0.##";
                }
                var decimalPlaceRegex = /[^.]*$/;
                var includesDot = columns[i].editor.format.indexOf(".");
                var formatLetters = includesDot !== -1 ? decimalPlaceRegex.exec(columns[i].editor.format)[0] : "";
                var formatLettersLength = formatLetters.length;
                var formatLetter = formatLettersLength > 0 ? formatLetters.charAt(formatLettersLength - 1) : "#";
                var decimalLength, intLength, maxLength;
                if (typeof columns[i].editor.maxLength === "string") {
                  maxLength = columns[i].editor.maxLength;
                } else if (typeof columns[i].editor.__maxLength === "string") {
                  maxLength = columns[i].editor.__maxLength;
                }
                if ($.type(maxLength) === "string") {
                  var maxLengthRegex = /^(\d+)(?:,(\d+))?$/;
                  var matchArray = maxLengthRegex.exec(maxLength);
                  columns[i].editor.__maxLength = maxLength;
                  if (matchArray && matchArray.length > 0) {
                    intLength = parseInt(matchArray[1], 10);
                    try {
                      if (intLength > 15) {
                        throw "\uC22B\uC790\uD14D\uC2A4\uD2B8\uBC15\uC2A4 maxLength \uC18D\uC131\uC758 \uC124\uC815 \uAC00\uB2A5\uD55C \uCD5C\uB300\uAC12\uC740 15\uC785\uB2C8\uB2E4.";
                      }
                      if (matchArray[2]) {
                        var newFormat;
                        decimalLength = parseInt(matchArray[2], 10);
                        intLength = intLength - decimalLength;
                        if (intLength <= 0) {
                          throw "\uC22B\uC790\uD14D\uC2A4\uD2B8\uBC15\uC2A4 maxLength \uC18D\uC131\uC758 \uC124\uC815\uAC12\uC740 \uC815\uC218\uBD80\uC758 \uC22B\uC790\uAC00 \uC18C\uC218\uBD80\uC758 \uC22B\uC790\uBCF4\uB2E4 \uCEE4\uC57C\uD569\uB2C8\uB2E4.";
                        }
                        if (formatLettersLength > decimalLength) {
                          newFormat = (includesDot !== -1 ? columns[i].editor.format.replace(decimalPlaceRegex, "") : columns[i].editor.format + ".") + formatLetters.substr(0, decimalLength);
                        } else if (formatLettersLength < decimalLength) {
                          newFormat = (includesDot !== -1 ? columns[i].editor.format.replace(decimalPlaceRegex, "") : columns[i].editor.format + ".") + formatLetters + formatLetter.repeat(decimalLength - formatLettersLength);
                        } else {
                          newFormat = columns[i].editor.format;
                        }
                        columns[i].editor.format = newFormat;
                      } else {
                        columns[i].editor.format = columns[i].editor.format.split(".")[0];
                      }
                    } catch (e) {
                      intLength = 15 - formatLettersLength;
                      console.error(e);
                    }
                    columns[i].editor.maxIntegerLength = intLength;
                  }
                  columns[i].editor.maxLength = 0;
                } else if (typeof maxLength === "undefined") {
                  columns[i].editor.maxIntegerLength = 15 - formatLettersLength;
                }
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].dataType = "number";
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "number";
                  dataSource.field[opt2.fieldIndex].min = columns[i].editor.min;
                  dataSource.field[opt2.fieldIndex].max = columns[i].editor.max;
                }
                columns[i].editor.editFormat = $.type(columns[i].editor.format) === "undefined" ? "#,##0.##" : columns[i].editor.format;
                columns[i].editor.increaseValue = $.type(columns[i].editor.increaseValue) === "undefined" ? 1e3 : parseFloat(columns[i].editor.increaseValue);
                columns[i].editor.increaseType = $.type(columns[i].editor.increaseType) === "undefined" ? "multiple" : columns[i].editor.increaseType;
                break;
              case "STRING":
                columns[i].editor.type = "text";
                break;
              case "DATE":
                if (columns[i].editor.predefined === true) {
                  if ($.type(columns[i].editor.preFormat) === "undefined") {
                    columns[i].editor.preFormat = columns[i].editor.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                  if (preDefinedFormat) {
                    columns[i].editor.format = preDefinedFormat;
                  } else {
                    columns[i].editor.format = dews._environments.formats.dateFormat;
                  }
                }
                columns[i].editor.maxDate = new Date(9999, 12, 0);
                columns[i].editor.minDate = new Date(1e3, 0, 1);
                columns[i].editor.yearDisplayFormat = "{Y}" + dews.localize.get("\uB144", "dews_\uB144Y");
                columns[i].editor.months = dews.localize.getMonth();
                columns[i].editor.weekDays = dews.localize.getDays();
                columns[i].editor.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.dateFormat : columns[i].editor.format;
                columns[i].styles.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.dateFormat : columns[i].editor.format;
                columns[i].editor.mask = {
                  editMask: $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.dateFormat.replace(/[A-z\\s]/gi, "9") : columns[i].editor.format.replace(/[A-z\\s]/gi, "9"),
                  includedFormat: true
                };
                columns[i].editButtonVisibility = "visible";
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                break;
              case "READONLY":
                columns[i].readOnly = true;
                columns[i].editable = false;
                break;
              case "MASK":
              case "TIME":
                var editMask = columns[i].editor.format;
                if (editMask) {
                  for (var em = 0; em < editMask.length; em += 1) {
                    switch (editMask[em]) {
                      case "L":
                      case "?":
                      case "#":
                      case "&":
                        editMask = editMask.replace(editMask[em], "a");
                        break;
                      case "A":
                      case "a":
                        editMask = editMask.replace(editMask[em], "*");
                        break;
                      case "H":
                      case "m":
                      case "s":
                        editMask = editMask.replace(editMask[em], "0");
                        break;}

                  }
                }
                if (columns[i].editor.type.toUpperCase() === "TIME") {
                  columns[i].editor.type = "time";
                  if (columns[i].editor.predefined === true) {
                    if ($.type(columns[i].editor.preFormat) === "undefined") {
                      columns[i].editor.preFormat = columns[i].editor.format;
                    }
                    var preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                    if (preDefinedFormat) {
                      editMask = preDefinedFormat;
                    } else {
                      editMask = "HH:mm:ss";
                    }
                  }
                  var secondValue = false;
                  if (typeof columns[i].editor.secondValue === "boolean" && columns[i].editor.secondValue === true) {
                    secondValue = true;
                  }
                  columns[i].button = "image";
                  columns[i].buttonVisibility = "visible";
                  if ($.type(columns[i].editor.editable) === "boolean" && !columns[i].editor.editable) {
                    columns[i].buttonVisibility = "hidden";
                  }
                  var clockIcon = dews._environments.scriptBase + "realgrid/assets/comp-icon-clock.png";
                  columns[i].imageButtons = {
                    width: 24,
                    height: 22,
                    images: [
                    {
                      name: "timebutton",
                      up: clockIcon,
                      hover: clockIcon,
                      down: clockIcon
                    }]

                  };
                  if ($("#" + grid2._grid.name + "_time").length === 0) {
                    var timepicker = $('<input class="dews-ui-timepicker">');
                    timepicker.prop("id", grid2._grid.name + "_time");
                    $("body").after(timepicker);
                    columns[i].timepicker = dews.ui.timepicker(timepicker, {
                      secondValue: secondValue
                    });
                    $("body").after(columns[i].timepicker.timeView.ul.parent(".k-list-container"));
                  } else {
                    columns[i].timepicker = dews.ui.timepicker($("#" + grid2._grid.name + "_time"));
                  }
                  columns[i].timepicker.wrapper.css({
                    display: "none",
                    height: opt2.display.rowHeight
                  });
                } else {
                  columns[i].editor.type = "text";
                }
                if ($.type(editMask) === "function") {
                  columns[i].editor.mask = {
                    allowEmpty: true
                  };
                } else {
                  if (editMask !== "") {
                    columns[i].editor.mask = {
                      editMask: editMask,
                      allowEmpty: true
                    };
                  }
                }
                break;
              case "CODEPICKER":
                columns[i].editor.firstClick = true;
                columns[i].button = "image";
                columns[i].buttonVisibility = "visible";
                if ($.type(columns[i].editor.editable) === "boolean") {
                  if (!columns[i].editor.editable) {
                    columns[i].buttonVisibility = "hidden";
                  }
                }
                columns[i].imageButtons = {
                  width: 24,
                  height: 22,
                  images: [
                  {
                    name: "codepickerbutton",
                    up: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
                    hover: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
                    down: dews._environments.scriptBase + "realgrid/assets/search_ico.png"
                  }]

                };
                opt2._grid = true;
                columns[i].codeOption = {
                  field: columns[i].field,
                  code: columns[i].editor.helpCode,
                  codeField: columns[i].editor.codeField,
                  textField: columns[i].editor.textField,
                  gridCodeField: columns[i].editor.gridCodeField,
                  gridTextField: columns[i].editor.gridTextField,
                  params: columns[i].editor.helpParams,
                  size: columns[i].editor.helpSize,
                  title: columns[i].editor.helpTitle,
                  mode: "single",
                  width: columns[i].editor.helpWidth,
                  height: columns[i].editor.helpHeight,
                  initData: columns[i].editor.initData,
                  callback: columns[i].editor.callback,
                  custom: columns[i].editor.helpCustom || false,
                  viewUrl: columns[i].editor.helpViewUrl,
                  apiUrl: columns[i].editor.helpApiUrl,
                  moveFocus: $.type(columns[i].editor.moveFocus) === "boolean" ? columns[i].editor.moveFocus : true,
                  useAjax: $.type(columns[i].editor.useAjax) === "boolean" ? columns[i].editor.useAjax : true,
                  validation: $.type(columns[i].editor.validation) === "boolean" ? columns[i].editor.validation : true,
                  value: {}
                };
                break;
              case "BUTTON":
                columns[i].buttonVisibility = "always";
                if ($.type(columns[i].editor.align) !== "undefined") {
                  switch (columns[i].editor.align.toLowerCase()) {
                    case "left":
                      columns[i].editor.align = "near";
                      break;
                    case "right":
                      columns[i].editor.align = "far";
                      break;}

                }
                columns[i].renderer = {
                  type: "imageButtons",
                  showText: true,
                  width: $.type(columns[i].editor.buttonWidth) === "undefined" ? 50 : columns[i].editor.buttonWidth,
                  height: $.type(columns[i].editor.buttonHeight) === "undefined" ? 25 : columns[i].editor.buttonHeight,
                  images: {
                    up: columns[i].editor.basicImg,
                    hover: columns[i].editor.hoverImg,
                    down: columns[i].editor.clickImg,
                    width: $.type(columns[i].editor.buttonWidth) === "undefined" ? 50 : columns[i].editor.buttonWidth
                  },
                  alignment: columns[i].editor.align ? columns[i].editor.align : "center",
                  margin: columns[i].editor.align === "far" ? -4 : 0
                };
                break;
              case "CHECK":
                columns[i].renderer = {
                  type: "check",
                  shape: "box",
                  editable: $.type(columns[i].editor.editable) === "boolean" ? columns[i].editor.editable : true,
                  startEditOnClick: true,
                  trueValues: $.type(columns[i].editor.trueValue) === "undefined" ? "true" : columns[i].editor.trueValue,
                  falseValues: $.type(columns[i].editor.falseValue) === "undefined" ? "false" : columns[i].editor.falseValue,
                  trueImage: opt2.gridStyle.body.checkedImg,
                  falseImage: opt2.gridStyle.body.unCheckImg,
                  labelPosition: "none",
                  showInnerFocus: false
                };
                columns[i].editable = false;
                columns[i].styles.figureBackground = "#ff4995ff";
                break;
              case "ZIPCODEPICKER":
                columns[i].button = "image";
                columns[i].buttonVisibility = "visible";
                if ($.type(columns[i].editor.editable) === "boolean" && !columns[i].editor.editable) {
                  columns[i].buttonVisibility = "hidden";
                }
                columns[i].imageButtons = {
                  width: 24,
                  height: 22,
                  images: [
                  {
                    name: "zipcodepickerbutton",
                    up: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
                    hover: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
                    down: dews._environments.scriptBase + "realgrid/assets/search_ico.png"
                  }]

                };
                opt2._grid = true;
                columns[i].codeOption = {
                  field: columns[i].field,
                  addressType: $.type(columns[i].editor.addressType) === "undefined" ? "zipcode" : columns[i].editor.addressType,
                  callback: columns[i].editor.callback
                };
                break;
              case "MULTILINE":
                columns[i].editor.type = "multiline";
                columns[i].styles.textWrap = "explicit";
                break;
              case "MONTH":
                if (columns[i].editor.predefined === true) {
                  if ($.type(columns[i].editor.preFormat) === "undefined") {
                    columns[i].editor.preFormat = columns[i].editor.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                  if (preDefinedFormat) {
                    columns[i].editor.format = preDefinedFormat;
                  } else {
                    columns[i].editor.format = dews._environments.formats.monthFormat;
                  }
                }
                columns[i].editor.minDate = new Date(1900, 0, 1);
                columns[i].editor.maxDate = new Date(2100, 12, 0);
                columns[i].editor.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.monthFormat : columns[i].editor.format;
                columns[i].styles.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.monthFormat : columns[i].editor.format;
                columns[i].editor.mask = {
                  editMask: $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.monthFormat.replace(/[A-z\\s]/gi, "9") : columns[i].editor.format.replace(/[A-z\\s]/gi, "9"),
                  includedFormat: true
                };
                columns[i].button = "image";
                columns[i].buttonVisibility = "visible";
                if ($.type(columns[i].editor.editable) === "boolean" && !columns[i].editor.editable) {
                  columns[i].buttonVisibility = "hidden";
                }
                columns[i].imageButtons = {
                  width: 24,
                  height: 22,
                  images: [
                  {
                    name: "monthbutton",
                    up: dews._environments.scriptBase + "realgrid/assets/calendar_up.png",
                    hover: dews._environments.scriptBase + "realgrid/assets/calendar_hover.png",
                    down: dews._environments.scriptBase + "realgrid/assets/calendar_down.png"
                  }]

                };
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                if ($("#" + grid2._grid.name + "_month").length === 0) {
                  var monthpicker = $('<input class="dews-ui-monthpicker">');
                  monthpicker.prop("id", grid2._grid.name + "_month");
                  $("body").after(monthpicker);
                  columns[i].monthpicker = dews.ui.monthpicker(monthpicker);
                  $("body").after(columns[i].monthpicker.dateView.div);
                } else {
                  columns[i].monthpicker = dews.ui.monthpicker($("#" + grid2._grid.name + "_month"));
                }
                columns[i].monthpicker.wrapper.css({
                  display: "none",
                  height: opt2.display.rowHeight
                });
                break;
              case "YEAR":
                if (columns[i].editor.predefined === true) {
                  if ($.type(columns[i].editor.preFormat) === "undefined") {
                    columns[i].editor.preFormat = columns[i].editor.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                  if (preDefinedFormat) {
                    columns[i].editor.format = preDefinedFormat;
                  } else {
                    columns[i].editor.format = dews._environments.formats.yearFormat;
                  }
                }
                columns[i].editor.minDate = new Date(1900, 0, 1);
                columns[i].editor.maxDate = new Date(2100, 12, 0);
                columns[i].editor.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.yearFormat : columns[i].editor.format;
                columns[i].styles.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.yearFormat : columns[i].editor.format;
                columns[i].editor.mask = {
                  editMask: $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.yearFormat.replace(/[A-z\\s]/gi, "9") : columns[i].editor.format.replace(/[A-z\\s]/gi, "9"),
                  includedFormat: true
                };
                columns[i].button = "image";
                columns[i].buttonVisibility = "visible";
                if ($.type(columns[i].editor.editable) === "boolean" && !columns[i].editor.editable) {
                  columns[i].buttonVisibility = "hidden";
                }
                columns[i].imageButtons = {
                  width: 24,
                  height: 22,
                  images: [
                  {
                    name: "yearbutton",
                    up: dews._environments.scriptBase + "realgrid/assets/calendar_up.png",
                    hover: dews._environments.scriptBase + "realgrid/assets/calendar_hover.png",
                    down: dews._environments.scriptBase + "realgrid/assets/calendar_down.png"
                  }]

                };
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.yearValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.yearValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                if ($("#" + grid2._grid.name + "_year").length === 0) {
                  var yearpicker = $('<input class="dews-ui-yearpicker">');
                  yearpicker.prop("id", grid2._grid.name + "_year");
                  $("body").after(yearpicker);
                  columns[i].yearpicker = dews.ui.yearpicker(yearpicker, {});
                  $("body").after(columns[i].yearpicker.dateView.div);
                } else {
                  columns[i].yearpicker = dews.ui.yearpicker($("#" + grid2._grid.name + "_year"));
                }
                columns[i].yearpicker.wrapper.css({
                  display: "none",
                  height: opt2.display.rowHeight
                });
                break;}

          }
          if (columns[i].attributes) {
            if (columns[i].attributes["class"] === "required" || columns[i].attributes["class"] === "none") {
              columns[i].styles.background = columns[i].attributes["class"] === "required" ? opt2.gridStyle.body.requiredBackground : opt2.gridStyle.body.background;
              columns[i].readOnly = false;
              if (columns[i].editor && columns[i].editor.type && columns[i].editor.type.toUpperCase() === "DROPDOWN" && grid2.userOptions) {
                var currentColumn = findUserOptionsColumn2(grid2.userOptions.columns, columns[i].field);
                columns[i].editor.textReadOnly = currentColumn && currentColumn.editor && currentColumn.editor.type && currentColumn.editor.type.toUpperCase() === "COMBO" ? false : true;
              }
            } else if (columns[i].attributes["class"] === "readonly") {
              columns[i].styles.background = opt2.gridStyle.body.readonlyBackground;
              columns[i].readOnly = true;
              columns[i].editable = false;
            }
          }
          if (columns[i].footer) {
            opt2.footer.visible = true;
            if (opt2.multiFooterCnt > 1) {
              opt2.footer.count = opt2.multiFooterCnt;
              opt2.footer.minHeight = 32 * opt2.multiFooterCnt;
              var multiFooterArray = [];
              if ($.type(columns[i].footer) === "object") {
                multiFooterArray.push(columns[i].footer);
              } else if ($.type(columns[i].footer) === "array") {
                multiFooterArray = columns[i].footer;
              }
              var footerStyles = [];
              var footerExpression = [];
              var footerPreCurrency = [];
              var footerPreFormat = [];
              var footerText = [];
              for (var footerIdx = 0; footerIdx < multiFooterArray.length; footerIdx++) {
                footerStyles.push({});
                if (multiFooterArray[footerIdx].text) {
                  footerText[footerIdx] = multiFooterArray[footerIdx].text;
                }
                if (multiFooterArray[footerIdx].styles === void 0) {
                  var footerAlign = "center";
                  if (columns[i].styles.textAlignment) {
                    footerAlign = columns[i].styles.textAlignment;
                  }
                  footerStyles[footerIdx].textAlignment = footerAlign;
                }
                if ($.type(multiFooterArray[footerIdx].align) !== "undefined") {
                  switch (multiFooterArray[footerIdx].align.toLowerCase()) {
                    case "left":
                      footerStyles[footerIdx].textAlignment = "near";
                      break;
                    case "right":
                      footerStyles[footerIdx].textAlignment = "far";
                      break;
                    default:
                      footerStyles[footerIdx].textAlignment = "center";
                      break;}

                }
                if (multiFooterArray[footerIdx].type) {
                  if ($.type(opt2.fieldIndex) !== "undefined" && multiFooterArray[footerIdx].type.toLowerCase() !== "count") {
                    dataSource.field[opt2.fieldIndex].dataType = "number";
                    dataSource.schema.model.fields[opt2.fieldIndex].dataType = "number";
                  }
                  footerExpression[footerIdx] = multiFooterArray[footerIdx].type;
                  footerStyles[footerIdx].numberFormat = $.type(multiFooterArray[footerIdx].format) === "undefined" ? "#,##0.##" : multiFooterArray[footerIdx].format;
                  if (multiFooterArray[footerIdx].predefined === true) {
                    if ($.type(footerPreFormat[footerIdx]) === "undefined" || footerPreFormat[footerIdx].preFormat !== footerPreFormat[footerIdx].format) {
                      footerPreFormat[footerIdx] = multiFooterArray[footerIdx].format;
                      multiFooterArray[footerIdx].preFormat = multiFooterArray[footerIdx].format;
                    }
                    var preDefinedFormat = dews.getPreDefinedFormat(multiFooterArray[footerIdx]);
                    if ($.type(multiFooterArray[footerIdx].currency) !== "undefined") {
                      if ($.type(multiFooterArray[footerIdx].currency) === "string") {
                        footerPreCurrency[footerIdx] = multiFooterArray[footerIdx].currency;
                        multiFooterArray[footerIdx].preCurrency = multiFooterArray[footerIdx].currency;
                        preDefinedFormat = dews.getCurrencyFormat(multiFooterArray[footerIdx]);
                        if (preDefinedFormat) {
                          var round = $.type(preDefinedFormat.round) === "string" ? preDefinedFormat.round : "round";
                          if (round !== "round") {
                            if (preDefinedFormat.format.split(".").length === 2) {
                              if (round === "ceil") {
                                preDefinedFormat.format += ";;;c";
                              } else {
                                preDefinedFormat.format += ";;;f";
                              }
                            }
                          }
                        }
                      } else if ($.type(multiFooterArray[footerIdx].currency) === "function") {
                        footerPreCurrency[footerIdx] = "";
                        multiFooterArray[footerIdx].preCurrency = "";
                        grid2._grid._gv._footer._cell.__proto__.value = _displayFooterText();
                      }
                    }
                    if ($.type(preDefinedFormat) === "object") {
                      preDefinedFormat = preDefinedFormat.format;
                    }
                    if (preDefinedFormat) {
                      footerStyles[footerIdx].numberFormat = preDefinedFormat;
                    } else {
                      footerStyles[footerIdx].numberFormat = "#,##0.##";
                    }
                  }
                }
                if (multiFooterArray[footerIdx].prefix) {
                  footerStyles[footerIdx].prefix = multiFooterArray[footerIdx].prefix;
                }
                if (multiFooterArray[footerIdx].suffix) {
                  footerStyles[footerIdx].suffix = multiFooterArray[footerIdx].suffix;
                }
              }
              columns[i].footer.styles = footerStyles;
              columns[i].footer.expression = footerExpression;
              columns[i].footer.preCurrency = footerPreCurrency;
              columns[i].footer.preFormat = footerPreFormat;
              columns[i].footer.text = footerText;
            } else {
              opt2.footer.count = 1;
              if (columns[i].footer.styles === void 0) {
                var footerAlign = "center";
                if (columns[i].styles.textAlignment) {
                  footerAlign = columns[i].styles.textAlignment;
                }
                columns[i].footer.styles = {
                  textAlignment: footerAlign
                };
              }
              if ($.type(columns[i].footer.align) !== "undefined") {
                switch (columns[i].footer.align.toLowerCase()) {
                  case "left":
                    columns[i].footer.styles.textAlignment = "near";
                    break;
                  case "right":
                    columns[i].footer.styles.textAlignment = "far";
                    break;
                  default:
                    columns[i].footer.styles.textAlignment = "center";
                    break;}

              }
              if (columns[i].footer.type) {
                if ($.type(opt2.fieldIndex) !== "undefined" && columns[i].footer.type.toLowerCase() !== "count") {
                  dataSource.field[opt2.fieldIndex].dataType = "number";
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "number";
                }
                columns[i].footer.expression = columns[i].footer.type;
                columns[i].footer.styles.numberFormat = $.type(columns[i].footer.format) === "undefined" ? "#,##0.##" : columns[i].footer.format;
                if (columns[i].footer.predefined === true) {
                  if ($.type(columns[i].footer.preFormat) === "undefined" || columns[i].footer.preFormat !== columns[i].footer.format) {
                    columns[i].footer.preFormat = columns[i].footer.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].footer);
                  if ($.type(columns[i].footer.currency) !== "undefined") {
                    if ($.type(columns[i].footer.currency) === "string") {
                      columns[i].footer.preCurrency = columns[i].footer.currency;
                      preDefinedFormat = dews.getCurrencyFormat(columns[i].footer);
                      if (preDefinedFormat) {
                        var round = $.type(preDefinedFormat.round) === "string" ? preDefinedFormat.round : "round";
                        if (round !== "round") {
                          if (preDefinedFormat.format.split(".").length === 2) {
                            if (round === "ceil") {
                              preDefinedFormat.format += ";;;c";
                            } else {
                              preDefinedFormat.format += ";;;f";
                            }
                          }
                        }
                      }
                    } else if ($.type(columns[i].footer.currency) === "function") {
                      columns[i].footer.preCurrency = "";
                      grid2._grid._gv._footer._cell.__proto__.value = _displayFooterText();
                    }
                  }
                  if ($.type(preDefinedFormat) === "object") {
                    preDefinedFormat = preDefinedFormat.format;
                  }
                  if (preDefinedFormat) {
                    columns[i].footer.styles.numberFormat = preDefinedFormat;
                  } else {
                    columns[i].footer.styles.numberFormat = "#,##0.##";
                  }
                }
              }
              if (columns[i].footer.group) {
                columns[i].footer.groupExpression = columns[i].footer.group.type;
                if (columns[i].footer.group.text) {
                  columns[i].footer.groupText = columns[i].footer.group.text;
                }
              }
              if (columns[i].footer.prefix) {
                columns[i].footer.styles.prefix = columns[i].footer.prefix;
              }
              if (columns[i].footer.suffix) {
                columns[i].footer.styles.suffix = columns[i].footer.suffix;
              }
            }
          }
          if (columns[i].suffix) {
            columns[i].styles.suffix = columns[i].suffix;
          }
          if (columns[i].prefix) {
            columns[i].styles.prefix = columns[i].prefix;
          }
          if ($.type(columns[i].style) === "function") {
            opt2.styleColumn.push(columns[i].field);
          }
          if ($.type(columns[i].grouping) === "boolean" && columns[i].grouping) {
            columns[i].type = "group";
            columns[i].orientation = "vertical";
            opt2.grouping = true;
            opt2.groupCol = columns[i].columns.length;
            if (opt2.groupCol > opt2.maxGroupCol) {
              opt2.maxGroupCol = opt2.groupCol;
            }
          }
          if ($.type(columns[i].multiColumnHeight) !== "undefined") {
            if ($.type(columns[i].multiColumnHeight) === "number") {
              columns[i].multiColumnHeight = {
                header: columns[i].multiColumnHeight,
                row: columns[i].multiColumnHeight
              };
            }
          } else {
            columns[i].multiColumnHeight = {};
          }
          if ($.type(columns[i].multiColumnHeight.header) === "number") {
            columns[i].header.fillHeight = columns[i].multiColumnHeight.header;
            columns[i].header.minHeight = columns[i].multiColumnHeight.header;
            columns[i].header.fixedHeight = columns[i].multiColumnHeight.header;
          } else if ($.type(columns[i].multiColumnHeight.header) === "undefined") {
            columns[i].header.fillHeight = opt2.header.minHeight;
            columns[i].header.minHeight = opt2.header.minHeight;
            columns[i].header.fixedHeight = opt2.header.minHeight;
          }
          if ($.type(columns[i].multiColumnHeight.row) === "number") {
            columns[i].height = columns[i].multiColumnHeight.row;
            columns[i].fillHeight = columns[i].multiColumnHeight.row;
            columns[i].minHeight = columns[i].multiColumnHeight.row;
            columns[i].fixedHeight = columns[i].multiColumnHeight.row;
          } else if ($.type(columns[i].multiColumnHeight.row) === "undefined") {
            columns[i].fillHeight = opt2.display.rowHeight;
            columns[i].minHeight = opt2.display.rowHeight;
            columns[i].fixedHeight = opt2.display.rowHeight;
          }
          if (columns[i].columns) {
            columns[i].type = "group";
            if (!columns[i].hideChildHeaders) {
              opt2.depth += 1;
            }
            if ($.type(columns[i].name) === "undefined") {
              if (columns[0].field === "__UUID") {
                columns[i].name = "_he@der_name_" + d + (i - 1);
              } else {
                columns[i].name = "_he@der_name_" + d + i;
              }
            }
            if ($.type(columns[i].visible) === "boolean") {
              if (grid2._hideChildrenColumns && grid2._hideChildrenColumns[columns[i].name]) {
                columns[i].visible = false;
              } else {
                columns[i].header.visible = columns[i].visible;
              }
            } else if (columns[i].visible === "hideChildren") {
              columns[i].visible = false;
            }
            customizingColumn(columns[i].columns, opt2, grid2);
          } else {
            if (opt2.depth > opt2.maxDepth) {
              opt2.maxDepth = opt2.depth;
            }
            opt2.depth = 1;
          }
          if ($.type(columns[i].merge) !== "undefined") {
            if ($.type(columns[i].merge.verticalTop) === "boolean" && columns[i].merge.verticalTop) {
              columns[i].equalBlank = true;
            } else {
              columns[i].mergeRule = {};
              if ($.type(columns[i].merge) === "boolean") {
                columns[i].mergeRule.criteria = columns[i].merge ? "value" : "";
              } else if ($.type(columns[i].merge) === "string") {
                columns[i].mergeRule.criteria = "values['" + columns[i].merge + "'] + value";
              } else if ($.type(columns[i].merge) === "object") {
                opt2.display.showInnerFocus = $.type(columns[i].merge.innerFocus) === "undefined" ? true : columns[i].merge.innerFocus;
                columns[i].mergeRule.criteria = $.type(columns[i].merge.referenceField) !== "undefined" ? "values['" + columns[i].merge.referenceField + "'] + value" : "value";
              }
            }
          }
        }
      });
      opt2.columns = columns;
      opt2.dataSource.options = dataSource;
      grid2.dataSource = opt2.dataSource;
    }
    return opt2;
  }
  function findUserOptionsColumn2(columns, fieldName, userColumn) {
    if (!columns)
    return null;
    for (var index = 0; index < columns.length; index++) {
      if (userColumn === void 0) {
        if (columns[index].field === fieldName) {
          userColumn = columns[index];
        } else if (columns[index].columns) {
          userColumn = findUserOptionsColumn2(columns[index].columns, fieldName, userColumn);
        }
      }
    }
    return userColumn;
  }
  function _displayFooterText() {
    return function () {
      var grid2 = $(this._index._column.grid()._container._containerDiv).closest(".dews-data-control").data("dews-control");
      if (grid2 === void 0 || grid2 === null) {
        return null;
      }
      var cols = grid2.columns;
      var col = grid2.columns[this._index._column._fieldName];
      var fieldName = this._index._column._fieldName;
      if (col.footer && col.footer.predefined && col.footer.format && col.footer.currency && $.type(col.footer.currency) === "function") {
        var params = {
          grid: grid2,
          column: cols
        };
        col.footer.preCurrency = col.footer.currency.call(grid2, params);
        grid2._innerOptions.columns.some(function (value, idx) {
          if (value.fieldName === fieldName) {
            grid2._innerOptions.columns[idx].footer.preCurrency = col.footer.preCurrency;
          }
        });
        var env = dews.ui.page && dews.ui.page.env && dews.ui.page.env[col.footer.preFormat];
        var predefinedFormat = dews.getCurrencyFormat(col.footer);
        var formats = "#,###.##";
        var round = "round";
        if (env) {
          formats = env.format;
          round = dews.mathType[env.round];
        }
        if ($.type(predefinedFormat) === "object") {
          formats = predefinedFormat.format;
          round = $.type(predefinedFormat.round) === "string" ? predefinedFormat.round : round;
        } else if ($.type(predefinedFormat) === "string") {
          formats = predefinedFormat;
        }
        if (round !== "round") {
          if (formats.split(".").length === 2) {
            if (round === "ceil") {
              formats += ";;;c";
            } else {
              formats += ";;;f";
            }
          }
        }
        var column = grid2._grid.columnByField(this._index._column._fieldName);
        var numberFormat = grid2._grid.getColumnProperty(column, "footer").styles.numberFormat;
        if (numberFormat !== formats) {
          grid2._grid.setColumnProperty(column, "footer", {
            styles: {
              numberFormat: formats
            }
          });
        }
      }
      if (col.footer && col.footer.length > 1) {
        var fieldName = this._index._column._fieldName;
        var columnIndex = grid2.options.columns.findIndex(function (column2) {
          return column2.field === fieldName;
        });
        for (var footerIdx = 0; footerIdx < col.footer.length; footerIdx++) {
          if (col.footer[footerIdx].predefined && col.footer[footerIdx].format && col.footer[footerIdx].currency && $.type(col.footer[footerIdx].currency) === "function") {
            var params = {
              grid: grid2,
              column: cols
            };
            col.footer[footerIdx].preCurrency = col.footer[footerIdx].currency.call(grid2, params);
            var env = dews.ui.page && dews.ui.page.env && dews.ui.page.env[col.footer[footerIdx].preFormat];
            var predefinedFormat = dews.getCurrencyFormat(col.footer[footerIdx]);
            var formats = "#,###.##";
            var round = "round";
            if (env) {
              formats = env.format;
              round = dews.mathType[env.round];
            }
            if ($.type(predefinedFormat) === "object") {
              formats = predefinedFormat.format;
              round = $.type(predefinedFormat.round) === "string" ? predefinedFormat.round : round;
            } else if ($.type(predefinedFormat) === "string") {
              formats = predefinedFormat;
            }
            if (round !== "round") {
              if (formats.split(".").length === 2) {
                if (round === "ceil") {
                  formats += ";;;c";
                } else {
                  formats += ";;;f";
                }
              }
            }
            grid2.options.columns[columnIndex].footer.styles[footerIdx].numberFormat = formats;
          }
        }
        grid2._grid.setColumnProperty(grid2._grid.columnByField(this._index._column._fieldName), "footer", {
          styles: grid2.options.columns[columnIndex].footer.styles
        });
      }
      return this._value;
    };
  }

  // src/js/grid/realgrid/dataProvider.js
  function setRow(grid2, rows) {
    return function (data, start, count) {
      var self = this;
      grid2.options.dataBounding = true;
      grid2.options.data = data;
      grid2.options._UUID = {};
      if (grid2.options.rowDynamic.length !== 0) {
        grid2.options.rowDynamic = [];
      }
      if (!self._checkClientState())
      return;
      start = arguments.length > 1 ? start : 0;
      count = arguments.length > 2 ? count : -1;
      if (count === 0) {
        return;
      }
      self.refreshFieldFormats();
      self.beginUpdate();
      try {
        self.$_clearRows();
        var checkSt = self.isCheckStates();
        var filters = self._filters;
        var len, end, n, r, i, row;
        if (data && (len = data.length) > 0 && start < len) {
          start = Math.max(0, start);
          if (count < 0) {
            count = len;
          } else {
            count = Math.min(count, len - start);
          }
          if (filters) {
            self._values.length = self._rowIds.length = self._rowStates.length = count;
            filters.prepare(self);
            end = len;
            r = n = 0;
            for (i = start; i < end && r < count; i++) {
              row = data[i];
              if (!$.isArray(row)) {
                row = objectToRow(self, grid2, row, i, end);
              }
              if (filters.select(n++, row)) {
                self._internalSetRow(r++, row, checkSt);
              }
            }
            self._values.length = self._rowIds.length = self._rowStates.length = r;
          } else {
            end = Math.min(len, start + count);
            if (end > start) {
              self._values.length = self._rowIds.length = self._rowStates.length = end - start;
              r = 0;
              for (i = start; i < end; i++) {
                row = data[i];
                if (!$.isArray(row)) {
                  row = objectToRow(self, grid2, row, i, end);
                }
                self._internalSetRow(r++, row, checkSt);
              }
            }
          }
        }
      } finally {
        self.endUpdate(false);
      }
      self.tags().setRows();
      self._fireRefresh();
      self._fireRowCountChanged();
      if (data && data.length === 0 && grid2.options.dataBounding) {
        grid2._grid.onCurrentChanging.call(grid2, grid2._grid, grid2._grid.getCurrent(), grid2._grid.getCurrent());
        grid2._grid.onCurrentChanged.call(grid2, grid2._grid, grid2._grid.getCurrent());
      }
      if (data.length > 0 && grid2._grid.getCurrent().dataRow === -1 && grid2.options.dataBounding) {
        grid2._grid.onCurrentChanging.call(grid2, grid2._grid, grid2._grid.getCurrent(), grid2._grid.getCurrent());
        grid2._grid.onCurrentChanged.call(grid2, grid2._grid, grid2._grid.getCurrent(), grid2._grid.getCurrent());
      }
    };
  }
  function insertRows(grid2, rows) {
    return function (row, rows2, start, count, rowEvents, itemIndex) {
      var self = this;
      if ($.type(grid2.options._UUID) === "undefined") {
        grid2.options._UUID = {};
      }
      start = arguments.length > 2 ? start : 0;
      count = arguments.length > 3 ? count : -1;
      rowEvents = arguments.length > 4 ? rowEvents : false;
      var len;
      if (!rows2 || (len = rows2.length) < 1) {
        if (!grid2.dataSource.options.paging) {
          return;
        }
      }
      var i, end, r, v;
      count = count < 0 ? len : Math.min(len, count);
      if (count == 0) {
        if (!grid2.dataSource.options.paging) {
          return;
        }
      }
      self._checkClientState();
      if (row < 0 || row > this._values.length) {
        throw new RangeError("row is out of bounds:" + row);
      }
      self.refreshFieldFormats();
      start = Math.max(0, start);
      end = Math.min(len, start + count);
      if (rowEvents) {
        r = row;
        for (i = start; i < end; i++) {
          if (self._fireRowInserting(r)) {
            v = rows2[i];
            if (!_isArray(v)) {
              v = objectToRow(self, grid2, v, i, end);
            }
            self._internalInsertRow(r, v);
            self.tags().insertRow(r);
            self._fireRowInserted(r);
            self._fireRowCountChanged();
            r++;
          }
        }
      } else {
        r = row;
        for (i = start; i < end; i++, r++) {
          v = rows2[i];
          if ($.type(v) !== "array") {
            v = objectToRow(self, grid2, v, i, end);
          }
          self._internalInsertRow(r, v);
        }
        self.tags().insertRows(row, count = end - start);
        self._fireRowsInserted(row, count, itemIndex);
        self._fireRowCountChanged();
      }
      if (grid2.options.dataSource.options.paging && grid2.options.dataSource.options.pagingType === "background") {
        var progress,progressID = grid2.$element.attr("id") + "largeData";
        if (row + rows2.length > 0) {
          if (grid2.options.dataSource.options.index === 0) {
            progress = dews.ui.progress(progressID, {
              total: grid2.options.dataSource.options.totalCount,
              textTemplate: dews.localize.get("\uB370\uC774\uD130\uB97C \uBD88\uB7EC\uC624\uACE0 \uC788\uC2B5\uB2C8\uB2E4.", "dews_\uB370\uC774\uD130\uB97C \uBD88\uB7EC\uC624\uACE0 \uC788\uC2B5\uB2C8\uB2E4.") + " <strong>#=percent#</strong>",
              target: grid2.$element,
              _paging: true
            });
          }
          progress = dews.ui.progress(progressID);
          progress.setCurrent(row + rows2.length);
        }
      }
      if (grid2.options.dataSource.options.paging) {
        grid2.options.dataBounding = true;
        grid2._grid.onCurrentChanging.call(grid2, grid2._grid, grid2._grid.getCurrent(), grid2._grid.getCurrent());
        grid2._grid.onCurrentChanged.call(grid2, grid2._grid, grid2._grid.getCurrent());
      }
    };
  }
  function insertRow(grid2) {
    return function (row, values, itemIndex) {
      var self = this;
      if ($.type(grid2.options._UUID) === "undefined") {
        grid2.options._UUID = {};
      }
      if (!self._checkClientState())
      return false;
      if (row < 0 || row > self._values.length) {
        throw new RangeError("row is out of bounds:" + row);
      }
      this.refreshFieldFormats();
      if (values && self._fireRowInserting(row, values)) {
        grid2._filterManager.validateFilterRowData(values);
        if ($.type(values) !== "array") {
          values = objectToRow(self, grid2, values, row, row + 1);
        }
        self._internalInsertRow(row, values);
        self.tags().insertRow(row);
        self._fireRowInserted(row, itemIndex);
        self._fireRowCountChanged();
        return true;
      }
      return false;
    };
  }
  function objectToRow(self, gridObj, values, index, endLength) {
    var row = [];
    var grid2 = gridObj;
    grid2._grid.setAllCheck(false);
    if ($.type(values.__UUID) === "undefined") {
      $.extend(true, values, { __UUID: dews.createUUid(guid()) });
    }
    if (values) {
      var i,fld,columns,column,length = endLength - 1,cnt = self.fieldCount();
      for (i = 0; i < cnt; i++) {
        fld = self.getOrgFieldName(i);
        columns = grid2.columns[fld];
        if (columns && columns.formats && columns.formats.type.toLowerCase() === "datasource") {
          var colFormatsDataSource = columns.formats.dataSource,fetchDataSource;
          if (colFormatsDataSource && index === 0) {
            colFormatsDataSource.col = columns;
            colFormatsDataSource.fetch(function () {
              fetchDataSource = this;
            }).done(function () {
              var column2 = grid2._grid.columnByField(fetchDataSource.col.field);
              var values2 = [],labels = [];
              var colFormatsDataSourceData = fetchDataSource.col.formats.dataSource.data();
              if (colFormatsDataSourceData.length > 0) {
                for (var k = 0; k < colFormatsDataSourceData.length; k++) {
                  values2.push(
                  colFormatsDataSourceData[k][fetchDataSource.col.formats.dataValueField]);

                  labels.push(colFormatsDataSourceData[k][fetchDataSource.col.formats.dataTextField]);
                }
              }
              column2.labels = labels;
              column2.values = values2;
              grid2._grid.setColumn(column2);
              grid2._grid.setColumnProperty(column2, "width", column2.width);
              delete fetchDataSource.col;
            });
          }
        }
        if (values.hasOwnProperty(fld)) {
          row[i] = values[fld];
        }
        if (columns && columns.editor && columns.editor.type.toLowerCase() === "dropdown") {
          var col, fetchData, datasource;
          if ($.type(columns.editor.dataSource) === "function") {
            col = grid2._grid.columnByField(columns.fieldName);
            datasource = columns.editor.dataSource;
            var e = {
              grid: grid2,
              row: {
                index: index,
                data: values
              }
            };
            datasource = columns.editor.dataSource.call(grid2, e);
            col.values = [];
            col.labels = [];
            if (_typeof(col.editor) !== "object") {
              col.editor = {
                type: "dropDown",
                values: [],
                labels: []
              };
            }
            if (_typeof(datasource.column) !== "object") {
              datasource.column = {};
            }
            datasource.col = col;
            datasource.fetch(function () {
              fetchData = this;
            }).done(function () {
              if (fetchData.col) {
                var dropdownColumn = grid2.columns[fetchData.col.fieldName];
                $.each(fetchData.data(), function (idx, data) {
                  if (dropdownColumn.editor.dataSelectable && data[dropdownColumn.editor.dataSelectable.field] !== dropdownColumn.editor.dataSelectable.falseValue) {
                    fetchData.col.editor.values.push(data[dropdownColumn.editor.dataValueField]);
                    fetchData.col.editor.labels.push(data[dropdownColumn.editor.dataTextField]);
                  }
                  fetchData.col.values.push(data[dropdownColumn.editor.dataValueField]);
                  fetchData.col.labels.push(data[dropdownColumn.editor.dataTextField]);
                });
                if ($.type(dropdownColumn.editor.textField) === "undefined") {
                  fetchData.col.labelField = dropdownColumn.editor.dataTextField;
                } else {
                  fetchData.col.labelField = dropdownColumn.editor.textField;
                }
                fetchData.col.lookupDisplay = true;
                grid2._grid.setColumn(fetchData.col);
                fetchData.transport.data = fetchData.data();
                delete fetchData.col;
              }
            });
          } else if ($.type(columns.editor.dataSource) !== "function" && index === 0) {
            col = grid2._grid.columnByField(columns.fieldName);
            datasource = columns.editor.dataSource;
            col.values = [];
            col.labels = [];
            if (_typeof(col.editor) !== "object") {
              col.editor = {
                type: "dropDown",
                values: [],
                labels: []
              };
            }
            datasource.col = col;
            datasource.fetch(function () {
              fetchData = this;
            }).done(function () {
              var dropdownColumn = grid2.columns[fetchData.col.fieldName];
              $.each(fetchData.data(), function (idx, data) {
                if (dropdownColumn.editor.dataSelectable && data[dropdownColumn.editor.dataSelectable.field] !== dropdownColumn.editor.dataSelectable.falseValue) {
                  fetchData.col.editor.values.push(data[dropdownColumn.editor.dataValueField]);
                  fetchData.col.editor.labels.push(data[dropdownColumn.editor.dataTextField]);
                }
                fetchData.col.values.push(data[dropdownColumn.editor.dataValueField]);
                fetchData.col.labels.push(data[dropdownColumn.editor.dataTextField]);
              });
              fetchData.col.lookupDisplay = true;
              grid2._grid.setColumn(fetchData.col);
              fetchData.transport.data = fetchData.data();
              delete fetchData.col;
            });
          }
        }
      }
    }
    if ($.type(grid2.options._UUID) === "undefined") {
      grid2.options._UUID = {};
    }
    grid2.options._UUID[values["__UUID"]] = values;
    return row;
  }
  function setJsonRows(treeGrid, rows) {
    return function (data, children, prop, image) {
      var self = this,previous = treeGrid._grid.getCurrent().itemIndex,items = data[children];
      treeGrid.options.dataBounding = true;
      treeGrid.options.data = data;
      treeGrid.options.__UUID = {};
      if (treeGrid.options.rowDynamic.length !== 0) {
        treeGrid.options.rowDynamic = [];
      }
      if (!this._checkClientState())
      return;
      if (rows) {
        this.beginUpdate();
        try {
          this._clearRows();
          this.refreshFieldFormats();
          var source = this._jsonTreeRows;
          source.__proto__.$_buildTree = $_buildTree();
          this._rowCount = source.load(null, data, children, this.getFieldIndex(prop), this.getFieldIndex(image));
        } finally {
          this.endUpdate(false);
        }
      }
      this._tags.setRows();
      this._fireReset();
      this._fireRowCountChanged();
      function $_buildTree() {
        return function (provider, parent, source2, rowsProp, childrenField, iconField) {
          function build(self2, p, rows2, fldNames2) {
            var flds = fldNames2.length;
            for (var i = 0, cnt = rows2.length; i < cnt; i++) {
              var obj = rows2[i];
              var vals = new Array(flds);
              $.extend(true, obj, {
                __UUID: dews.createUUid(guid())
              });
              for (var c = 0; c < flds; c++) {
                var fld = fldNames2[c];
                var column = treeGrid.columns[fld];
                if (obj.hasOwnProperty(fld)) {
                  vals[c] = obj[fld];
                  if (fld === "__UUID")
                  treeGrid.options.__UUID[obj[fld]] = obj;
                  if (column && column.editor && column.editor.type.toLowerCase() === "dropdown") {
                    var col, fetchData, datasource;
                    if ($.type(column.editor.dataSource) === "function") {
                      col = treeGrid._grid.columnByField(column.fieldName);
                      datasource = column.editor.dataSource;
                      var e = {
                        grid: treeGrid,
                        row: {
                          index: i,
                          data: obj
                        }
                      };
                      datasource = column.editor.dataSource.call(treeGrid, e);
                      col.values = [];
                      col.labels = [];
                      if (_typeof(col.editor) !== "object") {
                        col.editor = {
                          type: "dropDown",
                          values: [],
                          labels: []
                        };
                      }
                      datasource.col = col;
                      datasource.fetch(function () {
                        fetchData = this;
                      }).done(function () {
                        if (fetchData.col) {
                          var dropdownColumn = treeGrid.columns[fetchData.col.fieldName];
                          $.each(fetchData.data(), function (idx, data2) {
                            fetchData.col.values.push(
                            data2[dropdownColumn.editor.dataValueField]);

                            fetchData.col.labels.push(
                            data2[dropdownColumn.editor.dataTextField]);

                            if (dropdownColumn.editor.dataSelectable && data2[dropdownColumn.editor.dataSelectable.field] !== dropdownColumn.editor.dataSelectable.falseValue) {
                              fetchData.col.editor.values.push(
                              data2[dropdownColumn.editor.dataValueField]);

                              fetchData.col.editor.labels.push(
                              data2[dropdownColumn.editor.dataTextField]);

                            }
                          });
                          if ($.type(dropdownColumn.editor.textField) === "undefined") {
                            fetchData.col.labelField = dropdownColumn.editor.dataTextField;
                          } else {
                            fetchData.col.labelField = dropdownColumn.editor.textField;
                          }
                          fetchData.col.lookupDisplay = true;
                          treeGrid._grid.setColumn(fetchData.col);
                          fetchData.transport.data = fetchData.data();
                          delete fetchData.col;
                        }
                      });
                    } else if ($.type(column.editor.dataSource) !== "function" && i === 0) {
                      col = treeGrid._grid.columnByField(column.fieldName);
                      datasource = column.editor.dataSource;
                      col.values = [];
                      col.labels = [];
                      if (_typeof(col.editor) !== "object") {
                        col.editor = {
                          type: "dropDown",
                          values: [],
                          labels: []
                        };
                      }
                      datasource.col = col;
                      datasource.fetch(function () {
                        fetchData = this;
                      }).done(function () {
                        var dropdownColumn = treeGrid.columns[fetchData.col.fieldName];
                        $.each(fetchData.data(), function (idx, data2) {
                          if (dropdownColumn.editor.dataSelectable && data2[dropdownColumn.editor.dataSelectable.field] !== dropdownColumn.editor.dataSelectable.falseValue) {
                            fetchData.col.editor.values.push(
                            data2[dropdownColumn.editor.dataValueField]);

                            fetchData.col.editor.labels.push(
                            data2[dropdownColumn.editor.dataTextField]);

                          }
                          fetchData.col.values.push(
                          data2[dropdownColumn.editor.dataValueField]);

                          fetchData.col.labels.push(
                          data2[dropdownColumn.editor.dataTextField]);

                        });
                        fetchData.col.lookupDisplay = true;
                        treeGrid._grid.setColumn(fetchData.col);
                        fetchData.transport.data = fetchData.data();
                        delete fetchData.col;
                      });
                    }
                  }
                }
              }
              var row = self2._addRow(parent, p, childrenField, iconField, vals);
              if (obj.hasOwnProperty(rowsProp)) {
                var arr = obj[rowsProp];
                if (Array.isArray(arr) && arr.length > 0)
                build(self2, row, arr, fldNames2);
              }
            }
          }
          var fldNames = provider.getOrgFieldNames();
          build(this, parent, source2, fldNames);
        };
      }
      if ((items && items.length === 0 || previous === treeGrid._grid.getCurrent().itemIndex) && treeGrid.options.dataBounding) {
        treeGrid._grid.onCurrentChanging.call(
        treeGrid,
        treeGrid._grid,
        treeGrid._grid.getCurrent(),
        treeGrid._grid.getCurrent());

        treeGrid._grid.onCurrentChanged.call(treeGrid, treeGrid._grid, treeGrid._grid.getCurrent());
      }
      return this._rowCount;
    };
  }
  function createRow(treeGrid, orgCreateRow) {
    return function (values, iconIndex, hasChildren) {
      var self = this;
      treeGrid._filterManager.validateFilterRowData(values);
      var row = orgCreateRow.call(self, values, iconIndex, hasChildren);
      if (Array.isArray(row._values))
      row._values.splice(0, 1, dews.createUUid(guid()));
      var fldNames = this.getOrgFieldNames();
      for (var c = 0; c < fldNames.length; c++) {
        var fld = fldNames[c];
        var column = treeGrid.columns[fld];
        if (column && column.editor && column.editor.type.toLowerCase() === "dropdown") {
          var col, fetchData, datasource;
          if ($.type(column.editor.dataSource) === "function") {
            col = treeGrid._grid.columnByField(column.fieldName);
            datasource = column.editor.dataSource;
            var e = {
              grid: treeGrid,
              row: {
                index: row._rowId,
                data: row._values
              }
            };
            datasource = column.editor.dataSource.call(treeGrid, e);
            col.values = [];
            col.labels = [];
            datasource.col = col;
            datasource.fetch(function () {
              fetchData = this;
            }).done(function () {
              var dropdownColumn = treeGrid.columns[fetchData.col.fieldName];
              $.each(fetchData.data(), function (idx, data) {
                fetchData.col.values.push(data[dropdownColumn.editor.dataValueField]);
                fetchData.col.labels.push(data[dropdownColumn.editor.dataTextField]);
              });
              if ($.type(dropdownColumn.editor.textField) === "undefined") {
                fetchData.col.labelField = dropdownColumn.editor.dataTextField;
              } else {
                fetchData.col.labelField = dropdownColumn.editor.textField;
              }
              fetchData.col.lookupDisplay = true;
              treeGrid._grid.setColumn(fetchData.col);
              fetchData.transport.data = fetchData.data();
              delete fetchData.col;
            });
          } else if ($.type(column.editor.dataSource) !== "function") {
            col = treeGrid._grid.columnByField(column.fieldName);
            datasource = column.editor.dataSource;
            col.values = [];
            col.labels = [];
            datasource.col = col;
            datasource.fetch(function () {
              fetchData = this;
            }).done(function () {
              var dropdownColumn = treeGrid.columns[fetchData.col.fieldName];
              $.each(fetchData.data(), function (idx, data) {
                fetchData.col.values.push(data[dropdownColumn.editor.dataValueField]);
                fetchData.col.labels.push(data[dropdownColumn.editor.dataTextField]);
              });
              fetchData.col.lookupDisplay = true;
              treeGrid._grid.setColumn(fetchData.col);
              fetchData.transport.data = fetchData.data();
              delete fetchData.col;
            });
          }
        }
      }
      return row;
    };
  }
  function guid() {
    return "xxxxxxxx-xxxx-4xxx-9xxx-xxxxxxxxxxxx".replace(/[xy]/g, function (c) {
      var r = Math.random() * 16 | 0,v = c == "x" ? r : r & 3 | 8;
      return v.toString(16);
    });
  }

  // src/js/grid/api/gridAPI.js
  var GridAPI = /*#__PURE__*/function (_Api3) {"use strict";_inherits(GridAPI, _Api3);var _super8 = _createSuper(GridAPI);function GridAPI() {_classCallCheck(this, GridAPI);return _super8.apply(this, arguments);}_createClass(GridAPI, [{ key: "addRow", value:
      function addRow(param) {
        var self = this,dataRow,obj = {
            editing: true
          },displayColumns = self.options.displayColumns;
        if ($.type(param) === "object") {
          obj.row = $.type(param.index) === "number" ? param.index : void 0;
          obj.editing = $.type(param.editing) === "boolean" ? param.editing : true;
        } else if ($.type(param) === "number") {
          obj.row = param;
        }
        if ($.type(self.options.dataBounding) === "boolean" && !self.options.dataBounding) {
          self.options.dataBounding = true;
        }
        if ($.type(self._grid.getGroupFields()) !== "array") {
          self.options.add = true;
        }
        self._grid.commit();
        self._grid.setOptions({ edit: { insertable: true, appendable: true } });
        if ($.type(self.options.dataSource) !== "undefined" && self.options.dataSource.dataProvider.getRowCount() === 0) {
          self.options.dataSource.add({});
          delete self.options.dataBounding;
        } else if ($.type(obj.row) === "number") {
          if (self.options.dataSource.dataProvider.getRowCount() <= obj.row) {
            self.options.dataSource.dataProvider.addRow({});
          } else {
            self._grid.beginInsertRow(obj.row);
            self._grid.commit(true);
            self.options.insert = true;
          }
        } else {
          self.options.dataSource.dataProvider.addRow({});
        }
        self._grid.setOptions({ edit: { insertable: false, appendable: false } });
        dataRow = self._grid.getItemIndex(self.options.dataSource.dataProvider.getRowCount() - 1);
        if ($.type(self._grid.getGroupFields()) === "array") {
          self.options.add = true;
        }
        if ($.type(obj.row) !== "undefined") {
          dataRow = obj.row;
        }
        if (self._grid.getEditOptions().editable) {
          var parameter = {
            grid: self,
            row: {
              index: dataRow,
              data: self._grid.getValues(dataRow)
            },
            cell: {
              field: ""
            }
          };
          var editor;
          for (var i = 0; i < self.options.displayColumns.length; i += 1) {
            if ($.type(displayColumns[i].editor.editable) === "function") {
              editor = displayColumns[i].editor.editable.call(self, parameter);
            } else {
              editor = displayColumns[i].editor.editable;
            }
            parameter.cell.field = displayColumns[i].field;
            if (editor && self._grid.getColumnProperty(displayColumns[i].field, "visible")) {
              if (displayColumns[i].fieldName === self._grid.getCurrent().fieldName && self.options.insert) {
                delete self.options.insert;
              }
              if ($.type(displayColumns[i].editor.editable) === "function" && displayColumns[i].editor.editable.call(self, parameter)) {
                if (self._grid.getColumnProperty(displayColumns[i].field, "editor").toLowerCase() === "codepicker") {
                  self._grid.setColumnProperty(displayColumns[i].field, "buttonVisibility", "visible");
                }
                self._grid.setCurrent({
                  itemIndex: dataRow,
                  columns: displayColumns[i].field,
                  dataRow: self._grid.getDataRow(dataRow),
                  fieldIndex: i,
                  fieldName: displayColumns[i].field
                });
                if (obj.editing) {
                  setTimeout(function () {
                    self._grid.showEditor();
                  });
                }
                break;
              } else if ($.type(displayColumns[i].editor.editable) === "boolean") {
                self._grid.setCurrent({
                  itemIndex: dataRow,
                  columns: displayColumns[i].field,
                  dataRow: self._grid.getDataRow(dataRow),
                  fieldIndex: i,
                  fieldName: displayColumns[i].field
                });
                if (obj.editing) {
                  setTimeout(function () {
                    self._grid.showEditor();
                  });
                }
                break;
              }
            }
            if (displayColumns.length - 1 === i) {
              delete self.options.insert;
              self._grid.setCurrent({
                itemIndex: dataRow,
                columns: self._grid.getCurrent().column,
                dataRow: self._grid.getDataRow(dataRow),
                fieldIndex: self._grid.getCurrent().fieldIndex,
                fieldName: self._grid.getCurrent().fieldName
              });
            }
          }
        } else {
          delete self.options.insert;
          self._grid.setCurrent({
            itemIndex: dataRow,
            columns: self._grid.getCurrent().column,
            dataRow: self._grid.getDataRow(dataRow),
            fieldIndex: self._grid.getCurrent().fieldIndex,
            fieldName: self._grid.getCurrent().fieldName
          });
        }
      } }, { key: "removeRow", value:
      function removeRow(row) {
        var self = this,event,parameter,rows = [],dynamicRow = [];
        var dataProvider = self.options.dataSource.dataProvider;
        if ($.type(row) === "array") {
          rows = row;
        } else {
          rows.push(row);
        }
        rows.sort(function (a, b) {
          return a - b;
        });
        var colLength = self._grid.getColumns().length,colList = self._grid.getDisplayColumns(),codepickerVal = {},codepickerField = [],isCodepicker = false;
        for (var i = 0; i < colLength; i++) {
          if (self._grid.getColumnProperty(colList[i], "editor") === "codepicker" && self.columns[colList[i]].codeOption && self.columns[colList[i]].codeOption.value !== void 0) {
            isCodepicker = true;
            if (Object.keys(self.columns[colList[i]].codeOption.value).length > -1) {
              codepickerVal = self.columns[colList[i]].codeOption.value;
              codepickerField.push(colList[i]);
            }
          }
        }
        if (rows[0] > -1 && self._grid._dataSource.getJsonRow(self._grid.getDataRow(rows[0]))) {
          var setCriteriaIndex = function setCriteriaIndex(value) {
              var removeIndex = findCriteriaIndex(value);
              if (removeIndex > -1) {
                self.options.rowDynamic.splice(removeIndex, 1);
                self.options.rowDynamic = self.options.rowDynamic.map(function (row2) {
                  var dataRow = Number(row2.criteria.replace(/[^0-9]/g, ""));
                  row2.criteria = dataRow > value ? "(dataRow = " + (dataRow - 1) + ")" : row2.criteria;
                  return row2;
                });
              }
            },findCriteriaIndex = function findCriteriaIndex(value) {
              return self.options.rowDynamic.findIndex(function (row2) {
                var dataRow = Number(row2.criteria.replace(/[^0-9]/g, ""));
                return dataRow === value;
              });
            };
          parameter = {
            grid: self,
            row: {
              data: self.dataItems(rows),
              index: rows
            }
          };
          event = new $.Event("rowRemove", parameter);
          self.$element.trigger(event);
          if (self.options.rowDynamic.length !== 0) {
            for (var d = 0; d < self.options.rowDynamic.length; d += 1) {
              var criteria = self.options.rowDynamic[d].criteria.replace("(dataRow = ", "");
              criteria = parseInt(criteria.replace(")", ""));
              dynamicRow.push(criteria);
            }
          }
          for (var j = rows.length - 1; j >= 0; j -= 1) {
            if (dynamicRow.length !== 0) {
              setCriteriaIndex(self.getDataIndexFromItemIndex(rows[j]));
              self._grid.setStyles({
                body: {
                  dynamicStyles: self.options.rowDynamic
                }
              });
            }
            if (dataProvider.getRowState(self._grid.getDataRow(rows[j])) !== "created") {
              self.options.dataSource.options._destroy.push(
              dataProvider.getJsonRow(self._grid.getDataRow(rows[j])));

            }
            if (rows[j] <= self.select()) {
              self.options.remove = true;
            }
            var delDataIndex = self._grid.getDataRow(rows[j]);
            dataProvider.removeRow(delDataIndex);
            if (isCodepicker) {
              for (var k = 0; k < codepickerField.length; k++) {
                var val = self.columns[codepickerField[k]].codeOption.value;
                delete val[delDataIndex];
                self.columns[codepickerField[k]].codeOption.value = rearrange(val, dataProvider.getRowCount());
              }
            }
          }
        }
        function rearrange(value, length) {
          var values = [],rearrangeVal = {};
          for (i in value) {
            values.push(value[i]);
          }
          for (var l = 0; l < length; l++) {
            rearrangeVal[l] = values[l];
          }
          return rearrangeVal;
        }
      } }, { key: "cancelRow", value:
      function cancelRow(addDataCancel) {
        var self = this,current = self._grid.getCurrent().dataRow;
        _get(_getPrototypeOf(GridAPI.prototype), "cancelRow", this).call(this, current, addDataCancel);
      } }, { key: "cancelCell", value:
      function cancelCell() {
        var self = this,column = self._grid.getCurrent().column.toUpperCase(),row = self._grid.getCurrent().dataRow,dataSource = self.options.dataSource,fieldIndex = 0,originData;
        if (dataSource && dataSource.dataProvider) {
          fieldIndex = dataSource.dataProvider._dp._fieldNames.indexOf(column);
          originData = $.type(dataSource.dataProvider._dp._orgValues[row]) === "undefined" ? dataSource.dataProvider._dp._values[row] : dataSource.dataProvider._dp._orgValues[row];
          if (dataSource.dataProvider.getRowState(row) === "created") {
            self._grid.setValue(row, column, void 0);
          } else if ($.type(originData) !== "undefined") {
            self._grid.setValue(row, column, originData[fieldIndex]);
          }
        }
      } }, { key: "dataItem", value:
      function dataItem(row) {
        var self = this,data = self._grid.getValues(row);
        if (data) {
          delete data.__rowId;
        }
        return data;
      } }, { key: "dataItems", value:
      function dataItems(row) {
        var self = this,datasource = [],rowCount;
        if (self.options.dataSource && $.type(row) !== "undefined") {
          rowCount = self.options.dataSource.dataProvider.getRowCount();
          if ($.type(row) === "number" && row > -1) {
            return row >= rowCount ? null : self.options.dataSource.at(self._grid.getValues(row).__rowId);
          } else if (row.length > 0 && $.type(row) === "array") {
            $.each(row, function (index, data) {
              datasource.push(
              row >= rowCount ? null : self.options.dataSource.at(self._grid.getValues(data).__rowId));

            });
          }
          return datasource;
        } else {
          return self.options.dataSource.data();
        }
      } }, { key: "editCell", value:
      function editCell() {
        this._grid.showEditor();
      } }, { key: "commitCell", value:
      function commitCell() {
        this._grid.commitEditor();
        this._grid.commit(true);
      } }, { key: "closeCell", value:
      function closeCell() {
        this._grid.cancelEditor();
        this._grid.cancel();
      } }, { key: "getCellValue", value:
      function getCellValue(row, field) {
        return this._grid.getValue(row, field);
      } }, { key: "getEditCellValue", value:
      function getEditCellValue() {
        return this._grid.getEditValue();
      } }, { key: "setCellValue", value:
      function setCellValue(row, field, value, isSave, isCallback) {
        var self = this;
        var previous = self._grid.getValue(row, field);
        var onEditCell = true;
        var column = self.columns[field];
        var dataIndex;
        var _row = Array.isArray(row) ? row : [row];
        _row.forEach(function (itemIndex) {
          if (itemIndex !== -1) {var _column$editor3;
            self._grid.setValue(itemIndex, field, value);
            if ((column === null || column === void 0 ? void 0 : (_column$editor3 = column.editor) === null || _column$editor3 === void 0 ? void 0 : _column$editor3.type) === "codepicker") {
              dataIndex = self.getDataIndexFromItemIndex(itemIndex);
              column.codeOption.value[dataIndex] = dews.ui.gridUtil._codeOptionValue("", "", value);
            }
          }
        });
        if (typeof isSave === "boolean") {
          onEditCell = isSave;
        }
        if (value !== previous && self._grid.columnByField(field) !== null) {
          self._grid.onCellEdited.call(
          self,
          self._grid,
          row,
          row,
          self._grid.columnByField(field).dataIndex,
          onEditCell);

        }
        self._grid.commit();
        self.options.commit = true;
        if (typeof isCallback === "boolean" && isCallback) {
          _row.forEach(function (itemIndex) {
            var index = {
              itemIndex: itemIndex,
              dataRow: self.getDataIndexFromItemIndex(itemIndex),
              fieldName: field
            };
            self._codepickerCallbackCall(self, index, column);
          });
        }
      } }, { key: "_codepickerCallbackCall", value:
      function _codepickerCallbackCall(self, index, column) {var _column$editor4, _column$editor4$type;
        if ((column === null || column === void 0 ? void 0 : (_column$editor4 = column.editor) === null || _column$editor4 === void 0 ? void 0 : (_column$editor4$type = _column$editor4.type) === null || _column$editor4$type === void 0 ? void 0 : _column$editor4$type.toLowerCase()) === "codepicker") {
          var codeOption = column.codeOption;
          if (typeof self.options.callback === "function") {
            delete self.options.callback;
          }
          if (column.editor.callback) {
            self.options.callback = column.editor.callback;
          }
          if (typeof column.editor.helpParams === "function") {
            codeOption.params = column.editor.helpParams.call(self, {
              data: self._innerOptions._gridType === "GRID" ? self.dataItem(index.itemIndex) : self.dataItem(index.dataRow)
            });
          } else {
            codeOption.params = column.editor.helpParams;
          }
          var keyword = self._grid.getValue(index.itemIndex, column.field);
          codeOption.params = $.extend(true, codeOption.params, { keyword: keyword });
          codeOption.callbacks = function (data) {
            if (typeof data !== "undefined") {
              if (Array.isArray(data) && data.length !== 1 || !codeOption.useAjax) {
                self._grid.onImageButtonClicked.call(self, self._grid, index.itemIndex, column);
              } else {
                if (self.options._grid === true && typeof self.options._gridCallback === "function") {
                  self.options._gridCallback(data, column, index.itemIndex);
                  delete codeOption.codesearch;
                  if (codeOption.moveFocus) {
                    dews.ui.gridUtil.nextFocus(self, index);
                  }
                }
              }
            } else {
              self._grid.onImageButtonClicked.call(self, self._grid, index.itemIndex, column);
            }
          };
          delete codeOption.callback;
          var helpEvent = new $.Event("codesearch", codeOption);
          self.$element.closest(".dews-data-control").trigger(helpEvent);
        }
      } }, { key: "setCheck", value:
      function setCheck(index, value, flag) {
        var self = this;
        if ($.type(index) === "number") {
          self._grid.checkItem(index, value, false, flag);
        } else if ($.type(index) === "array") {
          self._grid.checkItems(index, value, flag);
        }
      } }, { key: "setDisableCheck", value:
      function setDisableCheck(index, _boolean5) {
        var self = this,row = [],bool = false;
        if ($.type(index) === "number") {
          row.push(index);
        } else if ($.type(index) === "array") {
          row = index;
        }
        if ($.type(_boolean5) === "boolean") {
          bool = !_boolean5;
        }
        for (var i = 0; i < row.length; i++) {
          self._grid.setCheckable(row[i], bool);
        }
      } }, { key: "setHeaderCheck", value:
      function setHeaderCheck(_boolean6) {
        this._grid.setAllCheck(_boolean6);
        this._grid.checkAll(_boolean6);
      } }, { key: "getCheckedRows", value:
      function getCheckedRows() {
        return dews.ui.gridUtil.getCheckedRows(this);
      } }, { key: "getCheckedValues", value:
      function getCheckedValues(field) {
        return dews.ui.gridUtil.getCheckedValues(this, field);
      } }, { key: "getCheckedIndex", value:
      function getCheckedIndex() {
        return this._grid.getCheckedItems();
      } }, { key: "getCheckedDataIndex", value:
      function getCheckedDataIndex() {
        return this._grid.getCheckedRows();
      } }, { key: "showColumn", value:
      function showColumn(field) {
        dews.ui.gridUtil.showColumn(this, field);
      } }, { key: "hideColumn", value:
      function hideColumn(field) {
        dews.ui.gridUtil.hideColumn(this, field);
      } }, { key: "refresh", value:
      function refresh() {
        this._grid.refresh();
      } }, { key: "showProgress", value:
      function showProgress() {
        dews.ui.loading.show({
          type: "tiny",
          text: dews.localize.get("\uB370\uC774\uD130 \uB85C\uB529 \uC911 \uC785\uB2C8\uB2E4.", "dews_\uB370\uC774\uD130 \uB85C\uB529 \uC911 \uC785\uB2C8\uB2E4.")
        });
      } }, { key: "hideProgress", value:
      function hideProgress() {
        dews.ui.loading.hide();
      } }, { key: "saveAsExcel", value:
      function saveAsExcel(options) {
        var self = this;
        var exporter = new ExcelExporter();
        exporter["export"](options, self);
      } }, { key: "importExcel", value:
      function importExcel(option) {
        var self = this,opt2 = {
            sheetName: void 0,
            fillData: "replace",
            fileDialog: false,
            mapping: {},
            result: {
              totalCount: 0,
              success: {
                count: 0,
                data: []
              },
              fail: {
                count: 0,
                data: []
              }
            }
          };
        var $inputFileElement = self.$element.find("> .dews-grid-excel-import-file"),fileList,$dfd = $.Deferred();
        opt2 = $.extend(true, opt2, option);
        if (opt2.fileDialog) {
          if ($inputFileElement.length === 0) {
            $inputFileElement = $('<input type="file" class="dews-grid-excel-import-file" style="display: none">');
            self.$element.append($inputFileElement);
            $inputFileElement.change(function (e) {
              fileList = e.target.files;
              opt2.file = fileList;
              loadExcelScript(self, opt2).done(function (result) {
                $inputFileElement.remove();
                $dfd.resolveWith(self, [result]);
              }).fail(function (result) {
                $inputFileElement.remove();
                $dfd.rejectWith(self, [result]);
              });
            });
          }
          $inputFileElement.trigger("click");
          return $dfd;
        } else {
          return loadExcelScript(self, opt2);
        }
        function loadExcelScript(grid2, options) {
          var self2 = grid2,opt3 = options,deferred = $.Deferred(),link = dews._environments.scriptBase + "xlsx.js";
          dews.ajax.script(link, { once: true }).done(function () {
            if ($.type(opt3.file) === "undefined") {
              return;
            }
            var files = opt3.file;
            if (files.length === 0) {
              deferred.rejectWith(self2, new Error("\uD30C\uC77C\uC744 \uC77D\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."));
            }
            var file = files[0];
            var excelImporter = new ExcelImporter(self2, opt3);
            excelImporter.loadExcelWorkbook(file).done(function (workbook) {
              opt3.sheetName = opt3.sheetName === void 0 ? workbook.SheetNames[0] : opt3.sheetName;
              var sheetsDataObj = workbook.Sheets[opt3.sheetName];
              for (var key in sheetsDataObj) {
                if (sheetsDataObj[key].t === "d") {
                  var dateValue = sheetsDataObj[key].v;
                  dateValue.setSeconds(dateValue.getSeconds() + 52);
                }
              }
              var output = to_json(workbook);
              self2.options.dataSource.dataProvider.fillJsonData(output[opt3.sheetName], {
                fillMode: opt3.fillData
              });
              if (opt3.result.fail.count === opt3.result.totalCount) {
                deferred.rejectWith(self2, [opt3.result]);
              } else {
                deferred.resolveWith(self2, [opt3.result]);
              }
            }).fail(function (err) {
              deferred.rejectWith(self2, err);
            });
            function fixdata(data) {
              var o = "",l = 0,w = 10240;
              for (; l < data.byteLength / w; ++l) {
                o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w, l * w + w)));
              }
              o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w)));
              return o;
            }
            function to_json(workbook) {
              var result = {},setData,roa,datas = [];
              !option.titleDepth ? option.titleDepth = 1 : option.titleDepth;
              var headerSize = option.titleDepth - 1;
              var makeJson = XLSX.utils.make_json(workbook.Sheets[opt3.sheetName], { header: 1, raw: true });
              var header = [],data = [];
              if ($.type(option.rawConverter) === "function") {
                result[opt3.sheetName] = option.rawConverter.call(self2, makeJson) || [];
                datas = result[opt3.sheetName];
                setData = result;
              } else {
                if (Object.keys(opt3.mapping).length === 0) {
                  setMapping(self2.options.columns);
                }
                if (option.titleDepth === 1) {
                  roa = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[opt3.sheetName], { raw: true });
                  result[opt3.sheetName] = roa;
                } else if (option.titleDepth > 1) {
                  for (var h = 0; h < makeJson[0].length; h++) {
                    header.push(void 0);
                  }
                  for (var j = 0; j <= headerSize; j++) {
                    for (var i = 0; i < makeJson[j].length; i++) {
                      if ($.type(makeJson[j][i]) !== "undefined") {
                        header.splice(i, 1, makeJson[j][i]);
                      }
                    }
                  }
                  $.each(header, function (headerIndex, headerName) {
                    var mappingList = Object.keys(opt3.mapping);
                    var matchIndex;
                    var matchField;
                    $.each(mappingList, function (mappingIndex, mappingValue) {
                      var mappingColumn = opt3.mapping[mappingValue];
                      if (mappingColumn === headerName) {
                        matchIndex = mappingIndex;
                        matchField = mappingValue;
                        return false;
                      }
                    });
                    if (matchField !== void 0 && matchField !== null) {
                      header[headerIndex] = {
                        title: headerName,
                        field: matchField,
                        index: matchIndex,
                        isMatch: true
                      };
                      opt3.mapping[matchField] = {
                        title: headerName,
                        field: matchField,
                        index: matchIndex,
                        isMatch: true
                      };
                    }
                  });
                  $.each(makeJson.slice(option.titleDepth), function (idx, array) {
                    var obj = {};
                    $.each(array, function (index, cell) {
                      var matchHeader = header[index];
                      if (matchHeader && matchHeader.isMatch) {
                        obj[matchHeader.field] = cell;
                      }
                    });
                    data.push(obj);
                  });
                  if (data.length > 0) {
                    result[opt3.sheetName] = data;
                  }
                }
                setData = result;
                Object.size = function (obj) {
                  var size = 0,key;
                  var bool = 0;
                  for (key in obj) {
                    if (obj.hasOwnProperty(key))
                    size++;
                    if (!obj[key])
                    bool++;
                  }
                  return size !== bool;
                };
                for (var i = 0; i <= setData[opt3.sheetName].length - 1; i++) {
                  var rows = mapping(setData[opt3.sheetName][i], setData[opt3.sheetName], i);
                  var check;
                  check = Object.size(rows);
                  if ($.type(rows) === "object" && check || $.type(rows) === "boolean" && rows) {
                    datas.push(rows);
                    opt3.result.success.data.push(result[opt3.sheetName][i]);
                    opt3.result.success.count++;
                  } else if ($.type(rows) === "boolean" && !rows) {
                    opt3.result.fail.data.push(result[opt3.sheetName][i]);
                    opt3.result.fail.count++;
                  }
                }
              }
              opt3.result.totalCount = setData[opt3.sheetName].length;
              setData[opt3.sheetName] = datas;
              return setData;
            }
            function mapping(row, total, index) {
              var data = {},originRow = row;
              for (var j = 0; j <= Object.keys(opt3.mapping).length - 1; j++) {
                var dataValue;
                if (option.titleDepth === 1) {
                  dataValue = originRow[opt3.mapping[Object.keys(opt3.mapping)[j]]];
                } else if (option.titleDepth > 1) {
                  dataValue = originRow[opt3.mapping[Object.keys(opt3.mapping)[j]].field];
                }
                data[Object.keys(opt3.mapping)[j]] = dataValue;
              }
              if ($.type(opt3.convertor) === "function") {
                data = opt3.convertor.call(self2, data);
              }
              if ($.type(opt3.validator) === "function") {
                var validte = opt3.validator.call(self2, data);
                if ($.type(validte) === "boolean" && !validte) {
                  return false;
                }
              }
              if ($.type(opt3.dupCheck) === "array" && opt3.dupCheck.length !== 0) {
                var keys = opt3.dupCheck,totals = total.slice(),dupData = [];
                totals.filter(function (row2) {
                  var dupCount = 0;
                  $.each(keys, function (idx, value) {
                    var dataValue2;
                    if (option.titleDepth === 1) {
                      dataValue2 = row2[opt3.mapping[value]];
                    } else if (option.titleDepth > 1) {
                      dataValue2 = row2[opt3.mapping[value].field];
                    }
                    if (data[value] === dataValue2) {
                      dupCount++;
                    }
                  });
                  if (dupCount === opt3.dupCheck.length) {
                    dupData.push(row2);
                  }
                });
                if (dupData.length > 0 && dupData[0] !== row) {
                  return false;
                }
              }
              if (Object.keys(data).length !== 0) {
                return data;
              }
            }
            function setMapping(col) {
              var columns = col;
              for (var k = 0; k <= columns.length - 1; k++) {
                if ($.type(columns[k].field) !== "undefined") {
                  opt3.mapping[columns[k].field] = columns[k].title;
                }
                if (columns[k].columns) {
                  setMapping(columns[k].columns);
                }
              }
              if (opt3.mapping.hasOwnProperty("__UUID")) {
                delete opt3.mapping.__UUID;
              }
            }
          });
          return deferred;
        }
      } }, { key: "setColumns", value:
      function setColumns(columns) {
        var self = this;
        var UUIDFlag = false;
        $.each(columns, function (idx, column) {
          if (column.field === "__UUID") {
            UUIDFlag = true;
            return false;
          }
        });
        self.options._originColumns = [].concat(columns);
        if (!UUIDFlag && columns) {
          columns.splice(0, 0, {
            field: "__UUID",
            fieldName: "__UUID",
            name: "__UUID",
            visible: false,
            header: { text: " " }
          });
        }
        self.options.styleColumn = [];
        __initialize(self);
        var result = this._getOptionsThatConvertColumns(columns, self.options, self);
        dews.ui.gridUtil.setColumns(self, result);
        self._filterManager.setFilterActions(self);
        self._setCriteria();
      } }, { key: "setColumn", value:
      function setColumn(columnFieldName, nextColumnOption) {
        var self = this,prevColumn,nextColumn,newColumn,columns = self.options.columns,result;
        delete nextColumnOption.field;
        if (nextColumnOption.width) {
          self._grid.setColumnProperty(columnFieldName, "width", nextColumnOption.width);
          delete nextColumnOption.width;
        }
        if (nextColumnOption.visible) {
          self._grid.setColumnProperty(columnFieldName, "visible", nextColumnOption.visible);
        }
        var userColumn;
        if ($.type(self.userOptions.columns) === "array") {
          userColumn = findUserOptionsColumn3(self.userOptions.columns, columnFieldName);
        }
        userColumn = $.extend(true, userColumn, nextColumnOption);
        if (nextColumnOption.editable !== void 0 && (nextColumnOption.editor === void 0 || nextColumnOption.editor.editable === void 0)) {
          if (userColumn.editor === void 0 || userColumn.editor.editable === void 0) {
            $.extend(true, nextColumnOption, {
              editor: { editable: nextColumnOption.editable }
            });
          } else if (userColumn.editor && userColumn.editor.editable !== void 0) {
            $.extend(true, nextColumnOption, {
              editor: { editable: userColumn.editor.editable }
            });
          }
        }
        if (nextColumnOption.editable === void 0 && nextColumnOption.editor && nextColumnOption.editor.editable !== void 0) {
          if (userColumn !== void 0 && userColumn.editable !== void 0) {
            $.extend(true, nextColumnOption, { editable: userColumn.editable });
          } else {
            $.extend(true, nextColumnOption, {
              editable: self.options.editable
            });
          }
        }
        findColumnAndExtend(columns);
        self.options.styleColumn = [];
        __initialize(self);
        result = this._getOptionsThatConvertColumns(columns, self.options, self);
        dews.ui.gridUtil._setColumns(self, result);
        prevColumn = self._grid.columnByName(columnFieldName);
        nextColumn = self.columns[columnFieldName];
        if (nextColumn && nextColumn.labels && nextColumn.values && nextColumn.editor && nextColumn.editor.type === "dropDown" && prevColumn) {
          prevColumn.labels = [];
          prevColumn.values = [];
        }
        newColumn = $.extend(true, {}, prevColumn, nextColumn);
        self._grid.setColumn(newColumn);
        self._filterManager.setFilterActions(self);
        self._setCriteria();
        function findColumnAndExtend(columns2) {
          for (var i = 0; i < columns2.length; i++) {
            if (columns2[i].columns) {
              findColumnAndExtend(columns2[i].columns);
            } else {
              if (columns2[i].fieldName && columns2[i].fieldName === columnFieldName) {
                $.extend(true, columns2[i], nextColumnOption);
              }
            }
          }
        }
      } }, { key: "select", value:
      function select(row, field) {
        var self = this,column = self._grid.getCurrent().column;
        if (row !== void 0) {
          if ($.type(field) !== "undefined") {
            column = field;
          }
          self._grid.setCurrent({
            itemIndex: row,
            column: column,
            dataRow: row
          });
        } else {
          if (self.options.dataBounding && self.options.dataSource.data().length !== 0) {
            return 0;
          } else {
            return self._grid.getCurrent().itemIndex;
          }
        }
      } }, { key: "multiSelect", value:
      function multiSelect(startItem, endItem, startColumn, endColumn) {
        return dews.ui.gridUtil.multiSelect(this, startItem, endItem, startColumn, endColumn);
      } }, { key: "setFixedOptions", value:
      function setFixedOptions(fixedOption) {
        this._grid.setFixedOptions(fixedOption);
      } }, { key: "sort", value:
      function sort(options) {
        dews.ui.gridUtil.sort(this, options);
      } }, { key: "setContextMenu", value:
      function setContextMenu(options) {
        dews.ui.gridUtil.setContextMenu(this, options);
      } }, { key: "setDataSource", value:
      function setDataSource(datasource) {
        var self = this;
        self._grid.setAllCheck(false);
        self.options.dataSource = datasource;
        self.options.styleColumn = [];
        __initialize(self);
        self.options = this._getOptionsThatConvertColumns(self.options.columns, self.options, self);
        delete self.options.fieldIndex;
        self.options.dataSource.dataProvider._dp.setRows = setRow(
        self,
        self.options.dataSource.dataProvider._dp.setRows);

        self.options.dataSource.dataProvider._dp.insertRows = insertRows(
        self,
        self.options.dataSource.dataProvider._dp.insertRows);

        self.options.dataSource.dataProvider._dp.insertRow = insertRow(
        self,
        self.options.dataSource.dataProvider._dp.insertRow);

        self._grid.setDataProvider(self.options.dataSource.dataProvider);
        self._grid.setColumns(self.options.columns);
        self._grid.setHeader({
          height: self.options.maxDepth * self.options.header.minHeight
        });
        if (self.options.grouping) {
          self.options.display.rowHeight = self.options.display.minHeight * self.options.maxGroupCol;
        }
        if (self.options.dataSource && self.options.dataSource.options.group) {
          self.options.group = self.options.dataSource.options.group;
        }
        if (typeof self.options.group !== "undefined") {
          setGroup(self._grid, self.options);
        }
        self._grid.setOptions(self.options);
        if ($.type(self.options.dataSource.options.detail) === "boolean") {
          var length = self.dataSource.dataProvider.getRowCount();
          $.each(self.dataItems(), function (idx, value) {
            objectToRow(self.options.dataSource.dataProvider._dp, self, value, idx, length);
          });
        }
        if (self._onegrid && self._onegrid._onegrid) {
          if (self._onegrid.loadData) {
            self._onegrid.loadColumns = dews.ui.gridUtil.setDisplayIndexColumns(
            self,
            self.userOptions.columns,
            self._onegrid.loadData);

          } else {
            self._onegrid.loadColumns = dews.ui.gridUtil.setDisplayColumns(self, self._grid.getDisplayColumns());
          }
        }
        self._filterManager.setFilterActions(self);
        self._setCriteria();
      } }, { key: "updateRow", value:
      function updateRow(row, data) {
        dews.ui.gridUtil.updateRow(this, row, data);
      } }, { key: "setOptions", value:
      function setOptions(options) {
        var self = this;
        var dispCols = self._grid.saveColumnLayout();
        self.userOptions = $.extend(true, self.userOptions, options);
        options = $.extend(true, {}, self.options, options);
        self.options = getOptions(self, options);
        self._grid.setOptions(self.options);
        self.columns = {};
        dews.ui.gridUtil._setColumns(self, self.options.columns);
        self._filterManager.setFilterActions(self);
        self._grid.setColumnLayout(dispCols);
        if (typeof self.options.group !== "undefined") {
          setGroup(self._grid, self.options);
        }
      } }, { key: "on", value:
      function on() {
        var self = this;
        self.$element.on.apply(self.$element, arguments);
      } }, { key: "off", value:
      function off() {
        var self = this;
        if (arguments[0] === "all") {
          self.$element.off();
        } else {
          self.$element.off.apply(self.$element, arguments);
        }
      } }, { key: "searchCell", value:
      function searchCell(options) {
        var self = this,opt2 = {
            select: true,
            partialMatch: true,
            caseMatch: false
          };
        if ($.type(options) === "undefined") {
          return;
        }
        opt2.startItemIndex = options.startIndex === void 0 ? 0 : options.startIndex;
        opt2 = $.extend(true, opt2, options);
        opt2.caseSensitive = opt2.caseMatch;
        if (self._grid.searchCell(opt2)) {
          return self._grid.searchCell(opt2).itemIndex;
        }
      } }, { key: "getCurrentColumn", value:
      function getCurrentColumn() {
        return this._grid.getCurrent().column;
      } }, { key: "getRowState", value:
      function getRowState(index) {
        return dews.ui.gridUtil.getRowState(this, index);
      } }, { key: "setDetail", value:
      function setDetail(target) {
        dews.ui.gridUtil.setDetail(this, target);
      } }, { key: "setDetailGrid", value:
      function setDetailGrid(detailGrid) {
        this.setDetail(detailGrid);
      } }, { key: "validate", value:
      function validate(opt2) {
        var self = this,validate = {
            result: true,
            fields: []
          },gridDatas = self.options.dataSource.data(),required = [],columns;
        if ($.type(opt2) === "function") {
          var funParams = {
            grid: self,
            row: {
              index: 0,
              data: ""
            },
            cell: {
              field: "",
              data: ""
            }
          };
          $.each(gridDatas, function (idx, rowData) {
            funParams.row.index = idx;
            funParams.row.data = rowData;
            $.each(self._grid.getDisplayColumns(), function (index, column2) {
              funParams.cell.field = column2;
              funParams.cell.data = rowData[column2];
              if (!opt2.call(self, funParams)) {
                validate.fields.push({ columnName: column2, rowIndex: idx });
                validate.result = false;
              }
            });
          });
        } else {
          var options = $.extend(
          true,
          {
            mode: $.type(opt2) === "boolean" ? opt2 : false,
            showTooltip: false
          },
          opt2);

          for (var i = 0; i < self._grid.getColumnNames().length; i += 1) {
            columns = self.columns[self._grid.getColumnNames()[i]];
            if (columns && $.type(columns.field) !== "undefined") {
              if (columns.attributes && columns.attributes["class"] === "required") {
                required.push(columns.field);
              }
            }
          }
          $.each(gridDatas, function (idx, datas) {
            var rowState = self.getRowState(idx);
            if (options.mode && rowState !== "updated" && rowState !== "added")
            return true;
            $.each(required, function (reqIdx, reqData) {
              var colData = datas[reqData];
              if ($.type(colData) === "number" && colData === 0) {
              } else if (!colData) {
                validate.result = false;
                validate.fields.push({
                  columnName: reqData,
                  rowIndex: idx,
                  validate: "required"
                });
              }
            });
          });
          if (!validate.result) {
            if (options.showTooltip) {
              var itemIndex = validate.itemIndex = validate.fields[0].rowIndex;
              var column = validate.column = validate.fields[0].columnName;
              self.showTooltip(itemIndex, column, {
                type: "required",
                position: "top",
                text: dews.localize.get("\uD544\uC218 \uC785\uB825 \uD56D\uBAA9\uC785\uB2C8\uB2E4.", "dews_\uD544\uC218 \uC785\uB825 \uD56D\uBAA9\uC785\uB2C8\uB2E4.")
              });
            }
          }
        }
        return validate;
      } }, { key: "setRowStyle", value:
      function setRowStyle(row, style, _colorLine) {
        dews.ui.gridUtil.setRowStyle(this, row, style, _colorLine);
      } }, { key: "setStyles", value:
      function setStyles(styles) {
        var self = this;
        self.options.styles = styles;
        self.options = _setStyles2(self._grid, self.options);
        self._grid.setOptions(self.options);
      } }, { key: "resetRowStyle", value:
      function resetRowStyle(row) {
        dews.ui.gridUtil.resetRowStyle(this, row);
      } }, { key: "lastEditCell", value:
      function lastEditCell() {
        var self = this,current = self._grid.getCurrent(),displayColumn = self.options.displayColumns,displayIndex = self._grid.getColumnProperty(current.column, "displayIndex"),value = false,editParams = {
            grid: self,
            row: {
              index: current.itemIndex,
              data: self.dataItem(current.itemIndex)
            },
            cell: {
              field: ""
            }
          };
        return dews.ui.gridUtil.lastEditCell(self, displayColumn, displayIndex, value, editParams);
      } }, { key: "getSummary", value:
      function getSummary(field, cal) {
        var self = this,calculate = cal || "SUM";
        return self._grid.getSummary(field, calculate);
      } }, { key: "setRowState", value:
      function setRowState(index, state) {
        dews.ui.gridUtil.setRowState(this, index, state);
      } }, { key: "setHeight", value:
      function setHeight(height) {
        dews.ui.gridUtil.setHeight(this, height);
      } }, { key: "setRowHeight", value:
      function setRowHeight(opt2, itemIndex, height) {
        return dews.ui.gridUtil.setRowHeight(this, opt2, itemIndex, height);
      } }, { key: "setMaxLength", value:
      function setMaxLength(field, length) {
        dews.ui.gridUtil.setMaxLength(this, field, length);
      } }, { key: "setHeaderCheckVisible", value:
      function setHeaderCheckVisible(visible) {
        dews.ui.gridUtil.setHeaderCheckVisible(this, visible);
      } }, { key: "getParentData", value:
      function getParentData() {
        return dews.ui.gridUtil.getParentData(this);
      } }, { key: "getChildData", value:
      function getChildData(index, gridId) {
        return dews.ui.gridUtil.getChildData(this, index, gridId);
      } }, { key: "getChildDataSource", value:
      function getChildDataSource(arg1, arg2) {
        return dews.ui.gridUtil.getChildDataSource(this, arg1, arg2);
      } }, { key: "_getExcelUrlForPrint", value:
      function _getExcelUrlForPrint(menuName, options) {
        return dews.ui.gridUtil._getExcelUrlForPrint(this, menuName, options);
      } }, { key: "sortDataItems", value:
      function sortDataItems(index) {
        var self = this;
        var sortDatas = [];
        if ($.type(index) === "array") {
          $.each(index, function (count, idx) {
            if ($.type(self.dataItem(idx)) !== "null") {
              sortDatas.push(self.dataItem(idx));
            }
          });
        } else if ($.type(index) === "undefined") {
          for (var i = 0; i < self._grid.getItemCount(); i++) {
            if ($.type(self.dataItem(i)) !== "null") {
              sortDatas.push(self.dataItem(i));
            }
          }
        }
        return sortDatas;
      } }, { key: "setGroup", value:
      function setGroup(group) {
        var self = this,groups = [];
        if ($.type(group) === "array") {
          $.each(group, function (idx, value) {
            groups.push(value.field);
          });
        }
        self._grid.groupBy(groups);
        self._grid.setSortingOptions({
          handleVisibility: self.userOptions.sortable !== false && groups.length === 0 ? "visible" : "hidden"
        });
      } }, { key: "enable", value:
      function enable(_boolean7) {
        dews.ui.gridUtil.enable(this, _boolean7);
      } }, { key: "setColumnHeaderCheck", value:
      function setColumnHeaderCheck(field, bool) {
        var self = this;
        self._grid.setColumn($.extend(true, self._grid.columnByField(field), { checked: bool }));
      } }, { key: "addColumn", value:
      function addColumn(column, insertField) {
        var self = this,options = self.options;
        options.columns.push(column);
        var UUIDFlag = false;
        $.each(options.columns, function (idx, col) {
          if (col.field === "__UUID") {
            UUIDFlag = true;
          }
        });
        if (!UUIDFlag && options.columns) {
          options.columns.splice(0, 0, {
            field: "__UUID",
            fieldName: "__UUID",
            name: "__UUID",
            visible: false,
            header: { text: " " }
          });
        }
        self.options.styleColumn = [];
        __initialize(self);
        options = this._getOptionsThatConvertColumns(options.columns, options, self);
        dews.ui.gridUtil.addColumn(self, options.columns[options.columns.length - 1], insertField);
        if (column && column.formats && column.formats.type && column.formats.type.toLowerCase() === "datasource") {
          var colFormatsDataSource = column.formats.dataSource,fetchDataSource;
          if (colFormatsDataSource) {
            colFormatsDataSource.col = column;
            colFormatsDataSource.fetch(function () {
              fetchDataSource = this;
            }).done(function () {
              var currentColumn = self._grid.columnByField(fetchDataSource.col.field);
              var values = [],labels = [];
              var colFormatsDataSourceData = fetchDataSource.col.formats.dataSource.data();
              if (colFormatsDataSourceData.length > 0) {
                for (var k = 0; k < colFormatsDataSourceData.length; k++) {
                  values.push(colFormatsDataSourceData[k][fetchDataSource.col.formats.dataValueField]);
                  labels.push(colFormatsDataSourceData[k][fetchDataSource.col.formats.dataTextField]);
                }
              }
              currentColumn.labels = labels;
              currentColumn.values = values;
              self._grid.setColumn(currentColumn);
              self._grid.setColumnProperty(currentColumn, "width", currentColumn.width);
              delete fetchDataSource.col;
            });
          }
        }
        self._setCriteria();
      } }, { key: "deleteColumn", value:
      function deleteColumn(column) {
        dews.ui.gridUtil.deleteColumn(this, column);
      } }, { key: "getByUUID", value:
      function getByUUID() {
        var self = this,data = self.dataItem(self.select());
        if (data) {
          return data["__UUID"];
        }
      } }, { key: "bindPanel", value:
      function bindPanel(panel) {
        dews.ui.gridUtil.bindPanel(this, panel);
      } }, { key: "updateRowFromPanel", value:
      function updateRowFromPanel(data) {
        var self = this;
        if (data) {
          Object.keys(data).forEach(function (key) {
            if (self.options.dataSource.dataProvider.getFieldIndex(key) !== -1) {
              self._grid.setValue(self.select(), key, data[key]);
            }
          });
        }
      } }, { key: "setCellStyle", value:
      function setCellStyle(index, field, styles) {
        dews.ui.gridUtil.setCellStyle(this, index, field, styles);
      } }, { key: "disableActiveEditor", value:
      function disableActiveEditor(_boolean8) {
        var self = this,column,columns,visible,styles,options = {},background;
        column = self.getCurrentColumn();
        columns = self.columns[column];
        styles = self._grid.getCellApplyStyles(self._grid.getCurrent().dataRow, column);
        if (self._grid.getSelectOptions().style !== "none") {
          background = self.options.gridStyle.selection.focusBackgroundColor;
          if ($.type(columns) !== "undefined" && $.type(columns.attributes) !== "undefined") {
            if (columns.attributes["class"] === "required") {
              background = self.options.gridStyle.body.requiredFocusBackground;
            } else if (columns.attributes["class"] === "readonly") {
              background = self.options.gridStyle.body.readonlyFocusBackground;
            }
          }
          options = {
            background: background
          };
          self._grid.removeCellStyles(["selection"]);
        }
        if (($.type(styles.editable) === "undefined" || styles.editable) && !_boolean8) {
          options.editable = false;
        }
        self._grid.addCellStyle("selection", options, true);
        self._grid.setCellStyle(self._grid.getCurrent().dataRow, column, "selection");
        self._grid.setColumnProperty(column, "editable", _boolean8);
        switch (columns.editor.type.toLowerCase()) {
          case "codepicker":
          case "zipcodepicker":
          case "time":
          case "month":
          case "year":
            visible = _boolean8 ? "visible" : "hidden";
            self._grid.setColumnProperty(column, "buttonVisibility", visible);
            break;
          case "check":
            var options2 = self._grid.getColumnProperty(columns.name, "renderer");
            self._grid.setColumnProperty(columns.name, "renderer", $.extend(true, options2, { editable: _boolean8 }));
            break;}

      } }, { key: "isFilteredColumn", value:
      function isFilteredColumn(column) {
        return this._grid.isFiltered(column);
      } }, { key: "setSelectedStyle", value:
      function setSelectedStyle(opt2) {
        dews.ui.gridUtil.setSelectedStyle(this, opt2);
      } }, { key: "getItemIndexFromDataIndex", value:
      function getItemIndexFromDataIndex(dataIndex) {
        return dews.ui.gridUtil.getItemIndexFromDataIndex(this, dataIndex);
      } }, { key: "getDataIndexFromItemIndex", value:
      function getDataIndexFromItemIndex(itemIndex) {
        return dews.ui.gridUtil.getDataIndexFromItemIndex(this, itemIndex);
      } }, { key: "getDynamicColumn", value:
      function getDynamicColumn(field) {
        return dews.ui.gridUtil.getDynamicColumn(this, field);
      } }, { key: "deleteNote", value:
      function deleteNote(options) {
        return dews.ui.gridUtil.deleteNote(this, options);
      } }, { key: "setDisabledNoteRows", value:
      function setDisabledNoteRows(dataIndex) {
        return dews.ui.gridUtil.setDisabledNoteRows(this, dataIndex);
      } }, { key: "getGridNoteInfo", value:
      function getGridNoteInfo(itemIndex) {
        return dews.ui.gridUtil.getGridNoteInfo(this, itemIndex);
      } }]);return GridAPI;}(Api);

  function __initialize(grid2) {
    if (grid2._filterManager) {
      grid2._filterManager._columns = {};
      grid2._filterManager._options.filter.useColumns = [];
    }
  }
  function findUserOptionsColumn3(columns, fieldName, userColumn) {
    if (!columns)
    return null;
    for (var index = 0; index < columns.length; index++) {
      if (userColumn === void 0) {
        if (columns[index].field === fieldName) {
          userColumn = columns[index];
        } else if (columns[index].columns) {
          userColumn = findUserOptionsColumn3(columns[index].columns, fieldName, userColumn);
        }
      }
    }
    return userColumn;
  }
  function _setStyles2(grid2, options) {
    var self = grid2,opt2 = options;
    return opt2 = dews.ui.gridUtil.setStyles(self, opt2);
  }
  function getOptions(self, options) {
    var grid2 = self._grid,opt2,defaultOptions2 = {
        panel: {
          visible: false
        },
        checkBar: {
          visible: true,
          checkImageUrl: options.gridStyle.checkBar.checkedImg,
          unCheckImageUrl: options.gridStyle.checkBar.unCheckImg,
          headCheckImageUrl: options.gridStyle.checkBar.checkedImg,
          headUnCheckImageUrl: options.gridStyle.checkBar.unCheckImg
        },
        stateBar: {
          visible: false
        },
        header: {
          minHeight: options.gridStyle.header.height,
          heightFill: "fixed"
        },
        footer: {
          visible: false,
          height: options.gridStyle.footer.height,
          minHeight: options.gridStyle.footer.height
        },
        indicator: {
          visible: true,
          headText: "No",
          footText: " "
        },
        edit: {
          insertable: false,
          appendable: false,
          editable: false,
          crossWhenExitLast: true,
          showInvalidFormatMessage: false,
          enterToTab: true,
          checkDiff: true,
          skipReadOnly: false
        },
        display: {
          fitStyle: "even",
          showEmptyMessage: false,
          emptyMessage: "",
          showEmptyImage: true,
          rowHeight: options.gridStyle.body.height,
          minHeight: options.gridStyle.body.height,
          focusColor: options.gridStyle.selection.focusBorderColor,
          focusBorderWidth: "2px",
          innerFocusColor: options.gridStyle.selection.focusBorderColor,
          showInnerFocus: true,
          columnMovable: options.movable ? options.movable : false,
          columnResizable: true,
          editingMergedRow: false,
          editItemMerging: true,
          heightMeasurer: "fixed",
          wheelEventPropagate: false
        },
        copy: {
          singleMode: false,
          copyDisplayText: true
        },
        paste: {
          singleMode: false,
          checkReadOnly: true,
          noEditEvent: true,
          numberChars: [",", " "]
        },
        select: {
          style: "block"
        },
        sorting: {
          enabled: true,
          style: "exclusive",
          keepFocusedRow: true
        },
        fixed: {
          colBarWidth: 1,
          rowBarHeight: 1
        },
        filtering: {
          imageHandle: true,
          handleImages: {
            fill: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png",
            hoveredNone: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-off.png",
            hoveredFill: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png"
          }
        },
        dataBounding: false,
        rowDynamic: [],
        autoBind: true,
        depth: 1,
        columnsDepth: 0,
        maxDepth: 1,
        grouping: false,
        groupCol: 1,
        maxGroupCol: 1,
        context: true,
        editSkip: false,
        copyMode: "row",
        sortMode: "explicit",
        isVisible: true,
        fillWidth: true,
        images: [],
        displayColumns: [],
        _originColumns: [],
        multiFooterCnt: 1,
        shiftCheck: dews._environments.gridShiftCheck,
        detailGrid: {
          addedRowDataSourceRead: true
        }
      };
    opt2 = $.extend(true, defaultOptions2, options);
    opt2._originColumns = [].concat(opt2.columns);
    if ($.type(opt2.rowNo) !== "undefined") {
      if ($.type(opt2.rowNo) === "object") {
        opt2.indicator.visible = true;
        opt2.indicator.headText = $.type(opt2.rowNo.text) === "undefined" ? opt2.indicator.headText : opt2.rowNo.text;
        opt2.indicator.width = $.type(opt2.rowNo.width) === "undefined" ? 40 : opt2.rowNo.width;
      } else if ($.type(opt2.rowNo) === "boolean") {
        opt2.indicator.visible = opt2.rowNo;
      }
    }
    if ($.type(opt2.selectable) !== "undefined") {
      if (opt2.selectable === true) {
        opt2.display.rowFocusVisible = true;
        opt2.display.rowFocusBackground = opt2.gridStyle.selectionBackground;
      } else if (opt2.selectable === false) {
        opt2.display.rowFocusVisible = false;
        delete opt2.display.rowFocusBackground;
      }
    }
    if ($.type(opt2.sortable) !== "undefined") {
      if (opt2.sortable === "multiple") {
        opt2.sorting.style = "inclusive";
        opt2.sorting.enabled = true;
      } else {
        opt2.sorting.enabled = opt2.sortable;
      }
    }
    if ($.type(opt2.sort) !== "undefined") {
      opt2.sorting.sort = opt2.sort;
    }
    if ($.type(opt2.rowEditable) !== "undefined") {
      opt2.edit.rowEditable = opt2.rowEditable;
    }
    if ($.type(opt2.editable) !== "undefined") {
      opt2.edit.editable = opt2.editable;
    }
    if ($.type(opt2.checkable) !== "undefined") {
      opt2.checkBar.visible = opt2.checkable;
    }
    if ($.type(opt2.stateColumn) === "boolean") {
      opt2.stateBar.visible = opt2.stateColumn;
    }
    if ($.type(opt2.readOnly) !== "undefined") {
      opt2.edit.readOnly = opt2.readOnly;
    }
    if ($.type(opt2.editSkip) === "boolean" && opt2.editSkip) {
      opt2.editSkip = true;
      opt2.edit.skipReadOnly = true;
    }
    if ($.type(opt2.noData) === "boolean") {
      opt2.display.showEmptyMessage = opt2.noData;
      opt2.display.showEmptyImage = opt2.noDataImage || opt2.display.showEmptyImage;
      if (opt2.display.showEmptyMessage && $.type(opt2.noDataMessage) !== "undefined") {
        opt2.display.emptyMessage = opt2.noDataMessage;
      } else {
        opt2.display.emptyMessage = dews.localize.get("\uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.", "dews_\uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");
      }
    }
    if (!opt2.fillWidth) {
      opt2.display.fitStyle = "none";
    }
    if ($.type(opt2.resizable) === "boolean") {
      opt2.display.columnResizable = opt2.resizable;
    }
    if ($.type(opt2.editingMergedRow) !== "undefined") {
      opt2.display.editItemMerging = opt2.editingMergedRow;
    }
    if ($.type(opt2.pasteMode) !== "undefined") {
      opt2.paste.singleMode = opt2.pasteMode === "cell";
    }
    if (opt2.selectionMode === "cell") {
      opt2.select.style = "none";
    } else {
      opt2.select.style = "block";
    }
    if (typeof opt2.filter === "boolean") {
      opt2.filter.use = opt2.filter;
    } else if (_typeof(opt2.filter) === "object") {
      if (opt2.filter.iconVisible) {
        opt2.filtering.handleImages = {
          none: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-off.png",
          fill: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png",
          hoveredNone: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-off.png",
          hoveredFill: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png"
        };
      } else {
        opt2.filtering.handleImages = {
          none: "",
          fill: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png",
          hoveredNone: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-off.png",
          hoveredFill: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png"
        };
      }
    }
    opt2 = _setStyles2(grid2, opt2);
    var UUIDFlag = false;
    $.each(opt2.columns, function (idx, column) {
      if (column.field === "__UUID") {
        UUIDFlag = true;
        return false;
      }
    });
    if (!UUIDFlag && opt2.columns) {
      opt2.columns.splice(0, 0, {
        field: "__UUID",
        fieldName: "__UUID",
        name: "__UUID",
        visible: false,
        header: { text: " " }
      });
    }
    opt2.styleColumn = [];
    __initialize(self);
    opt2 = customizingColumn(opt2.columns, opt2, self);
    delete opt2.fieldIndex;
    grid2.setColumns(opt2.columns);
    grid2.setHeader({ height: opt2.maxDepth * opt2.header.minHeight });
    grid2.setFooter({
      minHeight: opt2.footer.minHeight,
      height: opt2.footer.minHeight
    });
    if (opt2.grouping) {
      opt2.display.rowHeight = opt2.display.minHeight * opt2.maxGroupCol;
    }
    if (opt2.dataSource && opt2.dataSource.options.group) {
      opt2.group = opt2.dataSource.options.group;
    }
    if (typeof opt2.group !== "undefined") {
      setGroup(grid2, opt2);
    }
    return opt2;
  }
  function setGroup(grid2, opt2) {var _opt2$group3;
    var group = (_opt2$group3 = opt2.group) === null || _opt2$group3 === void 0 ? void 0 : _opt2$group3.map(function (g) {return g.field;});
    grid2.groupBy(group);
    var groupOption = {};
    if (typeof opt2.groupHeaderTemplate !== "undefined") {
      var state = opt2.groupHeaderTemplate;
      var index = 0;
      if (typeof opt2.groupHeaderColumn !== "undefined") {
        for (var g = 0; g < grid2.getDisplayColumns().length; g += 1) {
          if (opt2.groupHeaderColumn === grid2.getDisplayColumns()[g]) {
            index = g + 1;
            break;
          }
        }
        var groupText = opt2.columns[index].header.text;
        groupOption.headerCallback = function (groupModel, grid3) {
          var dataProvider = grid3.getDataSource();
          var replaceState = state;
          if (/\${title}/.test(replaceState)) {
            replaceState = replaceState.replace(/\${title}/gi, groupText);
          }
          if (/\${field}/.test(replaceState)) {
            replaceState = replaceState.replace(/\${field}/gi, opt2.groupHeaderColumn);
          }
          if (/\${value}/.test(replaceState)) {
            replaceState = replaceState.replace(
            /\${value}/gi,
            dataProvider.getValue(groupModel.firstItem.dataRow, opt2.groupHeaderColumn));

          }
          if (/\${count}/.test(replaceState)) {
            replaceState = replaceState.replace(/\${count}/gi, groupModel.dataRows.length);
          }
          return replaceState;
        };
        groupOption.headerStatement = null;
      } else {
        for (var _g3 = 0; _g3 < grid2.getDisplayColumns().length; _g3++) {
          for (var r = 0; r < group.length; r++) {
            if (group[r] === grid2.getDisplayColumns()[_g3]) {
              index = _g3 + 1;
              break;
            }
          }
        }
        if (/\${title}/.test(state)) {
          state = state.replace(/\${title}/gi, "${columnHeader}");
        }
        if (/\${field}/.test(state)) {
          state = state.replace(/\${field}/gi, "${groupField}");
        }
        if (/\${value}/.test(state)) {
          state = state.replace(/\${value}/gi, "${groupValue}");
        }
        if (/\${count}/.test(state)) {
          state = state.replace(/\${count}/gi, "${rowCount}");
        }
        groupOption.headerStatement = state;
      }
    }
    if (typeof opt2.dataSource.options.userGroup !== "undefined" && opt2.dataSource.options.userGroup) {
      groupOption.mergeMode = true;
      groupOption.collapsedAdornments = "footer";
      groupOption.expandedAdornments = "footer";
      opt2.panel.visible = true;
    }
    groupOption["levels"] = setGroupLevelColor(group.length);
    grid2.setRowGroup(groupOption);
    grid2.setSortingOptions({
      handleVisibility: "hidden"
    });
    function setGroupLevelColor(groupCnt) {
      var groupLevelStyles = [];
      for (var i = 1; i < groupCnt + 1; i++) {
        var levelColor = "rgba(0, 85, 170, ".concat(0.12 * i, ")");
        groupLevelStyles.push({
          headerStyles: {
            background: levelColor,
            fontBold: true
          },
          headerBarStyles: {
            background: levelColor
          },
          barStyles: {
            background: levelColor
          }
        });
      }
      return groupLevelStyles;
    }
  }

  // src/js/grid/api/TreeGridAPI.js
  var TreeGridAPI = /*#__PURE__*/function (_Api4) {"use strict";_inherits(TreeGridAPI, _Api4);var _super9 = _createSuper(TreeGridAPI);function TreeGridAPI() {_classCallCheck(this, TreeGridAPI);return _super9.apply(this, arguments);}_createClass(TreeGridAPI, [{ key: "showTooltip", value:
      function showTooltip(itemIndex, column, options) {
        var index = this._grid.getItemIndex(itemIndex);
        _get(_getPrototypeOf(TreeGridAPI.prototype), "showTooltip", this).call(this, index, column, options);
      } }, { key: "cancelRow", value:
      function cancelRow() {
        var self = this,current = self._grid.getCurrent(),rowId = self._grid.getDataRow(current.itemIndex);
        _get(_getPrototypeOf(TreeGridAPI.prototype), "cancelRow", this).call(this, rowId);
      } }, { key: "cancelCell", value:
      function cancelCell() {
        var self = this,column = self._grid.getCurrent().column.toUpperCase(),row = self._grid.getDataRow(self._grid.getCurrent().itemIndex),dataSource = self.options.dataSource,fieldIndex = 0,originData;
        if (dataSource && dataSource.dataProvider && dataSource.dataProvider._dp._rowMap[row]) {
          fieldIndex = dataSource.dataProvider._dp._fieldNames.indexOf(column);
          originData = $.type(dataSource.dataProvider._dp._rowMap[row]._orgValues) === "null" ? dataSource.dataProvider._dp._rowMap[row]._values : dataSource.dataProvider._dp._rowMap[row]._orgValues;
          if ($.type(originData) !== "null") {
            self._grid.setValue(self._grid.getCurrent().itemIndex, column, originData[fieldIndex]);
          } else if (dataSource.dataProvider.getRowState(row) === "created") {
            self._grid.setValue(self._grid.getItemIndex(row), column, void 0);
          }
        }
      } }, { key: "saveAsExcel", value:
      function saveAsExcel(options) {
        var self = this;
        if (options.excelDownloadExpandAll === true) {
          self._grid.expandAll();
        }
        var exporter = new ExcelExporter();
        exporter["export"](options, self);
      } }]);return TreeGridAPI;}(Api);


  // src/js/grid/column/treegridCustomizingColumn.js
  function treeCustomizingColumn(columns, opt2, treeGrid) {
    if (columns && opt2.dataSource && opt2.dataSource.options.field) {
      var dataSource = opt2.dataSource.options;
      opt2.columnsDepth = opt2.columnsDepth + 1;
      var d = opt2.columnsDepth;
      if (columns && $.type(treeGrid.multiHeaderFlag) === "undefined" && columns[0].field !== "__UUID") {
        columns.splice(0, 0, {
          field: "__UUID",
          fieldName: "__UUID",
          name: "__UUID",
          visible: false,
          header: { text: " " }
        });
      } else {
        delete treeGrid.multiHeaderFlag;
      }
      $.each(columns, function (i) {
        if ($.type(columns[i]) !== "undefined") {
          columns[i].fieldName = columns[i].field;
          if ($.type(columns[i].editable) === "undefined") {
            columns[i].editable = true;
          }
          if ($.type(columns[i].field) !== "undefined") {
            columns[i].name = columns[i].field;
          }
          for (var f = 0; f < dataSource.field.length; f += 1) {
            if (columns[i].fieldName === dataSource.field[f].fieldName) {
              opt2.fieldIndex = f;
              break;
            }
            if (f === dataSource.field.length - 1) {
              opt2.fieldIndex = void 0;
            }
          }
          if ($.type(columns[i].styles) === "undefined") {
            columns[i].styles = {};
          }
          if ($.type(opt2.fieldIndex) !== "undefined" && $.type(dataSource.field[opt2.fieldIndex].styles) === "undefined") {
            dataSource.field[opt2.fieldIndex].styles = {};
          }
          if ($.type(columns[i].editor) === "undefined") {
            columns[i].editor = {
              type: "text"
            };
          }
          if ($.type(columns[i].width) === "undefined" && opt2.display.fitStyle === "fill") {
            columns[i].fillWidth = 1;
          }
          if ($.type(columns[i].width) !== "undefined" && dews.ui.gridUtil.gridStyle.fontSize !== 12) {
            var fontSize = dews.ui.gridUtil.gridStyle.fontSize;
            switch (fontSize) {
              case 15:
                columns[i].width = Math.floor(1.25 * columns[i].width);
                break;
              case 18:
                columns[i].width = Math.floor(1.5 * columns[i].width);
                break;
              case 24:
                columns[i].width = Math.floor(2 * columns[i].width);
                break;
              case 30:
                columns[i].width = Math.floor(2.5 * columns[i].width);
                break;}

          }
          if (columns[i].title) {
            columns[i].header = $.extend(true, columns[i].header, {
              text: columns[i].title,
              fixedHeight: opt2.display.rowIndex
            });
          } else {
            columns[i].header = {
              text: " "
            };
          }
          if (columns[i].headerCheck === true || _typeof(columns[i].headerCheck) === "object") {
            columns[i].header.checkLocation = typeof columns[i].headerCheck.location === "undefined" ? "right" : columns[i].headerCheck.location;
            treeGrid._grid.setColumnHeaderOptions({
              checkVisibility: "visible",
              imageCheckHandle: true,
              checkImages: {
                none: opt2.gridStyle.body.unCheckImg,
                hoveredNone: opt2.gridStyle.body.unCheckImg,
                fill: opt2.gridStyle.body.checkedImg,
                hoveredFill: opt2.gridStyle.body.checkedImg
              }
            });
          } else {
            columns[i].header.checkLocation = "none";
            treeGrid._grid.setColumnHeaderOptions({
              checkVisibility: "hidden",
              imageCheckHandle: false
            });
          }
          if ($.type(opt2.styles) !== "undefined" && $.type(opt2.styles.textAlign) !== "undefined") {
            columns[i].align = opt2.styles.textAlign;
          } else if ($.type(columns[i].align) === "undefined") {
            columns[i].align = "center";
          }
          if (columns[i].align) {
            var align;
            if (columns[i].align === "right") {
              align = "far";
            } else if (columns[i].align === "left") {
              align = "near";
            } else {
              align = "center";
            }
            columns[i].styles.textAlignment = align;
          }
          treeGrid._filterManager.columnOptionConvert(columns[i]);
          if (columns[i].formats) {
            if ($.type(columns[i].formats.type) === "undefined") {
              columns[i].formats.type = "text";
            }
            switch (columns[i].formats.type.toUpperCase()) {
              case "DATE":
                if (columns[i].formats.predefined === true) {
                  if ($.type(columns[i].formats.preFormat) === "undefined") {
                    columns[i].formats.preFormat = columns[i].formats.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].formats);
                  if (preDefinedFormat) {
                    columns[i].formats.format = preDefinedFormat;
                  } else {
                    columns[i].formats.format = dews._environments.formats.dateFormat;
                  }
                }
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                columns[i].styles.datetimeFormat = $.type(columns[i].formats.format) === "undefined" ? dews._environments.formats.dateFormat : columns[i].formats.format;
                break;
              case "LINK":
                columns[i].renderer = $.extend(true, columns[i].renderer, {
                  type: "link",
                  url: dews.url.getAbsoluteUrl("${" + columns[i].field + "}"),
                  showUrl: false,
                  useMenu: $.type(columns[i].formats.useMenu) === "boolean" ? columns[i].formats.useMenu : false,
                  cursor: "pointer"
                });
                break;
              case "MASK":
                var mask = columns[i].formats.format,replace = "",exp = "(",regchar = "",regcount = 1,expcount = 0;
                var predefined = columns[i].formats.predefined;
                var predefined = columns[i].formats.predefined;
                var secureFormat = columns[i].formats.secureFormat;
                if (predefined) {
                  exp = "(.*)$";
                  replace = function replace(match) {
                    var groups = Array.prototype.splice.call(arguments, 1);
                    var orgValue = groups[groups.length - 1];
                    var chgValue = orgValue;
                    var secureMask = dews.getSecureMaskFormat(secureFormat);
                    if (mask && mask !== "") {
                      chgValue = dews.string.secureMask(chgValue, mask, false);
                    }
                    if (secureMask) {
                      chgValue = dews.string.secureMask(chgValue, secureFormat, true);
                    }
                    return chgValue;
                  };
                } else if (!predefined && secureFormat && secureFormat !== "") {
                  exp = "(.*)$";
                  replace = function replace(match) {
                    var groups = Array.prototype.splice.call(arguments, 1);
                    var orgValue = groups[groups.length - 1];
                    var chgValue = orgValue;
                    if (mask && mask !== "") {
                      chgValue = dews.string.secureMask(chgValue, mask, false);
                    }
                    if (secureFormat.match(/[,]/g) && secureFormat.match(/[,]/g).length > 1) {
                      chgValue = dews.string.secureMask(chgValue, secureFormat, false);
                    }
                    return chgValue;
                  };
                } else if (mask && mask !== "") {
                  for (var m = 0; m < mask.length; m += 1) {
                    if (mask[m] !== regchar && regchar === "*") {
                      exp += "{" + expcount + "})(";
                      expcount = 0;
                      regcount++;
                    }
                    switch (mask[m]) {
                      case "0":
                      case "9":
                        if (expcount === 0) {
                          exp += "\\d";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}\\d";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "#":
                        if (expcount === 0) {
                          exp += "\\d";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}\\d";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "L":
                        if (expcount === 0) {
                          exp += "[a-zA-Z]";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}[a-zA-Z]";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "?":
                        if (expcount === 0) {
                          exp += "[a-zA-Z]";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}[a-zA-Z]";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "&":
                        if (expcount === 0) {
                          exp += "\\S";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}\\S";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "C":
                        if (expcount === 0) {
                          exp += ".";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}.";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "A":
                      case "a":
                        if (expcount === 0) {
                          exp += "[a-zA-Z0-9]";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "}[a-zA-Z0-9]";
                          expcount = 0;
                        }
                        regchar = mask[m];
                        expcount++;
                        break;
                      case "*":
                        if (expcount === 0) {
                          exp += "[a-zA-Z0-9]";
                        } else if (regchar !== mask[m]) {
                          exp += "{" + expcount + "})([a-zA-Z0-9]";
                          replace += "$" + regcount;
                          expcount = 0;
                          regcount++;
                        }
                        replace += "*";
                        regchar = mask[m];
                        expcount++;
                        break;
                      default:
                        if (mask[m] !== "*") {
                          replace += "$" + regcount + mask[m];
                        }
                        exp += "{" + expcount + "})(";
                        expcount = 0;
                        regcount++;
                        break;}

                    if (m === mask.length - 1) {
                      exp += "{" + expcount + "})";
                      if (regchar !== "*") {
                        replace += "$" + regcount;
                      }
                    }
                  }
                } else {
                  exp = "(.*)$";
                  replace = function replace(match) {
                    var groups = Array.prototype.splice.call(arguments, 1);
                    var orgValue = groups[groups.length - 1];
                    return orgValue;
                  };
                }
                columns[i].displayRegExp = exp;
                columns[i].displayReplace = replace;
                break;
              case "NUMBER":
                if (columns[i].formats.predefined === true) {
                  if ($.type(columns[i].formats.preFormat) === "undefined") {
                    columns[i].formats.preFormat = columns[i].formats.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].formats);
                  if ($.type(preDefinedFormat) === "object") {
                    columns[i].formats.round = preDefinedFormat.round;
                    preDefinedFormat = preDefinedFormat.format;
                  }
                  if (typeof columns[i].formats.currency === "string") {
                    columns[i].formats.preCurrency = columns[i].formats.currency;
                    preDefinedFormat = dews.getCurrencyFormat(columns[i].formats);
                    if ($.type(preDefinedFormat) === "object") {
                      columns[i].formats.round = preDefinedFormat.round;
                      preDefinedFormat = preDefinedFormat.format;
                    }
                  } else if (typeof columns[i].formats.currency === "function") {
                    delete columns[i].formats.round;
                    columns[i].formats.preCurrency = "";
                    columns[i].displayCallback = function (realgrid, index, value2) {
                      var dewsTreeGrid = $(realgrid._gv._container._containerDiv).closest(".dews-data-control").data("dews-control");
                      var dewsParams = {
                        treegrid: dewsTreeGrid,
                        row: {
                          index: index.dataRow,
                          data: dewsTreeGrid.dataItem(index.dataRow)
                        },
                        cell: {
                          field: index.column,
                          data: dewsTreeGrid.getCellValue(index.dataRow, index.column)
                        }
                      };
                      var dewsCol = dewsTreeGrid.columns[index.column];
                      dewsCol.formats.preCurrency = dewsCol.formats.currency.call(
                      dewsCol,
                      dewsParams);

                      var env = dews.ui.page && dews.ui.page.env && dews.ui.page.env[dewsCol.formats.preFormat];
                      var predefinedFormat = dews.getCurrencyFormat(dewsCol.formats),formats = "#,###.##",round2 = "round";
                      if (env) {
                        formats = env.format;
                        round2 = dews.mathType[env.round];
                      }
                      if ($.type(predefinedFormat) === "object") {
                        formats = predefinedFormat.format;
                        round2 = $.type(predefinedFormat.round) === "string" ? predefinedFormat.round : round2;
                      } else if ($.type(predefinedFormat) === "string") {
                        formats = predefinedFormat;
                      }
                      if (round2 !== "round") {
                        if (formats.split(".").length === 2) {
                          var sosu = Math.pow(10, formats.split(".")[1].length);
                          if (round2 === "ceil") {
                            value2 = Math.ceil(value2 * sosu) / sosu;
                          } else {
                            value2 = Math.floor(value2 * sosu) / sosu;
                          }
                        }
                      }
                      var oldFormats = dewsTreeGrid._grid.getColumnProperty(
                      dewsCol.name,
                      "excelFormat");

                      if (!oldFormats) {
                        dewsTreeGrid._grid.setColumnProperty(dewsCol.name, "excelFormat", formats);
                      }
                      return dews.number.format(value2, formats);
                    };
                  }
                  if (preDefinedFormat) {
                    columns[i].formats.format = preDefinedFormat;
                  } else {
                    columns[i].formats.format = "#,##0.##";
                  }
                }
                if ($.type(columns[i].formats.abs) === "boolean" && columns[i].formats.abs) {
                  columns[i].dynamicStyles = [
                  {
                    criteria: "value<0",
                    styles: {
                      foreground: $.type(columns[i].formats.negative) === "undefined" ? "#e62324" : columns[i].formats.negative,
                      numberFormat: columns[i].formats.format + ";a"
                    }
                  }];

                  if ($.type(columns[i].formats.positive) !== "undefined") {
                    columns[i].dynamicStyles.push({
                      criteria: "value>=0",
                      styles: {
                        foreground: columns[i].formats.positive,
                        numberFormat: columns[i].formats.format + ";a"
                      }
                    });
                  }
                }
                if (columns[i].formats.negativeColor) {var _dews$ui$page8;
                  var useNegativeColor = false;
                  var MA00041 = (_dews$ui$page8 = dews.ui.page) === null || _dews$ui$page8 === void 0 ? void 0 : _dews$ui$page8.env["MA00041"];
                  if (MA00041) {
                    useNegativeColor = MA00041.value === "2";
                  }
                  if (useNegativeColor) {
                    columns[i].dynamicStyles = [
                    {
                      criteria: "value<0",
                      styles: {
                        foreground: "#e62324"
                      }
                    }];

                  }
                }
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].dataType = "number";
                  dataSource.field[opt2.fieldIndex].min = columns[i].formats.min;
                  dataSource.field[opt2.fieldIndex].max = columns[i].formats.max;
                  dataSource.field[opt2.fieldIndex].styles.numberFormat = $.type(columns[i].formats.format) === "undefined" ? "#,##0.##" : columns[i].formats.format;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "number";
                  dataSource.schema.model.fields[opt2.fieldIndex].numberFormat = $.type(columns[i].formats.format) === "undefined" ? "#,##0.##" : columns[i].formats.format;
                }
                if ($.type(columns[i].formats.round) === "undefined" || columns[i].formats.round === "round") {
                  if ($.type(columns[i].formats.currency) !== "function") {
                    columns[i].styles.numberFormat = columns[i].formats.format;
                  }
                } else if (columns[i].formats.round === "ceil") {
                  columns[i].styles.numberFormat = columns[i].formats.format + ";;;c";
                } else if (columns[i].formats.round === "floor") {
                  columns[i].styles.numberFormat = columns[i].formats.format + ";;;f";
                }
                break;
              case "CHECK":
                columns[i].renderer = {
                  type: "check",
                  shape: "box",
                  editable: false,
                  startEditOnClick: true,
                  trueValues: $.type(columns[i].formats.trueValue) === "undefined" ? "true" : columns[i].formats.trueValue,
                  falseValues: $.type(columns[i].formats.falseValue) === "undefined" ? "false" : columns[i].formats.falseValue,
                  trueImage: opt2.gridStyle.body.checkedImg,
                  falseImage: opt2.gridStyle.body.unCheckImg,
                  labelPosition: "none",
                  showInnerFocus: false
                };
                columns[i].editable = false;
                columns[i].styles.figureBackground = "#ff4995ff";
                break;
              case "DATASOURCE":
                var value = columns[i].formats.dataValueField,label = columns[i].formats.dataTextField,cfDataSource = columns[i].formats.dataSource,cfDataSourceData;
                columns[i].values = [];
                columns[i].labels = [];
                columns[i].lookupDisplay = true;
                if (cfDataSource) {
                  cfDataSource.fetch().done(function () {
                    var values2 = [],labels2 = [],column = treeGrid._grid.columnByField(columns[i].field);
                    cfDataSourceData = cfDataSource.data();
                    if (cfDataSourceData.length > 0) {
                      for (var k = 0; k < cfDataSourceData.length; k++) {
                        values2.push(cfDataSourceData[k][value]);
                        labels2.push(cfDataSourceData[k][label]);
                      }
                    }
                    if (!column) {
                      column = columns[i];
                    }
                    column.values = values2;
                    column.labels = labels2;
                    treeGrid._grid.setColumn(column);
                  });
                }
                break;
              case "IMAGE":
                columns[i].editable = false;
                columns[i].renderer = {
                  type: "image",
                  smoothing: true
                };
                columns[i].styles.contentFit = "auto";
                break;
              case "TIME":
                if (columns[i].formats.predefined === true) {
                  if ($.type(columns[i].formats.preFormat) === "undefined") {
                    columns[i].formats.preFormat = columns[i].formats.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].formats);
                  if (preDefinedFormat) {
                    columns[i].formats.format = preDefinedFormat;
                  } else {
                    columns[i].formats.format = "HH:mm:ss";
                  }
                }
                var time = columns[i].formats.format,timeReg = "";
                if (/HH/gi.test(time)) {
                  timeReg = time.replace(/HH/gi, "$1");
                }
                if (/mm/gi.test(time)) {
                  timeReg = timeReg.replace(/mm/gi, "$2");
                }
                if (/ss/gi.test(time)) {
                  timeReg = timeReg.replace(/ss/gi, "$3");
                }
                columns[i].displayRegExp = /([0-1]\d|2[0-3])([0-5]\d)([0-5]\d)?/gi;
                columns[i].displayReplace = timeReg;
                break;
              case "PASSWORD":
                var format = columns[i].formats.format;
                columns[i].displayRegExp = /([a-z0-9#?!@$%^~&*-]+)/gi;
                columns[i].displayReplace = format;
                break;
              case "MONTH":
                if (columns[i].formats.predefined === true) {
                  if ($.type(columns[i].formats.preFormat) === "undefined") {
                    columns[i].formats.preFormat = columns[i].formats.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].formats);
                  if (preDefinedFormat) {
                    columns[i].formats.format = preDefinedFormat;
                  } else {
                    columns[i].formats.format = dews._environments.formats.monthFormat;
                  }
                }
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                columns[i].styles.datetimeFormat = $.type(columns[i].formats.format) === "undefined" ? dews._environments.formats.monthFormat : columns[i].formats.format;
                break;
              case "YEAR":
                if (columns[i].formats.predefined === true) {
                  if ($.type(columns[i].formats.preFormat) === "undefined") {
                    columns[i].formats.preFormat = columns[i].formats.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].formats);
                  if (preDefinedFormat) {
                    columns[i].formats.format = preDefinedFormat;
                  } else {
                    columns[i].formats.format = dews._environments.formats.yearFormat;
                  }
                }
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.yearValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.yearValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                columns[i].styles.datetimeFormat = $.type(columns[i].formats.format) === "undefined" ? dews._environments.formats.yearFormat : columns[i].formats.format;
                break;
              case "FUNCTION":
                columns[i].displayCallback = function (realgrid, index, value2) {
                  var dewsTreeGrid = $(realgrid._gv._container._containerDiv).closest(".dews-data-control").data("dews-control");
                  var dewsParams = {
                    grid: dewsTreeGrid,
                    row: {
                      index: index.dataRow,
                      data: dewsTreeGrid.dataItem(index.dataRow)
                    },
                    cell: {
                      field: index.column,
                      data: dewsTreeGrid.getCellValue(index.dataRow, index.column)
                    }
                  };
                  return dewsTreeGrid.columns[index.column].formats.format.call(
                  dewsTreeGrid,
                  value2,
                  dewsParams);

                };
                break;
              case "BAR":
                var barRenderer = grid._columnRenderer.getBarRenderer(columns[i]);
                $.extend(true, columns[i], barRenderer);
                break;
              case "SIGNAL":
                var signalRenderer = grid._columnRenderer.getSignalRenderer(columns[i]);
                $.extend(true, columns[i], signalRenderer);
                break;}

          }
          if (columns[i].editor) {
            var editorAlign = "center";
            if (columns[i].styles.textAlignment) {
              editorAlign = columns[i].styles.textAlignment;
            }
            if ($.type(columns[i].editor.type) === "undefined") {
              columns[i].editor.type = "string";
            }
            if (typeof columns[i].editable === "boolean" && !columns[i].editable && columns[i].editor.type.toLowerCase() !== "check") {
              columns[i].editor.editable = columns[i].editable;
            } else {
              var userColumn;
              if (columns[i].editor.type.toLowerCase() === "check") {
                userColumn = findUserOptionsColumn4(treeGrid.userOptions.columns, columns[i].field);
              }
              if (userColumn && userColumn.editable !== void 0 && !userColumn.editable) {
                columns[i].editor.editable = columns[i].editable;
              } else {
                if ($.type(columns[i].editor.editable) === "boolean" || $.type(columns[i].editor.editable) === "function") {
                  columns[i].editable = columns[i].editor.editable;
                } else if ($.type(columns[i].editor.editable) === "undefined") {
                  columns[i].editor.editable = columns[i].editable;
                }
              }
            }
            columns[i].editor.textAlignment = editorAlign;
            columns[i].buttonVisibility = "hidden";
            columns[i].editButtonVisibility = "hidden";
            switch (columns[i].editor.type.toUpperCase()) {
              case "DROPDOWN":
              case "COMBO":
                var values = columns[i].editor.dataValueField,labels = columns[i].editor.dataTextField,datasource = columns[i].editor.dataSource;
                columns[i].values = [];
                columns[i].labels = [];
                columns[i].editButtonVisibility = "visible";
                if (columns[i].editor.type.toUpperCase() === "DROPDOWN") {
                  columns[i].editor.textReadOnly = true;
                  if (columns[i].editor.autoOpen) {
                    columns[i].editor.autoOpen = true;
                  }
                  columns[i].editor.useNumkey = $.type(columns[i].editor.useNumkey) === "boolean" ? columns[i].editor.useNumkey : true;
                } else {
                  columns[i].editor.textReadOnly = false;
                }
                columns[i].editor.type = "dropDown";
                columns[i].lookupDisplay = true;
                columns[i].editor.dropdowncount = 3;
                if ($.type(columns[i].editor.dataSource) === "function") {
                  datasource = columns[i].editor.dataSource.call(treeGrid, {
                    treeGrid: treeGrid,
                    row: {
                      index: 0,
                      data: {
                        labels: "",
                        values: ""
                      }
                    }
                  });
                  if ($.type(columns[i].editor.textField) === "undefined") {
                    columns[i].labelField = labels;
                  } else {
                    columns[i].labelField = columns[i].editor.textField;
                  }
                }
                if (typeof columns[i].editor.dataSelectable === "string") {
                  columns[i].editor.dataSelectable = {
                    field: columns[i].editor.dataSelectable,
                    trueValue: true,
                    falseValue: false
                  };
                }
                var dataSelectable = columns[i].editor.dataSelectable;
                columns[i].editor.values = [];
                columns[i].editor.labels = [];
                if (datasource && datasource.transport && datasource.transport.data && datasource.transport.data.length > 0) {
                  var transportData = datasource.transport.data;
                  for (var j = 0; j < transportData.length; j += 1) {
                    columns[i].values.push(transportData[j][values]);
                    columns[i].labels.push(transportData[j][labels]);
                    if (dataSelectable && transportData[j][dataSelectable.field] !== dataSelectable.falseValue) {
                      columns[i].editor.values.push(transportData[j][values]);
                      columns[i].editor.labels.push(transportData[j][labels]);
                    }
                  }
                }
                break;
              case "NUMBER":
                if (columns[i].editor.predefined === true) {
                  if ($.type(columns[i].editor.preFormat) === "undefined") {
                    columns[i].editor.preFormat = columns[i].editor.format;
                  }
                  var preDefinedFormat;
                  if ($.type(columns[i].editor.currency) === "undefined") {
                    preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                  } else if ($.type(columns[i].editor.currency) === "string") {
                    columns[i].editor.preCurrency = columns[i].editor.currency;
                    preDefinedFormat = dews.getCurrencyFormat(columns[i].editor);
                  }
                  if ($.type(preDefinedFormat) === "object") {
                    preDefinedFormat = preDefinedFormat.format;
                  }
                  if (preDefinedFormat) {
                    columns[i].editor.format = preDefinedFormat;
                  } else {
                    columns[i].editor.format = "#,##0.##";
                  }
                } else {
                  columns[i].editor.format = columns[i].editor.format ? columns[i].editor.format : "#,##0.##";
                }
                var decimalPlaceRegex = /[^.]*$/;
                var includesDot = columns[i].editor.format.indexOf(".");
                var formatLetters = includesDot !== -1 ? decimalPlaceRegex.exec(columns[i].editor.format)[0] : "";
                var formatLettersLength = formatLetters.length;
                var formatLetter = formatLettersLength > 0 ? formatLetters.charAt(formatLettersLength - 1) : "#";
                var decimalLength, intLength, maxLength;
                if (typeof columns[i].editor.maxLength === "string") {
                  maxLength = columns[i].editor.maxLength;
                } else if (typeof columns[i].editor.__maxLength === "string") {
                  maxLength = columns[i].editor.__maxLength;
                }
                if ($.type(maxLength) === "string") {
                  var maxLengthRegex = /^(\d+)(?:,(\d+))?$/;
                  var matchArray = maxLengthRegex.exec(maxLength);
                  columns[i].editor.__maxLength = maxLength;
                  if (matchArray && matchArray.length > 0) {
                    intLength = parseInt(matchArray[1], 10);
                    try {
                      if (intLength > 15) {
                        throw "\uC22B\uC790\uD14D\uC2A4\uD2B8\uBC15\uC2A4 maxLength \uC18D\uC131\uC758 \uC124\uC815 \uAC00\uB2A5\uD55C \uCD5C\uB300\uAC12\uC740 15\uC785\uB2C8\uB2E4.";
                      }
                      if (matchArray[2]) {
                        var newFormat;
                        decimalLength = parseInt(matchArray[2], 10);
                        intLength = intLength - decimalLength;
                        if (intLength <= 0) {
                          throw "\uC22B\uC790\uD14D\uC2A4\uD2B8\uBC15\uC2A4 maxLength \uC18D\uC131\uC758 \uC124\uC815\uAC12\uC740 \uC815\uC218\uBD80\uC758 \uC22B\uC790\uAC00 \uC18C\uC218\uBD80\uC758 \uC22B\uC790\uBCF4\uB2E4 \uCEE4\uC57C\uD569\uB2C8\uB2E4.";
                        }
                        if (formatLettersLength > decimalLength) {
                          newFormat = (includesDot !== -1 ? columns[i].editor.format.replace(decimalPlaceRegex, "") : columns[i].editor.format + ".") + formatLetters.substr(0, decimalLength);
                        } else if (formatLettersLength < decimalLength) {
                          newFormat = (includesDot !== -1 ? columns[i].editor.format.replace(decimalPlaceRegex, "") : columns[i].editor.format + ".") + formatLetters + formatLetter.repeat(decimalLength - formatLettersLength);
                        } else {
                          newFormat = columns[i].editor.format;
                        }
                        columns[i].editor.format = newFormat;
                      } else {
                        columns[i].editor.format = columns[i].editor.format.split(".")[0];
                      }
                    } catch (e) {
                      intLength = 15 - formatLettersLength;
                      console.error(e);
                    }
                    columns[i].editor.maxIntegerLength = intLength;
                  }
                  columns[i].editor.maxLength = 0;
                } else if (typeof maxLength === "undefined") {
                  columns[i].editor.maxIntegerLength = 15 - formatLettersLength;
                }
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].dataType = "number";
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "number";
                  dataSource.field[opt2.fieldIndex].min = columns[i].editor.min;
                  dataSource.field[opt2.fieldIndex].max = columns[i].editor.max;
                }
                columns[i].editor.editFormat = $.type(columns[i].editor.format) === "undefined" ? "#,##0.##" : columns[i].editor.format;
                columns[i].editor.increaseValue = $.type(columns[i].editor.increaseValue) === "undefined" ? 1e3 : parseFloat(columns[i].editor.increaseValue);
                columns[i].editor.increaseType = $.type(columns[i].editor.increaseType) === "undefined" ? "multiple" : columns[i].editor.increaseType;
                break;
              case "STRING":
                columns[i].editor.type = "text";
                break;
              case "DATE":
                if (columns[i].editor.predefined === true) {
                  if ($.type(columns[i].editor.preFormat) === "undefined") {
                    columns[i].editor.preFormat = columns[i].editor.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                  if (preDefinedFormat) {
                    columns[i].editor.format = preDefinedFormat;
                  } else {
                    columns[i].editor.format = dews._environments.formats.dateFormat;
                  }
                }
                columns[i].editor.maxDate = new Date(9999, 12, 0);
                columns[i].editor.minDate = new Date(1e3, 0, 1);
                columns[i].editor.yearDisplayFormat = "{Y}" + dews.localize.get("\uB144", "dews_\uB144Y");
                columns[i].editor.months = dews.localize.getMonth();
                columns[i].editor.weekDays = dews.localize.getDays();
                columns[i].editor.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.dateFormat : columns[i].editor.format;
                columns[i].styles.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.dateFormat : columns[i].editor.format;
                columns[i].editor.mask = {
                  editMask: $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.dateFormat.replace(/[A-z\\s]/gi, "9") : columns[i].editor.format.replace(/[A-z\\s]/gi, "9"),
                  includedFormat: true
                };
                columns[i].editButtonVisibility = "visible";
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                break;
              case "READONLY":
                columns[i].readOnly = true;
                columns[i].editable = false;
                break;
              case "MASK":
              case "TIME":
                var editMask = columns[i].editor.format;
                if (editMask) {
                  for (var em = 0; em < editMask.length; em += 1) {
                    switch (editMask[em]) {
                      case "L":
                      case "?":
                      case "#":
                      case "&":
                        editMask = editMask.replace(editMask[em], "a");
                        break;
                      case "A":
                      case "a":
                        editMask = editMask.replace(editMask[em], "*");
                        break;
                      case "H":
                      case "m":
                      case "s":
                        editMask = editMask.replace(editMask[em], "0");
                        break;}

                  }
                }
                if (columns[i].editor.type.toUpperCase() === "TIME") {
                  columns[i].editor.type = "time";
                  if (columns[i].editor.predefined === true) {
                    if ($.type(columns[i].editor.preFormat) === "undefined") {
                      columns[i].editor.preFormat = columns[i].editor.format;
                    }
                    var preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                    if (preDefinedFormat) {
                      editMask = preDefinedFormat;
                    } else {
                      editMask = "HH:mm:ss";
                    }
                  }
                  var secondValue = false;
                  if (typeof columns[i].editor.secondValue === "boolean" && columns[i].editor.secondValue === true) {
                    secondValue = true;
                  }
                  columns[i].button = "image";
                  columns[i].buttonVisibility = "visible";
                  if ($.type(columns[i].editor.editable) === "boolean" && !columns[i].editor.editable) {
                    columns[i].buttonVisibility = "hidden";
                  }
                  var clockIcon = dews._environments.scriptBase + "realgrid/assets/comp-icon-clock.png";
                  columns[i].imageButtons = {
                    width: 24,
                    height: 22,
                    images: [
                    {
                      name: "timebutton",
                      up: clockIcon,
                      hover: clockIcon,
                      down: clockIcon
                    }]

                  };
                  if ($("#" + treeGrid._grid.name + "_time").length === 0) {
                    var timepicker = $('<input class="dews-ui-timepicker">');
                    timepicker.prop("id", treeGrid._grid.name + "_time");
                    $("body").after(timepicker);
                    columns[i].timepicker = dews.ui.timepicker(timepicker, {
                      secondValue: secondValue
                    });
                    $("body").after(columns[i].timepicker.timeView.ul.parent(".k-list-container"));
                  } else {
                    columns[i].timepicker = dews.ui.timepicker($("#" + treeGrid._grid.name + "_time"));
                  }
                  columns[i].timepicker.wrapper.css({
                    display: "none",
                    height: opt2.display.rowHeight
                  });
                } else {
                  columns[i].editor.type = "text";
                }
                if ($.type(editMask) === "function") {
                  columns[i].editor.mask = {
                    allowEmpty: true
                  };
                } else {
                  if (editMask !== "") {
                    columns[i].editor.mask = {
                      editMask: editMask,
                      allowEmpty: true
                    };
                  }
                }
                break;
              case "CODEPICKER":
                columns[i].editor.firstClick = true;
                columns[i].button = "image";
                columns[i].buttonVisibility = "visible";
                if ($.type(columns[i].editor.editable) === "boolean") {
                  if (!columns[i].editor.editable) {
                    columns[i].buttonVisibility = "hidden";
                  }
                }
                columns[i].imageButtons = {
                  width: 24,
                  height: 22,
                  images: [
                  {
                    name: "codepickerbutton",
                    up: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
                    hover: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
                    down: dews._environments.scriptBase + "realgrid/assets/search_ico.png"
                  }]

                };
                opt2._grid = true;
                columns[i].codeOption = {
                  field: columns[i].field,
                  code: columns[i].editor.helpCode,
                  codeField: columns[i].editor.codeField,
                  textField: columns[i].editor.textField,
                  gridCodeField: columns[i].editor.gridCodeField,
                  gridTextField: columns[i].editor.gridTextField,
                  params: columns[i].editor.helpParams,
                  size: columns[i].editor.helpSize,
                  title: columns[i].editor.helpTitle,
                  mode: "single",
                  width: columns[i].editor.helpWidth,
                  height: columns[i].editor.helpHeight,
                  initData: columns[i].editor.initData,
                  callback: columns[i].editor.callback,
                  custom: columns[i].editor.helpCustom || false,
                  viewUrl: columns[i].editor.helpViewUrl,
                  apiUrl: columns[i].editor.helpApiUrl,
                  moveFocus: $.type(columns[i].editor.moveFocus) === "boolean" ? columns[i].editor.moveFocus : true,
                  useAjax: $.type(columns[i].editor.useAjax) === "boolean" ? columns[i].editor.useAjax : true,
                  validation: $.type(columns[i].editor.validation) === "boolean" ? columns[i].editor.validation : true,
                  value: {}
                };
                break;
              case "BUTTON":
                columns[i].buttonVisibility = "always";
                if ($.type(columns[i].editor.align) !== "undefined") {
                  switch (columns[i].editor.align.toLowerCase()) {
                    case "left":
                      columns[i].editor.align = "near";
                      break;
                    case "right":
                      columns[i].editor.align = "far";
                      break;}

                }
                columns[i].renderer = {
                  type: "imageButtons",
                  showText: true,
                  width: $.type(columns[i].editor.buttonWidth) === "undefined" ? 50 : columns[i].editor.buttonWidth,
                  height: $.type(columns[i].editor.buttonHeight) === "undefined" ? 25 : columns[i].editor.buttonHeight,
                  images: {
                    up: columns[i].editor.basicImg,
                    hover: columns[i].editor.hoverImg,
                    down: columns[i].editor.clickImg,
                    width: $.type(columns[i].editor.buttonWidth) === "undefined" ? 50 : columns[i].editor.buttonWidth
                  },
                  alignment: columns[i].editor.align ? columns[i].editor.align : "center",
                  margin: columns[i].editor.align === "far" ? -4 : 0
                };
                break;
              case "CHECK":
                columns[i].renderer = {
                  type: "check",
                  shape: "box",
                  editable: $.type(columns[i].editor.editable) === "boolean" ? columns[i].editor.editable : true,
                  startEditOnClick: true,
                  trueValues: $.type(columns[i].editor.trueValue) === "undefined" ? "true" : columns[i].editor.trueValue,
                  falseValues: $.type(columns[i].editor.falseValue) === "undefined" ? "false" : columns[i].editor.falseValue,
                  trueImage: opt2.gridStyle.body.checkedImg,
                  falseImage: opt2.gridStyle.body.unCheckImg,
                  labelPosition: "none",
                  showInnerFocus: false
                };
                columns[i].editable = false;
                columns[i].styles.figureBackground = "#ff4995ff";
                break;
              case "ZIPCODEPICKER":
                columns[i].button = "image";
                columns[i].buttonVisibility = "visible";
                if ($.type(columns[i].editor.editable) === "boolean" && !columns[i].editor.editable) {
                  columns[i].buttonVisibility = "hidden";
                }
                columns[i].imageButtons = {
                  width: 24,
                  height: 22,
                  images: [
                  {
                    name: "zipcodepickerbutton",
                    up: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
                    hover: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
                    down: dews._environments.scriptBase + "realgrid/assets/search_ico.png"
                  }]

                };
                opt2._grid = true;
                columns[i].codeOption = {
                  field: columns[i].field,
                  addressType: $.type(columns[i].editor.addressType) === "undefined" ? "zipcode" : columns[i].editor.addressType,
                  callback: columns[i].editor.callback
                };
                break;
              case "MULTILINE":
                columns[i].editor.type = "multiline";
                columns[i].styles.textWrap = "explicit";
                break;
              case "MONTH":
                if (columns[i].editor.predefined === true) {
                  if ($.type(columns[i].editor.preFormat) === "undefined") {
                    columns[i].editor.preFormat = columns[i].editor.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                  if (preDefinedFormat) {
                    columns[i].editor.format = preDefinedFormat;
                  } else {
                    columns[i].editor.format = dews._environments.formats.monthFormat;
                  }
                }
                columns[i].editor.minDate = new Date(1900, 0, 1);
                columns[i].editor.maxDate = new Date(2100, 12, 0);
                columns[i].editor.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.monthFormat : columns[i].editor.format;
                columns[i].styles.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.monthFormat : columns[i].editor.format;
                columns[i].editor.mask = {
                  editMask: $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.monthFormat.replace(/[A-z\\s]/gi, "9") : columns[i].editor.format.replace(/[A-z\\s]/gi, "9"),
                  includedFormat: true
                };
                columns[i].button = "image";
                columns[i].buttonVisibility = "visible";
                if ($.type(columns[i].editor.editable) === "boolean" && !columns[i].editor.editable) {
                  columns[i].buttonVisibility = "hidden";
                }
                columns[i].imageButtons = {
                  width: 24,
                  height: 22,
                  images: [
                  {
                    name: "monthbutton",
                    up: dews._environments.scriptBase + "realgrid/assets/calendar_up.png",
                    hover: dews._environments.scriptBase + "realgrid/assets/calendar_hover.png",
                    down: dews._environments.scriptBase + "realgrid/assets/calendar_down.png"
                  }]

                };
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                if ($("#" + treeGrid._grid.name + "_month").length === 0) {
                  var monthpicker = $('<input class="dews-ui-monthpicker">');
                  monthpicker.prop("id", treeGrid._grid.name + "_month");
                  $("body").after(monthpicker);
                  columns[i].monthpicker = dews.ui.monthpicker(monthpicker);
                  $("body").after(columns[i].monthpicker.dateView.div);
                } else {
                  columns[i].monthpicker = dews.ui.monthpicker($("#" + treeGrid._grid.name + "_month"));
                }
                columns[i].monthpicker.wrapper.css({
                  display: "none",
                  height: opt2.display.rowHeight
                });
                break;
              case "YEAR":
                if (columns[i].editor.predefined === true) {
                  if ($.type(columns[i].editor.preFormat) === "undefined") {
                    columns[i].editor.preFormat = columns[i].editor.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].editor);
                  if (preDefinedFormat) {
                    columns[i].editor.format = preDefinedFormat;
                  } else {
                    columns[i].editor.format = dews._environments.formats.yearFormat;
                  }
                }
                columns[i].editor.minDate = new Date(1900, 0, 1);
                columns[i].editor.maxDate = new Date(2100, 12, 0);
                columns[i].editor.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.yearFormat : columns[i].editor.format;
                columns[i].styles.datetimeFormat = $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.yearFormat : columns[i].editor.format;
                columns[i].editor.mask = {
                  editMask: $.type(columns[i].editor.format) === "undefined" ? dews._environments.formats.yearFormat.replace(/[A-z\\s]/gi, "9") : columns[i].editor.format.replace(/[A-z\\s]/gi, "9"),
                  includedFormat: true
                };
                columns[i].button = "image";
                columns[i].buttonVisibility = "visible";
                if ($.type(columns[i].editor.editable) === "boolean" && !columns[i].editor.editable) {
                  columns[i].buttonVisibility = "hidden";
                }
                columns[i].imageButtons = {
                  width: 24,
                  height: 22,
                  images: [
                  {
                    name: "yearbutton",
                    up: dews._environments.scriptBase + "realgrid/assets/calendar_up.png",
                    hover: dews._environments.scriptBase + "realgrid/assets/calendar_hover.png",
                    down: dews._environments.scriptBase + "realgrid/assets/calendar_down.png"
                  }]

                };
                if ($.type(opt2.fieldIndex) !== "undefined") {
                  dataSource.field[opt2.fieldIndex].datetimeFormat = dews._environments.formats.yearValueFormat;
                  dataSource.field[opt2.fieldIndex].dataType = "datetime";
                  dataSource.schema.model.fields[opt2.fieldIndex].datetimeFormat = dews._environments.formats.yearValueFormat;
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "datetime";
                }
                if ($("#" + treeGrid._grid.name + "_year").length === 0) {
                  var yearpicker = $('<input class="dews-ui-yearpicker">');
                  yearpicker.prop("id", treeGrid._grid.name + "_year");
                  $("body").after(yearpicker);
                  columns[i].yearpicker = dews.ui.yearpicker(yearpicker);
                  $("body").after(columns[i].yearpicker.dateView.div);
                } else {
                  columns[i].yearpicker = dews.ui.yearpicker($("#" + treeGrid._grid.name + "_year"));
                }
                columns[i].yearpicker.wrapper.css({
                  display: "none",
                  height: opt2.display.rowHeight
                });
                break;}

          }
          if (columns[i].attributes) {
            if (columns[i].attributes["class"] === "required" || columns[i].attributes["class"] === "none") {
              columns[i].styles.background = columns[i].attributes["class"] === "required" ? opt2.gridStyle.body.requiredBackground : opt2.gridStyle.body.background;
              columns[i].readOnly = false;
              if (columns[i].editor && columns[i].editor.type && columns[i].editor.type.toUpperCase() === "DROPDOWN" && treeGrid.userOptions) {
                var currentColumn = findUserOptionsColumn4(treeGrid.userOptions.columns, columns[i].field);
                columns[i].editor.textReadOnly = currentColumn && currentColumn.editor && currentColumn.editor.type && currentColumn.editor.type.toUpperCase() === "COMBO" ? false : true;
              }
            } else if (columns[i].attributes["class"] === "readonly") {
              columns[i].styles.background = opt2.gridStyle.body.readonlyBackground;
              columns[i].readOnly = true;
              columns[i].editable = false;
            }
          }
          if (columns[i].footer) {
            opt2.footer.visible = true;
            if (opt2.multiFooterCnt > 1) {
              opt2.footer.count = opt2.multiFooterCnt;
              opt2.footer.minHeight = 32 * opt2.multiFooterCnt;
              var multiFooterArray = [];
              if ($.type(columns[i].footer) === "object") {
                multiFooterArray.push(columns[i].footer);
              } else if ($.type(columns[i].footer) === "array") {
                multiFooterArray = columns[i].footer;
              }
              var footerStyles = [];
              var footerExpression = [];
              var footerPreCurrency = [];
              var footerPreFormat = [];
              var footerText = [];
              for (var footerIdx = 0; footerIdx < multiFooterArray.length; footerIdx++) {
                footerStyles.push({});
                if (multiFooterArray[footerIdx].text) {
                  footerText[footerIdx] = multiFooterArray[footerIdx].text;
                }
                if (multiFooterArray[footerIdx].styles === void 0) {
                  var footerAlign = "center";
                  if (columns[i].styles.textAlignment) {
                    footerAlign = columns[i].styles.textAlignment;
                  }
                  footerStyles[footerIdx].textAlignment = footerAlign;
                }
                if ($.type(multiFooterArray[footerIdx].align) !== "undefined") {
                  switch (multiFooterArray[footerIdx].align.toLowerCase()) {
                    case "left":
                      footerStyles[footerIdx].textAlignment = "near";
                      break;
                    case "right":
                      footerStyles[footerIdx].textAlignment = "far";
                      break;
                    default:
                      footerStyles[footerIdx].textAlignment = "center";
                      break;}

                }
                if (multiFooterArray[footerIdx].type) {
                  if ($.type(opt2.fieldIndex) !== "undefined" && multiFooterArray[footerIdx].type.toLowerCase() !== "count") {
                    dataSource.field[opt2.fieldIndex].dataType = "number";
                    dataSource.schema.model.fields[opt2.fieldIndex].dataType = "number";
                  }
                  footerExpression[footerIdx] = multiFooterArray[footerIdx].type;
                  footerStyles[footerIdx].numberFormat = $.type(multiFooterArray[footerIdx].format) === "undefined" ? "#,##0.##" : multiFooterArray[footerIdx].format;
                  if (multiFooterArray[footerIdx].predefined === true) {
                    if ($.type(footerPreFormat[footerIdx]) === "undefined" || footerPreFormat[footerIdx].preFormat !== footerPreFormat[footerIdx].format) {
                      footerPreFormat[footerIdx] = multiFooterArray[footerIdx].format;
                      multiFooterArray[footerIdx].preFormat = multiFooterArray[footerIdx].format;
                    }
                    var preDefinedFormat = dews.getPreDefinedFormat(multiFooterArray[footerIdx]);
                    if ($.type(multiFooterArray[footerIdx].currency) !== "undefined") {
                      if ($.type(multiFooterArray[footerIdx].currency) === "string") {
                        footerPreCurrency[footerIdx] = multiFooterArray[footerIdx].currency;
                        multiFooterArray[footerIdx].preCurrency = multiFooterArray[footerIdx].currency;
                        preDefinedFormat = dews.getCurrencyFormat(multiFooterArray[footerIdx]);
                        if (preDefinedFormat) {
                          var round = $.type(preDefinedFormat.round) === "string" ? preDefinedFormat.round : "round";
                          if (round !== "round") {
                            if (preDefinedFormat.format.split(".").length === 2) {
                              if (round === "ceil") {
                                preDefinedFormat.format += ";;;c";
                              } else {
                                preDefinedFormat.format += ";;;f";
                              }
                            }
                          }
                        }
                      } else if ($.type(multiFooterArray[footerIdx].currency) === "function") {
                        footerPreCurrency[footerIdx] = "";
                        multiFooterArray[footerIdx].preCurrency = "";
                        treeGrid._grid._gv._footer._cell.__proto__.value = _displayFooterText2();
                      }
                    }
                    if ($.type(preDefinedFormat) === "object") {
                      preDefinedFormat = preDefinedFormat.format;
                    }
                    if (preDefinedFormat) {
                      footerStyles[footerIdx].numberFormat = preDefinedFormat;
                    } else {
                      footerStyles[footerIdx].numberFormat = "#,##0.##";
                    }
                  }
                }
                if (multiFooterArray[footerIdx].prefix) {
                  footerStyles[footerIdx].prefix = multiFooterArray[footerIdx].prefix;
                }
                if (multiFooterArray[footerIdx].suffix) {
                  footerStyles[footerIdx].suffix = multiFooterArray[footerIdx].suffix;
                }
              }
              columns[i].footer.styles = footerStyles;
              columns[i].footer.expression = footerExpression;
              columns[i].footer.preCurrency = footerPreCurrency;
              columns[i].footer.preFormat = footerPreFormat;
              columns[i].footer.text = footerText;
            } else {
              opt2.footer.count = 1;
              if (columns[i].footer.styles === void 0) {
                var footerAlign = "center";
                if (columns[i].styles.textAlignment) {
                  footerAlign = columns[i].styles.textAlignment;
                }
                columns[i].footer.styles = {
                  textAlignment: footerAlign
                };
              }
              if ($.type(columns[i].footer.align) !== "undefined") {
                switch (columns[i].footer.align.toLowerCase()) {
                  case "left":
                    columns[i].footer.styles.textAlignment = "near";
                    break;
                  case "right":
                    columns[i].footer.styles.textAlignment = "far";
                    break;
                  default:
                    columns[i].footer.styles.textAlignment = "center";
                    break;}

              }
              if (columns[i].footer.type) {
                if ($.type(opt2.fieldIndex) !== "undefined" && columns[i].footer.type.toLowerCase() !== "count") {
                  dataSource.field[opt2.fieldIndex].dataType = "number";
                  dataSource.schema.model.fields[opt2.fieldIndex].dataType = "number";
                }
                columns[i].footer.expression = columns[i].footer.type;
                columns[i].footer.styles.numberFormat = $.type(columns[i].footer.format) === "undefined" ? "#,##0.##" : columns[i].footer.format;
                if (columns[i].footer.predefined === true) {
                  if ($.type(columns[i].footer.preFormat) === "undefined" || columns[i].footer.preFormat !== columns[i].footer.format) {
                    columns[i].footer.preFormat = columns[i].footer.format;
                  }
                  var preDefinedFormat = dews.getPreDefinedFormat(columns[i].footer);
                  if ($.type(columns[i].footer.currency) !== "undefined") {
                    if ($.type(columns[i].footer.currency) === "string") {
                      columns[i].footer.preCurrency = columns[i].footer.currency;
                      preDefinedFormat = dews.getCurrencyFormat(columns[i].footer);
                      if (preDefinedFormat) {
                        var round = $.type(preDefinedFormat.round) === "string" ? preDefinedFormat.round : "round";
                        if (round !== "round") {
                          if (preDefinedFormat.format.split(".").length === 2) {
                            if (round === "ceil") {
                              preDefinedFormat.format += ";;;c";
                            } else {
                              preDefinedFormat.format += ";;;f";
                            }
                          }
                        }
                      }
                    } else if ($.type(columns[i].footer.currency) === "function") {
                      columns[i].footer.preCurrency = "";
                      treeGrid._grid._gv._footer._cell.__proto__.value = _displayFooterText2();
                    }
                  }
                  if ($.type(preDefinedFormat) === "object") {
                    preDefinedFormat = preDefinedFormat.format;
                  }
                  if (preDefinedFormat) {
                    columns[i].footer.styles.numberFormat = preDefinedFormat;
                  } else {
                    columns[i].footer.styles.numberFormat = "#,##0.##";
                  }
                }
              }
              if (columns[i].footer.prefix) {
                columns[i].footer.styles.prefix = columns[i].footer.prefix;
              }
              if (columns[i].footer.suffix) {
                columns[i].footer.styles.suffix = columns[i].footer.suffix;
              }
            }
          }
          if (columns[i].suffix) {
            columns[i].styles.suffix = columns[i].suffix;
          }
          if (columns[i].prefix) {
            columns[i].styles.prefix = columns[i].prefix;
          }
          if ($.type(columns[i].style) === "function") {
            opt2.styleColumn.push(columns[i].field);
          }
          if ($.type(columns[i].grouping) === "boolean" && columns[i].grouping) {
            columns[i].type = "group";
            columns[i].orientation = "vertical";
            opt2.grouping = true;
            opt2.groupCol = columns[i].columns.length;
            if (opt2.groupCol > opt2.maxGroupCol) {
              opt2.maxGroupCol = opt2.groupCol;
            }
          }
          if ($.type(columns[i].multiColumnHeight) !== "undefined") {
            if ($.type(columns[i].multiColumnHeight) === "number") {
              columns[i].multiColumnHeight = {
                header: columns[i].multiColumnHeight,
                row: columns[i].multiColumnHeight
              };
            }
          } else {
            columns[i].multiColumnHeight = {};
          }
          if ($.type(columns[i].multiColumnHeight.header) === "number") {
            columns[i].header.fillHeight = columns[i].multiColumnHeight.header;
            columns[i].header.minHeight = columns[i].multiColumnHeight.header;
            columns[i].header.fixedHeight = columns[i].multiColumnHeight.header;
          } else if ($.type(columns[i].multiColumnHeight.header) === "undefined") {
            columns[i].header.fillHeight = opt2.header.minHeight;
            columns[i].header.minHeight = opt2.header.minHeight;
            columns[i].header.fixedHeight = opt2.header.minHeight;
          }
          if ($.type(columns[i].multiColumnHeight.row) === "number") {
            columns[i].height = columns[i].multiColumnHeight.row;
            columns[i].fillHeight = columns[i].multiColumnHeight.row;
            columns[i].minHeight = columns[i].multiColumnHeight.row;
            columns[i].fixedHeight = columns[i].multiColumnHeight.row;
          } else if ($.type(columns[i].multiColumnHeight.row) === "undefined") {
            columns[i].fillHeight = opt2.display.rowHeight;
            columns[i].minHeight = opt2.display.rowHeight;
            columns[i].fixedHeight = opt2.display.rowHeight;
          }
          if (columns[i].columns) {
            columns[i].type = "group";
            if (!columns[i].hideChildHeaders) {
              opt2.depth += 1;
            }
            if ($.type(columns[i].name) === "undefined") {
              if (columns[0].field === "__UUID") {
                columns[i].name = "_he@der_name_" + d + (i - 1);
              } else {
                columns[i].name = "_he@der_name_" + d + i;
              }
            }
            if ($.type(columns[i].visible) === "boolean") {
              columns[i].header.visible = columns[i].visible;
              delete columns[i].visible;
            }
            treeGrid.multiHeaderFlag = true;
            treeCustomizingColumn(columns[i].columns, opt2, treeGrid);
          } else {
            if (opt2.depth > opt2.maxDepth) {
              opt2.maxDepth = opt2.depth;
            }
            opt2.depth = 1;
          }
        }
      });
      opt2.columns = columns;
      opt2.dataSource.options = dataSource;
      treeGrid.dataSource = opt2.dataSource;
    }
    return opt2;
  }
  function findUserOptionsColumn4(columns, fieldName, userColumn) {
    if (!columns)
    return null;
    for (var index = 0; index < columns.length; index++) {
      if (userColumn === void 0) {
        if (columns[index].field === fieldName) {
          userColumn = columns[index];
        } else if (columns[index].columns) {
          userColumn = findUserOptionsColumn4(columns[index].columns, fieldName, userColumn);
        }
      }
    }
    return userColumn;
  }
  function _displayFooterText2() {
    return function () {
      var grid2 = $(this._index._column.grid()._container._containerDiv).closest(".dews-data-control").data("dews-control");
      if (grid2 === void 0 || grid2 === null) {
        return null;
      }
      var cols = grid2.columns;
      var col = grid2.columns[this._index._column._fieldName];
      var params = {
        grid: grid2,
        column: cols
      };
      if (col.footer && col.footer.currency && $.type(col.footer.currency) === "function") {
        col.footer.preCurrency = col.footer.currency.call(grid2, params);
        var env = dews.ui.page && dews.ui.page.env && dews.ui.page.env[col.footer.preFormat];
        var predefinedFormat = dews.getCurrencyFormat(col.footer);
        var formats = "#,###.##";
        var round = "round";
        if (env) {
          formats = env.format;
          round = dews.mathType[env.round];
        }
        if ($.type(predefinedFormat) === "object") {
          formats = predefinedFormat.format;
          round = $.type(predefinedFormat.round) === "string" ? predefinedFormat.round : round;
        } else if ($.type(predefinedFormat) === "string") {
          formats = predefinedFormat;
        }
        if (round !== "round") {
          if (formats.split(".").length === 2) {
            if (round === "ceil") {
              formats += ";;;c";
            } else {
              formats += ";;;f";
            }
          }
        }
        var column = grid2._grid.columnByField(this._index._column._fieldName);
        var numberFormat = grid2._grid.getColumnProperty(column, "footer").styles.numberFormat;
        if (numberFormat !== formats) {
          grid2._grid.setColumnProperty(column, "footer", {
            styles: {
              numberFormat: formats
            }
          });
        }
      }
      if (col.footer && col.footer.length > 1) {
        var fieldName = this._index._column._fieldName;
        var columnIndex = grid2.options.columns.findIndex(function (column2) {
          return column2.field === fieldName;
        });
        for (var footerIdx = 0; footerIdx < col.footer.length; footerIdx++) {
          if (col.footer[footerIdx].predefined && col.footer[footerIdx].format && col.footer[footerIdx].currency && $.type(col.footer[footerIdx].currency) === "function") {
            var params = {
              grid: grid2,
              column: cols
            };
            col.footer[footerIdx].preCurrency = col.footer[footerIdx].currency.call(grid2, params);
            var env = dews.ui.page && dews.ui.page.env && dews.ui.page.env[col.footer[footerIdx].preFormat];
            var predefinedFormat = dews.getCurrencyFormat(col.footer[footerIdx]);
            var formats = "#,###.##";
            var round = "round";
            if (env) {
              formats = env.format;
              round = dews.mathType[env.round];
            }
            if ($.type(predefinedFormat) === "object") {
              formats = predefinedFormat.format;
              round = $.type(predefinedFormat.round) === "string" ? predefinedFormat.round : round;
            } else if ($.type(predefinedFormat) === "string") {
              formats = predefinedFormat;
            }
            if (round !== "round") {
              if (formats.split(".").length === 2) {
                if (round === "ceil") {
                  formats += ";;;c";
                } else {
                  formats += ";;;f";
                }
              }
            }
            grid2.options.columns[columnIndex].footer.styles[footerIdx].numberFormat = formats;
          }
        }
        grid2._grid.setColumnProperty(grid2._grid.columnByField(this._index._column._fieldName), "footer", {
          styles: grid2.options.columns[columnIndex].footer.styles
        });
      }
      return this._value;
    };
  }

  // src/js/grid/dialog/GridDebugDialog.js
  var GridDebugDialog = /*#__PURE__*/function () {"use strict";




















    function GridDebugDialog(grid2) {_classCallCheck(this, GridDebugDialog);_defineProperty(this, "html", "\n            <div class=\"dews-dialog-contents-area\">\n                <div class=\"dews-ui-form-panel\" style=\"border-width: 0px\">\n                    <ul>\n                        <li>\n                            <label>GridID</label>\n                            <input type=\"text\" id=\"gridID\" class=\"dews-ui-textbox\" readonly=\"readonly\">\n                        </li>\n                        <li>\n                            <label>RowState</label>\n                            <input type=\"text\" id=\"gridRowState\" class=\"dews-ui-textbox\" readonly=\"readonly\">\n                        </li>\n                    </ul>\n                </div>\n                <div class=\"dews-ui-container-panel\" data-dews-fit-bottom=\"true\">\n                    <div class=\"dews-container-item\">\n                        <div id=\"grid\" class=\"dews-ui-grid\">\n                    </div>\n                </div>\n            </div> ");
      this.grid = grid2;
    }_createClass(GridDebugDialog, [{ key: "open", value:
      function open() {
        var self = this;
        var grid2 = this.grid;
        var dialog = dews.ui.dialog("dewsGridDebugDialog", {
          content: this.html,
          buttons: "close",
          title: "Grid Debug Dialog",
          size: "large",
          open: openHandler
        });
        dialog.setInitData(grid2);
        dialog.open();
        function openHandler() {
          dews.ready(function () {
            var self2 = this;
            var grid3 = dialog.getInitData();
            var fields = grid3.dataSource.options.field;
            var columns = grid3.columns;
            var type = grid3.gridType;
            var dataIdx = type === "GRID" ? grid3.getDataIndexFromItemIndex(grid3.select()) : grid3.select();
            var gridDataItem = grid3.dataSource.at(dataIdx);
            var data = [];
            if (fields) {
              fields.forEach(function (field) {
                var fieldName = field.field;
                if (!(fieldName.toUpperCase().indexOf("UID") !== -1)) {
                  var col = columns[fieldName];
                  var item = {
                    field: fieldName || "",
                    dataType: field.dataType === "text" ? "string" : field.dataType || "",
                    title: col ? col.title || "" : "",
                    value: gridDataItem[fieldName] || "",
                    isVisible: col ? typeof col.visible === "boolean" ? col.visible : true : false
                  };
                  data.push(item);
                }
              });
            }
            self2.gridID.text(grid3.$element.parent().attr("id"));
            self2.gridRowState.text(grid3.getRowState(grid3.select()));
            var dataSource = dews.ui.dataSource("gridDataSource", {
              grid: true,
              data: data,
              schema: {
                model: {
                  id: "field",
                  fields: [
                  { field: "title" },
                  { field: "field" },
                  { field: "value" },
                  { field: "dataType" },
                  { field: "isVisible", type: "boolean" }]

                }
              }
            });
            var debugGrid = dews.ui.grid(self2.$grid, {
              dataSource: dataSource,
              autoBind: true,
              checkable: false,
              columns: [
              {
                field: "title",
                title: "Title",
                align: "left",
                width: 150
              },
              {
                field: "field",
                title: "Field",
                align: "left",
                width: 200
              },
              {
                field: "value",
                title: "Value",
                align: "left",
                width: 150
              },
              {
                field: "dataType",
                title: "DataType",
                align: "left",
                width: 100
              }],

              dataBound: function dataBound(e) {
                var grid4 = e.grid;
                var index = [];
                var style = {
                  background: grid4.options.gridStyle.emphasizeColor1
                };
                var length = e.grid.dataItems().length;
                for (var i = 0; i < length; i += 1) {
                  if (!grid4.dataItem(i).isVisible) {
                    index.push(i);
                  }
                }
                grid4.setRowStyle(index, style);
              }
            });
          });
        }
      } }]);return GridDebugDialog;}();


  // src/js/grid/event/Event.js
  var Event = /*#__PURE__*/function () {"use strict";
    function Event(grid2) {_classCallCheck(this, Event);
      this.grid = grid2;
    }_createClass(Event, [{ key: "initialize", value:
      function initialize() {
        var self = this.grid;
        this._setCallBacks();
        self.$element.on("keyDown", this._keyDownHandler.bind(this));
      } }, { key: "_setCallBacks", value:
      function _setCallBacks() {
        var self = this.grid;
        self._grid.onSorting = function (grid2, fields) {
          var fieldName;
          if (fields.length > 0) {
            var selectFieldIndex = fields.length === 1 ? fields : fields.at(-1);
            fieldName = grid2._dataSource.getFieldName(selectFieldIndex);
          }
          self.onSortingData = _objectSpread(_objectSpread({},
          grid2.getCurrent()),
          fieldName && { fieldName: fieldName });

        };
        self._grid.onSortingChanged = function (grid2) {
          if (self.onSortingData) {
            var name = self.onSortingData.fieldName;
            grid2.setCurrent(_objectSpread({
              dataRow: self.onSortingData.dataRow },
            name && { fieldName: self.onSortingData.fieldName }));

            delete self.onSortingData;
          }
        };
      } }, { key: "_keyDownHandler", value:
      function _keyDownHandler(e) {
        var self = this.grid;
        if (self.options.context) {
          if (e.ctrl && e.shift && e.keyCode === 70) {
            openQuickFilter();
            return;
          }
        }
        if (self.options.context) {
          if (e.ctrl && e.keyCode === 70) {
            searchGrid();
          }
        }
        if (self.select() > -1) {
          if (e.alt && e.shift && e.keyCode === 68) {
            openDebugDialog();
          }
        }
        function openQuickFilter() {
          var quickFilter;
          self.options.contextMenu.some(function (item) {
            if (item.id === "quick_filter") {
              quickFilter = item;
              return true;
            }
          });
          if (quickFilter) {
            var enable = quickFilter.display.bind()();
            if (enable) {
              quickFilter.handler.bind()();
            }
          }
          e.stopPropagation();
          e.preventDefault();
        }
        function searchGrid() {
          var searchContextMenu, menuIndex;
          self.options.contextMenu.some(function (item, idx) {
            if (item.id === "search_text") {
              menuIndex = idx;
              return true;
            }
          });
          if (menuIndex !== void 0) {
            searchContextMenu = self.options.contextMenu[menuIndex];
            searchContextMenu.display.call(self);
            searchContextMenu.handler.call(self, { grid: self });
          }
          e.stopPropagation();
          e.preventDefault();
        }
        function openDebugDialog() {
          var gridDebugView = new GridDebugDialog(self);
          gridDebugView.open();
          e.preventDefault();
          e.stopPropagation();
        }
      } }]);return Event;}();


  // src/js/grid/dialog/ColumnDialog.js
  function ColumnDialog(grid2) {
    this.grid = grid2;
    this._init();
    this._bindEvent();
  }
  ColumnDialog.prototype._init = function () {
    var grid2 = this.grid;
    var dlgID;
    grid2._onegrid.saveColumns = grid2._onegrid.loadColumns.slice(0);
    dlgID = grid2.$element[0].id + "column_dialog";
    this.content = createElement(this);
    this.options = getOptions2(this);
    this.columnDialog = dews.ui.dialog(dlgID, this.options.dialogOptions);
  };
  ColumnDialog.prototype._bindEvent = function () {
    var dlgSelf = this;
    if (dlgSelf.grid._onegrid.editType !== "C") {
      dlgSelf.content.find(".dews-grid-column-item").on("mouseover", function (e) {
        if ($(this).find(".hover").length === 0) {
          $(this).addClass("hover");
        }
        e.stopPropagation();
      }).on("mouseout", function (e) {
        $(this).removeClass("hover");
        e.stopPropagation();
      });
      dlgSelf.content.find(".item-list.left").on("mousedown", function (e) {
        var $targetElement = $(this).closest(".dews-grid-column-item");
        var $dragElement = $targetElement.clone(),$parentUlElement = $targetElement.parent();
        var dragElementWidth, dragElementOffset;
        $targetElement.find("> .item-list-wrapper").css("visibility", "hidden");
        if ($targetElement.find("> .dews-grid-columns-list.sub").length > 0) {
          $targetElement.find("> .dews-grid-columns-list.sub").css("visibility", "hidden");
        }
        $targetElement.addClass("transparency");
        $dragElement.css("display", "none");
        $targetElement.parent().append($dragElement);
        $dragElement.addClass("dragging");
        dragElementWidth = $targetElement.css("width");
        $dragElement.css("position", "absolute");
        $dragElement.css("display", "block");
        $dragElement.css("width", dragElementWidth);
        $dragElement.css("z-index", 110);
        var targetElementOffset = $targetElement.offset();
        $dragElement.offset(targetElementOffset);
        dragElementOffset = targetElementOffset;
        $dragElement.startX = e.clientX - dragElementOffset.left;
        $dragElement.startY = e.clientY - dragElementOffset.top;
        if ($targetElement.parent().hasClass("sub") && $targetElement.parent().closest(".dews-grid-column-item").hasClass("hover")) {
          $targetElement.parent().closest(".dews-grid-column-item").removeClass("hover");
        }
        $targetElement.siblings(".dews-grid-column-item").not(".dragging").addClass("draggable");
        $targetElement.addClass("current");
        var $dropLine = $('<div class="drop-line"><span class="ico-drag-round"></span></div>');
        $dropLine.css("visibility", "hidden");
        $parentUlElement.append($dropLine);
        $dropLine.css("width", dragElementWidth);
        $(document.body).on("mousemove", $dragElement, dragMousemove).on("mouseup", $dragElement, dragMouseup);
        e.stopPropagation();
        e.preventDefault();
      });
    }
    var $buttonGroup = dlgSelf.content.eq(1);
    $buttonGroup.find("> .save-btn").on("click", function () {
      var liList = dlgSelf.columnDialog.$content.find("ul").not(".sub").find("> li");
      if (fixedVerification(liList)) {
        dews.confirm(dews.localize.get("\uC800\uC7A5\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?", "dews_\uC800\uC7A5\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")).yes(function () {
          var saveColumns = dlgSelf.grid._onegrid.saveColumns,saveObj;
          saveColumns = setSaveColumns(saveColumns, liList);
          dlgSelf.grid._onegrid.saveColumns = saveColumns;
          saveObj = setSaveData(dlgSelf.grid, saveColumns);
          saveObj.useColumns = setUseData(dlgSelf, saveColumns);
          dlgSelf.grid._onegrid.saveData = saveObj.columns;
          if (!saveObj.fixed) {
            saveObj.fixed = { colCount: 0, rightColCount: 0 };
          }
          dlgSelf.grid._onegrid.fixed = saveObj.fixed;
          dlgSelf.grid._onegrid._event = "save";
          var parameter = {
            moduleID: dews.ui.page.menu.module,
            menuID: dews.ui.page.menu.id,
            type: dlgSelf.grid._onegrid._onegridType,
            id: dlgSelf.grid._onegrid._gridID,
            content: saveObj
          };
          dews.ui.page._onegridSave(parameter);
          dlgSelf.columnDialog.ok(dlgSelf.grid._onegrid);
        }).no(function () {
        });
      } else {
        dews.alert(
        dews.localize.get(
        "\uACE0\uC815 \uC5EC\uBD80\uAC00 \uC815\uC0C1\uC801\uC73C\uB85C \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.",
        "dews_\uACE0\uC815 \uC5EC\uBD80\uAC00 \uC815\uC0C1\uC801\uC73C\uB85C \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4."),

        "warning").
        done(function () {
        });
      }
    });
    $buttonGroup.find("> .reset-btn").on("click", function () {
      dews.confirm(dews.localize.get("\uCD08\uAE30\uD654\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?", "dews_\uCD08\uAE30\uD654\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")).yes(function () {
        var onegridType = dlgSelf.grid._onegrid._onegridType;
        dlgSelf.grid._onegrid.saveData = null;
        dlgSelf.grid._onegrid.fixed = { colCount: 0, rightColCount: 0 };
        var parameter = {
          moduleID: dews.ui.page.menu.module,
          menuID: dews.ui.page.menu.id,
          type: onegridType,
          id: dlgSelf.grid._onegrid._gridID
        };
        dews.ui.page._onegridReset(parameter).done(function (oneGridData) {
          dlgSelf.grid._onegrid.loadData = null;
          if (oneGridData.items && oneGridData.items.length > 0) {
            var oneGridItems = oneGridData.items;
            var gridItem = oneGridItems.filter(function (oneGridItems2) {
              return oneGridItems2.type === onegridType && oneGridItems2.id === dlgSelf.grid._onegrid._gridID;
            });
            if (gridItem.length > 0 && gridItem[0].content) {
              dlgSelf.grid._onegrid.saveData = gridItem[0].content.columns;
              if (oneGridData.authority === 3) {
                dlgSelf.grid._onegrid.loadData = gridItem[0].content.useColumns;
              } else {
                dlgSelf.grid._onegrid.loadData = gridItem[0].content.columns;
              }
              $.extend(true, dlgSelf.grid._onegrid.fixed, gridItem[0].content.fixed);
            }
          } else {
            $.extend(true, dlgSelf.grid._onegrid.fixed, dlgSelf.grid.options.fixed);
          }
          dlgSelf.columnDialog.ok(dlgSelf.grid._onegrid);
        });
      }).no(function () {
      });
    });
    $buttonGroup.find("> .cancel-btn").on("click", function () {
      dlgSelf.columnDialog.cancel();
    });
    function dragMousemove(e) {
      var $dragElement = e.data;
      var $targetElement = $(".transparency");
      var $parentUlElement = $targetElement.closest("ul.dews-grid-columns-list");
      var $wrapper = $(".dews-grid-columns-wrapper");
      var $firstUlElement = $wrapper.find("> .dews-grid-columns-list");
      var parentUlElementOffset = $parentUlElement.offset();
      var wrapperElementOffset = $wrapper.offset();
      var scrollTop, $dropLine;
      $dragElement.css("top", e.clientY - $dragElement.startY - parentUlElementOffset.top + "px");
      $dragElement.css("left", e.clientX - $dragElement.startX - parentUlElementOffset.left + "px");
      scrollTop = $wrapper.scrollTop();
      $dropLine = $parentUlElement.find("> .drop-line");
      if (e.clientY + $dragElement.height() - $dragElement.startY > wrapperElementOffset.top + 490) {
        $dropLine.css("visibility", "hidden");
        if ($firstUlElement.height() + 20 > $wrapper.height() + scrollTop) {
          $wrapper.scrollTop(scrollTop + 7);
        }
      } else if (e.clientY - $dragElement.startY < wrapperElementOffset.top) {
        $dropLine.css("visibility", "hidden");
        if (scrollTop !== 0) {
          $wrapper.scrollTop(scrollTop - 7);
        }
      }
      var currentElement,currentElementLength,$currentElement = $parentUlElement.find("> .current");
      var currentElementOffset, currentElementHeight;
      if (navigator.appName === "Netscape" && navigator.userAgent.toLowerCase().indexOf("trident") !== -1 || navigator.userAgent.toLowerCase().indexOf("msie") !== -1 || navigator.userAgent.toLowerCase().indexOf("edge") !== -1) {
        var nodeList = document.msElementsFromPoint(e.clientX, e.clientY);
        currentElement = Array.prototype.slice.call(nodeList);
      } else {
        currentElement = document.elementsFromPoint(e.clientX, e.clientY);
      }
      currentElementLength = currentElement.length;
      for (var i = 0; i < currentElementLength; i++) {
        var $el = $(currentElement[i]);
        if ($el.hasClass("draggable")) {
          if (!$el.hasClass("current")) {
            $currentElement.removeClass("current");
            $el.addClass("current");
            $currentElement = $el;
            break;
          }
        }
      }
      currentElementOffset = $currentElement.offset();
      currentElementHeight = $currentElement.height();
      if (e.clientY <= parentUlElementOffset.top + $parentUlElement.height() + 10 && e.clientY >= parentUlElementOffset.top) {
        if ($dragElement.hasClass("noDrop")) {
          $dragElement.removeClass("noDrop");
        }
        if (!$currentElement.hasClass("transparency")) {
          if (currentElementOffset.top + currentElementHeight / 2 >= e.clientY) {
            if (!$currentElement.prev().hasClass("transparency")) {
              $dropLine.offset({
                top: currentElementOffset.top - 5,
                left: currentElementOffset.left
              });
              if ($dropLine.css("visibility") === "hidden") {
                $dropLine.css("visibility", "visible");
              }
            } else {
              if ($dropLine.css("visibility") === "visible") {
                $dropLine.css("visibility", "hidden");
              }
            }
          } else if (currentElementOffset.top + currentElementHeight / 2 < e.clientY) {
            if (!$currentElement.next().hasClass("transparency")) {
              $dropLine.offset({
                top: currentElementOffset.top + currentElementHeight + 5,
                left: currentElementOffset.left
              });
              if ($dropLine.css("visibility") === "hidden") {
                $dropLine.css("visibility", "visible");
              }
            } else {
              if ($dropLine.css("visibility") === "visible") {
                $dropLine.css("visibility", "hidden");
              }
            }
          }
        }
      } else {
        if (!$dragElement.hasClass("noDrop")) {
          $dragElement.addClass("noDrop");
        }
        if ($dropLine.css("visibility") === "visible") {
          $dropLine.css("visibility", "hidden");
        }
      }
      e.stopPropagation();
      e.preventDefault();
    }
    function dragMouseup(e) {
      var $targetElement = $(this).find(".dews-grid-column-item.transparency");
      var $parentUlElement = $targetElement.parent(),parentUlElementOffset = $parentUlElement.offset(),$currentElement = $parentUlElement.find(".current");
      var $dropLine = $(this).find(".drop-line");
      var currentElementOffset, currentElementHeight, $prevElement, $nextElement;
      if (!$currentElement.hasClass("transparency") && $currentElement.length > 0) {
        $prevElement = $currentElement.prev();
        $nextElement = $currentElement.next();
        currentElementOffset = $currentElement.offset();
        currentElementHeight = $currentElement.height();
        if (e.clientY <= parentUlElementOffset.top + $parentUlElement.height() + 10 && e.clientY >= parentUlElementOffset.top) {
          if (currentElementOffset.top + currentElementHeight / 2 >= e.clientY) {
            if (!$prevElement.hasClass("transparency")) {
              $currentElement.before($targetElement);
            }
          } else if (currentElementOffset.top + currentElementHeight / 2 < e.clientY) {
            if (!$nextElement.hasClass("transparency")) {
              $currentElement.after($targetElement);
            }
          }
        }
        var $nextUlElement = $targetElement.find("> .dews-grid-columns-list.sub");
        var $targetElementCheckBox = $targetElement.find("> .item-list-wrapper .column-item-fix .dews-ui-checkbox");
        var $targetElementVisibleBox = $targetElement.find(
        "> .item-list-wrapper .column-item-visible .dews-ui-checkbox");

        if ($dropLine.css("visibility") === "visible") {
          if ($targetElementCheckBox[0].checked) {
            if ($targetElement.prev().length > 0 && !$targetElement.next().hasClass("dragging") && !$targetElement.prev().find("> .item-list-wrapper .column-item-fix .dews-ui-checkbox")[0].checked && !$targetElement.next().find("> .item-list-wrapper .column-item-fix .dews-ui-checkbox")[0].checked) {
              $targetElementCheckBox[0].checked = false;
              $targetElement.data("column-fixed-type", null);
              if ($nextUlElement.length > 0) {
                changeChildrenChecked($nextUlElement, "fix", false);
              }
            }
          } else {
            if ($targetElement.prev().length === 0) {
              if ($targetElement.next().find("> .item-list-wrapper .column-item-fix .dews-ui-checkbox")[0].checked) {
                if ($targetElementVisibleBox[0].checked === true) {
                  $targetElementCheckBox[0].checked = true;
                  $targetElement.data(
                  "column-fixed-type",
                  $targetElement.next().data("column-fixed-type"));

                  if ($nextUlElement.length > 0) {
                    changeChildrenChecked($nextUlElement, "fix", true);
                  }
                }
              }
            } else if ($targetElement.next().hasClass("dragging")) {
              if ($targetElement.prev().find("> .item-list-wrapper .column-item-fix .dews-ui-checkbox")[0].checked) {
                if ($targetElementVisibleBox[0].checked === true) {
                  $targetElementCheckBox[0].checked = true;
                  $targetElement.data(
                  "column-fixed-type",
                  $targetElement.prev().data("column-fixed-type"));

                  if ($nextUlElement.length > 0) {
                    changeChildrenChecked($nextUlElement, "fix", true);
                  }
                }
              }
            } else {
              if ($targetElement.prev().find("> .item-list-wrapper .column-item-fix .dews-ui-checkbox")[0].checked && $targetElement.next().find("> .item-list-wrapper .column-item-fix .dews-ui-checkbox")[0].checked) {
                if ($targetElementVisibleBox[0].checked === true) {
                  $targetElementCheckBox[0].checked = true;
                  $targetElement.data(
                  "column-fixed-type",
                  $targetElement.next().data("column-fixed-type"));

                  if ($nextUlElement.length > 0) {
                    changeChildrenChecked($nextUlElement, "fix", true);
                  }
                }
              }
            }
          }
        }
      }
      $currentElement.removeClass("current");
      e.data.removeClass("dragging");
      e.data.remove();
      $targetElement.removeClass("transparency");
      $targetElement.find("> .item-list-wrapper").css("visibility", "");
      if ($targetElement.find("> .dews-grid-columns-list.sub").length > 0) {
        $targetElement.find("> .dews-grid-columns-list.sub").css("visibility", "visible");
      }
      $targetElement.siblings(".dews-grid-column-item").removeClass("draggable");
      $dropLine.remove();
      $(this).off("mousemove", dragMousemove).off("mouseup", dragMouseup);
      e.stopPropagation();
    }
  };
  function getOptions2(columnDialog) {
    var opt2 = {};
    opt2.dialogOptions = {
      title: dews.localize.get("\uCEEC\uB7FC \uC5D0\uB514\uD130", "dews_\uCEEC\uB7FC \uC5D0\uB514\uD130"),
      size: "large",
      height: 570,
      width: 800,
      content: columnDialog.content
    };
    opt2.dialogOptions.open = columnDialogOpen;
    opt2.dialogOptions.ok = function (e) {
      var baseColumns = Array.prototype.slice.call(columnDialog.grid._onegrid.baseColumns);
      var setInitColumns;
      if (e.saveData) {
        setInitColumns = dews.ui.gridUtil.setInitColumns(baseColumns, e.saveData);
      } else {
        setInitColumns = columnDialog.grid._onegrid.baseColumns;
      }
      columnDialog.grid.setColumns(setInitColumns);
      if (e.saveData) {
        columnDialog.grid._onegrid.loadData = e.saveData;
        columnDialog.grid._onegrid.loadColumns = dews.ui.gridUtil.setDisplayIndexColumns(
        columnDialog.grid,
        baseColumns,
        e.saveData);

      }
      columnDialog.grid._grid.setFixedOptions(columnDialog.grid._onegrid.fixed);
      if (columnDialog.grid.options.autoBind) {
        columnDialog.grid.dataSource.read();
      }
    };
    return opt2;
  }
  function createElement(columnDialog) {
    var grid2 = columnDialog.grid;
    var $content, $wrapper, $buttonGroup, $resetBtn, $saveBtn, $cancelBtn;
    $buttonGroup = $('<div class="dews-dialog-button-group bottom"></div>');
    $resetBtn = $(
    '<button id="reset-btn" class="dews-ui-button reset-btn">' + dews.localize.get("\uCD08\uAE30\uD654", "dews_\uCD08\uAE30\uD654") + "</button>");

    $saveBtn = $(
    '<button id="save-btn" class="dews-ui-button save-btn">' + dews.localize.get("\uC800\uC7A5", "dews_\uC800\uC7A5") + "</button>");

    $cancelBtn = $(
    '<button id="cancel-btn" class="dews-ui-button cancel-btn">' + dews.localize.get("\uCDE8\uC18C", "dews_\uCDE8\uC18C") + "</button>");

    $buttonGroup.append($resetBtn).append($saveBtn).append($cancelBtn);
    $content = $('<div class="dews-dialog-contents-area"></div>');
    $wrapper = $('<div class="dews-grid-columns-wrapper"></div>');
    $wrapper.append(createListHtml(grid2, grid2._onegrid.loadColumns, false));
    $content.append($wrapper);
    $content = $content.add($buttonGroup);
    return $content;
  }
  function createListHtml(grid2, columns, sub) {
    var $ulTag, $liTag;
    $ulTag = $('<ul class="dews-grid-columns-list"></ul>');
    if (sub) {
      $ulTag.addClass("sub");
    }
    for (var i = 0; i < columns.length; i++) {
      if (columns[i].name === "__UUID") {
        continue;
      }
      $liTag = createLiHtml(grid2, columns[i]);
      $liTag.attr("data-column-field", columns[i].name);
      if (columns[i].columns) {
        var $createListTag = createListHtml(grid2, columns[i].columns, true);
        $liTag.append($createListTag);
        if ($createListTag.find(".required").length > 0) {
          $liTag.find("> .item-list-wrapper .column-item-visible .dews-ui-checkbox").attr("disabled", "disabled");
        }
      } else {
        $liTag.find("> .item-list-wrapper").addClass("only");
      }
      if (sub) {
        var $inputFixed = $liTag.find(".column-item-fix > .dews-ui-checkbox");
        $inputFixed.prop("disabled", true);
      } else {
        if (columns[i]._fixed) {
          if (columns[i]._fixed.type === "fixed") {
            $liTag.find(".column-item-fix > .dews-ui-checkbox").attr("checked", true);
            $liTag.data("column-fixed-type", "fixed");
          }
        }
      }
      $ulTag.append($liTag);
    }
    return $ulTag;
  }
  function createLiHtml(grid2, column) {
    var $liTag, $itemListWrapper, $itemListRight, $itemListLeft, $icoRowmove, $columnItemTitle, $columnItemWidth, $columnItemVisible, $columnItemFix, $labelTitle, $labelWidth, $labelVisible, $labelFixed, $labelPx, $inputWidth, $inputVisible, $inputFixed;
    $liTag = $('<li class="dews-grid-column-item"></li>');
    $itemListWrapper = $('<span class="item-list-wrapper"></span>');
    $itemListRight = $('<span class="item-list right"></span>');
    $itemListLeft = $('<span class="item-list left"></span>');
    $icoRowmove = $('<span class="ico-rowmove"></span>');
    $columnItemTitle = $('<span class="column-item-list column-item-title"></span>');
    $labelTitle = $('<label class="column-item-label title">' + column.header.text + "</label>");
    $columnItemWidth = $('<span class="column-item-list column-item-width"></span>');
    $labelWidth = $('<label class="column-item-label width">' + dews.localize.get("\uB108\uBE44", "dews_\uB108\uBE44") + "</label>");
    $inputWidth = $(
    '<input type="text" class="dews-ui-numerictextbox" value="' + column.width + '" style="width: 40px">');

    $labelPx = $('<label class="column-item-label px">px</label>');
    $columnItemVisible = $('<span class="column-item-list column-item-visible"></span>');
    $labelVisible = $(
    '<label class="column-item-label visible">' + dews.localize.get("\uCD9C\uB825\uC5EC\uBD80", "dews_\uCD9C\uB825\uC5EC\uBD80") + "</label>");

    $inputVisible = $('<input type="checkbox" class="dews-ui-checkbox small-toggle">');
    $columnItemFix = $('<span class="column-item-list column-item-fix"></span>');
    $labelFixed = $(
    '<label class="column-item-label fixed">' + dews.localize.get("\uACE0\uC815\uC5EC\uBD80", "dews_\uACE0\uC815\uC5EC\uBD80") + "</label>");

    $inputFixed = $('<input type="checkbox" class="dews-ui-checkbox small-toggle">');
    if (grid2.columns[column.name] && grid2.columns[column.name].attributes && grid2.columns[column.name].attributes["class"] === "required") {
      $inputVisible.attr("disabled", "disabled");
      $liTag.addClass("required");
    }
    if (column.visible !== false) {
      $inputVisible.attr("checked", true);
    } else {
      $inputFixed.attr("disabled", "disabled");
      $liTag.data("column-fixed-type", "disabled");
    }
    if (grid2._onegrid.editType === "C") {
      $inputVisible.attr("disabled", "disabled");
      $inputFixed.attr("disabled", "disabled");
    }
    $liTag.append(
    $itemListWrapper.append(
    $itemListRight.append($columnItemWidth.append($labelWidth).append($inputWidth).append($labelPx)).append($columnItemVisible.append($labelVisible).append($inputVisible)).append($columnItemFix.append($labelFixed).append($inputFixed))).
    append($itemListLeft.append($icoRowmove).append($columnItemTitle.append($labelTitle))));

    return $liTag;
  }
  function columnDialogOpen() {
    dews.ready(function () {
      var dlgSelf = this;
      var updateColumnData = {};
      dlgSelf.$content.find(".column-item-width .dews-ui-numerictextbox").on("change", function (e) {
        var target = e.target;
        var columnField = $(target).closest(".dews-grid-column-item").data("column-field");
        updateColumnData[columnField] = updateColumnData[columnField] ? updateColumnData[columnField] : {};
        updateColumnData[columnField].width = $(e.target).val();
      });
      dlgSelf.$content.find(".column-item-visible .dews-ui-checkbox").on("change", function (e) {
        var target = e.target;
        var $targetLiElement = $(target).closest(".dews-grid-column-item");
        var $targetItemElement = $(target).closest(".item-list-wrapper");
        var $nextUlElement = $targetItemElement.next("ul");
        var columnField = $targetLiElement.data("column-field");
        var $targetElementFixedCheckBox = $targetItemElement.find(".column-item-fix .dews-ui-checkbox");
        updateColumnData[columnField] = updateColumnData[columnField] ? updateColumnData[columnField] : {};
        updateColumnData[columnField].visible = this.checked;
        if ($nextUlElement.length > 0) {
          changeChildrenChecked($nextUlElement, "visible", target.checked);
        }
        changeParentChecked($targetLiElement, target.checked);
        if ($targetLiElement.parent().not(".sub").length > 0) {
          if (this.checked === false) {
            $targetElementFixedCheckBox.attr("disabled", true);
            $targetElementFixedCheckBox.attr("checked", false);
            $targetLiElement.data("column-fixed-type", "disabled");
          } else {
            $targetElementFixedCheckBox.attr("disabled", false);
            $targetLiElement.data("column-fixed-type", "null");
          }
        }
      });
      dlgSelf.$content.find(".column-item-fix .dews-ui-checkbox").on("change", function (e) {
        var target = e.target;
        var $targetLiElement = $(target).closest(".dews-grid-column-item");
        var $targetItemElement = $(target).closest(".item-list-wrapper");
        var $nextUlElement = $targetItemElement.next("ul");
        var fixedType = $targetLiElement.data("column-fixed-type");
        if (target.checked) {
          $targetLiElement.data("column-fixed-type", "fixed");
        } else {
          $targetLiElement.data("column-fixed-type", null);
        }
        if ($nextUlElement.length > 0) {
          changeChildrenChecked($nextUlElement, "fix", target.checked);
        }
      });
    });
  }
  function changeParentChecked($element, isChecked) {
    var $parentElement = $element.parent();
    var $parentLiElement = $parentElement.closest(".dews-grid-column-item");
    if ($parentElement.hasClass("sub")) {
      if (isChecked && $parentLiElement.find("> .item-list-wrapper .column-item-visible .dews-ui-checkbox")[0].checked !== isChecked) {
        $parentLiElement.find("> .item-list-wrapper .column-item-visible .dews-ui-checkbox")[0].checked = isChecked;
        if ($parentLiElement.parent().hasClass("sub")) {
          changeParentChecked($parentLiElement, isChecked);
        }
      } else {
        var visibleCheckList = $element.siblings("li").find("> .item-list-wrapper .column-item-visible .dews-ui-checkbox");
        for (var i = 0; i < visibleCheckList.length; i++) {
          if (visibleCheckList[i].checked !== isChecked) {
            break;
          }
          if (i === visibleCheckList.length - 1) {
            $parentLiElement.find("> .item-list-wrapper .column-item-visible .dews-ui-checkbox")[0].checked = isChecked;
            if ($parentLiElement.parent().hasClass("sub")) {
              changeParentChecked($parentLiElement, isChecked);
            }
          }
        }
      }
    }
  }
  function changeChildrenChecked($element, type, isChecked) {
    var changeElements = $element.find(".column-item-" + type + " .dews-ui-checkbox");
    for (var i = 0; i < changeElements.length; i++) {
      changeElements[i].checked = isChecked;
    }
  }
  function setUseData(grid2, columns) {
    var useData = [],data,fixed = { colCount: 0, rightColCount: 0 };
    for (var i = 0; i < columns.length; i++) {
      data = {
        field: columns[i].name,
        width: columns[i].width,
        isVisible: columns[i].visible
      };
      if (columns[i].columns) {
        data.columns = setUseData(grid2, columns[i].columns);
      }
      useData.push(data);
    }
    return useData;
  }
  function setSaveData(grid2, columns, sub) {
    var saveData = [],useData = [],data,fixed = { colCount: 0, rightColCount: 0 };
    for (var i = 0; i < columns.length; i++) {
      data = {
        field: columns[i].name,
        width: columns[i].width,
        isVisible: columns[i].visible
      };
      if (columns[i].columns) {
        data.columns = setSaveData(grid2, columns[i].columns, "sub");
      }
      if (sub !== "sub" && columns[i]._fixed) {
        if (columns[i]._fixed.type === "left") {
          fixed.colCount++;
        } else if (columns[i]._fixed.type === "right") {
          fixed.rightColCount++;
        }
      }
      saveData.push(data);
    }
    if (sub === "sub") {
      return saveData;
    } else {
      var saveObj = { columns: saveData };
      if (fixed.colCount > 0 || fixed.rightColCount > 0) {
        saveObj.fixed = fixed;
      }
      return saveObj;
    }
  }
  function setSaveColumns(columns, liElementList) {
    for (var i = 0; i < liElementList.length; i++) {
      var $liElement = liElementList.eq(i);
      var index, column;
      columns.some(function (c, idx) {
        if (c.name === $liElement.data("columnField")) {
          index = idx;
        }
      });
      if (typeof index === "number") {
        column = columns[index];
        if ($liElement.find("> ul.sub").length > 0) {
          setSaveColumns(column.columns, $liElement.find("> ul.sub >li"));
        }
        var $widthElement = $liElement.find("> .item-list-wrapper .column-item-width .dews-ui-numerictextbox");
        var $visibleElement = $liElement.find("> .item-list-wrapper .column-item-visible .dews-ui-checkbox");
        column.width = parseInt($widthElement.val());
        column.displayWidth = column.width;
        column.visible = $visibleElement[0].checked;
        if ($liElement.data("column-fixed-type")) {
          column._fixed = column._fixed ? column._fixed : {};
          column._fixed.type = $liElement.data("column-fixed-align");
        } else {
          if (column._fixed) {
            delete column._fixed;
          }
        }
        var s = columns.splice(index, 1);
        columns.splice(i, 0, s[0]);
      }
    }
    return columns;
  }
  function fixedVerification(liList) {
    var enableFixedLiList = [];
    for (var i = 0; i < liList.length; i++) {
      if (liList.eq(i).data("column-fixed-type") !== "disabled") {
        liList.eq(i).data("column-fixed-align", null);
        enableFixedLiList.push(liList.eq(i));
      }
    }
    var rightFixedFlag = true,leftFixedFlag = true;
    for (var j = enableFixedLiList.length - 1; j > -1; j--) {
      if (enableFixedLiList[j].data("column-fixed-type") === "fixed") {
        if (rightFixedFlag) {
          enableFixedLiList[j].data("column-fixed-align", "right");
        } else {
          if (enableFixedLiList[0].data("column-fixed-type") === "fixed") {
            break;
          } else {
            return false;
          }
        }
      } else {
        rightFixedFlag = false;
      }
    }
    for (var k = 0; k < enableFixedLiList.length; k++) {
      if (enableFixedLiList[k].data("column-fixed-type") === "fixed") {
        if (leftFixedFlag) {
          if (enableFixedLiList[k].data("column-fixed-align") === "right") {
            break;
          } else {
            enableFixedLiList[k].data("column-fixed-align", "left");
          }
        } else {
          if (enableFixedLiList[k].data("column-fixed-align") === "right") {
            break;
          } else {
            return false;
          }
        }
      } else {
        leftFixedFlag = false;
      }
    }
    return true;
  }

  // src/js/grid/event/gridEvent.js
  var GridEvent = /*#__PURE__*/function (_Event3) {"use strict";_inherits(GridEvent, _Event3);var _super10 = _createSuper(GridEvent);
    function GridEvent(grid2) {var _this3;_classCallCheck(this, GridEvent);
      _this3 = _super10.call(this, grid2);
      _this3.grid = grid2;return _this3;
    }_createClass(GridEvent, [{ key: "initialize", value:
      function initialize() {
        _get(_getPrototypeOf(GridEvent.prototype), "initialize", this).call(this);
        this._bindEvent();
      } }, { key: "_bindEvent", value:
      function _bindEvent() {
        var self = this.grid;
        var observer = new MutationObserver(function (mutations) {
          mutations.forEach(function (mutation) {
            if (mutation.attributeName === "style") {
              if (/display:\s?none/i.test(mutation.oldValue)) {
                if ($(mutation.target).is(":visible")) {
                  self._grid.resetSize();
                }
              }
            } else if (mutation.attributeName === "class") {
              if ($(mutation.target).is(":visible")) {
                self._grid.resetSize();
              }
            }
          });
        });
        self.$element.parentsUntil("body").each(function (idx, item) {
          observer.observe(item, {
            attributes: true,
            attributeOldValue: true,
            attributeFilter: ["style", "class"]
          });
        });
        if (dews.app && dews.app.menuSectionResized) {
          dews.app.menuSectionResized.on(function () {
            self._grid.resetSize();
          });
        }
        self._grid.onColumnHeaderClicked = function (grid2, column, rightClicked) {
          var parameter = {
            grid: self,
            cell: {
              field: column.fieldName
            }
          };
          var headerClicked = new $.Event("headerClicked", parameter);
          self.$element.trigger(headerClicked);
        };
        self._grid.onImageButtonClicked = function (grid2, itemIndex, column, buttonIndex, name) {
          var parameter = {
            grid: self,
            row: {
              index: itemIndex,
              data: self.dataItem(itemIndex)
            },
            cell: {
              field: column.fieldName,
              data: self.getCellValue(itemIndex, column.fieldName)
            }
          };
          dews.ui.gridUtil.onImageButtonClicked(self, itemIndex, column, parameter);
        };
        self.options._gridCallback = function (data, column, index) {
          dews.ui.gridUtil._gridCallback(self, data, column, index);
        };
        self._grid.onLinkableCellClicked = function (grid2, index, url) {
          var linkUrl = self.dataItem(index.itemIndex)[self.columns[index.column].formats.urlField],parameter = {
              grid: self,
              row: {
                index: index.itemIndex,
                data: self.dataItem(index.itemIndex)
              },
              cell: {
                field: index.column,
                data: self.getCellValue(index.itemIndex, index.column)
              }
            };
          dews.ui.gridUtil.onLinkableCellClicked(self, index, linkUrl, parameter);
        };
        self._grid.onShowEditor = function (id, index) {
          var parameter = {
            grid: self,
            row: {
              index: index.dataRow === -1 ? index.itemIndex : index.dataRow
            },
            cell: {
              field: index.fieldName
            }
          };
          window.addEventListener("scroll", windowScroll);
          return dews.ui.gridUtil.onShowEditor(self, id, index, parameter);
        };
        self._grid.onHideEditor = function (grid2, index) {
          if (self.options.commit) {
            dews.ui.gridUtil.onHideEditor(self, grid2, index);
            window.removeEventListener("scroll", windowScroll);
          }
          setTimeout(function () {var _self$columns$fieldNa7, _self$columns$fieldNa8, _self$columns$fieldNa9;
            var fieldName = index.fieldName;
            if (((_self$columns$fieldNa7 = self.columns[fieldName]) === null || _self$columns$fieldNa7 === void 0 ? void 0 : (_self$columns$fieldNa8 = _self$columns$fieldNa7.editor) === null || _self$columns$fieldNa8 === void 0 ? void 0 : (_self$columns$fieldNa9 = _self$columns$fieldNa8.type) === null || _self$columns$fieldNa9 === void 0 ? void 0 : _self$columns$fieldNa9.toLowerCase()) === "codepicker") {
              $(window).trigger("enableMainArea");
            }
          }, 300);
          self.options.commit = false;
        };
        self._grid.onColumnCheckedChanged = function (grid2, column, check) {
          var params = {
              grid: self,
              cell: {
                field: column.fieldName
              },
              checked: check
            },i = 0;
          if (column.editorOptions && column.editorOptions.type.toLowerCase() === "check") {
            var dataItems = self.sortDataItems(),rowCount = dataItems.length,userColumn = findUserOptionsColumn5(self.userOptions.columns, column.fieldName),checkValue = check;
            if (check && column.editorOptions && column.editorOptions.trueValue) {
              checkValue = column.editorOptions.trueValue;
            } else if (!check && column.editorOptions && column.editorOptions.falseValue) {
              checkValue = column.editorOptions.falseValue;
            }
            self.options.dataSource.dataProvider.beginUpdate();
            try {
              for (i = 0; i < rowCount; i++) {
                var editParams = {
                  grid: self,
                  row: {
                    index: i,
                    data: dataItems[i]
                  },
                  cell: {
                    field: column.fieldName
                  }
                };
                var cellEditable = true;
                if (self.options.rowEditable !== void 0) {
                  cellEditable = self.options.rowEditable.call(self, editParams);
                }
                if (userColumn !== void 0 && userColumn !== null) {
                  if (cellEditable && userColumn.editable === false) {
                    cellEditable = false;
                  }
                  if (cellEditable && userColumn.editor !== void 0 && typeof userColumn.editor.editable === "function") {
                    cellEditable = userColumn.editor.editable.call(self, editParams);
                  }
                  if (cellEditable && userColumn.editor !== void 0 && typeof userColumn.editor.editable === "boolean" && userColumn.editor.editable === false) {
                    cellEditable = false;
                  }
                }
                if (cellEditable) {
                  self._grid.setValue(i, column.fieldName, checkValue);
                }
              }
            } finally {
              self.options.dataSource.dataProvider.endUpdate();
            }
          }
          var event = $.Event("columnHeaderCheck", params);
          self.$element.trigger(event);
        };
        self._grid.onCellEdited = function (grid2, itemIndex, dataRow, field) {
          var fields = self.options.dataSource.dataProvider.getFieldName(field);
          var column = dews.ui.gridUtil.findColumn(self.options.columns, fields);
          if (column && column.editor && column.editor.type.toLowerCase() === "time") {
            if (grid2.getEditingItem() && grid2.getEditingItem().values[column.fieldName]) {
              if (!column.displayRegExp.test(grid2.getEditingItem().values[column.fieldName])) {
                self.setCellValue(dataRow, column.fieldName, "");
              }
            }
          }
          var useCodesearch = self._useCodesearch;
          self.options.commit = true;
          grid2.commit(true);
          self.editable = false;
          if (column && column.editor && column.editor.type.toLowerCase() === "dropdown" && $.type(column.editor.dataSource) === "function") {
            var col = self._grid.columnByField(column.fieldName),e = {
                grid: self,
                row: {
                  data: self.dataItem(dataRow),
                  index: dataRow
                }
              },datasource = column.editor.dataSource.call(self, e);
            col.values = [];
            col.labels = [];
            if (typeof col.editor === "string" && col.editor === "dropDown") {
              col.editor = {
                type: "dropDown",
                values: [],
                labels: []
              };
            }
            if (datasource && datasource.transport && datasource.transport.data && datasource.transport.data.length > 0) {
              var index = {
                  itemIndex: itemIndex,
                  dataRow: dataRow,
                  fieldIndex: field,
                  column: column.field,
                  fieldName: column.field
                },editResult = {
                  text: "",
                  value: self.getCellValue(dataRow, column.field)
                };
              for (var l = 0; l < datasource.transport.data.length; l += 1) {
                col.values.push(datasource.transport.data[l][column.editor.dataValueField]);
                col.labels.push(datasource.transport.data[l][column.editor.dataTextField]);
                if (column.editor.dataSelectable && datasource.transport.data[l][column.editor.dataSelectable.field] !== column.editor.dataSelectable.falseValue) {
                  col.editor.values.push(datasource.transport.data[l][column.editor.dataValueField]);
                  col.editor.labels.push(datasource.transport.data[l][column.editor.dataTextField]);
                }
                if (datasource.transport.data[l][column.editor.dataValueField] === editResult.value) {
                  editResult.text = datasource.transport.data[l][column.editor.dataTextField];
                }
              }
              if ($.type(column.editor.textField) === "undefined") {
                col.labelField = column.editor.dataTextField;
              } else {
                col.labelField = column.editor.textField;
              }
              col.lookupDisplay = true;
              self._grid.setColumn(col);
              self._grid.onGetEditValue.call(self, self._grid, index, editResult);
            }
          }
          var event,parameter,subSave = true;
          if ($.type(arguments[4]) === "boolean") {
            subSave = arguments[4];
          }
          parameter = {
            grid: self,
            row: {
              index: itemIndex,
              data: self.dataItem(itemIndex)
            },
            codesearch: $.type(self._useCodesearch) === "undefined" ? false : useCodesearch,
            cell: {
              field: $.type(column) === "undefined" ? fields : column.field
            }
          };
          if (subSave) {
            event = new $.Event("save", parameter);
            self.$element.trigger(event);
          }
          delete self._useCodesearch;
        };
        self._grid.onSelectionEnded = function (grid2) {
          if (dews.ui.page.option === void 0 && dews.ui.page.useGridNote === "Y") {
            var selectDataIndex = grid2.getSelection().startRow;
            noteMain(grid2, selectDataIndex);
          }
        };
        self._grid.onCurrentRowChanged = function (grid2, oldIndex, newIndex) {
          if (self.options.dataBounding || oldIndex === newIndex || $.type(self.options.add) === "boolean" || newIndex === -1 && self.options.master || $.type(self.options.remove) === "boolean") {
            self._grid.onCurrentChanging.call(self, self._grid, self._grid.getCurrent(), self._grid.getCurrent());
            self.options.rowChange = true;
            self._grid.onCurrentChanged.call(self, self._grid, self._grid.getCurrent());
          }
        };
        self._grid.onCurrentChanging = function (grid2, oldIndex, newIndex) {
          if (typeof self.options.insert === "undefined") {var _columns$editor7, _columns$editor7$type, _columns$editor8, _columns$editor8$mask, _columns$editor9, _filterArr5;
            var getDataItem = function getDataItem(oldIndex2) {
              var dataProvider = grid2._dataSource;
              if (dataProvider.getRowCount() === 0) {
                return;
              }
              if (grid2.isGrouped() && oldIndex2.dataRow === 1) {
                return;
              }
              return self.dataItem(oldIndex2.itemIndex);
            };
            var dataRow = newIndex.dataRow;
            if (self._grid.getItemCount() === 0 && oldIndex.itemIndex >= 0) {
              return;
            }
            self.options.rowChange = false;
            if (newIndex.dataRow === -1 ? oldIndex.itemIndex !== newIndex.itemIndex : oldIndex.dataRow !== newIndex.dataRow) {
              self.options.rowChange = true;
            }
            self.options.isDataBound = self.options.dataBounding === true;
            self.options.previousData = getDataItem(oldIndex);
            self.options.previous = oldIndex;
            if (oldIndex.dataRow !== -1 && self.focused) {
              self.setFocus();
            }
            if (newIndex.dataRow === -1) {
              if (self._grid.getItemState(newIndex.itemIndex) === "appending") {
                self._grid.commit(true);
                dataRow = newIndex.itemIndex;
              }
            }
            var columns = self.columns[newIndex.fieldName];
            var filterArr;
            if (grid2.getColumnProperty(newIndex.column, "editor") && newIndex.fieldIndex !== -1 && self.dataItem(newIndex.itemIndex)) {
              if (columns !== null && columns !== void 0 && columns.editor && self.options.dataSource) {var _filterArr4;
                var editor;
                var rowEditable;
                var visible;
                var parameter = {
                  grid: self,
                  row: {
                    index: dataRow,
                    data: self._grid.getValues(newIndex.itemIndex)
                  },
                  cell: {
                    field: newIndex.fieldName
                  }
                };
                filterArr = newIndex !== null && newIndex !== void 0 && newIndex.fieldName ? self._grid.getActiveColumnFilters(newIndex.fieldName, true) : null;
                if (grid2.getSortedFields() !== null || ((_filterArr4 = filterArr) === null || _filterArr4 === void 0 ? void 0 : _filterArr4.length) > 0) {
                  parameter.row.index = newIndex.itemIndex;
                  parameter.row.data = self._grid.getValues(newIndex.itemIndex);
                }
                if (typeof columns.editable === "boolean" && !columns.editable && columns.editor.type.toLowerCase() !== "check") {
                  editor = columns.editable;
                } else {
                  editor = typeof columns.editor.editable === "function" ? columns.editor.editable.call(self, parameter) : columns.editor.editable;
                }
                columns.editor.editResult = editor;
                rowEditable = typeof self.options.rowEditable === "function" ? self.options.rowEditable.call(self, parameter) : self.options.rowEditable;
                self.rowEditable = rowEditable;
                if (self.options.editable) {
                  if (typeof rowEditable === "boolean") {
                    columns.editor.flag = rowEditable !== true;
                  }
                  if (columns.editable && typeof columns.editor.editable === "function" && editor) {
                    grid2.setColumnProperty(newIndex.fieldName, "editable", editor);
                  }
                }
                switch (columns.editor.type.toLowerCase()) {
                  case "codepicker":
                  case "zipcodepicker":
                  case "time":
                  case "month":
                  case "year":
                    visible = "visible";
                    if (!editor) {
                      visible = "hidden";
                      if (columns.cellDynamic) {
                        var betweenStr = function betweenStr(str, char1, char2) {
                          return str.split(char1).join("").split(char2).join("");
                        };
                        columns.cellDynamic.forEach(function (dynamic) {
                          var criteria = betweenStr(dynamic.criteria, "(", ")");
                          var field = betweenStr(
                          criteria.split("=")[0].match(/\'.*\'/gi)[0],
                          "'",
                          "'");

                          var value = betweenStr(criteria.split("=")[1].trim(), "'", "'");
                          var data = self.dataItem(dataRow);
                          if (data[field] === value) {
                            if (dynamic.styles.editable) {
                              visible = "visible";
                            }
                          }
                        });
                      }
                    }
                    if (rowEditable === false) {
                      visible = "hidden";
                    }
                    if (!self.options.edit.editable) {
                      visible = "hidden";
                    }
                    columns.buttonVisibility = visible;
                    self._grid.setColumnProperty(columns.name, "buttonVisibility", visible);
                    break;}

                if (columns.editor.type.toLowerCase() === "check") {
                  var options = self._grid.getColumnProperty(columns.name, "renderer");
                  if (typeof rowEditable === "boolean" && rowEditable === false) {
                    self._grid.setColumnProperty(
                    columns.name,
                    "renderer",
                    $.extend(true, options, {
                      editable: rowEditable
                    }));

                  } else {
                    self._grid.setColumnProperty(
                    columns.name,
                    "renderer",
                    $.extend(true, options, { editable: editor }));

                  }
                }
                if (columns.editable && editor) {
                  if (typeof self.options.rowEditable === "undefined" || rowEditable || rowEditable !== false) {
                    self._grid.setColumnProperty(columns.name, "editable", true);
                  } else {
                    self._grid.setColumnProperty(columns.name, "editable", false);
                  }
                } else {
                  self._grid.setColumnProperty(columns.name, "editable", false);
                }
              }
            }
            if ((columns === null || columns === void 0 ? void 0 : (_columns$editor7 = columns.editor) === null || _columns$editor7 === void 0 ? void 0 : (_columns$editor7$type = _columns$editor7.type) === null || _columns$editor7$type === void 0 ? void 0 : _columns$editor7$type.toLowerCase()) === "dropdown" && typeof columns.editor.dataSource === "function" && self.dataItem(newIndex.itemIndex)) {
              var col = self._grid.columnByField(columns.fieldName);
              var e = {
                grid: self,
                row: {
                  index: newIndex.dataRow,
                  data: self.dataItem(newIndex.dataRow)
                }
              };
              var datasource = columns.editor.dataSource.call(self, e);
              col.values = [];
              col.labels = [];
              if (typeof col.editor === "string" && col.editor === "dropDown") {
                col.editor = {
                  type: "dropDown",
                  values: [],
                  labels: []
                };
              }
              datasource.fetch(function () {
                $.each(datasource.data(), function (idx, value) {
                  col.values.push(value[columns.editor.dataValueField]);
                  col.labels.push(value[columns.editor.dataTextField]);
                  if (columns.editor.dataSelectable && value[columns.editor.dataSelectable.field] !== columns.editor.dataSelectable.falseValue) {
                    col.editor.values.push(value[columns.editor.dataValueField]);
                    col.editor.labels.push(value[columns.editor.dataTextField]);
                  }
                });
                col.labelField = typeof columns.editor.textField === "undefined" ? columns.editor.dataTextField : columns.editor.textField;
                col.lookupDisplay = true;
                self._grid.setColumn(col);
              });
            }
            if (columns !== null && columns !== void 0 && (_columns$editor8 = columns.editor) !== null && _columns$editor8 !== void 0 && (_columns$editor8$mask = _columns$editor8.mask) !== null && _columns$editor8$mask !== void 0 && _columns$editor8$mask.allowEmpty && typeof columns.editor.format === "function" && self.dataItem(newIndex.itemIndex)) {
              var maskParams = {
                grid: self,
                row: {
                  index: newIndex.dataRow,
                  data: self.dataItem(newIndex.dataRow)
                },
                cell: {
                  field: newIndex.column,
                  data: self.getCellValue(newIndex.dataRow, newIndex.column)
                }
              };
              var maskEditFormat = columns.editor.format.call(self, maskParams);
              if (typeof maskEditFormat === "string" && maskEditFormat !== "") {
                self._grid.setColumnProperty(self._grid.columnByField(columns.field), "editorOptions", {
                  mask: { editMask: maskEditFormat }
                });
              } else {
                self._grid.setColumnProperty(self._grid.columnByField(columns.field), "editorOptions", {
                  mask: null
                });
              }
            }
            if ((columns === null || columns === void 0 ? void 0 : (_columns$editor9 = columns.editor) === null || _columns$editor9 === void 0 ? void 0 : _columns$editor9.type) === "number" && typeof columns.editor.currency === "function" && self.dataItem(newIndex.itemIndex)) {var _dews$ui$page9;
              var params = {
                grid: self,
                row: {
                  index: newIndex.itemIndex,
                  data: self.dataItem(newIndex.itemIndex)
                },
                cell: {
                  field: newIndex.column,
                  data: self.getCellValue(newIndex.itemIndex, newIndex.column)
                }
              };
              columns.editor.preCurrency = columns.editor.currency.call(self, params);
              var env = ((_dews$ui$page9 = dews.ui.page) === null || _dews$ui$page9 === void 0 ? void 0 : _dews$ui$page9.env) && dews.ui.page.env[columns.editor.preFormat];
              var currencyFormat = dews.getCurrencyFormat(columns.editor);
              var formats = "#,###.##";
              if (env) {
                formats = env.format;
              }
              if (_typeof(currencyFormat) === "object") {
                formats = currencyFormat.format;
              }
              var columnInfo = self._grid.columnByField(columns.field);
              var editorOptions = self._grid.getColumnProperty(columnInfo, "editorOptions", true);
              editorOptions.editFormat = formats;
              self._grid.setColumnProperty(columnInfo, "editorOptions", editorOptions);
            }
            var column = self.options.columns;
            if (self.options.dataBounding) {
              var dataBoundParameter = {
                grid: self,
                row: {
                  data: self.options.dataSource.data()
                },
                column: column
              };
              if (self.options.dataSource.options.paging) {
                dataBoundParameter.paging = true;
                dataBoundParameter.page = {};
                dataBoundParameter.page.startIndex = self.options.dataSource.options.pagingStart;
                if (self.options.dataSource.options.data) {
                  dataBoundParameter.page.endIndex = self.options.dataSource.options.pagingStart + self.options.dataSource.options.data.length - 1;
                } else {
                  dataBoundParameter.page.endIndex = self.options.dataSource.options.pagingStart - 1;
                }
                dataBoundParameter.page.totalCount = self.options.dataSource.options.totalCount;
              }
              var dataBoundEvent = new $.Event("dataBound", dataBoundParameter);
              self.$element.trigger(dataBoundEvent);
              delete self.options.dataBounding;
              delete self._innerOptions.dataBounding;
              self._setCriteria();
              if (self.options.note) {
                self._gridNote.boundingDraw(grid2, self, dataBoundParameter);
              }
              for (var key in self.columns) {
                var _col2 = self.columns[key];
                if (_col2.codeOption) {
                  _col2.codeOption.value = {};
                }
              }
            }
            if (typeof self.options.previousData === "undefined") {
              self.options.previousData = "";
            }
            if (typeof self.options.previous === "undefined") {
              self.options.previous = newIndex;
            }
            var nIndex = self._grid.getGroupFields() && self._grid.getGroupFields().length !== 0 ? newIndex.itemIndex : newIndex.dataRow;
            var changingParameter = {
              grid: self,
              isDataBound: self.options.isDataBound,
              row: {
                next: {
                  index: newIndex.dataRow,
                  data: self.dataItem(newIndex.itemIndex)
                },
                isChange: self.options.rowChange,
                index: oldIndex.dataRow !== -1 ? oldIndex.dataRow : oldIndex.itemIndex,
                data: self.dataItem(oldIndex.dataRow)
              },
              cell: {
                next: {
                  field: newIndex.fieldName,
                  data: void 0
                },
                field: oldIndex.fieldName
              }
            };
            if (self._grid.getGroupFields() === null || self._grid.getGroupFields().length === 0) {
              changingParameter.cell.data = self._grid.getValue(oldIndex.dataRow, oldIndex.fieldName);
            }
            if (_typeof(self.dataItem(newIndex.itemIndex)) === "object") {
              try {
                if (self._grid.isGroupItem(newIndex.itemIndex) === true) {
                  changingParameter.cell.next.data = void 0;
                } else {
                  changingParameter.cell.next.data = self._grid.getValue(
                  newIndex.itemIndex,
                  newIndex.fieldName);

                }
              } catch (e) {
                changingParameter.cell.next.data = void 0;
              }
            }
            filterArr = newIndex !== null && newIndex !== void 0 && newIndex.fieldName ? self._grid.getActiveColumnFilters(newIndex.fieldName, true) : null;
            if (grid2.getSortedFields() !== null || ((_filterArr5 = filterArr) === null || _filterArr5 === void 0 ? void 0 : _filterArr5.length) > 0) {
              changingParameter.row.next.index = newIndex.itemIndex;
              changingParameter.row.next.data = self.dataItem(newIndex.itemIndex);
              changingParameter.row.index = oldIndex.itemIndex;
              changingParameter.row.data = getDataItem(oldIndex);
              if (oldIndex.itemIndex !== -1 && oldIndex.dataRow === -1) {
                changingParameter.cell.data = void 0;
              } else if (self._grid._dataSource.getRowCount() === 0) {
                changingParameter.cell.data = void 0;
              } else {
                changingParameter.cell.data = self._grid.getValue(oldIndex.itemIndex, oldIndex.fieldName);
              }
            }
            var _event2 = new $.Event("changing", changingParameter);
            self.$element.trigger(_event2);
            if (_event2.isDefaultPrevented()) {
              return false;
            }
          }
        };
        self._grid.onCurrentChanged = function (grid2, newIndex) {
          if ($.type(self.options.insert) === "undefined") {
            var index = newIndex.dataRow;
            var filterArr;
            if (self._grid.getItemCount() === 0 && newIndex.itemIndex >= 0) {
              return;
            }
            if (newIndex.itemIndex !== -1 && self.options.add && !self.options.filterClearing) {
              if (self.options.dataSource) {
                var addParameter, addEvent;
                addParameter = {
                  grid: self,
                  row: {
                    index: newIndex.itemIndex,
                    data: self.dataItem(self.select())
                  }
                };
                self._grid.commit(true);
                addEvent = new $.Event("rowAdd", addParameter);
                self.$element.trigger(addEvent);
              }
              delete self.options.add;
            }
            var parameter = {
              grid: self,
              isDataBound: self.options.isDataBound,
              row: {
                index: newIndex.itemIndex,
                data: self.dataItem(newIndex.itemIndex),
                isChange: self.options.rowChange,
                previous: {
                  index: self.options.previous.dataRow !== -1 ? self.options.previous.dataRow : self.options.previous.itemIndex,
                  data: self.dataItem(self.options.previous.dataRow)
                }
              },
              cell: {
                field: newIndex.fieldName,
                data: void 0,
                previous: {
                  field: self.options.previous.fieldName
                }
              }
            };
            if ($.type(self._grid.getGroupFields()) === "null" || self._grid.getGroupFields().length === 0) {
              parameter.cell.previous.data = self._grid.getValue(
              self.options.previous.dataRow,
              self.options.previous.fieldName);

            }
            if ($.type(self.dataItem(newIndex.itemIndex)) === "object") {
              try {
                if (self._grid.isGroupItem(newIndex.itemIndex) === true) {
                  parameter.cell.data = void 0;
                } else {
                  parameter.cell.data = self._grid.getValue(newIndex.itemIndex, newIndex.fieldName);
                }
              } catch (e) {
                parameter.cell.data = void 0;
              }
            }
            if (newIndex && newIndex.fieldName) {
              filterArr = self._grid.getActiveColumnFilters(newIndex.fieldName, true);
            } else {
              filterArr = null;
            }
            if ($.type(grid2.getSortedFields()) !== "null" || filterArr && filterArr.length > 0) {
              parameter.row.index = newIndex.itemIndex;
              parameter.row.data = self.dataItem(newIndex.itemIndex);
              parameter.row.previous.index = self.options.previous.itemIndex;
              parameter.row.previous.data = self.dataItem(self.options.previous.itemIndex);
              if (self.options.previous.itemIndex !== -1 && self.options.previous.dataRow === -1) {
                parameter.cell.previous.data = self._grid.getValue(
                self.options.previous.dataRow,
                self.options.previous.fieldName);

              } else {
                parameter.cell.previous.data = self._grid.getValue(
                self.options.previous.itemIndex,
                self.options.previous.fieldName);

              }
            }
            var event = new $.Event("change", parameter);
            self.$element.trigger(event);
            delete self.options.isDataBound;
            if (self._grid.getCurrent().dataRow === -1 && $.type(self._grid.getGroupFields()) === "null") {
              if (self._grid.getItemState(newIndex.itemIndex) === "appending") {
                self._grid.commit(true);
                index = self._grid.getCurrent().dataRow;
              } else {
                self._grid.removeCellStyles(["selection"]);
                return;
              }
            }
            if (self._grid.getSelectOptions().style !== "none") {
              var ids = ["selection"];
              self._grid.removeCellStyles(ids);
              var background = self.options.gridStyle.selection.focusBackgroundColor;
              if ($.type(self.columns[newIndex.column]) !== "undefined" && $.type(self.columns[newIndex.column].attributes) !== "undefined") {
                if (self.columns[newIndex.column].attributes["class"] === "required") {
                  background = self.options.gridStyle.body.requiredFocusBackground;
                } else if (self.columns[newIndex.column].attributes["class"] === "readonly") {
                  background = self.options.gridStyle.body.readonlyFocusBackground;
                }
              }
              if (self._grid.getCellStyle(index, newIndex.fieldIndex) === "editable") {
                self._grid.addCellStyle(
                "selection",
                {
                  editable: false,
                  background: background
                },
                true);

                self._grid.setCellStyle(index, newIndex.fieldIndex, "selection");
              } else {
                self._grid.addCellStyle(
                "selection",
                {
                  background: background
                },
                true);

                self._grid.setCellStyle(index, newIndex.fieldIndex, "selection");
              }
            } else {
              self._grid.removeCellStyles(["selection"]);
            }
            if (dews.ui.page && dews.ui.page.hasUserGuide) {
              if ($.isFunction(dews.ui.page.focusGuideItem) && newIndex.column) {
                dews.ui.page.focusGuideItem("#" + newIndex.column);
              }
            }
            var column = self.columns[newIndex.fieldName];
            if (column && column.editor) {
              if (column.editor.type.toLowerCase() === "dropdown" && column.editor.editResult && column.editor.autoOpen === true) {
                self.editCell();
              }
            }
          } else {
            delete self.options.insert;
          }
          delete self.options.remove;
        };
        self._grid.onValidateColumn = function (grid2, column, inserting, value) {
          var event,parameter = {
              grid: self,
              cell: {
                field: column.fieldName,
                data: value
              },
              row: {
                index: self._grid.getCurrent().itemIndex
              }
            };
          if (column.fieldName === grid2.getCurrent().fieldName) {
            event = new $.Event("validationCheck", parameter);
            self.$element.trigger(event);
          }
        };
        self._grid.onContextMenuPopup = function (grid2, x, y, elementName) {
          var contextPosition = self.optionAdaptor._styleCreator.theme === "posco" ? "HeaderCell" : "DataCell";
          if (elementName === contextPosition && self.options.dataSource) {
            var currentCell = grid2.mouseToIndex(x, y),parameter = {
                grid: self,
                row: {
                  index: currentCell.itemIndex,
                  data: self.dataItem(currentCell.itemIndex)
                },
                cell: {
                  field: currentCell.fieldName,
                  data: grid2.getValue(currentCell.itemIndex, currentCell.fieldName)
                }
              };
            dews.ui.gridUtil.onContextMenuPopup(self, currentCell, parameter);
          } else {
            return false;
          }
        };
        self._grid.onContextMenuItemClicked = function (grid2, label, index) {
          if (self.options.dataSource) {
            var parameter = {
              grid: self,
              row: {
                index: index.itemIndex,
                data: self.options.dataSource.at(self._grid.getValues(index.itemIndex).__rowId)
              },
              cell: {
                field: index.fieldName,
                data: grid2.getValue(index.itemIndex, index.fieldName)
              }
            };
            dews.ui.gridUtil.onContextMenuItemClicked(self, index, label, parameter);
          }
        };
        self._grid.onItemChecked = function (grid2, itemIndex, checked) {
          var event;
          var parameter = {
            grid: self,
            row: {
              index: itemIndex,
              data: self.dataItem(itemIndex)
            },
            cell: {
              isClicked: checked,
              header: {
                isClicked: false
              }
            }
          };
          event = new $.Event("selected", parameter);
          self.$element.trigger(event);
        };
        self._grid.onItemsChecked = function (grid2, items, checked) {
          var event;
          var parameter;
          parameter = {
            grid: self,
            row: {
              index: items,
              data: self.dataItems(items)
            },
            cell: {
              isClicked: checked,
              header: {
                isClicked: false
              }
            }
          };
          if (checked || self.options.shiftCheck) {
            event = new $.Event("selected", parameter);
            self.$element.trigger(event);
          }
        };
        self._grid.onItemAllChecked = function (grid2, checked) {
          var checkedIndex = self.getCheckedIndex();
          var event;
          var parameter = {
            grid: self,
            row: {
              index: checkedIndex,
              data: self.dataItems()
            },
            cell: {
              isClicked: checked,
              header: {
                isClicked: true
              }
            }
          };
          event = new $.Event("selected", parameter);
          self.$element.trigger(event);
        };
        self._grid.onGetEditValue = function (grid2, index, editResult) {
          dews.ui.gridUtil.onGetEditValue(self, index, editResult);
        };
        self._grid.onDataCellClicked = function (grid2, index) {
          var parameter = {
            grid: self,
            row: {
              index: index.itemIndex,
              data: self.dataItem(index.itemIndex)
            },
            cell: {
              field: index.fieldName,
              data: self.getCellValue(index.itemIndex, index.fieldName)
            }
          };
          var event = new $.Event("clicked", parameter);
          self.$element.trigger(event);
        };
        self._grid.onDataCellDblClicked = function (grid2, index) {
          var dblParameter = {
            grid: self,
            row: {
              index: index.itemIndex,
              data: self.dataItem(index.itemIndex)
            },
            cell: {
              field: index.fieldName,
              data: self.getCellValue(index.itemIndex, index.fieldName)
            }
          };
          var dblEvent = new $.Event("dblClicked", dblParameter);
          self.$element.trigger(dblEvent);
        };
        self._grid.onKeyDown = function (grid2, key, ctrl, shift, alt) {
          var currentColumn = self._grid.getCurrent().column;
          var currentIndex = self._grid.getCurrent().dataRow;
          if (key === 13 && self.options.requiredCheck && self.columns[currentColumn].attributes && self.columns[currentColumn].attributes["class"] === "required" && !self.getCellValue(currentIndex, currentColumn)) {
            return false;
          }
          if (key === 13 && self.columns[currentColumn].editor.type.toLowerCase() === "codepicker" && self.columns[currentColumn].codeOption.codesearch && $.type(self._grid.getEditValue()) === "undefined") {
            return false;
          }
          var parameter = {
              grid: self,
              keyCode: key,
              row: {
                index: self._grid.getCurrent().itemIndex
              },
              cell: {
                field: self._grid.getCurrent().column
              },
              ctrl: ctrl,
              shift: shift,
              alt: alt
            },event = $.Event("keyDown", parameter);
          self.$element.trigger(event);
          if (event.isDefaultPrevented()) {
            return false;
          }
          if (self._grid.getCheckBar().visible && self._grid.isCheckable(self._grid.getCurrent().itemIndex) && key === 32) {
            if (self._grid.isCheckedRow(self._grid.getCurrent().dataRow)) {
              self._grid.checkRow(self._grid.getCurrent().dataRow, false, false);
            } else {
              self._grid.checkRow(self._grid.getCurrent().dataRow, true, false);
            }
            return false;
          }
          var current = self._grid.getCurrent(),rowIndex = current.itemIndex,rowData = self.dataItem(rowIndex),editParams = {
              grid: self,
              row: {
                index: rowIndex,
                data: rowData
              },
              cell: {
                field: ""
              }
            };
          if ($.type(self._grid.getEditValue()) === "undefined" && $.type(self.options.editSkip) !== "undefined" && self.options.editSkip) {
            var disPlayColumn = self.options.displayColumns,index = 0,i = 0,column;
            $.each(self.options.displayColumns, function (idx, column2) {
              if (column2.field === current.column) {
                index = idx;
              }
            });
            if (key === 13 || !shift && key === 9) {
              for (var j = rowIndex; j < self.dataItems().length; j += 1) {
                editParams.row.index = j;
                editParams.row.data = self.dataItem(j);
                for (i = index + 1; i < disPlayColumn.length; i += 1) {
                  editParams.cell.field = disPlayColumn[i].field;
                  column = self.columns[disPlayColumn[i].field];
                  var condition;
                  if (column.editable) {
                    condition = $.type(self.options.rowEditable) !== "undefined" ? !column.editor.flag ? !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable")) || !($.type(self.options.rowEditable) === "function" ? self.options.rowEditable.call(self, editParams) : self.options.rowEditable) : !self.options.rowEditable.call(self, editParams) : !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable"));
                  } else {
                    condition = true;
                  }
                  if (!condition) {
                    if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                      self._grid.setCurrent({
                        itemIndex: j,
                        columns: column.fieldName,
                        dataRow: j,
                        fieldIndex: i,
                        fieldName: column.fieldName
                      });
                      return false;
                    }
                  } else if (i === disPlayColumn.length - 1 && j === self.dataItems().length - 1) {
                    if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                      self.commitCell();
                      return false;
                    }
                  }
                }
                index = -1;
              }
            } else if (key === 39 && index !== disPlayColumn.length - 1) {
              for (i = index + 1; i < disPlayColumn.length; i += 1) {
                editParams.cell.field = disPlayColumn[i].field;
                column = self.columns[disPlayColumn[i].field];
                var condition;
                if (column.editable) {
                  condition = $.type(self.options.rowEditable) !== "undefined" ? !column.editor.flag ? !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable")) || !($.type(self.options.rowEditable) === "function" ? self.options.rowEditable.call(self, editParams) : self.options.rowEditable) : !self.options.rowEditable.call(self, editParams) : !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable"));
                } else {
                  condition = true;
                }
                if (!condition) {
                  if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                    self._grid.setCurrent({
                      itemIndex: self._grid.getCurrent().itemIndex,
                      columns: column.fieldName,
                      dataRow: self._grid.getCurrent().dataRow,
                      fieldIndex: i,
                      fieldName: column.fieldName
                    });
                    return false;
                  } else if (i === disPlayColumn.length - 1) {
                    if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                      return false;
                    }
                  }
                } else if (i === disPlayColumn.length - 1) {
                  return false;
                }
              }
            } else if (key === 37 && index !== 0) {
              for (i = index - 1; i >= 0; i -= 1) {
                editParams.cell.field = disPlayColumn[i].field;
                column = self.columns[disPlayColumn[i].field];
                var condition;
                if (column.editable) {
                  condition = $.type(self.options.rowEditable) !== "undefined" ? !column.editor.flag ? !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable")) || !($.type(self.options.rowEditable) === "function" ? self.options.rowEditable.call(self, editParams) : self.options.rowEditable) : !self.options.rowEditable.call(self, editParams) : !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable"));
                } else {
                  condition = true;
                }
                if (!condition) {
                  if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                    self._grid.setCurrent({
                      itemIndex: self._grid.getCurrent().itemIndex,
                      columns: column.fieldName,
                      dataRow: self._grid.getCurrent().dataRow,
                      fieldIndex: i,
                      fieldName: column.fieldName
                    });
                    return false;
                  } else if (i === 0) {
                    if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                      return false;
                    }
                  }
                } else if (i === 0) {
                  return false;
                }
              }
            }
          }
          if (key === 27) {
            if (dews.ui.dialogPage && $.type(self._grid.getEditValue()) === "undefined") {
              dews.ui.dialogPage.dialog._close(false);
            }
          }
          if (shift && key === 9) {
            if (self.options.editSkip) {
              for (var row = rowIndex; row >= 0; row -= 1) {
                editParams.row.index = row;
                editParams.row.data = self.dataItem(row);
                for (i = index - 1; i >= 0; i -= 1) {
                  editParams.cell.field = disPlayColumn[i].field;
                  column = self.columns[disPlayColumn[i].field];
                  var condition = $.type(self.options.rowEditable) !== "undefined" ? !column.editor.flag ? !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable")) || !($.type(self.options.rowEditable) === "function" ? self.options.rowEditable.call(self, editParams) : self.options.rowEditable) : !self.options.rowEditable.call(self, editParams) : !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable"));
                  if (!condition) {
                    if (column.editor && $.type(column.editor.editable) === "function" && column.editor.editable.call(self, editParams)) {
                      if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                        self.select(row, column.fieldName);
                        return false;
                      }
                    } else if (column.editor && $.type(column.editor.editable) === "boolean") {
                      if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                        self.select(row, column.fieldName);
                        return false;
                      }
                    }
                  }
                }
                index = self.options.displayColumns.length;
              }
            }
          }
        };
        self._grid.onKeyUp = function (grid2, key, ctrl, shift, alt) {
          var params;
          if (self.dataItem(self._grid.getCurrent().itemIndex) !== null) {
            params = {
              grid: self,
              row: {
                index: self._grid.getCurrent().itemIndex,
                data: self.dataItem(self._grid.getCurrent().itemIndex)
              },
              cell: {
                field: self._grid.getCurrent().column,
                data: self.getCellValue(self._grid.getCurrent().itemIndex, self._grid.getCurrent().column)
              },
              keyCode: key,
              ctrl: ctrl,
              shift: shift,
              alt: alt
            };
          }
          var event = $.Event("keyUp", params);
          self.$element.trigger(event);
          if (key === 37 || key === 38 || key === 39 || key === 40) {
            if (dews.ui.page.option === void 0 && dews.ui.page.useGridNote === "Y") {
              self._grid.onSelectionEnded.call(self, self._grid);
            }
          }
        };
        self._grid.setPasteOptions({
          eventEachRow: true
        });
        self._grid.onEditRowPasted = function (grid2, itemIndex, dataRow, fields, oldValues, newValues) {
          var className = ".dews-ui-grid";
          newValues = newValues.filter(function (value) {return value !== void 0;});
          var isCell = true;
          var copyData = self.clipboard.copyData;
          if (copyData.length < 2) {
            copyData = copyData.toString().split("\n");
          }
          self.clipboard.length = copyData.length;
          if (fields.length > 1 || copyData.length > 1) {
            isCell = false;
          }
          for (var i = 0; i < fields.length; i++) {
            var _newValues = newValues.slice(i, i + 1),fieldName = grid2._dataSource.getOrgFieldName(fields[i]),fieldIndex = fields[i];
            dews.ui.gridUtil.onEditRowPasted(self, itemIndex, fieldName, fieldIndex, _newValues, className, isCell);
          }
          addRowEvent();
          function addRowEvent() {
            if (!self.options.pastingAtNewRow) {
              return;
            }
            if (self.options.dataSource) {
              var addParameter = {
                grid: self,
                row: {
                  index: itemIndex,
                  data: self.dataItem(itemIndex)
                }
              };
              self._grid.commit(true);
              var addEvent = new $.Event("rowAdd", addParameter);
              try {
                self.$element.trigger(addEvent);
              } catch (e) {
                console.log(e);
              }
            }
            delete self.options.pastingAtNewRow;
          }
        };
        self._grid.onCopy = function (grid2, range, event) {
          self.clipboard = {
            grid: self,
            itemIndex: {
              start: range.startItem,
              end: range.endItem
            },
            column: {
              start: range.startColumn,
              end: range.endColumn
            },
            range: range,
            values: self._grid.getSelectionData()
          };
          var copyEvent = new $.Event("onCopy", self.clipboard);
          self.$element.trigger(copyEvent);
          if (copyEvent.isDefaultPrevented()) {
            return false;
          }
        };
        self._grid.onPaste = function (grid2, index, event) {
          var getText = $.type(event.clipboardData) === "undefined" ? window.clipboardData.getData("Text") : event.clipboardData.getData("Text");
          var checkLastNewLine = getText.substr(getText.length - 2) === "\r\n";
          if (checkLastNewLine) {
            getText = getText.substring(0, getText.length - 2);
          }
          var doubleData = getText.split("\r\n");
          for (var i = 0; i < doubleData.length; i++) {
            doubleData[i] = doubleData[i].split("	");
          }
          var pastingParams = {
            grid: self,
            copyData: doubleData,
            start: {
              index: index.itemIndex,
              column: index.column
            }
          };
          self.clipboard = {
            copyData: doubleData,
            cnt: 0
          };
          var pastingEvent = new $.Event("pasting", pastingParams);
          self.$element.trigger(pastingEvent);
          if (pastingEvent.isDefaultPrevented()) {
            return false;
          }
          var pasteResult = dews.ui.gridUtil.onPaste(self, index, event);
          return pasteResult;
        };
        self._grid.onScrollToBottom = function () {
          var dataSource = self.options.dataSource;
          if (dataSource && dataSource.options.pagingType === "scroll") {
            dataSource.options.bottom = true;
            var eventParameter = {
                grid: self
              },scrollToBottomEvent;
            scrollToBottomEvent = new $.Event("scrollToBottom", eventParameter);
            self.$element.trigger(scrollToBottomEvent);
            if (dataSource.options.pagingScrollEnd !== true && dataSource.options.totalCount) {
              dataSource.read();
            } else {
              dews.ui.loading.hide();
            }
          }
        };
        self._grid.onPasted = function (grid2) {
          var start,end,rows = [],result,columns = [],isSelectionColumn = false,startColumn,endColumn,selectionColumns;
          selectionColumns = self._grid.getSelection();
          start = selectionColumns !== null ? selectionColumns.startItem : self._grid.getCurrent().itemIndex;
          end = selectionColumns !== null ? selectionColumns.endItem : self._grid.getCurrent().itemIndex;
          startColumn = selectionColumns !== null ? selectionColumns.startColumn : "";
          endColumn = selectionColumns !== null ? selectionColumns.endColumn : "";
          for (var i = start; i <= end; i++) {
            rows.push(i);
          }
          if (selectionColumns === null) {
            columns.push(self._grid.getCurrent().fieldName);
          } else {
            var displayColumns = self._grid.getDisplayColumns();
            result = getSelectionColumns(displayColumns, startColumn, endColumn, isSelectionColumn);
            columns = result.columns;
          }
          if (self.options.copyMode === "row") {
            $.each(rows, function (index, row) {
              $.each(columns, function (idx, column) {
                var editParams = {
                  grid: self,
                  row: {
                    index: row,
                    data: self.dataItem(row)
                  },
                  cell: {
                    field: column,
                    data: self.getCellValue(row, column)
                  }
                };
                if (self.columns[column] && (!self.columns[column].editable || $.type(self.columns[column].editor.editable) === "function" && !self.columns[column].editor.editable.call(self, editParams))) {
                }
              });
            });
          }
          var eventParameter = {
            grid: self,
            columns: columns,
            rows: rows
          };
          grid2.commit();
          var pastedEvent = new $.Event("pasted", eventParameter);
          self.$element.trigger(pastedEvent);
        };
        self._grid.onCellPasting = function (grid2, index) {
          if (!self.options.pasteAddRowEvent) {
            return true;
          }
          if (index.itemIndex === -1 || index.dataRow === -1) {
            self.options.pastingAtNewRow = true;
          }
          return true;
        };
        self.$element.on("changing", function (e) {
          if (self.options.changing && $.type(self.options.changing) === "function" && e.grid) {
            self.options.changing.call(self, e);
          }
        });
        self.$element.on("change", function (e) {
          if (self.options.change && $.type(self.options.change) === "function" && e.grid) {
            self.options.change.call(self, e);
          }
        });
        self.$element.on("save", function (e) {
          if (self.options.save && $.type(self.options.save) === "function" && e.grid) {
            self.options.save.call(self, e);
          }
        });
        self.$element.on("validationCheck", function (e) {
          if (self.options.validationCheck && $.type(self.options.validationCheck) === "function" && e.grid) {
            self.options.validationCheck.call(self, e);
          }
        });
        self.$element.on("dataBound", function (e) {
          if (self.options.dataBound && $.type(self.options.dataBound) === "function" && e.grid) {
            self.options.dataBound.call(self, e);
          }
        });
        self.$element.on("rowAdd", function (e) {
          if (self.options.rowAdd && $.type(self.options.rowAdd) === "function" && e.grid) {
            self.options.rowAdd.call(self, e);
          }
        });
        self.$element.on("rowRemove", function (e) {
          if (self.options.rowRemove && $.type(self.options.rowRemove) === "function" && e.grid) {
            self.options.rowRemove.call(self, e);
          }
        });
        self.$element.on("cellEditing", function (e) {
          if (self.options.cellEditing && $.type(self.options.cellEditing) === "function" && e.grid) {
            self.options.editValue = self.options.cellEditing.call(self, e);
          }
        });
        self.$element.on("selected", function (e) {
          if (self.options.selected && $.type(self.options.selected) === "function" && e.grid) {
            self.options.selected.call(self, e);
          }
        });
        self.$element.on("clicked", function (e) {
          if (self.options.clicked && $.type(self.options.clicked) === "function" && e.grid) {
            self.options.clicked.call(self, e);
          }
        });
        self.$element.on("dblClicked", function (e) {
          if (self.options.dblClicked && $.type(self.options.dblClicked) === "function" && e.grid) {
            self.options.dblClicked.call(self, e);
          }
        });
        self.$element.on("keyDown", function (e) {
          if (self.options.keyDown && $.type(self.options.keyDown) === "function" && e.grid) {
            self.options.keyDown.call(self, e);
          }
        });
        self.$element.on("headerClicked", function (e) {
          if (self.options.headerClicked && $.type(self.options.headerClicked) === "function" && e.grid) {
            self.options.headerClicked.call(self, e);
          }
        });
        self.$element.on("codedialog", function (e) {
          if (self.options.codedialog && $.type(self.options.codedialog) === "function") {
            self.options.codedialog.call(self, e);
          }
        });
        self.$element.on("columnHeaderCheck", function (e) {
          if (self.options.columnHeaderCheck && $.type(self.options.columnHeaderCheck) === "function") {
            self.options.columnHeaderCheck.call(self, e);
          }
        });
        self.$element.on("keyUp", function (e) {
          if (self.options.keyUp && $.type(self.options.keyUp) === "function") {
            self.options.keyUp.call(self, e);
          }
        });
        self.$element.on("scrollToBottom", function (e) {
          if (self.options.scrollToBottom && $.type(self.options.scrollToBottom) === "function" && e.grid) {
            self.options.scrollToBottom.call(self, e);
          }
        });
        self.$element.on("onCopy", function (e) {
          if (self.options.onCopy && $.type(self.options.onCopy) === "function" && e.grid) {
            self.options.onCopy.call(self, e);
          }
        });
        self.$element.on("pasted", function (e) {
          if (self.options.pasted && $.type(self.options.pasted) === "function" && e.grid) {
            self.options.pasted.call(self, e);
          }
        });
        self.$element.on("pasting", function (e) {
          if (self.options.pasting && $.type(self.options.pasting) === "function" && e.grid) {
            self.options.pasting.call(self, e);
          }
        });
        self.$element.on("mouseup", function (e) {
          if (e.altKey && self.options.useSimpleCalculator !== false) {
            dews.ui.gridUtil.openSimpleCalculatorDialog(self);
          }
        });
        self.$element.on("filtered", function (e) {
          if (self.options.filtered && $.type(self.options.filtered) === "function" && e.grid) {
            self.options.filtered.call(self, e);
          }
        });
        function windowScroll(e) {
          if ($(e.target).closest(document.body).length !== 0) {
            self.commitCell();
          }
        }
        function noteMain(grid2, dataIndex) {
          if (dataIndex === null || dataIndex < 0) {
            return null;
          }
          var disabledRows = self._gridNote.disabledRow;
          var disabled = false;
          if (disabledRows) {
            if (typeof disabledRows === "number") {
              disabled = disabledRows === dataIndex ? true : false;
            } else {
              disabled = disabledRows.indexOf(dataIndex) !== -1;
            }
          }
          var itemIndex = self.getItemIndexFromDataIndex(dataIndex);
          var noteOpt = self.options.note;
          var key;
          if (self.getRowState(itemIndex) === "added" || !noteOpt || disabled) {
            key = {
              gridNoteKey: "",
              gridCode: "",
              menuCode: "",
              userInfo: {
                insertId: "",
                insertIp: "",
                insertDate: "",
                updateId: "",
                updateIp: "",
                updateDate: ""
              }
            };
          } else {
            var selectRowDS = grid2._dataSource.getJsonRow(dataIndex);
            var noteKey = dews.ui.gridUtil._getGridNoteInfo(self, itemIndex);
            key = {
              gridNoteKey: noteKey.gridNoteKey,
              gridCode: noteKey.gridCode,
              menuCode: noteKey.menuCode,
              userInfo: {
                insertId: selectRowDS.INSERT_ID,
                insertIp: selectRowDS.INSERT_IP,
                insertDate: selectRowDS.INSERT_DTS,
                updateId: selectRowDS.UPDATE_ID,
                updateIp: selectRowDS.UPDATE_IP,
                updateDate: selectRowDS.UPDATE_DTS
              }
            };
          }
          dews.ui.page.gridNote.setGridNoteData(self, key);
        }
        $(window).on("mousedown", function (e) {
          var target = $(e.target).closest(".dews-ui-grid"),grid2 = self.$element.closest(".dews-ui-grid"),inGrid = false;
          if (grid2.length !== 0 && grid2.offset().left - window.pageXOffset < e.clientX && grid2.offset().left + grid2.width() - window.pageXOffset > e.clientX && grid2.offset().top - window.pageYOffset < e.clientY && grid2.offset().top + grid2.height() - window.pageYOffset > e.clientY) {
            inGrid = true;
          }
          if ($(e.target).closest(document.body).length === 0) {
            inGrid = true;
          }
          if (target.length === 0 && !inGrid) {
            self.commitCell();
            self.editable = false;
          }
          if (target.length !== 0 && target.children().attr("ID") !== self._grid.name) {
            self.commitCell();
            self.editable = false;
          }
        });
        self.$element.on("click", function (e) {
          var grid2 = self.options.$content.find(".dews-ui-grid");
          if (e.target.tagName !== "INPUT" && e.target.tagName !== "TEXTAREA" && self._grid.mouseToIndex(e.offsetX, e.offsetY).itemIndex === -1) {
            self.commitCell();
            self.editable = false;
          }
        });
        self.$element.on("keyDown", function (e) {
          if (self.options.columns) {
            var column = self.columns[self._grid.getCurrent().fieldName];
            if (column && column.editor) {
              if (column.editor.type.toLowerCase() === "codepicker" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (column.codeOption.validation) {
                  var codeOptionVal = column.codeOption.value[self.getDataIndexFromItemIndex(self.select())];
                  if (($.type(codeOptionVal) === "undefined" || codeOptionVal.value === "" || codeOptionVal.value === void 0) && self._grid.getCurrent().dataRow !== -1) {
                    var currentValue2 = self.getCellValue(
                    self._grid.getCurrent().itemIndex,
                    column.fieldName);

                    column.codeOption.value[self.getDataIndexFromItemIndex(self.select())] = dews.ui.gridUtil._codeOptionValue("", "", currentValue2);
                  }
                }
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
                if (e.keyCode === 13 && $.type(self._grid.getEditValue()) !== "undefined" && self._grid.getEditValue() !== "") {
                  self.commitCell();
                  e.preventDefault();
                }
                if (e.ctrl && e.keyCode === 86) {
                  self._useCodesearch = true;
                }
                if ($(".dews-loading-bg").length > 0) {
                  e.preventDefault();
                }
              }
              if (self._grid._gv._editController._editor && column.editor.type.toLowerCase() === "date") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1 && self._grid.getColumnProperty(column.fieldName, "editable")) {
                  self.editCell();
                  self._grid._gv._editController._editor.dropDown();
                  e.stopPropagation();
                  e.preventDefault();
                }
                if (e.keyCode === 13 && self._grid._gv._editController._editor._datetimeFormat && self._grid.getEditValue() === self._grid._gv._editController._editor._datetimeFormat.replace(/[A-z]/gi, "_") && ($.type(self._grid.getValue(self.select(), self.getCurrentColumn())) === "undefined" || self._grid.getValue(self.select(), self.getCurrentColumn()) === null)) {
                  self.closeCell();
                  self.setCellValue(self.select(), self.getCurrentColumn(), new Date());
                }
              }
              if (column.editor.type.toLowerCase() === "number" && self._grid.getColumnProperty(column.fieldName, "editable")) {
                if (e.keyCode === 107) {
                  var oldVal = self._grid.getEditValue();
                  if (oldVal) {
                    e.preventDefault();
                    var currentValue = oldVal.replace(/,/g, ""),resultValue = 0;
                    if (column.editor.increaseType === "plus") {
                      resultValue = parseFloat(currentValue) + parseFloat(column.editor.increaseValue);
                    } else {
                      resultValue = parseFloat(currentValue) * parseFloat(column.editor.increaseValue);
                    }
                    if (column.editor.maxIntegerLength > Math.ceil(resultValue).toString().length) {
                      self.$element.find("#" + self._grid.name + "_number").val(dews.number.format(resultValue.toString(), column.editor.format));
                      self._grid._gv._editController.onEditorChange.call(
                      self._grid._gv._editController,
                      self._grid._gv._editController._editIndex);

                    }
                  } else {
                    e.preventDefault();
                    self._grid.showEditor();
                  }
                }
              }
              if (self._grid._gv._editController._editor && column.editor.type.toLowerCase() === "dropdown") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1 && self._grid.getColumnProperty(column.fieldName, "editable")) {
                  self.editCell();
                  self._grid._gv._editController._editor.dropDown();
                  e.stopPropagation();
                  e.preventDefault();
                }
                if (self._grid._gv._editController._editor.isVisible() && column.editor.textReadOnly) {
                  if (e.keyCode >= 49 && e.keyCode <= 57 || e.keyCode >= 97 && e.keyCode <= 105 && column.editor.useNumkey) {
                    var number = e.keyCode >= 49 && e.keyCode <= 57 ? e.keyCode - 49 : e.keyCode - 97;
                    if (column.editor && column.editor.dataSelectable) {
                      if (column.editor.values.length > number) {
                        self.setCellValue(
                        self.select(),
                        column.fieldName,
                        column.editor.values[number]);

                        e.preventDefault();
                      }
                    } else {
                      if (column.values.length > number) {
                        self.setCellValue(self.select(), column.fieldName, column.values[number]);
                        e.preventDefault();
                      }
                    }
                  }
                }
              }
              if (column.editor.type.toLowerCase() === "zipcodepicker" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
              }
              if (column.editor.type.toLowerCase() === "month" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
                if (e.keyCode === 13) {
                  if (self._grid._gv._editController._editor._datetimeFormat && self._grid.getEditValue() === self._grid._gv._editController._editor._datetimeFormat.replace(/[A-z]/gi, "_") && ($.type(self._grid.getValue(self.select(), self.getCurrentColumn())) === "undefined" || self._grid.getValue(self.select(), self.getCurrentColumn()) === null)) {
                    self.commitCell();
                    self.setCellValue(self.select(), self.getCurrentColumn(), new Date());
                  } else if (column.monthpicker.dateView._value && column.monthpicker.dateView._value.toString() !== column.monthpicker.dateView._current.toString()) {
                    self.commitCell();
                    self.setCellValue(
                    self.select(),
                    self.getCurrentColumn(),
                    new Date(column.monthpicker.dateView._current));

                  }
                }
                if (e.keyCode < 41 && e.keyCode > 36 && $.type(self._grid.getEditValue()) !== "undefined") {
                  e.preventDefault();
                  column.monthpicker.kendoInstance._keydown(e);
                }
              }
              if (column.editor.type.toLowerCase() === "year" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
                if (e.keyCode === 13) {
                  if (self._grid._gv._editController._editor._datetimeFormat && self._grid.getEditValue() === self._grid._gv._editController._editor._datetimeFormat.replace(/[A-z]/gi, "_") && ($.type(self._grid.getValue(self.select(), self.getCurrentColumn())) === "undefined" || self._grid.getValue(self.select(), self.getCurrentColumn()) === null)) {
                    self.commitCell();
                    self.setCellValue(self.select(), self.getCurrentColumn(), new Date());
                    column.yearpicker.kendoInstance._keydown(e);
                  } else if (column.yearpicker.dateView._value && column.yearpicker.dateView._value.toString() !== column.yearpicker.dateView._current.toString()) {
                    self.commitCell();
                    self.setCellValue(
                    self.select(),
                    self.getCurrentColumn(),
                    new Date(column.yearpicker.dateView._current));

                    column.yearpicker.kendoInstance._keydown(e);
                  }
                }
                if (e.keyCode < 41 && e.keyCode > 36 && $.type(self._grid.getEditValue()) !== "undefined") {
                  e.preventDefault();
                  column.yearpicker.kendoInstance._keydown(e);
                }
              }
              if (column.editor.type.toLowerCase() === "time" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
                if (e.keyCode === 13) {
                  column.timepicker.kendoInstance._keydown(e);
                  self.commitCell();
                }
                if (e.keyCode < 41 && e.keyCode > 36 && $.type(self._grid.getEditValue()) !== "undefined") {
                  e.preventDefault();
                  column.timepicker.kendoInstance._keydown(e);
                }
              }
            }
          }
        });
        if (self.options.dataSource && self.options.dataSource.dataProvider) {
          self.options.dataSource.dataProvider._dp.setRows = setRow(
          self,
          self.options.dataSource.dataProvider._dp.setRows);

          self.options.dataSource.dataProvider._dp.insertRows = insertRows(
          self,
          self.options.dataSource.dataProvider._dp.insertRows);

          self.options.dataSource.dataProvider._dp.insertRow = insertRow(
          self,
          self.options.dataSource.dataProvider._dp.insertRow);

        }
        self._grid._gv._container._defaultTool._checkCellClicked = function (cell, event) {
          var grid2 = this.grid();
          var dewsGrid = $(grid2._container._containerDiv).closest(".dews-data-control").data("dews-control");
          if (grid2.editOptions().isCheckable()) {
            var checkBar = grid2.checkBar();
            var item = cell.item();
            if (event && event.shiftKey && this._prevCheckIndex && !checkBar.isExclusive() && dewsGrid.options.shiftCheck) {
              var prevItem = this._prevCheckIndex.item();
              var idx1 = Math.min(prevItem._index, item._index),idx2 = Math.max(prevItem._index, item._index),itemIndicies = [];
              for (var idx = idx1; idx <= idx2; idx++) {
                item = grid2.getItem(idx);
                item.isCheckable() && item.dataRow() >= 0 && itemIndicies.push(item);
              }
              itemIndicies.length > 0 && grid2.itemSource().checkItems(itemIndicies, prevItem.isChecked(), true);
            } else {
              if (item.isCheckable() && (checkBar.isShowGroup() || item.dataRow() >= 0)) {
                grid2.makeItemVisible(item.index());
                grid2.itemSource().checkItem(item, !item.isChecked(), checkBar.isExclusive(), true);
              }
            }
          }
        };
        if (dews.ui.page.onegridData && dews.ui.page.onegridData.editable) {
          self.$element.find(".dews-grid-edit-button").on("click", function (e) {
            var fixedOptions = self._grid.getFixedOptions();
            var fixedColumns = dews.ui.gridUtil.getFixedColumns(self);
            self._onegrid.fixed = {
              colCount: fixedOptions.colCount,
              rightColCount: fixedOptions.rightColCount,
              leftColumns: fixedColumns.leftColumns,
              rightColumns: fixedColumns.rightColumns
            };
            self._onegrid.loadColumns = dews.ui.gridUtil.setOnegridDialogColumns(self, self._onegrid.loadColumns);
            var dlg = new ColumnDialog(self);
            dlg.columnDialog.open();
          });
        }
        self._grid._gv._clipboardManager.$_convertValue = dews.ui.gridUtil.extend__$_convertValue(
        self._grid._gv._clipboardManager.$_convertValue);

        self._grid._gv._clipboardManager.$_pasteSingleCell = dews.ui.gridUtil.extend__$_pasteSingleCell(
        self._grid._gv._clipboardManager.$_pasteSingleCell,
        self._grid._gv._clipboardManager);

        self._grid._gv._clipboardManager.$_cellWritable = dews.ui.gridUtil.extend__$_cellWritable(
        self._grid._gv._clipboardManager.$_cellWritable,
        self._grid._gv._clipboardManager);

      } }]);return GridEvent;}(Event);

  function findUserOptionsColumn5(columns, fieldName, userColumn) {
    if (!columns)
    return null;
    for (var index = 0; index < columns.length; index++) {
      if (userColumn === void 0) {
        if (columns[index].field === fieldName) {
          userColumn = columns[index];
        } else if (columns[index].columns) {
          userColumn = findUserOptionsColumn5(columns[index].columns, fieldName, userColumn);
        }
      }
    }
    return userColumn;
  }
  function getSelectionColumns(cols, start, end, isSelectionColumn) {
    var result = {
      columns: [],
      isSelectionColumn: isSelectionColumn
    };
    for (var i = 0; i < cols.length; i++) {
      var col = cols[i];
      isSelectionColumn = !isSelectionColumn && start === col ? true : isSelectionColumn;
      if (col.columns) {
        var c = getSelectionColumns(col.columns, start, end, isSelectionColumn);
        isSelectionColumn = c.isSelectionColumn;
        var column = {
          field: col.name,
          columns: c.columns
        };
        if (c.columns.length > 0) {
          result.columns.push(column);
        }
      } else if (isSelectionColumn) {
        result.columns.push(col);
      }
      isSelectionColumn = isSelectionColumn && end === col ? false : isSelectionColumn;
    }
    result.isSelectionColumn = isSelectionColumn;
    return result;
  }

  // src/js/grid/event/treeGridEvent.js
  var TreeGridEvent = /*#__PURE__*/function (_Event4) {"use strict";_inherits(TreeGridEvent, _Event4);var _super11 = _createSuper(TreeGridEvent);
    function TreeGridEvent(grid2) {_classCallCheck(this, TreeGridEvent);return _super11.call(this,
      grid2);
    }_createClass(TreeGridEvent, [{ key: "initialize", value:
      function initialize() {
        _get(_getPrototypeOf(TreeGridEvent.prototype), "initialize", this).call(this);
        this._bindEvent();
      } }, { key: "_bindEvent", value:
      function _bindEvent() {
        var self = this.grid;
        var observer = new MutationObserver(function (mutations) {
          mutations.forEach(function (mutation) {
            if (mutation.attributeName === "style") {
              if (/display:\s?none/i.test(mutation.oldValue)) {
                if ($(mutation.target).is(":visible")) {
                  self._grid.resetSize();
                }
              }
            } else if (mutation.attributeName === "class") {
              if ($(mutation.target).is(":visible")) {
                self._grid.resetSize();
              }
            }
          });
        });
        self.$element.parentsUntil("body").each(function (idx, item) {
          observer.observe(item, {
            attributes: true,
            attributeOldValue: true,
            attributeFilter: ["style", "class"]
          });
        });
        if (dews.app && dews.app.menuSectionResized) {
          dews.app.menuSectionResized.on(function () {
            self._grid.resetSize();
          });
        }
        if (self.options.dataSource && self.options.dataSource.dataProvider) {
          self.options.dataSource.dataProvider._dp.setJsonRows = setJsonRows(
          self,
          self.options.dataSource.dataProvider._dp.setJsonRows);

          self.options.dataSource.dataProvider._dp.createRow = createRow(
          self,
          self.options.dataSource.dataProvider._dp.createRow);

        }
        self._grid.onImageButtonClicked = function (treeGrid, itemIndex, column, buttonIndex, name) {
          var parameter = {
            treegrid: self,
            row: {
              index: self._grid.getDataRow(itemIndex),
              data: self.dataItem(self._grid.getDataRow(itemIndex))
            },
            cell: {
              field: column.fieldName,
              data: self.getCellValue(self._grid.getDataRow(itemIndex), column.fieldName)
            }
          };
          dews.ui.gridUtil.onImageButtonClicked(self, itemIndex, column, parameter);
        };
        self.options._gridCallback = function (data, column, index) {
          dews.ui.gridUtil._gridCallback(self, data, column, index);
        };
        self._grid.onLinkableCellClicked = function (treeGrid, index, url) {
          var linkUrl = self.dataItem(index.dataRow)[self.columns[index.column].formats.urlField],parameter = {
              treegrid: self,
              row: {
                index: index.dataRow,
                data: self.dataItem(index.dataRow)
              },
              cell: {
                field: index.column,
                data: self.getCellValue(index.dataRow, index.column)
              }
            };
          dews.ui.gridUtil.onLinkableCellClicked(self, index, linkUrl, parameter);
        };
        self._grid.onShowEditor = function (id, index) {
          var parameter = {
            treegrid: self,
            row: {
              index: index.dataRow === -1 ? index.itemIndex : index.dataRow
            },
            cell: {
              field: index.fieldName
            }
          };
          window.addEventListener("scroll", windowScroll);
          return dews.ui.gridUtil.onShowEditor(self, id, index, parameter);
        };
        self._grid.onHideEditor = function (treeGrid, index) {
          if (self.options.commit) {
            dews.ui.gridUtil.onHideEditor(self, treeGrid, index);
            window.removeEventListener("scroll", windowScroll);
          }
          setTimeout(function () {var _self$columns$fieldNa10, _self$columns$fieldNa11, _self$columns$fieldNa12;
            var fieldName = index.fieldName;
            if (((_self$columns$fieldNa10 = self.columns[fieldName]) === null || _self$columns$fieldNa10 === void 0 ? void 0 : (_self$columns$fieldNa11 = _self$columns$fieldNa10.editor) === null || _self$columns$fieldNa11 === void 0 ? void 0 : (_self$columns$fieldNa12 = _self$columns$fieldNa11.type) === null || _self$columns$fieldNa12 === void 0 ? void 0 : _self$columns$fieldNa12.toLowerCase()) === "codepicker") {
              $(window).trigger("enableMainArea");
            }
          }, 300);
          self.options.commit = false;
        };
        self._grid.onSelectionEnded = function (treeGrid) {
          if (dews.ui.page.option === void 0 && dews.ui.page.useGridNote === "Y") {
            var selectDataIndex = treeGrid.getSelection().startRow;
            noteMain(treeGrid, selectDataIndex);
          }
        };
        self._grid.onCurrentRowChanged = function (treeGrid, oldIndex, newIndex) {
          if (self.options.dataBounding || self.options.master && newIndex === -1 || $.type(self.options.remove) === "boolean") {
            self._grid.onCurrentChanging.call(self, self._grid, self._grid.getCurrent(), self._grid.getCurrent());
            self.options.rowChange = true;
            self._grid.onCurrentChanged.call(self, self._grid, self._grid.getCurrent());
          }
        };
        self._grid.onCurrentChanging = function (treeGrid, oldIndex, newIndex) {var _columns$editor10, _columns$editor10$typ, _columns$editor11, _columns$editor11$mas, _columns$editor12;
          var dataRow = self._grid.getDataRow(newIndex.itemIndex);
          self.options.rowChange = false;
          if (newIndex.dataRow === -1 ? oldIndex.itemIndex !== newIndex.itemIndex : oldIndex.dataRow !== newIndex.dataRow) {
            self.options.rowChange = true;
          }
          self.options.isDataBound = self.options.dataBounding === true;
          self.options.previousData = self.dataItem(self._grid.getDataRow(oldIndex.itemIndex));
          self.options.previous = oldIndex;
          if (oldIndex.dataRow !== -1 && self.focused) {
            self.setFocus();
          }
          if (newIndex.dataRow === -1) {
            if (self._grid.getItemState(newIndex.itemIndex) === "appending") {
              self.commitCell();
              dataRow = newIndex.itemIndex;
            }
          }
          var columns = self.columns[newIndex.fieldName];
          var filterArr;
          if (treeGrid.getColumnProperty(newIndex.column, "editor") && newIndex.fieldIndex !== -1 && self.dataItem(dataRow)) {
            if (columns !== null && columns !== void 0 && columns.editor && self.options.dataSource) {var _filterArr6;
              var editor;
              var visible;
              var rowEditable;
              var parameter = {
                treegrid: self,
                row: {
                  index: dataRow,
                  data: self.dataItem(dataRow)
                },
                cell: {
                  field: newIndex.fieldName
                }
              };
              filterArr = newIndex !== null && newIndex !== void 0 && newIndex.fieldName ? self._grid.getActiveColumnFilters(newIndex.fieldName, true) : null;
              if (treeGrid.getSortedFields() !== null || ((_filterArr6 = filterArr) === null || _filterArr6 === void 0 ? void 0 : _filterArr6.length) > 0) {
                parameter.row.index = newIndex.itemIndex;
                parameter.row.data = self._grid.getValues(newIndex.itemIndex);
              }
              if (typeof columns.editable === "boolean" && !columns.editable && columns.editor.type.toLowerCase() !== "check") {
                editor = columns.editable;
              } else {
                editor = typeof columns.editor.editable === "function" ? columns.editor.editable.call(self, parameter) : columns.editor.editable;
              }
              columns.editor.editResult = editor;
              rowEditable = typeof self.options.rowEditable === "function" ? self.options.rowEditable.call(self, parameter) : self.options.rowEditable;
              self.rowEditable = rowEditable;
              if (self.options.editable) {
                if (typeof rowEditable === "boolean") {
                  columns.editor.flag = rowEditable !== true;
                }
                if (columns.editable && typeof columns.editor.editable === "function" && editor) {
                  self._grid.setColumnProperty(newIndex.fieldName, "editable", editor);
                }
              }
              switch (columns.editor.type.toLowerCase()) {
                case "codepicker":
                case "zipcodepicker":
                case "time":
                case "month":
                case "year":
                  visible = "visible";
                  if (!editor) {
                    visible = "hidden";
                  }
                  if (rowEditable === false) {
                    visible = "hidden";
                  }
                  if (!self.options.edit.editable) {
                    visible = "hidden";
                  }
                  columns.buttonVisibility = visible;
                  self._grid.setColumnProperty(columns.name, "buttonVisibility", visible);
                  break;}

              if (columns.editor.type.toLowerCase() === "check") {
                var options = self._grid.getColumnProperty(columns.name, "renderer");
                if (typeof rowEditable === "boolean" && rowEditable === false) {
                  self._grid.setColumnProperty(
                  columns.name,
                  "renderer",
                  $.extend(true, options, { editable: rowEditable }));

                } else {
                  self._grid.setColumnProperty(
                  columns.name,
                  "renderer",
                  $.extend(true, options, { editable: editor }));

                }
              }
              if (columns.editable && editor) {
                if (typeof self.options.rowEditable === "undefined" || rowEditable || rowEditable !== false) {
                  self._grid.setColumnProperty(columns.name, "editable", true);
                } else {
                  self._grid.setColumnProperty(columns.name, "editable", false);
                }
              } else {
                self._grid.setColumnProperty(columns.name, "editable", false);
              }
            }
          }
          if ((columns === null || columns === void 0 ? void 0 : (_columns$editor10 = columns.editor) === null || _columns$editor10 === void 0 ? void 0 : (_columns$editor10$typ = _columns$editor10.type) === null || _columns$editor10$typ === void 0 ? void 0 : _columns$editor10$typ.toLowerCase()) === "dropdown" && typeof columns.editor.dataSource === "function" && self.dataItem(dataRow)) {var _datasource$transport3, _datasource$transport4;
            var col = self._grid.columnByField(columns.fieldName);
            var e = {
              treegrid: self,
              row: {
                index: dataRow,
                data: self.dataItem(dataRow)
              }
            };
            var datasource = columns.editor.dataSource.call(self, e);
            col.values = [];
            col.labels = [];
            if (typeof col.editor === "string" && col.editor === "dropDown") {
              col.editor = {
                type: "dropDown",
                values: [],
                labels: []
              };
            }
            if ((datasource === null || datasource === void 0 ? void 0 : (_datasource$transport3 = datasource.transport) === null || _datasource$transport3 === void 0 ? void 0 : (_datasource$transport4 = _datasource$transport3.data) === null || _datasource$transport4 === void 0 ? void 0 : _datasource$transport4.length) > 0) {
              for (var l = 0; l < datasource.transport.data.length; l += 1) {
                col.values.push(datasource.transport.data[l][columns.editor.dataValueField]);
                col.labels.push(datasource.transport.data[l][columns.editor.dataTextField]);
                if (columns.editor.dataSelectable && datasource.transport.data[l][columns.editor.dataSelectable.field] !== columns.editor.dataSelectable.falseValue) {
                  col.editor.values.push(datasource.transport.data[l][columns.editor.dataValueField]);
                  col.editor.labels.push(datasource.transport.data[l][columns.editor.dataTextField]);
                }
              }
              col.labelField = typeof columns.editor.textField === "undefined" ? columns.editor.dataTextField : columns.editor.textField;
              col.lookupDisplay = true;
              self._grid.setColumn(col);
            } else {
              var fetchData;
              datasource.col = col;
              datasource.fetch(function () {
                fetchData = this;
              }).done(function () {
                var dropdownColumn = self.columns[fetchData.col.fieldName];
                $.each(fetchData.data(), function (idx, data) {
                  fetchData.col.values.push(data[dropdownColumn.editor.dataValueField]);
                  fetchData.col.labels.push(data[dropdownColumn.editor.dataTextField]);
                  if (dropdownColumn.editor.dataSelectable && data[dropdownColumn.editor.dataSelectable.field] !== dropdownColumn.editor.dataSelectable.falseValue) {
                    fetchData.col.editor.values.push(data[dropdownColumn.editor.dataValueField]);
                    fetchData.col.editor.labels.push(data[dropdownColumn.editor.dataTextField]);
                  }
                });
                fetchData.col.labelField = typeof dropdownColumn.editor.textField === "undefined" ? dropdownColumn.editor.dataTextField : dropdownColumn.editor.textField;
                fetchData.col.lookupDisplay = true;
                self._grid.setColumn(fetchData.col);
                fetchData.transport.data = fetchData.data();
                delete fetchData.col;
              });
            }
          }
          if (columns !== null && columns !== void 0 && (_columns$editor11 = columns.editor) !== null && _columns$editor11 !== void 0 && (_columns$editor11$mas = _columns$editor11.mask) !== null && _columns$editor11$mas !== void 0 && _columns$editor11$mas.allowEmpty && typeof columns.editor.format === "function" && self.dataItem(newIndex.dataRow)) {
            var maskParams = {
              grid: self,
              row: {
                index: newIndex.dataRow,
                data: self.dataItem(newIndex.dataRow)
              },
              cell: {
                field: newIndex.column,
                data: self.getCellValue(newIndex.dataRow, newIndex.column)
              }
            };
            var maskEditFormat = columns.editor.format.call(self, maskParams);
            if (typeof maskEditFormat === "string" && maskEditFormat !== "") {
              self._grid.setColumnProperty(self._grid.columnByField(columns.field), "editorOptions", {
                mask: { editMask: maskEditFormat }
              });
            } else {
              self._grid.setColumnProperty(self._grid.columnByField(columns.field), "editorOptions", {
                mask: null
              });
            }
          }
          if ((columns === null || columns === void 0 ? void 0 : (_columns$editor12 = columns.editor) === null || _columns$editor12 === void 0 ? void 0 : _columns$editor12.type) === "number" && typeof columns.editor.currency === "function" && self.dataItem(newIndex.itemIndex + 1)) {var _dews$ui$page10;
            var params = {
              grid: self,
              row: {
                index: newIndex.dataRow,
                data: self.dataItem(newIndex.dataRow)
              },
              cell: {
                field: newIndex.column,
                data: self.getCellValue(newIndex.dataRow, newIndex.column)
              }
            };
            columns.editor.preCurrency = columns.editor.currency.call(self, params);
            var env = ((_dews$ui$page10 = dews.ui.page) === null || _dews$ui$page10 === void 0 ? void 0 : _dews$ui$page10.env) && dews.ui.page.env[columns.editor.preFormat];
            var currencyFormat = dews.getCurrencyFormat(columns.editor);
            var formats = "#,###.##";
            if (env) {
              formats = env.format;
            }
            if (_typeof(currencyFormat) === "object") {
              formats = currencyFormat.format;
            }
            var columnInfo = self._grid.columnByField(columns.field);
            var editorOptions = self._grid.getColumnProperty(columnInfo, "editorOptions", true);
            editorOptions.editFormat = formats;
            self._grid.setColumnProperty(columnInfo, "editorOptions", editorOptions);
          }
          var column = self.options.columns;
          if (self.options.dataBounding) {
            var dataBoundParameter = {
              treegrid: self,
              row: {
                data: self.options.dataSource.data()
              },
              column: column
            };
            var dataBoundEvent = new $.Event("dataBound", dataBoundParameter);
            self.$element.trigger(dataBoundEvent);
            delete self.options.dataBounding;
            self._setCriteria();
            if (self.options.note) {
              self._gridNote.boundingDraw(treeGrid, self, dataBoundParameter);
            }
          }
          if (typeof self.options.previousData === "undefined") {
            self.options.previousData = "";
          }
          if (typeof self.options.previous === "undefined") {
            self.options.previous = newIndex;
          }
          var changingParameter = {
            treegrid: self,
            isDataBound: self.options.isDataBound,
            row: {
              next: {
                index: newIndex.dataRow,
                data: self.dataItem(dataRow)
              },
              isChange: self.options.rowChange,
              index: oldIndex.dataRow !== -1 ? oldIndex.dataRow : oldIndex.itemIndex,
              data: self.dataItem(oldIndex.dataRow)
            },
            cell: {
              next: {
                field: newIndex.fieldName,
                data: self._grid.getValue(dataRow, newIndex.fieldName)
              },
              field: oldIndex.fieldName
            }
          };
          var event = new $.Event("changing", changingParameter);
          self.$element.trigger(event);
          if (event.isDefaultPrevented()) {
            return false;
          }
        };
        self._grid.onCurrentChanged = function (treeGrid, newIndex) {
          var index = self._grid.getDataRow(newIndex.itemIndex);
          if ($.type(self.options.add) === "boolean" && self.options.add && !self.options.filterClearing) {
            if (self.options.dataSource) {
              var addParameter, addEvent;
              addParameter = {
                treegrid: self,
                row: {
                  index: newIndex.dataRow,
                  data: self.dataItem(self.select())
                }
              };
              addEvent = new $.Event("rowAdd", addParameter);
              self.$element.trigger(addEvent);
              self.options.add = false;
            }
          }
          var data;
          if (newIndex.itemIndex > -1 && newIndex.fieldIndex > -1) {
            data = self._grid.getValue(newIndex.itemIndex, newIndex.fieldName);
          }
          var parameter = {
            treegrid: self,
            isDataBound: self.options.isDataBound,
            row: {
              index: index,
              data: self.dataItem(index),
              isChange: self.options.rowChange,
              previous: {
                index: self.options.previous.dataRow,
                data: self.dataItem(self.options.previous.dataRow)
              }
            },
            cell: {
              field: newIndex.fieldName,
              data: data,
              previous: {
                field: self.options.previous.fieldName
              }
            }
          };
          var event = new $.Event("change", parameter);
          $("#" + treeGrid.name).trigger(event);
          delete self.options.isDataBound;
          if (dews.ui.page && dews.ui.page.hasUserGuide) {
            if ($.isFunction(dews.ui.page.focusGuideItem) && newIndex.column) {
              dews.ui.page.focusGuideItem("#" + newIndex.column);
            }
          }
          if (self._grid.getSelectOptions().style !== "none") {
            var ids = ["selection"];
            self._grid.removeCellStyles(ids);
            var background = self.options.gridStyle.selection.focusBackgroundColor;
            if ($.type(self.columns[newIndex.column]) !== "undefined" && $.type(self.columns[newIndex.column].attributes) !== "undefined") {
              if (self.columns[newIndex.column].attributes["class"] === "required") {
                background = self.options.gridStyle.body.requiredFocusBackground;
              } else if (self.columns[newIndex.column].attributes["class"] === "readonly") {
                background = self.options.gridStyle.body.readonlyFocusBackground;
              }
            }
            if (self._grid.getCellStyle(index, newIndex.fieldIndex) === "editable") {
              self._grid.addCellStyle(
              "selection",
              {
                editable: false,
                background: background
              },
              true);

              self._grid.setCellStyle(index, newIndex.fieldIndex, "selection");
            } else {
              self._grid.addCellStyle(
              "selection",
              {
                background: background
              },
              true);

              self._grid.setCellStyle(index, newIndex.fieldIndex, "selection");
            }
          } else {
            self._grid.removeCellStyles(["selection"]);
          }
          var column = self.columns[newIndex.fieldName];
          if (column && column.editor) {
            if (column.editor.type.toLowerCase() === "dropdown" && column.editor.editResult && column.editor.autoOpen === true) {
              self.editCell();
            }
          }
        };
        self._grid.onCellEdited = function (treeGrid, itemIndex, dataRow, field) {
          var fields = self.options.dataSource.dataProvider.getFieldName(field);
          var column = dews.ui.gridUtil.findColumn(self.options.columns, fields);
          if (column && column.editor && column.editor.type.toLowerCase() === "time") {
            if (treeGrid.getEditingItem() && treeGrid.getEditingItem().values[column.fieldName]) {
              if (!column.displayRegExp.test(treeGrid.getEditingItem().values[column.fieldName])) {
                self.options.commit = true;
                self._grid.commit();
                self.setCellValue(dataRow, column.fieldName, "");
              }
            }
          }
          self.options.commit = true;
          self._grid.commit();
          self.editable = false;
          if (column && column.editor && column.editor.type.toLowerCase() === "dropdown" && $.type(column.editor.dataSource) === "function") {
            var col = self._grid.columnByField(column.fieldName),e = {
                treegrid: self,
                row: {
                  data: self.dataItem(dataRow),
                  index: dataRow
                }
              },datasource = column.editor.dataSource.call(self, e);
            col.values = [];
            col.labels = [];
            if (typeof col.editor === "string" && col.editor === "dropDown") {
              col.editor = {
                type: "dropDown",
                values: [],
                labels: []
              };
            }
            if (datasource && datasource.transport && datasource.transport.data && datasource.transport.data.length > 0) {
              var index = {
                  itemIndex: itemIndex,
                  dataRow: dataRow,
                  fieldIndex: field,
                  column: column.field,
                  fieldName: column.field
                },editResult = {
                  text: "",
                  value: self.getCellValue(dataRow, column.field)
                };
              for (var l = 0; l < datasource.transport.data.length; l += 1) {
                col.values.push(datasource.transport.data[l][column.editor.dataValueField]);
                col.labels.push(datasource.transport.data[l][column.editor.dataTextField]);
                if (column.editor.dataSelectable && datasource.transport.data[l][column.editor.dataSelectable.field] !== column.editor.dataSelectable.falseValue) {
                  col.editor.values.push(datasource.transport.data[l][column.editor.dataValueField]);
                  col.editor.labels.push(datasource.transport.data[l][column.editor.dataTextField]);
                }
                if (datasource.transport.data[l][column.editor.dataValueField] === editResult.value) {
                  editResult.text = datasource.transport.data[l][column.editor.dataTextField];
                }
              }
              if ($.type(column.editor.textField) === "undefined") {
                col.labelField = column.editor.dataTextField;
              } else {
                col.labelField = column.editor.textField;
              }
              col.lookupDisplay = true;
              self._grid.setColumn(col);
              self._grid.onGetEditValue.call(self, self._grid, index, editResult);
            }
          }
          var event,parameter,subSave = true;
          if ($.type(arguments[4]) === "boolean") {
            subSave = arguments[4];
          }
          parameter = {
            treegrid: self,
            row: {
              index: self._grid.getDataRow(itemIndex),
              data: self.dataItem(self._grid.getDataRow(itemIndex))
            },
            cell: {
              field: $.type(column) === "undefined" ? fields : column.field
            }
          };
          if ($.type(arguments[4]) === "boolean") {
            subSave = arguments[4];
          }
          if (subSave) {
            if (parameter.row.index === -1 && parameter.row.data === void 0) {
              parameter.row.index = dataRow;
              parameter.row.data = self.dataItem(dataRow);
            }
            event = new $.Event("save", parameter);
            $("#" + treeGrid.name).trigger(event);
          }
        };
        self._grid.onValidateColumn = function (treeGrid, column, inserting, value) {
          var event,parameter = {
              treegrid: self,
              cell: {
                field: column.fieldName,
                data: value
              },
              row: {
                index: self._grid.getCurrent().itemIndex
              }
            };
          if (column.fieldName === treeGrid.getCurrent().fieldName) {
            event = new $.Event("validationCheck", parameter);
            $("#" + treeGrid.name).trigger(event);
          }
        };
        self._grid.onContextMenuPopup = function (treeGrid, x, y, elementName) {
          if (elementName === "DataCell" && self.options.dataSource) {
            var currentCell = treeGrid.mouseToIndex(x, y),displayIndex = [],items = [],dataRow = self._grid.getDataRow(currentCell.dataRow),parameter = {
                treegrid: self,
                row: {
                  index: dataRow,
                  data: self.dataItem(dataRow)
                },
                cell: {
                  field: currentCell.fieldName,
                  data: treeGrid.getValue(dataRow, currentCell.fieldName)
                }
              };
            dews.ui.gridUtil.onContextMenuPopup(self, currentCell, parameter);
          } else {
            return false;
          }
        };
        self._grid.onContextMenuItemClicked = function (treeGrid, label, index) {
          if (self.options.dataSource) {
            var rowId = self._grid.getDataRow(index.itemIndex);
            var parameter = {
              treegrid: self,
              row: {
                index: rowId,
                data: self.dataItem(rowId)
              },
              cell: {
                field: index.fieldName,
                data: treeGrid.getValue(index.dataRow, index.fieldName)
              }
            };
            dews.ui.gridUtil.onContextMenuItemClicked(self, index, label, parameter);
          }
        };
        self._grid.onItemChecked = function (treeGrid, itemIndex, checked) {
          var dataIndex = self._grid.getDataRow(itemIndex);
          var event;
          var parameter = {
            treegrid: self,
            row: {
              index: dataIndex,
              data: self.dataItem(dataIndex)
            },
            cell: {
              isClicked: checked,
              header: {
                isClicked: false
              }
            }
          };
          if (self.options.childNodesCheck) {
            self._grid.checkChildren(itemIndex, checked, true, false, true, true);
          }
          event = new $.Event("selected", parameter);
          self.$element.trigger(event);
        };
        self._grid.onItemsChecked = function (treeGrid, items, checked) {
          var checkedItemIndex = [];
          var event;
          var parameter;
          $.each(items, function (index, data) {
            checkedItemIndex.push(self._grid.getDataRow(data));
          });
          parameter = {
            treegrid: self,
            row: {
              index: checkedItemIndex,
              data: self.dataItems(checkedItemIndex)
            },
            cell: {
              isClicked: checked,
              header: {
                isClicked: false
              }
            }
          };
          if (checked || self.options.shiftCheck) {
            event = new $.Event("selected", parameter);
            self.$element.trigger(event);
          }
        };
        self._grid.onItemAllChecked = function (treeGrid, checked) {
          var checkedIndex = self.getCheckedIndex();
          var event;
          var parameter = {
            treegrid: self,
            row: {
              index: checkedIndex,
              data: self.dataItems()
            },
            cell: {
              isClicked: checked,
              header: {
                isClicked: true
              }
            }
          };
          event = new $.Event("selected", parameter);
          self.$element.trigger(event);
        };
        self._grid.onGetEditValue = function (treeGrid, index, editResult) {
          dews.ui.gridUtil.onGetEditValue(self, index, editResult);
        };
        self._grid.onDataCellClicked = function (treeGrid, index) {
          var dataRow = self._grid.getDataRow(index.itemIndex),parameter = {
              treegrid: self,
              row: {
                index: dataRow,
                data: self.dataItem(dataRow)
              },
              cell: {
                field: index.fieldName,
                data: self.getCellValue(dataRow, index.fieldName)
              }
            };
          var event = new $.Event("clicked", parameter);
          self.$element.trigger(event);
        };
        self._grid.onDataCellDblClicked = function (treeGrid, index) {
          var dataRow = self._grid.getDataRow(index.itemIndex),dblParameter = {
              treegrid: self,
              row: {
                index: dataRow,
                data: self.dataItem(dataRow)
              },
              cell: {
                field: index.fieldName,
                data: self.getCellValue(dataRow, index.fieldName)
              }
            };
          var dblEvent = new $.Event("dblClicked", dblParameter);
          self.$element.trigger(dblEvent);
        };
        self._grid.onKeyDown = function (treeGrid, key, ctrl, shift, alt) {
          var currentColumn = self._grid.getCurrent().column;
          var currentIndex = self._grid.getCurrent().dataRow;
          if (key === 13 && self.options.requiredCheck && self.columns[currentColumn].attributes && self.columns[currentColumn].attributes["class"] === "required" && !self.getCellValue(currentIndex, currentColumn)) {
            return false;
          }
          if (key === 13 && self.columns[currentColumn].editor.type.toLowerCase() === "codepicker" && self.columns[currentColumn].codeOption.codesearch && $.type(self._grid.getEditValue()) === "undefined") {
            return false;
          }
          var parameter = {
              treegrid: self,
              keyCode: key,
              row: {
                index: self._grid.getDataRow(self._grid.getCurrent().itemIndex)
              },
              cell: {
                field: self._grid.getCurrent().column
              },
              ctrl: ctrl,
              shift: shift,
              alt: alt
            },event = $.Event("keyDown", parameter);
          self.$element.trigger(event);
          if (event.isDefaultPrevented()) {
            return false;
          }
          if (self._grid.getCheckBar().visible && self._grid.isCheckable(self._grid.getItemIndex(self.select())) && key === 32) {
            if (self._grid.isCheckedRow(self.select())) {
              self._grid.checkRow(self.select(), false, false);
            } else {
              self._grid.checkRow(self.select(), true, false);
            }
            return false;
          }
          var current = self._grid.getCurrent(),rowIndex = self._grid.getDataRow(current.itemIndex),rowData = self.dataItem(rowIndex),editParams = {
              grid: self,
              row: {
                index: rowIndex,
                data: rowData
              },
              cell: {
                field: ""
              }
            };
          if ($.type(self.options.editSkip) !== "undefined" && self.options.editSkip) {
            var disPlayColumn = self.options.displayColumns,i = 0,column,index = 0;
            $.each(disPlayColumn, function (idx, column2) {
              if (column2.field === current.column) {
                index = idx;
              }
            });
            if (key === 13 || !shift && key === 9) {
              for (var j = current.itemIndex; j < self._grid.getItemCount(); j += 1) {
                editParams.row.index = rowIndex;
                editParams.row.data = self.dataItem(self._grid.getDataRow(j));
                for (i = index + 1; i < disPlayColumn.length; i += 1) {
                  editParams.cell.field = disPlayColumn[i].fieldName;
                  column = self.columns[disPlayColumn[i].fieldName];
                  var condition;
                  if (column.editable) {
                    condition = $.type(self.options.rowEditable) !== "undefined" ? !column.editor.flag ? !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable")) || !($.type(self.options.rowEditable) === "function" ? self.options.rowEditable.call(self, editParams) : self.options.rowEditable) : !self.options.rowEditable.call(self, editParams) : !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable"));
                  } else {
                    condition = true;
                  }
                  if (!condition) {
                    if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                      self._grid.setCurrent({
                        itemIndex: j,
                        columns: column.fieldName,
                        dataRow: j,
                        fieldIndex: i,
                        fieldName: column.fieldName
                      });
                      return false;
                    }
                  } else if (i === disPlayColumn.length && j === self._grid.getItemCount() - 1) {
                    if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                      self.commitCell();
                      return false;
                    }
                  }
                }
                index = -1;
              }
            } else if (key === 39 && index !== disPlayColumn.length - 1) {
              for (i = index + 1; i < disPlayColumn.length; i += 1) {
                editParams.cell.field = disPlayColumn[i].fieldName;
                column = self.columns[disPlayColumn[i].fieldName];
                var condition;
                if (column.editable) {
                  condition = $.type(self.options.rowEditable) !== "undefined" ? !column.editor.flag ? !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable")) || !($.type(self.options.rowEditable) === "function" ? self.options.rowEditable.call(self, editParams) : self.options.rowEditable) : !self.options.rowEditable.call(self, editParams) : !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable"));
                } else {
                  condition = true;
                }
                if (!condition) {
                  if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                    self._grid.setCurrent({
                      itemIndex: self._grid.getCurrent().itemIndex,
                      columns: column.fieldName,
                      dataRow: self._grid.getCurrent().dataRow,
                      fieldIndex: i,
                      fieldName: column.fieldName
                    });
                    return false;
                  } else if (i === disPlayColumn.length - 1) {
                    if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                      return false;
                    }
                  }
                } else if (i === disPlayColumn.length - 1) {
                  return false;
                }
              }
            } else if (key === 37 && index !== 0) {
              for (i = index - 1; i >= 0; i -= 1) {
                editParams.cell.field = disPlayColumn[i].fieldName;
                column = self.columns[disPlayColumn[i].fieldName];
                var condition;
                if (column.editable) {
                  condition = $.type(self.options.rowEditable) !== "undefined" ? !column.editor.flag ? !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable")) || !($.type(self.options.rowEditable) === "function" ? self.options.rowEditable.call(self, editParams) : self.options.rowEditable) : !self.options.rowEditable.call(self, editParams) : !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable"));
                } else {
                  condition = true;
                }
                if (!condition) {
                  if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                    self._grid.setCurrent({
                      itemIndex: self._grid.getCurrent().itemIndex,
                      columns: column.fieldName,
                      dataRow: self._grid.getCurrent().dataRow,
                      fieldIndex: i,
                      fieldName: column.fieldName
                    });
                    return false;
                  } else if (i === 0) {
                    if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                      return false;
                    }
                  }
                } else if (i === 0) {
                  return false;
                }
              }
            }
          }
          if (shift && key === 9) {
            if (self.options.editSkip) {
              for (var row = self._grid.getItemIndex(rowIndex); row >= 0; row -= 1) {
                editParams.row.index = row;
                editParams.row.data = self.dataItem(self._grid.getDataRow(row));
                for (i = index - 1; i >= 0; i -= 1) {
                  editParams.cell.field = disPlayColumn[i].field;
                  column = self.columns[disPlayColumn[i].fieldName];
                  var condition;
                  if (column.editable) {
                    condition = $.type(self.options.rowEditable) !== "undefined" ? !column.editor.flag ? !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable")) || !($.type(self.options.rowEditable) === "function" ? self.options.rowEditable.call(self, editParams) : self.options.rowEditable) : !self.options.rowEditable.call(self, editParams) : !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable"));
                  } else {
                    condition = true;
                  }
                  if (!condition) {
                    if (column.editor && $.type(column.editor.editable) === "function" && column.editor.editable.call(self, editParams)) {
                      if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                        self._grid.setCurrent({
                          itemIndex: row,
                          fieldName: column.fieldName
                        });
                        return false;
                      }
                    } else if (column.editor && $.type(column.editor.editable) === "boolean") {
                      if ($.type(column.editSkip) === "undefined" || !column.editSkip) {
                        self._grid.setCurrent({
                          itemIndex: row,
                          fieldName: column.fieldName
                        });
                        return false;
                      }
                    }
                  }
                }
                index = self.options.displayColumns.length;
              }
            }
          }
        };
        self._grid.onKeyUp = function (treeGrid, key, ctrl, shift, alt) {
          var params = {
            grid: self,
            row: {
              index: self._grid.getCurrent().dataRow,
              data: self.dataItem(self._grid.getCurrent().dataRow)
            },
            cell: {
              field: self._grid.getCurrent().column,
              data: self.getCellValue(self._grid.getCurrent().dataRow, self._grid.getCurrent().column)
            },
            keyCode: key,
            ctrl: ctrl,
            shift: shift,
            alt: alt
          };
          var event = $.Event("keyUp", params);
          self.$element.trigger(event);
          if (key === 37 || key === 38 || key === 39 || key === 40) {
            if (dews.ui.page.option === void 0 && dews.ui.page.useGridNote === "Y") {
              self._grid.onSelectionEnded.call(self, self._grid);
            }
          }
        };
        self._grid.onTreeItemExpanding = function (treeGrid, itemIndex, rowId) {
          var params = {
            treegrid: self,
            row: {
              index: itemIndex + 1,
              data: self.dataItem(rowId)
            }
          };
          var event = new $.Event("expanding", params);
          self.$element.trigger(event);
        };
        self._grid.onTreeItemExpanded = function (treeGrid, itemIndex, rowId) {
          var newIndex = self._grid.getCurrent(),columns = self.columns[newIndex.fieldName];
          var filterArr;
          if (treeGrid.getColumnProperty(newIndex.column, "editor") && newIndex.fieldIndex !== -1 && self.dataItem(self.select())) {
            if (columns && columns.editor && columns.editor.editable && self.options.dataSource) {
              var editor,visible,parameter = {
                  treegrid: self,
                  row: {
                    index: self.select(),
                    data: self.dataItem(self.select())
                  },
                  cell: {
                    field: newIndex.fieldName
                  }
                };
              if (newIndex && newIndex.fieldName) {
                filterArr = self._grid.getActiveColumnFilters(newIndex.fieldName, true);
              } else {
                filterArr = null;
              }
              if ($.type(treeGrid.getSortedFields()) !== "null" || filterArr && filterArr.length > 0) {
                parameter.row.index = newIndex.itemIndex;
                parameter.row.data = self._grid.getValues(newIndex.itemIndex);
              }
              if ($.type(columns.editor.editable) === "function") {
                editor = columns.editor.editable.call(self, parameter);
              } else {
                editor = columns.editor.editable;
              }
              if (columns.editor.type.toLowerCase() === "codepicker") {
                visible = "visible";
                if (!editor) {
                  visible = "hidden";
                }
                columns.buttonVisibility = visible;
                self._grid.setColumnProperty(columns.name, "buttonVisibility", visible);
              }
              if (!editor) {
                self._grid.addCellStyle(
                "editable",
                {
                  editable: false
                },
                true);

                self._grid.setCellStyles(newIndex.dataRow, newIndex.fieldName, "editable");
              }
            }
          }
          var params = {
            treegrid: self,
            row: {
              index: itemIndex + 1,
              data: self.dataItem(rowId)
            }
          };
          var event = new $.Event("expanded", params);
          self.$element.trigger(event);
        };
        self._grid.onTreeItemCollapsing = function (treeGrid, itemIndex, rowId) {
          var params = {
            treegrid: self,
            row: {
              index: itemIndex + 1,
              data: self.dataItem(rowId)
            }
          };
          var event = new $.Event("collapsing", params);
          self.$element.trigger(event);
        };
        self._grid.onTreeItemCollapsed = function (treeGrid, itemIndex, rowId) {
          var params = {
            treegrid: self,
            row: {
              index: itemIndex + 1,
              data: self.dataItem(rowId)
            }
          };
          var event = new $.Event("collapsed", params);
          self.$element.trigger(event);
        };
        self._grid.setPasteOptions({
          eventEachRow: true
        });
        self._grid.onEditRowPasted = function (grid2, itemIndex, dataRow, fields, oldValues, newValues) {
          var className = ".dews-ui-treegrid";
          newValues = newValues.filter(function (value) {return value !== void 0;});
          var isCell = true;
          var copyData = self.clipboard.copyData;
          if (copyData.length < 2) {
            copyData = copyData.toString().split("\n");
          }
          self.clipboard.length = copyData.length;
          if (fields.length > 1 || copyData.length > 1) {
            isCell = false;
          }
          for (var i = 0; i < fields.length; i++) {
            var _newValues = newValues.slice(i, i + 1),fieldName = grid2._dataSource.getOrgFieldName(fields[i]),fieldIndex = fields[i];
            dews.ui.gridUtil.onEditRowPasted(self, itemIndex, fieldName, fieldIndex, _newValues, className, isCell);
          }
        };
        self._grid.onCopy = function (grid2, range, event) {
          self.clipboard = {
            grid: self,
            itemIndex: {
              start: range.startItem,
              end: range.endItem
            },
            column: {
              start: range.startColumn,
              end: range.endColumn
            },
            values: self._grid.getSelectionData()
          };
        };
        self._grid.onPaste = function (grid2, index, event) {
          var getText = $.type(event.clipboardData) === "undefined" ? window.clipboardData.getData("Text") : event.clipboardData.getData("Text");
          var checkLastNewLine = getText.substr(getText.length - 2) === "\r\n";
          if (checkLastNewLine) {
            getText = getText.substring(0, getText.length - 2);
          }
          var doubleData = getText.split("\r\n");
          for (var i = 0; i < doubleData.length; i++) {
            doubleData[i] = doubleData[i].split("	");
          }
          var pastingParams = {
            treegrid: self,
            copyData: doubleData,
            start: {
              index: index.dataRow,
              column: index.column
            }
          };
          self.clipboard = {
            copyData: doubleData,
            cnt: 0
          };
          var pastingEvent = new $.Event("pasting", pastingParams);
          self.$element.trigger(pastingEvent);
          if (pastingEvent.isDefaultPrevented()) {
            return false;
          }
          var returnValue = dews.ui.gridUtil.onPaste(self, index, event);
          return returnValue;
        };
        self._grid.onColumnHeaderClicked = function (grid2, column, rightClicked) {
          var parameter = {
            treegrid: self,
            cell: {
              field: column.fieldName
            }
          };
          var headerClicked = new $.Event("headerClicked", parameter);
          self.$element.trigger(headerClicked);
        };
        self._grid.onColumnCheckedChanged = function (grid2, column, check) {
          var params = {
              treegrid: self,
              cell: {
                field: column.fieldName
              },
              checked: check
            },i = 0,data = self.options.dataSource;
          if (column.editorOptions && column.editorOptions.type.toLowerCase() === "check") {
            var dataItems = self.sortDataItems(),rowCount = dataItems.length,userColumn = findUserOptionsColumn(self.userOptions.columns, column.fieldName),checkValue = check;
            if (check && column.editorOptions && column.editorOptions.trueValue) {
              checkValue = column.editorOptions.trueValue;
            } else if (!check && column.editorOptions && column.editorOptions.falseValue) {
              checkValue = column.editorOptions.falseValue;
            }
            self.options.dataSource.dataProvider.beginUpdate();
            try {
              for (i = 0; i < rowCount; i++) {
                var editParams = {
                  grid: self,
                  row: {
                    index: i + 1,
                    data: dataItems[i]
                  },
                  cell: {
                    field: column.fieldName
                  }
                };
                var cellEditable = true;
                if (self.options.rowEditable !== void 0) {
                  cellEditable = self.options.rowEditable.call(self, editParams);
                }
                if (userColumn !== void 0 && userColumn !== null) {
                  if (cellEditable && userColumn.editable === false) {
                    cellEditable = false;
                  }
                  if (cellEditable && userColumn.editor !== void 0 && typeof userColumn.editor.editable === "function") {
                    cellEditable = userColumn.editor.editable.call(self, editParams);
                  }
                  if (cellEditable && userColumn.editor !== void 0 && typeof userColumn.editor.editable === "boolean" && userColumn.editor.editable === false) {
                    cellEditable = false;
                  }
                }
                if (cellEditable) {
                  self._grid.setValue(i, column.fieldName, checkValue);
                }
              }
            } finally {
              self.options.dataSource.dataProvider.endUpdate(false);
            }
          }
          var event = $.Event("columnHeaderCheck", params);
          self.$element.trigger(event);
        };
        self._grid.onPasted = function (grid2) {
          var start,end,rows = [],result,columns = [],isSelectionColumn = false,startColumn,endColumn,selectionColumns;
          selectionColumns = self._grid.getSelection();
          start = selectionColumns !== null ? selectionColumns.startItem : self._grid.getCurrent().itemIndex;
          end = selectionColumns !== null ? selectionColumns.endItem : self._grid.getCurrent().itemIndex;
          startColumn = selectionColumns !== null ? selectionColumns.startColumn : "";
          endColumn = selectionColumns !== null ? selectionColumns.endColumn : "";
          for (var i = start; i <= end; i++) {
            rows.push(self._grid.getDataRow(i));
          }
          if (selectionColumns === null) {
            columns.push(self._grid.getCurrent().fieldName);
          } else {
            var displayColumns = self._grid.getDisplayColumns();
            result = getSelectionColumns2(displayColumns, startColumn, endColumn, isSelectionColumn);
            columns = result.columns;
          }
          if (self.options.copyMode === "row") {
            $.each(rows, function (index, row) {
              $.each(columns, function (idx, column) {
                var editParams = {
                  grid: self,
                  row: {
                    index: row,
                    data: self.dataItem(row)
                  },
                  cell: {
                    field: column,
                    data: self.getCellValue(row, column)
                  }
                };
                if (!self.columns[column].editable || $.type(self.columns[column].editor.editable) === "function" && !self.columns[column].editor.editable.call(self, editParams)) {
                }
              });
            });
          }
          var eventParameter = {
            treegrid: self,
            columns: columns,
            rows: rows
          };
          self._grid.commit();
          var pastedEvent = new $.Event("pasted", eventParameter);
          self.$element.trigger(pastedEvent);
        };
        if (self.options.dataSource && self.options.dataSource.dataProvider) {
          self.options.dataSource.dataProvider.onRowAdded = function (dataProvider, rowId) {
            self.expand(rowId, false);
            self._grid.setCurrent({
              itemIndex: self._grid.getItemIndex(rowId),
              column: self._grid.getCurrent().column,
              dataRow: rowId
            });
          };
        }
        self.$element.on("dataBound", function (e) {
          if (self.options.dataBound && $.type(self.options.dataBound) === "function" && e.treegrid) {
            self.options.dataBound.call(self, e);
          }
        });
        self.$element.on("changing", function (e) {
          if (self.options.changing && $.type(self.options.changing) === "function" && e.treegrid) {
            self.options.changing.call(self, e);
          }
        });
        self.$element.on("change", function (e) {
          if (self.options.change && $.type(self.options.change) === "function" && e.treegrid) {
            self.options.change.call(self, e);
          }
        });
        self.$element.on("rowAdd", function (e) {
          if (self.options.rowAdd && $.type(self.options.rowAdd) === "function" && e.treegrid) {
            self.options.rowAdd.call(self, e);
          }
        });
        self.$element.on("rowRemove", function (e) {
          if (self.options.rowRemove && $.type(self.options.rowRemove) === "function" && e.treegrid) {
            self.options.rowRemove.call(self, e);
          }
        });
        self.$element.on("save", function (e) {
          if (self.options.save && $.type(self.options.save) === "function" && e.treegrid) {
            self.options.save.call(self, e);
          }
        });
        self.$element.on("validationCheck", function (e) {
          if (self.options.validationCheck && $.type(self.options.validationCheck) === "function" && e.treegrid) {
            self.options.validationCheck.call(self, e);
          }
        });
        self.$element.on("cellEditing", function (e) {
          if (self.options.cellEditing && $.type(self.options.cellEditing) === "function" && e.treegrid) {
            self.options.editValue = self.options.cellEditing.call(self, e);
          }
        });
        self.$element.on("selected", function (e) {
          if (self.options.selected && $.type(self.options.selected) === "function" && e.treegrid) {
            self.options.selected.call(self, e);
          }
        });
        self.$element.on("clicked", function (e) {
          if (self.options.clicked && $.type(self.options.clicked) === "function" && e.treegrid) {
            self.options.clicked.call(self, e);
          }
        });
        self.$element.on("dblClicked", function (e) {
          if (self.options.dblClicked && $.type(self.options.dblClicked) === "function" && e.treegrid) {
            self.options.dblClicked.call(self, e);
          }
        });
        self.$element.on("keyDown", function (e) {
          if (self.options.keyDown && $.type(self.options.keyDown) === "function" && e.treegrid) {
            self.options.keyDown.call(self, e);
          }
        });
        self.$element.on("headerClicked", function (e) {
          if (self.options.headerClicked && $.type(self.options.headerClicked) === "function" && e.treegrid) {
            self.options.headerClicked.call(self, e);
          }
        });
        self.$element.on("codedialog", function (e) {
          if (self.options.codedialog && $.type(self.options.codedialog) === "function") {
            self.options.codedialog.call(self, e);
          }
        });
        self.$element.on("columnHeaderCheck", function (e) {
          if (self.options.columnHeaderCheck && $.type(self.options.columnHeaderCheck) === "function") {
            self.options.columnHeaderCheck.call(self, e);
          }
        });
        self.$element.on("keyUp", function (e) {
          if (self.options.keyUp && $.type(self.options.keyUp) === "function") {
            self.options.keyUp.call(self, e);
          }
        });
        self.$element.on("pasted", function (e) {
          if (self.options.pasted && $.type(self.options.pasted) === "function" && e.treegrid) {
            self.options.pasted.call(self, e);
          }
        });
        self.$element.on("pasting", function (e) {
          if (self.options.pasting && $.type(self.options.pasting) === "function" && e.treegrid) {
            self.options.pasting.call(self, e);
          }
        });
        self.$element.on("mouseup", function (e) {
          if (e.altKey && self.options.useSimpleCalculator !== false) {
            dews.ui.gridUtil.openSimpleCalculatorDialog(self);
          }
        });
        self.$element.on("filtered", function (e) {
          if (self.options.filtered && $.type(self.options.filtered) === "function" && e.treegrid) {
            self.options.filtered.call(self, e);
          }
        });
        self.$element.on("expanding", function (e) {
          if (self.options.expanding && $.type(self.options.expanding) === "function" && e.treegrid) {
            self.options.expanding.call(self, e);
          }
        });
        self.$element.on("expanded", function (e) {
          if (self.options.expanded && $.type(self.options.expanded) === "function" && e.treegrid) {
            self.options.expanded.call(self, e);
          }
        });
        self.$element.on("collapsing", function (e) {
          if (self.options.collapsing && $.type(self.options.collapsing) === "function" && e.treegrid) {
            self.options.collapsing.call(self, e);
          }
        });
        self.$element.on("collapsed", function (e) {
          if (self.options.collapsed && $.type(self.options.collapsed) === "function" && e.treegrid) {
            self.options.collapsed.call(self, e);
          }
        });
        function windowScroll(e) {
          if ($(e.target).closest(document.body).length !== 0) {
            self.commitCell();
          }
        }
        function noteMain(treeGrid, dataIndex) {
          if (dataIndex === null || dataIndex < 0) {
            return null;
          }
          var disabledRows = self._gridNote.disabledRow;
          var disabled = false;
          if (disabledRows) {
            if (typeof disabledRows === "number") {
              disabled = disabledRows === dataIndex ? true : false;
            } else {
              disabled = disabledRows.indexOf(dataIndex) !== -1;
            }
          }
          var itemIndex = self.getItemIndexFromDataIndex(dataIndex);
          var noteOpt = self.options.note;
          var key;
          if (self.getRowState(itemIndex) === "added" || !noteOpt || disabled) {
            key = {
              gridNoteKey: "",
              gridCode: "",
              menuCode: "",
              userInfo: {
                insertId: "",
                insertIp: "",
                insertDate: "",
                updateId: "",
                updateIp: "",
                updateDate: ""
              }
            };
          } else {
            var selectRowDS = treeGrid._dataSource.getJsonRow(dataIndex);
            var noteKey = dews.ui.gridUtil._getGridNoteInfo(self, dataIndex);
            key = {
              gridNoteKey: noteKey.gridNoteKey,
              gridCode: noteKey.gridCode,
              menuCode: noteKey.menuCode,
              userInfo: {
                insertId: selectRowDS.INSERT_ID,
                insertIp: selectRowDS.INSERT_IP,
                insertDate: selectRowDS.INSERT_DTS,
                updateId: selectRowDS.UPDATE_ID,
                updateIp: selectRowDS.UPDATE_IP,
                updateDate: selectRowDS.UPDATE_DTS
              }
            };
          }
          dews.ui.page.gridNote.setGridNoteData(self, key);
        }
        $(window).on("click", function (e) {
          var target = $(e.target).closest(".dews-ui-treegrid"),treeGrid = self.$element.closest(".dews-ui-treegrid"),inTreeGrid = false;
          if (treeGrid.length !== 0 && treeGrid.offset().left - window.pageXOffset < e.clientX && treeGrid.offset().left + treeGrid.width() - window.pageXOffset > e.clientX && treeGrid.offset().top - window.pageYOffset < e.clientY && treeGrid.offset().top + treeGrid.height() - window.pageYOffset > e.clientY) {
            inTreeGrid = true;
          }
          if ($(e.target).closest(document.body).length === 0) {
            inTreeGrid = true;
          }
          if (target.length === 0 && !inTreeGrid) {
            self.commitCell();
            self.editable = false;
          }
          if (target.length !== 0 && target.children().attr("ID") !== self._grid.name) {
            self.commitCell();
            self.editable = false;
          }
        });
        self.$element.on("click", function (e) {
          var grid2 = self.options.$content.find(".dews-ui-treegrid");
          if (e.target.tagName !== "INPUT" && e.target.tagName !== "TEXTAREA" && self._grid.mouseToIndex(e.offsetX, e.offsetY).itemIndex === -1) {
            self.commitCell();
            self.editable = false;
          }
        });
        self.$element.on("keyDown", function (e) {
          if (self.options.columns) {
            var column = self.columns[self._grid.getCurrent().fieldName];
            if (column && column.editor) {
              if (column.editor.type.toLowerCase() === "codepicker" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (column.codeOption.validation) {
                  if ($.type(column.codeOption.value[self._grid.getCurrent().itemIndex]) === "undefined") {
                    var currentValue2 = self._grid.getValue(
                    self._grid.getCurrent().itemIndex,
                    column.fieldName);

                    column.codeOption.value[self._grid.getCurrent().itemIndex] = dews.ui.gridUtil._codeOptionValue("", "", currentValue2);
                  }
                }
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
                if (e.keyCode === 13 && $.type(self._grid.getEditValue()) !== "undefined" && self._grid.getEditValue() !== "") {
                  self.commitCell();
                  e.preventDefault();
                }
              }
              if (self._grid._gv._editController._editor && column.editor.type.toLowerCase() === "date") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1 && self._grid.getColumnProperty(column.fieldName, "editable")) {
                  self.editCell();
                  self._grid._gv._editController._editor.dropDown();
                  e.stopPropagation();
                  e.preventDefault();
                }
                if (e.keyCode === 13 && self._grid._gv._editController._editor._datetimeFormat && self._grid.getEditValue() === self._grid._gv._editController._editor._datetimeFormat.replace(/[A-z]/gi, "_") && ($.type(self._grid.getValue(self._grid.getCurrent().itemIndex, self.getCurrentColumn())) === "undefined" || self._grid.getValue(self._grid.getCurrent().itemIndex, self.getCurrentColumn()) === null)) {
                  self.closeCell();
                  self._grid.setValue(self._grid.getCurrent().itemIndex, self.getCurrentColumn(), new Date());
                }
              }
              if (column.editor.type.toLowerCase() === "number") {
                if (e.keyCode === 107) {
                  if ($.type(self._grid.getEditValue()) !== "undefined") {
                    e.preventDefault();
                    var currentValue = self._grid.getEditValue().replace(/,/g, ""),resultValue = 0;
                    if (column.editor.increaseType === "plus") {
                      resultValue = parseFloat(currentValue) + parseFloat(column.editor.increaseValue);
                    } else {
                      resultValue = parseFloat(currentValue) * parseFloat(column.editor.increaseValue);
                    }
                    self.$element.find("#" + self._grid.name + "_number").val(dews.number.format(resultValue.toString(), column.editor.format));
                    self._grid._gv._editController.onEditorChange.call(
                    self._grid._gv._editController,
                    self._grid._gv._editController._editIndex);

                  } else {
                    e.preventDefault();
                    self._grid.showEditor();
                  }
                }
              }
              if (self._grid._gv._editController._editor && column.editor.type.toLowerCase() === "dropdown") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1 && self._grid.getColumnProperty(column.fieldName, "editable")) {
                  self.editCell();
                  self._grid._gv._editController._editor.dropDown();
                  e.stopPropagation();
                  e.preventDefault();
                }
                if (self._grid._gv._editController._editor.isVisible() && column.editor.textReadOnly && column.editor.useNumkey) {
                  if (e.keyCode >= 49 && e.keyCode <= 57 || e.keyCode >= 97 && e.keyCode <= 105) {
                    var number = e.keyCode >= 49 && e.keyCode <= 57 ? e.keyCode - 49 : e.keyCode - 97;
                    if (column.editor && column.editor.dataSelectable) {
                      if (column.editor.values.length > number) {
                        self.setCellValue(
                        self.select(),
                        column.fieldName,
                        column.editor.values[number]);

                        e.preventDefault();
                      }
                    } else {
                      if (column.values.length > number) {
                        self.setCellValue(self.select(), column.fieldName, column.values[number]);
                        e.preventDefault();
                      }
                    }
                  }
                }
              }
              if (column.editor.type.toLowerCase() === "zipcodepicker" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
              }
              if (column.editor.type.toLowerCase() === "month" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
                if (e.keyCode === 13) {
                  if (self._grid._gv._editController._editor._datetimeFormat && self._grid.getEditValue() === self._grid._gv._editController._editor._datetimeFormat.replace(/[A-z]/gi, "_") && ($.type(
                  self._grid.getValue(self._grid.getCurrent().itemIndex, self.getCurrentColumn())) ===
                  "undefined" || self._grid.getValue(self._grid.getCurrent().itemIndex, self.getCurrentColumn()) === null)) {
                    self.commitCell();
                    self.setCellValue(self.select(), self.getCurrentColumn(), new Date());
                  } else if (column.monthpicker.dateView._value && column.monthpicker.dateView._value.toString() !== column.monthpicker.dateView._current.toString()) {
                    self.commitCell();
                    self.setCellValue(
                    self.select(),
                    self.getCurrentColumn(),
                    new Date(column.monthpicker.dateView._current));

                  }
                }
                if (e.keyCode < 41 && e.keyCode > 36 && $.type(self._grid.getEditValue()) !== "undefined") {
                  e.preventDefault();
                  column.monthpicker.kendoInstance._keydown(e);
                }
              }
              if (column.editor.type.toLowerCase() === "year" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
                if (e.keyCode === 13) {
                  if (self._grid._gv._editController._editor._datetimeFormat && self._grid.getEditValue() === self._grid._gv._editController._editor._datetimeFormat.replace(/[A-z]/gi, "_") && ($.type(
                  self._grid.getValue(self._grid.getCurrent().itemIndex, self.getCurrentColumn())) ===
                  "undefined" || self._grid.getValue(self._grid.getCurrent().itemIndex, self.getCurrentColumn()) === null)) {
                    self.commitCell();
                    self.setCellValue(self.select(), self.getCurrentColumn(), new Date());
                    column.yearpicker.kendoInstance._keydown(e);
                  } else if (column.yearpicker.dateView._value && column.yearpicker.dateView._value.toString() !== column.yearpicker.dateView._current.toString()) {
                    self.commitCell();
                    self.setCellValue(
                    self.select(),
                    self.getCurrentColumn(),
                    new Date(column.yearpicker.dateView._current));

                    column.yearpicker.kendoInstance._keydown(e);
                  }
                }
                if (e.keyCode < 41 && e.keyCode > 36 && $.type(self._grid.getEditValue()) !== "undefined") {
                  e.preventDefault();
                  column.yearpicker.kendoInstance._keydown(e);
                }
              }
              if (column.editor.type.toLowerCase() === "time" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                if (e.keyCode === 115 && self._grid.getCurrent().dataRow !== -1) {
                  self._grid.onImageButtonClicked.call(
                  self,
                  self._grid,
                  self._grid.getCurrent().itemIndex,
                  column);

                  e.preventDefault();
                  e.stopPropagation();
                }
                if (e.keyCode === 13) {
                  column.timepicker.kendoInstance._keydown(e);
                  self.commitCell();
                }
                if (e.keyCode < 41 && e.keyCode > 36 && $.type(self._grid.getEditValue()) !== "undefined") {
                  e.preventDefault();
                  column.timepicker.kendoInstance._keydown(e);
                }
              }
            }
          }
        });
        self._grid._gv._container._defaultTool._checkCellClicked = function (cell, event) {
          var grid2 = this.grid();
          var dewsGrid = $(grid2._container._containerDiv).closest(".dews-data-control").data("dews-control");
          if (grid2.editOptions().isCheckable()) {
            var checkBar = grid2.checkBar();
            var item = cell.item();
            if (event && event.shiftKey && this._prevCheckIndex && !checkBar.isExclusive() && dewsGrid.options.shiftCheck) {
              var prevItem = this._prevCheckIndex.item();
              var idx1 = Math.min(prevItem._index, item._index),idx2 = Math.max(prevItem._index, item._index),itemIndicies = [];
              for (var idx = idx1; idx <= idx2; idx++) {
                item = grid2.getItem(idx);
                item.isCheckable() && item.dataRow() >= 0 && itemIndicies.push(item);
              }
              itemIndicies.length > 0 && grid2.itemSource().checkItems(itemIndicies, prevItem.isChecked(), true);
            } else {
              if (item.isCheckable() && (checkBar.isShowGroup() || item.dataRow() >= 0)) {
                grid2.makeItemVisible(item.index());
                grid2.itemSource().checkItem(item, !item.isChecked(), checkBar.isExclusive(), true);
              }
            }
          }
        };
        if (dews.ui.page.onegridData && dews.ui.page.onegridData.editable) {
          self.$element.find(".dews-grid-edit-button").on("click", function (e) {
            var fixedOptions = self._grid.getFixedOptions();
            var fixedColumns = dews.ui.gridUtil.getFixedColumns(self);
            self._onegrid.fixed = {
              colCount: fixedOptions.colCount,
              rightColCount: fixedOptions.rightColCount,
              leftColumns: fixedColumns.leftColumns,
              rightColumns: fixedColumns.rightColumns
            };
            self._onegrid.loadColumns = dews.ui.gridUtil.setOnegridDialogColumns(self, self._onegrid.loadColumns);
            var dlg = new ColumnDialog(self);
            dlg.columnDialog.open();
          });
        }
        self._grid._gv._clipboardManager.$_convertValue = dews.ui.gridUtil.extend__$_convertValue(
        self._grid._gv._clipboardManager.$_convertValue);

      } }]);return TreeGridEvent;}(Event);

  function getSelectionColumns2(cols, start, end, isSelectionColumn) {
    var result = {
      columns: [],
      isSelectionColumn: isSelectionColumn
    };
    for (var i = 0; i < cols.length; i++) {
      var col = cols[i];
      isSelectionColumn = !isSelectionColumn && start === col ? true : isSelectionColumn;
      if (col.columns) {
        var c = getSelectionColumns2(col.columns, start, end, isSelectionColumn);
        isSelectionColumn = c.isSelectionColumn;
        var column = {
          field: col.name,
          columns: c.columns
        };
        if (c.columns.length > 0) {
          result.columns.push(column);
        }
      } else if (isSelectionColumn) {
        result.columns.push(col);
      }
      isSelectionColumn = isSelectionColumn && end === col ? false : isSelectionColumn;
    }
    result.isSelectionColumn = isSelectionColumn;
    return result;
  }

  // src/js/grid/base/gridBase.js
  var GRID = "GRID";
  var TREE_GRID = "TREEGRID";
  var DewsGrid = /*#__PURE__*/function () {"use strict";



    function DewsGrid($element) {_classCallCheck(this, DewsGrid);_defineProperty(this, "_grid", void 0);_defineProperty(this, "gridType", void 0);_defineProperty(this, "event", void 0);
      this.selector = $element;
      this.id = $element.attr("ID");
    }_createClass(DewsGrid, [{ key: "initializeGrid", value:
      function initializeGrid() {
        this.gridType = GRID;
        this.event = new GridEvent(this);
        Object.setPrototypeOf(DewsGrid.prototype, GridAPI.prototype);
      } }, { key: "initializeTreeGrid", value:
      function initializeTreeGrid() {
        this.gridType = TREE_GRID;
        this.event = new TreeGridEvent(this);
        Object.setPrototypeOf(DewsGrid.prototype, TreeGridAPI.prototype);
      } }, { key: "controlAuthority", value:
      function controlAuthority(options) {
        if (dews.ui.dialogPage) {
          return;
        }
        if (dews.ui.page) {var _dews$ui$page$control2;
          var gridAuthority = (_dews$ui$page$control2 = dews.ui.page.controlAuthority) === null || _dews$ui$page$control2 === void 0 ? void 0 : _dews$ui$page$control2.grid;
          if (gridAuthority) {
            var id = this.id;
            var mainGrid = gridAuthority[id];
            if (mainGrid) {
              setAuthColumn(mainGrid, options.columns);
            }
          }
        }
        function setAuthColumn(mainGrid, columns) {
          $.each(columns, function (idx, column) {
            if (mainGrid[column.field]) {
              $.extend(true, column, mainGrid[column.field]);
            }
            if ($.type(column.columns) !== "undefined") {
              setAuthColumn(mainGrid, column.columns);
            }
          });
        }
      } }, { key: "useCssStyle", value:
      function useCssStyle() {
        var self = this;
        self._grid.setEditorOptions({
          useCssStylePopupMenu: true,
          useCssStyleDropDownList: true
        });
        self._grid.setDisplayOptions({ useCssStyleProgress: true });
      } }]);return DewsGrid;}();

  DewsGrid.prototype._bindEvent = function () {
    this.event.initialize();
  };
  DewsGrid.prototype._setOneGridData = function () {
    var self = this;
    var oneGridData = dews.ui.page.onegridData;
    setTimeout(function () {
      if (oneGridData && self._onegrid._onegrid) {
        if (self._onegrid.loadData) {
          self._onegrid.loadColumns = dews.ui.gridUtil.setDisplayIndexColumns(
          self,
          self.options.columns,
          self._onegrid.loadData);

        } else {
          self._onegrid.loadColumns = dews.ui.gridUtil.setDisplayColumns(self, self._grid.getDisplayColumns());
        }
      }
    });
  };
  DewsGrid.prototype._getOptionsThatConvertColumns = function (column, opt2, grid2) {
    if (this.gridType === "GRID") {
      return customizingColumn(column, opt2, grid2);
    }
    return treeCustomizingColumn(column, opt2, grid2);
  };
  DewsGrid.prototype._createOneGridButton = function (element) {
    var oneGridData = dews.ui.page.onegridData;
    var id = this.id;
    if (oneGridData !== null && oneGridData !== void 0 && oneGridData.editable && id !== "__filter_layer_grid__") {
      var $columnDialogBtn = $("<button class=\"dews-grid-edit-button\" type=\"button\">\n                    <span class=\"ico-edit\"></span>Edit\n                  </button>");




      element.prepend($columnDialogBtn);
    }
  };
  DewsGrid.prototype._initOneGrid = function () {
    var self = this;
    var id = this.id;
    var selector = this.selector;
    var oneGridData = dews.ui.page.onegridData;
    var gridType = this.gridType;
    self.userOptions._dewsGridID = id;
    if (oneGridData) {
      if (!self._onegrid) {
        self._onegrid = {};
      }
      self._onegrid.editType = oneGridData.editType;
      self._onegrid.baseColumns = $.extend(true, [], self.userOptions.columns);
      self._onegrid._gridID = id;
      if (dews.ui.dialogPage && selector.closest(dews.ui.dialogPage.$content).length) {
        self._onegrid._onegridType = "D_" + gridType;
        var dlgID = dews.ui.dialogPage.id;
        if (id.indexOf(dlgID) < 0) {
          self._onegrid._gridID = dlgID + "-" + id;
        }
      } else {
        self._onegrid._onegridType = gridType;
      }
      self._onegrid._gridType = gridType;
      if (oneGridData.editable || Array.isArray(oneGridData.items)) {
        dews.ui.gridUtil.notExistFieldNaming(self._onegrid.baseColumns, 1);
      }
      if (oneGridData.editable) {
        dews.ui.gridUtil.initOneGridOptions(self, oneGridData, self.userOptions);
        self._onegrid._onegrid = true;
      } else {
        if (Array.isArray(oneGridData.items)) {
          var isGrid = oneGridData.items.some(function (oneGridItems) {
            return oneGridItems.type === self._onegrid._onegridType && oneGridItems.id === self._onegrid._gridID;
          });
          if (isGrid) {
            dews.ui.gridUtil.initOneGridOptions(self, oneGridData, self.userOptions);
            self._onegrid._onegrid = true;
          } else {
            self._onegrid._onegrid = false;
          }
        }
      }
    }
  };

  // src/js/grid/column/HeaderSummary.js
  var instance;
  var HeaderSummary = /*#__PURE__*/function () {"use strict";
    function HeaderSummary(columnAdaptor) {_classCallCheck(this, HeaderSummary);
      if (instance) {
        return instance;
      }
      this.columnAdaptor = columnAdaptor;
      instance = this;
    }_createClass(HeaderSummary, [{ key: "initialize", value:
      function initialize(column, stylesTextAlignment) {
        var self = this.columnAdaptor;
        var cnt = self._userOptions.multiHeaderSummaryCnt;
        var gridSummary = self._innerOptions.header.summary;
        var headerSummary = column.headerSummary;
        self._innerOptions.header.summary = _objectSpread(_objectSpread({},
        gridSummary),
        _getSummaryOptions());

        return cnt > 1 ? this._getMultiHeaderSummary(headerSummary, stylesTextAlignment) : this._getHeaderSummary(headerSummary, stylesTextAlignment);
        function _getSummaryOptions() {
          var HEIGHT = 32;
          var multiHeight = HEIGHT * cnt;
          return _objectSpread(_objectSpread({
            visible: true },
          cnt > 1 && { count: cnt }),
          cnt > 1 && { minHeight: multiHeight });

        }
      } }, { key: "_getMultiHeaderSummary", value:
      function _getMultiHeaderSummary(headerSummary, stylesTextAlignment) {var _this4 = this;
        var arr = Array.isArray(headerSummary) ? headerSummary : [headerSummary];
        var text = [];
        var styles = [];
        var expression = [];
        var preCurrency = [];
        var preFormat = [];
        arr.forEach(function (multiSummary) {
          var headerSummary2 = _this4._getHeaderSummary(multiSummary, stylesTextAlignment);
          text.push(headerSummary2.text);
          styles.push(headerSummary2.styles);
          expression.push(headerSummary2.expression);
          preCurrency.push(headerSummary2.preCurrency);
          preFormat.push(headerSummary2.preFormat);
        });
        return {
          text: text,
          styles: styles,
          expression: expression,
          preCurrency: preCurrency,
          preFormat: preFormat
        };
      } }, { key: "_getHeaderSummary", value:
      function _getHeaderSummary(userHeaderSummary, stylesTextAlignment) {var _userHeaderSummary$fo;
        var self = this.columnAdaptor;
        var headerSummary = _objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({},
        userHeaderSummary.text && { text: userHeaderSummary.text }),
        userHeaderSummary.type && {
          expression: userHeaderSummary.type
        }),
        userHeaderSummary.predefined && {
          predefined: userHeaderSummary.predefined
        }),
        userHeaderSummary.format && {
          format: userHeaderSummary.format
        }),
        userHeaderSummary.callback && {
          callback: userHeaderSummary.callback
        }), {}, {
          styles: _objectSpread(_objectSpread({
            textAlignment: userHeaderSummary.styles === void 0 ? stylesTextAlignment : "center",
            numberFormat: (_userHeaderSummary$fo = userHeaderSummary.format) !== null && _userHeaderSummary$fo !== void 0 ? _userHeaderSummary$fo : "#,##0.##" },
          userHeaderSummary.suffix && {
            suffix: userHeaderSummary.suffix
          }),
          userHeaderSummary.prefix && {
            prefix: userHeaderSummary.prefix
          }) });


        if (typeof userHeaderSummary.align !== "undefined") {
          switch (userHeaderSummary.align.toLowerCase()) {
            case "left":
              headerSummary.styles.textAlignment = "near";
              break;
            case "right":
              headerSummary.styles.textAlignment = "far";
              break;
            default:
              headerSummary.styles.textAlignment = "center";
              break;}

        }
        if (userHeaderSummary.type) {
          if (typeof self._innerOptions.fieldIndex !== "undefined" && userHeaderSummary.type.toLowerCase() !== "count") {
            self._innerOptions.dataSource.options.field[self._innerOptions.fieldIndex].dataType = "number";
            self._innerOptions.dataSource.options.schema.model.fields[self._innerOptions.fieldIndex].dataType = "number";
          }
          if (userHeaderSummary.predefined === true) {
            if (typeof userHeaderSummary.preFormat === "undefined" || userHeaderSummary.preFormat !== userHeaderSummary.format) {
              headerSummary.preFormat = userHeaderSummary.format;
            }
            var preDefinedFormat = dews.getPreDefinedFormat(headerSummary);
            if ($.type(userHeaderSummary.currency) !== "undefined") {
              if ($.type(userHeaderSummary.currency) === "string") {
                headerSummary.preCurrency = userHeaderSummary.currency;
                headerSummary.currency = userHeaderSummary.currency;
                preDefinedFormat = dews.getCurrencyFormat(headerSummary);
                if (preDefinedFormat) {
                  var round = typeof preDefinedFormat.round === "string" ? preDefinedFormat.round : "round";
                  if (round !== "round") {
                    if (preDefinedFormat.format.split(".").length === 2) {
                      if (round === "ceil") {
                        preDefinedFormat.format += ";;;c";
                      } else {
                        preDefinedFormat.format += ";;;f";
                      }
                    }
                  }
                }
              } else if (typeof userHeaderSummary.currency === "function") {
                headerSummary.preCurrency = userHeaderSummary.currency;
                headerSummary.currency = userHeaderSummary.currency;
                userHeaderSummary.preCurrency = "";
              }
            }
            if (_typeof(preDefinedFormat) === "object") {
              preDefinedFormat = preDefinedFormat.format;
            }
            if (preDefinedFormat) {
              headerSummary.styles.numberFormat = preDefinedFormat;
            } else {
              headerSummary.styles.numberFormat = "#,##0.##";
            }
          }
        }
        return headerSummary;
      } }]);return HeaderSummary;}();


  // src/js/grid/column/CellMerge.js
  var setInnerColumnCellMerge = function setInnerColumnCellMerge(column, innerColumn, innerOptions) {
    if (innerOptions._gridType !== "GRID") {
      return;
    }
    if (!column.merge) {
      return;
    }
    if (typeof column.merge.verticalTop === "boolean" && column.merge.verticalTop) {
      innerColumn.equalBlank = true;
      return;
    }
    if (typeof column.merge === "boolean") {
      innerColumn.mergeRule = {
        criteria: column.merge ? "value" : ""
      };
    }
    if (typeof column.merge === "string") {
      innerColumn.mergeRule = {
        criteria: "values['" + column.merge + "'] + value"
      };
    }
    if (_typeof(column.merge) === "object") {
      var referenceField = column.merge.referenceField;
      var criteria = "value";
      if (referenceField) {
        var arrReferenceField = Array.isArray(referenceField) ? referenceField : [referenceField];
        criteria = "";
        arrReferenceField.forEach(function (field) {
          criteria += "values[\"".concat(field, "\"] + ");
        });
        criteria += "value";
      }
      innerOptions.display.showInnerFocus = typeof column.merge.innerFocus === "undefined" ? true : column.merge.innerFocus;
      innerColumn.mergeRule = {
        criteria: criteria
      };
    }
  };

  // src/js/grid/column/MultiHeader.js
  var setInnerColumnMultiHeader = function setInnerColumnMultiHeader(self, column, innerColumn, innerOptions) {
    if (column.columns) {
      innerColumn.type = "group";
      innerColumn.hideChildHeaders = column.hideChildHeaders;
      if (!column.hideChildHeaders) {
        innerOptions.depth += 1;
      }
      if (typeof innerColumn.name === "undefined") {
        innerColumn.name = column._multiHeaderColumnName;
      }
      if (typeof column.visible === "boolean") {
        if (innerOptions._gridType === "GRID" && innerOptions._hideChildrenColumns && innerOptions._hideChildrenColumns[innerColumn.name]) {
          innerColumn.visible = false;
        } else {
          innerColumn.header.visible = column.visible;
          delete column.visible;
        }
      } else if (column.visible === "hideChildren") {
        innerColumn.visible = false;
      }
      innerColumn.columns = self.convertColumns(column.columns);
    } else {
      if (innerOptions.depth > innerOptions.maxDepth) {
        innerOptions.maxDepth = innerOptions.depth;
      }
      innerOptions.depth = 1;
    }
  };

  // src/js/grid/column/MultiColumnHeight.js
  var setInnerColumnMultiColumnHeight = function setInnerColumnMultiColumnHeight(column, innerColumn, innerOptions) {
    if (typeof column.multiColumnHeight !== "undefined") {
      if (typeof column.multiColumnHeight === "number") {
        innerColumn.multiColumnHeight = {
          header: column.multiColumnHeight,
          row: column.multiColumnHeight
        };
      } else {
        innerColumn.multiColumnHeight = column.multiColumnHeight;
      }
    } else {
      innerColumn.multiColumnHeight = {};
    }
    if (typeof innerColumn.multiColumnHeight.header === "number") {
      innerColumn.header.fillHeight = innerColumn.multiColumnHeight.header;
      innerColumn.header.minHeight = innerColumn.multiColumnHeight.header;
      innerColumn.header.fixedHeight = innerColumn.multiColumnHeight.header;
    } else if (typeof innerColumn.multiColumnHeight.header === "undefined") {
      innerColumn.header.fillHeight = innerOptions.header.minHeight;
      innerColumn.header.minHeight = innerOptions.header.minHeight;
      innerColumn.header.fixedHeight = innerOptions.header.minHeight;
    }
    if (typeof innerColumn.multiColumnHeight.row === "number") {
      innerColumn.height = innerColumn.multiColumnHeight.row;
      innerColumn.fillHeight = innerColumn.multiColumnHeight.row;
      innerColumn.minHeight = innerColumn.multiColumnHeight.row;
      innerColumn.fixedHeight = innerColumn.multiColumnHeight.row;
    } else if (typeof innerColumn.multiColumnHeight.row === "undefined") {
      innerColumn.fillHeight = innerOptions.display.rowHeight;
      innerColumn.minHeight = innerOptions.display.rowHeight;
      innerColumn.fixedHeight = innerOptions.display.rowHeight;
    }
  };

  // src/js/grid/column/Grouping.js
  var setInnerColumnGrouping = function setInnerColumnGrouping(column, innerColumn, innerOptions) {
    if (typeof column.grouping === "boolean" && column.grouping) {
      innerColumn.type = "group";
      innerColumn.orientation = "vertical";
      innerOptions.grouping = true;
      innerOptions.groupCol = column.columns.length;
      if (innerOptions.groupCol > innerOptions.maxGroupCol) {
        innerOptions.maxGroupCol = innerOptions.groupCol;
      }
    }
  };

  // src/js/grid/column/Attributes.js
  var setInnerColumnAttributes = function setInnerColumnAttributes(column, innerColumn, innerOptions) {
    if (column.attributes) {
      if (column.attributes["class"] === "required" || column.attributes["class"] === "none") {
        innerColumn.styles.background = column.attributes["class"] === "required" ? innerOptions.gridStyle.body.requiredBackground : innerOptions.gridStyle.body.background;
        innerColumn.readOnly = false;
        if (column.editor && column.editor.type && column.editor.type.toUpperCase() === "COMBO") {
          innerColumn.editor.textReadOnly = false;
        }
      } else if (column.attributes["class"] === "readonly") {
        innerColumn.styles.background = innerOptions.gridStyle.body.readonlyBackground;
        innerColumn.readOnly = true;
        innerColumn.editable = false;
      }
    }
  };

  // src/js/grid/column/BaseColumn.js
  var setInnerColumnBase = function setInnerColumnBase(self, column, innerColumn, innerOptions, userOptions) {
    var dataSourceOpt = innerOptions.dataSource.options;
    if (typeof column.width === "number") {
      innerColumn.width = column.width;
    }
    if (typeof column.sortable === "boolean") {
      innerColumn.sortable = column.sortable;
    }
    if (typeof column.groupable === "boolean") {
      innerColumn.groupable = column.groupable;
    }
    if (typeof column.resizable === "boolean") {
      innerColumn.resizable = column.resizable;
    }
    if (typeof column.movable === "boolean") {
      innerColumn.movable = column.movable;
    }
    if (typeof column.style === "function") {
      innerColumn.style = column.style;
    }
    if (typeof column.visible === "boolean" || typeof column.visible === "string") {
      innerColumn.visible = column.visible;
    }
    self._filterManager.columnOptionConvert(column);
    if (typeof column.renderer !== "undefined") {
      if (typeof innerColumn.renderer === "undefined") {
        innerColumn.renderer = {
          showTooltip: column.renderer.showTooltip
        };
      } else {
        innerColumn.renderer.showTooltip = column.renderer.showTooltip;
      }
    }
    if (Array.isArray(column.dynamicStyles)) {
      innerColumn.dynamicStyles = column.dynamicStyles;
    }
    innerColumn.fieldName = column.field;
    if (typeof column.editable === "undefined") {
      innerColumn.editable = true;
    } else if (typeof column.editable === "boolean") {
      innerColumn.editable = column.editable;
    } else if (typeof column.editable === "function") {
      innerColumn.editable = column.editable;
    }
    if (typeof column.field !== "undefined") {
      innerColumn.name = column.field;
      innerColumn.field = column.field;
    }
    for (var i = 0; i < dataSourceOpt.field.length; i++) {
      if (innerColumn.fieldName === dataSourceOpt.field[i].fieldName) {
        innerOptions.fieldIndex = i;
        break;
      }
      if (i === dataSourceOpt.field.length - 1) {
        innerOptions.fieldIndex = void 0;
      }
    }
    if (typeof innerColumn.styles === "undefined") {
      innerColumn.styles = {};
    }
    if (typeof innerOptions.fieldIndex !== "undefined" && typeof dataSourceOpt.field[innerOptions.fieldIndex].styles === "undefined") {
      dataSourceOpt.field[innerOptions.fieldIndex].styles = {};
    }
    if (typeof column.width === "undefined") {
      if (innerOptions.display.fitStyle === "fill") {
        innerColumn.fillWidth = 1;
      }
    }
    if (typeof column.width !== "undefined" && innerOptions.gridStyle.fontSize !== 12) {
      var fontSize = innerOptions.gridStyle.fontSize;
      switch (fontSize) {
        case 15:
          innerColumn.width = Math.floor(1.25 * column.width);
          break;
        case 18:
          innerColumn.width = Math.floor(1.5 * column.width);
          break;
        case 24:
          innerColumn.width = Math.floor(2 * column.width);
          break;
        case 30:
          innerColumn.width = Math.floor(2.5 * column.width);
          break;}

    }
    if (column.title) {
      innerColumn.header = $.extend(true, innerColumn.header, {
        text: column.title,
        fixedHeight: innerOptions.display.rowIndex
      });
    } else {
      innerColumn.header = {
        text: " "
      };
    }
    if (column.headerCheck) {
      if (typeof column.headerCheck.location === "undefined") {
        innerColumn.header.checkLocation = "right";
      } else {
        innerColumn.header.checkLocation = column.headerCheck.location;
      }
    }
    if (typeof userOptions.styles !== "undefined" && typeof userOptions.styles.textAlign !== "undefined") {
      innerColumn.align = userOptions.styles.textAlign;
    } else if (typeof column.align === "undefined") {
      innerColumn.align = "center";
    }
    if (column.align) {
      var align;
      if (column.align === "right") {
        align = "far";
      } else if (column.align === "left") {
        align = "near";
      } else {
        align = "center";
      }
      innerColumn.styles.textAlignment = align;
    } else {
      innerColumn.styles.textAlignment = "center";
    }
    if (column.suffix) {
      innerColumn.styles.suffix = column.suffix;
    }
    if (column.prefix) {
      innerColumn.styles.prefix = column.prefix;
    }
  };

  // src/js/grid/column/formats/DateFormats.js
  function convertDateFormats(column, innerOptions) {
    var innerColumn = {};
    innerColumn.styles = {};
    innerColumn.formats = {
      type: column.formats.type,
      predefined: column.formats.predefined,
      format: column.formats.format
    };
    if (column.formats.predefined === true) {
      if (typeof innerColumn.formats.preFormat === "undefined") {
        innerColumn.formats.preFormat = column.formats.format;
      }
      var preDefinedFormat = dews.getPreDefinedFormat(innerColumn.formats);
      if (preDefinedFormat) {
        innerColumn.formats.format = preDefinedFormat;
      } else {
        innerColumn.formats.format = dews._environments.formats.dateFormat;
      }
    }
    if (typeof innerOptions.fieldIndex !== "undefined") {
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].dataType = "datetime";
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].dataType = "datetime";
    }
    innerColumn.styles.datetimeFormat = typeof innerColumn.formats.format === "undefined" ? dews._environments.formats.dateFormat : innerColumn.formats.format;
    return innerColumn;
  }

  // src/js/grid/column/formats/LinkFormats.js
  function convertLinkFormats(column) {
    var innerColumn = {};
    innerColumn.formats = {
      type: column.formats.type,
      urlField: column.formats.urlField,
      useMenu: column.formats.useMenu,
      module: column.formats.module,
      menu: column.formats.menu,
      data: column.formats.data
    };
    innerColumn.renderer = $.extend(true, innerColumn.renderer, {
      type: "link",
      url: dews.url.getAbsoluteUrl("${" + column.field + "}"),
      showUrl: false,
      useMenu: typeof column.formats.useMenu === "boolean" ? column.formats.useMenu : false,
      cursor: "pointer"
    });
    return innerColumn;
  }

  // src/js/grid/column/formats/Mask.js
  function convertMaskFormats(column) {
    var innerColumn = {};
    innerColumn.formats = {
      type: column.formats.type,
      format: column.formats.format,
      predefined: column.formats.predefined,
      secureFormat: column.formats.secureFormat
    };
    var mask = column.formats.format,replace = "",exp = "(",regchar = "",regcount = 1,expcount = 0;
    var predefined = column.formats.predefined;
    var secureFormat = column.formats.secureFormat;
    if (predefined) {
      exp = "(.*)$";
      replace = function replace(match) {
        var groups = Array.prototype.splice.call(arguments, 1);
        var orgValue = groups[groups.length - 1];
        var chgValue = orgValue;
        var secureMask = dews.getSecureMaskFormat(secureFormat);
        if (mask && mask !== "") {
          chgValue = dews.string.secureMask(chgValue, mask, false);
        }
        if (secureMask) {
          chgValue = dews.string.secureMask(chgValue, secureFormat, true);
        }
        return chgValue;
      };
    } else if (!predefined && secureFormat && secureFormat !== "") {
      exp = "(.*)$";
      replace = function replace(match) {
        var groups = Array.prototype.splice.call(arguments, 1);
        var orgValue = groups[groups.length - 1];
        var chgValue = orgValue;
        if (mask && mask !== "") {
          chgValue = dews.string.secureMask(chgValue, mask, false);
        }
        if (secureFormat.match(/[,]/g) && secureFormat.match(/[,]/g).length > 1) {
          chgValue = dews.string.secureMask(chgValue, secureFormat, false);
        }
        return chgValue;
      };
    } else if (mask && mask !== "") {
      for (var m = 0; m < mask.length; m += 1) {
        if (mask[m] !== regchar && regchar === "*") {
          exp += "{" + expcount + "})(";
          expcount = 0;
          regcount++;
        }
        switch (mask[m]) {
          case "0":
          case "9":
            if (expcount === 0) {
              exp += "\\d";
            } else if (regchar !== mask[m]) {
              exp += "{" + expcount + "}\\d";
              expcount = 0;
            }
            regchar = mask[m];
            expcount++;
            break;
          case "#":
            if (expcount === 0) {
              exp += "\\d";
            } else if (regchar !== mask[m]) {
              exp += "{" + expcount + "}\\d";
              expcount = 0;
            }
            regchar = mask[m];
            expcount++;
            break;
          case "L":
            if (expcount === 0) {
              exp += "[a-zA-Z]";
            } else if (regchar !== mask[m]) {
              exp += "{" + expcount + "}[a-zA-Z]";
              expcount = 0;
            }
            regchar = mask[m];
            expcount++;
            break;
          case "?":
            if (expcount === 0) {
              exp += "[a-zA-Z]";
            } else if (regchar !== mask[m]) {
              exp += "{" + expcount + "}[a-zA-Z]";
              expcount = 0;
            }
            regchar = mask[m];
            expcount++;
            break;
          case "&":
            if (expcount === 0) {
              exp += "\\S";
            } else if (regchar !== mask[m]) {
              exp += "{" + expcount + "}\\S";
              expcount = 0;
            }
            regchar = mask[m];
            expcount++;
            break;
          case "C":
            if (expcount === 0) {
              exp += ".";
            } else if (regchar !== mask[m]) {
              exp += "{" + expcount + "}.";
              expcount = 0;
            }
            regchar = mask[m];
            expcount++;
            break;
          case "A":
          case "a":
            if (expcount === 0) {
              exp += "[a-zA-Z0-9]";
            } else if (regchar !== mask[m]) {
              exp += "{" + expcount + "}[a-zA-Z0-9]";
              expcount = 0;
            }
            regchar = mask[m];
            expcount++;
            break;
          case "*":
            if (expcount === 0) {
              exp += "[a-zA-Z0-9]";
            } else if (regchar !== mask[m]) {
              exp += "{" + expcount + "})([a-zA-Z0-9]";
              replace += "$" + regcount;
              expcount = 0;
              regcount++;
            }
            replace += "*";
            regchar = mask[m];
            expcount++;
            break;
          default:
            if (mask[m] !== "*") {
              replace += "$" + regcount + mask[m];
            }
            exp += "{" + expcount + "})(";
            expcount = 0;
            regcount++;
            break;}

        if (m === mask.length - 1) {
          exp += "{" + expcount + "})";
          if (regchar !== "*") {
            replace += "$" + regcount;
          }
        }
      }
    } else {
      exp = "(.*)$";
      replace = function replace(match) {
        var groups = Array.prototype.splice.call(arguments, 1);
        var orgValue = groups[groups.length - 1];
        return orgValue;
      };
    }
    innerColumn.displayRegExp = exp;
    innerColumn.displayReplace = replace;
    return innerColumn;
  }

  // src/js/grid/column/formats/Number.js
  function convertNumberFormats(column, innerOptions) {
    var innerColumn = {};
    innerColumn.styles = {};
    innerColumn.formats = {
      type: column.formats.type,
      predefined: column.formats.predefined,
      format: column.formats.format,
      round: column.formats.round
    };
    innerColumn.formats.format = column.formats.format;
    if (column.formats.predefined === true) {
      if (typeof innerColumn.formats.preFormat === "undefined") {
        innerColumn.formats.preFormat = column.formats.format;
      }
      var preDefinedFormat = dews.getPreDefinedFormat(innerColumn.formats);
      if (_typeof(preDefinedFormat) === "object") {
        innerColumn.formats.round = preDefinedFormat.round;
        preDefinedFormat = preDefinedFormat.format;
      }
      if (typeof column.formats.currency === "string") {
        innerColumn.formats.preCurrency = column.formats.currency;
        innerColumn.formats.currency = column.formats.currency;
        preDefinedFormat = dews.getCurrencyFormat(innerColumn.formats);
        if (_typeof(preDefinedFormat) === "object") {
          innerColumn.formats.round = preDefinedFormat.round;
          preDefinedFormat = preDefinedFormat.format;
        }
      } else if (typeof column.formats.currency === "function") {
        delete innerColumn.formats.round;
        innerColumn.formats.preCurrency = "";
        innerColumn.displayCallback = function (realgrid, index, value) {
          var dewsGrid = $(realgrid._gv._container._containerDiv).closest(".dews-data-control").data("dews-control");
          var dewsParams;
          if (innerOptions._gridType === "GRID") {
            dewsParams = {
              grid: dewsGrid,
              row: {
                index: index.itemIndex,
                data: dewsGrid.dataItem(index.itemIndex)
              },
              cell: {
                field: index.column,
                data: dewsGrid.getCellValue(index.itemIndex, index.column)
              }
            };
          } else {
            dewsParams = {
              treegrid: dewsGrid,
              row: {
                index: index.itemIndex,
                data: dewsGrid.dataItem(index.dataRow)
              },
              cell: {
                field: index.column,
                data: dewsGrid.getCellValue(index.dataRow, index.column)
              }
            };
          }
          var dewsCol = dewsGrid.columns[index.column];
          dewsCol.formats.preCurrency = dewsCol.formats.currency.call(dewsCol, dewsParams);
          dewsGrid._innerOptions.columns.some(function (value2, idx) {
            if (value2.fieldName === index.column) {
              dewsGrid._innerOptions.columns[idx].formats.preCurrency = dewsCol.formats.preCurrency;
            }
          });
          var env = dews.ui.page && dews.ui.page.env && dews.ui.page.env[dewsCol.formats.preFormat];
          var predefinedFormat = dews.getCurrencyFormat(dewsCol.formats),formats = "#,###.##",round = "round";
          if (env) {
            formats = env.format;
            round = dews.mathType[env.round];
          }
          if (_typeof(predefinedFormat) === "object") {
            formats = predefinedFormat.format;
            round = typeof predefinedFormat.round === "string" ? predefinedFormat.round : round;
          } else if (typeof predefinedFormat === "string") {
            formats = predefinedFormat;
          }
          if (round !== "round") {
            if (formats.split(".").length === 2) {
              var sosu = Math.pow(10, formats.split(".")[1].length);
              if (round === "ceil") {
                value = Math.ceil(value * sosu) / sosu;
              } else {
                value = Math.floor(value * sosu) / sosu;
              }
            }
          }
          var oldFormats = dewsGrid._grid.getColumnProperty(dewsCol.name, "excelFormat");
          if (!oldFormats) {
            dewsGrid._grid.setColumnProperty(dewsCol.name, "excelFormat", formats);
          }
          return dews.number.format(value, formats);
        };
      }
      if (preDefinedFormat) {
        innerColumn.formats.format = preDefinedFormat;
      } else {
        innerColumn.formats.format = "#,##0.##";
      }
    }
    if (typeof column.formats.abs === "boolean" && column.formats.abs) {
      innerColumn.dynamicStyles = [
      {
        criteria: "value<0",
        styles: {
          foreground: typeof column.formats.negative === "undefined" ? "#e62324" : column.formats.negative,
          numberFormat: innerColumn.formats.format + ";a"
        }
      }];

      if (typeof column.formats.positive !== "undefined") {
        innerColumn.dynamicStyles.push({
          criteria: "value>=0",
          styles: {
            foreground: column.formats.positive,
            numberFormat: innerColumn.formats.format + ";a"
          }
        });
      }
    }
    if (column.formats.negativeColor) {var _dews$ui$page11;
      var useNegativeColor = false;
      var MA00041 = (_dews$ui$page11 = dews.ui.page) === null || _dews$ui$page11 === void 0 ? void 0 : _dews$ui$page11.env["MA00041"];
      if (MA00041) {
        useNegativeColor = MA00041.value === "2";
      }
      if (useNegativeColor) {
        innerColumn.dynamicStyles = [
        {
          criteria: "value<0",
          styles: {
            foreground: "#e62324"
          }
        }];

      }
    }
    if (typeof innerOptions.fieldIndex !== "undefined") {
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].dataType = "number";
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].min = column.formats.min;
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].max = column.formats.max;
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].styles.numberFormat = typeof innerColumn.formats.format === "undefined" ? "#,##0.##" : innerColumn.formats.format;
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].dataType = "number";
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].numberFormat = typeof innerColumn.formats.format === "undefined" ? "#,##0.##" : innerColumn.formats.format;
    }
    if (typeof innerColumn.formats.round === "undefined" || innerColumn.formats.round === "round") {
      if (typeof column.formats.currency !== "function") {
        innerColumn.styles.numberFormat = innerColumn.formats.format;
      }
    } else if (innerColumn.formats.round === "ceil") {
      innerColumn.styles.numberFormat = innerColumn.formats.format + ";;;c";
    } else if (innerColumn.formats.round === "floor") {
      innerColumn.styles.numberFormat = innerColumn.formats.format + ";;;f";
    }
    return innerColumn;
  }

  // src/js/grid/column/formats/Check.js
  function convertCheckFormats(column, innerOptions) {
    var innerColumn = {};
    innerColumn.formats = {
      type: column.formats.type,
      trueValue: column.formats.trueValue,
      falseValue: column.formats.falseValue
    };
    innerColumn.styles = {};
    innerColumn.renderer = {
      type: "check",
      shape: "box",
      editable: false,
      startEditOnClick: true,
      trueValues: typeof column.formats.trueValue === "undefined" ? "true" : column.formats.trueValue,
      falseValues: typeof column.formats.falseValue === "undefined" ? "false" : column.formats.falseValue,
      trueImage: innerOptions.gridStyle.body.checkedImg,
      falseImage: innerOptions.gridStyle.body.unCheckImg,
      labelPosition: "none",
      showInnerFocus: false
    };
    innerColumn.editable = false;
    innerColumn.styles.figureBackground = "#ff4995ff";
    return innerColumn;
  }

  // src/js/grid/column/formats/DataSource.js
  function convertDataSourceFormats(column) {
    var innerColumn = {};
    innerColumn.formats = {
      type: "dataSource",
      dataSource: column.formats.dataSource,
      dataValueField: column.formats.dataValueField,
      dataTextField: column.formats.dataTextField
    };
    innerColumn.values = [];
    innerColumn.labels = [];
    innerColumn.lookupDisplay = true;
    return innerColumn;
  }

  // src/js/grid/column/formats/Image.js
  function convertImageFormats() {
    var innerColumn = {};
    innerColumn.formats = {
      type: "image"
    };
    innerColumn.styles = {};
    innerColumn.editable = false;
    innerColumn.renderer = {
      type: "image",
      smoothing: true
    };
    innerColumn.styles.contentFit = "auto";
    return innerColumn;
  }

  // src/js/grid/column/formats/Time.js
  function convertTimeFormats(column) {
    var innerColumn = {};
    innerColumn.formats = {
      type: column.formats.type,
      predefined: column.formats.predefined,
      format: column.formats.format
    };
    innerColumn.formats.format = column.formats.format;
    if (column.formats.predefined === true) {
      if (typeof innerColumn.formats.preFormat === "undefined") {
        innerColumn.formats.preFormat = column.formats.format;
      }
      var preDefinedFormat = dews.getPreDefinedFormat(innerColumn.formats);
      if (preDefinedFormat) {
        innerColumn.formats.format = preDefinedFormat;
      } else {
        innerColumn.formats.format = "HH:mm:ss";
      }
    }
    var time = innerColumn.formats.format,timeReg = "";
    if (/HH/gi.test(time)) {
      timeReg = time.replace(/HH/gi, "$1");
    }
    if (/mm/gi.test(time)) {
      timeReg = timeReg.replace(/mm/gi, "$2");
    }
    if (/ss/gi.test(time)) {
      timeReg = timeReg.replace(/ss/gi, "$3");
    }
    innerColumn.displayRegExp = /([0-1]\d|2[0-3])([0-5]\d)([0-5]\d)?/gi;
    innerColumn.displayReplace = timeReg;
    return innerColumn;
  }

  // src/js/grid/column/formats/Password.js
  function convertPasswordFormats(column) {
    var innerColumn = {};
    innerColumn.formats = {
      type: "password",
      format: column.formats.format
    };
    var format = column.formats.format;
    innerColumn.displayRegExp = /^.*$/gi;
    innerColumn.displayReplace = format;
    return innerColumn;
  }

  // src/js/grid/column/formats/Year.js
  function convertYearFormats(column, innerOptions) {
    var innerColumn = {};
    innerColumn.formats = {
      type: column.formats.type,
      predefined: column.formats.predefined,
      format: column.formats.format
    };
    innerColumn.styles = {};
    innerColumn.formats.format = column.formats.format;
    if (column.formats.predefined === true) {
      if (typeof innerColumn.formats.preFormat === "undefined") {
        innerColumn.formats.preFormat = column.formats.format;
      }
      var preDefinedFormat = dews.getPreDefinedFormat(innerColumn.formats);
      if (preDefinedFormat) {
        innerColumn.formats.format = preDefinedFormat;
      } else {
        innerColumn.formats.format = dews._environments.formats.dateFormat;
      }
    }
    if (typeof innerOptions.fieldIndex !== "undefined") {
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].datatimeFormat = dews._environments.formats.yearValueFormat;
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].dataType = "datetime";
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.yearValueFormat;
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].dataType = "datetime";
    }
    innerColumn.styles.datetimeFormat = typeof innerColumn.formats.format === "undefined" ? dews._environments.formats.yearValueFormat : innerColumn.formats.format;
    return innerColumn;
  }

  // src/js/grid/column/formats/Function.js
  function convertFunctionFormats(column, innerOptions) {
    var innerColumn = {};
    innerColumn.formats = {
      type: "function",
      format: column.formats.format
    };
    innerColumn.displayCallback = function (realgrid, index, value) {
      var dewsGrid = $(realgrid._gv._container._containerDiv).closest(".dews-data-control").data("dews-control");
      var dewsParams;
      if (innerOptions._gridType === "GRID") {
        dewsParams = {
          grid: dewsGrid,
          row: {
            index: index.itemIndex,
            data: dewsGrid.dataItem(index.itemIndex)
          },
          cell: {
            field: index.column,
            data: dewsGrid.getCellValue(index.itemIndex, index.column)
          }
        };
      } else {
        dewsParams = {
          grid: dewsGrid,
          row: {
            index: index.itemIndex,
            data: dewsGrid.dataItem(index.dataRow)
          },
          cell: {
            field: index.column,
            data: dewsGrid.getCellValue(index.dataRow, index.column)
          }
        };
      }
      return dewsGrid.columns[index.column].formats.format.call(dewsGrid, value, dewsParams);
    };
    return innerColumn;
  }

  // src/js/grid/column/formats/Month.js
  function convertMonthFormats(column, innerOptions) {
    var innerColumn = {};
    innerColumn.formats = {
      type: column.formats.type,
      predefined: column.formats.predefined,
      format: column.formats.format
    };
    innerColumn.styles = {};
    innerColumn.formats.format = column.formats.format;
    if (column.formats.predefined === true) {
      if (typeof innerColumn.formats.preFormat === "undefined") {
        innerColumn.formats.preFormat = column.formats.format;
      }
      var preDefinedFormat = dews.getPreDefinedFormat(innerColumn.formats);
      if (preDefinedFormat) {
        innerColumn.formats.format = preDefinedFormat;
      } else {
        innerColumn.formats.format = dews._environments.formats.dateFormat;
      }
    }
    if (typeof innerOptions.fieldIndex !== "undefined") {
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].datatimeFormat = dews._environments.formats.monthValueFormat;
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].dataType = "datetime";
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].dataType = "datetime";
    }
    innerColumn.styles.datetimeFormat = typeof innerColumn.formats.format === "undefined" ? dews._environments.formats.monthFormat : innerColumn.formats.format;
    return innerColumn;
  }

  // src/js/grid/column/ColumnRenderer.js
  function ColumnRenderer() {
  }
  ColumnRenderer.prototype.getBarRenderer = function (column) {
    if (!column)
    return null;
    var f = column.formats;
    if (!f)
    return null;
    var styleCreator = dews.ui.grid.StyleCreator.getInstance();
    var defaultMinimum = 0;
    var defaultMaximum = 100;
    var defaultShowLabel = true;
    var defaultStartingPoint = "left";
    var defaultColor = styleCreator.gridStyle.themeColorLight1;
    var defaultAngle = 0;
    var defaultTextAlignment = "center";
    var defaultLineAlignment = "middle";
    var defaultPadding = 6;
    var defaultSize = "100%";
    var ds = column.dynamicStyles;
    if (ds) {
      $.each(ds, function (idx, item) {
        var style = item.styles;
        var startColor2 = checkNullOrType(style.startColor, "string", defaultColor);
        var endColor2 = checkNullOrType(style.endColor, "string", defaultColor);
        var angle2 = checkNullOrType(style.angle, "number", defaultAngle);
        var size2 = checkNullOrType(style.size, "number", defaultSize);
        style.figureBackground = dews.string.format("linear, {0}, {1}, {2}", startColor2, endColor2, angle2);
        delete style.startColor;
        delete style.endColor;
        delete style.angle;
        style.figureSize = dews.string.format("{0}%", size2);
        delete style.size;
      });
    }
    var startColor = checkNullOrType(f.startColor, "string", defaultColor);
    var endColor = checkNullOrType(f.endColor, "string", defaultColor);
    var angle = checkNullOrType(f.angle, "number", defaultAngle);
    var size = checkNullOrType(f.size, "number", defaultSize);
    var textAlignment = checkNullOrType(f.textAlignment, "string", defaultTextAlignment);
    var lineAlignment = checkNullOrType(f.lineAlignment, "string", defaultLineAlignment);
    textAlignment = convertHorizontalAlignment(textAlignment);
    lineAlignment = convertVerticalAlignment(lineAlignment);
    var returnRenderer = {
      renderer: {
        type: "bar",
        minimum: checkNullOrType(f.minimum, "number", defaultMinimum),
        maximum: checkNullOrType(f.maximum, "number", defaultMaximum),
        showLabel: checkNullOrType(f.showLabel, "boolean", defaultShowLabel),
        origin: checkNullOrType(f.startingPoint, "string", defaultStartingPoint)
      },
      styles: {
        figureBackground: dews.string.format("linear, {0}, {1}, {2}", startColor, endColor, angle),
        textAlignment: textAlignment,
        lineAlignment: lineAlignment,
        paddingLeft: checkNullOrType(f.paddingLeft, "number", defaultPadding),
        paddingRight: checkNullOrType(f.paddingRight, "number", defaultPadding),
        paddingTop: checkNullOrType(f.paddingTop, "number", defaultPadding),
        paddingBottom: checkNullOrType(f.paddingBottom, "number", defaultPadding),
        figureSize: dews.string.format("{0}%", size)
      }
    };
    if (typeof f.displayCallback === "function")
    returnRenderer.displayCallback = f.displayCallback;
    return returnRenderer;
  };
  ColumnRenderer.prototype.getSignalRenderer = function (column) {
    if (!column)
    return null;
    var f = column.formats;
    if (!f)
    return null;
    var styleCreator = dews.ui.grid.StyleCreator.getInstance();
    var defaultBarCount = 10;
    var defaultColor = styleCreator.gridStyle.themeColorLight1;
    var defaultState = "value";
    var ds = column.dynamicStyles;
    if (ds) {
      $.each(ds, function (idx, item) {
        var style = item.styles;
        var color = checkNullOrType(style.color, "string", defaultColor);
        var state = checkNullOrType(style.state, "string", defaultState);
        style.figureBackground = color;
        delete style.color;
        style.figureState = Number(state);
        delete style.state;
      });
    }
    return {
      renderer: {
        type: "signal",
        barCount: checkNullOrType(f.barCount, "number", defaultBarCount)
      },
      styles: {
        figureBackground: checkNullOrType(f.color, "string", defaultColor),
        figureState: checkNullOrType(f.state, "string", defaultState)
      }
    };
  };
  function checkNullOrType(value, type, defaultValue) {
    if (value === null || value === void 0 || _typeof(value) !== type)
    return defaultValue;else

    return value;
  }
  function convertHorizontalAlignment(value) {
    switch (value.toLowerCase()) {
      case "left":
        return "near";
      case "right":
        return "far";
      case "center":
        return "center";
      default:
        return value;}

  }
  function convertVerticalAlignment(value) {
    switch (value.toLowerCase()) {
      case "top":
        return "near";
      case "bottom":
        return "far";
      case "middle":
        return "center";
      default:
        return value;}

  }

  // src/js/grid/column/formats/FormatsFactory.js
  var columnFormatMap = {
    DATE: convertDateFormats,
    LINK: convertLinkFormats,
    MASK: convertMaskFormats,
    NUMBER: convertNumberFormats,
    CHECK: convertCheckFormats,
    DATASOURCE: convertDataSourceFormats,
    IMAGE: convertImageFormats,
    TIME: convertTimeFormats,
    PASSWORD: convertPasswordFormats,
    MONTH: convertMonthFormats,
    YEAR: convertYearFormats,
    FUNCTION: convertFunctionFormats
  };
  var instance2;
  var FormatsFactory = /*#__PURE__*/function () {"use strict";
    function FormatsFactory() {_classCallCheck(this, FormatsFactory);
      if (instance2) {
        return instance2;
      }
      instance2 = this;
    }_createClass(FormatsFactory, [{ key: "getInnerColumnFormat", value:
      function getInnerColumnFormat(type, column, innerOptions) {
        var instance4 = columnFormatMap[type];
        if (instance4) {
          return instance4(column, innerOptions);
        }
        var columnRenderer = new ColumnRenderer();
        switch (type) {
          case "BAR":
            return columnRenderer.getBarRenderer(column);
          case "SIGNAL":
            return columnRenderer.getSignalRenderer(column);}

      } }]);return FormatsFactory;}();


  // src/js/grid/column/editor/ComboDropdown.js
  function convertComboDropdownEditor(column) {
    var innerColumn = {};
    innerColumn.editor = {
      dataValueField: column.editor.dataValueField,
      dataTextField: column.editor.dataTextField,
      editable: column.editor.editable
    };
    if (column.editor.dataSource) {
      innerColumn.editor.dataSource = column.editor.dataSource;
    }
    var values = column.editor.dataValueField,labels = column.editor.dataTextField,datasource = column.editor.dataSource;
    innerColumn.values = [];
    innerColumn.labels = [];
    innerColumn.editButtonVisibility = "visible";
    if (column.editor.type.toUpperCase() === "DROPDOWN") {
      innerColumn.editor.textReadOnly = true;
      if (column.editor.autoOpen) {
        innerColumn.editor.autoOpen = true;
      }
      innerColumn.editor.useNumkey = typeof column.editor.useNumkey === "boolean" ? column.editor.useNumkey : true;
    } else {
      innerColumn.editor.textReadOnly = false;
    }
    innerColumn.editor.type = "dropDown";
    innerColumn.lookupDisplay = true;
    innerColumn.editor.dropdowncount = 3;
    if (typeof column.editor.dataSource === "function") {
      if (typeof column.editor.dataTextField === "undefined") {
        innerColumn.labelField = labels;
      } else {
        innerColumn.labelField = column.editor.textField;
      }
    }
    if (typeof column.editor.dataSelectable === "string") {
      innerColumn.editor.dataSelectable = {
        field: column.editor.dataSelectable,
        trueValue: true,
        falseValue: false
      };
    } else if (_typeof(column.editor.dataSelectable) === "object") {
      innerColumn.editor.dataSelectable = column.editor.dataSelectable;
    }
    var dataSelectable = innerColumn.editor.dataSelectable;
    innerColumn.editor.values = [];
    innerColumn.editor.labels = [];
    if (datasource && datasource.transport && datasource.transport.data && datasource.transport.data.length > 0) {
      var transportData = datasource.transport.data;
      for (var j = 0; j < datasource.transport.data.length; j += 1) {
        innerColumn.values.push(transportData[j][values]);
        innerColumn.labels.push(transportData[j][labels]);
        if (dataSelectable && transportData[j][dataSelectable.field] !== dataSelectable.falseValue) {
          innerColumn.editor.values.push(datasource.transport.data[j][values]);
          innerColumn.editor.labels.push(datasource.transport.data[j][labels]);
        }
      }
    }
    return innerColumn;
  }

  // src/js/grid/column/editor/Number.js
  function convertNumberEditor(column, innerOptions) {
    var innerColumn = {};
    innerColumn.editor = {
      type: column.editor.type,
      max: column.editor.max,
      min: column.editor.min,
      round: column.editor.round,
      editable: column.editor.editable,
      format: column.editor.format,
      predefined: column.editor.predefined
    };
    if (column.editor.predefined === true) {
      if (typeof innerColumn.editor.preFormat === "undefined") {
        innerColumn.editor.preFormat = column.editor.format;
      }
      var preDefinedFormat;
      if (typeof column.editor.currency === "undefined") {
        preDefinedFormat = dews.getPreDefinedFormat(innerColumn.editor);
      } else if (typeof column.editor.currency === "string") {
        innerColumn.editor.preCurrency = column.editor.currency;
        innerColumn.editor.currency = column.editor.currency;
        preDefinedFormat = dews.getCurrencyFormat(innerColumn.editor);
      }
      if (_typeof(preDefinedFormat) === "object") {
        preDefinedFormat = preDefinedFormat.format;
      }
      if (preDefinedFormat) {
        innerColumn.editor.format = preDefinedFormat;
      } else {
        innerColumn.editor.format = "#,##0.##";
      }
    } else {
      innerColumn.editor.format = column.editor.format ? column.editor.format : "#,##0.##";
    }
    var decimalPlaceRegex = /[^.]*$/;
    var includesDot = innerColumn.editor.format.indexOf(".");
    var formatLetters = includesDot !== -1 ? decimalPlaceRegex.exec(innerColumn.editor.format)[0] : "";
    var formatLettersLength = formatLetters.length;
    var formatLetter = formatLettersLength > 0 ? formatLetters.charAt(formatLettersLength - 1) : "#";
    var decimalLength, intLength, maxLength;
    if (typeof column.editor.maxLength === "string") {
      maxLength = column.editor.maxLength;
    } else if (typeof innerColumn.editor.__maxLength === "string") {
      maxLength = innerColumn.editor.__maxLength;
    }
    if (typeof maxLength === "string") {
      var maxLengthRegex = /^(\d+)(?:,(\d+))?$/;
      var matchArray = maxLengthRegex.exec(maxLength);
      innerColumn.editor.__maxLength = maxLength;
      if (matchArray && matchArray.length > 0) {
        intLength = parseInt(matchArray[1], 10);
        try {
          if (intLength > 15) {
            throw "\uC22B\uC790\uD14D\uC2A4\uD2B8\uBC15\uC2A4 maxLength \uC18D\uC131\uC758 \uC124\uC815 \uAC00\uB2A5\uD55C \uCD5C\uB300\uAC12\uC740 15\uC785\uB2C8\uB2E4.";
          }
          if (matchArray[2]) {
            var newFormat;
            decimalLength = parseInt(matchArray[2], 10);
            intLength = intLength - decimalLength;
            if (intLength <= 0) {
              throw "\uC22B\uC790\uD14D\uC2A4\uD2B8\uBC15\uC2A4 maxLength \uC18D\uC131\uC758 \uC124\uC815\uAC12\uC740 \uC815\uC218\uBD80\uC758 \uC22B\uC790\uAC00 \uC18C\uC218\uBD80\uC758 \uC22B\uC790\uBCF4\uB2E4 \uCEE4\uC57C\uD569\uB2C8\uB2E4.";
            }
            if (formatLettersLength > decimalLength) {
              newFormat = (includesDot !== -1 ? innerColumn.editor.format.replace(decimalPlaceRegex, "") : innerColumn.editor.format + ".") + formatLetters.substr(0, decimalLength);
            } else if (formatLettersLength < decimalLength) {
              newFormat = (includesDot !== -1 ? innerColumn.editor.format.replace(decimalPlaceRegex, "") : innerColumn.editor.format + ".") + formatLetters + formatLetter.repeat(decimalLength - formatLettersLength);
            } else {
              newFormat = innerColumn.editor.format;
            }
            innerColumn.editor.format = newFormat;
          } else {
            innerColumn.editor.format = innerColumn.editor.format.split(".")[0];
          }
        } catch (e) {
          intLength = 15 - formatLettersLength;
          console.error(e);
        }
        innerColumn.editor.maxIntegerLength = intLength;
      }
      innerColumn.editor.maxLength = 0;
    } else if (typeof maxLength === "undefined") {
      innerColumn.editor.maxIntegerLength = 15 - formatLettersLength;
    }
    if (typeof innerOptions.fieldIndex !== "undefined") {
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].dataType = "number";
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].dataType = "number";
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].min = column.editor.min;
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].max = column.editor.max;
    }
    innerColumn.editor.editFormat = typeof innerColumn.editor.format === "undefined" ? "#,##0.##" : innerColumn.editor.format;
    innerColumn.editor.increaseValue = typeof column.editor.increaseValue === "undefined" ? 1e3 : parseFloat(column.editor.increaseValue);
    innerColumn.editor.increaseType = typeof column.editor.increaseType === "undefined" ? "multiple" : column.editor.increaseType;
    return innerColumn;
  }

  // src/js/grid/column/editor/String.js
  function convertStringEditor(column) {
    var innerColumn = {};
    innerColumn.editor = {
      maxLength: column.editor.maxLength,
      editable: column.editor.editable,
      textCase: column.editor.textCase
    };
    innerColumn.editor.type = "text";
    return innerColumn;
  }

  // src/js/grid/column/editor/Date.js
  function convertDateEditor(column, innerOptions) {
    var innerColumn = {};
    innerColumn.editor = {
      type: column.editor.type,
      format: column.editor.format,
      predefined: column.editor.predefined,
      editable: column.editor.editable
    };
    innerColumn.styles = {};
    if (column.editor.predefined === true) {
      if (typeof innerColumn.editor.preFormat === "undefined") {
        innerColumn.editor.preFormat = column.editor.format;
      }
      var preDefinedFormat = dews.getPreDefinedFormat(innerColumn.editor);
      if (preDefinedFormat) {
        innerColumn.editor.format = preDefinedFormat;
      } else {
        innerColumn.editor.format = dews._environments.formats.dateFormat;
      }
    }
    innerColumn.editor.maxDate = new Date(9999, 12, 0);
    innerColumn.editor.minDate = new Date(1e3, 0, 1);
    innerColumn.editor.yearDisplayFormat = "{Y}" + dews.localize.get("\uB144", "dews_\uB144Y");
    innerColumn.editor.months = dews.localize.getMonth();
    innerColumn.editor.weekDays = dews.localize.getDays();
    innerColumn.editor.datetimeFormat = typeof innerColumn.editor.format === "undefined" ? dews._environments.formats.dateFormat : innerColumn.editor.format;
    innerColumn.styles.datetimeFormat = typeof innerColumn.editor.format === "undefined" ? dews._environments.formats.dateFormat : innerColumn.editor.format;
    innerColumn.editor.mask = {
      editMask: typeof innerColumn.editor.format === "undefined" ? dews._environments.formats.dateFormat.replace(/[A-z\\s]/gi, "9") : innerColumn.editor.format.replace(/[A-z\\s]/gi, "9"),
      includedFormat: true
    };
    innerColumn.editButtonVisibility = "visible";
    if ($.type(innerOptions.fieldIndex) !== "undefined") {
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].dataType = "datetime";
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].dataType = "datetime";
    }
    return innerColumn;
  }

  // src/js/grid/column/editor/MaskTime.js
  function convertMaskTimeEditor(column) {
    var innerColumn = {};
    innerColumn.editor = {
      type: column.editor.type,
      format: column.editor.format,
      editable: column.editor.editable
    };
    if (column.editor.type === "time") {
      innerColumn.editor.min = column.editor.min;
      innerColumn.editor.max = column.editor.max;
      innerColumn.editor.interval = column.editor.interval;
      innerColumn.editor.useAP = column.editor.useAP;
      innerColumn.editor._secondValue = column.editor.secondValue;
    }
    var editMask = column.editor.format;
    if (editMask) {
      for (var em = 0; em < editMask.length; em += 1) {
        switch (editMask[em]) {
          case "L":
          case "?":
          case "#":
          case "&":
            editMask = editMask.replace(editMask[em], "a");
            break;
          case "A":
          case "a":
            editMask = editMask.replace(editMask[em], "*");
            break;
          case "H":
          case "m":
          case "s":
            editMask = editMask.replace(editMask[em], "0");
            break;}

      }
    }
    if (column.editor.type.toUpperCase() === "TIME") {
      innerColumn.editor.type = "time";
      innerColumn.editor.format = column.editor.format;
      innerColumn.editor.predefined = column.editor.predefined;
      if (column.editor.predefined === true) {
        if (typeof innerColumn.editor.preFormat === "undefined") {
          innerColumn.editor.preFormat = column.editor.format;
        }
        var preDefinedFormat = dews.getPreDefinedFormat(innerColumn.editor);
        if (preDefinedFormat) {
          editMask = preDefinedFormat;
        } else {
          editMask = "HH:mm:ss";
        }
      }
      if (typeof column.editor.secondValue === "boolean" && column.editor.secondValue === true) {
        innerColumn._secondValue = true;
      }
      innerColumn.button = "image";
      innerColumn.buttonVisibility = "visible";
      if (typeof column.editor.editable === "boolean" && !column.editor.editable) {
        innerColumn.buttonVisibility = "hidden";
      }
      var clockIcon = dews._environments.scriptBase + "realgrid/assets/comp-icon-clock.png";
      innerColumn.imageButtons = {
        width: 24,
        height: 22,
        images: [
        {
          name: "timebutton",
          up: clockIcon,
          hover: clockIcon,
          down: clockIcon
        }]

      };
    } else {
      innerColumn.editor.type = "text";
    }
    if (typeof editMask === "function") {
      innerColumn.editor.mask = {
        allowEmpty: true
      };
    } else {
      if (editMask !== "") {
        innerColumn.editor.mask = {
          editMask: editMask,
          allowEmpty: true
        };
      }
    }
    return innerColumn;
  }

  // src/js/grid/column/editor/CodePicker.js
  function convertCodePickerEditor(column, innerOptions) {
    var innerColumn = {};
    innerColumn.editor = $.extend(true, {}, column.editor);
    innerColumn.editor.firstClick = true;
    innerColumn.button = "image";
    innerColumn.buttonVisibility = "visible";
    if (typeof column.editor.editable === "boolean") {
      if (!column.editor.editable) {
        innerColumn.buttonVisibility = "hidden";
      }
    }
    innerColumn.imageButtons = {
      width: 24,
      height: 22,
      images: [
      {
        name: "codepickerbutton",
        up: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
        hover: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
        down: dews._environments.scriptBase + "realgrid/assets/search_ico.png"
      }]

    };
    innerOptions._grid = true;
    innerColumn.codeOption = {
      field: column.field,
      code: column.editor.helpCode,
      codeField: column.editor.codeField,
      textField: column.editor.textField,
      gridCodeField: column.editor.gridCodeField,
      gridTextField: column.editor.gridTextField,
      params: column.editor.helpParams,
      size: column.editor.helpSize,
      title: column.editor.helpTitle,
      mode: "single",
      width: column.editor.helpWidth,
      height: column.editor.helpHeight,
      initData: column.editor.initData,
      callback: column.editor.callback,
      custom: column.editor.helpCustom || false,
      viewUrl: column.editor.helpViewUrl,
      apiUrl: column.editor.helpApiUrl,
      moveFocus: typeof column.editor.moveFocus === "boolean" ? column.editor.moveFocus : true,
      useAjax: typeof column.editor.useAjax === "boolean" ? column.editor.useAjax : true,
      validation: typeof column.editor.validation === "boolean" ? column.editor.validation : true,
      value: {}
    };
    return innerColumn;
  }

  // src/js/grid/column/editor/Button.js
  function convertButtonEditor(column) {
    var innerColumn = {};
    innerColumn.editor = $.extend(true, {}, column.editor);
    innerColumn.buttonVisibility = "always";
    if (typeof column.editor.align !== "undefined") {
      switch (column.editor.align.toLowerCase()) {
        case "left":
          innerColumn.editor.align = "near";
          break;
        case "right":
          innerColumn.editor.align = "far";
          break;}

    }
    innerColumn.renderer = column.editor.buttonText ? textRenderer(innerColumn) : defaultRenderer(innerColumn);
    return innerColumn;
  }
  function defaultRenderer(column) {
    return {
      type: "imageButtons",
      images: {
        up: column.editor.basicImg,
        hover: column.editor.hoverImg,
        down: column.editor.clickImg,
        width: typeof column.editor.buttonWidth === "undefined" ? 50 : column.editor.buttonWidth
      },
      margin: column.editor.align === "far" ? -4 : 0,
      alignment: column.editor.align ? column.editor.align : "center",
      width: typeof column.editor.buttonWidth === "undefined" ? 50 : column.editor.buttonWidth,
      height: typeof column.editor.buttonHeight === "undefined" ? 25 : column.editor.buttonHeight,
      showText: true
    };
  }
  function textRenderer(column) {
    return {
      type: "imageButton",
      imageUrl: column.editor.basicImg,
      hoverUrl: column.editor.hoverImg,
      activeUrl: column.editor.clickImg,
      text: getButtonText(column.editor.buttonText),
      hoveredUnderline: column.editor.hoveredUnderline ? column.editor.hoveredUnderline : false
    };
  }
  function getButtonText(buttonText) {
    var result = "";
    if (_typeof(buttonText) === "object") {
      result = buttonText.text ? buttonText.text : "";
    }
    return result;
  }

  // src/js/grid/column/editor/ZipCodePicker.js
  function convertZipCodePickerEditor(column, innerOptions) {
    var innerColumn = {};
    innerColumn.editor = {
      type: column.editor.type,
      addressType: column.editor.addressType,
      callback: column.editor.callback,
      editable: column.editor.editable
    };
    innerColumn.button = "image";
    innerColumn.buttonVisibility = "visible";
    if (typeof column.editor.editable === "boolean" && !column.editor.editable) {
      innerColumn.buttonVisibility = "hidden";
    }
    innerColumn.imageButtons = {
      width: 24,
      height: 22,
      images: [
      {
        name: "zipcodepickerbutton",
        up: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
        hover: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
        down: dews._environments.scriptBase + "realgrid/assets/search_ico.png"
      }]

    };
    innerOptions._grid = true;
    innerColumn.codeOption = {
      field: column.field,
      addressType: typeof column.editor.addressType === "undefined" ? "zipcode" : column.editor.addressType,
      callback: column.editor.callback
    };
    return innerColumn;
  }

  // src/js/grid/column/editor/Month.js
  function convertMonthEditor(column, innerOptions) {
    var innerColumn = {};
    innerColumn.editor = {
      type: "month",
      editable: column.editor.editable,
      predefined: column.editor.predefined,
      format: column.editor.format
    };
    innerColumn.styles = {};
    if (column.editor.predefined === true) {
      if (typeof innerColumn.editor.preFormat === "undefined") {
        innerColumn.editor.preFormat = column.editor.format;
      }
      var preDefinedFormat = dews.getPreDefinedFormat(innerColumn.editor);
      if (preDefinedFormat) {
        innerColumn.editor.format = preDefinedFormat;
      } else {
        innerColumn.editor.format = dews._environments.formats.monthFormat;
      }
    }
    innerColumn.editor.minDate = new Date(1900, 0, 1);
    innerColumn.editor.maxDate = new Date(2100, 12, 0);
    innerColumn.editor.datetimeFormat = typeof innerColumn.editor.format === "undefined" ? dews._environments.formats.monthFormat : innerColumn.editor.format;
    innerColumn.styles.datetimeFormat = typeof innerColumn.editor.format === "undefined" ? dews._environments.formats.monthFormat : innerColumn.editor.format;
    innerColumn.editor.mask = {
      editMask: typeof innerColumn.editor.format === "undefined" ? dews._environments.formats.monthFormat.replace(/[A-z\\s]/gi, "9") : innerColumn.editor.format.replace(/[A-z\\s]/gi, "9"),
      includedFormat: true
    };
    innerColumn.button = "image";
    innerColumn.buttonVisibility = "visible";
    if (typeof column.editor.editable === "boolean" && !column.editor.editable) {
      innerColumn.buttonVisibility = "hidden";
    }
    innerColumn.imageButtons = {
      width: 24,
      height: 22,
      images: [
      {
        name: "monthbutton",
        up: dews._environments.scriptBase + "realgrid/assets/calendar_up.png",
        hover: dews._environments.scriptBase + "realgrid/assets/calendar_hover.png",
        down: dews._environments.scriptBase + "realgrid/assets/calendar_down.png"
      }]

    };
    if (typeof innerOptions.fieldIndex !== "undefined") {
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].dataType = "datetime";
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].dataType = "datetime";
    }
    return innerColumn;
  }

  // src/js/grid/column/editor/Year.js
  function convertYearEditor(column, innerOptions) {
    var innerColumn = {};
    innerColumn.editor = {
      type: "year",
      editable: column.editor.editable,
      predefined: column.editor.predefined,
      format: column.editor.format
    };
    innerColumn.styles = {};
    if (column.editor.predefined === true) {
      if (typeof innerColumn.editor.preFormat === "undefined") {
        innerColumn.editor.preFormat = column.editor.format;
      }
      var preDefinedFormat = dews.getPreDefinedFormat(innerColumn.editor);
      if (preDefinedFormat) {
        innerColumn.editor.format = preDefinedFormat;
      } else {
        innerColumn.editor.format = dews._environments.formats.yearFormat;
      }
    }
    innerColumn.editor.minDate = new Date(1900, 0, 1);
    innerColumn.editor.maxDate = new Date(2100, 12, 0);
    innerColumn.editor.datetimeFormat = typeof innerColumn.editor.format === "undefined" ? dews._environments.formats.yearFormat : innerColumn.editor.format;
    innerColumn.styles.datetimeFormat = typeof innerColumn.editor.format === "undefined" ? dews._environments.formats.yearFormat : innerColumn.editor.format;
    innerColumn.editor.mask = {
      editMask: typeof innerColumn.editor.format === "undefined" ? dews._environments.formats.monthFormat.replace(/[A-z\\s]/gi, "9") : innerColumn.editor.format.replace(/[A-z\\s]/gi, "9"),
      includedFormat: true
    };
    innerColumn.button = "image";
    innerColumn.buttonVisibility = "visible";
    if (typeof column.editor.editable === "boolean" && !column.editor.editable) {
      innerColumn.buttonVisibility = "hidden";
    }
    innerColumn.imageButtons = {
      width: 24,
      height: 22,
      images: [
      {
        name: "yearbutton",
        up: dews._environments.scriptBase + "realgrid/assets/calendar_up.png",
        hover: dews._environments.scriptBase + "realgrid/assets/calendar_hover.png",
        down: dews._environments.scriptBase + "realgrid/assets/calendar_down.png"
      }]

    };
    if (typeof innerOptions.fieldIndex !== "undefined") {
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.yearFormat;
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].dataType = "datetime";
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.yearFormat;
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].dataType = "datetime";
    }
    return innerColumn;
  }

  // src/js/grid/column/editor/MultiLine.js
  function convertMultilineEditor(column) {var _column$editor$textWr;
    var innerColumn = {};
    innerColumn.editor = {
      type: column.editor.type,
      maxLength: column.editor.maxLength,
      editable: column.editor.editable,
      textCase: column.editor.textCase,
      minHeight: column.editor.minHeight
    };
    innerColumn.styles = {};
    innerColumn.editor.type = "multiline";
    innerColumn.styles.textWrap = (_column$editor$textWr = column.editor.textWrap) !== null && _column$editor$textWr !== void 0 ? _column$editor$textWr : "explicit";
    return innerColumn;
  }

  // src/js/grid/column/editor/Check.js
  function convertCheckEditor(column, innerOptions) {
    var innerColumn = {};
    innerColumn.editor = {
      type: column.editor.type,
      trueValue: column.editor.trueValue,
      falseValue: column.editor.falseValue
    };
    innerColumn.styles = {};
    innerColumn.renderer = {
      type: "check",
      shape: "box",
      editable: typeof column.editor.editable === "boolean" ? column.editor.editable : true,
      startEditOnClick: true,
      trueValues: typeof column.editor.trueValue === "undefined" ? "true" : column.editor.trueValue,
      falseValues: typeof column.editor.falseValue === "undefined" ? "false" : column.editor.falseValue,
      trueImage: innerOptions.gridStyle.body.checkedImg,
      falseImage: innerOptions.gridStyle.body.unCheckImg,
      labelPosition: "none",
      showInnerFocus: false
    };
    innerColumn.editable = false;
    innerColumn.styles.figureBackground = "#ff4995ff";
    return innerColumn;
  }

  // src/js/grid/column/editor/ReadOnly.js
  function convertReadonlyEditor() {
    var innerColumn = {};
    innerColumn.editor = {
      type: "readonly"
    };
    innerColumn.readOnly = true;
    innerColumn.editable = false;
    return innerColumn;
  }

  // src/js/grid/column/editor/EditorFactory.js
  var columnEditorMap = {
    DROPDOWN: convertComboDropdownEditor,
    COMBO: convertComboDropdownEditor,
    NUMBER: convertNumberEditor,
    STRING: convertStringEditor,
    DATE: convertDateEditor,
    READONLY: convertReadonlyEditor,
    MASK: convertMaskTimeEditor,
    TIME: convertMaskTimeEditor,
    CODEPICKER: convertCodePickerEditor,
    BUTTON: convertButtonEditor,
    CHECK: convertCheckEditor,
    ZIPCODEPICKER: convertZipCodePickerEditor,
    MULTILINE: convertMultilineEditor,
    MONTH: convertMonthEditor,
    YEAR: convertYearEditor
  };
  var instance3;
  var EditorFactory = /*#__PURE__*/function () {"use strict";
    function EditorFactory() {_classCallCheck(this, EditorFactory);
      if (instance3) {
        return instance3;
      }
      instance3 = this;
    }_createClass(EditorFactory, [{ key: "getInnerColumnEditor", value:
      function getInnerColumnEditor(type, column, innerOptions) {
        var instance4 = columnEditorMap[type];
        if (instance4) {
          return instance4(column, innerOptions);
        }
      } }]);return EditorFactory;}();


  // src/js/grid/column/ColumnAdaptor.js
  var ColumnAdaptor = /*#__PURE__*/function () {"use strict";
    function ColumnAdaptor(userOptions, _innerOptions) {_classCallCheck(this, ColumnAdaptor);_defineProperty(this, "_columnFormatsConvert",








































































































































































































































































      function (column, innerOptions) {var _column$formats$type;
        var type = (_column$formats$type = column.formats.type) !== null && _column$formats$type !== void 0 ? _column$formats$type : "text";
        var innerColumn = {
          formats: {
            type: type
          }
        };
        var formatsFactory = new FormatsFactory();
        var innerColumnFormats = formatsFactory.getInnerColumnFormat(type.toUpperCase(), column, innerOptions);
        $.extend(true, innerColumn, innerColumnFormats);
        return innerColumn;
      });this._userOptions = userOptions;this._innerOptions = _innerOptions;return this;}_createClass(ColumnAdaptor, [{ key: "initialize", value: function initialize() {this._innerOptions._columns = {};this._innerOptions.styleColumn = [];if (typeof this._userOptions.columns !== "undefined") {this._userOptions.columns = this.uuidCreator(this._userOptions.columns);}this._innerOptions.columns = this.convertColumns(this._userOptions.columns);return this._innerOptions;} }, { key: "convertColumns", value: function convertColumns(columns) {var self = this;if (columns && self._userOptions.dataSource && self._userOptions.dataSource.options.field) {var d,innerColumns = [],innerColumn;self._innerOptions.columnsDepth = self._innerOptions.columnsDepth + 1;d = self._innerOptions.columnsDepth;$.each(columns, function (index, column) {if (columns[0].field === "__UUID") {column._multiHeaderColumnName = "_he@der_name_" + d + (index - 1);} else {column._multiHeaderColumnName = "_he@der_name_" + d + index;}innerColumn = self.convert(column, self._userOptions, self._innerOptions);innerColumns.push(innerColumn);self._innerOptions._columns[innerColumn.name] = innerColumn;});}return innerColumns;} }, { key: "convert", value: function convert(column, userOptions, innerOptions) {var innerColumn = {};if (!column) {return innerColumn;}setInnerColumnBase(this, column, innerColumn, innerOptions, userOptions);if (column.formats) {$.extend(true, innerColumn, this._columnFormatsConvert(column, innerOptions));}if (column.editor) {if (!innerColumn.editor) {innerColumn.editor = {};}var editorAlign = "center";if (innerColumn.styles.textAlignment) {editorAlign = innerColumn.styles.textAlignment;}if (typeof column.editor.type === "undefined") {innerColumn.editor.type = "string";$.extend(true, innerColumn, convertStringEditor(column));} else {innerColumn.editor.type = column.editor.type;}if (typeof innerColumn.editable === "boolean" && !innerColumn.editable && innerColumn.editor.type.toLowerCase() !== "check") {innerColumn.editor.editable = innerColumn.editable;} else if (innerColumn.editor.type.toLowerCase() === "check" && typeof column.editable === "boolean" && !column.editable) {innerColumn.editor.editable = column.editable;} else {if (typeof column.editor.editable === "boolean") {innerColumn.editable = column.editor.editable;innerColumn.editor.editable = column.editor.editable;} else if (typeof column.editor.editable === "undefined") {if (innerColumn.editor.type.toLowerCase() === "check") {innerColumn.editor.editable = column.editable !== void 0 ? column.editable : true;} else {innerColumn.editor.editable = innerColumn.editable;}}}innerColumn.editor.textAlignment = editorAlign;$.extend(true, innerColumn, this._columnEditorConvert(column));}if (typeof column.editor === "undefined") {innerColumn.editor = { type: "text", editable: innerColumn.editable, textAlignment: innerColumn.styles.textAlignment };}setInnerColumnAttributes(column, innerColumn, innerOptions);if (column.footer) {$.extend(true, innerColumn, this._columnFooterConvert(column, innerColumn.styles.textAlignment));}if (column.headerSummary) {this._headerSummary = new HeaderSummary(this);innerColumn.header.summary = this._headerSummary.initialize(column, innerColumn.styles.textAlignment);}if (typeof column.style === "function") {innerOptions.styleColumn.push(column.field);}setInnerColumnGrouping(column, innerColumn, innerOptions);setInnerColumnMultiColumnHeight(column, innerColumn, innerOptions);setInnerColumnMultiHeader(this, column, innerColumn, innerOptions);setInnerColumnCellMerge(column, innerColumn, innerOptions);return innerColumn;} }, { key: "_columnEditorConvert", value: function _columnEditorConvert(column) {var type = column.editor.type,innerOptions = this._innerOptions;if (!type) {return;}var editorFactory = new EditorFactory();return editorFactory.getInnerColumnEditor(type.toUpperCase(), column, innerOptions);} }, { key: "_columnFooterConvert", value: function _columnFooterConvert(column, stylesTextAlignment) {var innerColumn = {};innerColumn.footer = {};this._innerOptions.footer.visible = true;var multiFooterCnt = this._userOptions.multiFooterCnt;if (multiFooterCnt > 1) {this._innerOptions.footer.count = multiFooterCnt;this._innerOptions.footer.minHeight = 32 * multiFooterCnt;var multiFooterArray = [];if (Array.isArray(column.footer)) {multiFooterArray = column.footer;} else if (_typeof(column.footer) === "object") {multiFooterArray.push(column.footer);}var footerText = [];var footerStyles = [];var footerExpression = [];var footerPreCurrency = [];var footerPreFormat = [];var footerCallback;for (var footerIdx = 0; footerIdx < multiFooterArray.length; footerIdx++) {var footer = this._footerConvert(multiFooterArray[footerIdx], stylesTextAlignment);footerText.push(footer.text);footerStyles.push(footer.styles);footerExpression.push(footer.expression);footerPreCurrency.push(footer.preCurrency);footerPreFormat.push(footer.preFormat);if (footerIdx === 0) {if (!footer.expression) {footerCallback = footer.callback;}} else {if (footer.expression) {footerCallback = "";}}}innerColumn.footer.styles = footerStyles;innerColumn.footer.expression = footerExpression;innerColumn.footer.preCurrency = footerPreCurrency;innerColumn.footer.preFormat = footerPreFormat;innerColumn.footer.text = footerText;if (typeof footerCallback === "function") {innerColumn.footer.callback = footerCallback;innerColumn.footer.expression = "";}} else {this._innerOptions.footer.count = 1;innerColumn.footer = this._footerConvert(column.footer, stylesTextAlignment);}if (this._innerOptions._gridType === "GRID") {var footers = !Array.isArray(column.footer) ? [column.footer] : column.footer;footers.forEach(function (footer) {if (footer.group) {setColumnFooter(footer.group);}});}function setColumnFooter(group) {innerColumn.footer.groupExpression = group.type;if (group.text) {innerColumn.footer.groupText = group.text;}if (group.callback) {innerColumn.footer.groupCallback = group.callback;}}return innerColumn;} }, { key: "_footerConvert", value: function _footerConvert(userFooter, stylesTextAlignment) {var footer = {},footerAlign = "center";if (typeof userFooter.text === "string") {footer.text = userFooter.text;}if (typeof userFooter.predefined === "boolean") {footer.predefined = userFooter.predefined;}if (typeof userFooter.format === "string") {footer.format = userFooter.format;}if (typeof userFooter.callback === "function") {footer.callback = userFooter.callback;}footer.styles = {};if (userFooter.styles === void 0) {if (stylesTextAlignment) {footerAlign = stylesTextAlignment;}footer.styles = { textAlignment: footerAlign };}if (typeof userFooter.suffix !== "undefined") {footer.styles.suffix = userFooter.suffix;}if (typeof userFooter.prefix !== "undefined") {footer.styles.prefix = userFooter.prefix;}if (typeof userFooter.align !== "undefined") {switch (userFooter.align.toLowerCase()) {case "left":footer.styles.textAlignment = "near";break;case "right":footer.styles.textAlignment = "far";break;default:footer.styles.textAlignment = "center";break;}}if (userFooter.type) {if (typeof this._innerOptions.fieldIndex !== "undefined" && userFooter.type.toLowerCase() !== "count") {this._innerOptions.dataSource.options.field[this._innerOptions.fieldIndex].dataType = "number";this._innerOptions.dataSource.options.schema.model.fields[this._innerOptions.fieldIndex].dataType = "number";}footer.expression = userFooter.type;footer.styles.numberFormat = typeof userFooter.format === "undefined" ? "#,##0.##" : userFooter.format;if (userFooter.predefined === true) {if (typeof userFooter.preFormat === "undefined" || userFooter.preFormat !== userFooter.format) {footer.preFormat = userFooter.format;}var preDefinedFormat = dews.getPreDefinedFormat(footer);if ($.type(userFooter.currency) !== "undefined") {if ($.type(userFooter.currency) === "string") {footer.preCurrency = userFooter.currency;footer.currency = userFooter.currency;preDefinedFormat = dews.getCurrencyFormat(footer);if (preDefinedFormat) {var round = typeof preDefinedFormat.round === "string" ? preDefinedFormat.round : "round";if (round !== "round") {if (preDefinedFormat.format.split(".").length === 2) {if (round === "ceil") {preDefinedFormat.format += ";;;c";} else {preDefinedFormat.format += ";;;f";}}}}} else if (typeof userFooter.currency === "function") {footer.preCurrency = userFooter.currency;footer.currency = userFooter.currency;userFooter.preCurrency = "";}}if (_typeof(preDefinedFormat) === "object") {preDefinedFormat = preDefinedFormat.format;}if (preDefinedFormat) {footer.styles.numberFormat = preDefinedFormat;} else {footer.styles.numberFormat = "#,##0.##";}}}return footer;} }, { key: "uuidCreator", value:
      function uuidCreator(columns) {
        var f = columns.some(function (column) {
          return column.field === "__UUID";
        });
        if (!f) {
          columns.splice(0, 0, {
            field: "__UUID",
            fieldName: "__UUID",
            name: "__UUID",
            visible: false,
            header: { text: " " }
          });
        }
        return columns;
      } }]);return ColumnAdaptor;}();

  dews.ui.grid.ColumnAdaptor = ColumnAdaptor;

  // src/js/grid/note/GridNote.js
  function GridNote() {
  }
  GridNote.prototype.initialize = function (grid2, option, e, noteIndex) {
    var noteColumn, rendererType;
    noteColumn = setNoteIconColumn(grid2, option);
    rendererType = setRendererType(noteColumn);
    noteIndex.forEach(function (index) {
      NoteFlag(grid2, noteColumn, index, rendererType, true);
    });
  };
  GridNote.prototype.renderIcon = function (grid2, itemIndex, _isNote) {
    if (!grid2.options.note)
    return null;
    var noteColumn, rendererType;
    noteColumn = setNoteIconColumn(grid2, grid2.options.note);
    rendererType = setRendererType(noteColumn);
    NoteFlag(grid2, noteColumn, grid2.getDataIndexFromItemIndex(itemIndex), rendererType, _isNote);
  };
  GridNote.prototype.boundingDraw = function (gridView, grid2, dataBoundParameter) {
    var arr = gridView.name.split("_");
    var gridKey = arr[arr.length - 1];
    var noteIndex = [],memoIndex = [],clrArr = [];
    if (dews.ui.page.option === void 0 && dews.ui.page.useGridNote === "Y") {
      dews.api.get(dews.url.getApiUrl("CM", "GridNoteService", "gridList"), {
        async: false,
        data: {
          gridCode: gridKey,
          menuCode: dews.ui.page.menu.id
        }
      }).done(function (data) {
        var gridList = data;
        if (gridList.length < 1) {
          return null;
        }
        gridList.forEach(function (v) {
          var gridNoteKey = v.gridNoteKey.split("|");
          var obj = {};
          gridNoteKey.forEach(function (currentValue) {
            var valueKey = currentValue.split(":")[0];
            obj[valueKey] = currentValue.substr(valueKey.length + 1);
          });
          Object.keys(obj).forEach(function (key) {
            if (grid2.columns[key] && grid2.columns[key].formats && grid2.columns[key].formats.type === "date") {
              obj[key] = get_date_str(new Date(obj[key]));
            }
          });
          var noteI = gridView._dataSource.searchDataRow({
            fields: Object.keys(obj),
            values: Object.values(obj)
          });
          if (noteI > -1) {
            noteIndex.push(noteI);
            if (v.existGdntTxt === "Y") {
              memoIndex.push(noteI);
            }
            clrArr[grid2.getItemIndexFromDataIndex(noteI)] = v.glcCode;
          }
          grid2._colorLine.useColorLine = v.glcUseYn;
        });
      }).fail(function (e, xhr) {
        console.log(e);
      });
      memoIndex = _toConsumableArray(new Set(memoIndex));
      for (var i = 0; i < clrArr.length; i++) {
        if (clrArr[i] === void 0) {
          clrArr[i] = null;
        }
      }
      if (grid2.options.note && $.type(grid2.options.note) === "object") {
        grid2._gridNote.initialize(grid2, grid2.options.note, dataBoundParameter, memoIndex);
        grid2._colorLine.initialize(grid2, clrArr, dataBoundParameter);
      }
    }
  };
  function NoteFlag(grid2, column, rowIndex, _renderer, _isNote) {
    if (!column)
    return null;
    var styles = {
      iconLocation: "left",
      iconAlignment: "left",
      paddingLeft: column.align === "left" ? 6 : 0,
      paddingTop: 0,
      iconIndex: -1
    };
    var renderType = {
      type: _renderer
    };
    var imgs = new RealGridJS.ImageList("_noteIcon", dews._environments.scriptBase + "realgrid/assets/");
    imgs.addUrls(["ico-pin-memo.png"]);
    grid2._grid.registerImageList(imgs);
    grid2._grid.setColumnProperty(column.field, "imageList", "_noteIcon");
    grid2._grid.setColumnProperty(column.field, "renderer", renderType);
    grid2._grid.setColumnProperty(column.field, "styles", styles);
    styles.iconIndex = _isNote ? 0 : -1;
    if (column.align === "left") {
      styles.paddingLeft = _isNote ? 0 : 6;
    }
    var iconIndex = grid2.options._gridType === "GRID" ? grid2.getItemIndexFromDataIndex(rowIndex) : rowIndex;
    grid2.setCellStyle(iconIndex, column.field, styles, true);
  }
  function setNoteIconColumn(grid2, option) {
    var markFieldNote, noteColumn;
    if (option.markField) {
      markFieldNote = option.markField;
    } else {
      if ($.type(grid2._grid.getDisplayColumns()[0]) !== "string") {
        markFieldNote = grid2._grid.getDisplayColumns()[0].columns[0];
      } else {
        markFieldNote = grid2._grid.getDisplayColumns()[0];
      }
    }
    noteColumn = grid2.columns[markFieldNote];
    return noteColumn;
  }
  function setRendererType(noteColumn) {
    var _renderer,rendererType = ["LINK", "CHECK", "IMAGE", "BAR", "SIGNAL", "BUTTON"];
    if (noteColumn.editor || noteColumn.formats) {
      var columnType = (noteColumn.editor || noteColumn.formats).type.toUpperCase();
      _renderer = rendererType.indexOf(columnType) !== -1 ? "multiIcon" : "icon";
    }
    return _renderer;
  }
  function get_date_str(date) {
    var sYear = date.getFullYear();
    var sMonth = date.getMonth() + 1;
    var sDate = date.getDate();
    sMonth = sMonth > 9 ? sMonth.toString() : "0" + sMonth;
    sDate = sDate > 9 ? sDate.toString() : "0" + sDate;
    return sYear + sMonth + sDate;
  }

  // src/js/grid/note/ColorLine.js
  function ColorLine() {
  }
  ColorLine.prototype.initialize = function (grid2, clrArr, e) {
    var data = e.row.data;
    if (!data)
    return null;
    grid2._colorLine.rowDynamic = [];
    for (var i = 0; i < Object.keys(clrArr).length; i++) {
      grid2._colorLine.addColorLine(grid2, Object.values(clrArr)[i], Object.keys(clrArr)[i]);
    }
  };
  ColorLine.prototype.addColorLine = function (grid2, color, rowIndex) {
    if (color === null) {
      return null;
    }
    rowIndex = grid2.getDataIndexFromItemIndex(rowIndex);
    grid2._grid.setStyles({
      body: {
        line: "#00ffffff"
      }
    });
    grid2.setRowStyle(
    rowIndex,
    {
      borderBottom: color
    },
    true);

  };
  ColorLine.prototype.removeColorLine = function (grid2, rowIndex) {
    rowIndex = grid2.getDataIndexFromItemIndex(rowIndex);
    grid2.resetRowStyle(rowIndex);
  };
  ColorLine.prototype.activateColorLine = function (grid2) {
    grid2._colorLine.useColorLine = "Y";
    grid2._grid.setStyles({
      body: {
        dynamicStyles: grid2.options.rowDynamic
      }
    });
  };
  ColorLine.prototype.disabledColorLine = function (grid2) {
    grid2._colorLine.useColorLine = "N";
    var colorLineStyles = grid2._colorLine.rowDynamic;
    var gridStyles = grid2.options.rowDynamic;
    var extraStyle = [];
    gridStyles.forEach(function (v) {
      if (!(colorLineStyles.indexOf(v) !== -1)) {
        extraStyle.push(v);
      }
    });
    grid2._grid.setStyles({
      body: {
        dynamicStyles: extraStyle
      }
    });
  };

  // src/js/grid/customTheme/posco.js
  var setPOSCO = /*#__PURE__*/_createClass(function setPOSCO() {"use strict";_classCallCheck(this, setPOSCO);});

  setPOSCO.prototype.style = function () {
    return {
      body: {
        height: 24,
        paddingLeft: 10,
        paddingRight: 10,
        requiredBackground: "#f4fcfd",
        requiredFocusBackground: "#f4fcfd",
        selectedBackground: "#ff696969",
        checkedImg: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAMAAAC67D+PAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAABpUExURRVSoRNSohVRoBRSogBSpgBRpgBRpQ5cqx9nsQFTphJerJCz2Ja42gRVqAJUpzl5uh1msA9cq5G02cPW6jp5ugRVp5a4263H46C+3sHV6Tt6uwBQpSJpsq/I48vb7Tt6uhVgrR5msP///2A+C0oAAAADdFJOU4v1jJrT6kwAAAABYktHRCJdZVysAAAAB3RJTUUH5wMVBBwLkV5w7gAAAFFJREFUCNctzUcWgEAIA1AQBnvvjvX+l3TiM6u/IIGI5QsTsSLOlEkgi5NUAp1alhdlYFU3bdcPGjhO87JuHnT7cV6m+t3eD6qCMfMghv8X0QugKgMopiPBGAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0wMy0yMVQwNDoyODowNCswMDowMJOr+/0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjMtMDMtMjFUMDQ6Mjg6MDQrMDA6MDDi9kNBAAAAKHRFWHRkYXRlOnRpbWVzdGFtcAAyMDIzLTAzLTIxVDA0OjI4OjExKzAwOjAwK3FNpwAAAABJRU5ErkJggg==",
        unCheckImg: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKBAMAAAB/HNKOAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAASUExURdvh6+Hm7tzh6+Lm7v39/v///00AeYoAAAADdFJOU4v1jJrT6kwAAAABYktHRAX4b+nHAAAAB3RJTUUH5wMVBBwLkV5w7gAAAB9JREFUCNdjYDQ2NhZgEAkNDXVkMAWSwQRIiEqQLiEAiGkNKYmpiRAAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDMtMjFUMDQ6Mjg6MDMrMDA6MDBWDMVzAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTAzLTIxVDA0OjI4OjAzKzAwOjAwJ1F9zwAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyMy0wMy0yMVQwNDoyODoxMSswMDowMCtxTacAAAAASUVORK5CYII="
      },
      indicator: {
        head: {
          fontBold: false
        },
        fontBold: false,
        background: "#f0f0f0",
        hoveredBackground: "#f0f0f0",
        selectedBackground: "#f0f0f0",
        focusBorderColor: "#000000"
      },
      fixed: {
        paddingLeft: 10,
        paddingRight: 10
      },
      header: {
        height: 28,
        fontBold: false,
        paddingLeft: 10,
        paddingRight: 10,
        hoveredBackground: "rgba(67,144,244,0.1)",
        group: {
          paddingLeft: 10,
          paddingRight: 10
        },
        summary: {
          paddingLeft: 10,
          paddingRight: 10
        }
      },
      footer: {
        height: 28,
        paddingLeft: 10,
        paddingRight: 10
      },
      rowGroup: {
        footer: {
          paddingLeft: 10,
          paddingRight: 10
        }
      },
      scrollBar: {
        background: "#f1f1f1",
        thumb: "#c1c1c1",
        button: {
          background: "#f1f1f1"
        }
      },
      selection: {
        focusBorderColor: "",
        focusBackgroundColor: "",
        selectedBackground: "#000000"
      },
      tree: {
        expander: {
          figureBackground: "#1e52a0"
        }
      }
    };
  };
  setPOSCO.prototype.option = function () {
    return {
      checkBar: {
        width: 28,
        drawCheckBox: false,
        checkImageUrl: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAMAAAC67D+PAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAABpUExURRVSoRNSohVRoBRSogBSpgBRpgBRpQ5cqx9nsQFTphJerJCz2Ja42gRVqAJUpzl5uh1msA9cq5G02cPW6jp5ugRVp5a4263H46C+3sHV6Tt6uwBQpSJpsq/I48vb7Tt6uhVgrR5msP///2A+C0oAAAADdFJOU4v1jJrT6kwAAAABYktHRCJdZVysAAAAB3RJTUUH5wMVBBwLkV5w7gAAAFFJREFUCNctzUcWgEAIA1AQBnvvjvX+l3TiM6u/IIGI5QsTsSLOlEkgi5NUAp1alhdlYFU3bdcPGjhO87JuHnT7cV6m+t3eD6qCMfMghv8X0QugKgMopiPBGAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0wMy0yMVQwNDoyODowNCswMDowMJOr+/0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjMtMDMtMjFUMDQ6Mjg6MDQrMDA6MDDi9kNBAAAAKHRFWHRkYXRlOnRpbWVzdGFtcAAyMDIzLTAzLTIxVDA0OjI4OjExKzAwOjAwK3FNpwAAAABJRU5ErkJggg==",
        unCheckImageUrl: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKBAMAAAB/HNKOAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAASUExURdvh6+Hm7tzh6+Lm7v39/v///00AeYoAAAADdFJOU4v1jJrT6kwAAAABYktHRAX4b+nHAAAAB3RJTUUH5wMVBBwLkV5w7gAAAB9JREFUCNdjYDQ2NhZgEAkNDXVkMAWSwQRIiEqQLiEAiGkNKYmpiRAAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDMtMjFUMDQ6Mjg6MDMrMDA6MDBWDMVzAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTAzLTIxVDA0OjI4OjAzKzAwOjAwJ1F9zwAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyMy0wMy0yMVQwNDoyODoxMSswMDowMCtxTacAAAAASUVORK5CYII=",
        headCheckImageUrl: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAMAAAC67D+PAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAABpUExURRVSoRNSohVRoBRSogBSpgBRpgBRpQ5cqx9nsQFTphJerJCz2Ja42gRVqAJUpzl5uh1msA9cq5G02cPW6jp5ugRVp5a4263H46C+3sHV6Tt6uwBQpSJpsq/I48vb7Tt6uhVgrR5msP///2A+C0oAAAADdFJOU4v1jJrT6kwAAAABYktHRCJdZVysAAAAB3RJTUUH5wMVBBwLkV5w7gAAAFFJREFUCNctzUcWgEAIA1AQBnvvjvX+l3TiM6u/IIGI5QsTsSLOlEkgi5NUAp1alhdlYFU3bdcPGjhO87JuHnT7cV6m+t3eD6qCMfMghv8X0QugKgMopiPBGAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0wMy0yMVQwNDoyODowNCswMDowMJOr+/0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjMtMDMtMjFUMDQ6Mjg6MDQrMDA6MDDi9kNBAAAAKHRFWHRkYXRlOnRpbWVzdGFtcAAyMDIzLTAzLTIxVDA0OjI4OjExKzAwOjAwK3FNpwAAAABJRU5ErkJggg==",
        headUnCheckImageUrl: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKBAMAAAB/HNKOAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAASUExURdvh6+Hm7tzh6+Lm7v39/v///00AeYoAAAADdFJOU4v1jJrT6kwAAAABYktHRAX4b+nHAAAAB3RJTUUH5wMVBBwLkV5w7gAAAB9JREFUCNdjYDQ2NhZgEAkNDXVkMAWSwQRIiEqQLiEAiGkNKYmpiRAAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDMtMjFUMDQ6Mjg6MDMrMDA6MDBWDMVzAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTAzLTIxVDA0OjI4OjAzKzAwOjAwJ1F9zwAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyMy0wMy0yMVQwNDoyODoxMSswMDowMCtxTacAAAAASUVORK5CYII="
      },
      indicator: {
        headText: "NO"
      }
    };
  };

  // src/js/grid/dews.ui.treegrid.js
  function getOptions3(self, options) {
    var treeGrid = self._grid,opt2,defaultOptions2 = {
        panel: {
          visible: false
        },
        checkBar: {
          visible: true,
          checkImageUrl: options.gridStyle.checkBar.checkedImg,
          unCheckImageUrl: options.gridStyle.checkBar.unCheckImg,
          headCheckImageUrl: options.gridStyle.checkBar.checkedImg,
          headUnCheckImageUrl: options.gridStyle.checkBar.unCheckImg
        },
        stateBar: {
          visible: false
        },
        header: {
          minHeight: options.gridStyle.header.height,
          heightFill: "fixed"
        },
        footer: {
          visible: false,
          height: options.gridStyle.footer.height,
          minHeight: options.gridStyle.footer.height
        },
        indicator: {
          visible: true,
          headText: "No",
          footText: " "
        },
        edit: {
          insertable: false,
          appendable: false,
          editable: false,
          crossWhenExitLast: true,
          showInvalidFormatMessage: false,
          enterToTab: true,
          checkDiff: true,
          skipReadOnly: false
        },
        display: {
          fitStyle: "even",
          showEmptyMessage: false,
          emptyMessage: "",
          showEmptyImage: true,
          rowHeight: options.gridStyle.body.height,
          minHeight: options.gridStyle.body.height,
          focusColor: options.gridStyle.selection.focusBorderColor,
          focusBorderWidth: "2px",
          innerFocusColor: options.gridStyle.selection.focusBorderColor,
          showInnerFocus: true,
          columnMovable: options.movable ? options.movable : false,
          columnResizable: true,
          editingMergedRow: false,
          editItemMerging: true,
          heightMeasurer: "fixed",
          wheelEventPropagate: false
        },
        copy: {
          singleMode: false,
          copyDisplayText: true
        },
        paste: {
          singleMode: false,
          checkReadOnly: true,
          noEditEvent: true,
          numberChars: [",", " "]
        },
        select: {
          style: "block"
        },
        sorting: {
          enabled: true,
          keepFocusedRow: true
        },
        fixed: {
          colBarWidth: 1
        },
        dataBounding: false,
        rowDynamic: [],
        autoBind: true,
        depth: 1,
        columnsDepth: 0,
        maxDepth: 1,
        grouping: false,
        groupCol: 1,
        maxGroupCol: 1,
        context: true,
        editSkip: false,
        copyMode: "row",
        isVisible: true,
        fillWidth: true,
        images: [],
        icons: [],
        displayColumns: [],
        _originColumns: [],
        multiFooterCnt: 1,
        shiftCheck: dews._environments.gridShiftCheck,
        detailGrid: {
          addedRowDataSourceRead: true
        }
      };
    opt2 = $.extend(true, defaultOptions2, options);
    opt2._originColumns = [].concat(opt2.columns);
    if ($.type(opt2.rowNo) !== "undefined") {
      if ($.type(opt2.rowNo) === "object") {
        opt2.indicator.visible = true;
        opt2.indicator.headText = $.type(opt2.rowNo.text) === "undefined" ? opt2.indicator.headText : opt2.rowNo.text;
        opt2.indicator.width = $.type(opt2.rowNo.width) === "undefined" ? 40 : opt2.rowNo.width;
      } else if ($.type(opt2.rowNo) === "boolean") {
        opt2.indicator.visible = opt2.rowNo;
      }
    }
    if ($.type(opt2.selectable) !== "undefined") {
      if (opt2.selectable === true) {
        opt2.display.rowFocusVisible = true;
        opt2.display.rowFocusBackground = opt2.gridStyle.selectionBackground;
      } else if (opt2.selectable === false) {
        opt2.display.rowFocusVisible = false;
        delete opt2.display.rowFocusBackground;
      }
    }
    if ($.type(opt2.sortable) !== "undefined") {
      opt2.sorting.enabled = opt2.sortable;
    }
    if ($.type(opt2.sort) !== "undefined") {
      opt2.sorting.sort = opt2.sort;
    }
    if ($.type(opt2.editable) !== "undefined") {
      opt2.edit.editable = opt2.editable;
    }
    if ($.type(opt2.checkable) !== "undefined") {
      opt2.checkBar.visible = opt2.checkable;
    }
    if ($.type(opt2.stateColumn) === "boolean") {
      opt2.stateBar.visible = opt2.stateColumn;
    }
    if ($.type(opt2.readOnly) !== "undefined") {
      opt2.edit.readOnly = opt2.readOnly;
    }
    if ($.type(opt2.editSkip) === "boolean" && opt2.editSkip) {
      opt2.editSkip = true;
      opt2.edit.skipReadOnly = true;
    }
    if ($.type(opt2.noData) === "boolean") {
      opt2.display.showEmptyMessage = opt2.noData;
      opt2.display.showEmptyImage = opt2.noDataImage || opt2.display.showEmptyImage;
      if (opt2.display.showEmptyMessage && $.type(opt2.noDataMessage) !== "undefined") {
        opt2.display.emptyMessage = opt2.noDataMessage;
      } else {
        opt2.display.emptyMessage = dews.localize.get("\uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.", "dews_\uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");
      }
    }
    if (!opt2.fillWidth) {
      opt2.display.fitStyle = "none";
    }
    if ($.type(opt2.resizable) === "boolean") {
      opt2.display.columnResizable = opt2.resizable;
    }
    if ($.type(opt2.pasteMode) !== "undefined") {
      opt2.paste.singleMode = opt2.pasteMode === "cell";
    }
    if (opt2.selectionMode === "cell") {
      opt2.select.style = "none";
    } else {
      opt2.select.style = "block";
    }
    if (typeof opt2.filter === "boolean") {
      opt2.filter.use = opt2.filter;
    } else if (_typeof(opt2.filter) === "object") {
      if (opt2.filter.iconVisible) {
        opt2.filtering.handleImages = {
          none: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-off.png",
          fill: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png",
          hoveredNone: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-off.png",
          hoveredFill: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png"
        };
      } else {
        opt2.filtering.handleImages = {
          none: "",
          fill: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png",
          hoveredNone: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-off.png",
          hoveredFill: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png"
        };
      }
    }
    opt2 = setStyles2(treeGrid, opt2);
    opt2.styleColumn = [];
    __initialize2(self);
    opt2 = treeCustomizingColumn(opt2.columns, opt2, self);
    delete opt2.fieldIndex;
    treeGrid.setColumns(opt2.columns);
    treeGrid.setHeader({ height: opt2.maxDepth * opt2.header.minHeight });
    treeGrid.setFooter({
      minHeight: opt2.footer.minHeight,
      height: opt2.footer.height
    });
    if (opt2.grouping) {
      opt2.display.rowHeight = opt2.display.minHeight * opt2.maxGroupCol;
    }
    if (opt2.dataSource) {
      opt2.dataSource.options.imageField = opt2.imageField || "";
    }
    self._grid.setTreeOptions({
      expanderWidth: 15,
      iconWidth: 0
    });
    return opt2;
  }
  function findUserOptionsColumn6(columns, fieldName, userColumn) {
    if (!columns)
    return null;
    for (var index = 0; index < columns.length; index++) {
      if (userColumn === void 0) {
        if (columns[index].field === fieldName) {
          userColumn = columns[index];
        } else if (columns[index].columns) {
          userColumn = findUserOptionsColumn6(columns[index].columns, fieldName, userColumn);
        }
      }
    }
    return userColumn;
  }
  function __initialize2(treeGrid) {
    if (treeGrid._filterManager) {
      treeGrid._filterManager._columns = {};
      treeGrid._filterManager._options.filter.useColumns = [];
    }
  }
  function setStyles2(treeGrid, options) {
    var self = treeGrid,opt2 = options;
    return opt2 = dews.ui.gridUtil.setStyles(self, opt2);
  }
  var TreeGrid = /*#__PURE__*/function (_DewsGrid2) {"use strict";_inherits(TreeGrid, _DewsGrid2);var _super12 = _createSuper(TreeGrid);
    function TreeGrid(element, options) {var _this5;_classCallCheck(this, TreeGrid);
      _this5 = _super12.call(this, element);
      var self = _assertThisInitialized(_this5),option,realTreeGrid,realTreeGridID,id = element.attr("ID");
      _this5.initializeTreeGrid();
      _this5.controlAuthority(options);
      option = $.extend(true, {}, options);
      self.userOptions = $.extend(true, {}, options);
      self._innerOptions = {};
      _this5._initOneGrid();
      var gridOptionAdaptor = new dews.ui.grid.GridOptionAdaptor("TREEGRID");
      _this5.optionAdaptor = gridOptionAdaptor;
      var styleCreator = dews.ui.grid.StyleCreator.getInstance();
      self._filterManager = new dews.ui.grid.FilterManager(self, "TREEGRID");
      gridOptionAdaptor._filterManager = self._filterManager;
      self._columnRenderer = new ColumnRenderer();
      gridOptionAdaptor._columnRenderer = self._columnRenderer;
      self._gridNote = new GridNote();
      gridOptionAdaptor._gridNote = self._gridNote;
      self._colorLine = new ColorLine();
      gridOptionAdaptor._colorLine = self._colorLine;
      self._innerOptions = gridOptionAdaptor.convert(self.userOptions);
      if (styleCreator.theme === "posco") {
        var customOption = new setPOSCO();
        self._innerOptions = $.extend(true, self._innerOptions, customOption.option());
      }
      var _columnAdaptor = new ColumnAdaptor();
      if (typeof option.columns !== "undefined") {
        _columnAdaptor.uuidCreator(option.columns);
      }
      self.dataSource = self._innerOptions.dataSource;
      dews.ui.gridUtil.gridStyle = styleCreator.gridStyle;
      realTreeGrid = $("<div></div>");
      if (dews.ui.dialogPage && element.closest(dews.ui.dialogPage.$content).length) {
        self._innerOptions.$content = dews.ui.dialogPage.$content;
        realTreeGridID = dews.ui.dialogPage.id + "_" + id;
      } else if (dews.ui.page && element.closest(dews.ui.page.$content).length) {
        self._innerOptions.$content = dews.ui.page.$content;
        realTreeGridID = dews.ui.page.id + "_" + id;
      } else {
        self._innerOptions.$content = $(document);
        realTreeGridID = "child_" + id;
      }
      realTreeGridID = realTreeGridID.replace(/ /gi, "");
      realTreeGrid.attr("ID", realTreeGridID);
      $("#" + id, self._innerOptions.$content).append(realTreeGrid);
      if (self._innerOptions.height) {
        realTreeGrid.css("height", self._innerOptions.height + "px");
      } else {
        realTreeGrid.css("height", "635px");
      }
      self._grid = new RealGridJS.TreeView(realTreeGridID);
      self._grid.name = realTreeGridID;
      self.$element = $("#" + self._grid.name);
      $.extend(true, option, self._innerOptions);
      option._originColumns = [].concat(option.columns);
      _this5._createOneGridButton(realTreeGrid);
      if ($.type(self.userOptions.rowStyle) === "function") {
        self._innerOptions.gridStyle.body.dynamicStyles = function (grids, index) {
          var treegrid = $(grids._gv._container._containerDiv).closest(".dews-data-control").data("dews-control");
          var params = {
            treegrid: treegrid,
            row: {
              index: treegrid._grid.getDataRow(index.itemIndex),
              data: treegrid.dataItem(treegrid._grid.getDataRow(index.itemIndex))
            }
          };
          var style = $.extend(true, {}, treegrid.options.rowStyle.call(treegrid, params));
          if (style.color) {
            style.foreground = style.color;
          }
          if (style.textAlign) {
            switch (style.textAlign) {
              case "left":
                style.textAlignment = "near";
                break;
              case "right":
                style.textAlignment = "far";
                break;
              case "center":
                style.textAlignment = "center";
                break;}

          }
          if (style.verticalAlign) {
            switch (style.verticalAlign.toLowerCase()) {
              case "top":
                style.lineAlignment = "near";
                break;
              case "bottom":
                style.lineAlignment = "far";
                break;
              case "middle":
                style.lineAlignment = "center";
                break;}

          }
          return style;
        };
      }
      self._grid.setStyles(self._innerOptions.gridStyle);
      setRealGridColumns(self, self._innerOptions.columns, self._innerOptions);
      $.extend(true, option, self._innerOptions);
      self._grid.setColumns(self._innerOptions.columns);
      self._grid.setHeader({
        height: self._innerOptions.maxDepth * self._innerOptions.header.minHeight
      });
      self._grid.setFooter({
        minHeight: self._innerOptions.footer.minHeight,
        height: self._innerOptions.footer.height
      });
      if (self.userOptions.dataSource && self.userOptions.dataSource.dataProvider) {
        self.userOptions.dataSource.dataProvider.setFields(self.userOptions.dataSource.options.field);
        self._grid.setDataProvider(self.userOptions.dataSource.dataProvider);
      }
      self._grid.setTreeOptions({
        expanderWidth: 15,
        iconWidth: 0
      });
      self._grid.setOptions(self._innerOptions);
      self.options = option;
      self.focused = false;
      self.columns = {};
      if (self._innerOptions.columns) {
        dews.ui.gridUtil._setColumns(self, option.columns);
      }
      self._setOneGridData();
      self.useCssStyle();
      self._filterManager.setFilterActions(self);
      if (self._innerOptions.filter.use) {
        self._grid.onFilterActionClicked = function (_grid, column, action, x, y) {
          if ($(".dews-grid-user-filter-layer").length > 0) {
            return false;
          }
          if (action === column + "_filterAction") {
            self._filterManager.createFilterLayer(column, x, y);
          }
        };
        var filterBeforeDataIndex = -1;
        self._grid.onFiltering = function (grid2) {
          var itemIndex = self.select();
          var dataIndex = self.getDataIndexFromItemIndex(itemIndex);
          filterBeforeDataIndex = dataIndex;
        };
        self._grid.onFilteringChanged = function (grid2, column) {
          if (column) {
            var itemIndex = self.select();
            var dataIndex = self.getDataIndexFromItemIndex(itemIndex);
            if (filterBeforeDataIndex != dataIndex) {
              grid2.onCurrentChanged.call(self, grid2, grid2.getCurrent());
            }
          }
        };
      }
      if (_typeof(self._innerOptions._sortOrderBy) === "object") {
        self._grid.orderBy(self._innerOptions._sortOrderBy.field, self._innerOptions._sortOrderBy.dir);
      }
      self._bindEvent();
      element.data("dews-control", self);
      if (self._innerOptions.dataSource && self._innerOptions.autoBind) {
        self._innerOptions.dataSource.read();
      }
      if (self._innerOptions.context !== false) {
        self.setContextMenu(self._innerOptions.context);
        self._innerOptions.contextMenu = self.options.contextMenu;
      }
      setTimeout(function () {
        self._grid.resetSize();
      }, 100);
      if (self.options.columns) {
        dews.ui.gridUtil.displayColumns(self, self._grid.getDisplayColumns());
        if (self.options.displayColumns[0] !== void 0) {
          self._grid.setColumnProperty(self.options.displayColumns[0].field, "styles", { paddingLeft: 4 });
        }
      }
      if (dews.ui.page.useGridNote === "Y" && self.options.note) {
        var tabPanel = self.$element.closest(".dews-ui-tab-panel").data("dews-control");
        if (tabPanel) {
          tabPanel.on("change", function () {var _dews$ui$page$gridNot2;
            (_dews$ui$page$gridNot2 = dews.ui.page.gridNote) === null || _dews$ui$page$gridNot2 === void 0 ? void 0 : _dews$ui$page$gridNot2.close();
          });
        }
      }return _this5;
    }return _createClass(TreeGrid);}(DewsGrid);

  function setRealGridColumns(treeGrid, columns, innerOptions) {
    $.each(columns, function (index) {
      var column = columns[index];
      if (column.headerCheck) {
        treeGrid._grid.setColumnHeaderOptions({
          checkVisibility: "visible",
          imageCheckHandle: true,
          checkImages: {
            none: innerOptions.gridStyle.body.unCheckImg,
            hoveredNone: innerOptions.gridStyle.body.unCheckImg,
            fill: innerOptions.gridStyle.body.checkedImg,
            hoveredFill: innerOptions.gridStyle.body.checkedImg
          }
        });
      }
      if (column.formats) {
        var columnFormatsType;
        if (column.formats.type) {
          columnFormatsType = column.formats.type.toUpperCase();
        }
        if (columnFormatsType === "DATASOURCE") {
          var value = column.formats.dataValueField,label = column.formats.dataTextField,cfDataSource = column.formats.dataSource,cfDataSourceData;
          if (cfDataSource) {
            cfDataSource.fetch().done(function () {
              var values2 = [],labels2 = [],newColumn = treeGrid._grid.columnByField(column.fieldName);
              cfDataSourceData = cfDataSource.data();
              if (cfDataSourceData.length > 0) {
                for (var k = 0; k < cfDataSourceData.length; k++) {
                  values2.push(cfDataSourceData[k][value]);
                  labels2.push(cfDataSourceData[k][label]);
                }
              }
              if (!newColumn) {
                newColumn = column;
              }
              newColumn.values = values2;
              newColumn.labels = labels2;
              treeGrid._grid.setColumn(newColumn);
            });
          }
        }
      }
      if (column.editor) {
        var columnEditorType;
        if (column.editor.type) {
          columnEditorType = column.editor.type.toUpperCase();
        }
        if (columnEditorType === "DROPDOWN" || columnEditorType === "COMBO") {
          var dataSource = column.editor.dataSource,values = column.editor.dataValueField,labels = column.editor.dataTextField;
          column.values = [];
          column.labels = [];
          column.editButtonVisibility = "visible";
          if (typeof column.editor.dataSource === "function") {
            dataSource = column.editor.dataSource.call(treeGrid, {
              treeGrid: treeGrid,
              row: {
                index: 0,
                data: {
                  labels: "",
                  values: ""
                }
              }
            });
          }
          var dataSelectable = column.editor.dataSelectable;
          column.editor.values = [];
          column.editor.labels = [];
          if (dataSource && dataSource.transport && dataSource.transport.data && dataSource.transport.data.length > 0) {
            var transportData = dataSource.transport.data;
            for (var j = 0; j < dataSource.transport.data.length; j += 1) {
              column.values.push(transportData[j][values]);
              column.labels.push(transportData[j][labels]);
              if (dataSelectable && transportData[j][dataSelectable.field] !== dataSelectable.falseValue) {
                column.editor.values.push(dataSource.transport.data[j][values]);
                column.editor.labels.push(dataSource.transport.data[j][labels]);
              }
            }
          }
        } else if (columnEditorType === "TIME") {
          if ($("#" + treeGrid._grid.name + "_time").length === 0) {
            var timePicker = $('<input class="dews-ui-timepicker">');
            timePicker.prop("id", treeGrid._grid.name + "_time");
            $("body").after(timePicker);
            column.timepicker = dews.ui.timepicker(timePicker, {
              secondValue: column._secondValue
            });
            $("body").after(column.timepicker.timeView.ul.parent(".k-list-container"));
          } else {
            column.timepicker = dews.ui.timepicker($("#" + treeGrid._grid.name + "_time"));
          }
          column.timepicker.wrapper.css({
            display: "none",
            height: innerOptions.display.rowHeight
          });
        } else if (columnEditorType === "MONTH") {
          if ($("#" + treeGrid._grid.name + "_month").length === 0) {
            var monthPicker = $('<input class="dews-ui-monthpicker">');
            monthPicker.prop("id", treeGrid._grid.name + "_month");
            $("body").after(monthPicker);
            column.monthpicker = dews.ui.monthpicker(monthPicker);
            $("body").after(column.monthpicker.dateView.div);
          } else {
            column.monthpicker = dews.ui.monthpicker($("#" + treeGrid._grid.name + "_month"));
          }
          column.monthpicker.wrapper.css({
            display: "none",
            height: innerOptions.display.rowHeight
          });
        } else if (columnEditorType === "YEAR") {
          if ($("#" + treeGrid._grid.name + "_year").length === 0) {
            var yearPicker = $('<input class="dews-ui-yearpicker">');
            yearPicker.prop("id", treeGrid._grid.name + "_year");
            $("body").after(yearPicker);
            column.yearpicker = dews.ui.yearpicker(yearPicker);
            $("body").after(column.yearpicker.dateView.div);
          } else {
            column.yearpicker = dews.ui.yearpicker($("#" + treeGrid._grid.name + "_year"));
          }
          column.yearpicker.wrapper.css({
            display: "none",
            height: innerOptions.display.rowHeight
          });
        }
      }
      if (column.footer) {
        var columnFooterArray = [];
        if (_typeof(column.footer) === "object") {
          columnFooterArray.push(column.footer);
        } else if (Array.isArray(column.footer)) {
          columnFooterArray = column.footer;
        }
        for (var footerIdx = 0; footerIdx < columnFooterArray.length; footerIdx++) {
          if (columnFooterArray[footerIdx].expression) {
            if (columnFooterArray[footerIdx].predefined === true) {
              if (typeof columnFooterArray[footerIdx].preCurrency === "function") {
                columnFooterArray[footerIdx].preCurrency = "";
                treeGrid._grid._gv._footer._cell.__proto__.value = _displayFooterText3();
              }
            }
          }
        }
      }
      if (Array.isArray(column.columns)) {
        setRealGridColumns(treeGrid, column.columns, innerOptions);
      }
    });
  }
  dews = $.extend(true, dews, {
    ui: {
      treegrid: function treegrid(selector, options) {
        var $el, treeGrid, $content;
        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          if (dews.ui.dialogPage) {
            $content = dews.ui.dialogPage.$content;
          } else if (dews.ui.page) {
            $content = dews.ui.page.$content;
          } else {
            $content = $(document);
          }
          $el = $(selector, $content);
        }
        if ($.type($el) === "undefined") {
          return;
        }
        $el.each(function () {
          var treeGridView,$this = $(this);
          treeGridView = $this.data("dews-control");
          if (!treeGridView) {
            if ($.type(options) === "undefined") {
              options = {};
            }
            if (!$this.hasClass("dews-data-control")) {
              $this.addClass("dews-data-control");
            }
            RealGridJS.setRootContext(dews._environments.scriptBase + "realgrid");
            treeGridView = new TreeGrid($el, options);
            $this.data("dews-control", treeGridView);
          }
          treeGrid = treeGridView;
        });
        return treeGrid;
      }
    }
  });
  TreeGrid.prototype.on = function () {
    var self = this;
    self.$element.on.apply(self.$element, arguments);
  };
  TreeGrid.prototype.off = function () {
    var self = this;
    self.$element.off.apply(self.$element, arguments);
  };
  TreeGrid.prototype.append = function (dataIndex, value) {
    var self = this;
    if ($.type(dataIndex) === "object" || $.type(dataIndex) === "undefined") {
      if ($.type(dataIndex) === "object") {
        value = dataIndex;
      }
      dataIndex = -1;
    }
    if ($.type(value) === "undefined") {
      value = {};
    }
    if (self.options.dataSource && self.options.dataSource.dataProvider) {
      if ($.type(self.options.dataBounding) === "boolean" && !self.options.dataBounding) {
        self.options.dataBounding = true;
      }
      self.options.add = true;
      self.options.dataSource.dataProvider.addChildRow(dataIndex, value, "", false);
    }
  };
  TreeGrid.prototype.remove = function (dataIndex) {
    var self = this,rows = [],previous = self._grid.getCurrent(),dataProvider = self.options.dataSource.dataProvider;
    if ($.type(dataIndex) === "array") {
      rows = dataIndex;
    } else {
      rows.push(dataIndex);
    }
    rows.sort(function (a, b) {
      return a - b;
    });
    if (self.options.dataSource && self.options.dataSource.dataProvider) {
      var parameter = {
        treegrid: self,
        row: {
          data: self.dataItems(rows),
          index: rows
        }
      };
      var event = new $.Event("rowRemove", parameter);
      self.$element.trigger(event);
      for (var j = rows.length - 1; j >= 0; j -= 1) {
        if (dataProvider.getRowState(rows[j]) !== "created") {
          var deleteData = dataProvider.getJsonRow(rows[j]),parentId = dataProvider.getParent(rows[j]);
          deleteData.__parent = dataProvider.getJsonRow(parentId);
          deleteData.__sequence;
          $.each(dataProvider.getChildren(parentId), function (index, rowId) {
            if (rowId === rows[j]) {
              deleteData.__sequence = index;
            }
          });
          self.options.dataSource.options._destroy.push(deleteData);
        }
        if (rows[j] <= self.select()) {
          self.options.remove = true;
        }
        dataProvider.removeRow(rows[j]);
      }
      if (self._grid.getCurrent().itemIndex !== -1 && self._grid.getItemCount() !== self._grid.getCurrent().itemIndex) {
      }
    }
  };
  TreeGrid.prototype.insertBefore = function (dataIndex, value) {
    var self = this,dataLength = self._grid.getItemCount(),current = self._grid.getCurrent();
    if ($.type(dataIndex) === "object" || $.type(dataIndex) === "undefined") {
      if ($.type(dataIndex) === "object") {
        value = dataIndex;
      }
      dataIndex = -1;
    }
    if ($.type(value) === "undefined") {
      value = {};
    }
    if (self.options.dataSource && self.options.dataSource.dataProvider) {
      var parentId = self.options.dataSource.dataProvider.getParent(dataIndex);
      var count = 0;
      $.each(self.options.dataSource.dataProvider.getChildren(parentId), function (idx, target) {
        if (dataIndex === target) {
          count = idx;
        }
      });
      self.options.add = true;
      self.options.dataSource.dataProvider.insertChildRow(parentId, count, value, "", false);
      if (dataLength !== 0 && current.itemIndex !== -1) {
        self._grid.onCurrentChanging.call(self, self._grid, self._grid.getCurrent(), self._grid.getCurrent());
        self._grid.onCurrentChanged.call(self, self._grid, self._grid.getCurrent());
      }
    }
  };
  TreeGrid.prototype.insertAfter = function (dataIndex, value) {
    var self = this,dataLength = self._grid.getItemCount(),current = self._grid.getCurrent();
    if ($.type(dataIndex) === "object" || $.type(dataIndex) === "undefined") {
      if ($.type(dataIndex) === "object") {
        value = dataIndex;
      }
      dataIndex = -1;
    }
    if ($.type(value) === "undefined") {
      value = {};
    }
    if (self.options.dataSource && self.options.dataSource.dataProvider) {
      var parentId = self.options.dataSource.dataProvider.getParent(dataIndex);
      var count = 0;
      $.each(self.options.dataSource.dataProvider.getChildren(parentId), function (idx, target) {
        if (dataIndex === target) {
          count = idx;
        }
      });
      self.options.add = true;
      self.options.dataSource.dataProvider.insertChildRow(parentId, count + 1, value, "", false);
      if (dataLength !== 0 && current.itemIndex !== -1) {
        self._grid.onCurrentChanging.call(self, self._grid, self._grid.getCurrent(), self._grid.getCurrent());
        self._grid.onCurrentChanged.call(self, self._grid, self._grid.getCurrent());
      }
    }
  };
  TreeGrid.prototype.select = function (dataIndex, field) {
    var self = this,column = self._grid.getCurrent().column;
    if ($.type(field) !== "undefined") {
      column = field;
    }
    if ($.type(dataIndex) !== "undefined") {
      var parents = self.options.dataSource.dataProvider.getAncestors(dataIndex);
      if (parents.length !== 0) {
        for (var i = parents.length - 1; i >= 0; i--) {
          self._grid.expand(self._grid.getItemIndex(parents[i]), false, false);
        }
      }
      self._grid.setCurrent({
        itemIndex: self._grid.getItemIndex(dataIndex),
        column: column
      });
    } else {
      return self._grid.getCurrent().dataRow;
    }
  };
  TreeGrid.prototype.multiSelect = function (startItem, endItem, startColumn, endColumn) {
    return dews.ui.gridUtil.multiSelect(this, startItem, endItem, startColumn, endColumn);
  };
  TreeGrid.prototype.expand = function (rowId, bool) {
    var self = this,_boolean9 = false,index = rowId;
    if ($.type(bool) === "boolean") {
      _boolean9 = bool;
    }
    var parents = self.options.dataSource.dataProvider.getAncestors(rowId);
    if (parents && parents.length !== 0) {
      for (var i = parents.length - 1; i >= 0; i--) {
        self._grid.expand(self._grid.getItemIndex(parents[i]), _boolean9, _boolean9);
      }
    }
    self._grid.expand(self._grid.getItemIndex(index), _boolean9, _boolean9);
  };
  TreeGrid.prototype.expandAll = function (level) {
    var self = this;
    self._grid.expandAll(level);
  };
  TreeGrid.prototype.collapse = function (dataIndex) {
    var self = this;
    self._grid.collapse(self._grid.getItemIndex(dataIndex));
  };
  TreeGrid.prototype.collapseAll = function () {
    var self = this;
    self._grid.collapseAll();
  };
  TreeGrid.prototype.dataItem = function (dataIndex) {
    var self = this;
    if (dataIndex > -1 && self.options.dataSource && self.options.dataSource.dataProvider) {
      return self.options.dataSource.dataProvider.getJsonRow(dataIndex);
    }
  };
  TreeGrid.prototype.dataItems = function (dataIndex) {
    var self = this,data = [];
    if ($.type(dataIndex) !== "undefined") {
      if ($.type(dataIndex) === "number" && dataIndex > 0) {
        return self.options.dataSource.dataProvider.getJsonRow(dataIndex);
      } else if ($.type(dataIndex) === "array") {
        for (var i = 0; i < dataIndex.length; i++) {
          data.push(self.options.dataSource.dataProvider.getJsonRow(dataIndex[i]));
        }
        return data;
      }
    } else {
      return self.options.dataSource.data();
    }
  };
  TreeGrid.prototype.setCellValue = function (dataIndex, field, value, isSave) {
    var self = this;
    var previous = self.dataItem(dataIndex);
    var onEditCell = true;
    var itemIndex = self._grid.getItemIndex(dataIndex);
    if ($.type(previous) === "object") {
      previous = previous[field];
    }
    self.options.dataSource.dataProvider.setValue(dataIndex, field, value);
    if (typeof isSave === "boolean") {
      onEditCell = isSave;
    }
    if (value !== previous && $.type(self._grid.columnByField(field)) !== "null") {
      self._grid.onCellEdited.call(
      self,
      self._grid,
      itemIndex,
      dataIndex,
      self._grid.columnByField(field).dataIndex,
      onEditCell);

    }
    self.options.commit = true;
    self._grid.commit();
  };
  TreeGrid.prototype.getCellValue = function (dataIndex, field) {
    var self = this;
    return self.options.dataSource.dataProvider.getValue(dataIndex, field);
  };
  TreeGrid.prototype.getEditCellValue = function () {
    return this._grid.getEditValue();
  };
  TreeGrid.prototype.setDataSource = function (dataSource) {
    var self = this;
    self._grid.setAllCheck(false);
    self.options.dataSource = dataSource;
    __initialize2(self);
    self.options = this._getOptionsThatConvertColumns(self.options.columns, self.options, self);
    delete self.options.fieldIndex;
    self.options.dataSource.dataProvider._dp.setJsonRows = setJsonRows(
    self,
    self.options.dataSource.dataProvider._dp.setJsonRows);

    self.options.dataSource.dataProvider._dp.createRow = createRow(
    self,
    self.options.dataSource.dataProvider._dp.createRow);

    self._grid.setDataProvider(self.options.dataSource.dataProvider);
    self._grid.setColumns(self.options.columns);
    self._grid.setHeader({
      height: self.options.maxDepth * self.options.header.minHeight
    });
    if (self.options.grouping) {
      self.options.display.rowHeight = self.options.display.minHeight * self.options.maxGroupCol;
    }
    self._grid.setOptions(self.options);
    if (self._onegrid && self._onegrid._onegrid) {
      if (self._onegrid.loadData) {
        self._onegrid.loadColumns = dews.ui.gridUtil.setDisplayIndexColumns(
        self,
        self.userOptions.columns,
        self._onegrid.loadData);

      } else {
        self._onegrid.loadColumns = dews.ui.gridUtil.setDisplayColumns(self, self._grid.getDisplayColumns());
      }
    }
    self._filterManager.setFilterActions(self);
    self._setCriteria();
  };
  TreeGrid.prototype.setColumns = function (columns) {
    var self = this;
    self.options.styleColumn = [];
    self.options._originColumns = [].concat(columns);
    __initialize2(self);
    var result = this._getOptionsThatConvertColumns(columns, self.options, self);
    dews.ui.gridUtil.setColumns(self, result);
    self._filterManager.setFilterActions(self);
    self._setCriteria();
  };
  TreeGrid.prototype.setColumn = function (columnFieldName, nextColumnOption) {
    var self = this,prevColumn,nextColumn,newColumn,columns = self.options.columns,result;
    delete nextColumnOption.field;
    if (nextColumnOption.width) {
      self._grid.setColumnProperty(columnFieldName, "width", nextColumnOption.width);
      delete nextColumnOption.width;
    }
    if (nextColumnOption.visible) {
      self._grid.setColumnProperty(columnFieldName, "visible", nextColumnOption.visible);
    }
    var userColumn;
    if ($.type(self.userOptions.columns) === "array") {
      userColumn = findUserOptionsColumn6(self.userOptions.columns, columnFieldName);
    }
    userColumn = $.extend(true, userColumn, nextColumnOption);
    if (nextColumnOption.editable !== void 0 && (nextColumnOption.editor === void 0 || nextColumnOption.editor.editable === void 0)) {
      if (userColumn.editor === void 0 || userColumn.editor.editable === void 0) {
        $.extend(true, nextColumnOption, {
          editor: { editable: nextColumnOption.editable }
        });
      } else if (userColumn.editor && userColumn.editor.editable !== void 0) {
        $.extend(true, nextColumnOption, {
          editor: { editable: userColumn.editor.editable }
        });
      }
    }
    if (nextColumnOption.editable === void 0 && nextColumnOption.editor && nextColumnOption.editor.editable !== void 0) {
      if (userColumn !== void 0 && userColumn.editable !== void 0) {
        $.extend(true, nextColumnOption, { editable: userColumn.editable });
      } else {
        $.extend(true, nextColumnOption, {
          editable: self.options.editable
        });
      }
    }
    findColumnAndExtend(columns);
    self.options.styleColumn = [];
    __initialize2(self);
    result = this._getOptionsThatConvertColumns(columns, self.options, self);
    dews.ui.gridUtil._setColumns(self, result);
    prevColumn = self._grid.columnByName(columnFieldName);
    nextColumn = self.columns[columnFieldName];
    if (nextColumn && nextColumn.labels && nextColumn.values && nextColumn.editor && nextColumn.editor.type === "dropDown" && prevColumn) {
      prevColumn.labels = [];
      prevColumn.values = [];
    }
    newColumn = $.extend(true, {}, prevColumn, nextColumn);
    self._grid.setColumn(newColumn);
    self._filterManager.setFilterActions(self);
    self._setCriteria();
    function findColumnAndExtend(columns2) {
      for (var i = 0; i < columns2.length; i++) {
        if (columns2[i].columns) {
          findColumnAndExtend(columns2[i].columns);
        } else {
          if (columns2[i].fieldName && columns2[i].fieldName === columnFieldName) {
            $.extend(true, columns2[i], nextColumnOption);
          }
        }
      }
    }
  };
  TreeGrid.prototype.setOptions = function (options) {
    var self = this;
    var dispCols = self._grid.saveColumnLayout();
    self.userOptions = $.extend(true, self.userOptions, options);
    options = $.extend(true, {}, self.options, options);
    self.options = getOptions3(self, options);
    self._grid.setOptions(self.options);
    self.columns = {};
    dews.ui.gridUtil._setColumns(self, self.options.columns);
    self._filterManager.setFilterActions(self);
    self._grid.setColumnLayout(dispCols);
  };
  TreeGrid.prototype.setFixedOptions = function (fixedOption) {
    this._grid.setFixedOptions(fixedOption);
  };
  TreeGrid.prototype.setHeaderCheck = function (_boolean10) {
    this._grid.setAllCheck(_boolean10);
    this._grid.checkAll(_boolean10);
  };
  TreeGrid.prototype.getCheckedValues = function (field) {
    return dews.ui.gridUtil.getCheckedValues(this, field);
  };
  TreeGrid.prototype.getCheckedRows = function () {
    return dews.ui.gridUtil.getCheckedRows(this);
  };
  TreeGrid.prototype.getCheckedIndex = function () {
    var self = this;
    return self._grid.getCheckedRows();
  };
  TreeGrid.prototype.editCell = function () {
    var self = this;
    self._grid.showEditor();
  };
  TreeGrid.prototype.commitCell = function () {
    var self = this;
    self._grid.commitEditor();
    self._grid.commit(true);
  };
  TreeGrid.prototype.closeCell = function () {
    var self = this;
    self._grid.cancelEditor();
    self._grid.cancel();
  };
  TreeGrid.prototype.setContextMenu = function (options) {
    dews.ui.gridUtil.setContextMenu(this, options);
  };
  TreeGrid.prototype.sort = function (options) {
    dews.ui.gridUtil.sort(this, options);
  };
  TreeGrid.prototype.setCheck = function (dataIndex, value, flag) {
    var self = this;
    if ($.type(dataIndex) === "number") {
      self._grid.checkRow(dataIndex, value, false, flag);
    } else if ($.type(dataIndex) === "array") {
      self._grid.checkRows(dataIndex, value, flag);
    }
  };
  TreeGrid.prototype.setDisableCheck = function (itemIndex, _boolean11) {
    var self = this,row = [],bool = false;
    if ($.type(itemIndex) === "number") {
      row.push(itemIndex);
    } else if ($.type(itemIndex) === "array") {
      row = itemIndex;
    }
    if ($.type(_boolean11) === "boolean") {
      bool = !_boolean11;
    }
    for (var i = 0; i < row.length; i++) {
      self._grid.setCheckable(row[i], bool);
    }
  };
  TreeGrid.prototype.showColumn = function (field) {
    dews.ui.gridUtil.showColumn(this, field);
  };
  TreeGrid.prototype.hideColumn = function (field) {
    dews.ui.gridUtil.hideColumn(this, field);
  };
  TreeGrid.prototype.refresh = function () {
    var self = this;
    self._grid.refresh();
  };
  TreeGrid.prototype.showProgress = function () {
    dews.ui.loading.show({
      type: "tiny",
      text: dews.localize.get("\uB370\uC774\uD130 \uB85C\uB529 \uC911 \uC785\uB2C8\uB2E4.", "dews_\uB370\uC774\uD130 \uB85C\uB529 \uC911 \uC785\uB2C8\uB2E4.")
    });
  };
  TreeGrid.prototype.hideProgress = function () {
    dews.ui.loading.hide();
  };
  TreeGrid.prototype.searchCell = function (options) {
    var self = this,opt2 = {
        select: true,
        partialMatch: true,
        caseMatch: false
      };
    if ($.type(options) === "undefined") {
      return;
    }
    opt2.startItemIndex = options.startIndex === void 0 ? 0 : options.startIndex;
    opt2 = $.extend(true, opt2, options);
    opt2.caseSensitive = opt2.caseMatch;
    if (self._grid.searchCell(opt2)) {
      return self._grid.getDataRow(self._grid.searchCell(opt2).itemIndex);
    }
  };
  TreeGrid.prototype.getCurrentColumn = function () {
    var self = this;
    return self._grid.getCurrent().column;
  };
  TreeGrid.prototype.getRowState = function (dataIndex) {
    var self = this;
    var itemIndex = self._grid.getItemIndex(dataIndex);
    return dews.ui.gridUtil.getRowState(this, itemIndex);
  };
  TreeGrid.prototype.setRowState = function (dataIndex, state) {
    dews.ui.gridUtil.setRowState(this, dataIndex, state);
  };
  TreeGrid.prototype.updateRow = function (row, data) {
    dews.ui.gridUtil.updateRow(this, row, data);
  };
  TreeGrid.prototype.setDetail = function (target) {
    dews.ui.gridUtil.setDetail(this, target);
  };
  TreeGrid.prototype.validate = function (opt2) {
    var self = this,validate = {
        result: true,
        fields: []
      },gridDatas = self.options.dataSource.dataProvider._dp._rowMap.length - 1,required = [],columns,rowData;
    if ($.type(opt2) === "function") {
      var funParams = {
        treegrid: self,
        row: {},
        cell: {}
      };
      for (var i = 0; i < gridDatas; i++) {
        if (self.options.dataSource.dataProvider.getJsonRow(i)) {
          funParams.row.index = i;
          funParams.row.data = self.options.dataSource.dataProvider.getJsonRow(i);
          $.each(self._grid.getDisplayColumns(), function (index, column2) {
            funParams.cell.field = column2;
            funParams.cell.data = funParams.row.data[column2];
            if (!opt2.call(self, funParams)) {
              validate.result = false;
              validate.fields.push({
                columnName: column2,
                rowIndex: i
              });
            }
          });
        }
      }
    } else {
      var options = $.extend(
      true,
      {
        mode: $.type(opt2) === "boolean" ? opt2 : false,
        showTooltip: false
      },
      opt2);

      for (var i = 0; i < self._grid.getColumnNames().length; i += 1) {
        columns = self.columns[self._grid.getColumnNames()[i]];
        if (columns && $.type(columns.field) !== "undefined") {
          if (columns.attributes && columns.attributes["class"] === "required") {
            required.push(columns.field);
          }
        }
      }
      if (options.mode) {
        for (var d = self._grid.getDataRow(0); d < gridDatas + self._grid.getDataRow(0); d += 1) {
          if (self.getRowState(d) === "updated" || self.getRowState(d) === "added") {
            rowData = self.options.dataSource.dataProvider.getJsonRow(d);
            if (rowData) {
              for (var j = 0; j < required.length; j += 1) {
                if ($.type(rowData[required[j]]) === "number" && rowData[required[j]] === 0) {
                } else if (!rowData[required[j]]) {
                  validate.result = false;
                  validate.fields.push({
                    columnName: required[j],
                    rowIndex: d,
                    validate: "required"
                  });
                }
              }
            }
          }
        }
      } else {
        for (var k = self._grid.getDataRow(0); k < gridDatas + self._grid.getDataRow(0); k += 1) {
          rowData = self.options.dataSource.dataProvider.getJsonRow(k);
          if (rowData) {
            for (var l = 0; l < required.length; l += 1) {
              if ($.type(rowData[required[l]]) === "number" && rowData[required[l]] === 0) {
              } else if (!rowData[required[l]]) {
                validate.result = false;
                validate.fields.push({
                  columnName: required[l],
                  rowIndex: k,
                  validate: "required"
                });
              }
            }
          }
        }
      }
      if (!validate.result) {
        if (options.showTooltip) {
          var itemIndex = validate.itemIndex = validate.fields[0].rowIndex;
          var column = validate.column = validate.fields[0].columnName;
          self.expand(self.getParentsIndex(itemIndex, true));
          self.showTooltip(self._grid.getItemIndex(itemIndex), column, {
            type: "required",
            position: "top",
            text: dews.localize.get("\uD544\uC218 \uC785\uB825 \uD56D\uBAA9\uC785\uB2C8\uB2E4.", "dews_\uD544\uC218 \uC785\uB825 \uD56D\uBAA9\uC785\uB2C8\uB2E4.")
          });
        }
      }
    }
    return validate;
  };
  TreeGrid.prototype.setRowStyle = function (dataIndex, style, _colorLine) {
    dews.ui.gridUtil.setRowStyle(this, dataIndex, style, _colorLine);
  };
  TreeGrid.prototype.setStyles = function (styles) {
    var self = this;
    self.options.styles = styles;
    self.options = setStyles2(self._grid, self.options);
    self._grid.setOptions(self.options);
  };
  TreeGrid.prototype.resetRowStyle = function (dataIndex) {
    dews.ui.gridUtil.resetRowStyle(this, dataIndex);
  };
  TreeGrid.prototype.lastEditCell = function () {
    var self = this,current = self._grid.getCurrent(),displayColumn = self.options.displayColumns,displayIndex = self._grid.getColumnProperty(current.column, "displayIndex"),value = false,editParams = {
        treegrid: self,
        row: {
          index: current.itemIndex,
          data: self.dataItem(self._grid.getDataRow(current.itemIndex))
        },
        cell: {
          field: ""
        }
      };
    return dews.ui.gridUtil.lastEditCell(self, displayColumn, displayIndex, value, editParams);
  };
  TreeGrid.prototype.getSummary = function (field, cal) {
    var self = this,calculate = cal || "SUM";
    return self._grid.getSummary(field, calculate);
  };
  TreeGrid.prototype.getByUUID = function () {
    var self = this;
    var data = self.dataItem(self.select());
    if (data) {
      return data["__UUID"];
    }
  };
  TreeGrid.prototype.bindPanel = function (panel) {
    dews.ui.gridUtil.bindPanel(this, panel);
  };
  TreeGrid.prototype.updateRowFromPanel = function (data) {
    var self = this;
    if (data) {
      Object.keys(data).forEach(function (key) {
        if (self.options.dataSource.dataProvider.getFieldIndex(key) !== -1) {
          self._grid.setValue(self._grid.getItemIndex(self.select()), key, data[key]);
        }
      });
    }
  };
  TreeGrid.prototype.setHeight = function (height) {
    dews.ui.gridUtil.setHeight(this, height);
  };
  TreeGrid.prototype.setRowHeight = function (opt2, itemIndex, height) {
    return dews.ui.gridUtil.setRowHeight(this, opt2, itemIndex, height);
  };
  TreeGrid.prototype.setCellStyle = function (index, field, styles) {
    dews.ui.gridUtil.setCellStyle(this, index, field, styles);
  };
  TreeGrid.prototype.setMaxLength = function (field, length) {
    dews.ui.gridUtil.setMaxLength(this, field, length);
  };
  TreeGrid.prototype.setHeaderCheckVisible = function (visible) {
    dews.ui.gridUtil.setHeaderCheckVisible(this, visible);
  };
  TreeGrid.prototype.getParentData = function () {
    return dews.ui.gridUtil.getParentData(this);
  };
  TreeGrid.prototype.getChildData = function (index, gridId) {
    return dews.ui.gridUtil.getChildData(this, index, gridId);
  };
  TreeGrid.prototype.getChildDataSource = function (arg1, arg2) {
    return dews.ui.gridUtil.getChildDataSource(this, arg1, arg2);
  };
  TreeGrid.prototype._getExcelUrlForPrint = function (menuName, options) {
    var self = this;
    self.expandAll();
    return dews.ui.gridUtil._getExcelUrlForPrint(this, menuName, options);
  };
  TreeGrid.prototype.sortDataItems = function (index) {
    var self = this;
    var sortDatas = [];
    if ($.type(index) === "array") {
      $.each(index, function (count, idx) {
        if ($.type(self.dataItem(idx)) !== "null") {
          sortDatas.push(self.dataItem(idx));
        }
      });
    } else if ($.type(index) === "undefined") {
      for (var i = 0; i < self._grid.getItemCount(); i++) {
        if ($.type(self.dataItem(self._grid.getDataRow(i))) !== "null") {
          sortDatas.push(self.dataItem(self._grid.getDataRow(i)));
        }
      }
    }
    return sortDatas;
  };
  TreeGrid.prototype.enable = function (_boolean12) {
    dews.ui.gridUtil.enable(this, _boolean12);
  };
  TreeGrid.prototype.getParentsIndex = function (dataIndex, all) {
    var self = this;
    if ($.type(all) === "undefined") {
      all = false;
    }
    if (self.options.dataSource) {
      if (all) {
        return self.options.dataSource.dataProvider.getAncestors(dataIndex);
      } else {
        var data = [];
        data.push(self.options.dataSource.dataProvider.getParent(dataIndex));
        return data;
      }
    }
  };
  TreeGrid.prototype.getChildrenIndex = function (dataIndex, all) {
    var self = this;
    if ($.type(all) === "undefined") {
      all = false;
    }
    if (self.options.dataSource) {
      if (all) {
        return self.options.dataSource.dataProvider.getDescendants(dataIndex);
      } else {
        return self.options.dataSource.dataProvider.getChildren(dataIndex);
      }
    }
  };
  TreeGrid.prototype.getParentsData = function (dataIndex, all) {
    var self = this,parentIndex = self.getParentsIndex(dataIndex, all),parentData = [];
    $.each(parentIndex, function (idx, value) {
      parentData.push(self.dataItem(value));
    });
    return parentData;
  };
  TreeGrid.prototype.getChildrenData = function (dataIndex, all) {
    var self = this,childIndex = self.getChildrenIndex(dataIndex, all),childData = [];
    $.each(childIndex, function (idx, value) {
      childData.push(self.dataItem(value));
    });
    return childData;
  };
  TreeGrid.prototype.setColumnHeaderCheck = function (field, bool) {
    var self = this;
    self._grid.setColumn($.extend(true, self._grid.columnByField(field), { checked: bool }));
  };
  TreeGrid.prototype.addColumn = function (column, insertField) {
    var self = this,options = self.options;
    self.options.styleColumn = [];
    options.columns.push(column);
    __initialize2(self);
    options = this._getOptionsThatConvertColumns(options.columns, options, self);
    dews.ui.gridUtil.addColumn(self, options.columns[options.columns.length - 1], insertField);
    self._setCriteria();
  };
  TreeGrid.prototype._setCriteria = function () {
    var self = this;
    $.each(self.options.styleColumn, function (idx, column) {
      var fieldName = self._grid.columnByField(column);
      self.columns[column].criteriaFunction = {
        criteria: function criteria(treeGrid, index, value) {
          var grid2 = $(treeGrid._gv._container._containerDiv).closest(".dews-data-control").data("dews-control");
          if (!grid2) {
            return false;
          }
          var params = {
            treegrid: grid2,
            row: {
              index: index.dataRow,
              data: grid2.dataItem(index.dataRow)
            },
            cell: {
              field: index.column,
              data: value
            }
          };
          var style = $.extend(true, {}, grid2.columns[index.column].style.call(grid2, params));
          if (style.color) {
            style.foreground = style.color;
          }
          if (style.textAlign) {
            switch (style.textAlign) {
              case "left":
                style.textAlignment = "near";
                break;
              case "right":
                style.textAlignment = "far";
                break;
              case "center":
                style.textAlignment = "center";
                break;}

          }
          if (style.verticalAlign) {
            switch (style.verticalAlign.toLowerCase()) {
              case "top":
                style.lineAlignment = "near";
                break;
              case "bottom":
                style.lineAlignment = "far";
                break;
              case "middle":
                style.lineAlignment = "center";
                break;}

          }
          if (style.icon && style.icon.image) {
            var image;
            if (grid2.options.iconImagelist) {
              image = grid2.options.iconImagelist;
            } else {
              image = new RealGridJS.ImageList("iconImage", "");
            }
            if (grid2.options.images.indexOf(style.icon.image) !== -1) {
            } else {
              grid2.options.images.push(style.icon.image);
            }
            style = $.extend(true, {}, style, {
              iconIndex: style.icon.image,
              iconOffset: 0,
              iconPadding: 5,
              iconAlignment: "center",
              iconLocation: style.icon.position || "left"
            });
            image.addUrls(grid2.options.images);
            grid2._grid.registerImageList(image);
            grid2.columns[index.column].imageList = "iconImage";
            grid2.options.iconImagelist = image;
          } else if (grid2.columns[index.column].imageList === "iconImage") {
            style = $.extend(true, {}, style, {
              iconIndex: -1
            });
          }
          if (style.header) {
            var styles = $.extend(true, {}, style.header);
            if (style.header.color) {
              styles.foreground = style.header.color;
            }
            if (style.header.selectedColor) {
              styles.selectedForeground = style.header.selectedColor;
            }
            if (style.header.hoveredColor) {
              styles.hoveredForeground = style.header.hoveredColor;
            }
            self._grid.setColumnProperty(fieldName, "header", {
              styles: styles
            });
          }
          return style;
        }
      };
      self._grid.setColumnProperty(fieldName, "dynamicStyles", [self.columns[column].criteriaFunction]);
      var renderer = self._grid.getColumnProperty(fieldName, "renderer");
      if (!renderer) {
        self._grid.setColumnProperty(self._grid.columnByField(column), "renderer", { type: "icon" });
      }
    });
  };
  TreeGrid.prototype.deleteColumn = function (column) {
    dews.ui.gridUtil.deleteColumn(this, column);
  };
  TreeGrid.prototype.disableActiveEditor = function (_boolean13) {
    var self = this,column,columns,options = {},fieldIndex,background,editable;
    column = self.getCurrentColumn();
    columns = self.columns[column];
    fieldIndex = self.options.dataSource.dataProvider.getFieldIndex(column);
    editable = self._grid.getColumnProperty(column, "editable");
    if (self._grid.getSelectOptions().style !== "none") {
      background = self.options.gridStyle.selection.focusBackgroundColor;
      if ($.type(columns) !== "undefined" && $.type(columns.attributes) !== "undefined") {
        if (columns.attributes["class"] === "required") {
          background = self.options.gridStyle.body.requiredFocusBackground;
        } else if (columns.attributes["class"] === "readonly") {
          background = self.options.gridStyle.body.readonlyFocusBackground;
        }
      }
      options = {
        background: background
      };
      self._grid.removeCellStyles(["selection"]);
    }
    if (($.type(editable) === "undefined" || editable) && !_boolean13) {
      options.editable = false;
    }
    self._grid.addCellStyle("selection", options, true);
    self._grid.setCellStyle(self._grid.getCurrent().dataRow, fieldIndex, "selection");
    self._grid.setColumnProperty(column, "editable", _boolean13);
    switch (columns.editor.type.toLowerCase()) {
      case "codepicker":
      case "zipcodepicker":
      case "month":
      case "year":
        var visible = _boolean13 ? "visible" : "hidden";
        self._grid.setColumnProperty(column, "buttonVisibility", visible);
        break;}

  };
  TreeGrid.prototype.isFilteredColumn = function (column) {
    return this._grid.isFiltered(column);
  };
  TreeGrid.prototype.setSelectedStyle = function (opt2) {
    dews.ui.gridUtil.setSelectedStyle(this, opt2);
  };
  TreeGrid.prototype.getItemIndexFromDataIndex = function (dataIndex) {
    return dews.ui.gridUtil.getItemIndexFromDataIndex(this, dataIndex);
  };
  TreeGrid.prototype.getDataIndexFromItemIndex = function (itemIndex) {
    return dews.ui.gridUtil.getDataIndexFromItemIndex(this, itemIndex);
  };
  TreeGrid.prototype.getDynamicColumn = function (field) {
    return dews.ui.gridUtil.getDynamicColumn(this, field);
  };
  TreeGrid.prototype.deleteNote = function (options) {
    return dews.ui.gridUtil.deleteNote(this, options);
  };
  TreeGrid.prototype.setDisabledNoteRows = function (dataIndex) {
    return dews.ui.gridUtil.setDisabledNoteRows(this, dataIndex);
  };
  TreeGrid.prototype.getGridNoteInfo = function (itemIndex) {
    return dews.ui.gridUtil.getGridNoteInfo(this, itemIndex);
  };
  function _displayFooterText3() {
    return function () {
      var grid2 = $(this._index._column.grid()._container._containerDiv).closest(".dews-data-control").data("dews-control");
      if (grid2 === void 0 || grid2 === null) {
        return null;
      }
      var cols = grid2.columns;
      var col = grid2.columns[this._index._column._fieldName];
      var params = {
        grid: grid2,
        column: cols
      };
      if (col.footer && col.footer.currency && $.type(col.footer.currency) === "function") {
        col.footer.preCurrency = col.footer.currency.call(grid2, params);
        var env = dews.ui.page && dews.ui.page.env && dews.ui.page.env[col.footer.preFormat];
        var predefinedFormat = dews.getCurrencyFormat(col.footer);
        var formats = "#,###.##";
        var round = "round";
        if (env) {
          formats = env.format;
          round = dews.mathType[env.round];
        }
        if ($.type(predefinedFormat) === "object") {
          formats = predefinedFormat.format;
          round = $.type(predefinedFormat.round) === "string" ? predefinedFormat.round : round;
        } else if ($.type(predefinedFormat) === "string") {
          formats = predefinedFormat;
        }
        if (round !== "round") {
          if (formats.split(".").length === 2) {
            if (round === "ceil") {
              formats += ";;;c";
            } else {
              formats += ";;;f";
            }
          }
        }
        var column = grid2._grid.columnByField(this._index._column._fieldName);
        var numberFormat = grid2._grid.getColumnProperty(column, "footer").styles.numberFormat;
        if (numberFormat !== formats) {
          grid2._grid.setColumnProperty(column, "footer", {
            styles: {
              numberFormat: formats
            }
          });
        }
      }
      if (col.footer && col.footer.length > 1) {
        var fieldName = this._index._column._fieldName;
        var columnIndex = grid2.options.columns.findIndex(function (column2) {
          return column2.field === fieldName;
        });
        for (var footerIdx = 0; footerIdx < col.footer.length; footerIdx++) {
          if (col.footer[footerIdx].predefined && col.footer[footerIdx].format && col.footer[footerIdx].currency && $.type(col.footer[footerIdx].currency) === "function") {
            var params = {
              grid: grid2,
              column: cols
            };
            col.footer[footerIdx].preCurrency = col.footer[footerIdx].currency.call(grid2, params);
            var env = dews.ui.page && dews.ui.page.env && dews.ui.page.env[col.footer[footerIdx].preFormat];
            var predefinedFormat = dews.getCurrencyFormat(col.footer[footerIdx]);
            var formats = "#,###.##";
            var round = "round";
            if (env) {
              formats = env.format;
              round = dews.mathType[env.round];
            }
            if ($.type(predefinedFormat) === "object") {
              formats = predefinedFormat.format;
              round = $.type(predefinedFormat.round) === "string" ? predefinedFormat.round : round;
            } else if ($.type(predefinedFormat) === "string") {
              formats = predefinedFormat;
            }
            if (round !== "round") {
              if (formats.split(".").length === 2) {
                if (round === "ceil") {
                  formats += ";;;c";
                } else {
                  formats += ";;;f";
                }
              }
            }
            grid2.options.columns[columnIndex].footer.styles[footerIdx].numberFormat = formats;
          }
        }
        grid2._grid.setColumnProperty(grid2._grid.columnByField(this._index._column._fieldName), "footer", {
          styles: grid2.options.columns[columnIndex].footer.styles
        });
      }
      return this._value;
    };
  }
})();


(function () {
  // src/js/grid/excel/ExcelExporter.js
  function ExcelExporter() {
  }
  ExcelExporter.prototype["export"] = function (options, grids) {
    var self = this;
    self.grid = grids;
    self.options = exportInitialOptions(options);
    if (self.options.useExcelDownloadRecord) {
      self.grid._useExcelDownloadRecord = self.options.useExcelDownloadRecord;
    }
    if (self.grid._useExcelDownloadRecord) {
      var recordDialog = dews.ui.dialog("H_CM_PRINTREASON_INFO_C", {
        url: "~/codehelp/CI/H_CM_PRINTREASON_INFO_C",
        iframe: false,
        buttons: "applyAndClose",
        width: 560,
        height: 537,
        size: "medium",
        initData: {
          code: "H_CM_PRINTREASON_INFO_C",
          MENU_CD: dews.ui.page.menu.id,
          GRID_CD: self.grid.userOptions._dewsGridID
        },
        ok: function ok() {
          Array.isArray(self.grid) ? self.multiSheetExcelExport() : self.oneSheetExcelExport();
        }
      });
      recordDialog.open();
    } else {
      Array.isArray(self.grid) ? self.multiSheetExcelExport() : self.oneSheetExcelExport();
    }
  };
  ExcelExporter.prototype.oneSheetExcelExport = function () {
    var self = this;
    var opt = self.options;
    removeGridCellStyles(self.grid);
    self.grid._grid.exportGrid(opt);
    restoreGridCellStyles(self.grid);
  };
  ExcelExporter.prototype.multiSheetExcelExport = function () {
    var self = this;
    var opt = self.options;
    for (var i = 0; i < self.grid.length; i++) {
      removeGridCellStyles(self.grid[i]);
      opt.exportGrids[i].grid = self.grid[i]._grid;
    }
    RealGridJS.exportGrid(opt);
    for (var j = 0; j < self.grid.length; j++) {
      restoreGridCellStyles(self.grid[j]);
    }
  };
  function removeGridCellStyles(grid) {
    if (grid._grid.getSelectOptions().style !== "none") {
      grid._grid.clearCellStyles();
    }
  }
  function restoreGridCellStyles(grid) {
    var currentCell = grid._grid.getCurrent();
    var rowIndex = currentCell.dataRow;
    var fieldIndex = currentCell.fieldIndex;
    var background = grid.options.gridStyle.selection.focusBackgroundColor;
    if (typeof grid.columns[currentCell.column] !== "undefined" && typeof grid.columns[currentCell.column].attributes !== "undefined") {
      if (grid.columns[currentCell.column].attributes["class"] === "required") {
        background = grid.options.gridStyle.body.requiredFocusBackground;
      } else if (grid.columns[currentCell.column].attributes["class"] === "readonly") {
        background = grid.options.gridStyle.body.readonlyFocusBackground;
      }
    }
    if (grid._grid.getSelectOptions().style !== "none") {
      grid._grid.addCellStyle(
      "selection",
      {
        editable: false,
        background: background
      },
      true);

      grid._grid.setCellStyle(rowIndex, fieldIndex, "selection");
    }
  }
  function exportInitialOptions(options) {var _dews$_environments3;
    var defaultOptions = {
      type: "excel",
      applyDynamicStyles: true,
      allPages: true,
      target: "local",
      showProgress: true,
      progressMessage: dews.localize.get("\uC5D1\uC140 \uB0B4\uBCF4\uB0B4\uAE30 \uC911\uC785\uB2C8\uB2E4.", "dews_\uC5D1\uC140 \uB0B4\uBCF4\uB0B4\uAE30 \uC911\uC785\uB2C8\uB2E4."),
      numberCallback: function numberCallback(itemIndex, column, value) {
        return value;
      }
    };
    if (_typeof(options) === "object") {
      options.allItems = options.allPages || false;
    }
    var newOptions = $.extend(true, {}, defaultOptions, options);
    if ((_dews$_environments3 = dews._environments) !== null && _dews$_environments3 !== void 0 && _dews$_environments3.drmCreateDownload) {
      newOptions.target = "remote";
      newOptions.url = "/drmService/excel/create";
    }
    return newOptions;
  }

  // src/js/grid/excel/dews.ui.grid.exportToExcel.js
  (function ($2, dews2) {
    dews2.ui.grid.exportToExcel = function (options) {
      var grids, exportGrids, excelExporter;
      if (options.exportGrids) {
        exportGrids = options.exportGrids;
        grids = [];
        for (var i = 0; i < exportGrids.length; i++) {
          grids.push(exportGrids[i].grid);
        }
      }
      excelExporter = new ExcelExporter();
      excelExporter["export"](options, grids);
    };
  })(jQuery, window.dews || {});
})();


(function () {
  // src/js/grid/util/dews.ui.grid.FilterManager.js
  (function (dews) {
    function FilterManager(grid, gridType) {
      this._options = {
        filtering: {
          imageHandle: true,
          handleImages: {
            hoveredNone: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-off.png",
            hoveredFill: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png"
          }
        },
        filter: {
          use: true,
          iconVisible: false,
          useColumns: []
        }
      };
      this._columns = {};
      this._condition = {};
      this._columnInfoDict = {};
      this._columnType = "";
      this._columnName = "";
      this._grid = grid;
      if (gridType === "GRID") {
        gridType = "GRID_AVOID";
      }
      this._gridType = gridType;
      this._layerFilter;
      this._createCondition();
      this._getLoadData();
    }
    FilterManager.prototype._getLoadData = function () {
      var self = this;
      var loadFilterData = {};
      if (dews.ui.page.gridFilterData && dews.ui.page.gridFilterData.length > 0) {
        var gridFilterDataArr = dews.ui.page.gridFilterData.filter(function (data) {
          return data.gridId === self._grid.userOptions._dewsGridID;
        });
        var gridFilterData = gridFilterDataArr[0];
        if (gridFilterData && gridFilterData.columns && gridFilterData.columns.length > 0) {
          for (var i = 0; i < gridFilterData.columns.length; i++) {
            loadFilterData[gridFilterData.columns[i].columnName] = gridFilterData.columns[i];
          }
        }
        self._loadFilterData = loadFilterData;
      }
    };
    FilterManager.prototype._createCondition = function () {
      var self = this;
      var getDropDownText = function getDropDownText(columnName, dataRow, field, ddlDataObj, data) {
        var columnInfo = self._getColumnInfo(columnName);
        var ddlColumn = columnInfo.columnByName;
        var itemIndex;
        var dropdownText;
        var ddlFlag = $.type(ddlColumn.editorOptions.dataSource) === "function";
        if (ddlFlag) {
          if (fm._gridType === "TREEGRID") {
            itemIndex = fm._getRealGrid().getItemIndex(dataRow);
            dropdownText = fm._getRealGrid().getDisplayValues(itemIndex)[field];
          } else {
            dropdownText = fm._getRealGrid().getDisplayValuesOfRow(dataRow)[field];
          }
        } else {
          dropdownText = ddlDataObj[data];
        }
        return dropdownText;
      };
      var createDropDownData = function createDropDownData(columnName) {
        var columnInfo = self._getColumnInfo(columnName);
        var ddlColumn = columnInfo.columnByName;
        var ddlDataObj = {};
        var ddlFlag = $.type(ddlColumn.editorOptions.dataSource) === "function";
        if (!ddlFlag) {
          for (var i = 0; i < ddlColumn.values.length; i++) {
            ddlDataObj[ddlColumn.values[i]] = ddlColumn.labels[i];
          }
        }
        return ddlDataObj;
      };
      var getDropDownValue = function getDropDownValue(columnName, text) {
        var columnInfo = self._getColumnInfo(columnName);
        var ddlColumn = columnInfo.columnByName;
        var value;
        if (ddlColumn.labels) {
          for (var i = 0; i < ddlColumn.labels.length; i++) {
            if (text === ddlColumn.labels[i]) {
              value = ddlColumn.values[i];
              break;
            }
          }
          return value;
        } else {
          return false;
        }
      };
      var numberExpressionHandler = function numberExpressionHandler(fm2, callback, value1, value2, not, empty) {
        var decimalCount = getDecimalCount(fm2);
        var round = getRound(fm2);
        if (decimalCount > 0) {
          var pow = Math.pow(10, decimalCount);
        }
        return function (dataProvider, dataRow, field, filter, data) {
          if (decimalCount > 0) {
            if (round === "ceil") {
              data = Math.ceil(data * pow) / pow;
            } else if (round === "floor") {
              data = Math.floor(data * pow) / pow;
            } else {
              data = Math.round(data * pow) / pow;
            }
          }
          if (value2) {
            return callback(data, field, value1, value2);
          } else {
            return callback(data, field, value1);
          }
        };
      };
      var convertNotDataRegExp = function convertNotDataRegExp(notData) {
        try {
          var regExp = new RegExp(/^[*]+$/);
          var isMatch = notData.match(regExp);
          if (isMatch !== void 0 && isMatch !== null && isMatch.length > 0) {
            return null;
          }
        } catch (e) {
          return null;
        }
        var pureData;
        var regExpString;
        if (notData.startsWith("*") && notData.endsWith("*")) {
          pureData = notData.substring(1, notData.length - 1);
          regExpString = ".*" + pureData + ".*";
        } else if (notData.startsWith("*")) {
          pureData = notData.substring(1, notData.length);
          regExpString = ".*" + pureData;
        } else if (notData.endsWith("*")) {
          pureData = notData.substring(0, notData.length - 1);
          regExpString = pureData + ".*";
        } else {
          regExpString = notData;
        }
        return regExpString;
      };
      var excludeData = function excludeData(data, columnName, not, empty) {
        var columnInfo = self._getColumnInfo(columnName);
        var type = columnInfo.type;
        if (not && data !== void 0 && data !== null) {
          if (type === "number" || type === "date" || type === "month") {
            if (not.indexOf(data.toString()) !== -1) {
              return false;
            }
          } else {
            var isReturn;
            $.each(not, function (idx, notData) {
              var regExpString = convertNotDataRegExp(notData);
              if (regExpString === void 0 || regExpString === null) {
                return true;
              }
              regExpString = "^" + regExpString + "$";
              try {
                var regExp = new RegExp(regExpString, "i");
                var isMatch = data.match(regExp);
                if (isMatch === void 0 || isMatch === null) {
                  return true;
                } else if (isMatch.length > 0) {
                  isReturn = false;
                  return false;
                }
              } catch (e) {
                return true;
              }
            });
            if (isReturn === false) {
              return isReturn;
            }
          }
        }
        var getIsEmpty = function getIsEmpty(data2) {
          if (typeof data2 === "string") {
            return data2 === null || typeof data2 === "undefined" || data2 === "" || data2.trim() === "";
          } else if (typeof data2 === "number") {
            return data2 === null || typeof data2 === "undefined" || isNaN(data2);
          } else {
            return data2 === null || typeof data2 === "undefined";
          }
        };
        if (empty && getIsEmpty(data)) {
          return false;
        }
        return true;
      };
      self.excludeCriteria = function (type, criteria, not, empty) {
        var notExpr = "";
        if (not === void 0 && not === null) {
          not = [];
        }
        if (typeof not === "string") {
          not = not.split(",");
        }
        $.each(not, function (idx, notData) {
          var notDataRegExpString = convertNotDataRegExp(notData);
          if (notDataRegExpString === void 0 || notDataRegExpString === null) {
            return true;
          }
          var expr = self._condition["ne"].expression(type, notDataRegExpString, void 0, not, empty, true);
          if (expr !== null && expr !== void 0) {
            if (notExpr !== "") {
              notExpr += " and ";
            }
            notExpr += "(" + expr + ")";
          }
        });
        var emptyExpr = "";
        if (empty) {
          var emptyExpr = "value is not empty";
        }
        if (criteria === null || criteria === void 0) {
          criteria = "";
        }
        if (criteria !== "" && (notExpr !== "" || emptyExpr !== "")) {
          criteria = "(" + criteria + ")";
        }
        if (notExpr !== "") {
          if (criteria !== "") {
            criteria += " and ";
            0;
          }
          criteria += "(" + notExpr + ")";
        }
        if (emptyExpr !== "") {
          if (criteria !== "") {
            criteria += " and ";
          }
          criteria += "(" + emptyExpr + ")";
        }
        return criteria;
      };
      var toUpperCase = function toUpperCase(value) {
        if (typeof value === "string") {
          return value.toUpperCase();
        } else {
          return value;
        }
      };
      var getNumberFormatInfo = function getNumberFormatInfo(columnName) {
        var editorFormat = self._getEditorFormat(columnName);
        var valueFieldFormats = editorFormat.valueFieldFormats;
        var count = 2;
        var round = "round";
        if (valueFieldFormats) {
          if (valueFieldFormats.format) {
            var decimal = valueFieldFormats.format.split(".");
            if (decimal.length === 2) {
              count = decimal[1].length;
            }
          }
          if (valueFieldFormats.round) {
            round = valueFieldFormats.round;
          } else if (valueFieldFormats.predefined) {
            var preDefinedFormat = dews.getPreDefinedFormat(valueFieldFormats);
            round = preDefinedFormat.round;
          }
        }
        return {
          decimalCount: count,
          round: round
        };
      };
      var convertNumber = function convertNumber(columnName, value) {
        if (value == void 0 || value == null) {
          return value;
        }
        var numberFormatInfo = getNumberFormatInfo(columnName);
        var decimalCount = numberFormatInfo.decimalCount;
        var round = numberFormatInfo.round;
        var numberValue = 0;
        try {
          if (decimalCount > 0) {
            var pow = Math.pow(10, decimalCount);
            if (round === "ceil") {
              numberValue = Math.ceil(value * pow) / pow;
            } else if (round === "floor") {
              numberValue = Math.floor(value * pow) / pow;
            } else {
              numberValue = Math.round(value * pow) / pow;
            }
          } else {
            numberValue = parseInt(value);
          }
        } catch (e) {
        }
        return numberValue;
      };
      var stringToDate = function stringToDate(str) {
        if (typeof str !== "string") {
          return str;
        }
        var dataNumber = str.replace(/[^0-9]/g, "");
        var dataString = dataNumber.toString();
        var year;
        var month;
        var day;
        var date;
        try {
          if (dataString.length >= 8) {
            year = dataString.substring(0, 4);
            month = dataString.substring(4, 6);
            day = dataString.substring(6, 8);
            var nYear = parseInt(dataString.substring(0, 4));
            var nMonth = parseInt(dataString.substring(4, 6)) - 1;
            var nDay = parseInt(dataString.substring(6, 8));
            date = new Date(nYear, nMonth, nDay);
          } else if (dataString.length >= 6) {
            var nYear = parseInt(dataString.substring(0, 4));
            var nMonth = parseInt(dataString.substring(4, 6)) - 1;
            date = new Date(nYear, nMonth);
          } else if (dataString.length >= 4) {
            var nYear = parseInt(dataString.substring(0, 4));
            date = new Date(nYear);
          }
        } catch (e) {
        }
        return date;
      };
      var dateFormatString = function dateFormatString(columnName, date) {
        var editorFormat = self._getEditorFormat(columnName);
        var valueFieldFormats = editorFormat.valueFieldFormats;
        if (!valueFieldFormats) {
          return date;
        }
        var predefined = valueFieldFormats.predefined;
        var format = valueFieldFormats.format;
        try {
          if (predefined) {
            var preDefinedFormat = dews.getPreDefinedFormat(valueFieldFormats);
            if (preDefinedFormat !== false) {
              format = preDefinedFormat;
            }
          }
        } catch (e) {
        }
        if (typeof date === "string") {
          date = stringToDate(date);
        }
        var valueDateString = kendo.toString(date, format, kendo.getCulture());
        return valueDateString;
      };
      var dateToString = function dateToString(type, date) {
        var valueDateString, fmt;
        if (typeof date === "string") {
          valueDateString = date;
        } else {
          if (type === "date") {
            fmt = "yyyyMMdd";
          } else if (type === "month") {
            fmt = "yyyyMM";
          }
          valueDateString = kendo.toString(date, fmt, kendo.getCulture());
        }
        return valueDateString;
      };
      var getAddRowCompareData = function getAddRowCompareData(columnName, addCellValue, filterValue1, filterValue2) {
        var columnInfo = self._getColumnInfo(columnName);
        var columnByName = columnInfo.columnByName;
        var type = columnInfo.type;
        var _rtnCellValue;
        var _rtnFilterValue1;
        var _rtnFilterValue2;
        try {
          if (type === "number") {
            _rtnCellValue = convertNumber(columnName, addCellValue);
            _rtnFilterValue1 = convertNumber(columnName, filterValue1);
            _rtnFilterValue2 = convertNumber(columnName, filterValue2);
          } else if (type === "dropDown") {
            var dataObj = createDropDownData(columnName);
            _rtnCellValue = addCellValue;
            _rtnFilterValue1 = getDropDownValue(columnName, filterValue1);
            _rtnFilterValue2 = getDropDownValue(columnName, filterValue2);
          } else if (type === "date" || type === "month") {
            _rtnCellValue = dateFormatString(columnName, addCellValue);
            _rtnFilterValue1 = dateFormatString(columnName, filterValue1);
            _rtnFilterValue2 = dateFormatString(columnName, filterValue2);
          } else {
            _rtnCellValue = toUpperCase(addCellValue);
            _rtnFilterValue1 = toUpperCase(filterValue1);
            _rtnFilterValue2 = toUpperCase(filterValue2);
          }
        } catch (e) {
        }
        return {
          type: type,
          addCellValue: _rtnCellValue,
          filterValue1: _rtnFilterValue1,
          filterValue2: _rtnFilterValue2
        };
      };
      var expression = {
        e: {
          value: "equal",
          text: "=",
          addRowCompare: function addRowCompare(columnName, addCellValue, filterValue1, filterValue2) {
            var compareData = getAddRowCompareData(columnName, addCellValue, filterValue1, filterValue2);
            return compareData.addCellValue === compareData.filterValue1;
          },
          expression: function expression(type, value1, value2, not, empty) {
            var criteria;
            if (type === "number") {
              var numberFormatInfo = getNumberFormatInfo(self._columnName);
              var decimalCount = numberFormatInfo.decimalCount;
              var round = numberFormatInfo.round;
              criteria = "value = " + value1;
              if (decimalCount > 0) {
                var pow = Math.pow(10, decimalCount);
                if (round === "ceil") {
                  criteria = "(((" + value1 + " * " + pow + ") - 1) / " + pow + " < value) and (value <= " + value1 + ")";
                } else if (round === "floor") {
                  criteria = "(" + value1 + " <= value) and (value < ((" + value1 + " * " + pow + ") + 1) / " + pow + ")";
                } else {
                  criteria = "(((" + value1 + " * " + pow + ") - 0.5) / " + pow + " <= value) and (value < ((" + value1 + " * " + pow + ") + 0.5) / " + pow + ")";
                }
              }
            } else if (type === "dropDown") {
              var ddlValue = getDropDownValue(self._columnName, value1);
              criteria = 'value imatch "^' + ddlValue + '$"';
            } else if (type === "date" || type === "month") {
              var valueDateString = dateToString(type, value1);
              criteria = 'datestr(value) like "' + valueDateString + '%"';
            } else {
              if (value1.indexOf("[") > 0 || value1.indexOf("]") > 0) {
                value1 = value1.replaceAll("[", "\\\\[").replaceAll("]", "\\\\]");
              }
              if (value1.indexOf("(") > 0 || value1.indexOf(")") > 0) {
                value1 = value1.replaceAll("(", "[(]").replaceAll(")", "[)]");
              }
              criteria = 'value imatch "^' + value1 + '$"';
            }
            criteria = self.excludeCriteria(type, criteria, not, empty);
            return criteria;
          }
        },
        ne: {
          value: "notEqual",
          text: "<>",
          addRowCompare: function addRowCompare(columnName, addCellValue, filterValue1, filterValue2) {
            var compareData = getAddRowCompareData(columnName, addCellValue, filterValue1, filterValue2);
            return compareData.addCellValue !== compareData.filterValue1;
          },
          expression: function expression(type, value1, value2, not, empty, overStackFlowBlock) {
            var criteria;
            try {
              if (type === "number") {
                if (value1 !== void 0 && value1 !== null && value1 !== "") {
                  var numberFormatInfo = getNumberFormatInfo(self._columnName);
                  var decimalCount = numberFormatInfo.decimalCount;
                  var round = numberFormatInfo.round;
                  criteria = "value <> " + value1;
                  if (decimalCount > 0) {
                    var pow = Math.pow(10, decimalCount);
                    if (round === "ceil") {
                      criteria = "(value is Empty) or (((" + value1 + " * " + pow + ") - 1) / " + pow + " >= value) or (value > " + value1 + ")";
                    } else if (round === "floor") {
                      criteria = "(value is Empty) or (" + value1 + " > value) or (value >= ((" + value1 + " * " + pow + ") + 1) / " + pow + ")";
                    } else {
                      criteria = "(value is Empty) or (((" + value1 + " * " + pow + ") - 0.5) / " + pow + " > value) or (value >= ((" + value1 + " * " + pow + ") + 0.5) / " + pow + ")";
                    }
                  }
                }
              } else if (type === "dropDown") {
                var ddlValue = getDropDownValue(self._columnName, value1);
                criteria = '(value is Empty) or (value not imatch "^' + ddlValue + '$")';
              } else if (type === "date" || type === "month") {
                value1 = stringToDate(value1);
                var year = value1.getFullYear();
                var month = value1.getMonth() + 1;
                var day = value1.getDate();
                if (type === "date") {
                  criteria = "(value is Empty) or ((year(value) <> " + year + ") or (month(value) <> " + month + ") or (day(value) <> " + day + "))";
                } else {
                  criteria = "(value is Empty) or ((year(value) <> " + year + ") or (month(value) <> " + month + "))";
                }
              } else {
                criteria = '(value is Empty) or (value not imatch "^' + value1 + '$")';
              }
            } catch (e) {
            }
            if (!overStackFlowBlock) {
              criteria = self.excludeCriteria(type, criteria, not, empty);
            }
            return criteria;
          }
        },
        gt: {
          value: "gt",
          text: ">",
          addRowCompare: function addRowCompare(columnName, addCellValue, filterValue1, filterValue2) {
            var compareData = getAddRowCompareData(columnName, addCellValue, filterValue1, filterValue2);
            return compareData.addCellValue > compareData.filterValue1;
          },
          expression: function expression(type, value1, value2, not, empty) {
            var criteria;
            if (type === "number") {
              var numberFormatInfo = getNumberFormatInfo(self._columnName);
              var decimalCount = numberFormatInfo.decimalCount;
              var round = numberFormatInfo.round;
              criteria = "value >" + value1;
              if (decimalCount > 0) {
                var pow = Math.pow(10, decimalCount);
                if (round === "floor") {
                  criteria = "value >= ((" + value1 + " * " + pow + ") + 1) / " + pow;
                } else if (round === "round") {
                  criteria = "value >= ((" + value1 + " * " + pow + ") + 0.5) / " + pow;
                }
              }
            } else if (type === "dropDown") {
              var ddlValue = getDropDownValue(self._columnName, value1);
              criteria = 'value > "' + ddlValue + '"';
            } else if (type === "date" || type === "month") {
              var year = value1.getFullYear();
              var month = value1.getMonth() + 1;
              var day = value1.getDate();
              if (type === "date") {
                criteria = "((year(value) = " + year + ") and (month(value) = " + month + ") and (day(value) > " + day + "))or ((year(value) = " + year + ") and (month(value) > " + month + ")or ((year(value) > " + year + "))";
              } else {
                criteria = "((year(value) = " + year + ") and (month(value) > " + month + ")or ((year(value) > " + year + "))";
              }
            } else {
              criteria = 'value > "' + value1 + '"';
            }
            criteria = self.excludeCriteria(type, criteria, not, empty);
            return criteria;
          }
        },
        gtoet: {
          value: "gtoet",
          text: ">=",
          addRowCompare: function addRowCompare(columnName, addCellValue, filterValue1, filterValue2) {
            var compareData = getAddRowCompareData(columnName, addCellValue, filterValue1, filterValue2);
            return compareData.addCellValue >= compareData.filterValue1;
          },
          expression: function expression(type, value1, value2, not, empty) {
            var criteria;
            if (type === "number") {
              var numberFormatInfo = getNumberFormatInfo(self._columnName);
              var decimalCount = numberFormatInfo.decimalCount;
              var round = numberFormatInfo.round;
              criteria = "value >=" + value1;
              if (decimalCount > 0) {
                var pow = Math.pow(10, decimalCount);
                if (round === "ceil") {
                  criteria = "((" + value1 + " * " + pow + ") - 1) / " + pow + " < value";
                } else if (round === "round") {
                  criteria = "((" + value1 + " * " + pow + ") - 0.5) / " + pow + " <= value";
                }
              }
            } else if (type === "dropDown") {
              var ddlValue = getDropDownValue(self._columnName, value1);
              criteria = 'value >= "' + ddlValue + '"';
            } else if (type === "date" || type === "month") {
              var year = value1.getFullYear();
              var month = value1.getMonth() + 1;
              var day = value1.getDate();
              if (type === "date") {
                criteria = "((year(value) = " + year + ") and (month(value) = " + month + ") and (day(value) >= " + day + "))or ((year(value) = " + year + ") and (month(value) > " + month + ")or ((year(value) > " + year + "))";
              } else {
                criteria = "((year(value) = " + year + ") and (month(value) >= " + month + ")or ((year(value) > " + year + "))";
              }
            } else {
              criteria = 'value >= "' + value1 + '"';
            }
            criteria = self.excludeCriteria(type, criteria, not, empty);
            return criteria;
          }
        },
        lt: {
          value: "lt",
          text: "<",
          addRowCompare: function addRowCompare(columnName, addCellValue, filterValue1, filterValue2) {
            var compareData = getAddRowCompareData(columnName, addCellValue, filterValue1, filterValue2);
            return compareData.addCellValue < compareData.filterValue1;
          },
          expression: function expression(type, value1, value2, not, empty) {
            var criteria;
            if (type === "number") {
              var numberFormatInfo = getNumberFormatInfo(self._columnName);
              var decimalCount = numberFormatInfo.decimalCount;
              var round = numberFormatInfo.round;
              criteria = "value <" + value1;
              if (decimalCount > 0) {
                var pow = Math.pow(10, decimalCount);
                if (round === "ceil") {
                  criteria = "((" + value1 + " * " + pow + ") - 1) / " + pow + " >= value";
                } else if (round === "round") {
                  criteria = "((" + value1 + " * " + pow + ") - 0.5) / " + pow + " > value";
                }
              }
            } else if (type === "dropDown") {
              var ddlValue = getDropDownValue(self._columnName, value1);
              criteria = 'value < "' + ddlValue + '"';
            } else if (type === "date" || type === "month") {
              var year = value1.getFullYear();
              var month = value1.getMonth() + 1;
              var day = value1.getDate();
              if (type === "date") {
                criteria = "((year(value) = " + year + ") and (month(value) = " + month + ") and (day(value) < " + day + "))or ((year(value) = " + year + ") and (month(value) < " + month + ")or ((year(value) < " + year + "))";
              } else {
                criteria = "((year(value) = " + year + ") and (month(value) < " + month + ")or ((year(value) < " + year + "))";
              }
            } else {
              criteria = 'value < "' + value1 + '"';
            }
            criteria = self.excludeCriteria(type, criteria, not, empty);
            return criteria;
          }
        },
        ltoet: {
          value: "lt",
          text: "=<",
          addRowCompare: function addRowCompare(columnName, addCellValue, filterValue1, filterValue2) {
            var compareData = getAddRowCompareData(columnName, addCellValue, filterValue1, filterValue2);
            return compareData.addCellValue <= compareData.filterValue1;
          },
          expression: function expression(type, value1, value2, not, empty) {
            var criteria;
            if (type === "number") {
              var numberFormatInfo = getNumberFormatInfo(self._columnName);
              var decimalCount = numberFormatInfo.decimalCount;
              var round = numberFormatInfo.round;
              criteria = "value <=" + value1;
              if (decimalCount > 0) {
                var pow = Math.pow(10, decimalCount);
                if (round === "floor") {
                  criteria = "value < ((" + value1 + " * " + pow + ") + 1) / " + pow;
                } else if (round === "round") {
                  criteria = "value < ((" + value1 + " * " + pow + ") + 0.5) / " + pow;
                }
              }
            } else if (type === "dropDown") {
              var ddlValue = getDropDownValue(self._columnName, value1);
              criteria = 'value <= "' + ddlValue + '"';
            } else if (type === "date" || type === "month") {
              var year = value1.getFullYear();
              var month = value1.getMonth() + 1;
              var day = value1.getDate();
              if (type === "date") {
                criteria = "((year(value) = " + year + ") and (month(value) = " + month + ") and (day(value) <= " + day + "))or ((year(value) = " + year + ") and (month(value) < " + month + ")or ((year(value) < " + year + "))";
              } else {
                criteria = "((year(value) = " + year + ") and (month(value) <= " + month + ")or ((year(value) < " + year + "))";
              }
            } else {
              criteria = 'value <= "' + value1 + '"';
            }
            criteria = self.excludeCriteria(type, criteria, not, empty);
            return criteria;
          }
        },
        r: {
          value: "r",
          text: "\uBC94\uC704",
          addRowCompare: function addRowCompare(columnName, addCellValue, filterValue1, filterValue2) {
            var compareData = getAddRowCompareData(columnName, addCellValue, filterValue1, filterValue2);
            return compareData.addCellValue <= compareData.filterValue2 && compareData.addCellValue >= compareData.filterValue1;
          },
          expression: function expression(type, value1, value2, not, empty) {
            var criteria;
            if (type === "number") {
              var numberFormatInfo = getNumberFormatInfo(self._columnName);
              var decimalCount = numberFormatInfo.decimalCount;
              var round = numberFormatInfo.round;
              criteria = "(value <= " + value2 + ") and (value >= " + value1 + ")";
              if (decimalCount > 0) {
                var pow = Math.pow(10, decimalCount);
                if (round === "ceil") {
                  criteria = "(((" + value1 + " * " + pow + ") - 1) / " + pow + " < value) and (value <= " + value2 + ")";
                } else if (round === "floor") {
                  criteria = "(value >= " + value1 + ") and (value < ((" + value2 + " * " + pow + ") + 1) / " + pow + ")";
                } else {
                  criteria = "(((" + value1 + " * " + pow + ") - 0.5) / " + pow + " <= value) and (value < ((" + value2 + " * " + pow + ") + 0.5) / " + pow + ")";
                }
              }
            } else if (type === "date" || type === "month") {
              var year1 = value1.getFullYear();
              var month1 = value1.getMonth() + 1;
              var day1 = value1.getDate();
              var year2 = value2.getFullYear();
              var month2 = value2.getMonth() + 1;
              var day2 = value2.getDate();
              if (type === "date") {
                criteria = "(((year(value) = ".concat(year1, ") and (month(value) = ").concat(month1, ") and (day(value) >= ").concat(day1, ")) or ((year(value) = ").concat(year1, ") and (month(value) > ").concat(month1, ")) or ((year(value) > ").concat(year1, "))) and (((year(value) = ").concat(year2, ") and (month(value) = ").concat(month2, ") and (day(value) <= ").concat(day2, ")) or ((year(value) = ").concat(year2, ") and (month(value) < ").concat(month2, ")) or ((year(value) < ").concat(year2, ")))");
              } else {
                criteria = "(((year(value) = " + year2 + ") and (month(value) <= " + month2 + ")or ((year(value) < " + year2 + ")))and (((year(value) = " + year1 + ") and (month(value) >= " + month1 + ")or ((year(value) > " + year1 + ")))";
              }
            } else {
              criteria = '(value <= "' + value2 + '") and (value >= "' + value1 + '")';
            }
            criteria = self.excludeCriteria(type, criteria, not, empty);
            return criteria;
          }
        },
        sc: {
          value: "sc",
          text: "\uC2DC\uC791 \uBB38\uC790",
          addRowCompare: function addRowCompare(columnName, addCellValue, filterValue1, filterValue2) {
            var compareData = getAddRowCompareData(columnName, addCellValue, filterValue1, filterValue2);
            return compareData.addCellValue.startsWith(compareData.filterValue1);
          },
          expression: function expression(type, value1, value2, not, empty) {
            var criteria;
            if (type === "dropDown") {
              var ddlValue = getDropDownValue(self._columnName, value1);
              criteria = 'value ilike "' + ddlValue + '%"';
            } else {
              criteria = 'value ilike "' + value1 + '%"';
            }
            criteria = self.excludeCriteria(type, criteria, not, empty);
            return criteria;
          }
        },
        scte: {
          value: "scte",
          text: "\uC81C\uC678\uD560 \uC2DC\uC791 \uBB38\uC790",
          addRowCompare: function addRowCompare(columnName, addCellValue, filterValue1, filterValue2) {
            var compareData = getAddRowCompareData(columnName, addCellValue, filterValue1, filterValue2);
            return !compareData.addCellValue.startsWith(compareData.filterValue1);
          },
          expression: function expression(type, value1, value2, not, empty) {
            var criteria;
            if (type === "dropDown") {
              var ddlValue = getDropDownValue(self._columnName, value1);
              criteria = 'value not ilike "' + ddlValue + '%"';
            } else {
              criteria = 'value not ilike "' + value1 + '%"';
            }
            criteria = self.excludeCriteria(type, criteria, not, empty);
            return criteria;
          }
        },
        ec: {
          value: "ec",
          text: "\uB05D \uBB38\uC790",
          addRowCompare: function addRowCompare(columnName, addCellValue, filterValue1, filterValue2) {
            var compareData = getAddRowCompareData(columnName, addCellValue, filterValue1, filterValue2);
            return compareData.addCellValue.endsWith(compareData.filterValue1);
          },
          expression: function expression(type, value1, value2, not, empty) {
            var criteria;
            if (type === "dropDown") {
              var ddlValue = getDropDownValue(self._columnName, value1);
              criteria = 'value imatch "' + ddlValue + '$"';
            } else {
              criteria = 'value imatch "' + value1 + '$"';
            }
            criteria = self.excludeCriteria(type, criteria, not, empty);
            return criteria;
          }
        },
        ecte: {
          value: "ecte",
          text: "\uC81C\uC678\uD560 \uB05D \uBB38\uC790",
          addRowCompare: function addRowCompare(columnName, addCellValue, filterValue1, filterValue2) {
            var compareData = getAddRowCompareData(columnName, addCellValue, filterValue1, filterValue2);
            return !compareData.addCellValue.endsWith(compareData.filterValue1);
          },
          expression: function expression(type, value1, value2, not, empty) {
            var criteria;
            if (type === "dropDown") {
              var ddlValue = getDropDownValue(self._columnName, value1);
              criteria = 'value not imatch "' + ddlValue + '$"';
            } else {
              criteria = 'value not imatch "' + value1 + '$"';
            }
            criteria = self.excludeCriteria(type, criteria, not, empty);
            return criteria;
          }
        },
        i: {
          value: "i",
          text: "\uD3EC\uD568",
          addRowCompare: function addRowCompare(columnName, addCellValue, filterValue1, filterValue2) {
            var compareData = getAddRowCompareData(columnName, addCellValue, filterValue1, filterValue2);
            return compareData.addCellValue.indexOf(compareData.filterValue1) !== -1;
          },
          expression: function expression(type, value1, value2, not, empty) {
            var criteria;
            if (type === "dropDown") {
              var ddlValue = getDropDownValue(self._columnName, value1);
              criteria = 'value ilike "%' + ddlValue + '%"';
            } else {
              criteria = 'value ilike "%' + value1 + '%"';
            }
            criteria = self.excludeCriteria(type, criteria, not, empty);
            return criteria;
          }
        },
        ni: {
          value: "ni",
          text: "\uD3EC\uD568\uD558\uC9C0 \uC54A\uC74C",
          addRowCompare: function addRowCompare(columnName, addCellValue, filterValue1, filterValue2) {
            var compareData = getAddRowCompareData(columnName, addCellValue, filterValue1, filterValue2);
            return !(compareData.addCellValue.indexOf(compareData.filterValue1) !== -1);
          },
          expression: function expression(type, value1, value2, not, empty) {
            var criteria;
            if (type === "dropDown") {
              var ddlValue = getDropDownValue(self._columnName, value1);
              criteria = 'value not ilike "%' + ddlValue + '%"';
            } else {
              criteria = 'value not ilike "%' + value1 + '%"';
            }
            criteria = self.excludeCriteria(type, criteria, not, empty);
            return criteria;
          }
        },
        ev: {
          value: "ev",
          text: "\uBE48\uAC12",
          addRowCompare: function addRowCompare(columnName, addCellValue, filterValue1, filterValue2) {
            var compareData = getAddRowCompareData(columnName, addCellValue, filterValue1, filterValue2);
            var d = compareData.addCellValue;
            if (typeof d === "string") {
              return d === "" || d === null || typeof d === "undefined" || d.trim() === "";
            } else {
              return d === null || typeof d === "undefined";
            }
          },
          expression: function expression(type, value1, value2, not, empty) {
            var criteria = '(value is empty) or (value match "^[ ]+$")';
            criteria = self.excludeCriteria(type, criteria, not, empty);
            return criteria;
          }
        },
        ebv: {
          value: "ebv",
          text: "\uBE48\uAC12 \uC81C\uC678",
          addRowCompare: function addRowCompare(columnName, addCellValue, filterValue1, filterValue2) {
            var compareData = getAddRowCompareData(columnName, addCellValue, filterValue1, filterValue2);
            var d = compareData.addCellValue;
            if (typeof d === "string") {
              return d !== null && typeof d !== "undefined" && d !== "" && d.trim() !== "";
            } else {
              return d !== null && typeof d !== "undefined";
            }
          },
          expression: function expression(type, value1, value2, not, empty) {
            var criteria = '(value is not empty) and (value not match "^[ ]+$")';
            criteria = self.excludeCriteria(type, criteria, not, empty);
            return criteria;
          }
        }
      };
      this._condition = expression;
    };
    FilterManager.prototype._getRealGrid = function () {
      return this._grid._grid;
    };
    FilterManager.prototype._getColumnInfo = function (columnName) {
      if (columnName === void 0 || columnName === null) {
        columnName = this._columnName;
      }
      if (columnName in this._columnInfoDict === false) {
        var info = {};
        var columnByName = this._getRealGrid().columnByName(columnName);
        info.columnByName = columnByName;
        var type = columnByName.editorOptions.type;
        if (type !== "number" || type !== "date" || type !== "month") {
          var fields = this._grid.dataSource.dataProvider.getFields();
          var formats = this._grid.columns[columnName].formats;
          var dataType;
          for (var i = 0; i < fields.length; i++) {
            if (fields[i].orgFieldName === columnName) {
              dataType = fields[i].dataType;
              break;
            }
          }
          if (dataType !== "text" && formats && formats.type) {
            type = formats.type;
          }
        }
        info.type = type;
        this._columnInfoDict[columnName] = info;
      }
      return this._columnInfoDict[columnName];
    };
    FilterManager.prototype._setColumnName = function (columnName) {
      this._columnName = columnName;
    };
    FilterManager.prototype._getEditorFormat = function (columnName) {
      var valueFieldEditor;
      var valueFieldFormats;
      var value2Visible = true;
      var etcComponent;
      var etcComponentFormat;
      var align = "left";
      var columnInfo = this._getColumnInfo(columnName);
      var type = columnInfo.type;
      var editorFormat;
      var formatsFormat;
      var gridColumn = this._grid.columns[columnName];
      if (gridColumn.editor.format) {
        editorFormat = gridColumn.editor.format;
      }
      if (gridColumn.formats && gridColumn.formats.format) {
        formatsFormat = gridColumn.formats.format;
      }
      switch (type) {
        case "date":
          valueFieldEditor = {
            type: "date",
            format: dews._environments.formats.dateFormat
          };
          valueFieldFormats = {
            type: "date",
            format: dews._environments.formats.dateFormat
          };
          etcComponent = "datepicker";
          break;
        case "month":
          valueFieldEditor = {
            type: "month",
            format: dews._environments.formats.monthFormat
          };
          valueFieldFormats = {
            type: "month",
            format: dews._environments.formats.monthFormat
          };
          etcComponent = "monthpicker";
          break;
        case "time":
          valueFieldEditor = {
            type: "time"
          };
          valueFieldFormats = {
            type: "time"
          };
          if (gridColumn.editor.secondValue === true) {
            valueFieldEditor.secondValue = true;
            valueFieldEditor.format = "HH:mm:ss";
            valueFieldFormats.format = "HH:mm:ss";
          } else {
            valueFieldEditor.format = "HH:mm";
            valueFieldFormats.format = "HH:mm";
          }
          etcComponent = "timepicker";
          break;
        case "number":
          valueFieldEditor = {
            type: "number"
          };
          valueFieldFormats = {
            type: "number"
          };
          etcComponent = "numerictextbox";
          align = "right";
          break;
        default:
          valueFieldEditor = {
            type: "string"
          };
          value2Visible = false;
          etcComponent = "textbox";}

      if (formatsFormat) {
        valueFieldEditor.format = formatsFormat;
        etcComponentFormat = formatsFormat;
        if (valueFieldFormats) {
          valueFieldFormats.format = formatsFormat;
          if (gridColumn.formats.round) {
            valueFieldFormats.round = gridColumn.formats.round;
          }
          if (gridColumn.formats.predefined) {
            valueFieldFormats.predefined = true;
            if (gridColumn.formats.preFormat) {
              valueFieldFormats.originalFormat = valueFieldFormats.format;
              valueFieldFormats.preFormat = gridColumn.formats.preFormat;
            }
          }
        }
      } else if (editorFormat) {
        valueFieldEditor.format = editorFormat;
        etcComponentFormat = editorFormat;
        if (valueFieldFormats) {
          valueFieldFormats.format = editorFormat;
          if (gridColumn.editor.round) {
            valueFieldFormats.round = gridColumn.editor.round;
          }
          if (gridColumn.editor.predefined) {
            valueFieldFormats.predefined = true;
            if (gridColumn.editor.preFormat) {
              valueFieldFormats.originalFormat = valueFieldFormats.format;
              valueFieldFormats.preFormat = gridColumn.editor.preFormat;
            }
          }
        }
      }
      return {
        valueFieldEditor: valueFieldEditor,
        valueFieldFormats: valueFieldFormats,
        value2Visible: value2Visible,
        etcComponent: etcComponent,
        etcComponentFormat: etcComponentFormat,
        align: align
      };
    };
    FilterManager.prototype.optionConvert = function (filterOptions) {
      var opt = this._options;
      if (typeof filterOptions === "boolean") {
        opt.filter.use = filterOptions;
      } else if (_typeof(filterOptions) === "object") {
        if (filterOptions.iconVisible) {
          opt.filtering.handleImages = {
            none: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-off.png",
            fill: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png",
            hoveredNone: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-off.png",
            hoveredFill: dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png"
          };
        }
      }
    };
    FilterManager.prototype.columnOptionConvert = function (column) {
      var opt = this._options;
      if (!opt.filter.use)
      return;
      if (column.field === "__UUID" || !column.field || column.grouping || column.columns)
      return;
      if (column.editor && (column.editor.type === "mask" || column.editor.type === "button" || column.editor.type === "check"))
      return;
      if (column.formats && (column.formats.type === "mask" || column.formats.type === "check" || column.formats.type === "image" || column.formats.type === "password"))
      return;
      var cols = this._columns;
      if (cols[column.field] === void 0) {
        cols[column.field] = {};
      }
      if (typeof column.filter === "boolean") {
        cols[column.field].use = column.filter;
      } else if (column.filter === void 0) {
        cols[column.field].use = !!opt.filter;
      }
      if (cols[column.field].use) {var _column$editor5;
        if (!cols[column.field].data) {
          cols[column.field].data = [];
        }
        if (this._loadFilterData && this._loadFilterData[column.field]) {var _loadColumnFilterData;
          var loadColumnFilterData = this._loadFilterData[column.field];
          if (((_loadColumnFilterData = loadColumnFilterData.filters) === null || _loadColumnFilterData === void 0 ? void 0 : _loadColumnFilterData.length) > 0) {
            var findNotData = loadColumnFilterData.filters.filter(function (x) {
              return x.filterName.indexOf("__save_notData_") !== -1;
            });
            if (findNotData) {
              var arr = [];
              findNotData.forEach(function (data) {
                arr.push(data.value1);
              });
              cols[column.field].notData = arr.join(",");
            }
            cols[column.field].data = loadColumnFilterData.filters.filter(function (x) {
              return !(x.filterName.indexOf("__save_notData_") !== -1);
            });
          }
          if (loadColumnFilterData.etcFilter) {
            cols[column.field].etcData = loadColumnFilterData.etcFilter;
          }
        }
        if (!(this._gridType === "TREEGRID" && ((_column$editor5 = column.editor) === null || _column$editor5 === void 0 ? void 0 : _column$editor5.type) === "dropDown" && typeof column.editor.dataSource === "function")) {
          opt.filter.useColumns.push(column.field);
        }
      }
    };
    FilterManager.prototype.setFilterActions = function () {
      var self = this;
      var optFilter = self._options.filter;
      if (optFilter.use) {
        $.each(optFilter.useColumns, function (index) {
          var filterColumn = optFilter.useColumns[index];
          var action = {
            name: filterColumn + "_filterAction",
            text: filterColumn + "_filterText"
          };
          self._getRealGrid().setColumnFilterActions(filterColumn, action);
        });
      }
    };
    FilterManager.prototype.createFilterLayer = function (columnName, x, y, isVisible, customClose) {
      var self = this;
      self._setColumnName(columnName);
      var columnInfo = self._getColumnInfo();
      var type = columnInfo.type;
      var title = columnInfo.columnByName.header.text;
      var displayWidth = columnInfo.columnByName.displayWidth;
      if (type !== "number" || type !== "date" || type !== "month") {
        var fields = self._grid.dataSource.dataProvider.getFields();
        var formats = self._grid.columns[columnName].formats;
        var dataType;
        for (var i = 0; i < fields.length; i++) {
          if (fields[i].orgFieldName === columnName) {
            dataType = fields[i].dataType;
            break;
          }
        }
        if (dataType !== "text" && formats && formats.type) {
          type = formats.type;
        }
      }
      self._columnType = type;
      var dlgWidth = 340;
      if (type === "date" || type === "month" || type === "time" || type === "number") {
        dlgWidth = 437;
      }
      var layerX;
      var layerY;
      var gridOffset = self._grid.$element.offset();
      if ($(window).width() - gridOffset.left - x < 428) {
        layerX = displayWidth + x + gridOffset.left - dlgWidth;
      } else {
        layerX = x + gridOffset.left;
      }
      layerY = y + gridOffset.top + 2;
      var layerFilterTarget = {
        dataType: type
      };
      var layerFilterOption = {
        left: layerX,
        top: layerY,
        width: dlgWidth,
        visible: isVisible,
        autoClose: customClose
      };
      this._layerFilter = new dews.fn.layer.filter(layerFilterTarget, layerFilterOption);
      $(this._layerFilter).on("dataChanged", function (e) {
        self._columns[columnName].data = e.filterData;
        self._columns[columnName].etcData = e.filterEtcData;
        self._columns[columnName].isCheckNot = e.isCheckNot;
        self._columns[columnName].notData = e.notData;
        self._columns[columnName].isCheckEmpty = e.isCheckEmpty;
        self.apply();
      });
      $(this._layerFilter).on("save", function (e) {
        var layer = e.layer;
        var layerGrid = layer._layerComponents.grid;
        var layerRealGrid = layerGrid._grid;
        var filterData = e.filterData;
        var filterEtcData = e.filterEtcData;
        var filterIsCheckNot = e.isCheckNot;
        var filterNotData = e.notData;
        var filterIsCheckEmpty = e.isCheckEmpty;
        if (filterData.length > 0) {
          var validateReturn = false;
          $.each(filterData, function (idx, data) {
            var itemIndex = layerRealGrid.getItemIndex(idx);
            var result = layer._layerGridRowDataValidate(itemIndex);
            if (!result) {
              validateReturn = true;
              return false;
            }
            data.noSq = idx;
            if (type === "date") {
              if (data.value1 && $.type(data.value1) === "date") {
                data.value1 = kendo.toString(data.value1, "yyyyMMdd", kendo.getCulture());
              }
              if (data.value2 && $.type(data.value2) === "date") {
                data.value2 = kendo.toString(data.value2, "yyyyMMdd", kendo.getCulture());
              }
            }
            if (type === "month") {
              if (data.value1 && $.type(data.value1) === "date") {
                data.value1 = kendo.toString(data.value1, "yyyyMM", kendo.getCulture());
              }
              if (data.value2 && $.type(data.value2) === "date") {
                data.value2 = kendo.toString(data.value2, "yyyyMM", kendo.getCulture());
              }
            }
          });
          if (validateReturn) {
            return;
          }
        }
        layer._deactivate();
        dews.confirm(dews.localize.get("\uC800\uC7A5\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?", "dews_\uC800\uC7A5\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")).yes(function () {
          var saveData = {
            gridId: self._grid.userOptions._dewsGridID,
            columns: []
          };
          var columnData = {
            columnName: columnName,
            filters: filterData
          };
          if (filterEtcData) {
            columnData.etcFilter = filterEtcData;
          }
          if ((filterNotData === null || filterNotData === void 0 ? void 0 : filterNotData.length) > 0) {
            filterNotData.forEach(function (item, index) {
              columnData.filters.push({
                filterName: "__save_notData_".concat(Date.now()).concat(index),
                value1: item
              });
            });
          }
          saveData.columns.push(columnData);
          if (dews.ui.page) {
            dews.ui.page._saveGridFilter(saveData).done(function () {
              dews.ui.snackbar.ok(
              dews.localize.get(
              "\uD604\uC7AC \uD544\uD130 \uB808\uC774\uC5B4 \uB0B4\uC5ED\uC774 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",
              "dews_\uD604\uC7AC \uD544\uD130 \uB808\uC774\uC5B4 \uB0B4\uC5ED\uC774 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4."));


            }).fail(function () {
              dews.ui.snackbar.error(
              dews.localize.get(
              "\uD604\uC7AC \uD544\uD130 \uB808\uC774\uC5B4 \uB0B4\uC5ED\uC774 \uC800\uC7A5\uC5D0 \uC2E4\uD328\uD558\uC600\uC2B5\uB2C8\uB2E4.",
              "dews_\uD604\uC7AC \uD544\uD130 \uB808\uC774\uC5B4 \uB0B4\uC5ED\uC774 \uC800\uC7A5\uC5D0 \uC2E4\uD328\uD558\uC600\uC2B5\uB2C8\uB2E4."));


            });
          }
          layer._activate();
        }).no(function () {
          layer._activate();
        });
      });
      $(this._layerFilter).on("closed", function (e) {
        $(this._layerFilter).off("dataChanged");
        $(this._layerFilter).off("closed");
      });
      var editorFormat = this._getEditorFormat(columnName);
      var valueFieldEditor = editorFormat.valueFieldEditor;
      var valueFieldFormats = editorFormat.valueFieldFormats;
      var value2Visible = editorFormat.value2Visible;
      var etcComponent = editorFormat.etcComponent;
      var etcComponentFormat = editorFormat.etcComponentFormat;
      var align = editorFormat.align;
      var openOption = this._layerFilter._getOpenDefaultOption();
      openOption.general.field = columnName;
      openOption.general.title = title;
      openOption.grid.editor = valueFieldEditor;
      openOption.grid.formats = valueFieldFormats;
      openOption.grid.isVisibleValue2 = value2Visible;
      openOption.grid.align = align;
      openOption.etc.etcComponent = etcComponent;
      openOption.etc.etcComponentFormat = etcComponentFormat;
      openOption.grid.data = this._columns[columnName].data;
      openOption.etc.data = this._columns[columnName].etcData;
      openOption.not.check = this._columns[columnName].isCheckNot;
      openOption.not.data = this._columns[columnName].notData;
      openOption.empty.check = this._columns[columnName].isCheckEmpty;
      if (!(dews.ui.dialogPage && self._grid.$element.closest(dews.ui.dialogPage.$content).length > 0)) {
        openOption.isVisibleSaveButton = true;
      }
      this._layerFilter.open(openOption);
    };
    FilterManager.prototype.closeFilterLayer = function () {
      if (this._layerFilter)
      this._layerFilter.close(true);
    };
    FilterManager.prototype.apply = function (columnName) {
      var self = this;
      if (columnName === void 0 || columnName === null) {
        columnName = self._columnName;
      }
      var columnInfo = self._getColumnInfo();
      var type = columnInfo.type;
      var filterData = self._columns[columnName].data;
      var filterEtcData = self._columns[columnName].etcData;
      var filterIsCheckNot = self._columns[columnName].isCheckNot;
      var filterNotData = self._columns[columnName].notData;
      var filterIsCheckEmpty = self._columns[columnName].isCheckEmpty;
      self._grid.options.filterClearing = true;
      self._getRealGrid().clearColumnFilters(columnName);
      if (filterIsCheckNot === false) {
        filterNotData = void 0;
      }
      if (filterEtcData) {
        var filterName = filterEtcData.filterName;
        var condition1 = filterEtcData.condition1;
        var condition2 = filterEtcData.condition2;
        var value1 = filterEtcData.value1;
        var value2 = filterEtcData.value2;
        var logicOp = filterEtcData.logicOp;
        var expr;
        var expr1 = self._condition[condition1].expression(type, value1);
        var expr2 = self._condition[condition2].expression(type, value2);
        if (self._gridType === "GRID") {
          expr = function expr(dataProvider, dataRow, field, filter, data) {
            if (filterEtcData.logicOp === "and") {
              return expr1(dataProvider, dataRow, field, filter, data) && expr2(dataProvider, dataRow, field, filter, data);
            } else if (filterEtcData.logicOp === "or") {
              return expr1(dataProvider, dataRow, field, filter, data) || expr2(dataProvider, dataRow, field, filter, data);
            }
          };
        } else {
          if (filterEtcData.logicOp === "and") {
            expr = "(" + expr1 + ") and (" + expr2 + ")";
          } else if (filterEtcData.logicOp === "or") {
            expr = "(" + expr1 + ") or (" + expr2 + ")";
          }
        }
        self._getRealGrid().addColumnFilters(columnName, {
          name: filterName,
          text: filterName,
          criteria: expr,
          active: false,
          visible: false
        });
      } else if (filterData) {
        var checkedList = filterData.find(function (data) {
          return data.checked === true;
        });
        if (checkedList) {
          $.each(filterData, function (idx, data) {
            var isChecked = data["checked"];
            if (!isChecked)
            return true;
            var condition = data["condition"];
            var value12 = data["value1"];
            var value22 = data["value2"];
            var filterName2 = data["filterName"];
            var expr3 = self._condition[condition].expression(
            type,
            value12,
            value22,
            filterNotData,
            filterIsCheckEmpty);

            self._getRealGrid().addColumnFilters(columnName, {
              name: filterName2,
              text: filterName2,
              criteria: expr3,
              active: false,
              visible: false
            });
          });
        } else if (filterNotData && filterNotData.length > 0 || filterIsCheckEmpty) {
          var filterName = "innerFilterExcludeOnly";
          var expr = self._condition["ne"].expression(
          type,
          void 0,
          void 0,
          filterNotData,
          filterIsCheckEmpty);

          self._getRealGrid().addColumnFilters(columnName, {
            name: filterName,
            text: filterName,
            criteria: expr,
            active: false,
            visible: false
          });
        }
      }
      self._getRealGrid().activateAllColumnFilters(columnName, true);
      delete self._grid.options.filterClearing;
      self.onEventFiltered();
    };
    FilterManager.prototype.clearAllCheck = function () {
      for (var columnName in this._columns) {
        this._getRealGrid().clearColumnFilters(columnName);
        var columnData = this._columns[columnName];
        $.each(columnData.data, function (idx, data) {
          data.checked = false;
        });
        columnData.etcData = void 0;
        columnData.isCheckNot = false;
        columnData.isCheckEmpty = false;
      }
    };
    FilterManager.prototype.clearAllCheckData = function () {
      this.clearAllCheck();
    };
    FilterManager.prototype.clearDataFilters = function (columnName) {
      var self = this;
      var columnData = this._columns[columnName];
      if (columnData !== void 0 && columnData !== null) {
        columnData.data = void 0;
      }
    };
    FilterManager.prototype.clearAllColumnFilters = function () {
      var self = this;
      for (var columnName in this._columns) {
        this._getRealGrid().clearColumnFilters(columnName);
        self._columns[columnName].data = void 0;
        self._columns[columnName].etcData = void 0;
        self._columns[columnName].isCheckNot = false;
        self._columns[columnName].notData = void 0;
        self._columns[columnName].isCheckEmpty = false;
      }
    };
    FilterManager.prototype.addFilterValueList = function (columnName, value1Datas) {
      var self = this;
      self._layerFilter = new dews.fn.layer.filter();
      self._setColumnName(columnName);
      var columnInfo = self._getColumnInfo();
      var type = columnInfo.type;
      $.each(value1Datas, function (idx, value) {
        var isChecked = true;
        var condition = "e";
        var value1 = value;
        var value2 = void 0;
        var filterName = self._layerFilter._getFilterName();
        var expr = self._condition[condition].expression(type, value1, value2, null, null);
        var columnData = self._columns[columnName];
        if (!columnData) {
          columnData = {};
        }
        if (!columnData.data) {
          columnData.data = [];
        }
        var findIndex = columnData.data.findIndex(function (x) {
          var compareValue1 = x.value1;
          var compareValue = value;
          var isNullFunc = function isNullFunc(value3, nullValue) {
            if (value3 === void 0 || value3 === null) {
              return nullValue;
            } else {
              return value3;
            }
          };
          compareValue1 = isNullFunc(compareValue1, "");
          compareValue = isNullFunc(compareValue, "");
          return compareValue1.toString() === compareValue.toString() && x.condition === condition;
        });
        if (findIndex > -1) {
          var findData = columnData.data[findIndex];
          findData.checked = isChecked;
          filterName = findData.filterName;
        } else {
          columnData.data.push({
            checked: isChecked,
            condition: condition,
            value1: value1,
            value2: value2,
            filterName: filterName
          });
        }
        self._columns[columnName] = columnData;
        self._getRealGrid().addColumnFilters(columnName, {
          name: filterName,
          text: filterName,
          criteria: expr,
          active: false,
          visible: false
        });
      });
      self._getRealGrid().activateAllColumnFilters(columnName, true);
      self.onEventFiltered();
    };
    FilterManager.prototype.onEventFiltered = function () {
      var self = this;
      var grid = self._grid;
      var eventFilteredParameter = {
        filterColumns: self._columns
      };
      if (self._gridType === "TREEGRID") {
        eventFilteredParameter.treegrid = grid;
      } else {
        eventFilteredParameter.grid = grid;
      }
      var eventFiltered = new $.Event("filtered", eventFilteredParameter);
      grid.$element.trigger(eventFiltered);
    };
    FilterManager.prototype.validateFilterRowData = function (rowData) {
      var self = this;
      if (self._getRealGrid().isFiltered() === false) {
        return;
      }
      var isSnackbarMessage = false;
      if (rowData === void 0 || rowData === null || rowData.constructor === Object && Object.keys(rowData).length === 0) {
        $.each(self._columns, function (filterColumnName, filterInfo) {
          var isApply = false;
          if (filterInfo.data) {
            var findEv = filterInfo.data.find(function (x) {
              return x.condition === "ev" && x.checked === true;
            });
            if (findEv === void 0) {
              $.each(filterInfo.data, function (idx, filterDataValue) {
                if (filterDataValue.checked === void 0 || filterDataValue.checked === false) {
                  return true;
                }
                filterDataValue.checked = false;
                isApply = true;
              });
            }
          }
          if (filterInfo.isCheckEmpty) {
            self._columns[filterColumnName].isCheckEmpty = false;
            isApply = true;
          }
          if (filterInfo.etcData) {
            filterInfo.etcData = void 0;
            isApply = true;
          }
          if (isApply) {
            self.apply(filterColumnName);
            isSnackbarMessage = true;
          }
        });
      } else {
        $.each(rowData, function (columnName, addCellValue) {
          var isApply = false;
          var filterInfo = self._columns[columnName];
          if (filterInfo == void 0) {
            return true;
          }
          var compareTrueCount = 0;
          var compareFalseCount = 0;
          $.each(filterInfo.data, function (idx, filterDataValue) {
            var condition = filterDataValue.condition;
            var checked = filterDataValue.checked;
            var filterValue1 = filterDataValue.value1;
            var filterValue2 = filterDataValue.value2;
            var columnInfo = self._getColumnInfo(columnName);
            var type = columnInfo.type;
            var compare = self._condition[condition].addRowCompare(
            columnName,
            addCellValue,
            filterValue1,
            filterValue2);

            if (checked === void 0 || checked === false) {
              return true;
            }
            if (compare) {
              compareTrueCount++;
            } else {
              compareFalseCount++;
            }
          });
          if (compareTrueCount + compareFalseCount > 0 && compareTrueCount === 0) {
            $.each(filterInfo.data, function (idx, filterDataValue) {
              var checked = filterDataValue.checked;
              filterDataValue.checked = false;
              isApply = true;
            });
          }
          if (filterInfo.notData) {
            $.each(filterInfo.notData, function (idx, notData) {
              var compare = self._condition["ne"].addRowCompare(columnName, addCellValue, notData, null);
              if (!compare) {
                filterInfo.isCheckNot = false;
                isApply = true;
                return false;
              }
            });
          }
          if (filterInfo.etcData) {
            filterInfo.etcData = void 0;
            isApply = true;
          }
          if (isApply) {
            self.apply(columnName);
            isSnackbarMessage = true;
          }
        });
      }
      if (isSnackbarMessage) {
        dews.ui.snackbar.info("\uD589\uC774 \uCD94\uAC00\uB418\uC5B4 \uC77C\uBD80 \uD544\uD130\uAC00 \uD574\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4.", {
          exposureTime: 3e3
        });
      }
    };
    dews.ui.grid.FilterManager = FilterManager;
  })(window.dews || {});
})();


(function () {
  // src/js/grid/column/HeaderSummary.js
  var instance;
  var HeaderSummary = /*#__PURE__*/function () {"use strict";
    function HeaderSummary(columnAdaptor) {_classCallCheck(this, HeaderSummary);
      if (instance) {
        return instance;
      }
      this.columnAdaptor = columnAdaptor;
      instance = this;
    }_createClass(HeaderSummary, [{ key: "initialize", value:
      function initialize(column, stylesTextAlignment) {
        var self = this.columnAdaptor;
        var cnt = self._userOptions.multiHeaderSummaryCnt;
        var gridSummary = self._innerOptions.header.summary;
        var headerSummary = column.headerSummary;
        self._innerOptions.header.summary = _objectSpread(_objectSpread({},
        gridSummary),
        _getSummaryOptions());

        return cnt > 1 ? this._getMultiHeaderSummary(headerSummary, stylesTextAlignment) : this._getHeaderSummary(headerSummary, stylesTextAlignment);
        function _getSummaryOptions() {
          var HEIGHT = 32;
          var multiHeight = HEIGHT * cnt;
          return _objectSpread(_objectSpread({
            visible: true },
          cnt > 1 && { count: cnt }),
          cnt > 1 && { minHeight: multiHeight });

        }
      } }, { key: "_getMultiHeaderSummary", value:
      function _getMultiHeaderSummary(headerSummary, stylesTextAlignment) {var _this6 = this;
        var arr = Array.isArray(headerSummary) ? headerSummary : [headerSummary];
        var text = [];
        var styles = [];
        var expression = [];
        var preCurrency = [];
        var preFormat = [];
        arr.forEach(function (multiSummary) {
          var headerSummary2 = _this6._getHeaderSummary(multiSummary, stylesTextAlignment);
          text.push(headerSummary2.text);
          styles.push(headerSummary2.styles);
          expression.push(headerSummary2.expression);
          preCurrency.push(headerSummary2.preCurrency);
          preFormat.push(headerSummary2.preFormat);
        });
        return {
          text: text,
          styles: styles,
          expression: expression,
          preCurrency: preCurrency,
          preFormat: preFormat
        };
      } }, { key: "_getHeaderSummary", value:
      function _getHeaderSummary(userHeaderSummary, stylesTextAlignment) {var _userHeaderSummary$fo2;
        var self = this.columnAdaptor;
        var headerSummary = _objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({},
        userHeaderSummary.text && { text: userHeaderSummary.text }),
        userHeaderSummary.type && {
          expression: userHeaderSummary.type
        }),
        userHeaderSummary.predefined && {
          predefined: userHeaderSummary.predefined
        }),
        userHeaderSummary.format && {
          format: userHeaderSummary.format
        }),
        userHeaderSummary.callback && {
          callback: userHeaderSummary.callback
        }), {}, {
          styles: _objectSpread(_objectSpread({
            textAlignment: userHeaderSummary.styles === void 0 ? stylesTextAlignment : "center",
            numberFormat: (_userHeaderSummary$fo2 = userHeaderSummary.format) !== null && _userHeaderSummary$fo2 !== void 0 ? _userHeaderSummary$fo2 : "#,##0.##" },
          userHeaderSummary.suffix && {
            suffix: userHeaderSummary.suffix
          }),
          userHeaderSummary.prefix && {
            prefix: userHeaderSummary.prefix
          }) });


        if (typeof userHeaderSummary.align !== "undefined") {
          switch (userHeaderSummary.align.toLowerCase()) {
            case "left":
              headerSummary.styles.textAlignment = "near";
              break;
            case "right":
              headerSummary.styles.textAlignment = "far";
              break;
            default:
              headerSummary.styles.textAlignment = "center";
              break;}

        }
        if (userHeaderSummary.type) {
          if (typeof self._innerOptions.fieldIndex !== "undefined" && userHeaderSummary.type.toLowerCase() !== "count") {
            self._innerOptions.dataSource.options.field[self._innerOptions.fieldIndex].dataType = "number";
            self._innerOptions.dataSource.options.schema.model.fields[self._innerOptions.fieldIndex].dataType = "number";
          }
          if (userHeaderSummary.predefined === true) {
            if (typeof userHeaderSummary.preFormat === "undefined" || userHeaderSummary.preFormat !== userHeaderSummary.format) {
              headerSummary.preFormat = userHeaderSummary.format;
            }
            var preDefinedFormat = dews.getPreDefinedFormat(headerSummary);
            if ($.type(userHeaderSummary.currency) !== "undefined") {
              if ($.type(userHeaderSummary.currency) === "string") {
                headerSummary.preCurrency = userHeaderSummary.currency;
                headerSummary.currency = userHeaderSummary.currency;
                preDefinedFormat = dews.getCurrencyFormat(headerSummary);
                if (preDefinedFormat) {
                  var round = typeof preDefinedFormat.round === "string" ? preDefinedFormat.round : "round";
                  if (round !== "round") {
                    if (preDefinedFormat.format.split(".").length === 2) {
                      if (round === "ceil") {
                        preDefinedFormat.format += ";;;c";
                      } else {
                        preDefinedFormat.format += ";;;f";
                      }
                    }
                  }
                }
              } else if (typeof userHeaderSummary.currency === "function") {
                headerSummary.preCurrency = userHeaderSummary.currency;
                headerSummary.currency = userHeaderSummary.currency;
                userHeaderSummary.preCurrency = "";
              }
            }
            if (_typeof(preDefinedFormat) === "object") {
              preDefinedFormat = preDefinedFormat.format;
            }
            if (preDefinedFormat) {
              headerSummary.styles.numberFormat = preDefinedFormat;
            } else {
              headerSummary.styles.numberFormat = "#,##0.##";
            }
          }
        }
        return headerSummary;
      } }]);return HeaderSummary;}();


  // src/js/grid/column/CellMerge.js
  var setInnerColumnCellMerge = function setInnerColumnCellMerge(column, innerColumn, innerOptions) {
    if (innerOptions._gridType !== "GRID") {
      return;
    }
    if (!column.merge) {
      return;
    }
    if (typeof column.merge.verticalTop === "boolean" && column.merge.verticalTop) {
      innerColumn.equalBlank = true;
      return;
    }
    if (typeof column.merge === "boolean") {
      innerColumn.mergeRule = {
        criteria: column.merge ? "value" : ""
      };
    }
    if (typeof column.merge === "string") {
      innerColumn.mergeRule = {
        criteria: "values['" + column.merge + "'] + value"
      };
    }
    if (_typeof(column.merge) === "object") {
      var referenceField = column.merge.referenceField;
      var criteria = "value";
      if (referenceField) {
        var arrReferenceField = Array.isArray(referenceField) ? referenceField : [referenceField];
        criteria = "";
        arrReferenceField.forEach(function (field) {
          criteria += "values[\"".concat(field, "\"] + ");
        });
        criteria += "value";
      }
      innerOptions.display.showInnerFocus = typeof column.merge.innerFocus === "undefined" ? true : column.merge.innerFocus;
      innerColumn.mergeRule = {
        criteria: criteria
      };
    }
  };

  // src/js/grid/column/MultiHeader.js
  var setInnerColumnMultiHeader = function setInnerColumnMultiHeader(self, column, innerColumn, innerOptions) {
    if (column.columns) {
      innerColumn.type = "group";
      innerColumn.hideChildHeaders = column.hideChildHeaders;
      if (!column.hideChildHeaders) {
        innerOptions.depth += 1;
      }
      if (typeof innerColumn.name === "undefined") {
        innerColumn.name = column._multiHeaderColumnName;
      }
      if (typeof column.visible === "boolean") {
        if (innerOptions._gridType === "GRID" && innerOptions._hideChildrenColumns && innerOptions._hideChildrenColumns[innerColumn.name]) {
          innerColumn.visible = false;
        } else {
          innerColumn.header.visible = column.visible;
          delete column.visible;
        }
      } else if (column.visible === "hideChildren") {
        innerColumn.visible = false;
      }
      innerColumn.columns = self.convertColumns(column.columns);
    } else {
      if (innerOptions.depth > innerOptions.maxDepth) {
        innerOptions.maxDepth = innerOptions.depth;
      }
      innerOptions.depth = 1;
    }
  };

  // src/js/grid/column/MultiColumnHeight.js
  var setInnerColumnMultiColumnHeight = function setInnerColumnMultiColumnHeight(column, innerColumn, innerOptions) {
    if (typeof column.multiColumnHeight !== "undefined") {
      if (typeof column.multiColumnHeight === "number") {
        innerColumn.multiColumnHeight = {
          header: column.multiColumnHeight,
          row: column.multiColumnHeight
        };
      } else {
        innerColumn.multiColumnHeight = column.multiColumnHeight;
      }
    } else {
      innerColumn.multiColumnHeight = {};
    }
    if (typeof innerColumn.multiColumnHeight.header === "number") {
      innerColumn.header.fillHeight = innerColumn.multiColumnHeight.header;
      innerColumn.header.minHeight = innerColumn.multiColumnHeight.header;
      innerColumn.header.fixedHeight = innerColumn.multiColumnHeight.header;
    } else if (typeof innerColumn.multiColumnHeight.header === "undefined") {
      innerColumn.header.fillHeight = innerOptions.header.minHeight;
      innerColumn.header.minHeight = innerOptions.header.minHeight;
      innerColumn.header.fixedHeight = innerOptions.header.minHeight;
    }
    if (typeof innerColumn.multiColumnHeight.row === "number") {
      innerColumn.height = innerColumn.multiColumnHeight.row;
      innerColumn.fillHeight = innerColumn.multiColumnHeight.row;
      innerColumn.minHeight = innerColumn.multiColumnHeight.row;
      innerColumn.fixedHeight = innerColumn.multiColumnHeight.row;
    } else if (typeof innerColumn.multiColumnHeight.row === "undefined") {
      innerColumn.fillHeight = innerOptions.display.rowHeight;
      innerColumn.minHeight = innerOptions.display.rowHeight;
      innerColumn.fixedHeight = innerOptions.display.rowHeight;
    }
  };

  // src/js/grid/column/Grouping.js
  var setInnerColumnGrouping = function setInnerColumnGrouping(column, innerColumn, innerOptions) {
    if (typeof column.grouping === "boolean" && column.grouping) {
      innerColumn.type = "group";
      innerColumn.orientation = "vertical";
      innerOptions.grouping = true;
      innerOptions.groupCol = column.columns.length;
      if (innerOptions.groupCol > innerOptions.maxGroupCol) {
        innerOptions.maxGroupCol = innerOptions.groupCol;
      }
    }
  };

  // src/js/grid/column/Attributes.js
  var setInnerColumnAttributes = function setInnerColumnAttributes(column, innerColumn, innerOptions) {
    if (column.attributes) {
      if (column.attributes["class"] === "required" || column.attributes["class"] === "none") {
        innerColumn.styles.background = column.attributes["class"] === "required" ? innerOptions.gridStyle.body.requiredBackground : innerOptions.gridStyle.body.background;
        innerColumn.readOnly = false;
        if (column.editor && column.editor.type && column.editor.type.toUpperCase() === "COMBO") {
          innerColumn.editor.textReadOnly = false;
        }
      } else if (column.attributes["class"] === "readonly") {
        innerColumn.styles.background = innerOptions.gridStyle.body.readonlyBackground;
        innerColumn.readOnly = true;
        innerColumn.editable = false;
      }
    }
  };

  // src/js/grid/column/BaseColumn.js
  var setInnerColumnBase = function setInnerColumnBase(self, column, innerColumn, innerOptions, userOptions) {
    var dataSourceOpt = innerOptions.dataSource.options;
    if (typeof column.width === "number") {
      innerColumn.width = column.width;
    }
    if (typeof column.sortable === "boolean") {
      innerColumn.sortable = column.sortable;
    }
    if (typeof column.groupable === "boolean") {
      innerColumn.groupable = column.groupable;
    }
    if (typeof column.resizable === "boolean") {
      innerColumn.resizable = column.resizable;
    }
    if (typeof column.movable === "boolean") {
      innerColumn.movable = column.movable;
    }
    if (typeof column.style === "function") {
      innerColumn.style = column.style;
    }
    if (typeof column.visible === "boolean" || typeof column.visible === "string") {
      innerColumn.visible = column.visible;
    }
    self._filterManager.columnOptionConvert(column);
    if (typeof column.renderer !== "undefined") {
      if (typeof innerColumn.renderer === "undefined") {
        innerColumn.renderer = {
          showTooltip: column.renderer.showTooltip
        };
      } else {
        innerColumn.renderer.showTooltip = column.renderer.showTooltip;
      }
    }
    if (Array.isArray(column.dynamicStyles)) {
      innerColumn.dynamicStyles = column.dynamicStyles;
    }
    innerColumn.fieldName = column.field;
    if (typeof column.editable === "undefined") {
      innerColumn.editable = true;
    } else if (typeof column.editable === "boolean") {
      innerColumn.editable = column.editable;
    } else if (typeof column.editable === "function") {
      innerColumn.editable = column.editable;
    }
    if (typeof column.field !== "undefined") {
      innerColumn.name = column.field;
      innerColumn.field = column.field;
    }
    for (var i = 0; i < dataSourceOpt.field.length; i++) {
      if (innerColumn.fieldName === dataSourceOpt.field[i].fieldName) {
        innerOptions.fieldIndex = i;
        break;
      }
      if (i === dataSourceOpt.field.length - 1) {
        innerOptions.fieldIndex = void 0;
      }
    }
    if (typeof innerColumn.styles === "undefined") {
      innerColumn.styles = {};
    }
    if (typeof innerOptions.fieldIndex !== "undefined" && typeof dataSourceOpt.field[innerOptions.fieldIndex].styles === "undefined") {
      dataSourceOpt.field[innerOptions.fieldIndex].styles = {};
    }
    if (typeof column.width === "undefined") {
      if (innerOptions.display.fitStyle === "fill") {
        innerColumn.fillWidth = 1;
      }
    }
    if (typeof column.width !== "undefined" && innerOptions.gridStyle.fontSize !== 12) {
      var fontSize = innerOptions.gridStyle.fontSize;
      switch (fontSize) {
        case 15:
          innerColumn.width = Math.floor(1.25 * column.width);
          break;
        case 18:
          innerColumn.width = Math.floor(1.5 * column.width);
          break;
        case 24:
          innerColumn.width = Math.floor(2 * column.width);
          break;
        case 30:
          innerColumn.width = Math.floor(2.5 * column.width);
          break;}

    }
    if (column.title) {
      innerColumn.header = $.extend(true, innerColumn.header, {
        text: column.title,
        fixedHeight: innerOptions.display.rowIndex
      });
    } else {
      innerColumn.header = {
        text: " "
      };
    }
    if (column.headerCheck) {
      if (typeof column.headerCheck.location === "undefined") {
        innerColumn.header.checkLocation = "right";
      } else {
        innerColumn.header.checkLocation = column.headerCheck.location;
      }
    }
    if (typeof userOptions.styles !== "undefined" && typeof userOptions.styles.textAlign !== "undefined") {
      innerColumn.align = userOptions.styles.textAlign;
    } else if (typeof column.align === "undefined") {
      innerColumn.align = "center";
    }
    if (column.align) {
      var align;
      if (column.align === "right") {
        align = "far";
      } else if (column.align === "left") {
        align = "near";
      } else {
        align = "center";
      }
      innerColumn.styles.textAlignment = align;
    } else {
      innerColumn.styles.textAlignment = "center";
    }
    if (column.suffix) {
      innerColumn.styles.suffix = column.suffix;
    }
    if (column.prefix) {
      innerColumn.styles.prefix = column.prefix;
    }
  };

  // src/js/grid/column/formats/DateFormats.js
  function convertDateFormats(column, innerOptions) {
    var innerColumn = {};
    innerColumn.styles = {};
    innerColumn.formats = {
      type: column.formats.type,
      predefined: column.formats.predefined,
      format: column.formats.format
    };
    if (column.formats.predefined === true) {
      if (typeof innerColumn.formats.preFormat === "undefined") {
        innerColumn.formats.preFormat = column.formats.format;
      }
      var preDefinedFormat = dews.getPreDefinedFormat(innerColumn.formats);
      if (preDefinedFormat) {
        innerColumn.formats.format = preDefinedFormat;
      } else {
        innerColumn.formats.format = dews._environments.formats.dateFormat;
      }
    }
    if (typeof innerOptions.fieldIndex !== "undefined") {
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].dataType = "datetime";
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].dataType = "datetime";
    }
    innerColumn.styles.datetimeFormat = typeof innerColumn.formats.format === "undefined" ? dews._environments.formats.dateFormat : innerColumn.formats.format;
    return innerColumn;
  }

  // src/js/grid/column/formats/LinkFormats.js
  function convertLinkFormats(column) {
    var innerColumn = {};
    innerColumn.formats = {
      type: column.formats.type,
      urlField: column.formats.urlField,
      useMenu: column.formats.useMenu,
      module: column.formats.module,
      menu: column.formats.menu,
      data: column.formats.data
    };
    innerColumn.renderer = $.extend(true, innerColumn.renderer, {
      type: "link",
      url: dews.url.getAbsoluteUrl("${" + column.field + "}"),
      showUrl: false,
      useMenu: typeof column.formats.useMenu === "boolean" ? column.formats.useMenu : false,
      cursor: "pointer"
    });
    return innerColumn;
  }

  // src/js/grid/column/formats/Mask.js
  function convertMaskFormats(column) {
    var innerColumn = {};
    innerColumn.formats = {
      type: column.formats.type,
      format: column.formats.format,
      predefined: column.formats.predefined,
      secureFormat: column.formats.secureFormat
    };
    var mask = column.formats.format,replace = "",exp = "(",regchar = "",regcount = 1,expcount = 0;
    var predefined = column.formats.predefined;
    var secureFormat = column.formats.secureFormat;
    if (predefined) {
      exp = "(.*)$";
      replace = function replace(match) {
        var groups = Array.prototype.splice.call(arguments, 1);
        var orgValue = groups[groups.length - 1];
        var chgValue = orgValue;
        var secureMask = dews.getSecureMaskFormat(secureFormat);
        if (mask && mask !== "") {
          chgValue = dews.string.secureMask(chgValue, mask, false);
        }
        if (secureMask) {
          chgValue = dews.string.secureMask(chgValue, secureFormat, true);
        }
        return chgValue;
      };
    } else if (!predefined && secureFormat && secureFormat !== "") {
      exp = "(.*)$";
      replace = function replace(match) {
        var groups = Array.prototype.splice.call(arguments, 1);
        var orgValue = groups[groups.length - 1];
        var chgValue = orgValue;
        if (mask && mask !== "") {
          chgValue = dews.string.secureMask(chgValue, mask, false);
        }
        if (secureFormat.match(/[,]/g) && secureFormat.match(/[,]/g).length > 1) {
          chgValue = dews.string.secureMask(chgValue, secureFormat, false);
        }
        return chgValue;
      };
    } else if (mask && mask !== "") {
      for (var m = 0; m < mask.length; m += 1) {
        if (mask[m] !== regchar && regchar === "*") {
          exp += "{" + expcount + "})(";
          expcount = 0;
          regcount++;
        }
        switch (mask[m]) {
          case "0":
          case "9":
            if (expcount === 0) {
              exp += "\\d";
            } else if (regchar !== mask[m]) {
              exp += "{" + expcount + "}\\d";
              expcount = 0;
            }
            regchar = mask[m];
            expcount++;
            break;
          case "#":
            if (expcount === 0) {
              exp += "\\d";
            } else if (regchar !== mask[m]) {
              exp += "{" + expcount + "}\\d";
              expcount = 0;
            }
            regchar = mask[m];
            expcount++;
            break;
          case "L":
            if (expcount === 0) {
              exp += "[a-zA-Z]";
            } else if (regchar !== mask[m]) {
              exp += "{" + expcount + "}[a-zA-Z]";
              expcount = 0;
            }
            regchar = mask[m];
            expcount++;
            break;
          case "?":
            if (expcount === 0) {
              exp += "[a-zA-Z]";
            } else if (regchar !== mask[m]) {
              exp += "{" + expcount + "}[a-zA-Z]";
              expcount = 0;
            }
            regchar = mask[m];
            expcount++;
            break;
          case "&":
            if (expcount === 0) {
              exp += "\\S";
            } else if (regchar !== mask[m]) {
              exp += "{" + expcount + "}\\S";
              expcount = 0;
            }
            regchar = mask[m];
            expcount++;
            break;
          case "C":
            if (expcount === 0) {
              exp += ".";
            } else if (regchar !== mask[m]) {
              exp += "{" + expcount + "}.";
              expcount = 0;
            }
            regchar = mask[m];
            expcount++;
            break;
          case "A":
          case "a":
            if (expcount === 0) {
              exp += "[a-zA-Z0-9]";
            } else if (regchar !== mask[m]) {
              exp += "{" + expcount + "}[a-zA-Z0-9]";
              expcount = 0;
            }
            regchar = mask[m];
            expcount++;
            break;
          case "*":
            if (expcount === 0) {
              exp += "[a-zA-Z0-9]";
            } else if (regchar !== mask[m]) {
              exp += "{" + expcount + "})([a-zA-Z0-9]";
              replace += "$" + regcount;
              expcount = 0;
              regcount++;
            }
            replace += "*";
            regchar = mask[m];
            expcount++;
            break;
          default:
            if (mask[m] !== "*") {
              replace += "$" + regcount + mask[m];
            }
            exp += "{" + expcount + "})(";
            expcount = 0;
            regcount++;
            break;}

        if (m === mask.length - 1) {
          exp += "{" + expcount + "})";
          if (regchar !== "*") {
            replace += "$" + regcount;
          }
        }
      }
    } else {
      exp = "(.*)$";
      replace = function replace(match) {
        var groups = Array.prototype.splice.call(arguments, 1);
        var orgValue = groups[groups.length - 1];
        return orgValue;
      };
    }
    innerColumn.displayRegExp = exp;
    innerColumn.displayReplace = replace;
    return innerColumn;
  }

  // src/js/grid/column/formats/Number.js
  function convertNumberFormats(column, innerOptions) {
    var innerColumn = {};
    innerColumn.styles = {};
    innerColumn.formats = {
      type: column.formats.type,
      predefined: column.formats.predefined,
      format: column.formats.format,
      round: column.formats.round
    };
    innerColumn.formats.format = column.formats.format;
    if (column.formats.predefined === true) {
      if (typeof innerColumn.formats.preFormat === "undefined") {
        innerColumn.formats.preFormat = column.formats.format;
      }
      var preDefinedFormat = dews.getPreDefinedFormat(innerColumn.formats);
      if (_typeof(preDefinedFormat) === "object") {
        innerColumn.formats.round = preDefinedFormat.round;
        preDefinedFormat = preDefinedFormat.format;
      }
      if (typeof column.formats.currency === "string") {
        innerColumn.formats.preCurrency = column.formats.currency;
        innerColumn.formats.currency = column.formats.currency;
        preDefinedFormat = dews.getCurrencyFormat(innerColumn.formats);
        if (_typeof(preDefinedFormat) === "object") {
          innerColumn.formats.round = preDefinedFormat.round;
          preDefinedFormat = preDefinedFormat.format;
        }
      } else if (typeof column.formats.currency === "function") {
        delete innerColumn.formats.round;
        innerColumn.formats.preCurrency = "";
        innerColumn.displayCallback = function (realgrid, index, value) {
          var dewsGrid = $(realgrid._gv._container._containerDiv).closest(".dews-data-control").data("dews-control");
          var dewsParams;
          if (innerOptions._gridType === "GRID") {
            dewsParams = {
              grid: dewsGrid,
              row: {
                index: index.itemIndex,
                data: dewsGrid.dataItem(index.itemIndex)
              },
              cell: {
                field: index.column,
                data: dewsGrid.getCellValue(index.itemIndex, index.column)
              }
            };
          } else {
            dewsParams = {
              treegrid: dewsGrid,
              row: {
                index: index.itemIndex,
                data: dewsGrid.dataItem(index.dataRow)
              },
              cell: {
                field: index.column,
                data: dewsGrid.getCellValue(index.dataRow, index.column)
              }
            };
          }
          var dewsCol = dewsGrid.columns[index.column];
          dewsCol.formats.preCurrency = dewsCol.formats.currency.call(dewsCol, dewsParams);
          dewsGrid._innerOptions.columns.some(function (value2, idx) {
            if (value2.fieldName === index.column) {
              dewsGrid._innerOptions.columns[idx].formats.preCurrency = dewsCol.formats.preCurrency;
            }
          });
          var env = dews.ui.page && dews.ui.page.env && dews.ui.page.env[dewsCol.formats.preFormat];
          var predefinedFormat = dews.getCurrencyFormat(dewsCol.formats),formats = "#,###.##",round = "round";
          if (env) {
            formats = env.format;
            round = dews.mathType[env.round];
          }
          if (_typeof(predefinedFormat) === "object") {
            formats = predefinedFormat.format;
            round = typeof predefinedFormat.round === "string" ? predefinedFormat.round : round;
          } else if (typeof predefinedFormat === "string") {
            formats = predefinedFormat;
          }
          if (round !== "round") {
            if (formats.split(".").length === 2) {
              var sosu = Math.pow(10, formats.split(".")[1].length);
              if (round === "ceil") {
                value = Math.ceil(value * sosu) / sosu;
              } else {
                value = Math.floor(value * sosu) / sosu;
              }
            }
          }
          var oldFormats = dewsGrid._grid.getColumnProperty(dewsCol.name, "excelFormat");
          if (!oldFormats) {
            dewsGrid._grid.setColumnProperty(dewsCol.name, "excelFormat", formats);
          }
          return dews.number.format(value, formats);
        };
      }
      if (preDefinedFormat) {
        innerColumn.formats.format = preDefinedFormat;
      } else {
        innerColumn.formats.format = "#,##0.##";
      }
    }
    if (typeof column.formats.abs === "boolean" && column.formats.abs) {
      innerColumn.dynamicStyles = [
      {
        criteria: "value<0",
        styles: {
          foreground: typeof column.formats.negative === "undefined" ? "#e62324" : column.formats.negative,
          numberFormat: innerColumn.formats.format + ";a"
        }
      }];

      if (typeof column.formats.positive !== "undefined") {
        innerColumn.dynamicStyles.push({
          criteria: "value>=0",
          styles: {
            foreground: column.formats.positive,
            numberFormat: innerColumn.formats.format + ";a"
          }
        });
      }
    }
    if (column.formats.negativeColor) {var _dews$ui$page12;
      var useNegativeColor = false;
      var MA00041 = (_dews$ui$page12 = dews.ui.page) === null || _dews$ui$page12 === void 0 ? void 0 : _dews$ui$page12.env["MA00041"];
      if (MA00041) {
        useNegativeColor = MA00041.value === "2";
      }
      if (useNegativeColor) {
        innerColumn.dynamicStyles = [
        {
          criteria: "value<0",
          styles: {
            foreground: "#e62324"
          }
        }];

      }
    }
    if (typeof innerOptions.fieldIndex !== "undefined") {
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].dataType = "number";
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].min = column.formats.min;
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].max = column.formats.max;
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].styles.numberFormat = typeof innerColumn.formats.format === "undefined" ? "#,##0.##" : innerColumn.formats.format;
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].dataType = "number";
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].numberFormat = typeof innerColumn.formats.format === "undefined" ? "#,##0.##" : innerColumn.formats.format;
    }
    if (typeof innerColumn.formats.round === "undefined" || innerColumn.formats.round === "round") {
      if (typeof column.formats.currency !== "function") {
        innerColumn.styles.numberFormat = innerColumn.formats.format;
      }
    } else if (innerColumn.formats.round === "ceil") {
      innerColumn.styles.numberFormat = innerColumn.formats.format + ";;;c";
    } else if (innerColumn.formats.round === "floor") {
      innerColumn.styles.numberFormat = innerColumn.formats.format + ";;;f";
    }
    return innerColumn;
  }

  // src/js/grid/column/formats/Check.js
  function convertCheckFormats(column, innerOptions) {
    var innerColumn = {};
    innerColumn.formats = {
      type: column.formats.type,
      trueValue: column.formats.trueValue,
      falseValue: column.formats.falseValue
    };
    innerColumn.styles = {};
    innerColumn.renderer = {
      type: "check",
      shape: "box",
      editable: false,
      startEditOnClick: true,
      trueValues: typeof column.formats.trueValue === "undefined" ? "true" : column.formats.trueValue,
      falseValues: typeof column.formats.falseValue === "undefined" ? "false" : column.formats.falseValue,
      trueImage: innerOptions.gridStyle.body.checkedImg,
      falseImage: innerOptions.gridStyle.body.unCheckImg,
      labelPosition: "none",
      showInnerFocus: false
    };
    innerColumn.editable = false;
    innerColumn.styles.figureBackground = "#ff4995ff";
    return innerColumn;
  }

  // src/js/grid/column/formats/DataSource.js
  function convertDataSourceFormats(column) {
    var innerColumn = {};
    innerColumn.formats = {
      type: "dataSource",
      dataSource: column.formats.dataSource,
      dataValueField: column.formats.dataValueField,
      dataTextField: column.formats.dataTextField
    };
    innerColumn.values = [];
    innerColumn.labels = [];
    innerColumn.lookupDisplay = true;
    return innerColumn;
  }

  // src/js/grid/column/formats/Image.js
  function convertImageFormats() {
    var innerColumn = {};
    innerColumn.formats = {
      type: "image"
    };
    innerColumn.styles = {};
    innerColumn.editable = false;
    innerColumn.renderer = {
      type: "image",
      smoothing: true
    };
    innerColumn.styles.contentFit = "auto";
    return innerColumn;
  }

  // src/js/grid/column/formats/Time.js
  function convertTimeFormats(column) {
    var innerColumn = {};
    innerColumn.formats = {
      type: column.formats.type,
      predefined: column.formats.predefined,
      format: column.formats.format
    };
    innerColumn.formats.format = column.formats.format;
    if (column.formats.predefined === true) {
      if (typeof innerColumn.formats.preFormat === "undefined") {
        innerColumn.formats.preFormat = column.formats.format;
      }
      var preDefinedFormat = dews.getPreDefinedFormat(innerColumn.formats);
      if (preDefinedFormat) {
        innerColumn.formats.format = preDefinedFormat;
      } else {
        innerColumn.formats.format = "HH:mm:ss";
      }
    }
    var time = innerColumn.formats.format,timeReg = "";
    if (/HH/gi.test(time)) {
      timeReg = time.replace(/HH/gi, "$1");
    }
    if (/mm/gi.test(time)) {
      timeReg = timeReg.replace(/mm/gi, "$2");
    }
    if (/ss/gi.test(time)) {
      timeReg = timeReg.replace(/ss/gi, "$3");
    }
    innerColumn.displayRegExp = /([0-1]\d|2[0-3])([0-5]\d)([0-5]\d)?/gi;
    innerColumn.displayReplace = timeReg;
    return innerColumn;
  }

  // src/js/grid/column/formats/Password.js
  function convertPasswordFormats(column) {
    var innerColumn = {};
    innerColumn.formats = {
      type: "password",
      format: column.formats.format
    };
    var format = column.formats.format;
    innerColumn.displayRegExp = /^.*$/gi;
    innerColumn.displayReplace = format;
    return innerColumn;
  }

  // src/js/grid/column/formats/Year.js
  function convertYearFormats(column, innerOptions) {
    var innerColumn = {};
    innerColumn.formats = {
      type: column.formats.type,
      predefined: column.formats.predefined,
      format: column.formats.format
    };
    innerColumn.styles = {};
    innerColumn.formats.format = column.formats.format;
    if (column.formats.predefined === true) {
      if (typeof innerColumn.formats.preFormat === "undefined") {
        innerColumn.formats.preFormat = column.formats.format;
      }
      var preDefinedFormat = dews.getPreDefinedFormat(innerColumn.formats);
      if (preDefinedFormat) {
        innerColumn.formats.format = preDefinedFormat;
      } else {
        innerColumn.formats.format = dews._environments.formats.dateFormat;
      }
    }
    if (typeof innerOptions.fieldIndex !== "undefined") {
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].datatimeFormat = dews._environments.formats.yearValueFormat;
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].dataType = "datetime";
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.yearValueFormat;
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].dataType = "datetime";
    }
    innerColumn.styles.datetimeFormat = typeof innerColumn.formats.format === "undefined" ? dews._environments.formats.yearValueFormat : innerColumn.formats.format;
    return innerColumn;
  }

  // src/js/grid/column/formats/Function.js
  function convertFunctionFormats(column, innerOptions) {
    var innerColumn = {};
    innerColumn.formats = {
      type: "function",
      format: column.formats.format
    };
    innerColumn.displayCallback = function (realgrid, index, value) {
      var dewsGrid = $(realgrid._gv._container._containerDiv).closest(".dews-data-control").data("dews-control");
      var dewsParams;
      if (innerOptions._gridType === "GRID") {
        dewsParams = {
          grid: dewsGrid,
          row: {
            index: index.itemIndex,
            data: dewsGrid.dataItem(index.itemIndex)
          },
          cell: {
            field: index.column,
            data: dewsGrid.getCellValue(index.itemIndex, index.column)
          }
        };
      } else {
        dewsParams = {
          grid: dewsGrid,
          row: {
            index: index.itemIndex,
            data: dewsGrid.dataItem(index.dataRow)
          },
          cell: {
            field: index.column,
            data: dewsGrid.getCellValue(index.dataRow, index.column)
          }
        };
      }
      return dewsGrid.columns[index.column].formats.format.call(dewsGrid, value, dewsParams);
    };
    return innerColumn;
  }

  // src/js/grid/column/formats/Month.js
  function convertMonthFormats(column, innerOptions) {
    var innerColumn = {};
    innerColumn.formats = {
      type: column.formats.type,
      predefined: column.formats.predefined,
      format: column.formats.format
    };
    innerColumn.styles = {};
    innerColumn.formats.format = column.formats.format;
    if (column.formats.predefined === true) {
      if (typeof innerColumn.formats.preFormat === "undefined") {
        innerColumn.formats.preFormat = column.formats.format;
      }
      var preDefinedFormat = dews.getPreDefinedFormat(innerColumn.formats);
      if (preDefinedFormat) {
        innerColumn.formats.format = preDefinedFormat;
      } else {
        innerColumn.formats.format = dews._environments.formats.dateFormat;
      }
    }
    if (typeof innerOptions.fieldIndex !== "undefined") {
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].datatimeFormat = dews._environments.formats.monthValueFormat;
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].dataType = "datetime";
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].dataType = "datetime";
    }
    innerColumn.styles.datetimeFormat = typeof innerColumn.formats.format === "undefined" ? dews._environments.formats.monthFormat : innerColumn.formats.format;
    return innerColumn;
  }

  // src/js/grid/column/ColumnRenderer.js
  function ColumnRenderer() {
  }
  ColumnRenderer.prototype.getBarRenderer = function (column) {
    if (!column)
    return null;
    var f = column.formats;
    if (!f)
    return null;
    var styleCreator = dews.ui.grid.StyleCreator.getInstance();
    var defaultMinimum = 0;
    var defaultMaximum = 100;
    var defaultShowLabel = true;
    var defaultStartingPoint = "left";
    var defaultColor = styleCreator.gridStyle.themeColorLight1;
    var defaultAngle = 0;
    var defaultTextAlignment = "center";
    var defaultLineAlignment = "middle";
    var defaultPadding = 6;
    var defaultSize = "100%";
    var ds = column.dynamicStyles;
    if (ds) {
      $.each(ds, function (idx, item) {
        var style = item.styles;
        var startColor2 = checkNullOrType(style.startColor, "string", defaultColor);
        var endColor2 = checkNullOrType(style.endColor, "string", defaultColor);
        var angle2 = checkNullOrType(style.angle, "number", defaultAngle);
        var size2 = checkNullOrType(style.size, "number", defaultSize);
        style.figureBackground = dews.string.format("linear, {0}, {1}, {2}", startColor2, endColor2, angle2);
        delete style.startColor;
        delete style.endColor;
        delete style.angle;
        style.figureSize = dews.string.format("{0}%", size2);
        delete style.size;
      });
    }
    var startColor = checkNullOrType(f.startColor, "string", defaultColor);
    var endColor = checkNullOrType(f.endColor, "string", defaultColor);
    var angle = checkNullOrType(f.angle, "number", defaultAngle);
    var size = checkNullOrType(f.size, "number", defaultSize);
    var textAlignment = checkNullOrType(f.textAlignment, "string", defaultTextAlignment);
    var lineAlignment = checkNullOrType(f.lineAlignment, "string", defaultLineAlignment);
    textAlignment = convertHorizontalAlignment(textAlignment);
    lineAlignment = convertVerticalAlignment(lineAlignment);
    var returnRenderer = {
      renderer: {
        type: "bar",
        minimum: checkNullOrType(f.minimum, "number", defaultMinimum),
        maximum: checkNullOrType(f.maximum, "number", defaultMaximum),
        showLabel: checkNullOrType(f.showLabel, "boolean", defaultShowLabel),
        origin: checkNullOrType(f.startingPoint, "string", defaultStartingPoint)
      },
      styles: {
        figureBackground: dews.string.format("linear, {0}, {1}, {2}", startColor, endColor, angle),
        textAlignment: textAlignment,
        lineAlignment: lineAlignment,
        paddingLeft: checkNullOrType(f.paddingLeft, "number", defaultPadding),
        paddingRight: checkNullOrType(f.paddingRight, "number", defaultPadding),
        paddingTop: checkNullOrType(f.paddingTop, "number", defaultPadding),
        paddingBottom: checkNullOrType(f.paddingBottom, "number", defaultPadding),
        figureSize: dews.string.format("{0}%", size)
      }
    };
    if (typeof f.displayCallback === "function")
    returnRenderer.displayCallback = f.displayCallback;
    return returnRenderer;
  };
  ColumnRenderer.prototype.getSignalRenderer = function (column) {
    if (!column)
    return null;
    var f = column.formats;
    if (!f)
    return null;
    var styleCreator = dews.ui.grid.StyleCreator.getInstance();
    var defaultBarCount = 10;
    var defaultColor = styleCreator.gridStyle.themeColorLight1;
    var defaultState = "value";
    var ds = column.dynamicStyles;
    if (ds) {
      $.each(ds, function (idx, item) {
        var style = item.styles;
        var color = checkNullOrType(style.color, "string", defaultColor);
        var state = checkNullOrType(style.state, "string", defaultState);
        style.figureBackground = color;
        delete style.color;
        style.figureState = Number(state);
        delete style.state;
      });
    }
    return {
      renderer: {
        type: "signal",
        barCount: checkNullOrType(f.barCount, "number", defaultBarCount)
      },
      styles: {
        figureBackground: checkNullOrType(f.color, "string", defaultColor),
        figureState: checkNullOrType(f.state, "string", defaultState)
      }
    };
  };
  function checkNullOrType(value, type, defaultValue) {
    if (value === null || value === void 0 || _typeof(value) !== type)
    return defaultValue;else

    return value;
  }
  function convertHorizontalAlignment(value) {
    switch (value.toLowerCase()) {
      case "left":
        return "near";
      case "right":
        return "far";
      case "center":
        return "center";
      default:
        return value;}

  }
  function convertVerticalAlignment(value) {
    switch (value.toLowerCase()) {
      case "top":
        return "near";
      case "bottom":
        return "far";
      case "middle":
        return "center";
      default:
        return value;}

  }

  // src/js/grid/column/formats/FormatsFactory.js
  var columnFormatMap = {
    DATE: convertDateFormats,
    LINK: convertLinkFormats,
    MASK: convertMaskFormats,
    NUMBER: convertNumberFormats,
    CHECK: convertCheckFormats,
    DATASOURCE: convertDataSourceFormats,
    IMAGE: convertImageFormats,
    TIME: convertTimeFormats,
    PASSWORD: convertPasswordFormats,
    MONTH: convertMonthFormats,
    YEAR: convertYearFormats,
    FUNCTION: convertFunctionFormats
  };
  var instance2;
  var FormatsFactory = /*#__PURE__*/function () {"use strict";
    function FormatsFactory() {_classCallCheck(this, FormatsFactory);
      if (instance2) {
        return instance2;
      }
      instance2 = this;
    }_createClass(FormatsFactory, [{ key: "getInnerColumnFormat", value:
      function getInnerColumnFormat(type, column, innerOptions) {
        var instance4 = columnFormatMap[type];
        if (instance4) {
          return instance4(column, innerOptions);
        }
        var columnRenderer = new ColumnRenderer();
        switch (type) {
          case "BAR":
            return columnRenderer.getBarRenderer(column);
          case "SIGNAL":
            return columnRenderer.getSignalRenderer(column);}

      } }]);return FormatsFactory;}();


  // src/js/grid/column/editor/ComboDropdown.js
  function convertComboDropdownEditor(column) {
    var innerColumn = {};
    innerColumn.editor = {
      dataValueField: column.editor.dataValueField,
      dataTextField: column.editor.dataTextField,
      editable: column.editor.editable
    };
    if (column.editor.dataSource) {
      innerColumn.editor.dataSource = column.editor.dataSource;
    }
    var values = column.editor.dataValueField,labels = column.editor.dataTextField,datasource = column.editor.dataSource;
    innerColumn.values = [];
    innerColumn.labels = [];
    innerColumn.editButtonVisibility = "visible";
    if (column.editor.type.toUpperCase() === "DROPDOWN") {
      innerColumn.editor.textReadOnly = true;
      if (column.editor.autoOpen) {
        innerColumn.editor.autoOpen = true;
      }
      innerColumn.editor.useNumkey = typeof column.editor.useNumkey === "boolean" ? column.editor.useNumkey : true;
    } else {
      innerColumn.editor.textReadOnly = false;
    }
    innerColumn.editor.type = "dropDown";
    innerColumn.lookupDisplay = true;
    innerColumn.editor.dropdowncount = 3;
    if (typeof column.editor.dataSource === "function") {
      if (typeof column.editor.dataTextField === "undefined") {
        innerColumn.labelField = labels;
      } else {
        innerColumn.labelField = column.editor.textField;
      }
    }
    if (typeof column.editor.dataSelectable === "string") {
      innerColumn.editor.dataSelectable = {
        field: column.editor.dataSelectable,
        trueValue: true,
        falseValue: false
      };
    } else if (_typeof(column.editor.dataSelectable) === "object") {
      innerColumn.editor.dataSelectable = column.editor.dataSelectable;
    }
    var dataSelectable = innerColumn.editor.dataSelectable;
    innerColumn.editor.values = [];
    innerColumn.editor.labels = [];
    if (datasource && datasource.transport && datasource.transport.data && datasource.transport.data.length > 0) {
      var transportData = datasource.transport.data;
      for (var j = 0; j < datasource.transport.data.length; j += 1) {
        innerColumn.values.push(transportData[j][values]);
        innerColumn.labels.push(transportData[j][labels]);
        if (dataSelectable && transportData[j][dataSelectable.field] !== dataSelectable.falseValue) {
          innerColumn.editor.values.push(datasource.transport.data[j][values]);
          innerColumn.editor.labels.push(datasource.transport.data[j][labels]);
        }
      }
    }
    return innerColumn;
  }

  // src/js/grid/column/editor/Number.js
  function convertNumberEditor(column, innerOptions) {
    var innerColumn = {};
    innerColumn.editor = {
      type: column.editor.type,
      max: column.editor.max,
      min: column.editor.min,
      round: column.editor.round,
      editable: column.editor.editable,
      format: column.editor.format,
      predefined: column.editor.predefined
    };
    if (column.editor.predefined === true) {
      if (typeof innerColumn.editor.preFormat === "undefined") {
        innerColumn.editor.preFormat = column.editor.format;
      }
      var preDefinedFormat;
      if (typeof column.editor.currency === "undefined") {
        preDefinedFormat = dews.getPreDefinedFormat(innerColumn.editor);
      } else if (typeof column.editor.currency === "string") {
        innerColumn.editor.preCurrency = column.editor.currency;
        innerColumn.editor.currency = column.editor.currency;
        preDefinedFormat = dews.getCurrencyFormat(innerColumn.editor);
      }
      if (_typeof(preDefinedFormat) === "object") {
        preDefinedFormat = preDefinedFormat.format;
      }
      if (preDefinedFormat) {
        innerColumn.editor.format = preDefinedFormat;
      } else {
        innerColumn.editor.format = "#,##0.##";
      }
    } else {
      innerColumn.editor.format = column.editor.format ? column.editor.format : "#,##0.##";
    }
    var decimalPlaceRegex = /[^.]*$/;
    var includesDot = innerColumn.editor.format.indexOf(".");
    var formatLetters = includesDot !== -1 ? decimalPlaceRegex.exec(innerColumn.editor.format)[0] : "";
    var formatLettersLength = formatLetters.length;
    var formatLetter = formatLettersLength > 0 ? formatLetters.charAt(formatLettersLength - 1) : "#";
    var decimalLength, intLength, maxLength;
    if (typeof column.editor.maxLength === "string") {
      maxLength = column.editor.maxLength;
    } else if (typeof innerColumn.editor.__maxLength === "string") {
      maxLength = innerColumn.editor.__maxLength;
    }
    if (typeof maxLength === "string") {
      var maxLengthRegex = /^(\d+)(?:,(\d+))?$/;
      var matchArray = maxLengthRegex.exec(maxLength);
      innerColumn.editor.__maxLength = maxLength;
      if (matchArray && matchArray.length > 0) {
        intLength = parseInt(matchArray[1], 10);
        try {
          if (intLength > 15) {
            throw "\uC22B\uC790\uD14D\uC2A4\uD2B8\uBC15\uC2A4 maxLength \uC18D\uC131\uC758 \uC124\uC815 \uAC00\uB2A5\uD55C \uCD5C\uB300\uAC12\uC740 15\uC785\uB2C8\uB2E4.";
          }
          if (matchArray[2]) {
            var newFormat;
            decimalLength = parseInt(matchArray[2], 10);
            intLength = intLength - decimalLength;
            if (intLength <= 0) {
              throw "\uC22B\uC790\uD14D\uC2A4\uD2B8\uBC15\uC2A4 maxLength \uC18D\uC131\uC758 \uC124\uC815\uAC12\uC740 \uC815\uC218\uBD80\uC758 \uC22B\uC790\uAC00 \uC18C\uC218\uBD80\uC758 \uC22B\uC790\uBCF4\uB2E4 \uCEE4\uC57C\uD569\uB2C8\uB2E4.";
            }
            if (formatLettersLength > decimalLength) {
              newFormat = (includesDot !== -1 ? innerColumn.editor.format.replace(decimalPlaceRegex, "") : innerColumn.editor.format + ".") + formatLetters.substr(0, decimalLength);
            } else if (formatLettersLength < decimalLength) {
              newFormat = (includesDot !== -1 ? innerColumn.editor.format.replace(decimalPlaceRegex, "") : innerColumn.editor.format + ".") + formatLetters + formatLetter.repeat(decimalLength - formatLettersLength);
            } else {
              newFormat = innerColumn.editor.format;
            }
            innerColumn.editor.format = newFormat;
          } else {
            innerColumn.editor.format = innerColumn.editor.format.split(".")[0];
          }
        } catch (e) {
          intLength = 15 - formatLettersLength;
          console.error(e);
        }
        innerColumn.editor.maxIntegerLength = intLength;
      }
      innerColumn.editor.maxLength = 0;
    } else if (typeof maxLength === "undefined") {
      innerColumn.editor.maxIntegerLength = 15 - formatLettersLength;
    }
    if (typeof innerOptions.fieldIndex !== "undefined") {
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].dataType = "number";
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].dataType = "number";
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].min = column.editor.min;
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].max = column.editor.max;
    }
    innerColumn.editor.editFormat = typeof innerColumn.editor.format === "undefined" ? "#,##0.##" : innerColumn.editor.format;
    innerColumn.editor.increaseValue = typeof column.editor.increaseValue === "undefined" ? 1e3 : parseFloat(column.editor.increaseValue);
    innerColumn.editor.increaseType = typeof column.editor.increaseType === "undefined" ? "multiple" : column.editor.increaseType;
    return innerColumn;
  }

  // src/js/grid/column/editor/String.js
  function convertStringEditor(column) {
    var innerColumn = {};
    innerColumn.editor = {
      maxLength: column.editor.maxLength,
      editable: column.editor.editable,
      textCase: column.editor.textCase
    };
    innerColumn.editor.type = "text";
    return innerColumn;
  }

  // src/js/grid/column/editor/Date.js
  function convertDateEditor(column, innerOptions) {
    var innerColumn = {};
    innerColumn.editor = {
      type: column.editor.type,
      format: column.editor.format,
      predefined: column.editor.predefined,
      editable: column.editor.editable
    };
    innerColumn.styles = {};
    if (column.editor.predefined === true) {
      if (typeof innerColumn.editor.preFormat === "undefined") {
        innerColumn.editor.preFormat = column.editor.format;
      }
      var preDefinedFormat = dews.getPreDefinedFormat(innerColumn.editor);
      if (preDefinedFormat) {
        innerColumn.editor.format = preDefinedFormat;
      } else {
        innerColumn.editor.format = dews._environments.formats.dateFormat;
      }
    }
    innerColumn.editor.maxDate = new Date(9999, 12, 0);
    innerColumn.editor.minDate = new Date(1e3, 0, 1);
    innerColumn.editor.yearDisplayFormat = "{Y}" + dews.localize.get("\uB144", "dews_\uB144Y");
    innerColumn.editor.months = dews.localize.getMonth();
    innerColumn.editor.weekDays = dews.localize.getDays();
    innerColumn.editor.datetimeFormat = typeof innerColumn.editor.format === "undefined" ? dews._environments.formats.dateFormat : innerColumn.editor.format;
    innerColumn.styles.datetimeFormat = typeof innerColumn.editor.format === "undefined" ? dews._environments.formats.dateFormat : innerColumn.editor.format;
    innerColumn.editor.mask = {
      editMask: typeof innerColumn.editor.format === "undefined" ? dews._environments.formats.dateFormat.replace(/[A-z\\s]/gi, "9") : innerColumn.editor.format.replace(/[A-z\\s]/gi, "9"),
      includedFormat: true
    };
    innerColumn.editButtonVisibility = "visible";
    if ($.type(innerOptions.fieldIndex) !== "undefined") {
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].dataType = "datetime";
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.dateValueFormat;
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].dataType = "datetime";
    }
    return innerColumn;
  }

  // src/js/grid/column/editor/MaskTime.js
  function convertMaskTimeEditor(column) {
    var innerColumn = {};
    innerColumn.editor = {
      type: column.editor.type,
      format: column.editor.format,
      editable: column.editor.editable
    };
    if (column.editor.type === "time") {
      innerColumn.editor.min = column.editor.min;
      innerColumn.editor.max = column.editor.max;
      innerColumn.editor.interval = column.editor.interval;
      innerColumn.editor.useAP = column.editor.useAP;
      innerColumn.editor._secondValue = column.editor.secondValue;
    }
    var editMask = column.editor.format;
    if (editMask) {
      for (var em = 0; em < editMask.length; em += 1) {
        switch (editMask[em]) {
          case "L":
          case "?":
          case "#":
          case "&":
            editMask = editMask.replace(editMask[em], "a");
            break;
          case "A":
          case "a":
            editMask = editMask.replace(editMask[em], "*");
            break;
          case "H":
          case "m":
          case "s":
            editMask = editMask.replace(editMask[em], "0");
            break;}

      }
    }
    if (column.editor.type.toUpperCase() === "TIME") {
      innerColumn.editor.type = "time";
      innerColumn.editor.format = column.editor.format;
      innerColumn.editor.predefined = column.editor.predefined;
      if (column.editor.predefined === true) {
        if (typeof innerColumn.editor.preFormat === "undefined") {
          innerColumn.editor.preFormat = column.editor.format;
        }
        var preDefinedFormat = dews.getPreDefinedFormat(innerColumn.editor);
        if (preDefinedFormat) {
          editMask = preDefinedFormat;
        } else {
          editMask = "HH:mm:ss";
        }
      }
      if (typeof column.editor.secondValue === "boolean" && column.editor.secondValue === true) {
        innerColumn._secondValue = true;
      }
      innerColumn.button = "image";
      innerColumn.buttonVisibility = "visible";
      if (typeof column.editor.editable === "boolean" && !column.editor.editable) {
        innerColumn.buttonVisibility = "hidden";
      }
      var clockIcon = dews._environments.scriptBase + "realgrid/assets/comp-icon-clock.png";
      innerColumn.imageButtons = {
        width: 24,
        height: 22,
        images: [
        {
          name: "timebutton",
          up: clockIcon,
          hover: clockIcon,
          down: clockIcon
        }]

      };
    } else {
      innerColumn.editor.type = "text";
    }
    if (typeof editMask === "function") {
      innerColumn.editor.mask = {
        allowEmpty: true
      };
    } else {
      if (editMask !== "") {
        innerColumn.editor.mask = {
          editMask: editMask,
          allowEmpty: true
        };
      }
    }
    return innerColumn;
  }

  // src/js/grid/column/editor/CodePicker.js
  function convertCodePickerEditor(column, innerOptions) {
    var innerColumn = {};
    innerColumn.editor = $.extend(true, {}, column.editor);
    innerColumn.editor.firstClick = true;
    innerColumn.button = "image";
    innerColumn.buttonVisibility = "visible";
    if (typeof column.editor.editable === "boolean") {
      if (!column.editor.editable) {
        innerColumn.buttonVisibility = "hidden";
      }
    }
    innerColumn.imageButtons = {
      width: 24,
      height: 22,
      images: [
      {
        name: "codepickerbutton",
        up: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
        hover: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
        down: dews._environments.scriptBase + "realgrid/assets/search_ico.png"
      }]

    };
    innerOptions._grid = true;
    innerColumn.codeOption = {
      field: column.field,
      code: column.editor.helpCode,
      codeField: column.editor.codeField,
      textField: column.editor.textField,
      gridCodeField: column.editor.gridCodeField,
      gridTextField: column.editor.gridTextField,
      params: column.editor.helpParams,
      size: column.editor.helpSize,
      title: column.editor.helpTitle,
      mode: "single",
      width: column.editor.helpWidth,
      height: column.editor.helpHeight,
      initData: column.editor.initData,
      callback: column.editor.callback,
      custom: column.editor.helpCustom || false,
      viewUrl: column.editor.helpViewUrl,
      apiUrl: column.editor.helpApiUrl,
      moveFocus: typeof column.editor.moveFocus === "boolean" ? column.editor.moveFocus : true,
      useAjax: typeof column.editor.useAjax === "boolean" ? column.editor.useAjax : true,
      validation: typeof column.editor.validation === "boolean" ? column.editor.validation : true,
      value: {}
    };
    return innerColumn;
  }

  // src/js/grid/column/editor/Button.js
  function convertButtonEditor(column) {
    var innerColumn = {};
    innerColumn.editor = $.extend(true, {}, column.editor);
    innerColumn.buttonVisibility = "always";
    if (typeof column.editor.align !== "undefined") {
      switch (column.editor.align.toLowerCase()) {
        case "left":
          innerColumn.editor.align = "near";
          break;
        case "right":
          innerColumn.editor.align = "far";
          break;}

    }
    innerColumn.renderer = column.editor.buttonText ? textRenderer(innerColumn) : defaultRenderer(innerColumn);
    return innerColumn;
  }
  function defaultRenderer(column) {
    return {
      type: "imageButtons",
      images: {
        up: column.editor.basicImg,
        hover: column.editor.hoverImg,
        down: column.editor.clickImg,
        width: typeof column.editor.buttonWidth === "undefined" ? 50 : column.editor.buttonWidth
      },
      margin: column.editor.align === "far" ? -4 : 0,
      alignment: column.editor.align ? column.editor.align : "center",
      width: typeof column.editor.buttonWidth === "undefined" ? 50 : column.editor.buttonWidth,
      height: typeof column.editor.buttonHeight === "undefined" ? 25 : column.editor.buttonHeight,
      showText: true
    };
  }
  function textRenderer(column) {
    return {
      type: "imageButton",
      imageUrl: column.editor.basicImg,
      hoverUrl: column.editor.hoverImg,
      activeUrl: column.editor.clickImg,
      text: getButtonText(column.editor.buttonText),
      hoveredUnderline: column.editor.hoveredUnderline ? column.editor.hoveredUnderline : false
    };
  }
  function getButtonText(buttonText) {
    var result = "";
    if (_typeof(buttonText) === "object") {
      result = buttonText.text ? buttonText.text : "";
    }
    return result;
  }

  // src/js/grid/column/editor/ZipCodePicker.js
  function convertZipCodePickerEditor(column, innerOptions) {
    var innerColumn = {};
    innerColumn.editor = {
      type: column.editor.type,
      addressType: column.editor.addressType,
      callback: column.editor.callback,
      editable: column.editor.editable
    };
    innerColumn.button = "image";
    innerColumn.buttonVisibility = "visible";
    if (typeof column.editor.editable === "boolean" && !column.editor.editable) {
      innerColumn.buttonVisibility = "hidden";
    }
    innerColumn.imageButtons = {
      width: 24,
      height: 22,
      images: [
      {
        name: "zipcodepickerbutton",
        up: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
        hover: dews._environments.scriptBase + "realgrid/assets/search_ico.png",
        down: dews._environments.scriptBase + "realgrid/assets/search_ico.png"
      }]

    };
    innerOptions._grid = true;
    innerColumn.codeOption = {
      field: column.field,
      addressType: typeof column.editor.addressType === "undefined" ? "zipcode" : column.editor.addressType,
      callback: column.editor.callback
    };
    return innerColumn;
  }

  // src/js/grid/column/editor/Month.js
  function convertMonthEditor(column, innerOptions) {
    var innerColumn = {};
    innerColumn.editor = {
      type: "month",
      editable: column.editor.editable,
      predefined: column.editor.predefined,
      format: column.editor.format
    };
    innerColumn.styles = {};
    if (column.editor.predefined === true) {
      if (typeof innerColumn.editor.preFormat === "undefined") {
        innerColumn.editor.preFormat = column.editor.format;
      }
      var preDefinedFormat = dews.getPreDefinedFormat(innerColumn.editor);
      if (preDefinedFormat) {
        innerColumn.editor.format = preDefinedFormat;
      } else {
        innerColumn.editor.format = dews._environments.formats.monthFormat;
      }
    }
    innerColumn.editor.minDate = new Date(1900, 0, 1);
    innerColumn.editor.maxDate = new Date(2100, 12, 0);
    innerColumn.editor.datetimeFormat = typeof innerColumn.editor.format === "undefined" ? dews._environments.formats.monthFormat : innerColumn.editor.format;
    innerColumn.styles.datetimeFormat = typeof innerColumn.editor.format === "undefined" ? dews._environments.formats.monthFormat : innerColumn.editor.format;
    innerColumn.editor.mask = {
      editMask: typeof innerColumn.editor.format === "undefined" ? dews._environments.formats.monthFormat.replace(/[A-z\\s]/gi, "9") : innerColumn.editor.format.replace(/[A-z\\s]/gi, "9"),
      includedFormat: true
    };
    innerColumn.button = "image";
    innerColumn.buttonVisibility = "visible";
    if (typeof column.editor.editable === "boolean" && !column.editor.editable) {
      innerColumn.buttonVisibility = "hidden";
    }
    innerColumn.imageButtons = {
      width: 24,
      height: 22,
      images: [
      {
        name: "monthbutton",
        up: dews._environments.scriptBase + "realgrid/assets/calendar_up.png",
        hover: dews._environments.scriptBase + "realgrid/assets/calendar_hover.png",
        down: dews._environments.scriptBase + "realgrid/assets/calendar_down.png"
      }]

    };
    if (typeof innerOptions.fieldIndex !== "undefined") {
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].dataType = "datetime";
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.monthValueFormat;
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].dataType = "datetime";
    }
    return innerColumn;
  }

  // src/js/grid/column/editor/Year.js
  function convertYearEditor(column, innerOptions) {
    var innerColumn = {};
    innerColumn.editor = {
      type: "year",
      editable: column.editor.editable,
      predefined: column.editor.predefined,
      format: column.editor.format
    };
    innerColumn.styles = {};
    if (column.editor.predefined === true) {
      if (typeof innerColumn.editor.preFormat === "undefined") {
        innerColumn.editor.preFormat = column.editor.format;
      }
      var preDefinedFormat = dews.getPreDefinedFormat(innerColumn.editor);
      if (preDefinedFormat) {
        innerColumn.editor.format = preDefinedFormat;
      } else {
        innerColumn.editor.format = dews._environments.formats.yearFormat;
      }
    }
    innerColumn.editor.minDate = new Date(1900, 0, 1);
    innerColumn.editor.maxDate = new Date(2100, 12, 0);
    innerColumn.editor.datetimeFormat = typeof innerColumn.editor.format === "undefined" ? dews._environments.formats.yearFormat : innerColumn.editor.format;
    innerColumn.styles.datetimeFormat = typeof innerColumn.editor.format === "undefined" ? dews._environments.formats.yearFormat : innerColumn.editor.format;
    innerColumn.editor.mask = {
      editMask: typeof innerColumn.editor.format === "undefined" ? dews._environments.formats.monthFormat.replace(/[A-z\\s]/gi, "9") : innerColumn.editor.format.replace(/[A-z\\s]/gi, "9"),
      includedFormat: true
    };
    innerColumn.button = "image";
    innerColumn.buttonVisibility = "visible";
    if (typeof column.editor.editable === "boolean" && !column.editor.editable) {
      innerColumn.buttonVisibility = "hidden";
    }
    innerColumn.imageButtons = {
      width: 24,
      height: 22,
      images: [
      {
        name: "yearbutton",
        up: dews._environments.scriptBase + "realgrid/assets/calendar_up.png",
        hover: dews._environments.scriptBase + "realgrid/assets/calendar_hover.png",
        down: dews._environments.scriptBase + "realgrid/assets/calendar_down.png"
      }]

    };
    if (typeof innerOptions.fieldIndex !== "undefined") {
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.yearFormat;
      innerOptions.dataSource.options.field[innerOptions.fieldIndex].dataType = "datetime";
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].datetimeFormat = dews._environments.formats.yearFormat;
      innerOptions.dataSource.options.schema.model.fields[innerOptions.fieldIndex].dataType = "datetime";
    }
    return innerColumn;
  }

  // src/js/grid/column/editor/MultiLine.js
  function convertMultilineEditor(column) {var _column$editor$textWr2;
    var innerColumn = {};
    innerColumn.editor = {
      type: column.editor.type,
      maxLength: column.editor.maxLength,
      editable: column.editor.editable,
      textCase: column.editor.textCase,
      minHeight: column.editor.minHeight
    };
    innerColumn.styles = {};
    innerColumn.editor.type = "multiline";
    innerColumn.styles.textWrap = (_column$editor$textWr2 = column.editor.textWrap) !== null && _column$editor$textWr2 !== void 0 ? _column$editor$textWr2 : "explicit";
    return innerColumn;
  }

  // src/js/grid/column/editor/Check.js
  function convertCheckEditor(column, innerOptions) {
    var innerColumn = {};
    innerColumn.editor = {
      type: column.editor.type,
      trueValue: column.editor.trueValue,
      falseValue: column.editor.falseValue
    };
    innerColumn.styles = {};
    innerColumn.renderer = {
      type: "check",
      shape: "box",
      editable: typeof column.editor.editable === "boolean" ? column.editor.editable : true,
      startEditOnClick: true,
      trueValues: typeof column.editor.trueValue === "undefined" ? "true" : column.editor.trueValue,
      falseValues: typeof column.editor.falseValue === "undefined" ? "false" : column.editor.falseValue,
      trueImage: innerOptions.gridStyle.body.checkedImg,
      falseImage: innerOptions.gridStyle.body.unCheckImg,
      labelPosition: "none",
      showInnerFocus: false
    };
    innerColumn.editable = false;
    innerColumn.styles.figureBackground = "#ff4995ff";
    return innerColumn;
  }

  // src/js/grid/column/editor/ReadOnly.js
  function convertReadonlyEditor() {
    var innerColumn = {};
    innerColumn.editor = {
      type: "readonly"
    };
    innerColumn.readOnly = true;
    innerColumn.editable = false;
    return innerColumn;
  }

  // src/js/grid/column/editor/EditorFactory.js
  var columnEditorMap = {
    DROPDOWN: convertComboDropdownEditor,
    COMBO: convertComboDropdownEditor,
    NUMBER: convertNumberEditor,
    STRING: convertStringEditor,
    DATE: convertDateEditor,
    READONLY: convertReadonlyEditor,
    MASK: convertMaskTimeEditor,
    TIME: convertMaskTimeEditor,
    CODEPICKER: convertCodePickerEditor,
    BUTTON: convertButtonEditor,
    CHECK: convertCheckEditor,
    ZIPCODEPICKER: convertZipCodePickerEditor,
    MULTILINE: convertMultilineEditor,
    MONTH: convertMonthEditor,
    YEAR: convertYearEditor
  };
  var instance3;
  var EditorFactory = /*#__PURE__*/function () {"use strict";
    function EditorFactory() {_classCallCheck(this, EditorFactory);
      if (instance3) {
        return instance3;
      }
      instance3 = this;
    }_createClass(EditorFactory, [{ key: "getInnerColumnEditor", value:
      function getInnerColumnEditor(type, column, innerOptions) {
        var instance4 = columnEditorMap[type];
        if (instance4) {
          return instance4(column, innerOptions);
        }
      } }]);return EditorFactory;}();


  // src/js/grid/column/ColumnAdaptor.js
  var ColumnAdaptor = /*#__PURE__*/function () {"use strict";
    function ColumnAdaptor(userOptions, _innerOptions2) {_classCallCheck(this, ColumnAdaptor);_defineProperty(this, "_columnFormatsConvert",








































































































































































































































































      function (column, innerOptions) {var _column$formats$type2;
        var type = (_column$formats$type2 = column.formats.type) !== null && _column$formats$type2 !== void 0 ? _column$formats$type2 : "text";
        var innerColumn = {
          formats: {
            type: type
          }
        };
        var formatsFactory = new FormatsFactory();
        var innerColumnFormats = formatsFactory.getInnerColumnFormat(type.toUpperCase(), column, innerOptions);
        $.extend(true, innerColumn, innerColumnFormats);
        return innerColumn;
      });this._userOptions = userOptions;this._innerOptions = _innerOptions2;return this;}_createClass(ColumnAdaptor, [{ key: "initialize", value: function initialize() {this._innerOptions._columns = {};this._innerOptions.styleColumn = [];if (typeof this._userOptions.columns !== "undefined") {this._userOptions.columns = this.uuidCreator(this._userOptions.columns);}this._innerOptions.columns = this.convertColumns(this._userOptions.columns);return this._innerOptions;} }, { key: "convertColumns", value: function convertColumns(columns) {var self = this;if (columns && self._userOptions.dataSource && self._userOptions.dataSource.options.field) {var d,innerColumns = [],innerColumn;self._innerOptions.columnsDepth = self._innerOptions.columnsDepth + 1;d = self._innerOptions.columnsDepth;$.each(columns, function (index, column) {if (columns[0].field === "__UUID") {column._multiHeaderColumnName = "_he@der_name_" + d + (index - 1);} else {column._multiHeaderColumnName = "_he@der_name_" + d + index;}innerColumn = self.convert(column, self._userOptions, self._innerOptions);innerColumns.push(innerColumn);self._innerOptions._columns[innerColumn.name] = innerColumn;});}return innerColumns;} }, { key: "convert", value: function convert(column, userOptions, innerOptions) {var innerColumn = {};if (!column) {return innerColumn;}setInnerColumnBase(this, column, innerColumn, innerOptions, userOptions);if (column.formats) {$.extend(true, innerColumn, this._columnFormatsConvert(column, innerOptions));}if (column.editor) {if (!innerColumn.editor) {innerColumn.editor = {};}var editorAlign = "center";if (innerColumn.styles.textAlignment) {editorAlign = innerColumn.styles.textAlignment;}if (typeof column.editor.type === "undefined") {innerColumn.editor.type = "string";$.extend(true, innerColumn, convertStringEditor(column));} else {innerColumn.editor.type = column.editor.type;}if (typeof innerColumn.editable === "boolean" && !innerColumn.editable && innerColumn.editor.type.toLowerCase() !== "check") {innerColumn.editor.editable = innerColumn.editable;} else if (innerColumn.editor.type.toLowerCase() === "check" && typeof column.editable === "boolean" && !column.editable) {innerColumn.editor.editable = column.editable;} else {if (typeof column.editor.editable === "boolean") {innerColumn.editable = column.editor.editable;innerColumn.editor.editable = column.editor.editable;} else if (typeof column.editor.editable === "undefined") {if (innerColumn.editor.type.toLowerCase() === "check") {innerColumn.editor.editable = column.editable !== void 0 ? column.editable : true;} else {innerColumn.editor.editable = innerColumn.editable;}}}innerColumn.editor.textAlignment = editorAlign;$.extend(true, innerColumn, this._columnEditorConvert(column));}if (typeof column.editor === "undefined") {innerColumn.editor = { type: "text", editable: innerColumn.editable, textAlignment: innerColumn.styles.textAlignment };}setInnerColumnAttributes(column, innerColumn, innerOptions);if (column.footer) {$.extend(true, innerColumn, this._columnFooterConvert(column, innerColumn.styles.textAlignment));}if (column.headerSummary) {this._headerSummary = new HeaderSummary(this);innerColumn.header.summary = this._headerSummary.initialize(column, innerColumn.styles.textAlignment);}if (typeof column.style === "function") {innerOptions.styleColumn.push(column.field);}setInnerColumnGrouping(column, innerColumn, innerOptions);setInnerColumnMultiColumnHeight(column, innerColumn, innerOptions);setInnerColumnMultiHeader(this, column, innerColumn, innerOptions);setInnerColumnCellMerge(column, innerColumn, innerOptions);return innerColumn;} }, { key: "_columnEditorConvert", value: function _columnEditorConvert(column) {var type = column.editor.type,innerOptions = this._innerOptions;if (!type) {return;}var editorFactory = new EditorFactory();return editorFactory.getInnerColumnEditor(type.toUpperCase(), column, innerOptions);} }, { key: "_columnFooterConvert", value: function _columnFooterConvert(column, stylesTextAlignment) {var innerColumn = {};innerColumn.footer = {};this._innerOptions.footer.visible = true;var multiFooterCnt = this._userOptions.multiFooterCnt;if (multiFooterCnt > 1) {this._innerOptions.footer.count = multiFooterCnt;this._innerOptions.footer.minHeight = 32 * multiFooterCnt;var multiFooterArray = [];if (Array.isArray(column.footer)) {multiFooterArray = column.footer;} else if (_typeof(column.footer) === "object") {multiFooterArray.push(column.footer);}var footerText = [];var footerStyles = [];var footerExpression = [];var footerPreCurrency = [];var footerPreFormat = [];var footerCallback;for (var footerIdx = 0; footerIdx < multiFooterArray.length; footerIdx++) {var footer = this._footerConvert(multiFooterArray[footerIdx], stylesTextAlignment);footerText.push(footer.text);footerStyles.push(footer.styles);footerExpression.push(footer.expression);footerPreCurrency.push(footer.preCurrency);footerPreFormat.push(footer.preFormat);if (footerIdx === 0) {if (!footer.expression) {footerCallback = footer.callback;}} else {if (footer.expression) {footerCallback = "";}}}innerColumn.footer.styles = footerStyles;innerColumn.footer.expression = footerExpression;innerColumn.footer.preCurrency = footerPreCurrency;innerColumn.footer.preFormat = footerPreFormat;innerColumn.footer.text = footerText;if (typeof footerCallback === "function") {innerColumn.footer.callback = footerCallback;innerColumn.footer.expression = "";}} else {this._innerOptions.footer.count = 1;innerColumn.footer = this._footerConvert(column.footer, stylesTextAlignment);}if (this._innerOptions._gridType === "GRID") {var footers = !Array.isArray(column.footer) ? [column.footer] : column.footer;footers.forEach(function (footer) {if (footer.group) {setColumnFooter(footer.group);}});}function setColumnFooter(group) {innerColumn.footer.groupExpression = group.type;if (group.text) {innerColumn.footer.groupText = group.text;}if (group.callback) {innerColumn.footer.groupCallback = group.callback;}}return innerColumn;} }, { key: "_footerConvert", value: function _footerConvert(userFooter, stylesTextAlignment) {var footer = {},footerAlign = "center";if (typeof userFooter.text === "string") {footer.text = userFooter.text;}if (typeof userFooter.predefined === "boolean") {footer.predefined = userFooter.predefined;}if (typeof userFooter.format === "string") {footer.format = userFooter.format;}if (typeof userFooter.callback === "function") {footer.callback = userFooter.callback;}footer.styles = {};if (userFooter.styles === void 0) {if (stylesTextAlignment) {footerAlign = stylesTextAlignment;}footer.styles = { textAlignment: footerAlign };}if (typeof userFooter.suffix !== "undefined") {footer.styles.suffix = userFooter.suffix;}if (typeof userFooter.prefix !== "undefined") {footer.styles.prefix = userFooter.prefix;}if (typeof userFooter.align !== "undefined") {switch (userFooter.align.toLowerCase()) {case "left":footer.styles.textAlignment = "near";break;case "right":footer.styles.textAlignment = "far";break;default:footer.styles.textAlignment = "center";break;}}if (userFooter.type) {if (typeof this._innerOptions.fieldIndex !== "undefined" && userFooter.type.toLowerCase() !== "count") {this._innerOptions.dataSource.options.field[this._innerOptions.fieldIndex].dataType = "number";this._innerOptions.dataSource.options.schema.model.fields[this._innerOptions.fieldIndex].dataType = "number";}footer.expression = userFooter.type;footer.styles.numberFormat = typeof userFooter.format === "undefined" ? "#,##0.##" : userFooter.format;if (userFooter.predefined === true) {if (typeof userFooter.preFormat === "undefined" || userFooter.preFormat !== userFooter.format) {footer.preFormat = userFooter.format;}var preDefinedFormat = dews.getPreDefinedFormat(footer);if ($.type(userFooter.currency) !== "undefined") {if ($.type(userFooter.currency) === "string") {footer.preCurrency = userFooter.currency;footer.currency = userFooter.currency;preDefinedFormat = dews.getCurrencyFormat(footer);if (preDefinedFormat) {var round = typeof preDefinedFormat.round === "string" ? preDefinedFormat.round : "round";if (round !== "round") {if (preDefinedFormat.format.split(".").length === 2) {if (round === "ceil") {preDefinedFormat.format += ";;;c";} else {preDefinedFormat.format += ";;;f";}}}}} else if (typeof userFooter.currency === "function") {footer.preCurrency = userFooter.currency;footer.currency = userFooter.currency;userFooter.preCurrency = "";}}if (_typeof(preDefinedFormat) === "object") {preDefinedFormat = preDefinedFormat.format;}if (preDefinedFormat) {footer.styles.numberFormat = preDefinedFormat;} else {footer.styles.numberFormat = "#,##0.##";}}}return footer;} }, { key: "uuidCreator", value:
      function uuidCreator(columns) {
        var f = columns.some(function (column) {
          return column.field === "__UUID";
        });
        if (!f) {
          columns.splice(0, 0, {
            field: "__UUID",
            fieldName: "__UUID",
            name: "__UUID",
            visible: false,
            header: { text: " " }
          });
        }
        return columns;
      } }]);return ColumnAdaptor;}();

  dews.ui.grid.ColumnAdaptor = ColumnAdaptor;

  // src/js/grid/util/dews.ui.grid.OptionAdaptor.js
  (function (dews2) {
    function GridOptionAdaptor(type) {
      this._columnAdaptor = {};
      this._innerOptions = {
        _gridType: type.toUpperCase()
      };
      this._styleCreator = dews2.ui.grid.StyleCreator.getInstance();
      return this;
    }
    GridOptionAdaptor.prototype.convert = function (userOptions) {
      var innerOptions = this._innerOptions;
      innerOptions.gridStyle = this._styleCreator.gridStyle;
      var innerDefaultOptions = {
        panel: {
          visible: false
        },
        checkBar: {
          visible: true,
          checkImageUrl: innerOptions.gridStyle.checkBar.checkedImg,
          unCheckImageUrl: innerOptions.gridStyle.checkBar.unCheckImg,
          headCheckImageUrl: innerOptions.gridStyle.checkBar.checkedImg,
          headUnCheckImageUrl: innerOptions.gridStyle.checkBar.unCheckImg
        },
        stateBar: {
          visible: false
        },
        header: {
          minHeight: innerOptions.gridStyle.header.height,
          heightFill: "fixed",
          summary: {
            height: innerOptions.gridStyle.header.summary.height,
            minHeight: innerOptions.gridStyle.header.summary.height
          }
        },
        footer: {
          visible: false,
          height: innerOptions.gridStyle.footer.height,
          minHeight: innerOptions.gridStyle.footer.height
        },
        indicator: {
          visible: true,
          headText: "No",
          footText: " "
        },
        edit: {
          insertable: false,
          appendable: false,
          editable: false,
          crossWhenExitLast: true,
          showInvalidFormatMessage: false,
          enterToTab: true,
          checkDiff: true,
          skipReadOnly: false
        },
        display: {
          fitStyle: "even",
          showEmptyMessage: false,
          emptyMessage: "",
          showEmptyImage: true,
          rowHeight: innerOptions.gridStyle.body.height,
          minHeight: innerOptions.gridStyle.body.height,
          focusColor: innerOptions.gridStyle.selection.focusBorderColor,
          focusBorderWidth: "2px",
          innerFocusColor: innerOptions.gridStyle.selection.focusBorderColor,
          showInnerFocus: true,
          columnMovable: userOptions.movable ? userOptions.movable : false,
          columnResizable: true,
          editingMergedRow: false,
          editItemMerging: true,
          heightMeasurer: "fixed",
          wheelEventPropagate: false
        },
        copy: {
          singleMode: false,
          copyDisplayText: true
        },
        paste: {
          singleMode: false,
          checkReadOnly: true,
          noEditEvent: true,
          numberChars: [",", " "]
        },
        select: {
          style: "block"
        },
        sorting: {
          enabled: true,
          keepFocusedRow: true
        },
        fixed: {
          colBarWidth: 1
        },
        filtering: {
          imageHandle: true,
          handleImages: {
            fill: dews2._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png",
            hoveredNone: dews2._environments.scriptBase + "realgrid/assets/ico-grid-filter-off.png",
            hoveredFill: dews2._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png"
          }
        },
        filter: {
          use: true,
          iconVisible: false,
          useColumns: []
        },
        dataBounding: false,
        rowDynamic: [],
        autoBind: true,
        depth: 1,
        columnsDepth: 0,
        maxDepth: 1,
        grouping: false,
        groupCol: 1,
        maxGroupCol: 1,
        context: true,
        editSkip: false,
        copyMode: "row",
        isVisible: true,
        fillWidth: true,
        images: [],
        displayColumns: [],
        _originColumns: [],
        multiFooterCnt: 1,
        shiftCheck: dews2._environments.gridShiftCheck,
        detailGrid: {
          addedRowDataSourceRead: true
        },
        scrollThumbRadius: 5,
        scrollBarWidth: 8,
        scrollBarHeight: 8
      };
      if (innerOptions._gridType === "GRID") {
        innerDefaultOptions.sorting.style = "exclusive";
        innerDefaultOptions.fixed.rowBarHeight = 1;
        innerDefaultOptions.sortMode = "explicit";
      } else if (innerOptions._gridType === "TREEGRID") {
        innerDefaultOptions.icons = [];
      }
      var userDefaultOptions = {
        autoBind: true,
        fillWidth: true,
        editSkip: false
      };
      userOptions = $.extend(true, {}, userDefaultOptions, userOptions);
      innerOptions = $.extend(true, {}, innerDefaultOptions, innerOptions);
      innerOptions.dataSource = userOptions.dataSource;
      if (Array.isArray(userOptions.columns)) {
        innerOptions._initColumns = userOptions.columns.slice();
      } else {
        innerOptions._initColumns = [];
      }
      if ($.type(userOptions.context) !== "undefined") {
        innerOptions.context = userOptions.context;
      }
      if ($.type(userOptions.autoBind) !== "undefined") {
        innerOptions.autoBind = userOptions.autoBind;
      }
      if ($.type(userOptions.rowNo) !== "undefined") {
        if ($.type(userOptions.rowNo) === "object") {
          innerOptions.indicator.visible = true;
          innerOptions.indicator.headText = $.type(userOptions.rowNo.text) === "undefined" ? innerOptions.indicator.headText : userOptions.rowNo.text;
          innerOptions.indicator.width = $.type(userOptions.rowNo.width) === "undefined" ? 40 : userOptions.rowNo.width;
        } else if ($.type(userOptions.rowNo) === "boolean") {
          innerOptions.indicator.visible = userOptions.rowNo;
        }
      }
      if ($.type(userOptions.selectable) !== "undefined") {
        if (userOptions.selectable === true) {
          innerOptions.display.rowFocusVisible = true;
          innerOptions.display.rowFocusBackground = innerOptions.gridStyle.selectionBackground;
        } else if (userOptions.selectable === false) {
          innerOptions.display.rowFocusVisible = false;
          delete innerOptions.display.rowFocusBackground;
        }
      }
      if ($.type(userOptions.sortable) !== "undefined") {
        if (innerOptions._gridType === "GRID" && userOptions.sortable === "multiple") {
          innerOptions.sorting.style = "inclusive";
          innerOptions.sorting.enabled = true;
        } else {
          innerOptions.sorting.enabled = userOptions.sortable;
        }
      }
      if ($.type(userOptions.sort) !== "undefined") {
        innerOptions.sorting.sort = userOptions.sort;
      }
      if (innerOptions._gridType === "GRID" && $.type(userOptions.rowEditable) !== "undefined") {
        innerOptions.edit.rowEditable = userOptions.rowEditable;
      }
      if ($.type(userOptions.editable) !== "undefined") {
        innerOptions.edit.editable = userOptions.editable;
      }
      if ($.type(userOptions.checkable) !== "undefined") {
        innerOptions.checkBar.visible = userOptions.checkable;
      }
      if ($.type(userOptions.stateColumn) === "boolean") {
        innerOptions.stateBar.visible = userOptions.stateColumn;
      }
      if ($.type(innerOptions.readOnly) !== "undefined") {
        innerOptions.edit.readOnly = innerOptions.readOnly;
      }
      if ($.type(userOptions.editSkip) === "boolean" && userOptions.editSkip) {
        innerOptions.editSkip = true;
        innerOptions.edit.skipReadOnly = true;
      }
      if ($.type(userOptions.noData) === "boolean") {
        innerOptions.display.showEmptyMessage = userOptions.noData;
        innerOptions.display.showEmptyImage = userOptions.noDataImage || innerOptions.display.showEmptyImage;
        if (innerOptions.display.showEmptyMessage && $.type(userOptions.noDataMessage) !== "undefined") {
          innerOptions.display.emptyMessage = userOptions.noDataMessage;
        } else {
          innerOptions.display.emptyMessage = dews2.localize.get("\uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.", "dews_\uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");
        }
      }
      if (!userOptions.fillWidth) {
        innerOptions.fillWidth = userOptions.fillWidth;
        innerOptions.display.fitStyle = "none";
      }
      if ($.type(userOptions.resizable) === "boolean") {
        innerOptions.display.columnResizable = userOptions.resizable;
      }
      if (innerOptions._gridType === "GRID" && $.type(userOptions.editingMergedRow) !== "undefined") {
        innerOptions.display.editItemMerging = userOptions.editingMergedRow;
      }
      if (userOptions.styles !== void 0 && $.type(userOptions.styles.height) !== "undefined") {
        if ($.type(userOptions.styles.height) === "number") {
          innerOptions.display.minHeight = userOptions.styles.height;
          innerOptions.display.rowHeight = userOptions.styles.height;
          innerOptions.header.height = userOptions.styles.height;
          innerOptions.header.minHeight = userOptions.styles.height;
          innerOptions.footer.height = userOptions.styles.height;
          innerOptions.footer.minHeight = userOptions.styles.height;
        } else {
          innerOptions.display.rowHeight = $.type(userOptions.styles.height.row) === "undefined" ? innerOptions.display.rowHeight : userOptions.styles.height.row;
          innerOptions.header.height = $.type(userOptions.styles.height.header) === "undefined" ? innerOptions.header.height : userOptions.styles.height.header;
          innerOptions.footer.height = $.type(userOptions.styles.height.footer) === "undefined" ? innerOptions.footer.height : userOptions.styles.height.footer;
          innerOptions.display.minHeight = innerOptions.display.rowHeight;
          innerOptions.header.minHeight = innerOptions.header.height;
          innerOptions.footer.minHeight = innerOptions.footer.height;
        }
      }
      if (typeof userOptions.multiFooterCnt === "number") {
        innerOptions.multiFooterCnt = userOptions.multiFooterCnt;
      }
      if (typeof userOptions.shiftCheck === "boolean") {
        innerOptions.shiftCheck = userOptions.shiftCheck;
      }
      if (typeof userOptions.groupHeaderTemplate === "string") {
        innerOptions.groupHeaderTemplate = userOptions.groupHeaderTemplate;
      }
      if (typeof userOptions.groupHeaderColumn === "string") {
        innerOptions.groupHeaderColumn = userOptions.groupHeaderColumn;
      }
      if (userOptions.group !== void 0) {
        innerOptions.group = userOptions.group;
      }
      if (userOptions.fixed !== void 0) {
        innerOptions.fixed.colCount = userOptions.fixed.colCount;
        innerOptions.fixed.rightColCount = userOptions.fixed.rightColCount;
        innerOptions.fixed.resizable = userOptions.fixed.resizable;
      }
      if (userOptions.display !== void 0 && userOptions.display.rowHeight !== void 0) {
        innerOptions.display.rowHeight = userOptions.display.rowHeight;
      }
      if (userOptions.height !== void 0) {
        innerOptions.height = userOptions.height;
      }
      if (userOptions.pasteMode === "cell") {
        innerOptions.paste.singleMode = true;
      }
      if (userOptions.selectionMode === "cell") {
        innerOptions.select.style = "none";
      }
      if (typeof userOptions.filter === "boolean") {
        innerOptions.filter.use = userOptions.filter;
      } else if (_typeof(userOptions.filter) === "object") {
        if (userOptions.filter.iconVisible) {
          innerOptions.filtering.handleImages = {
            none: dews2._environments.scriptBase + "realgrid/assets/ico-grid-filter-off.png",
            fill: dews2._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png",
            hoveredNone: dews2._environments.scriptBase + "realgrid/assets/ico-grid-filter-off.png",
            hoveredFill: dews2._environments.scriptBase + "realgrid/assets/ico-grid-filter-on.png"
          };
        }
      }
      this._filterManager.optionConvert(userOptions.filter);
      if ($.type(userOptions.note) !== "undefined") {
        innerOptions.note = userOptions.note;
      }
      innerOptions.gridStyle = this._styleCreator.setGridStyles(userOptions.styles, this._styleCreator.gridStyle);
      this._columnAdaptor = new ColumnAdaptor(userOptions, innerOptions);
      this._columnAdaptor._filterManager = this._filterManager;
      this._columnAdaptor._columnRenderer = this._columnRenderer;
      this._columnAdaptor._gridNote = this._gridNote;
      this._columnAdaptor._colorLine = this._colorLine;
      this._columnAdaptor.initialize();
      if (innerOptions.grouping) {
        innerOptions.display.rowHeight = innerOptions.display.minHeight * innerOptions.maxGroupCol;
      }
      if (innerOptions._gridType === "GRID" && userOptions.dataSource && userOptions.dataSource.options.group) {
        innerOptions.group = userOptions.dataSource.options.group;
      }
      if (innerOptions._gridType === "TREEGRID" && userOptions.dataSource) {
        innerOptions.dataSource.options.imageField = userOptions.imageField || "";
      }
      if (innerOptions.sorting.enabled && innerOptions.sorting.sort) {
        var sortField = [],dir = [],sortingOptions = innerOptions.sorting;
        if (Array.isArray(sortingOptions.sort)) {
          for (var i = 0; i < sortingOptions.sort.length; i++) {
            sortField.push(sortingOptions.sort[i].field);
            if (sortingOptions.sort[i].dir === "des") {
              dir.push("descending");
            } else {
              dir.push("ascending");
            }
          }
        } else {
          sortField.push(sortingOptions.sort.field);
          if (sortingOptions.sort.dir === "des") {
            dir.push("descending");
          } else {
            dir.push("ascending");
          }
        }
        innerOptions._sortOrderBy = {
          field: sortField,
          dir: dir
        };
      }
      var detailGrid = userOptions.detailGrid;
      if (detailGrid !== void 0 && detailGrid !== null) {
        var read = detailGrid.addedRowDataSourceRead;
        if (read !== void 0 && read !== null) {
          innerOptions.detailGrid.addedRowDataSourceRead = read;
        }
      }
      return innerOptions;
    };
    dews2.ui.grid.GridOptionAdaptor = GridOptionAdaptor;
  })(window.dews || {});
})();


(function () {
  // src/js/grid/customTheme/posco.js
  var setPOSCO = /*#__PURE__*/_createClass(function setPOSCO() {"use strict";_classCallCheck(this, setPOSCO);});

  setPOSCO.prototype.style = function () {
    return {
      body: {
        height: 24,
        paddingLeft: 10,
        paddingRight: 10,
        requiredBackground: "#f4fcfd",
        requiredFocusBackground: "#f4fcfd",
        selectedBackground: "#ff696969",
        checkedImg: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAMAAAC67D+PAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAABpUExURRVSoRNSohVRoBRSogBSpgBRpgBRpQ5cqx9nsQFTphJerJCz2Ja42gRVqAJUpzl5uh1msA9cq5G02cPW6jp5ugRVp5a4263H46C+3sHV6Tt6uwBQpSJpsq/I48vb7Tt6uhVgrR5msP///2A+C0oAAAADdFJOU4v1jJrT6kwAAAABYktHRCJdZVysAAAAB3RJTUUH5wMVBBwLkV5w7gAAAFFJREFUCNctzUcWgEAIA1AQBnvvjvX+l3TiM6u/IIGI5QsTsSLOlEkgi5NUAp1alhdlYFU3bdcPGjhO87JuHnT7cV6m+t3eD6qCMfMghv8X0QugKgMopiPBGAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0wMy0yMVQwNDoyODowNCswMDowMJOr+/0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjMtMDMtMjFUMDQ6Mjg6MDQrMDA6MDDi9kNBAAAAKHRFWHRkYXRlOnRpbWVzdGFtcAAyMDIzLTAzLTIxVDA0OjI4OjExKzAwOjAwK3FNpwAAAABJRU5ErkJggg==",
        unCheckImg: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKBAMAAAB/HNKOAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAASUExURdvh6+Hm7tzh6+Lm7v39/v///00AeYoAAAADdFJOU4v1jJrT6kwAAAABYktHRAX4b+nHAAAAB3RJTUUH5wMVBBwLkV5w7gAAAB9JREFUCNdjYDQ2NhZgEAkNDXVkMAWSwQRIiEqQLiEAiGkNKYmpiRAAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDMtMjFUMDQ6Mjg6MDMrMDA6MDBWDMVzAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTAzLTIxVDA0OjI4OjAzKzAwOjAwJ1F9zwAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyMy0wMy0yMVQwNDoyODoxMSswMDowMCtxTacAAAAASUVORK5CYII="
      },
      indicator: {
        head: {
          fontBold: false
        },
        fontBold: false,
        background: "#f0f0f0",
        hoveredBackground: "#f0f0f0",
        selectedBackground: "#f0f0f0",
        focusBorderColor: "#000000"
      },
      fixed: {
        paddingLeft: 10,
        paddingRight: 10
      },
      header: {
        height: 28,
        fontBold: false,
        paddingLeft: 10,
        paddingRight: 10,
        hoveredBackground: "rgba(67,144,244,0.1)",
        group: {
          paddingLeft: 10,
          paddingRight: 10
        },
        summary: {
          paddingLeft: 10,
          paddingRight: 10
        }
      },
      footer: {
        height: 28,
        paddingLeft: 10,
        paddingRight: 10
      },
      rowGroup: {
        footer: {
          paddingLeft: 10,
          paddingRight: 10
        }
      },
      scrollBar: {
        background: "#f1f1f1",
        thumb: "#c1c1c1",
        button: {
          background: "#f1f1f1"
        }
      },
      selection: {
        focusBorderColor: "",
        focusBackgroundColor: "",
        selectedBackground: "#000000"
      },
      tree: {
        expander: {
          figureBackground: "#1e52a0"
        }
      }
    };
  };
  setPOSCO.prototype.option = function () {
    return {
      checkBar: {
        width: 28,
        drawCheckBox: false,
        checkImageUrl: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAMAAAC67D+PAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAABpUExURRVSoRNSohVRoBRSogBSpgBRpgBRpQ5cqx9nsQFTphJerJCz2Ja42gRVqAJUpzl5uh1msA9cq5G02cPW6jp5ugRVp5a4263H46C+3sHV6Tt6uwBQpSJpsq/I48vb7Tt6uhVgrR5msP///2A+C0oAAAADdFJOU4v1jJrT6kwAAAABYktHRCJdZVysAAAAB3RJTUUH5wMVBBwLkV5w7gAAAFFJREFUCNctzUcWgEAIA1AQBnvvjvX+l3TiM6u/IIGI5QsTsSLOlEkgi5NUAp1alhdlYFU3bdcPGjhO87JuHnT7cV6m+t3eD6qCMfMghv8X0QugKgMopiPBGAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0wMy0yMVQwNDoyODowNCswMDowMJOr+/0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjMtMDMtMjFUMDQ6Mjg6MDQrMDA6MDDi9kNBAAAAKHRFWHRkYXRlOnRpbWVzdGFtcAAyMDIzLTAzLTIxVDA0OjI4OjExKzAwOjAwK3FNpwAAAABJRU5ErkJggg==",
        unCheckImageUrl: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKBAMAAAB/HNKOAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAASUExURdvh6+Hm7tzh6+Lm7v39/v///00AeYoAAAADdFJOU4v1jJrT6kwAAAABYktHRAX4b+nHAAAAB3RJTUUH5wMVBBwLkV5w7gAAAB9JREFUCNdjYDQ2NhZgEAkNDXVkMAWSwQRIiEqQLiEAiGkNKYmpiRAAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDMtMjFUMDQ6Mjg6MDMrMDA6MDBWDMVzAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTAzLTIxVDA0OjI4OjAzKzAwOjAwJ1F9zwAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyMy0wMy0yMVQwNDoyODoxMSswMDowMCtxTacAAAAASUVORK5CYII=",
        headCheckImageUrl: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAMAAAC67D+PAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAABpUExURRVSoRNSohVRoBRSogBSpgBRpgBRpQ5cqx9nsQFTphJerJCz2Ja42gRVqAJUpzl5uh1msA9cq5G02cPW6jp5ugRVp5a4263H46C+3sHV6Tt6uwBQpSJpsq/I48vb7Tt6uhVgrR5msP///2A+C0oAAAADdFJOU4v1jJrT6kwAAAABYktHRCJdZVysAAAAB3RJTUUH5wMVBBwLkV5w7gAAAFFJREFUCNctzUcWgEAIA1AQBnvvjvX+l3TiM6u/IIGI5QsTsSLOlEkgi5NUAp1alhdlYFU3bdcPGjhO87JuHnT7cV6m+t3eD6qCMfMghv8X0QugKgMopiPBGAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0wMy0yMVQwNDoyODowNCswMDowMJOr+/0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjMtMDMtMjFUMDQ6Mjg6MDQrMDA6MDDi9kNBAAAAKHRFWHRkYXRlOnRpbWVzdGFtcAAyMDIzLTAzLTIxVDA0OjI4OjExKzAwOjAwK3FNpwAAAABJRU5ErkJggg==",
        headUnCheckImageUrl: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKBAMAAAB/HNKOAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAASUExURdvh6+Hm7tzh6+Lm7v39/v///00AeYoAAAADdFJOU4v1jJrT6kwAAAABYktHRAX4b+nHAAAAB3RJTUUH5wMVBBwLkV5w7gAAAB9JREFUCNdjYDQ2NhZgEAkNDXVkMAWSwQRIiEqQLiEAiGkNKYmpiRAAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDMtMjFUMDQ6Mjg6MDMrMDA6MDBWDMVzAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTAzLTIxVDA0OjI4OjAzKzAwOjAwJ1F9zwAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyMy0wMy0yMVQwNDoyODoxMSswMDowMCtxTacAAAAASUVORK5CYII="
      },
      indicator: {
        headText: "NO"
      }
    };
  };

  // src/js/grid/util/dews.ui.grid.StyleCreator.js
  (function (dews) {
    var styleCreatorInstance;
    function StyleCreator() {
      this.theme = getTheme();
      this.gridStyle = {};
      this.gridStyle = this.changeGridStyle(this.theme);
      if (this.theme === "posco") {
        this.customStyle = new setPOSCO();
        this.gridStyle = $.extend(true, this.gridStyle, this.customStyle.style());
      }
      return this;
    }
    StyleCreator.getInstance = function () {
      if (!styleCreatorInstance) {
        styleCreatorInstance = new StyleCreator();
      }
      return styleCreatorInstance;
    };
    StyleCreator.prototype.setGridStyles = function (userOptionsStyles, gridStyle) {
      var styles = $.extend(true, {}, gridStyle);
      if ($.type(userOptionsStyles) !== "undefined") {
        if ($.type(userOptionsStyles.rowNo) !== "undefined") {
          styles.indicator.foreground = $.type(userOptionsStyles.rowNo.color) === "undefined" ? styles.indicator.foreground : userOptionsStyles.rowNo.color;
          styles.indicator.hoveredForeground = styles.indicator.foreground;
          styles.indicator.background = $.type(userOptionsStyles.rowNo.background) === "undefined" ? styles.indicator.background : userOptionsStyles.rowNo.background;
          styles.indicator.hoveredBackground = styles.indicator.background;
          styles.indicator.selectedBackground = $.type(userOptionsStyles.rowNo.selectedBackground) === "undefined" ? styles.indicator.selectedBackground : userOptionsStyles.rowNo.selectedBackground;
        }
        if ($.type(userOptionsStyles.cellBorder) !== "undefined") {
          var border = "";
          if ($.type(userOptionsStyles.cellBorder.color) !== "undefined") {
            border = userOptionsStyles.cellBorder.color + ", ";
          } else {
            border = styles.body.border.split(",")[0] + ", ";
          }
          if ($.type(userOptionsStyles.cellBorder.width) !== "undefined") {
            border += userOptionsStyles.cellBorder.width;
          } else {
            border += styles.body.border.split(",")[1];
          }
          styles.body.borderRight = border;
          styles.body.borderBottom = border;
        }
        if ($.type(userOptionsStyles.font) !== "undefined") {
          styles.body.fontFamily = $.type(userOptionsStyles.font.family) === "undefined" ? styles.body.fontFamily : userOptionsStyles.font.family;
          styles.body.fontSize = $.type(userOptionsStyles.font.size) === "undefined" ? styles.body.fontSize : userOptionsStyles.font.size;
          styles.body.fontBold = $.type(userOptionsStyles.font.bold) === "undefined" ? styles.body.fontBold : userOptionsStyles.font.bold;
        }
        if ($.type(userOptionsStyles.padding) !== "undefined") {
          styles.body.paddingTop = $.type(userOptionsStyles.padding.top) === "undefined" ? styles.body.paddingTop : userOptionsStyles.padding.top;
          styles.body.paddingBottom = $.type(userOptionsStyles.padding.bottom) === "undefined" ? styles.body.paddingBottom : userOptionsStyles.padding.bottom;
          styles.body.paddingLeft = $.type(userOptionsStyles.padding.left) === "undefined" ? styles.body.paddingLeft : userOptionsStyles.padding.left;
          styles.body.paddingRight = $.type(userOptionsStyles.padding.right) === "undefined" ? styles.body.paddingRight : userOptionsStyles.padding.right;
        }
        if ($.type(userOptionsStyles.verticalAlign) !== "undefined") {
          var position = "middle";
          switch (userOptionsStyles.verticalAlign.toLowerCase()) {
            case "top":
              position = "near";
              break;
            case "bottom":
              position = "far";
              break;}

          styles.body.lineAlignment = position;
        }
        styles.body.foreground = $.type(userOptionsStyles.color) === "undefined" ? styles.body.foreground : userOptionsStyles.color;
        styles.body.background = $.type(userOptionsStyles.background) === "undefined" ? styles.body.background : userOptionsStyles.background;
        if ($.type(userOptionsStyles.grid) !== "undefined") {
          styles.grid.background = $.type(userOptionsStyles.grid.background) === "undefined" ? styles.grid.background : userOptionsStyles.grid.background;
        }
      }
      return styles;
    };
    StyleCreator.prototype.changeGridStyle = function (theme) {
      var gridThemeColor = getGridThemeColor(theme);
      var themeColorOptions = {};
      if (Object.keys(this.gridStyle).length === 0) {
        themeColorOptions = $.extend(true, {}, gridThemeColor);
      } else {
        themeColorOptions = $.extend(true, this.gridStyle, gridThemeColor);
      }
      return {
        selectionBackground: themeColorOptions.selectionBackground,
        selectedBackground: themeColorOptions.selectedBackground,
        focusBackgroundColor: themeColorOptions.focusBackgroundColor,
        focusBorderColor: themeColorOptions.focusBorderColor,
        fontSize: themeColorOptions.fontSize,
        borderColor: themeColorOptions.borderColor,
        themeColorLight1: themeColorOptions.themeColorLight1,
        emphasizeColor1: "#fddada",
        emphasizeFontColor1: "#81153f",
        emphasizeColor2: "#ffe2c9",
        emphasizeFontColor2: "#71300b",
        emphasizeColor3: "#faecb8",
        emphasizeFontColor3: "#643B08",
        emphasizeColor4: "#e1f5c8",
        emphasizeFontColor4: "#274B00",
        emphasizeColor5: "#caf2e9",
        emphasizeFontColor5: "#005062",
        emphasizeColor6: "#c1eaf8",
        emphasizeFontColor6: "#045272",
        emphasizeColor7: "#c4dbff",
        emphasizeFontColor7: "#003972",
        emphasizeColor8: "#cbd2ff",
        emphasizeFontColor8: "#19207C",
        emphasizeColor9: "#e2d8ff",
        emphasizeFontColor9: "#451684",
        emphasizeColor10: "#f6deff",
        emphasizeFontColor10: "#6C1577",
        grid: {
          background: "#ffffff",
          iconLocation: "left",
          border: themeColorOptions.borderColor,
          iconAlignment: "center",
          borderBottom: themeColorOptions.borderColor,
          font: "Graphic",
          iconPadding: "0",
          fontSize: themeColorOptions.fontSize,
          selectedBackground: themeColorOptions.selectedBackground,
          contentFit: "auto",
          inactiveBackground: "#ffd3d3d3",
          iconOffset: "0",
          selectionDisplay: "mask",
          hoveredMaskBackground: "#ffff7000",
          hoveredMaskBorder: "#ffff0000,1",
          paddingRight: "2",
          paddingBottom: "2",
          paddingTop: "2",
          figureBackground: "#ff657082",
          selectedForeground: "#ffffffff",
          foreground: "#ff000000",
          inactiveForeground: "#ff808080",
          line: "#ffb7bdc7,1",
          textAlignment: "center",
          lineAlignment: "center",
          iconIndex: "0"
        },
        panel: {
          background: "#e7e7e7",
          paddingRight: "2",
          iconLocation: "left",
          border: themeColorOptions.borderColor,
          selectedForeground: "#ffffffff",
          iconAlignment: "center",
          foreground: "#404040",
          inactiveForeground: "#ff808080",
          borderBottom: themeColorOptions.borderColor,
          textAlignment: "near",
          fontSize: themeColorOptions.fontSize,
          selectedBackground: themeColorOptions.selectedBackground,
          lineAlignment: "center",
          inactiveBackground: "#ffd3d3d3",
          iconOffset: "0",
          selectionDisplay: "mask",
          hoveredMaskBorder: "#335292f7,1",
          iconPadding: "0",
          hoveredMaskBackground: "#1f5292f7",
          contentFit: "auto",
          paddingTop: "4",
          borderRight: themeColorOptions.borderColor,
          figureBackground: "#ff008800",
          paddingBottom: "5",
          iconIndex: "0"
        },
        body: {
          height: 32,
          checkedImg: dews._environments.scriptBase + "realgrid/assets/checked.png",
          unCheckImg: dews._environments.scriptBase + "realgrid/assets/uncheck.png",
          requiredBackground: "#fef4f4",
          readonlyBackground: "#f5f5f5",
          requiredFocusBackground: "#ffdede",
          readonlyFocusBackground: "#e2e2e2",
          background: "#ffffffff",
          iconLocation: "left",
          border: "#ffffffff,0",
          iconAlignment: "center",
          borderBottom: themeColorOptions.borderColor,
          font: "Graphic",
          borderTop: "#ffffffff,0",
          fontSize: themeColorOptions.fontSize,
          selectedBackground: themeColorOptions.selectedBackground,
          contentFit: "auto",
          inactiveBackground: "#ffd3d3d3",
          iconOffset: "0",
          selectionDisplay: "mask",
          iconPadding: "0",
          hoveredMaskBackground: "#1f5292f7",
          hoveredMaskBorder: "#335292f7,1",
          figureBackground: "#ff008800",
          paddingLeft: "8",
          paddingRight: "8",
          paddingBottom: "2",
          paddingTop: "2",
          selectedForeground: "#ffffffff",
          foreground: "#000000",
          inactiveForeground: "#ff808080",
          line: "#ffe1e1e1,1",
          textAlignment: "center",
          borderLeft: "#ffe1e1e1,0",
          lineAlignment: "center",
          borderRight: themeColorOptions.borderColor,
          iconIndex: "0",
          empty: {}
        },
        fixed: {
          background: "#ffffffff",
          iconLocation: "left",
          border: themeColorOptions.borderColor,
          iconAlignment: "center",
          borderBottom: themeColorOptions.borderColor,
          font: "Graphic",
          iconPadding: "0",
          selectedBackground: themeColorOptions.selectedBackground,
          contentFit: "auto",
          inactiveBackground: "#ffd3d3d3",
          iconOffset: "0",
          selectionDisplay: "mask",
          hoveredMaskBackground: "#1f5292f7",
          hoveredMaskBorder: "#335292f7,1",
          paddingLeft: "8",
          paddingRight: "8",
          paddingBottom: "0",
          paddingTop: "0",
          figureBackground: "#ff008800",
          selectedForeground: "#ffffffff",
          foreground: "#ff000000",
          inactiveForeground: "#ff808080",
          textAlignment: "center",
          lineAlignment: "center",
          borderRight: themeColorOptions.borderColor,
          iconIndex: "0",
          colBar: {
            background: "#a6a6a6",
            iconLocation: "left",
            border: "#a6a6a6,1",
            iconAlignment: "center",
            borderBottom: "#ff808080,1",
            font: "Graphic",
            iconPadding: "0",
            selectedBackground: themeColorOptions.selectedBackground,
            contentFit: "auto",
            inactiveBackground: "#ffd3d3d3",
            iconOffset: "0",
            selectionDisplay: "mask",
            hoveredMaskBackground: "#ffff7000",
            hoveredMaskBorder: "#ffff0000,1",
            paddingRight: "0",
            paddingBottom: "0",
            paddingTop: "0",
            figureBackground: "#ffe1e1e1",
            selectedForeground: "#ffffffff",
            foreground: "#ff000000",
            inactiveForeground: "#ff808080",
            textAlignment: "center",
            lineAlignment: "center",
            borderRight: "#a6a6a6,1",
            borderLeft: "#a6a6a6,1",
            iconIndex: "0"
          },
          rowBar: {
            background: "#ffffffff",
            iconLocation: "left",
            border: "#a6a6a6,1",
            iconAlignment: "center",
            borderBottom: "#ff808080,1",
            font: "Graphic",
            iconPadding: "0",
            selectedBackground: themeColorOptions.selectedBackground,
            contentFit: "auto",
            inactiveBackground: "#ffd3d3d3",
            iconOffset: "0",
            selectionDisplay: "mask",
            hoveredMaskBackground: "#ffff7000",
            hoveredMaskBorder: "#ffff0000,1",
            paddingRight: "0",
            paddingBottom: "0",
            paddingTop: "0",
            figureBackground: "#ffe1e1e1",
            selectedForeground: "#ffffffff",
            foreground: "#ff000000",
            inactiveForeground: "#ff808080",
            textAlignment: "center",
            lineAlignment: "center",
            borderRight: "#a6a6a6,1",
            borderLeft: "#a6a6a6,1",
            iconIndex: "0"
          }
        },
        header: {
          height: 32,
          background: "#f0f0f0",
          iconLocation: "left",
          border: "#ffffffff,0",
          iconAlignment: "center",
          borderBottom: themeColorOptions.borderColor,
          font: "Graphic",
          fontSize: themeColorOptions.fontSize,
          selectedBackground: "#fff0f0f0",
          contentFit: "auto",
          inactiveBackground: "#ffd3d3d3",
          iconOffset: "0",
          selectionDisplay: "mask",
          iconPadding: "0",
          hoveredMaskBackground: "#22002b5b",
          hoveredBackground: "#fff0f0f0",
          paddingTop: "2",
          fontBold: "true",
          figureBackground: "#ff008800",
          paddingBottom: "4",
          hoveredMaskBorder: "#ffff0000,1",
          paddingRight: "8",
          paddingLeft: "8",
          selectedForeground: "#ff000000",
          foreground: "#000000",
          inactiveForeground: "#ff808080",
          textAlignment: "center",
          borderLeft: "#ffffffff,0",
          lineAlignment: "center",
          borderRight: themeColorOptions.borderColor,
          iconIndex: "0",
          group: {
            background: "#fff0f0f0",
            iconLocation: "left",
            border: "#ffffffff,0",
            iconAlignment: "center",
            borderBottom: themeColorOptions.borderColor,
            font: "Graphic",
            fontSize: themeColorOptions.fontSize,
            borderTop: "#ffffffff,0",
            selectedBackground: "linear,#ffcad0d7,#ffb7bec7,90",
            contentFit: "auto",
            inactiveBackground: "#ffd3d3d3",
            iconOffset: "0",
            selectionDisplay: "mask",
            iconPadding: "0",
            hoveredMaskBackground: "#22002b5b",
            paddingTop: "2",
            fontBold: "true",
            figureBackground: "#ff008800",
            paddingBottom: "4",
            hoveredMaskBorder: "#ffff0000,1",
            paddingRight: "2",
            selectedForeground: "#ff000000",
            foreground: "#ff222530",
            inactiveForeground: "#ff808080",
            textAlignment: "center",
            borderLeft: "#ffffffff,0",
            lineAlignment: "center",
            borderRight: themeColorOptions.borderColor,
            iconIndex: "0"
          },
          summary: {
            height: 32,
            minHeight: 32,
            background: "#ffecdb",
            iconLocation: "left",
            border: "#f5d3b6,0",
            iconAlignment: "center",
            font: "Graphic",
            fontBold: "true",
            fontSize: themeColorOptions.fontSize,
            borderTop: "#f5d3b6,0",
            borderRight: "#f5d3b6,1",
            borderLeft: "#f5d3b6,0",
            borderBottom: "#f5d3b6,1",
            selectedBackground: themeColorOptions.selectedBackground,
            contentFit: "auto",
            inactiveBackground: "#ffd3d3d3",
            iconOffset: 2,
            selectionDisplay: "mask",
            iconPadding: "0",
            hoveredMaskBackground: "#1f5292f7",
            hoveredMaskBorder: "#335292f7,1",
            figureBackground: "#ff008800",
            paddingBottom: "1",
            paddingTop: "2",
            paddingRight: "5",
            paddingLeft: "5",
            selectedForeground: "#ffffffff",
            foreground: "#000000",
            inactiveForeground: "#ff808080",
            textAlignment: "near",
            lineAlignment: "center",
            iconIndex: "0"
          }
        },
        footer: {
          height: 32,
          background: "#ffecdb",
          iconLocation: "left",
          border: "#f5d3b6,0",
          iconAlignment: "center",
          font: "Graphic",
          fontBold: "true",
          fontSize: themeColorOptions.fontSize,
          borderTop: "#f5d3b6,1",
          borderRight: "#f5d3b6,1",
          borderLeft: "#f5d3b6,0",
          borderBottom: "#f5d3b6,0",
          selectedBackground: themeColorOptions.selectedBackground,
          contentFit: "auto",
          inactiveBackground: "#ffd3d3d3",
          iconOffset: "0",
          selectionDisplay: "mask",
          iconPadding: "0",
          hoveredMaskBackground: "#1f5292f7",
          hoveredMaskBorder: "#335292f7,1",
          figureBackground: "#ff008800",
          paddingBottom: "1",
          paddingTop: "2",
          paddingRight: "5",
          paddingLeft: "5",
          selectedForeground: "#ffffffff",
          foreground: "#000000",
          inactiveForeground: "#ff808080",
          textAlignment: "near",
          lineAlignment: "center",
          iconIndex: "0"
        },
        rowGroup: {
          header: {
            background: "#edf3f9",
            foreground: "#323e4a",
            iconLocation: "left",
            border: "#ffffffff,0",
            iconAlignment: "center",
            borderBottom: "#bdc7d1,1",
            borderTop: "#ff464c58,0",
            selectedBackground: themeColorOptions.selectedBackground,
            contentFit: "auto",
            inactiveBackground: "#ffd3d3d3",
            iconOffset: "0",
            selectionDisplay: "mask",
            iconPadding: "0",
            hoveredMaskBackground: "#1f5292f7",
            hoveredMaskBorder: "#335292f7,1",
            figureBackground: "#ff008800",
            paddingBottom: "2",
            paddingTop: "2",
            paddingRight: "2",
            selectedForeground: "#ffffffff",
            inactiveForeground: "#ff808080",
            textAlignment: "near",
            borderLeft: "#ffffffff,0",
            lineAlignment: "center",
            borderRight: "#bdc7d1,1",
            iconIndex: "0"
          },
          footer: {
            background: "#12ffbf00",
            iconLocation: "left",
            border: "#ffffffff,0",
            iconAlignment: "center",
            borderBottom: "#ffe1e1e1,1",
            font: "Graphic",
            borderTop: "#ffe1e1e1,0",
            selectedBackground: themeColorOptions.selectedBackground,
            contentFit: "auto",
            inactiveBackground: "#ffd3d3d3",
            iconOffset: "0",
            selectionDisplay: "mask",
            iconPadding: "0",
            hoveredMaskBackground: "#1f5292f7",
            hoveredMaskBorder: "#335292f7,1",
            figureBackground: "#ff008800",
            paddingBottom: "2",
            paddingTop: "2",
            paddingRight: "8",
            paddingLeft: "8",
            selectedForeground: "#ffffffff",
            foreground: "#ff000000",
            inactiveForeground: "#ff808080",
            textAlignment: "far",
            borderLeft: "#ffffffff,0",
            lineAlignment: "center",
            borderRight: "#ffe1e1e1,1",
            iconIndex: "0"
          },
          head: {
            background: "linear,#f0f0f0,#f0f0f0,90",
            iconLocation: "left",
            border: "#ffffffff,0",
            iconAlignment: "center",
            borderBottom: "#ffe1e1e1,1",
            font: "Graphic",
            borderTop: "#ffffffff,0",
            selectedBackground: themeColorOptions.selectedBackground,
            contentFit: "auto",
            inactiveBackground: "#ffd3d3d3",
            iconOffset: "0",
            selectionDisplay: "mask",
            iconPadding: "0",
            hoveredMaskBackground: "#22002b5b",
            hoveredMaskBorder: "#ffff0000,1",
            figureBackground: "#ff008800",
            paddingBottom: "2",
            paddingTop: "2",
            paddingRight: "2",
            selectedForeground: "#ffffffff",
            foreground: "#ff222530",
            inactiveForeground: "#ff808080",
            textAlignment: "center",
            borderLeft: "#ffffffff,0",
            lineAlignment: "center",
            borderRight: "#ffe1e1e1,1",
            iconIndex: "0"
          },
          foot: {
            background: "#ffecdb",
            iconLocation: "left",
            border: "#ffffffff,0",
            iconAlignment: "center",
            borderBottom: "#f5d3b6,0",
            font: "Graphic",
            borderTop: "#f5d3b6,1",
            selectedBackground: themeColorOptions.selectedBackground,
            contentFit: "auto",
            inactiveBackground: "#ffd3d3d3",
            iconOffset: "0",
            selectionDisplay: "mask",
            iconPadding: "0",
            hoveredMaskBackground: "#1f5292f7",
            hoveredMaskBorder: "#335292f7,1",
            figureBackground: "#ff008800",
            paddingBottom: "1",
            paddingTop: "2",
            paddingRight: "2",
            selectedForeground: "#ffffffff",
            foreground: "#ff222530",
            inactiveForeground: "#ff808080",
            textAlignment: "near",
            borderLeft: "#f5d3b6,0",
            lineAlignment: "center",
            borderRight: "#f5d3b6,1",
            iconIndex: "0"
          },
          headerBar: {
            background: "#eaf1f8",
            iconLocation: "left",
            border: "#ffffffff,0",
            iconAlignment: "center",
            borderBottom: "#ffffffff,0",
            font: "Graphic",
            borderTop: "#ffffffff,0",
            selectedBackground: themeColorOptions.selectedBackground,
            contentFit: "auto",
            inactiveBackground: "#ffd3d3d3",
            iconOffset: "0",
            selectionDisplay: "mask",
            iconPadding: "0",
            hoveredMaskBackground: "#1f5292f7",
            fontSize: "12",
            paddingTop: "2",
            figureBackground: "#586777",
            paddingBottom: "2",
            hoveredMaskBorder: "#335292f7,1",
            paddingRight: "2",
            selectedForeground: "#ffffffff",
            foreground: "#ffe2ecff",
            inactiveForeground: "#ff808080",
            textAlignment: "near",
            borderLeft: "#ffffffff,0",
            lineAlignment: "center",
            borderRight: "#ffffffff,0",
            iconIndex: "0"
          },
          footerBar: {
            background: "#ffd8dee6",
            iconLocation: "left",
            border: "#ffffffff,0",
            iconAlignment: "center",
            borderBottom: "#ff6e7b8c,0",
            font: "Graphic",
            borderTop: "#bdc7d1,1",
            selectedBackground: themeColorOptions.selectedBackground,
            contentFit: "auto",
            inactiveBackground: "#ffd3d3d3",
            iconOffset: "0",
            selectionDisplay: "mask",
            iconPadding: "0",
            hoveredMaskBackground: "#1f5292f7",
            hoveredMaskBorder: "#335292f7,1",
            figureBackground: "#ff008800",
            paddingBottom: "2",
            paddingTop: "2",
            paddingRight: "2",
            selectedForeground: "#ffffffff",
            foreground: "#ff000000",
            inactiveForeground: "#ff808080",
            textAlignment: "near",
            borderLeft: "#ffffffff,0",
            lineAlignment: "center",
            borderRight: "#bdc7d1,1",
            iconIndex: "0"
          },
          bar: {
            background: "#120055aa",
            iconLocation: "left",
            border: "#ffffffff,0",
            iconAlignment: "center",
            borderBottom: "#ff272d37,0",
            font: "Graphic",
            borderTop: "#ff464c58,0",
            selectedBackground: themeColorOptions.selectedBackground,
            contentFit: "auto",
            inactiveBackground: "#ffd3d3d3",
            iconOffset: "0",
            selectionDisplay: "mask",
            iconPadding: "0",
            hoveredMaskBackground: "#1f5292f7",
            fontSize: "11",
            paddingTop: "2",
            figureBackground: "#ff008800",
            paddingBottom: "2",
            hoveredMaskBorder: "#335292f7,1",
            paddingRight: "2",
            selectedForeground: "#ffffffff",
            foreground: "#ffe2ecff",
            inactiveForeground: "#ff808080",
            textAlignment: "near",
            borderLeft: "#ffffffff,0",
            lineAlignment: "center",
            borderRight: "#bdc7d1,1",
            iconIndex: "0"
          },
          panel: {
            background: "#f2f2f2",
            iconLocation: "left",
            border: "#bebebe,1",
            iconAlignment: "center",
            borderBottom: "#ffffffff,0",
            borderTop: "#ffffffff,0",
            selectedBackground: "#ecf4ff",
            contentFit: "auto",
            inactiveBackground: "#ecf4ff",
            iconOffset: "0",
            selectionDisplay: "mask",
            iconPadding: "0",
            hoveredBackground: "#ecf4ff",
            hoveredBorder: "#1c90fb,1",
            hoveredMaskBackground: "#ecf4ff",
            hoveredMaskBorder: "#1c90fb,1",
            figureBackground: "#ff008800",
            paddingBottom: "1",
            paddingTop: "1",
            paddingRight: "1",
            selectedForeground: "#ffffffff",
            foreground: "#404040",
            inactiveForeground: "#ff808080",
            line: "#666666,1",
            textAlignment: "center",
            borderLeft: "#ffffffff,0",
            lineAlignment: "center",
            borderRight: "#ffffffff,0",
            iconIndex: "0",
            fontBold: false
          }
        },
        indicator: {
          background: "#ffffffff",
          paddingRight: "2",
          iconLocation: "none",
          border: "#ff464b58,1",
          selectedForeground: "#ffffffff",
          iconAlignment: "center",
          foreground: "#ff222530",
          inactiveForeground: "#ff808080",
          borderBottom: themeColorOptions.borderColor,
          textAlignment: "center",
          fontSize: themeColorOptions.fontSize,
          selectedBackground: themeColorOptions.selectionBackground,
          lineAlignment: "center",
          inactiveBackground: "#edf8fe",
          iconOffset: "0",
          selectionDisplay: "mask",
          hoveredMaskBorder: "#ff000000,1",
          iconPadding: "0",
          hoveredMaskBackground: "#ffd1d5db",
          hoveredBackground: "#ffffffff",
          contentFit: "auto",
          paddingTop: "2",
          borderRight: themeColorOptions.borderColor,
          figureBackground: "#ff2f363f",
          paddingBottom: "2",
          iconIndex: "0",
          head: {
            paddingRight: "0",
            paddingLeft: "0",
            background: "#fff0f0f0",
            iconLocation: "left",
            border: "#ffff0000,1",
            iconAlignment: "center",
            borderBottom: themeColorOptions.borderColor,
            font: "Graphic",
            fontSize: themeColorOptions.fontSize,
            selectedBackground: themeColorOptions.selectedBackground,
            contentFit: "auto",
            inactiveBackground: "#ffd3d3d3",
            fontBold: true,
            iconOffset: "0",
            selectionDisplay: "mask",
            iconPadding: "0",
            hoveredMaskBackground: "#1f5292f7",
            hoveredMaskBorder: "#335292f7,1",
            figureBackground: "#ff008800",
            paddingBottom: "2",
            paddingTop: "2",
            selectedForeground: "#ffffffff",
            foreground: "#ff000000",
            inactiveForeground: "#ff808080",
            textAlignment: "center",
            borderLeft: "#e1e1e1,0",
            lineAlignment: "center",
            borderRight: themeColorOptions.borderColor,
            iconIndex: "0"
          },
          foot: {
            background: "#ffecdb",
            iconLocation: "left",
            border: "#f5d3b6,1",
            iconAlignment: "center",
            borderBottom: "#ff5d3b6,0",
            font: "Graphic",
            borderTop: "#f5d3b6,1",
            borderRight: "#f5d3b6, 1",
            fontSize: themeColorOptions.fontSize,
            selectedBackground: themeColorOptions.selectedBackground,
            contentFit: "auto",
            inactiveBackground: "#ffd3d3d3",
            iconOffset: "0",
            selectionDisplay: "mask",
            iconPadding: "0",
            hoveredMaskBackground: "#1f5292f7",
            hoveredMaskBorder: "#335292f7,1",
            figureBackground: "#ff2f363f",
            paddingBottom: "2",
            paddingTop: "2",
            paddingRight: "2",
            selectedForeground: "#ffffffff",
            foreground: "#ff000000",
            inactiveForeground: "#ff808080",
            textAlignment: "center",
            borderLeft: "#ffffffff,0",
            lineAlignment: "center",
            iconIndex: "0"
          }
        },
        checkBar: {
          background: "#ffffffff",
          iconLocation: "left",
          border: "#ff464b58,1",
          iconAlignment: "center",
          borderBottom: themeColorOptions.borderColor,
          font: "Graphic",
          iconPadding: "0",
          selectedBackground: themeColorOptions.selectedBackground,
          contentFit: "auto",
          inactiveBackground: "#ffd3d3d3",
          iconOffset: "0",
          selectionDisplay: "mask",
          hoveredMaskBackground: "#1f5292f7",
          hoveredMaskBorder: "#335292f7,1",
          paddingRight: "2",
          paddingBottom: "2",
          paddingTop: "2",
          figureBackground: "#ff4995ff",
          selectedForeground: "#ffffffff",
          foreground: "#ff555555",
          inactiveForeground: "#ff808080",
          textAlignment: "center",
          lineAlignment: "center",
          borderRight: themeColorOptions.borderColor,
          iconIndex: "0",
          head: {
            background: "#fff0f0f0",
            iconLocation: "left",
            border: "#ffff0000,1",
            iconAlignment: "center",
            borderBottom: themeColorOptions.borderColor,
            font: "Graphic",
            borderTop: "#ffffff, 0",
            selectedBackground: themeColorOptions.selectedBackground,
            contentFit: "auto",
            inactiveBackground: "#ffd3d3d3",
            iconOffset: "0",
            selectionDisplay: "mask",
            iconPadding: "0",
            hoveredMaskBackground: "#1f5292f7",
            hoveredMaskBorder: "#335292f7,1",
            figureBackground: "#ff4995ff",
            paddingBottom: "2",
            paddingTop: "2",
            paddingRight: "0",
            paddingLeft: "0",
            selectedForeground: "#ffffffff",
            foreground: "#ff000000",
            inactiveForeground: "#ff808080",
            textAlignment: "center",
            borderLeft: "#ffffffff,0",
            lineAlignment: "center",
            borderRight: themeColorOptions.borderColor,
            iconIndex: "0"
          },
          foot: {
            background: "#ffecdb",
            iconLocation: "left",
            border: "#f5d3b6,1",
            iconAlignment: "center",
            borderBottom: "#ffe1e1e1,0",
            font: "Graphic",
            borderTop: "#f5d3b6,1",
            selectedBackground: themeColorOptions.selectedBackground,
            contentFit: "auto",
            inactiveBackground: "#ffd3d3d3",
            iconOffset: "0",
            selectionDisplay: "mask",
            iconPadding: "0",
            hoveredMaskBackground: "#1f5292f7",
            hoveredMaskBorder: "#335292f7,1",
            figureBackground: "#ff008800",
            paddingBottom: "2",
            paddingTop: "2",
            paddingRight: "2",
            selectedForeground: "#ffffffff",
            foreground: "#ff000000",
            inactiveForeground: "#ff808080",
            textAlignment: "center",
            borderLeft: "#ffffffff,0",
            lineAlignment: "center",
            borderRight: "#f5d3b6,1",
            iconIndex: "0"
          }
        },
        statusBar: {
          background: "#ffffffff",
          iconLocation: "left",
          border: "#ff464b58,1",
          iconAlignment: "center",
          borderBottom: themeColorOptions.borderColor,
          font: "Graphic",
          iconPadding: "0",
          selectedBackground: themeColorOptions.selectedBackground,
          contentFit: "auto",
          inactiveBackground: themeColorOptions.selectedBackground,
          iconOffset: "0",
          selectionDisplay: "mask",
          hoveredMaskBackground: "#1f5292f7",
          hoveredMaskBorder: "#335292f7,1",
          paddingRight: "2",
          paddingBottom: "2",
          paddingTop: "2",
          figureBackground: "#ff008800",
          selectedForeground: "#ffffffff",
          foreground: "#ff000000",
          inactiveForeground: "#ff808080",
          textAlignment: "center",
          lineAlignment: "center",
          borderRight: themeColorOptions.borderColor,
          iconIndex: "0",
          head: {
            background: "#fff0f0f0",
            iconLocation: "left",
            border: "#ffff0000,1",
            iconAlignment: "center",
            borderBottom: themeColorOptions.borderColor,
            font: "Graphic",
            borderTop: "#ffffffff,0",
            selectedBackground: themeColorOptions.selectedBackground,
            contentFit: "auto",
            inactiveBackground: "#ffd3d3d3",
            iconOffset: "0",
            selectionDisplay: "mask",
            iconPadding: "0",
            hoveredMaskBackground: "#1f5292f7",
            hoveredMaskBorder: "#335292f7,1",
            figureBackground: "#ff008800",
            paddingBottom: "2",
            paddingTop: "2",
            paddingRight: "2",
            selectedForeground: "#ffffffff",
            foreground: "#ff000000",
            inactiveForeground: "#ff808080",
            textAlignment: "center",
            borderLeft: "#ffffffff,0",
            lineAlignment: "center",
            borderRight: themeColorOptions.borderColor,
            iconIndex: "0"
          },
          foot: {
            background: "#ffecdb",
            iconLocation: "left",
            border: "#f5d3b6,1",
            iconAlignment: "center",
            borderBottom: "#ffe1e1e1,0",
            font: "Graphic",
            borderTop: "#f5d3b6,1",
            selectedBackground: themeColorOptions.selectedBackground,
            contentFit: "auto",
            inactiveBackground: "#ffd3d3d3",
            iconOffset: "0",
            selectionDisplay: "mask",
            iconPadding: "0",
            hoveredMaskBackground: "#1f5292f7",
            hoveredMaskBorder: "#335292f7,1",
            figureBackground: "#ff008800",
            paddingBottom: "2",
            paddingTop: "2",
            paddingRight: "2",
            selectedForeground: "#ffffffff",
            foreground: "#ff000000",
            inactiveForeground: "#ff808080",
            textAlignment: "center",
            borderLeft: "#ffffffff,0",
            lineAlignment: "center",
            borderRight: "#f5d3b6,1",
            iconIndex: "0"
          }
        },
        selection: {
          focusBorderColor: themeColorOptions.focusBorderColor,
          focusBackgroundColor: themeColorOptions.focusBackgroundColor,
          background: themeColorOptions.selectionBackground,
          selectedBackground: themeColorOptions.selectedBackground,
          inactiveBackground: themeColorOptions.selectedBackground,
          border: themeColorOptions.selectionBorderColor + ",2px",
          foreground: "#ff000000",
          selectedForeground: "#ffffffff",
          inactiveForeground: "#ff808080",
          paddingLeft: 0,
          paddingRight: 0,
          paddingTop: 0,
          paddingBottom: 0,
          iconIndex: "0",
          iconLocation: "left",
          iconAlignment: "center",
          iconOffset: 0,
          iconPadding: 0,
          contentFit: "auto",
          selectionDisplay: "mask",
          hoveredMaskBackground: "#1f5292f7",
          focusBackground: "#ff000000",
          figureBackground: "#ff008800",
          figureInactiveBackground: "#ffd3d3d3"
        },
        tree: {
          expander: {
            figureBackground: themeColorOptions.focusBorderColor,
            paddingRight: 0
          }
        }
      };
    };
    function getTheme() {
      var currentTheme = "";
      var themeUrl = $.type(dews.theme) === "undefined" ? $('head link[data-role="dews-theme"]').attr("href") : dews.theme.getCurrentThemeUrl();
      var theme = $.isFunction(window.getThemes) ? window.getThemes() : "";
      if (theme && theme[0] && theme[0].colors) {
        $.each(theme[0].colors, function (idx, item) {
          if (themeUrl.match(item.name)) {
            currentTheme = item.name;
            return false;
          }
        });
      }
      return currentTheme;
    }
    function getGridThemeColor(theme) {
      var currentTheme = theme;
      var themeColor = {
        selectionBackground: "#161c90fb",
        selectedBackground: "#ff696969",
        selectionBorderColor: "#a0d6fe",
        focusBackgroundColor: "#e6f5ff",
        focusBorderColor: "#1c90fb",
        fontSize: 12,
        borderColor: "#ffe1e1e1,1",
        themeColorLight1: "#5eb5fd"
      };
      switch (currentTheme) {
        case "cyan":
          themeColor.selectionBackground = "#162ea5ad";
          themeColor.selectedBackground = "#ff2ea5ad";
          themeColor.selectionBorderColor = "#a2e6e6";
          themeColor.focusBackgroundColor = "#ebfaf9";
          themeColor.focusBorderColor = "#2ea5ad";
          themeColor.themeColorLight1 = "#5ed0d4";
          if (dews.theme && dews.theme.getCurrentThemeUrl && /hds/.test(dews.theme.getCurrentThemeUrl())) {
            themeColor.selectionBackground = "#163ababc";
            themeColor.selectedBackground = "#ff3ababc";
            themeColor.selectionBorderColor = "#d0f0f1";
            themeColor.focusBackgroundColor = "#ebf9f9";
            themeColor.focusBorderColor = "#3ababc";
            themeColor.themeColorLight1 = "#8adadb";
          }
          break;
        case "green":
          themeColor.selectionBackground = "#1631aa4d";
          themeColor.selectedBackground = "#ff31aa4d";
          themeColor.selectionBorderColor = "#a4e5af";
          themeColor.focusBackgroundColor = "#ebf9ed";
          themeColor.focusBorderColor = "#31aa4d";
          themeColor.themeColorLight1 = "#61d177";
          break;
        case "indigo":
          themeColor.selectionBackground = "#163c69dd";
          themeColor.selectedBackground = "#ff3c69dd";
          themeColor.selectionBorderColor = "#adc4f0";
          themeColor.focusBackgroundColor = "#e9f0fb";
          themeColor.focusBorderColor = "#3c69dd";
          themeColor.themeColorLight1 = "#7498e7";
          break;
        case "orange":
          themeColor.selectionBackground = "#16ec7813";
          themeColor.selectedBackground = "#ffec7813";
          themeColor.selectionBorderColor = "#facca3";
          themeColor.focusBackgroundColor = "#fef1e7";
          themeColor.focusBorderColor = "#ec7813";
          themeColor.themeColorLight1 = "#f7ad64";
          break;
        case "purple":
          themeColor.selectionBackground = "#167953c6";
          themeColor.selectedBackground = "#ff7953c6";
          themeColor.selectionBorderColor = "#c3b6e7";
          themeColor.focusBackgroundColor = "#efecf9";
          themeColor.focusBorderColor = "#7953c6";
          themeColor.themeColorLight1 = "#9d85d6";
          break;
        case "red":
          themeColor.selectionBackground = "#16e33e35";
          themeColor.selectedBackground = "#ffe33e35";
          themeColor.selectionBorderColor = "#f3aaaa";
          themeColor.focusBackgroundColor = "#fce9e9";
          themeColor.focusBorderColor = "#e33e35";
          themeColor.themeColorLight1 = "#eb716f";
          break;
        default:
          break;}

      return themeColor;
    }
    dews.ui.grid.StyleCreator = StyleCreator;
  })(window.dews || {});
})();


(function () {
  // src/js/grid/util/dews.ui.gridutil.js
  (function (dews) {
    dews = $.extend(true, dews, {
      ui: {
        gridUtil: {
          gridStyle: "",
          changeStyle: function changeStyle(opt) {
            var options = {};
            if (dews.ui.gridUtil.gridStyle === "") {
              options = $.extend(true, {}, opt);
            } else {
              options = $.extend(true, dews.ui.gridUtil.gridStyle, opt);
            }
            return {
              selectionBackground: options.selectionBackground,
              selectedBackground: options.selectedBackground,
              focusBackgroundColor: options.focusBackgroundColor,
              focusBorderColor: options.focusBorderColor,
              fontSize: options.fontSize,
              borderColor: options.borderColor,
              grid: {
                background: "#fafafa",
                iconLocation: "left",
                border: options.borderColor,
                iconAlignment: "center",
                borderBottom: options.borderColor,
                font: "Graphic",
                iconPadding: "0",
                fontSize: options.fontSize,
                selectedBackground: options.selectedBackground,
                contentFit: "auto",
                inactiveBackground: "#ffd3d3d3",
                iconOffset: "0",
                selectionDisplay: "mask",
                hoveredMaskBackground: "#ffff7000",
                hoveredMaskBorder: "#ffff0000,1",
                paddingRight: "2",
                paddingBottom: "2",
                paddingTop: "2",
                figureBackground: "#ff657082",
                selectedForeground: "#ffffffff",
                foreground: "#ff000000",
                inactiveForeground: "#ff808080",
                line: "#ffb7bdc7,1",
                textAlignment: "center",
                lineAlignment: "center",
                iconIndex: "0"
              },
              panel: {
                background: "#e7e7e7",
                paddingRight: "2",
                iconLocation: "left",
                border: options.borderColor,
                selectedForeground: "#ffffffff",
                iconAlignment: "center",
                foreground: "#404040",
                inactiveForeground: "#ff808080",
                borderBottom: options.borderColor,
                textAlignment: "near",
                fontSize: options.fontSize,
                selectedBackground: options.selectedBackground,
                lineAlignment: "center",
                inactiveBackground: "#ffd3d3d3",
                iconOffset: "0",
                selectionDisplay: "mask",
                hoveredMaskBorder: "#335292f7,1",
                iconPadding: "0",
                hoveredMaskBackground: "#1f5292f7",
                contentFit: "auto",
                paddingTop: "4",
                borderRight: options.borderColor,
                figureBackground: "#ff008800",
                paddingBottom: "5",
                iconIndex: "0"
              },
              body: {
                height: 32,
                checkedImg: dews._environments.scriptBase + "realgrid/assets/checked.png",
                unCheckImg: dews._environments.scriptBase + "realgrid/assets/uncheck.png",
                requiredBackground: "#fef4f4",
                readonlyBackground: "#f5f5f5",
                requiredFocusBackground: "#ffdede",
                readonlyFocusBackground: "#e2e2e2",
                background: "#ffffffff",
                iconLocation: "left",
                border: "#ffffffff,0",
                iconAlignment: "center",
                borderBottom: options.borderColor,
                font: "Graphic",
                borderTop: "#ffffffff,0",
                fontSize: options.fontSize,
                selectedBackground: options.selectedBackground,
                contentFit: "auto",
                inactiveBackground: "#ffd3d3d3",
                iconOffset: "0",
                selectionDisplay: "mask",
                iconPadding: "0",
                hoveredMaskBackground: "#1f5292f7",
                hoveredMaskBorder: "#335292f7,1",
                figureBackground: "#ff008800",
                paddingLeft: "8",
                paddingRight: "8",
                paddingBottom: "2",
                paddingTop: "2",
                selectedForeground: "#ffffffff",
                foreground: "#000000",
                inactiveForeground: "#ff808080",
                line: "#ffe1e1e1,1",
                textAlignment: "center",
                borderLeft: "#ffe1e1e1,0",
                lineAlignment: "center",
                borderRight: options.borderColor,
                iconIndex: "0",
                empty: {}
              },
              fixed: {
                background: "#ffffffff",
                iconLocation: "left",
                border: options.borderColor,
                iconAlignment: "center",
                borderBottom: options.borderColor,
                font: "Graphic",
                iconPadding: "0",
                selectedBackground: options.selectedBackground,
                contentFit: "auto",
                inactiveBackground: "#ffd3d3d3",
                iconOffset: "0",
                selectionDisplay: "mask",
                hoveredMaskBackground: "#1f5292f7",
                hoveredMaskBorder: "#335292f7,1",
                paddingLeft: "8",
                paddingRight: "8",
                paddingBottom: "0",
                paddingTop: "0",
                figureBackground: "#ff008800",
                selectedForeground: "#ffffffff",
                foreground: "#ff000000",
                inactiveForeground: "#ff808080",
                textAlignment: "center",
                lineAlignment: "center",
                borderRight: options.borderColor,
                iconIndex: "0",
                colBar: {
                  background: "#a6a6a6",
                  iconLocation: "left",
                  border: "#a6a6a6,1",
                  iconAlignment: "center",
                  borderBottom: "#ff808080,1",
                  font: "Graphic",
                  iconPadding: "0",
                  selectedBackground: options.selectedBackground,
                  contentFit: "auto",
                  inactiveBackground: "#ffd3d3d3",
                  iconOffset: "0",
                  selectionDisplay: "mask",
                  hoveredMaskBackground: "#ffff7000",
                  hoveredMaskBorder: "#ffff0000,1",
                  paddingRight: "0",
                  paddingBottom: "0",
                  paddingTop: "0",
                  figureBackground: "#ffe1e1e1",
                  selectedForeground: "#ffffffff",
                  foreground: "#ff000000",
                  inactiveForeground: "#ff808080",
                  textAlignment: "center",
                  lineAlignment: "center",
                  borderRight: "#a6a6a6,1",
                  borderLeft: "#a6a6a6,1",
                  iconIndex: "0"
                },
                rowBar: {
                  background: "#ffffffff",
                  iconLocation: "left",
                  border: "#a6a6a6,1",
                  iconAlignment: "center",
                  borderBottom: "#ff808080,1",
                  font: "Graphic",
                  iconPadding: "0",
                  selectedBackground: options.selectedBackground,
                  contentFit: "auto",
                  inactiveBackground: "#ffd3d3d3",
                  iconOffset: "0",
                  selectionDisplay: "mask",
                  hoveredMaskBackground: "#ffff7000",
                  hoveredMaskBorder: "#ffff0000,1",
                  paddingRight: "0",
                  paddingBottom: "0",
                  paddingTop: "0",
                  figureBackground: "#ffe1e1e1",
                  selectedForeground: "#ffffffff",
                  foreground: "#ff000000",
                  inactiveForeground: "#ff808080",
                  textAlignment: "center",
                  lineAlignment: "center",
                  borderRight: "#a6a6a6,1",
                  borderLeft: "#a6a6a6,1",
                  iconIndex: "0"
                }
              },
              header: {
                height: 32,
                background: "#f0f0f0",
                iconLocation: "left",
                border: "#ffffffff,0",
                iconAlignment: "center",
                borderBottom: options.borderColor,
                font: "Graphic",
                fontSize: options.fontSize,
                selectedBackground: "#fff0f0f0",
                contentFit: "auto",
                inactiveBackground: "#ffd3d3d3",
                iconOffset: "0",
                selectionDisplay: "mask",
                iconPadding: "0",
                hoveredMaskBackground: "#22002b5b",
                hoveredBackground: "#fff0f0f0",
                paddingTop: "2",
                fontBold: "true",
                figureBackground: "#ff008800",
                paddingBottom: "4",
                hoveredMaskBorder: "#ffff0000,1",
                paddingRight: "8",
                paddingLeft: "8",
                selectedForeground: "#ff000000",
                foreground: "#000000",
                inactiveForeground: "#ff808080",
                textAlignment: "center",
                borderLeft: "#ffffffff,0",
                lineAlignment: "center",
                borderRight: options.borderColor,
                iconIndex: "0",
                group: {
                  background: "#fff0f0f0",
                  iconLocation: "left",
                  border: "#ffffffff,0",
                  iconAlignment: "center",
                  borderBottom: options.borderColor,
                  font: "Graphic",
                  fontSize: options.fontSize,
                  borderTop: "#ffffffff,0",
                  selectedBackground: "linear,#ffcad0d7,#ffb7bec7,90",
                  contentFit: "auto",
                  inactiveBackground: "#ffd3d3d3",
                  iconOffset: "0",
                  selectionDisplay: "mask",
                  iconPadding: "0",
                  hoveredMaskBackground: "#22002b5b",
                  paddingTop: "2",
                  fontBold: "true",
                  figureBackground: "#ff008800",
                  paddingBottom: "4",
                  hoveredMaskBorder: "#ffff0000,1",
                  paddingRight: "2",
                  selectedForeground: "#ff000000",
                  foreground: "#ff222530",
                  inactiveForeground: "#ff808080",
                  textAlignment: "center",
                  borderLeft: "#ffffffff,0",
                  lineAlignment: "center",
                  borderRight: options.borderColor,
                  iconIndex: "0"
                }
              },
              footer: {
                height: 32,
                background: "#ffecdb",
                iconLocation: "left",
                border: "#f5d3b6,0",
                iconAlignment: "center",
                font: "Graphic",
                fontBold: "true",
                fontSize: options.fontSize,
                borderTop: "#f5d3b6,1",
                borderRight: "#f5d3b6,1",
                borderLeft: "#f5d3b6,0",
                borderBottom: "#f5d3b6,0",
                selectedBackground: options.selectedBackground,
                contentFit: "auto",
                inactiveBackground: "#ffd3d3d3",
                iconOffset: "0",
                selectionDisplay: "mask",
                iconPadding: "0",
                hoveredMaskBackground: "#1f5292f7",
                hoveredMaskBorder: "#335292f7,1",
                figureBackground: "#ff008800",
                paddingBottom: "1",
                paddingTop: "2",
                paddingRight: "5",
                paddingLeft: "5",
                selectedForeground: "#ffffffff",
                foreground: "#000000",
                inactiveForeground: "#ff808080",
                textAlignment: "near",
                lineAlignment: "center",
                iconIndex: "0"
              },
              rowGroup: {
                header: {
                  background: "#edf3f9",
                  foreground: "#323e4a",
                  iconLocation: "left",
                  border: "#ffffffff,0",
                  iconAlignment: "center",
                  borderBottom: "#bdc7d1,1",
                  borderTop: "#ff464c58,0",
                  selectedBackground: options.selectedBackground,
                  contentFit: "auto",
                  inactiveBackground: "#ffd3d3d3",
                  iconOffset: "0",
                  selectionDisplay: "mask",
                  iconPadding: "0",
                  hoveredMaskBackground: "#1f5292f7",
                  hoveredMaskBorder: "#335292f7,1",
                  figureBackground: "#ff008800",
                  paddingBottom: "2",
                  paddingTop: "2",
                  paddingRight: "2",
                  selectedForeground: "#ffffffff",
                  inactiveForeground: "#ff808080",
                  textAlignment: "near",
                  borderLeft: "#ffffffff,0",
                  lineAlignment: "center",
                  borderRight: "#bdc7d1,1",
                  iconIndex: "0"
                },
                footer: {
                  background: "#12ffbf00",
                  iconLocation: "left",
                  border: "#ffffffff,0",
                  iconAlignment: "center",
                  borderBottom: "#ffe1e1e1,1",
                  font: "Graphic",
                  borderTop: "#ffe1e1e1,0",
                  selectedBackground: options.selectedBackground,
                  contentFit: "auto",
                  inactiveBackground: "#ffd3d3d3",
                  iconOffset: "0",
                  selectionDisplay: "mask",
                  iconPadding: "0",
                  hoveredMaskBackground: "#1f5292f7",
                  hoveredMaskBorder: "#335292f7,1",
                  figureBackground: "#ff008800",
                  paddingBottom: "2",
                  paddingTop: "2",
                  paddingRight: "8",
                  paddingLeft: "8",
                  selectedForeground: "#ffffffff",
                  foreground: "#ff000000",
                  inactiveForeground: "#ff808080",
                  textAlignment: "far",
                  borderLeft: "#ffffffff,0",
                  lineAlignment: "center",
                  borderRight: "#ffe1e1e1,1",
                  iconIndex: "0"
                },
                head: {
                  background: "linear,#f0f0f0,#f0f0f0,90",
                  iconLocation: "left",
                  border: "#ffffffff,0",
                  iconAlignment: "center",
                  borderBottom: "#ffe1e1e1,1",
                  font: "Graphic",
                  borderTop: "#ffffffff,0",
                  selectedBackground: options.selectedBackground,
                  contentFit: "auto",
                  inactiveBackground: "#ffd3d3d3",
                  iconOffset: "0",
                  selectionDisplay: "mask",
                  iconPadding: "0",
                  hoveredMaskBackground: "#22002b5b",
                  hoveredMaskBorder: "#ffff0000,1",
                  figureBackground: "#ff008800",
                  paddingBottom: "2",
                  paddingTop: "2",
                  paddingRight: "2",
                  selectedForeground: "#ffffffff",
                  foreground: "#ff222530",
                  inactiveForeground: "#ff808080",
                  textAlignment: "center",
                  borderLeft: "#ffffffff,0",
                  lineAlignment: "center",
                  borderRight: "#ffe1e1e1,1",
                  iconIndex: "0"
                },
                foot: {
                  background: "#ffecdb",
                  iconLocation: "left",
                  border: "#ffffffff,0",
                  iconAlignment: "center",
                  borderBottom: "#f5d3b6,0",
                  font: "Graphic",
                  borderTop: "#f5d3b6,1",
                  selectedBackground: options.selectedBackground,
                  contentFit: "auto",
                  inactiveBackground: "#ffd3d3d3",
                  iconOffset: "0",
                  selectionDisplay: "mask",
                  iconPadding: "0",
                  hoveredMaskBackground: "#1f5292f7",
                  hoveredMaskBorder: "#335292f7,1",
                  figureBackground: "#ff008800",
                  paddingBottom: "1",
                  paddingTop: "2",
                  paddingRight: "2",
                  selectedForeground: "#ffffffff",
                  foreground: "#ff222530",
                  inactiveForeground: "#ff808080",
                  textAlignment: "near",
                  borderLeft: "#f5d3b6,0",
                  lineAlignment: "center",
                  borderRight: "#f5d3b6,1",
                  iconIndex: "0"
                },
                headerBar: {
                  background: "#eaf1f8",
                  iconLocation: "left",
                  border: "#ffffffff,0",
                  iconAlignment: "center",
                  borderBottom: "#ffffffff,0",
                  font: "Graphic",
                  borderTop: "#ffffffff,0",
                  selectedBackground: options.selectedBackground,
                  contentFit: "auto",
                  inactiveBackground: "#ffd3d3d3",
                  iconOffset: "0",
                  selectionDisplay: "mask",
                  iconPadding: "0",
                  hoveredMaskBackground: "#1f5292f7",
                  fontSize: "12",
                  paddingTop: "2",
                  figureBackground: "#586777",
                  paddingBottom: "2",
                  hoveredMaskBorder: "#335292f7,1",
                  paddingRight: "2",
                  selectedForeground: "#ffffffff",
                  foreground: "#ffe2ecff",
                  inactiveForeground: "#ff808080",
                  textAlignment: "near",
                  borderLeft: "#ffffffff,0",
                  lineAlignment: "center",
                  borderRight: "#ffffffff,0",
                  iconIndex: "0"
                },
                footerBar: {
                  background: "#ffd8dee6",
                  iconLocation: "left",
                  border: "#ffffffff,0",
                  iconAlignment: "center",
                  borderBottom: "#ff6e7b8c,0",
                  font: "Graphic",
                  borderTop: "#bdc7d1,1",
                  selectedBackground: options.selectedBackground,
                  contentFit: "auto",
                  inactiveBackground: "#ffd3d3d3",
                  iconOffset: "0",
                  selectionDisplay: "mask",
                  iconPadding: "0",
                  hoveredMaskBackground: "#1f5292f7",
                  hoveredMaskBorder: "#335292f7,1",
                  figureBackground: "#ff008800",
                  paddingBottom: "2",
                  paddingTop: "2",
                  paddingRight: "2",
                  selectedForeground: "#ffffffff",
                  foreground: "#ff000000",
                  inactiveForeground: "#ff808080",
                  textAlignment: "near",
                  borderLeft: "#ffffffff,0",
                  lineAlignment: "center",
                  borderRight: "#bdc7d1,1",
                  iconIndex: "0"
                },
                bar: {
                  background: "#120055aa",
                  iconLocation: "left",
                  border: "#ffffffff,0",
                  iconAlignment: "center",
                  borderBottom: "#ff272d37,0",
                  font: "Graphic",
                  borderTop: "#ff464c58,0",
                  selectedBackground: options.selectedBackground,
                  contentFit: "auto",
                  inactiveBackground: "#ffd3d3d3",
                  iconOffset: "0",
                  selectionDisplay: "mask",
                  iconPadding: "0",
                  hoveredMaskBackground: "#1f5292f7",
                  fontSize: "11",
                  paddingTop: "2",
                  figureBackground: "#ff008800",
                  paddingBottom: "2",
                  hoveredMaskBorder: "#335292f7,1",
                  paddingRight: "2",
                  selectedForeground: "#ffffffff",
                  foreground: "#ffe2ecff",
                  inactiveForeground: "#ff808080",
                  textAlignment: "near",
                  borderLeft: "#ffffffff,0",
                  lineAlignment: "center",
                  borderRight: "#bdc7d1,1",
                  iconIndex: "0"
                },
                panel: {
                  background: "#f2f2f2",
                  iconLocation: "left",
                  border: "#bebebe,1",
                  iconAlignment: "center",
                  borderBottom: "#ffffffff,0",
                  borderTop: "#ffffffff,0",
                  selectedBackground: "#ecf4ff",
                  contentFit: "auto",
                  inactiveBackground: "#ecf4ff",
                  iconOffset: "0",
                  selectionDisplay: "mask",
                  iconPadding: "0",
                  hoveredBackground: "#ecf4ff",
                  hoveredBorder: "#1c90fb,1",
                  hoveredMaskBackground: "#ecf4ff",
                  hoveredMaskBorder: "#1c90fb,1",
                  figureBackground: "#ff008800",
                  paddingBottom: "1",
                  paddingTop: "1",
                  paddingRight: "1",
                  selectedForeground: "#ffffffff",
                  foreground: "#404040",
                  inactiveForeground: "#ff808080",
                  line: "#666666,1",
                  textAlignment: "center",
                  borderLeft: "#ffffffff,0",
                  lineAlignment: "center",
                  borderRight: "#ffffffff,0",
                  iconIndex: "0",
                  fontBold: false
                }
              },
              indicator: {
                background: "#ffffffff",
                paddingRight: "2",
                iconLocation: "none",
                border: "#ff464b58,1",
                selectedForeground: "#ffffffff",
                iconAlignment: "center",
                foreground: "#ff222530",
                inactiveForeground: "#ff808080",
                borderBottom: options.borderColor,
                textAlignment: "center",
                fontSize: options.fontSize,
                selectedBackground: options.selectionBackground,
                lineAlignment: "center",
                inactiveBackground: "#edf8fe",
                iconOffset: "0",
                selectionDisplay: "mask",
                hoveredMaskBorder: "#ff000000,1",
                iconPadding: "0",
                hoveredMaskBackground: "#ffd1d5db",
                hoveredBackground: "#ffffffff",
                contentFit: "auto",
                paddingTop: "2",
                borderRight: options.borderColor,
                figureBackground: "#ff2f363f",
                paddingBottom: "2",
                iconIndex: "0",
                head: {
                  paddingRight: "0",
                  paddingLeft: "0",
                  background: "#fff0f0f0",
                  iconLocation: "left",
                  border: "#ffff0000,1",
                  iconAlignment: "center",
                  borderBottom: options.borderColor,
                  font: "Graphic",
                  fontSize: options.fontSize,
                  selectedBackground: options.selectedBackground,
                  contentFit: "auto",
                  inactiveBackground: "#ffd3d3d3",
                  fontBold: true,
                  iconOffset: "0",
                  selectionDisplay: "mask",
                  iconPadding: "0",
                  hoveredMaskBackground: "#1f5292f7",
                  hoveredMaskBorder: "#335292f7,1",
                  figureBackground: "#ff008800",
                  paddingBottom: "2",
                  paddingTop: "2",
                  selectedForeground: "#ffffffff",
                  foreground: "#ff000000",
                  inactiveForeground: "#ff808080",
                  textAlignment: "center",
                  borderLeft: "#e1e1e1,0",
                  lineAlignment: "center",
                  borderRight: options.borderColor,
                  iconIndex: "0"
                },
                foot: {
                  background: "#ffecdb",
                  iconLocation: "left",
                  border: "#f5d3b6,1",
                  iconAlignment: "center",
                  borderBottom: "#ff5d3b6,0",
                  font: "Graphic",
                  borderTop: "#f5d3b6,1",
                  borderRight: "#f5d3b6, 1",
                  fontSize: options.fontSize,
                  selectedBackground: options.selectedBackground,
                  contentFit: "auto",
                  inactiveBackground: "#ffd3d3d3",
                  iconOffset: "0",
                  selectionDisplay: "mask",
                  iconPadding: "0",
                  hoveredMaskBackground: "#1f5292f7",
                  hoveredMaskBorder: "#335292f7,1",
                  figureBackground: "#ff2f363f",
                  paddingBottom: "2",
                  paddingTop: "2",
                  paddingRight: "2",
                  selectedForeground: "#ffffffff",
                  foreground: "#ff000000",
                  inactiveForeground: "#ff808080",
                  textAlignment: "center",
                  borderLeft: "#ffffffff,0",
                  lineAlignment: "center",
                  iconIndex: "0"
                }
              },
              checkBar: {
                background: "#ffffffff",
                iconLocation: "left",
                border: "#ff464b58,1",
                iconAlignment: "center",
                borderBottom: options.borderColor,
                font: "Graphic",
                iconPadding: "0",
                selectedBackground: options.selectedBackground,
                contentFit: "auto",
                inactiveBackground: "#ffd3d3d3",
                iconOffset: "0",
                selectionDisplay: "mask",
                hoveredMaskBackground: "#1f5292f7",
                hoveredMaskBorder: "#335292f7,1",
                paddingRight: "2",
                paddingBottom: "2",
                paddingTop: "2",
                figureBackground: "#ff4995ff",
                selectedForeground: "#ffffffff",
                foreground: "#ff555555",
                inactiveForeground: "#ff808080",
                textAlignment: "center",
                lineAlignment: "center",
                borderRight: options.borderColor,
                iconIndex: "0",
                head: {
                  background: "#fff0f0f0",
                  iconLocation: "left",
                  border: "#ffff0000,1",
                  iconAlignment: "center",
                  borderBottom: options.borderColor,
                  font: "Graphic",
                  borderTop: "#ffffff, 0",
                  selectedBackground: options.selectedBackground,
                  contentFit: "auto",
                  inactiveBackground: "#ffd3d3d3",
                  iconOffset: "0",
                  selectionDisplay: "mask",
                  iconPadding: "0",
                  hoveredMaskBackground: "#1f5292f7",
                  hoveredMaskBorder: "#335292f7,1",
                  figureBackground: "#ff4995ff",
                  paddingBottom: "2",
                  paddingTop: "2",
                  paddingRight: "0",
                  paddingLeft: "0",
                  selectedForeground: "#ffffffff",
                  foreground: "#ff000000",
                  inactiveForeground: "#ff808080",
                  textAlignment: "center",
                  borderLeft: "#ffffffff,0",
                  lineAlignment: "center",
                  borderRight: options.borderColor,
                  iconIndex: "0"
                },
                foot: {
                  background: "#ffecdb",
                  iconLocation: "left",
                  border: "#f5d3b6,1",
                  iconAlignment: "center",
                  borderBottom: "#ffe1e1e1,0",
                  font: "Graphic",
                  borderTop: "#f5d3b6,1",
                  selectedBackground: options.selectedBackground,
                  contentFit: "auto",
                  inactiveBackground: "#ffd3d3d3",
                  iconOffset: "0",
                  selectionDisplay: "mask",
                  iconPadding: "0",
                  hoveredMaskBackground: "#1f5292f7",
                  hoveredMaskBorder: "#335292f7,1",
                  figureBackground: "#ff008800",
                  paddingBottom: "2",
                  paddingTop: "2",
                  paddingRight: "2",
                  selectedForeground: "#ffffffff",
                  foreground: "#ff000000",
                  inactiveForeground: "#ff808080",
                  textAlignment: "center",
                  borderLeft: "#ffffffff,0",
                  lineAlignment: "center",
                  borderRight: "#f5d3b6,1",
                  iconIndex: "0"
                }
              },
              statusBar: {
                background: "#ffffffff",
                iconLocation: "left",
                border: "#ff464b58,1",
                iconAlignment: "center",
                borderBottom: options.borderColor,
                font: "Graphic",
                iconPadding: "0",
                selectedBackground: options.selectedBackground,
                contentFit: "auto",
                inactiveBackground: options.selectedBackground,
                iconOffset: "0",
                selectionDisplay: "mask",
                hoveredMaskBackground: "#1f5292f7",
                hoveredMaskBorder: "#335292f7,1",
                paddingRight: "2",
                paddingBottom: "2",
                paddingTop: "2",
                figureBackground: "#ff008800",
                selectedForeground: "#ffffffff",
                foreground: "#ff000000",
                inactiveForeground: "#ff808080",
                textAlignment: "center",
                lineAlignment: "center",
                borderRight: options.borderColor,
                iconIndex: "0",
                head: {
                  background: "#fff0f0f0",
                  iconLocation: "left",
                  border: "#ffff0000,1",
                  iconAlignment: "center",
                  borderBottom: options.borderColor,
                  font: "Graphic",
                  borderTop: "#ffffffff,0",
                  selectedBackground: options.selectedBackground,
                  contentFit: "auto",
                  inactiveBackground: "#ffd3d3d3",
                  iconOffset: "0",
                  selectionDisplay: "mask",
                  iconPadding: "0",
                  hoveredMaskBackground: "#1f5292f7",
                  hoveredMaskBorder: "#335292f7,1",
                  figureBackground: "#ff008800",
                  paddingBottom: "2",
                  paddingTop: "2",
                  paddingRight: "2",
                  selectedForeground: "#ffffffff",
                  foreground: "#ff000000",
                  inactiveForeground: "#ff808080",
                  textAlignment: "center",
                  borderLeft: "#ffffffff,0",
                  lineAlignment: "center",
                  borderRight: options.borderColor,
                  iconIndex: "0"
                },
                foot: {
                  background: "#ffecdb",
                  iconLocation: "left",
                  border: "#f5d3b6,1",
                  iconAlignment: "center",
                  borderBottom: "#ffe1e1e1,0",
                  font: "Graphic",
                  borderTop: "#f5d3b6,1",
                  selectedBackground: options.selectedBackground,
                  contentFit: "auto",
                  inactiveBackground: "#ffd3d3d3",
                  iconOffset: "0",
                  selectionDisplay: "mask",
                  iconPadding: "0",
                  hoveredMaskBackground: "#1f5292f7",
                  hoveredMaskBorder: "#335292f7,1",
                  figureBackground: "#ff008800",
                  paddingBottom: "2",
                  paddingTop: "2",
                  paddingRight: "2",
                  selectedForeground: "#ffffffff",
                  foreground: "#ff000000",
                  inactiveForeground: "#ff808080",
                  textAlignment: "center",
                  borderLeft: "#ffffffff,0",
                  lineAlignment: "center",
                  borderRight: "#f5d3b6,1",
                  iconIndex: "0"
                }
              },
              selection: {
                focusBorderColor: options.focusBorderColor,
                focusBackgroundColor: options.focusBackgroundColor,
                background: options.selectionBackground,
                selectedBackground: options.selectedBackground,
                inactiveBackground: options.selectedBackground,
                border: options.selectionBorderColor + ",2px",
                foreground: "#ff000000",
                selectedForeground: "#ffffffff",
                inactiveForeground: "#ff808080",
                paddingLeft: 0,
                paddingRight: 0,
                paddingTop: 0,
                paddingBottom: 0,
                iconIndex: "0",
                iconLocation: "left",
                iconAlignment: "center",
                iconOffset: 0,
                iconPadding: 0,
                contentFit: "auto",
                selectionDisplay: "mask",
                hoveredMaskBackground: "#1f5292f7",
                focusBackground: "#ff000000",
                figureBackground: "#ff008800",
                figureInactiveBackground: "#ffd3d3d3"
              },
              tree: {
                expander: {
                  figureBackground: options.focusBorderColor,
                  paddingRight: 0
                }
              }
            };
          },
          findColumn: function findColumn(columns, fieldName) {
            if (columns && fieldName) {
              var column;
              for (var i = 0; i < columns.length; i += 1) {
                if (columns[i].columns) {
                  column = dews.ui.gridUtil.findColumn(columns[i].columns, fieldName);
                  if ($.type(column) !== "undefined") {
                    return column;
                  }
                }
                if (columns[i].name && columns[i].name.toUpperCase() === fieldName.toUpperCase()) {
                  column = columns[i];
                  break;
                }
              }
              return column;
            }
          },
          displayColumns: function displayColumns(self, columns) {
            for (var i = 0; i < columns.length; i++) {
              if (columns[i].columns) {
                dews.ui.gridUtil.displayColumns(self, columns[i].columns);
              } else {
                self.options.displayColumns.push(self.columns[columns[i]]);
              }
            }
          },
          setStyles: function setStyles(grid, opt) {
            if ($.type(opt.styles) !== "undefined") {
              var styles = $.extend(true, {}, opt.gridStyle);
              if ($.type(opt.styles.rowNo) !== "undefined") {
                styles.indicator.foreground = $.type(opt.styles.rowNo.color) === "undefined" ? styles.indicator.foreground : opt.styles.rowNo.color;
                styles.indicator.hoveredForeground = styles.indicator.foreground;
                styles.indicator.background = $.type(opt.styles.rowNo.background) === "undefined" ? styles.indicator.background : opt.styles.rowNo.background;
                styles.indicator.hoveredBackground = styles.indicator.background;
                styles.indicator.selectedBackground = $.type(opt.styles.rowNo.selectedBackground) === "undefined" ? styles.indicator.selectedBackground : opt.styles.rowNo.selectedBackground;
                styles.indicator.head.foreground = $.type(opt.styles.rowNo.headerColor) === "undefined" ? styles.indicator.head.foreground : opt.styles.rowNo.headerColor;
                styles.indicator.head.background = $.type(opt.styles.rowNo.headerBackground) === "undefined" ? styles.indicator.head.background : opt.styles.rowNo.headerBackground;
              }
              if ($.type(opt.styles.cellBorder) !== "undefined") {
                var border = "";
                if ($.type(opt.styles.cellBorder.color) !== "undefined") {
                  border = opt.styles.cellBorder.color + ", ";
                } else {
                  border = styles.body.border.split(",")[0] + ", ";
                }
                if ($.type(opt.styles.cellBorder.width) !== "undefined") {
                  border += opt.styles.cellBorder.width;
                } else {
                  border += styles.body.border.split(",")[1];
                }
                styles.body.borderRight = border;
                styles.body.borderBottom = border;
              }
              if ($.type(opt.styles.font) !== "undefined") {
                styles.body.fontFamily = $.type(opt.styles.font.family) === "undefined" ? styles.body.fontFamily : opt.styles.font.family;
                styles.body.fontSize = $.type(opt.styles.font.size) === "undefined" ? styles.body.fontSize : opt.styles.font.size;
                styles.body.fontBold = $.type(opt.styles.font.bold) === "undefined" ? styles.body.fontBold : opt.styles.font.bold;
              }
              if ($.type(opt.styles.padding) !== "undefined") {
                styles.body.paddingTop = $.type(opt.styles.padding.top) === "undefined" ? styles.body.paddingTop : opt.styles.padding.top;
                styles.body.paddingBottom = $.type(opt.styles.padding.bottom) === "undefined" ? styles.body.paddingBottom : opt.styles.padding.bottom;
                styles.body.paddingLeft = $.type(opt.styles.padding.left) === "undefined" ? styles.body.paddingLeft : opt.styles.padding.left;
                styles.body.paddingRight = $.type(opt.styles.padding.right) === "undefined" ? styles.body.paddingRight : opt.styles.padding.right;
              }
              if ($.type(opt.styles.height) !== "undefined") {
                if ($.type(opt.styles.height) === "number") {
                  opt.display.minHeight = opt.styles.height;
                  opt.display.rowHeight = opt.styles.height;
                  opt.header.height = opt.styles.height;
                  opt.header.minHeight = opt.styles.height;
                  opt.footer.height = opt.styles.height;
                  opt.footer.minHeight = opt.styles.height;
                } else {
                  opt.display.rowHeight = $.type(opt.styles.height.row) === "undefined" ? opt.display.rowHeight : opt.styles.height.row;
                  opt.header.height = $.type(opt.styles.height.header) === "undefined" ? opt.header.height : opt.styles.height.header;
                  opt.footer.height = $.type(opt.styles.height.footer) === "undefined" ? opt.footer.height : opt.styles.height.footer;
                  opt.display.minHeight = opt.display.rowHeight;
                  opt.header.minHeight = opt.header.height;
                  opt.footer.minHeight = opt.footer.height;
                }
              }
              if ($.type(opt.styles.verticalAlign) !== "undefined") {
                var position = "middle";
                switch (opt.styles.verticalAlign.toLowerCase()) {
                  case "top":
                    position = "near";
                    break;
                  case "bottom":
                    position = "far";
                    break;}

                styles.body.lineAlignment = position;
              }
              styles.body.foreground = $.type(opt.styles.color) === "undefined" ? styles.body.foreground : opt.styles.color;
              styles.body.background = $.type(opt.styles.background) === "undefined" ? styles.body.background : opt.styles.background;
              if ($.type(opt.styles.grid) !== "undefined") {
                styles.grid.background = $.type(opt.styles.grid.background) === "undefined" ? styles.grid.background : opt.styles.grid.background;
              }
              grid.setStyles(styles);
            }
            return opt;
          },
          cancelRow: function cancelRow(self, data, rowId, _boolean14) {
            if ($.type(_boolean14) === "undefined") {
              _boolean14 = true;
            }
            if (data.getRowState(rowId) === "created") {
              self._grid.cancel();
              if (_boolean14) {
                self.$element.closest(".dews-ui-treegrid.dews-data-control").length > 0 ? self.remove(rowId) : self.removeRow(rowId);
              } else {
                $.each(self.columns, function (idx, value) {
                  self.options.dataSource.dataProvider.setValue(rowId, value.fieldName, void 0);
                });
              }
            } else {
              self._grid.cancel();
              data.restoreUpdatedRows(rowId);
            }
          },
          clearRows: function clearRows(self) {
            var colLength = self._grid.getColumns().length,colList = self._grid.getDisplayColumns(),codepickerVal = {},codepickerField = [],isCodepicker = false;
            for (var i = 0; i < colLength; i++) {
              if (self._grid.getColumnProperty(colList[i], "editor") === "codepicker" && self.columns[colList[i]].codeOption && self.columns[colList[i]].codeOption.value !== void 0) {
                isCodepicker = true;
                if (Object.keys(self.columns[colList[i]].codeOption.value).length > -1) {
                  codepickerVal = self.columns[colList[i]].codeOption.value;
                  codepickerField.push(colList[i]);
                }
              }
            }
            self.options.dataSource.dataProvider.clearRows();
            if (isCodepicker) {
              codepickerField.forEach(function (element) {
                self.columns[element].codeOption.value = {};
              });
            }
          },
          bindPanel: function bindPanel(self, panel) {
            var current = self.dataItem(self.select());
            if ($.type(panel) === "object" && panel.length) {
              if (panel.hasClass("dews-ui-form-panel")) {
                panel = dews.ui.formpanel(panel);
              } else if (panel.hasClass("dews-ui-condition-panel")) {
                panel = dews.ui.conditionpanel(panel);
              }
            }
            panel.bindData(current);
          },
          setDetail: function setDetail(self, target) {
            var master = self,detail = target,masterDataSource = master.options.dataSource,detailDataSource = detail.options.dataSource;
            master.options.master = true;
            if (!master.options._detailGrids) {
              master.options._detailGrids = [];
            }
            master.options._detailGrids.push(target);
            detailDataSource.options.detail = true;
            detailDataSource.options.lineDataSources = {};
            detailDataSource.options.masterDataSource = masterDataSource;
            masterDataSource.options.master = {};
            masterDataSource.options.detailDataSource = detailDataSource;
            var originDetailDataSource;
            if (detailDataSource.options.tree) {
              originDetailDataSource = dews.ui.treeDataSource(
              "orgin_" + detailDataSource.id,
              detail.options.dataSource.options);

            } else {
              originDetailDataSource = dews.ui.dataSource(
              "orgin_" + detailDataSource.id,
              detail.options.dataSource.options);

            }
            self.on("changing", function (e) {
              if (e.row.isChange) {
                commitDetail();
              }
              function commitDetail() {var _master$options$_deta;
                (_master$options$_deta = master.options._detailGrids) === null || _master$options$_deta === void 0 ? void 0 : _master$options$_deta.forEach(function (grid) {
                  var gridView = grid._grid;
                  if (gridView !== null && gridView !== void 0 && gridView.isItemEditing()) {
                    grid._grid.commit();
                  }
                });
              }
            });
            self.on("keyDown", function (e) {
              switch (e.keyCode) {
                case 38:
                case 40:
                  self.onKeyDown = true;
                  break;}

            });
            self.on("keyUp", function (e) {
              switch (e.keyCode) {
                case 38:
                case 40:
                  delete self.onKeyDown;
                  self._grid.onCurrentChanged.call(self, self._grid, self._grid.getCurrent());
                  break;}

            });
            self.on("change", function (e) {
              if (!self.onKeyDown) {
                var currentHDataItem = master.dataItem(master.select()),uid;
                if ($.type(currentHDataItem) === "object") {
                  uid = currentHDataItem._uid;
                }
                if (detail._filterManager) {
                  detail._filterManager.clearAllCheck();
                }
                if (e.grid || e.treegrid) {
                  if (masterDataSource.options._dataChange) {
                    detailDataSource._detailDataChange();
                  }
                  if ($.type(uid) !== "undefined" && $.type(detailDataSource.options.lineDataSources[uid]) === "undefined") {
                    if (detailDataSource.options.tree) {
                      detailDataSource.options.lineDataSources[uid] = dews.ui.treeDataSource(
                      "__ds_" + uid,
                      detailDataSource.options);

                      detailDataSource.options.lineDataSources[uid].dataProvider.onRowAdded = function (dataProvider, rowId) {
                        detail.expand(rowId, false);
                        detail._grid.setCurrent({
                          itemIndex: detail._grid.getItemIndex(rowId),
                          column: detail._grid.getCurrent().column,
                          dataRow: rowId
                        });
                      };
                    } else {
                      detailDataSource.options.lineDataSources[uid] = dews.ui.dataSource(
                      "__ds_" + uid,
                      detailDataSource.options);

                    }
                    detailDataSource.options.lineDataSources[uid].options.master = {};
                    detailDataSource.options.lineDataSources[uid].options._muid = uid;
                    detailDataSource.options.lineDataSources[uid].options._baseDataSource = detailDataSource;
                    detailDataSource.options.id = detailDataSource.id;
                    detail.setDataSource(detailDataSource.options.lineDataSources[uid]);
                    var rowState = master.getRowState(e.row.index);
                    var detailGridOpt = master.options.detailGrid;
                    if (rowState !== "added" || detailGridOpt && detailGridOpt.addedRowDataSourceRead === true) {
                      detailDataSource.options.lineDataSources[uid].read();
                    }
                    if (masterDataSource.options._dataChange) {
                      detailDataSource.options.lineDataSources[uid].options.parentDataSource = detailDataSource;
                      detailDataSource.options.lineDataSources[uid]._detailDataChange();
                    }
                  } else {
                    if (self.dataItems() === null || self.dataItems() === void 0 || $.type(self.dataItems()) === "array" && self.dataItems().length === 0) {
                      detail.setDataSource(originDetailDataSource);
                      var rowState = master.getRowState(e.row.index);
                      var detailGridOpt = master.options.detailGrid;
                      if (rowState !== "added" || detailGridOpt && detailGridOpt.addedRowDataSourceRead === true) {
                        detail.dataSource.read();
                      }
                    } else if ($.type(detailDataSource.options.lineDataSources[uid]) !== "undefined") {
                      detail.setDataSource(detailDataSource.options.lineDataSources[uid]);
                      if (detail.options.note) {
                        var column = self.options.columns,dataBoundParameter = {
                            grid: self,
                            row: {
                              data: self.options.dataSource.data()
                            },
                            column: column
                          };
                        self._gridNote.boundingDraw(detail._grid, detail, dataBoundParameter);
                      }
                    }
                  }
                  masterDataSource.options.master[detailDataSource.options.id] = detailDataSource;
                }
              }
            });
            self.on("rowAdd", function (e) {
              if (master === null)
              return;
              var uidColumnName = "_uid";
              var selectedIndex = master.select();
              var selectedData = master.dataItem(selectedIndex);
              var hasPropertyUid = selectedData.hasOwnProperty(uidColumnName);
              if (hasPropertyUid === false) {
                return;
              }
              var newGUID = guid();
              master.setCellValue(selectedIndex, uidColumnName, newGUID, false);
            });
            self.on("rowRemove", function (e) {
              $.each(e.row.data, function (idx, rowData) {
                if (rowData._uid !== void 0 && detailDataSource.options.lineDataSources[rowData._uid] !== void 0) {
                  delete detailDataSource.options.lineDataSources[rowData._uid];
                }
              });
            });
            function guid() {
              return "xxxxxxxx-xxxx-4xxx-9xxx-xxxxxxxxxxxx".replace(/[xy]/g, function (c) {
                var r = Math.random() * 16 | 0,v = c == "x" ? r : r & 3 | 8;
                return v.toString(16);
              });
            }
          },
          setHeight: function setHeight(self, height) {
            self.options.height = height;
            self.$element.css("height", height);
            self._grid.resetSize();
          },
          setRowHeight: function setRowHeight(self, opt, itemIndex, height) {
            self._grid.setDisplayOptions({
              eachRowResizable: true
            });
            if (opt === "fitAll") {
              self._grid.fitRowHeightAll(0, true);
            } else if (opt === "fit") {
              self._grid.fitRowHeight(itemIndex, 0, true, true);
            } else if (opt === "custom") {
              self._grid.setRowHeight(itemIndex, height, true);
            } else if (opt === "none") {
              self._grid.clearRowHeights(true);
            } else
            return false;
          },
          setRowStyle: function setRowStyle(self, row, style, _colorLine) {
            var styles = {},index = [];
            if (style) {
              if (style.color) {
                styles.foreground = style.color;
              }
              if (style.textAlign) {
                switch (style.textAlign) {
                  case "left":
                    styles.textAlignment = "near";
                    break;
                  case "right":
                    styles.textAlignment = "far";
                    break;
                  case "center":
                    styles.textAlignment = "center";
                    break;}

              }
              if ($.type(row) !== "array" && $.type(row) === "number") {
                index.push(row);
              } else if ($.type(row) === "array") {
                index = row;
              } else {
                return;
              }
              styles = $.extend(true, styles, style);
              for (var i = 0; i < index.length; i += 1) {
                var rowDynamicStyle = {
                  criteria: "(dataRow = " + index[i] + ")",
                  styles: styles
                };
                self.options.rowDynamic.push(rowDynamicStyle);
                if (_colorLine) {
                  self._colorLine.rowDynamic.push(rowDynamicStyle);
                }
              }
              if (self._colorLine.useColorLine === "N") {
                return null;
              }
              self._grid.setStyles({
                body: {
                  dynamicStyles: self.options.rowDynamic
                }
              });
            }
          },
          resetRowStyle: function resetRowStyle(self, row) {
            var index = [];
            if ($.type(row) !== "array" && $.type(row) === "number") {
              index.push(row);
            } else if ($.type(row) === "array") {
              index = row;
            } else {
              return;
            }
            var tempDataList;
            if (self._colorLine.rowDynamic) {
              tempDataList = self.options.rowDynamic.slice();
              self._colorLine.rowDynamic.forEach(function (row2) {
                var check = self.options.rowDynamic.find(function (_row) {
                  return JSON.stringify(row2) === JSON.stringify(_row);
                });
                if (check) {
                  tempDataList.forEach(function (__row, index2) {
                    if (JSON.stringify(__row) === JSON.stringify(check)) {
                      tempDataList.splice(index2, 1);
                    }
                  });
                }
              });
            }
            for (var i = self.options.rowDynamic.length - 1; i >= 0; i -= 1) {
              for (var j = 0; j < index.length; j += 1) {
                if (self.options.rowDynamic[i].criteria === "(dataRow = " + index[j] + ")") {
                  self.options.rowDynamic.splice(i, 1);
                }
              }
            }
            if (self._colorLine.rowDynamic) {
              for (var i = 0; i < tempDataList.length; i++) {
                self.options.rowDynamic.push(tempDataList[i]);
              }
            }
            self._grid.setStyles({
              body: {
                dynamicStyles: self.options.rowDynamic
              }
            });
          },
          updateRow: function updateRow(self, row, data) {
            if (self.options.dataSource) {
              self._grid.commit(true);
              self.options.dataSource.dataProvider.updateRow(row, data);
              for (var i = 0; i < Object.keys(data).length; i += 1) {
                if (self.options.dataSource.dataProvider.getFieldIndex(Object.keys(data)[i]) !== -1) {
                  self._grid.onCellEdited.call(
                  self,
                  self._grid,
                  row,
                  row,
                  self.options.dataSource.dataProvider.getFieldIndex(Object.keys(data)[i]));

                }
              }
            }
          },
          setRowState: function setRowState(self, index, state) {
            var dataRow = index,status;
            if (state.toLowerCase() === "added") {
              state = "created";
            }
            status = state.toLowerCase();
            if (self.options.dataSource && self.options.dataSource.dataProvider) {
              self.options.dataSource.dataProvider.setRowState(dataRow, status);
            }
          },
          getRowState: function getRowState(self, idx) {
            var index = self._grid.getDataRow(idx);
            if (self.options.dataSource && index !== -1) {
              var state;
              if (self._grid.getItemState(index) === "appending") {
                state = "added";
              } else {
                state = self.options.dataSource.dataProvider.getRowState(index);
                if (state === "created") {
                  state = "added";
                }
              }
              return state;
            }
          },
          showColumn: function showColumn(self, field) {
            var column = self._grid.columnByName(field);
            if ($.type(column) !== "undefined" && $.type(column) !== "null") {
              self._grid.setColumnProperty(column, "visible", true);
              self.columns[column.name].visible = true;
              if ($.type(column.parent) !== "undefined") {
                self.showColumn(column.parent);
              }
              self.options.displayColumns = [];
              dews.ui.gridUtil.displayColumns(self, self._grid.getDisplayColumns());
            }
          },
          hideColumn: function hideColumn(self, field) {
            var column = self._grid.columnByName(field);
            if ($.type(column) !== "undefined" && $.type(column) !== "null") {
              self._grid.setColumnProperty(column, "visible", false);
              if (column.columns) {
                if (!self._hideChildrenColumns) {
                  self._hideChildrenColumns = {};
                }
                self._hideChildrenColumns[column.name] = true;
              }
              self.columns[column.name].visible = false;
              if ($.type(column.parent) !== "null") {
                var parent = self.columns[column.parent],flag = true;
                if ($.type(parent) !== "undefined") {
                  $.each(parent.columns, function (idx, col) {
                    if (self._grid.columnByName(col.name).visible) {
                      flag = false;
                    }
                  });
                  if (flag) {
                    self.hideColumn(column.parent);
                  }
                }
              }
              self.options.displayColumns = [];
              dews.ui.gridUtil.displayColumns(self, self._grid.getDisplayColumns());
            }
          },
          sort: function sort(self, options) {
            var field = [],dir = [];
            if ($.type(options) === "array") {
              for (var i = 0; i < options.length; i += 1) {
                field.push(options[i].field);
                if (options[i].dir === "des") {
                  dir.push("descending");
                } else {
                  dir.push("ascending");
                }
              }
            } else {
              field.push(options.field);
              if (options.dir === "des") {
                dir.push("descending");
              } else {
                dir.push("ascending");
              }
            }
            self._grid.orderBy(field, dir);
          },
          showTooltip: function showTooltip(self, rowIndex, column, options) {
            var itemIndex = rowIndex;
            var column = column;
            self._grid.setCurrent({
              itemIndex: itemIndex,
              column: column
            });
            setTimeout(function () {
              var tooltipOptions = {
                grid: true,
                cellX: self._grid.getCellBounds(itemIndex, column, true).x,
                cellY: self._grid.getCellBounds(itemIndex, column, true).y,
                cellWidth: self._grid.getCellBounds(itemIndex, column, true).width,
                cellHeight: self._grid.getCellBounds(itemIndex, column, true).height
              };
              tooltipOptions = $.extend(true, tooltipOptions, options);
              dews.ui.tooltip.show(self.$element, tooltipOptions);
            });
          },
          isCheckedRow: function isCheckedRow(self, row) {
            return self._grid._gv.isCheckedRow(row);
          },
          setContextMenu: function setContextMenu(self, options) {
            var items = [];
            var option = {
              excelDownload: true,
              excelDownloadExpandAll: true,
              excelFileNameSuffixDate: false,
              excelFileNameSuffixDateFormat: "yyyyMMddHHmmss",
              fixed: true,
              search: true,
              filter: true,
              items: []
            };
            if (Array.isArray(options)) {
              $.extend(true, option.items, options);
            } else if (_typeof(options) === "object") {
              $.extend(true, option, options);
            }
            if (typeof option === "boolean" || typeof option !== "undefined") {
              if (option.filter && self._filterManager._options.filter.use) {
                var fmOpt = self._filterManager._options;
                option.items.unshift({
                  id: "filter",
                  text: dews.localize.get("\uD544\uD130 \uC635\uC158", "dews_\uD544\uD130 \uC635\uC158"),
                  children: [
                  {
                    id: "filter_icon_display_true",
                    text: dews.localize.get("\uD544\uD130 \uC544\uC774\uCF58 \uD45C\uC2DC", "dews_\uD544\uD130 \uC544\uC774\uCF58 \uD45C\uC2DC"),
                    handler: function handler() {
                      fmOpt.filtering.handleImages.none = dews._environments.scriptBase + "realgrid/assets/ico-grid-filter-off.png";
                      self._grid.setFilteringOptions(fmOpt.filtering);
                      self._grid.resetSize();
                    },
                    display: function display() {
                      return !fmOpt.filtering.handleImages.none;
                    }
                  },
                  {
                    id: "filter_icon_display_false",
                    text: dews.localize.get("\uD544\uD130 \uC544\uC774\uCF58 \uD45C\uC2DC \uCDE8\uC18C", "dews_\uD544\uD130 \uC544\uC774\uCF58 \uD45C\uC2DC \uCDE8\uC18C"),
                    handler: function handler() {
                      fmOpt.filtering.handleImages.none = null;
                      self._grid.setFilteringOptions(fmOpt.filtering);
                      self._grid.resetSize();
                    },
                    display: function display() {
                      return !!fmOpt.filtering.handleImages.none;
                    }
                  },
                  {
                    id: "filter_clear",
                    text: dews.localize.get("\uD544\uD130\uD574\uC81C", "dews_\uD544\uD130\uD574\uC81C"),
                    handler: function handler() {
                      self._filterManager.clearAllCheck();
                    },
                    display: function display() {
                      var columns = self._filterManager._columns;
                      for (var prop in columns) {
                        var activeColumnFilters = self._grid.getActiveColumnFilters(prop, true);
                        if (activeColumnFilters && activeColumnFilters.length > 0) {
                          return true;
                        }
                      }
                      return false;
                    }
                  }],

                  display: function display() {
                    return true;
                  }
                });
                option.items.unshift({
                  id: "quick_filter",
                  text: dews.localize.get("\uD035 \uD544\uD130", "dews_\uD035 \uD544\uD130"),
                  handler: function handler() {
                    var columns = self.getColumns();
                    var currentColumn = self.getCurrentColumn();
                    var allColumns = [];
                    var setAllColumns = function setAllColumns(columns2) {
                      $.each(columns2, function (idx, column) {
                        if (column.columns) {
                          setAllColumns(column.columns);
                        } else {
                          allColumns.push(column);
                        }
                      });
                    };
                    setAllColumns(columns);
                    var currentColumnInfo = allColumns.find(function (e) {
                      if (e.field === "__UUID" || !e.field || e.grouping || e.columns || e.editor && (e.editor.type === "mask" || e.editor.type === "button" || e.editor.type === "check") || e.formats && (e.formats.type === "mask" || e.formats.type === "check" || e.formats.type === "image" || e.formats.type === "password")) {
                        return false;
                      }
                      if (e.field == currentColumn) {
                        return true;
                      }
                    });
                    if (!currentColumnInfo)
                    return;
                    var fm = self._filterManager;
                    fm._setColumnName(currentColumn);
                    var columnInfo = fm._getColumnInfo();
                    var type = columnInfo.type;
                    var editorFormat = fm._getEditorFormat(currentColumn);
                    var value1Editor = editorFormat.valueFieldEditor;
                    var value1Formats = editorFormat.valueFieldFormats;
                    var dialogTitle = title = dews.localize.get("\uD035 \uD544\uD130", "dews_\uD035 \uD544\uD130");
                    if (currentColumnInfo) {
                      dialogTitle = dews.localize.get("\uD035 \uD544\uD130", "dews_\uD035 \uD544\uD130") + " (" + currentColumnInfo.title + ")";
                    }
                    var dialog2 = dews.ui.dialog("quickFilter", {
                      title: dialogTitle,
                      buttons: "applyAndClose",
                      width: 475,
                      height: 550,
                      content: "<div class=\"dews-dialog-contents-area\">\n  <div class=\"dews-grid-quickfilter-area\">\n    <div class=\"dews-grid-quickfilter-button-group\">\n      <div class=\"reset-button\">\n        <button id=\"btnClear\" class=\"dews-ui-button\">\uCD08\uAE30\uD654</button>\n      </div>\n      <div class=\"line-button\">\n        <button id=\"btnAddRow\" class=\"dews-ui-button\">\uCD94\uAC00</button>\n      </div>\n    </div>\n    <div id=\"grid\" class=\"dews-ui-grid\"></div>\n  </div>\n  <div class=\"dews-grid-quickfilter-tip\">\n    <span class=\"title\">\uC0AC\uC6A9Tip</span>\n    <p>\n      \u2022\uC120\uD0DD\uB41C \uCEEC\uB7FC\uC5D0 \uC785\uB825\uD55C \uAC12\uC73C\uB85C \uD544\uD130\uB9C1 \uB429\uB2C8\uB2E4. \uB2E4\uB978 \uD544\uD130\uB294 \uCD08\uAE30\uD654\uB429\uB2C8\uB2E4.<br>\n      \u2022\uB2E8\uCD95\uD0A4: \uCD94\uAC00(Ins, Shift+Enter), \uC0AD\uC81C(Del), \uCD08\uAE30\uD654(F8), \uC801\uC6A9(Ctrl+Enter)\n    </p>\n  </div>\n</div>",
                      open: function open() {
                        dews.ready(function () {
                          var selfDialog = this;
                          var dialog3 = dews.ui.dialog(selfDialog.$content.attr("ID"));
                          var initData = [];
                          if (type.toUpperCase() === "DROPDOWN") {
                            var selection = self._grid.getSelection();
                            for (var i = selection.startItem; i <= selection.endItem; i++) {
                              var displayValue = self._grid.getDisplayValues(i);
                              var v = displayValue[currentColumn];
                              if (v !== void 0 && v !== null && v !== "") {
                                var findData = initData.find(function (x) {
                                  return x.value === v;
                                });
                                if (findData === void 0) {
                                  initData.push({
                                    value: v
                                  });
                                }
                              }
                            }
                          } else {
                            var selectionDatas = self._grid.getSelectionData();
                            $.each(selectionDatas, function (idx, selectionRow) {
                              var v2 = selectionRow[currentColumn];
                              if (v2 === void 0 || v2 === null || v2 === "") {
                                return true;
                              }
                              var findData2 = initData.find(function (x) {
                                return x.value === v2;
                              });
                              if (findData2 === void 0) {
                                initData.push({
                                  value: v2
                                });
                              }
                            });
                          }
                          var gridDataSource = dews.ui.dataSource("dataSource", {
                            grid: true,
                            data: initData,
                            schema: {
                              model: {
                                id: "data",
                                fields: [
                                {
                                  field: "value"
                                },
                                {
                                  field: "delete"
                                }]

                              }
                            }
                          });
                          var grid = dews.ui.grid("#grid", {
                            dataSource: gridDataSource,
                            editable: true,
                            sortable: false,
                            checkable: false,
                            filter: false,
                            autoBind: true,
                            editSkip: true,
                            context: false,
                            height: 350,
                            columns: [
                            {
                              field: "value",
                              title: dews.localize.get("\uD544\uD130 \uAC12", "dews_\uD544\uD130 \uAC12"),
                              width: 200,
                              align: "left",
                              formats: value1Formats,
                              editor: value1Editor
                            },
                            {
                              field: "delete",
                              title: dews.localize.get("\uC0AD\uC81C", "dews_\uC0AD\uC81C"),
                              width: 30,
                              editable: false,
                              editor: {
                                type: "button",
                                buttonWidth: 21,
                                buttonHeight: 21,
                                basicImg: dews._environments.scriptBase + "realgrid/assets/sbtn-del-normal.png",
                                hoverImg: dews._environments.scriptBase + "realgrid/assets/sbtn-del-over.png",
                                clickImg: dews._environments.scriptBase + "realgrid/assets/sbtn-del-click.png",
                                click: function click(e) {
                                  gridRemoveRow.bind(selfDialog)();
                                }
                              }
                            }]

                          });
                          selfDialog.buttons.ok.on("click", function () {
                            dialogOk();
                          });
                          selfDialog.btnClear.on("click", function (e) {
                            gridClear.bind(selfDialog)();
                          });
                          selfDialog.btnAddRow.on("click", function (e) {
                            gridAddRow.bind(selfDialog)();
                          });
                          if (initData.length === 0) {
                            gridAddRow.bind(selfDialog)();
                          } else {
                            grid.select(initData.length - 1);
                          }
                          grid.on("keyDown", function (e) {
                            if (e.keyCode == 45 || e.shift && e.keyCode == 13) {
                              gridAddRow.bind(selfDialog)();
                              e.preventDefault();
                              return;
                            }
                            if (e.keyCode == 46) {
                              if (grid.getEditCellValue() || grid.getEditCellValue() == "") {
                                return;
                              } else {
                                gridRemoveRow.bind(selfDialog)();
                                e.preventDefault();
                                return;
                              }
                            }
                            if (e.keyCode == 119) {
                              gridClear.bind(selfDialog)();
                              e.preventDefault();
                              return;
                            }
                            if (e.ctrl && e.keyCode == 13) {
                              dialogOk();
                              return;
                            }
                          });
                          function gridAddRow() {
                            grid.addRow({
                              editing: false
                            });
                          }
                          function gridRemoveRow() {
                            grid.removeRow(grid.select());
                          }
                          function gridClear() {
                            grid.dataSource.data([]);
                          }
                          function dialogOk() {
                            grid.commitCell();
                            var isValidate = true;
                            $.each(grid.dataItems(), function (idx, data) {
                              isValidate = gridValidate(idx);
                              return isValidate;
                            });
                            if (isValidate === false) {
                              return;
                            }
                            selfDialog.ok(grid.dataItems());
                          }
                          function gridValidate(itemIndex) {
                            var realGrid = grid._grid;
                            var rowValues = realGrid.getValues(itemIndex);
                            var value = rowValues.value;
                            var tooltipOpt = {
                              type: "normal",
                              text: dews.localize.get(
                              "\uAC12\uC744 \uC785\uB825\uD558\uC138\uC694",
                              "dews_\uAC12\uC744 \uC785\uB825\uD558\uC138\uC694"),

                              position: "top"
                            };
                            if (value !== 0 && !value) {
                              grid.showTooltip(itemIndex, "value", tooltipOpt);
                              return false;
                            }
                            return true;
                          }
                        });
                      },
                      ok: function ok(datas) {
                        fm.clearAllCheck();
                        var filterDatas = datas.filter(function (data) {
                          var value = data.value;
                          if (value === void 0 || value === null || value === "") {
                            return false;
                          }
                          return true;
                        });
                        var dataList = filterDatas.map(function (data) {
                          return data.value;
                        });
                        fm.addFilterValueList(currentColumnInfo.field, dataList);
                      }
                    });
                    dialog2.open();
                    dialog2.on("closed", function () {
                      self._grid.setFocus();
                    });
                  },
                  display: function display() {
                    return true;
                  }
                });
              }
              if (option.search) {
                option.items.unshift({
                  id: "search_text",
                  text: dews.localize.get("\uAC80\uC0C9", "dews_\uAC80\uC0C9"),
                  handler: function handler(e) {
                    self.options.searchDiv = $('<div class="dews-search-area"></div>');
                    self.options.searchText = $(
                    '<input type="text" class="dews-ui-textbox k-textbox dews-control-activate dews-form-control" id="' + self._grid.name + '_search"/>');

                    self.options.searchEndBtn = $(
                    '<button type="button" class="dews-ui-button dews-control k-button dews-control-activate" id="' + self._grid.name + '_btn"></button>');

                    self.options.searchDiv.css({
                      top: self._grid.getHeader().height + 2
                    });
                    self.$element.append(self.options.searchDiv);
                    self.options.searchDiv.append(self.options.searchText);
                    self.options.searchDiv.append(self.options.searchEndBtn);
                    self.options.searchText.on("keydown", function (e2) {
                      if (e2.keyCode === 13) {
                        e2.stopPropagation();
                        var visibleColumn = [],currentIndex = self._grid.getCurrent().itemIndex,currentColumn = self.getCurrentColumn(),currentFieldIndex = 0;
                        $.each(self.options.displayColumns, function (idx, column) {
                          visibleColumn.push(column.field);
                          if (column.field === currentColumn) {
                            currentFieldIndex = idx;
                          }
                        });
                        var searchDataCell = self.dataSource.dataProvider.searchData({
                          fields: visibleColumn,
                          value: self.options.searchText.val(),
                          startFieldIndex: currentFieldIndex,
                          startIndex: self._grid.getDataRow(currentIndex),
                          partialMatch: true
                        });
                        if ($.type(searchDataCell) === "null") {
                          dews.alert("\uAC80\uC0C9 \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.").yes(function () {
                            setTimeout(function () {
                              self.options.searchText.focus();
                            }, 200);
                          });
                        } else {
                          if (searchDataCell.searchFieldIndex === currentFieldIndex) {
                            if (currentFieldIndex === visibleColumn.length - 1) {
                              if (self._grid.getItemCount() === currentIndex) {
                                currentIndex = 0;
                              } else {
                                currentIndex = currentIndex + 1;
                              }
                              currentFieldIndex = 0;
                            } else {
                              currentFieldIndex = currentFieldIndex + 1;
                            }
                          }
                          self.searchCell({
                            fields: visibleColumn,
                            value: self.options.searchText.val(),
                            startFieldIndex: currentFieldIndex,
                            startIndex: currentIndex
                          });
                          self.options.searchText.focus();
                        }
                      } else if (e2.keyCode === 27) {
                        self.options.searchEndBtn.click();
                        e2.stopPropagation();
                        e2.preventDefault();
                      }
                    });
                    self.options.searchEndBtn.on("click", function (e2) {
                      closeSearch(self);
                    });
                    self.options.searchText.focus();
                  },
                  display: function display(e) {
                    if (self.options.searchText) {
                      closeSearch(self);
                    }
                    return true;
                  }
                });
              }
              if (option.fixed) {
                option.items.unshift(
                {
                  id: "fixed_added",
                  text: dews.localize.get("\uD2C0 \uACE0\uC815", "dews_\uD2C0 \uACE0\uC815"),
                  handler: function handler(e) {
                    var currentColumn = getFixedColumn(self, e.cell.field);
                    if ((self.userOptions.resizable || self.userOptions.resizable === void 0) && self.userOptions.fixed && self.userOptions.fixed.resizable) {
                      self._grid.setFixedOptions({
                        colCount: currentColumn.displayIndex + 1,
                        resizable: true
                      });
                    } else {
                      self._grid.setFixedOptions({
                        colCount: currentColumn.displayIndex + 1,
                        resizable: false
                      });
                    }
                  },
                  display: function display(e) {
                    var fixedOption = self._grid.getFixedOptions();
                    if (fixedOption.colCount === 0) {
                      return true;
                    } else {
                      return false;
                    }
                  }
                },
                {
                  id: "fixed_delete",
                  text: dews.localize.get("\uD2C0 \uCDE8\uC18C", "dews_\uD2C0 \uACE0\uC815 \uCDE8\uC18C"),
                  handler: function handler(e) {
                    self._grid.setFixedOptions({
                      colCount: 0
                    });
                  },
                  display: function display(e) {
                    var fixedOption = self._grid.getFixedOptions();
                    if (fixedOption.colCount === 0) {
                      return false;
                    } else {
                      return true;
                    }
                  }
                });

              }
              if (option.excelDownload) {
                var reprocessingExcelFileName2 = function reprocessingExcelFileName2(defaultName) {
                  var fileName2 = defaultName;
                  if (option.excelFileNameSuffixDate) {
                    var suffixFormat = dews.date.toString(
                    new Date(),
                    option.excelFileNameSuffixDateFormat);

                    fileName2 += "_" + suffixFormat;
                  }
                  return fileName2;
                };
                var reprocessingExcelFileName = reprocessingExcelFileName2;
                var fieldName = self._grid.name;
                var fileName = reprocessingExcelFileName2(fieldName);
                option.items.unshift({
                  id: "download_excel",
                  text: dews.localize.get("\uC5D1\uC140 \uB0B4\uBCF4\uB0B4\uAE30", "dews_\uC5D1\uC140 \uB0B4\uBCF4\uB0B4\uAE30"),
                  children: [
                  {
                    id: "download_excel_text",
                    text: dews.localize.get("\uC5D1\uC140 \uB0B4\uBCF4\uB0B4\uAE30(\uD654\uBA74)", "dews_\uC5D1\uC140 \uB0B4\uBCF4\uB0B4\uAE30(\uD654\uBA74)"),
                    handler: function handler() {
                      self.saveAsExcel({
                        fileName: fileName,
                        excelDownloadExpandAll: option.excelDownloadExpandAll,
                        lookupDisplay: true
                      });
                    },
                    display: function display() {
                      return true;
                    }
                  },
                  {
                    id: "download_excel_code",
                    text: dews.localize.get("\uC5D1\uC140 \uB0B4\uBCF4\uB0B4\uAE30(\uCF54\uB4DC)", "dews_\uC5D1\uC140 \uB0B4\uBCF4\uB0B4\uAE30(\uCF54\uB4DC)"),
                    handler: function handler() {
                      self.saveAsExcel({
                        fileName: fileName,
                        excelDownloadExpandAll: option.excelDownloadExpandAll,
                        lookupDisplay: false
                      });
                    },
                    display: function display() {
                      return true;
                    }
                  },
                  {
                    id: "menuSeparator",
                    text: "-",
                    display: function display() {
                      return true;
                    }
                  },
                  {
                    id: "download_excel_text_all",
                    text: dews.localize.get(
                    "\uC5D1\uC140 \uB0B4\uBCF4\uB0B4\uAE30(\uD654\uBA74, \uC228\uAE40 \uCEEC\uB7FC \uD3EC\uD568)",
                    "dews_\uC5D1\uC140 \uB0B4\uBCF4\uB0B4\uAE30(\uD654\uBA74, \uC228\uAE40 \uCEEC\uB7FC \uD3EC\uD568)"),

                    handler: function handler() {
                      self.saveAsExcel({
                        fileName: fileName,
                        excelDownloadExpandAll: option.excelDownloadExpandAll,
                        lookupDisplay: true,
                        allColumns: true,
                        hideColumns: ["__UUID"]
                      });
                    },
                    display: function display() {
                      return true;
                    }
                  },
                  {
                    id: "downLoad_excel_code_all",
                    text: dews.localize.get(
                    "\uC5D1\uC140 \uB0B4\uBCF4\uB0B4\uAE30(\uCF54\uB4DC, \uC228\uAE40 \uCEEC\uB7FC \uD3EC\uD568)",
                    "dews_\uC5D1\uC140 \uB0B4\uBCF4\uB0B4\uAE30(\uCF54\uB4DC, \uC228\uAE40 \uCEEC\uB7FC \uD3EC\uD568)"),

                    handler: function handler() {
                      self.saveAsExcel({
                        fileName: fileName,
                        excelDownloadExpandAll: option.excelDownloadExpandAll,
                        lookupDisplay: false,
                        allColumns: true,
                        hideColumns: ["__UUID"]
                      });
                    },
                    display: function display() {
                      return true;
                    }
                  },
                  {
                    id: "menuSeparator",
                    text: "-",
                    display: function display() {
                      return true;
                    }
                  },
                  {
                    id: "download_excel_text_removeDynamicStyles",
                    text: dews.localize.get(
                    "\uC5D1\uC140 \uB0B4\uBCF4\uB0B4\uAE30(\uD654\uBA74\uAE30\uC900 \uC2A4\uD0C0\uC77C\uC81C\uAC70)",
                    "dews_\uC5D1\uC140 \uB0B4\uBCF4\uB0B4\uAE30(\uD654\uBA74\uAE30\uC900 \uC2A4\uD0C0\uC77C\uC81C\uAC70)"),

                    handler: function handler() {
                      self.saveAsExcel({
                        fileName: fileName,
                        excelDownloadExpandAll: option.excelDownloadExpandAll,
                        lookupDisplay: true,
                        applyDynamicStyles: false
                      });
                    },
                    display: function display() {
                      return true;
                    }
                  },
                  {
                    id: "menuSeparator",
                    text: "-",
                    display: function display() {
                      return true;
                    }
                  },
                  {
                    id: "downLoad_excel_custom_dialog",
                    text: dews.localize.get("\uC0AC\uC6A9\uC790 \uC815\uC758 \uB0B4\uBCF4\uB0B4\uAE30", "dews_\uC0AC\uC6A9\uC790 \uC815\uC758 \uB0B4\uBCF4\uB0B4\uAE30"),
                    handler: function handler() {
                      var dialog2 = dews.ui.dialog("grid_excel_dialog", {
                        title: dews.localize.get(
                        "\uADF8\uB9AC\uB4DC \uC5D1\uC140 \uB2E4\uC6B4\uB85C\uB4DC",
                        "dews_\uADF8\uB9AC\uB4DC \uC5D1\uC140 \uB2E4\uC6B4\uB85C\uB4DC"),

                        buttons: "none",
                        width: 560,
                        height: 560,
                        content: '<div class="dews-ui-grid" id="grid_excel_down" style="height: 415px"></div><div><input type="checkbox" id="excel_check" class="dews-ui-checkbox"><label for="excel_check">' + dews.localize.get(
                        "\uB9AC\uC2A4\uD2B8 \uCEEC\uB7FC(\uB4DC\uB86D\uB2E4\uC6B4, \uCF64\uBCF4, \uCF54\uB4DC\uBCC0\uD658) \uD654\uBA74\uC5D0 \uD45C\uC2DC\uB41C \uB300\uB85C \uCD9C\uB825",
                        "dews_\uB9AC\uC2A4\uD2B8 \uCEEC\uB7FC(\uB4DC\uB86D\uB2E4\uC6B4, \uCF64\uBCF4, \uCF54\uB4DC\uBCC0\uD658) \uD654\uBA74\uC5D0 \uD45C\uC2DC\uB41C \uB300\uB85C \uCD9C\uB825") +
                        '</label></div><div><input type="checkbox" id="excel_separate_check" class="dews-ui-checkbox"><label for="excel_separate_check">' + dews.localize.get("\uB370\uC774\uD130 \uBCD1\uD569 \uD574\uC81C", "dews_\uB370\uC774\uD130 \uBCD1\uD569 \uD574\uC81C") + '</label></div><div><input type="checkbox" id="excel_column_group_check" class="dews-ui-checkbox"><label for="excel_column_group_check">' + dews.localize.get("\uCEEC\uB7FC \uBCD1\uD569 \uD574\uC81C", "dews_\uCEEC\uB7FC \uBCD1\uD569 \uD574\uC81C") + '</label></div><div class="dews-button-group dews-dialog-button-group bottom"><button class="dews-ui-button" type="button" id="download_excel">' + dews.localize.get("\uB2E4\uC6B4\uB85C\uB4DC", "dews_\uB2E4\uC6B4\uB85C\uB4DC") + '</button><button class="dews-ui-button" type="button" id="dialog_close">' + dews.localize.get("\uB2EB\uAE30", "dews_\uB2EB\uAE30") + "</button></div>"
                      });
                      dialog2.open();
                      if (dialog2._kendoWindow) {
                        var array = [];
                        dialog2._kendoWindow.bind("activate", function (e) {
                          var data = [],totalColumn = {};
                          var dataSource = dews.ui.dataSource("dataSource", {
                            grid: true,
                            data: [],
                            schema: {
                              model: {
                                id: "field",
                                fields: [
                                {
                                  field: "field"
                                },
                                {
                                  field: "title"
                                },
                                {
                                  field: "visible"
                                },
                                {
                                  field: "headerVisible",
                                  dataType: "bool"
                                },
                                {
                                  field: "parent"
                                }]

                              }
                            }
                          });
                          getColumns(totalColumn, self.getColumns());
                          $.each(totalColumn, function (idx, column2) {
                            if (column2.field !== "__UUID") {
                              data.push({
                                field: $.type(column2.field) === "undefined" ? column2.name : column2.field,
                                title: column2.title,
                                visible: $.type(column2.visible) !== "undefined" ? column2.visible : true,
                                headerVisible: $.type(column2.header.visible) !== "undefined" ? column2.header.visible : true,
                                parent: $.type(column2.parent) !== "undefined" ? column2.parent : ""
                              });
                            }
                          });
                          dataSource.data(data);
                          var grid = dews.ui.grid($("#grid_excel_down", this.element), {
                            dataSource: dataSource,
                            autoBind: true,
                            sortable: false,
                            selectable: true,
                            editable: true,
                            height: 415,
                            columns: [
                            {
                              field: "title",
                              title: dews.localize.get("\uCEEC\uB7FC\uBA85", "dews_\uCEEC\uB7FC\uBA85"),
                              editable: false,
                              align: "left"
                            },
                            {
                              field: "field",
                              title: dews.localize.get("\uD544\uB4DC\uBA85", "dews_\uD544\uB4DC\uBA85"),
                              editable: false,
                              align: "left"
                            },
                            {
                              field: "visible",
                              title: dews.localize.get("visible", "dews_visible"),
                              formats: {
                                type: "check",
                                trueValue: "true",
                                falseValue: "false"
                              }
                            }],

                            dataBound: function dataBound(e2) {
                              $.each(e2.row.data, function (idx, rowData) {
                                if ($.type(rowData.title) === "undefined") {
                                  array.push(idx);
                                }
                              });
                              e2.grid.dataSource.dataProvider.hideRows(array);
                            }
                          });
                          var checkedArray = [];
                          var itemCount = grid._grid.getItemCount();
                          for (var i = 0; i < itemCount; i++) {
                            try {
                              var gridData = grid.dataItem(i);
                              if (gridData == null)
                              continue;
                              var isCheck = false;
                              if (gridData.visible === "true") {
                                isCheck = true;
                              }
                              var fieldName2 = gridData.field;
                              if (fieldName2) {
                                var column = totalColumn[fieldName2];
                                if (column) {
                                  if (column.customExport) {
                                    var check = column.customExport.check;
                                    if (check != null)
                                    isCheck = check;
                                  }
                                }
                              }
                              if (isCheck == true) {
                                checkedArray.push(i);
                              }
                            } catch (e2) {
                              continue;
                            }
                          }
                          grid.setCheck(checkedArray, true, false);
                          var downBtn = $("#download_excel", this.element),cancelBtn = $("#dialog_close", this.element),showColumns = [],hideColumns = [];
                          downBtn.on("click", function () {
                            if (grid.getCheckedIndex().length !== 0) {
                              dataSource.dataProvider.showHiddenRows(array);
                              $.each(dataSource.data(), function (idx, column2) {
                                if (grid._grid.isCheckedItem(idx) || array && array.indexOf(idx) !== -1) {
                                  showColumns.push(column2.field);
                                } else {
                                  if (column2.headerVisible) {
                                    hideColumns.push(column2.field);
                                    if (column2.parent) {
                                      hideColumnParent(
                                      self,
                                      column2.parent,
                                      hideColumns);

                                    }
                                  }
                                }
                              });
                              var fileName2 = reprocessingExcelFileName2(fieldName2);
                              self.saveAsExcel({
                                fileName: fileName2,
                                excelDownloadExpandAll: option.excelDownloadExpandAll,
                                lookupDisplay: $("#excel_check", this.element).prop(
                                "checked"),

                                showColumns: showColumns,
                                hideColumns: hideColumns,
                                separateRows: $("#excel_separate_check").prop("checked"),
                                linear: $("#excel_column_group_check").prop("checked")
                              });
                              dialog2.ok();
                            } else {
                              dews.alert(
                              dews.localize.get(
                              "\uB2E4\uC6B4\uB85C\uB4DC \uCEEC\uB7FC\uC744 \uC120\uD0DD\uD558\uC138\uC694.",
                              "dews_\uB2E4\uC6B4\uB85C\uB4DC \uCEEC\uB7FC\uC744 \uC120\uD0DD\uD558\uC138\uC694."));


                            }
                          });
                          cancelBtn.on("click", function () {
                            dialog2.close();
                          });
                        });
                      }
                      function hideColumnParent(gd, field, hideColumn) {
                        if (field.parent) {
                          hideColumnParent(gd, field.parent, hideColumn);
                        }
                        var col = gd.columns[field].columns;
                        var flag = true;
                        $.each(col, function (idx, column) {
                          if (hideColumn.indexOf(column.field) === -1) {
                            flag = false;
                            return false;
                          }
                        });
                        if (flag) {
                          hideColumn.push(field);
                        }
                      }
                      function getColumns(totalColumn, columns, parent) {
                        for (var i = 0; i < columns.length; i++) {
                          if (typeof columns[i].name !== "undefined") {
                            totalColumn[columns[i].name] = columns[i];
                          }
                          if (typeof parent !== "undefined") {
                            columns[i].parent = parent;
                          }
                          if (columns[i].columns) {
                            if (typeof columns[i].name !== "undefined") {
                              totalColumn[columns[i].name] = columns[i];
                            }
                            getColumns(totalColumn, columns[i].columns, columns[i].name);
                          }
                        }
                      }
                    },
                    display: function display() {
                      return true;
                    }
                  }],

                  display: function display() {
                    return true;
                  }
                });
              }
            }
            self.options.contextMenu = option.items;
            convertContextMenuOptions(self, self.options.contextMenu, {}, true);
            self._grid.setContextMenu(items);
          },
          setFocus: function setFocus(self) {
            self.$element.click();
            self._grid.setFocus();
          },
          getCheckedRows: function getCheckedRows(self) {
            var data = self._grid.getCheckedRows(),datasource = [];
            if (self.options.dataSource) {
              for (var i = 0; i < data.length; i += 1) {
                datasource.push(self.options.dataSource.dataProvider.getJsonRow(data[i]));
              }
            }
            return datasource;
          },
          getCheckedValues: function getCheckedValues(self, field) {
            var data = [];
            $.each(self._grid.getCheckedRows(), function (idx, rowId) {
              data.push(self.options.dataSource.dataProvider.getJsonRow(rowId)[field]);
            });
            return data;
          },
          setDataSource: function setDataSource(self) {
            delete self.options.fieldIndex;
            self._grid.setDataProvider(self.options.dataSource.dataProvider);
            self._grid.setColumns(self.options.columns);
            self._grid.setHeader({
              height: self.options.maxDepth * self.options.header.minHeight
            });
            if (self.options.grouping) {
              self.options.display.rowHeight = self.options.display.minHeight * self.options.maxGroupCol;
            }
            self._grid.setOptions(self.options);
          },
          setColumns: function setColumns(self, result) {
            delete self.options.fieldIndex;
            self.options.displayColumns = [];
            $.extend(true, self.options, result);
            if (self.options.dataSource) {
              self._grid.setColumns([]);
              self.options.dataSource.setFields(self.options.dataSource.options.field);
            }
            if (self.options.grouping) {
              self.options.display.rowHeight = self.options.display.minHeight * self.options.maxGroupCol;
            }
            self._grid.setColumns(result.columns);
            self._grid.setHeader({
              height: self.options.maxDepth * self.options.header.minHeight
            });
            self._grid.setOptions(self.options);
            self.columns = {};
            dews.ui.gridUtil._setColumns(self, self.options.columns);
            dews.ui.gridUtil.displayColumns(self, self._grid.getDisplayColumns());
          },
          _setColumns: function _setColumns(self, columns) {
            for (var i = 0; i < columns.length; i++) {
              if (columns[i].columns) {
                if ($.type(columns[i].name) !== "undefined") {
                  self.columns[columns[i].name] = columns[i];
                }
                dews.ui.gridUtil._setColumns(self, columns[i].columns);
              } else if ($.type(columns[i].name) !== "undefined") {
                self.columns[columns[i].name] = columns[i];
              }
            }
          },
          lastEditCell: function lastEditCell(self, displayColumn, displayIndex, value, editParams) {
            var i, column;
            if (displayIndex === displayColumn.length - 1) {
              value = true;
            } else {
              for (i = displayIndex + 1; i < displayColumn.length; i += 1) {
                editParams.cell.field = displayColumn[i].field;
                column = self.columns[displayColumn[i].field];
                if (self._grid.getColumnProperty(column.field, "editable")) {
                  if (column.editor && $.type(column.editor.editable) === "function" && column.editor.editable.call(self, editParams)) {
                    break;
                  } else if (column.editor && $.type(column.editor.editable) === "boolean" && column.editor.editable) {
                    break;
                  } else if (column.editor && $.type(column.editor.editable) === "undefined") {
                    break;
                  } else if (i === displayColumn.length - 1) {
                    value = true;
                    break;
                  }
                } else if (i === displayColumn.length - 1) {
                  value = true;
                  break;
                }
              }
            }
            return value;
          },
          setCellStyle: function setCellStyle(self, index, field, styles) {
            if (self.dataItem(index)) {
              var criteria = "(values['__UUID'] = '" + self.dataItem(index).__UUID + "')";
              if ($.type(self.options.cellStyles) !== "array") {
                self.options.cellStyles = [];
              }
              if ($.type(self.columns[field].criteriaFunction) !== "undefined") {
                self.options.cellStyles.push(self.columns[field].criteriaFunction);
              }
              if (styles) {
                if (styles.color) {
                  styles.foreground = styles.color;
                }
                if ($.type(styles.cellBorder) !== "undefined") {
                  var border = "";
                  if ($.type(styles.cellBorder.color) !== "undefined") {
                    border = styles.cellBorder.color + ", ";
                  }
                  if ($.type(styles.cellBorder.width) !== "undefined") {
                    border += styles.cellBorder.width;
                  }
                  styles.borderRight = border;
                  styles.borderBottom = border;
                }
                if ($.type(styles.font) !== "undefined") {
                  styles.fontFamily = $.type(styles.font.family) === "undefined" ? styles.fontFamily : styles.font.family;
                  styles.fontSize = $.type(styles.font.size) === "undefined" ? styles.fontSize : styles.font.size;
                  styles.fontBold = $.type(styles.font.bold) === "undefined" ? styles.fontBold : styles.font.bold;
                }
                if ($.type(styles.padding) !== "undefined") {
                  styles.paddingTop = $.type(styles.padding.top) === "undefined" ? styles.paddingTop : styles.padding.top;
                  styles.paddingBottom = $.type(styles.padding.bottom) === "undefined" ? styles.paddingBottom : styles.padding.bottom;
                  styles.paddingLeft = $.type(styles.padding.left) === "undefined" ? styles.paddingLeft : styles.padding.left;
                  styles.paddingRight = $.type(styles.padding.right) === "undefined" ? styles.paddingRight : styles.padding.right;
                }
                if (styles.textAlign) {
                  switch (styles.textAlign) {
                    case "left":
                      styles.textAlignment = "near";
                      break;
                    case "right":
                      styles.textAlignment = "far";
                      break;
                    case "center":
                      styles.textAlignment = "center";
                      break;}

                }
                if (styles.verticalAlign) {
                  switch (styles.verticalAlign) {
                    case "top":
                      styles.lineAlignment = "near";
                      break;
                    case "bottom":
                      styles.lineAlignment = "far";
                      break;
                    case "middle":
                      styles.lineAlignment = "center";
                      break;}

                }
              }
              self.options.cellStyles.push({
                criteria: criteria,
                styles: styles,
                fieldName: field
              });
              var cellStyle = [];
              if (self._grid.getColumnProperty(self._grid.columnByField(field), "dynamicStyles")) {
                cellStyle = self._grid.getColumnProperty(self._grid.columnByField(field), "dynamicStyles");
              }
              cellStyle.push({
                criteria: criteria,
                styles: styles,
                fieldName: field
              });
              var columns = self.columns[field];
              if ($.type(columns.cellDynamic) === "undefined") {
                columns.cellDynamic = [];
              }
              columns.cellDynamic.push({
                criteria: criteria,
                styles: styles,
                fieldName: field
              });
              self._grid.setColumnProperty(self._grid.columnByField(field), "dynamicStyles", cellStyle);
            }
          },
          setMaxLength: function setMaxLength(self, field, length) {
            var column = self.columns[field];
            var options = $.extend(true, self._grid.getColumnProperty(field, "editorOptions"), {
              maxLength: length
            });
            if (column && column.editor && column.editor.type === "text" && length > -1) {
              self._grid.setColumnProperty(field, "editorOptions", options);
            }
          },
          setHeaderCheckVisible: function setHeaderCheckVisible(self, visible) {
            self._grid.setCheckBar({ showAll: visible });
          },
          getParentData: function getParentData(self) {
            if (self.options.dataSource.options.detail) {
              var masterDataSource,master_uid,master_data = [],rowData;
              masterDataSource = self.options.dataSource.options.masterDataSource;
              master_uid = self.options.dataSource.options._muid;
              if (masterDataSource.options.detail && masterDataSource.options.lineDataSources) {
                var masterLineDataSources = Object.values(masterDataSource.options.lineDataSources);
                for (var inx = 0; inx < masterLineDataSources.length; inx++) {
                  var lineDataSourceData = masterLineDataSources[inx].data();
                  if (lineDataSourceData !== null) {
                    var isMasterUid = lineDataSourceData.find(function (data) {
                      return data._uid === master_uid;
                    });
                  }
                  if (isMasterUid) {
                    master_data = master_data.concat(lineDataSourceData);
                  }
                }
              } else {
                master_data = masterDataSource.data();
              }
              return master_data;
            }
          },
          getChildData: function getChildData(self, index, gridId) {
            var data = self.dataItem(index),uid,detail,dataSourceId,masterDataSource = self.options.dataSource,detailDatSource;
            if ($.type(data) === "undefined") {
              return;
            }
            if ($.type(masterDataSource) !== "undefined") {
              detailDatSource = masterDataSource.options.detailDataSource;
            }
            if ($.type(gridId) !== "undefined") {
              detail = $("#" + gridId, self.$content).data("dews-control");
              if (detail.options.dataSource && detail.options.dataSource.options.parentDataSource) {
                dataSourceId = detail.options.dataSource.options.parentDataSource.id;
              }
              if ($.type(dataSourceId) !== "undefined") {
                detailDatSource = masterDataSource.options.master[dataSourceId];
              }
            }
            uid = data._uid;
            if ($.type(uid) !== "undefined") {
              if (masterDataSource && detailDatSource && detailDatSource.options.lineDataSources[uid]) {
                return detailDatSource.options.lineDataSources[uid].data();
              }
            }
          },
          getChildDataSource: function getChildDataSource(self, arg1, arg2) {
            var dataSource = self.dataSource;
            if (dataSource.options.master) {
              var _uid;
              if (Object.values(dataSource.options.master).length > 1) {
                if (typeof arg1 === "string") {
                  var detailGrid = $("#" + arg1, self.$content).data("dews-control");
                  if (!detailGrid) {
                    throw "\uC544\uC774\uB514 \uAC12\uACFC \uC77C\uCE58\uD558\uB294 \uB514\uD14C\uC77C \uADF8\uB9AC\uB4DC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.";
                  }
                  var detailGridDataSource = detailGrid.dataSource.options._baseDataSource;
                  if (detailGridDataSource) {
                    if (typeof arg2 === "number") {
                      _uid = self.dataItem(arg2)._uid;
                      return detailGridDataSource.options.lineDataSources[_uid];
                    } else {
                      return Object.values(detailGridDataSource.options.lineDataSources);
                    }
                  }
                } else {
                  throw "1:n \uB9C8\uC2A4\uD130 \uB514\uD14C\uC77C \uADF8\uB9AC\uB4DC\uC5D0\uC11C \uB514\uD14C\uC77C \uADF8\uB9AC\uB4DC \uC544\uC774\uB514\uB97C \uCCAB\uBC88\uC9F8 \uD30C\uB77C\uBBF8\uD130\uC5D0 \uC785\uB825\uD558\uC5EC\uC57C \uD569\uB2C8\uB2E4.";
                }
              } else {
                if (arg1 !== void 0) {
                  if (typeof arg1 === "number") {
                    _uid = self.dataItem(arg1)._uid;
                    return dataSource.options.detailDataSource.options.lineDataSources[_uid];
                  }
                } else {
                  return Object.values(dataSource.options.detailDataSource.options.lineDataSources);
                }
              }
            }
          },
          _getExcelUrlForPrint: function _getExcelUrlForPrint(self, menuName, opt) {
            var grid = self._grid._gv,$dfd = $.Deferred(),fileName = menuName + ".xlsx",url,options = {
                target: "local",
                applyDynamicStyles: true,
                lookupDisplay: true
              },exportGrid = new Grids.GridExcelExporter2();
            if (self.dataItems().length !== 0) {
              exportGrid.$_export = function (parts, options2) {
                if (JSZip.support.blob || !options2.target()) {
                  var zip = new JSZip();
                  for (var i = 0; i < parts.length; i++) {
                    var s = parts[i].body;
                    s.indexOf('xmlns=""') >= 0 && (s = s.replace(/ xmlns=""/g, "").replace(/xmlns=""/g, ""));
                    zip.file(parts[i].key, s);
                  }
                  var blob = zip.generate({
                    type: "blob",
                    compression: "DEFLATE"
                  });
                  blob.name = fileName;
                  url = blob;
                }
              };
              if ($.type(opt) === "object") {
                options = $.extend(true, {}, options, opt);
              }
              options["exportGrids"] = [{ grid: grid }];
              exportGrid["export"](options);
              var token = dews.ui.page ? JSON.parse(dews.ui.page.token).access_token : "";
              var formData = new FormData();
              formData.append("file", url);
              formData.append("isText", "false");
              formData.append("token", token);
              var xhr = new XMLHttpRequest();
              xhr.open("POST", "/upload/file", true);
              xhr.addEventListener("load", function () {
                if (this.status === 200) {
                  var data = JSON.parse(this.responseText).data,downloadUrl;
                  dews.api.get("/auth/temporary/token", {}).done(function (tokenData) {
                    downloadUrl = "/download/tempfile?key=" + encodeURIComponent(data.newFilename) + "&filename=" + fileName + "&token=" + encodeURIComponent(tokenData);
                    $dfd.resolve(downloadUrl);
                  }).fail(function () {
                    $dfd.reject("error");
                  });
                } else {
                  $dfd.reject("error");
                }
              });
              xhr.addEventListener("error", function () {
                $dfd.reject("error");
              });
              xhr.send(formData);
            } else {
              $dfd.reject("error");
            }
            return $dfd.promise();
          },
          enable: function enable(self, _boolean15) {
            var styles = $.extend(true, {}, dews.ui.gridUtil.gridStyle),editable = self.options.editable;
            if (_boolean15) {
              self.$element.removeClass("disabled");
              styles.header.foreground = "#000000";
              styles.header.selectedForeground = "#ff000000";
              styles.rowGroup.header.foreground = "#000000";
              styles.rowGroup.header.background = "#120055aa";
              styles.rowGroup.footer.foreground = "#000000";
              styles.rowGroup.footer.background = "#12ffbf00";
              styles.rowGroup.headerBar.background = "#eaf1f8";
              styles.rowGroup.footerBar.background = "#ffd8dee6";
              styles.rowGroup.foot.background = "#ffecdb";
              styles.rowGroup.foot.borderRight = "#f5d3b6, 1";
              styles.rowGroup.foot.borderTop = "#f5d3b6, 1";
              styles.rowGroup.bar.background = "#120055aa";
              styles.indicator.head.foreground = "#000000";
              styles.indicator.foreground = "#000000";
              styles.indicator.background = "#ffffff";
              styles.indicator.foot.background = "#ffecdb";
              styles.indicator.foot.borderRight = "#f5d3b6, 1";
              styles.indicator.foot.borderTop = "#f5d3b6, 1";
              styles.checkBar.background = "#ffffff";
              styles.checkBar.foot.background = "#ffecdb";
              styles.checkBar.foot.borderRight = "#f5d3b6, 1";
              styles.checkBar.foot.borderTop = "#f5d3b6, 1";
              styles.body.foreground = "#000000";
              styles.body.background = "#ffffff";
              styles.footer.foreground = "#000000";
              styles.footer.background = "#ffecdb";
              styles.footer.borderRight = "#f5d3b6, 1";
              styles.footer.borderTop = "#f5d3b6, 1";
            } else {
              self.$element.addClass("disabled");
              styles.header.foreground = "#a6a6a6";
              styles.header.selectedForeground = "#a6a6a6";
              styles.rowGroup.header.foreground = "#a6a6a6";
              styles.rowGroup.header.background = "#f5f5f5";
              styles.rowGroup.footer.foreground = "#a6a6a6";
              styles.rowGroup.footer.background = "#f5f5f5";
              styles.rowGroup.headerBar.background = "#f5f5f5";
              styles.rowGroup.footerBar.background = "#f5f5f5";
              styles.rowGroup.foot.background = "#f5f5f5";
              styles.rowGroup.foot.borderRight = "#ccc, 1";
              styles.rowGroup.foot.borderTop = "#ccc, 1";
              styles.rowGroup.bar.background = "#f5f5f5";
              styles.indicator.head.foreground = "#a6a6a6";
              styles.indicator.foreground = "#a6a6a6";
              styles.indicator.background = "#f5f5f5";
              styles.indicator.foot.background = "#f5f5f5";
              styles.indicator.foot.borderRight = "#ccc, 1";
              styles.indicator.foot.borderTop = "#ccc, 1";
              styles.checkBar.background = "#f5f5f5";
              styles.checkBar.foot.background = "#f5f5f5";
              styles.checkBar.foot.borderRight = "#ccc, 1";
              styles.checkBar.foot.borderTop = "#ccc, 1";
              styles.body.foreground = "#a6a6a6";
              styles.body.background = "#f5f5f5";
              styles.footer.foreground = "#a6a6a6";
              styles.footer.background = "#f5f5f5";
              styles.footer.borderRight = "#ccc, 1";
              styles.footer.borderTop = "#ccc, 1";
            }
            if (editable) {
              self._grid.setEditOptions({ editable: _boolean15 });
              self.options.edit.editable = _boolean15;
            }
            self._grid.setStyles(styles);
          },
          addColumn: function addColumn(self, column, index) {
            var columnIndex = null;
            var flag = false,addColumns = [];
            if ($.type(self._grid.columnByName(index)) !== "null") {
              columnIndex = self._grid.columnByName(index).displayIndex + 1;
            }
            flag = columnValidate(self, column);
            if (flag) {
              self._grid.addColumn(column, null, columnIndex);
              self.columns = {};
              dews.ui.gridUtil._setColumns(self, self.options.columns);
              for (var i = 0; i < addColumns.length; i++) {
                var addColumn = addColumns[i];
                self._filterManager.columnOptionConvert(addColumn);
                if (self._innerOptions.filter.use && addColumn.filter !== false && addColumn.field) {
                  var columnName = addColumn.field;
                  var action = {
                    name: columnName + "_filterAction",
                    text: columnName + "_filterText"
                  };
                  self._grid.setColumnFilterActions(columnName, action);
                }
              }
            }
            if (self.options.footer && self.options.footer.visible && self._grid.getFooter().visible === false) {
              self._grid.setFooter({ visible: true });
            }
            if ($.type(index) === "undefined") {
              self.options._originColumns.push(column);
            } else {
              $.each(self.options._originColumns, function (idx, col) {
                if (col.field === index) {
                  self.options._originColumns.splice(idx, 0, column);
                  return false;
                }
              });
            }
            function columnValidate(grid, columns) {
              var self2 = grid;
              var columnArr = [],validation = false;
              if (Array.isArray(columns)) {
                columnArr = columns;
              } else {
                columnArr.push(columns);
              }
              for (var i2 = 0; i2 < columnArr.length; i2++) {
                var column2 = columnArr[i2];
                if (column2.columns) {
                  validation = columnValidate(grid, column2.columns);
                } else {
                  var fields = self2.options.dataSource.dataProvider.getFields();
                  for (var f = 0; f < fields.length; f++) {
                    var value = fields[f];
                    if (value.orgFieldName === column2.fieldName) {
                      addColumns.push(column2);
                      validation = true;
                      break;
                    }
                  }
                }
              }
              return validation;
            }
          },
          deleteColumn: function deleteColumn(self, col) {
            var column = self._grid.columnByName(col),deleteIndex = void 0;
            $.each(self.options.columns, function (idx, value) {
              if (col === value.name) {
                deleteIndex = idx;
              }
            });
            $.each(self.options._originColumns, function (idx, column2) {
              if (column2.field === col) {
                self.options._originColumns.splice(idx, 1);
                return false;
              }
            });
            deleteIndex !== void 0 ? self.options.columns.splice(deleteIndex, 1) : "";
            self._grid.removeColumn(column);
            self.columns = {};
            dews.ui.gridUtil._setColumns(self, self.options.columns);
          },
          onImageButtonClicked: function onImageButtonClicked(self, itemIndex, column, parameter) {
            var _column = self.columns[column.fieldName];
            var fieldName = _column.fieldName;
            if (column.editor === "codepicker" || _column.editor.type === "codepicker") {
              if (_column.editor.firstClick) {
                var codeOption = {},helpEvent,keyword,nextFocusFlag = false,dataIndex = self.getDataIndexFromItemIndex(itemIndex);
                if (_column.codeOption.validation) {
                  if (typeof _column.codeOption.value[dataIndex] === "undefined") {
                    var currentValue = self._grid.getValue(itemIndex, fieldName);
                    _column.codeOption.value[dataIndex] = codeOptionValue("", "", currentValue);
                  }
                }
                codeOption = _column.codeOption;
                if (typeof self.options.callback === "function") {
                  delete self.options.callback;
                }
                if (_column.editor.callback) {
                  self.options.callback = _column.editor.callback;
                }
                if (typeof _column.editor.helpParams === "function") {
                  codeOption.params = _column.editor.helpParams.call(self, {
                    data: self._innerOptions._gridType === "GRID" ? self.dataItem(itemIndex) : self.dataItem(dataIndex)
                  });
                } else {
                  codeOption.params = _column.editor.helpParams;
                }
                if (typeof self._grid.getEditValue() !== "undefined") {
                  keyword = self._grid.getEditValue();
                } else {
                  keyword = self._grid.getValue(itemIndex, fieldName);
                }
                codeOption.params = $.extend(true, codeOption.params, { keyword: keyword });
                codeOption.callbacks = function (data) {
                  if (typeof data !== "undefined") {
                    if (Array.isArray(data)) {
                      throw "\uB450 \uAC1C \uC774\uC0C1\uC758 \uD56D\uBAA9\uC744 \uCF54\uB4DC\uD53C\uCEE4\uC5D0 \uC124\uC815\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.";
                    } else {
                      if (self.options._grid === true && typeof self.options._gridCallback === "function") {
                        self.options._gridCallback(data, _column, itemIndex);
                        nextFocusFlag = true;
                      } else {
                        nextFocusFlag = true;
                      }
                    }
                  }
                };
                delete codeOption.callback;
                self.commitCell();
                helpEvent = new $.Event("codedialog", codeOption);
                self.$element.trigger(helpEvent);
                var dialog2 = dews.ui.dialog(helpEvent.code);
                if (dialog2) {
                  dialog2._kendoWindow.bind("close", function (e) {
                    self._grid.setFocus();
                  });
                }
                if (self._grid.getEditingItem()) {
                  _column.editor.firstClick = false;
                }
                self.$element.on("codedialogclosed", function (e) {
                  var current = {
                    itemIndex: itemIndex,
                    dataRow: dataIndex
                  };
                  if (codeOption.validation) {
                    codepickerValidation(self, _column, current);
                    if (codeOption.value[dataIndex].value === "") {
                      nextFocusFlag = false;
                    }
                    delete codeOption.codesearch;
                    if (nextFocusFlag && codeOption.moveFocus) {
                      dews.ui.gridUtil.nextFocus(self, "", parameter);
                    }
                  }
                  self.setFocus();
                  self._grid.commit();
                  self.$element.off("codedialogclosed");
                  _column.editor.firstClick = true;
                });
              }
            }
            if (column.editor === "button" || _column.editor.type === "button") {
              if (typeof _column.editor.click === "function") {
                _column.editor.click.call(self, parameter);
              }
            }
            if (column.editor === "zipcodepicker" || _column.editor.type === "zipcodepicker") {
              var _codeOption = _column.codeOption;
              if ($("#zipcodepicker-dialog").length === 0) {
                var callback = function callback(data) {
                  var result = {
                    zipcode: data.zonecode,
                    jibun: data.jibunAddress,
                    street: data.roadAddress
                  };
                  if (typeof _codeOption.callback === "function") {
                    _codeOption.callback.call(self, self.dataItem(self.select()), result, self.select());
                  } else {
                    self._grid.setValue(self.select(), fieldName, result[_codeOption.addressType]);
                  }
                  $("body").find(".postcode-wrapper").remove();
                };
                dialog = dews.ui.zipcodedialog();
                dialog.open(callback);
                $("#region_name").on("keydown", function (e) {
                  console.log(e);
                });
              }
            }
            if (column.editor === "month" || _column.editor.type === "month") {
              var monthpicker = _column.monthpicker;
              var editMonth = $("#" + self._grid.name + "_month");
              monthpicker.close();
              self.editCell();
              if (editMonth.length !== 0 && self._grid.columnByField(fieldName).editor.toLowerCase() === "month") {
                if (typeof monthpicker.dateView.calendar === "undefined") {
                  monthpicker.dateView._calendar();
                }
                var currentOffset = self._grid.getCellBounds(itemIndex, fieldName, false);
                monthpicker.wrapper.css({
                  visible: "hidden",
                  top: currentOffset.y,
                  left: currentOffset.x
                });
                monthpicker.dateView.calendar.navigate(self.getCellValue(self.select(), fieldName));
                var value = monthpicker._value;
                var getValue = self._grid.getValue(self.select(), fieldName);
                if (kendo.toString(value, "yyyy-MM") !== kendo.toString(getValue, "yyyy-MM") && kendo.toString(getValue, "yyyy-MM") === "") {
                  monthpicker._value = void 0;
                  monthpicker.value("");
                } else {
                  if (getValue === void 0) {
                    monthpicker._value = void 0;
                    monthpicker.value("");
                  } else {
                    monthpicker.value(getValue);
                  }
                }
                var topPosition;
                var contents = $("#contents");
                if (contents && currentOffset.y + currentOffset.height + 199 > contents.height() && currentOffset.y > 199) {
                  topPosition = currentOffset.y + self.$element.offset().top - 199;
                  monthpicker.dateView.popup.options.animation.open.effects = "slideIn:up";
                } else {
                  topPosition = currentOffset.y + currentOffset.height + self.$element.offset().top;
                  monthpicker.dateView.popup.options.animation.open.effects = "slideIn:down";
                }
                monthpicker.open();
                monthpicker.wrapper.css({
                  display: "none",
                  visible: "visibility"
                });
                var animationContainer = monthpicker.dateView.div.parent(".k-animation-container");
                var calendarPosition = currentOffset.x + self.$element.offset().left + animationContainer.width();
                var leftPosition = calendarPosition > $(window).width() ? currentOffset.x - (animationContainer.width() - currentOffset.width) : currentOffset.x;
                animationContainer.css({
                  top: topPosition,
                  left: leftPosition + self.$element.offset().left
                });
                monthpicker.on("change", function (e) {
                  self.options.commit = false;
                  var value2 = e.sender.value();
                  self.setCellValue(self.select(), self.getCurrentColumn(), value2);
                  self.commitCell();
                  self.closeCell();
                });
              }
            }
            if (column.editor === "year" || _column.editor.type === "year") {
              var yearpicker = _column.yearpicker;
              var editYear = $("#" + self._grid.name + "_year");
              yearpicker.close();
              self.editCell();
              if (editYear.length !== 0 && self._grid.columnByField(fieldName).editor.toLowerCase() === "year") {
                if (typeof yearpicker.dateView.calendar === "undefined") {
                  yearpicker.dateView._calendar();
                }
                var _currentOffset = self._grid.getCellBounds(itemIndex, fieldName, false);
                yearpicker.wrapper.css({
                  visible: "hidden",
                  top: _currentOffset.y,
                  left: _currentOffset.x
                });
                yearpicker.dateView.calendar.navigate(self.getCellValue(self.select(), fieldName));
                var _value = yearpicker._value;
                var _getValue = self._grid.getValue(self.select(), fieldName);
                if (kendo.toString(_value, "yyyy") !== kendo.toString(_getValue, "yyyy") && kendo.toString(_getValue, "yyyy") === "") {
                  yearpicker._value = void 0;
                  yearpicker.value("");
                } else {
                  if (_getValue === void 0) {
                    yearpicker._value = void 0;
                    yearpicker.value("");
                  } else {
                    yearpicker.value(_getValue);
                  }
                }
                var _topPosition;
                var _contents = $("#contents");
                if (_contents && _currentOffset.y + _currentOffset.height + 199 > _contents.height() && _currentOffset.y > 199) {
                  _topPosition = _currentOffset.y + self.$element.offset().top - 199;
                  yearpicker.dateView.popup.options.animation.open.effects = "slideIn:up";
                } else {
                  _topPosition = _currentOffset.y + _currentOffset.height + self.$element.offset().top;
                  yearpicker.dateView.popup.options.animation.open.effects = "slideIn:down";
                }
                yearpicker.open();
                yearpicker.wrapper.css({
                  display: "none",
                  visible: "visibility"
                });
                var _animationContainer = yearpicker.dateView.div.parent(".k-animation-container");
                var _calendarPosition = _currentOffset.x + self.$element.offset().left + _animationContainer.width();
                var _leftPosition = _calendarPosition > $(window).width() ? _currentOffset.x - (_animationContainer.width() - _currentOffset.width) : _currentOffset.x;
                _animationContainer.css({
                  top: _topPosition,
                  left: _leftPosition + self.$element.offset().left
                });
                yearpicker.on("change", function (e) {
                  self.options.commit = false;
                  var value2 = e.sender.value();
                  self.setCellValue(self.select(), self.getCurrentColumn(), value2);
                  self.commitCell();
                  self.closeCell();
                });
              }
            }
            if (column.editor === "time" || _column.editor.type === "time") {
              var timepicker = _column.timepicker;
              if (timepicker) {
                if (_column.editor.min && typeof _column.editor.min === "string") {
                  timepicker.min(_column.editor.min);
                } else {
                  timepicker.min("0000");
                }
                if (_column.editor.max && typeof _column.editor.max === "string") {
                  timepicker.max(_column.editor.max);
                } else {
                  timepicker.max("0000");
                }
                var useAP = _column.editor.format;
                if (typeof timepicker.setOptions === "function") {
                  timepicker.setOptions({
                    interval: _column.editor.interval || 30
                  });
                  if (column.editor.useAP) {
                    useAP = "hh:mm tt";
                  }
                  timepicker.setOptions({
                    format: useAP
                  });
                } else if (typeof timepicker.kendoInstance !== "undefined") {
                  timepicker.kendoInstance.setOptions({
                    interval: _column.editor.interval || 30
                  });
                  if (column.editor.useAP) {
                    useAP = "hh:mm tt";
                  }
                  timepicker.kendoInstance.setOptions({
                    format: useAP
                  });
                }
              }
              var time = $("#" + self._grid.name + "_time");
              timepicker.close();
              self.editCell();
              if (time.length !== 0 && self._grid.columnByField(column.fieldName).editor.toLowerCase() === "time") {
                var _currentOffset2 = self._grid.getCellBounds(itemIndex, fieldName, false);
                timepicker.wrapper.css({
                  visible: "hidden",
                  top: _currentOffset2.y,
                  left: _currentOffset2.x
                });
                var _topPosition2;
                var _contents2 = $("#contents");
                if (_contents2 && _currentOffset2.y + _currentOffset2.height + 199 > _contents2.height() && _currentOffset2.y > 199) {
                  _topPosition2 = _currentOffset2.y + self.$element.offset().top - 199;
                  timepicker.timeView.popup.options.animation.open.effects = "slideIn:up";
                } else {
                  _topPosition2 = _currentOffset2.y + _currentOffset2.height + self.$element.offset().top;
                  timepicker.timeView.popup.options.animation.open.effects = "slideIn:down";
                }
                timepicker.open();
                timepicker.wrapper.css({
                  display: "none",
                  visible: "visibility"
                });
                var _animationContainer2 = timepicker.timeView.ul.parent("div").parent(".k-animation-container");
                _animationContainer2.css({
                  top: _topPosition2,
                  left: _currentOffset2.x + self.$element.offset().left
                });
                timepicker.on("change", function (e) {
                  self.options.commit = false;
                  var value = e.sender.value();
                  self.setCellValue(self.select(), self.getCurrentColumn(), value);
                  self.commitCell();
                  self.closeCell();
                });
              }
            }
          },
          _gridCallback: function _gridCallback(self, data, columns, index) {
            var item,current,column,dataIndex = self.getDataIndexFromItemIndex(index);
            if ($.type(data) === "array" && data.length === 1) {
              item = data[0];
            } else if ($.type(data) === "object") {
              item = data;
            }
            if (item) {
              current = index;
              column = columns;
              self.closeCell();
              if (self.options.callback && $.type(self.options.callback) === "function") {
                if (self.$element.closest(".dews-data-control").hasClass("dews-ui-treegrid")) {
                  current = self._grid.getDataRow(index);
                }
                self.options.callback.call(self, self.dataItem(current), item, current);
              } else {
                self._grid.setValue(current, column.fieldName, item[column.editor.textField]);
                if ($.type(column.codeOption.gridCodeField) !== "undefined") {
                  self._grid.setValue(
                  current,
                  column.codeOption.gridCodeField,
                  item[column.editor.codeField]);

                }
                if ($.type(column.codeOption.gridTextField) !== "undefined") {
                  self._grid.setValue(
                  current,
                  column.codeOption.gridTextField,
                  item[column.editor.textField]);

                }
              }
              delete column.codeOption.codesearch;
              if (current === self.select() && column.field === self.getCurrentColumn() && column.codeOption.moveFocus) {
                dews.ui.gridUtil.nextFocus(self, index);
              }
              if (column.codeOption.validation) {
                var code = item[column.editor.codeField];
                var text = item[column.editor.textField];
                var value = self._grid.getValue(index, column.fieldName);
                column.codeOption.value[dataIndex] = codeOptionValue(code, text, value);
              }
              self._grid.commit();
            }
          },
          onLinkableCellClicked: function onLinkableCellClicked(self, index, linkUrl, parameter) {
            if (self.columns[index.column].formats.useMenu) {
              var module = self.columns[index.column].formats.module,menu = self.columns[index.column].formats.menu,data = self.columns[index.column].formats.data;
              if ($.type(module) === "function") {
                module = module.call(self, parameter);
              }
              if ($.type(menu) === "function") {
                menu = menu.call(self, parameter);
              }
              if ($.type(data) === "function") {
                data = data.call(self, parameter);
              } else if ($.type(data) !== "object") {
                data = {};
              }
              dews.ui.openMenu(module, menu, data);
            } else {
              window.open(dews.url.getAbsoluteUrl(linkUrl), "_blank");
            }
          },
          onShowEditor: function onShowEditor(self, id, index, parameter) {
            if ($.type(index.fieldName) !== "null") {
              var field = index.fieldName,align = self._grid.getColumnProperty(index.fieldName, "styles").textAlignment,event,textAlign = "center",editInput = $("#" + id.name + "_line", self.options.$content),editDropdown = $("#" + id.name + "_dropdown", self.options.$content),multiInput = $("#" + id.name + "_multiline", self.options.$content),editDate = $("#" + id.name + "_date", self.options.$content),editPass = $("#" + id.name + "_password", self.options.$content);
              event = new $.Event("cellEditing", parameter);
              self.$element.trigger(event);
              if ($.type(self.options.editValue) === "boolean" && !self.options.editValue) {
                var result = self.options.editValue;
                delete self.options.editValue;
                return result;
              }
              if (self.options.searchText) {
                closeSearch(self);
              }
              switch (align) {
                case "far":
                  textAlign = "right";
                  break;
                case "near":
                  textAlign = "left";
                  break;
                default:
                  break;}

              if (editInput.length !== 0 && self._grid.columnByField(index.column).editor.toLowerCase() !== "date" && self._grid.columnByField(index.column).editor.toLowerCase() !== "dropdown" && self._grid.columnByField(index.column).editor.toLowerCase() !== "password" && self._grid.columnByField(index.column).editor.toLowerCase() !== "multiline") {
                editInput.css("textAlign", textAlign);
                editInput.select();
              }
              if (editDate.length !== 0 && self._grid.columnByField(index.column).editor.toLowerCase() === "date") {
                editDate.css("textAlign", textAlign);
                editDate.select();
              }
              if (editDropdown.length !== 0 && self._grid.columnByField(index.column).editor.toLowerCase() === "dropdown") {
                editDropdown.css("textAlign", textAlign);
                editDropdown.select();
                var column = self._grid.columnByName(index.fieldName);
                var value = self._grid.getValue(index.itemIndex, index.fieldName),textLabel;
                for (var i = 0; i < column.values.length; i++) {
                  if (column.values[i] === value) {
                    textLabel = column.labels[i];
                    editDropdown.one("select", { text: textLabel }, function (e) {
                      self._grid.setEditValue(e.data.text, false, false);
                    });
                    break;
                  }
                }
                if (column.editorOptions && column.editorOptions.dataSelectable && column.editorOptions.values.length === 0 && column.editorOptions.labels.length === 0) {
                  return false;
                }
              }
              if (editPass.length !== 0 && self._grid.columnByField(index.column).editor.toLowerCase() === "password") {
                editPass.css("textAlign", textAlign);
                editPass.select();
              }
              if (multiInput.length !== 0 && self._grid.columnByField(index.column).editor.toLowerCase() === "multiline") {
                multiInput.css("textAlign", textAlign);
              }
              if (self.columns[field] && self.columns[field].editor.type.toLowerCase() === "codepicker") {
                $(window).trigger("disableMainArea");
                if (self.columns[field].codeOption.validation) {
                  self.columns[field].codeOption.value[index.dataRow] = {
                    value: self._grid.getValue(index.itemIndex, field)
                  };
                }
                self._useCodesearch = true;
                self.columns[field].codeOption.codesearch = true;
              }
              self.editable = true;
              return true;
            }
          },
          onHideEditor: function onHideEditor(self, grid, index) {var _column$editor7, _column$editor7$type, _column$editor8, _column$editor8$type;
            var column = self.columns[index.fieldName];
            if (self._grid.getEditValue() !== "") {var _column$editor6, _column$editor6$type;
              if ((column === null || column === void 0 ? void 0 : (_column$editor6 = column.editor) === null || _column$editor6 === void 0 ? void 0 : (_column$editor6$type = _column$editor6.type) === null || _column$editor6$type === void 0 ? void 0 : _column$editor6$type.toLowerCase()) === "codepicker" && self._grid.getColumnProperty(column.name, "buttonVisibility") === "visible") {
                var codeOption = column.codeOption;
                if (typeof self.options.callback === "function") {
                  delete self.options.callback;
                }
                if (column.editor.callback) {
                  self.options.callback = column.editor.callback;
                }
                if (typeof column.editor.helpParams === "function") {
                  codeOption.params = column.editor.helpParams.call(self, {
                    data: self._innerOptions._gridType === "GRID" ? self.dataItem(index.itemIndex) : self.dataItem(index.dataRow)
                  });
                } else {
                  codeOption.params = column.editor.helpParams;
                }
                var keyword = self._grid.getValue(index.itemIndex, column.field);
                codeOption.params = $.extend(true, codeOption.params, { keyword: keyword });
                codeOption.callbacks = function (data) {
                  if (typeof data !== "undefined") {
                    if (Array.isArray(data) && data.length !== 1 || !codeOption.useAjax) {
                      self._grid.onImageButtonClicked.call(self, self._grid, index.itemIndex, column);
                    } else {
                      if (self.options._grid === true && typeof self.options._gridCallback === "function") {
                        self.options._gridCallback(data, column, index.itemIndex);
                        delete codeOption.codesearch;
                        if (codeOption.moveFocus) {
                          dews.ui.gridUtil.nextFocus(self, index);
                        }
                      }
                    }
                  } else {
                    self._grid.onImageButtonClicked.call(self, self._grid, index.itemIndex, column);
                  }
                };
                delete codeOption.callback;
                if (keyword !== "" && keyword !== null) {
                  if (self._grid.getEditingItem()) {
                    keyword = self._grid.getEditingItem().values[column.fieldName];
                  }
                  if (typeof codeOption.value[index.dataRow] !== "undefined" && keyword !== codeOption.value[index.dataRow].value) {
                    if (!codeOption.apiUrl) {
                      $(window).trigger("enableMainArea");
                    }
                    var helpEvent = new $.Event("codesearch", codeOption);
                    self.$element.closest(".dews-data-control").trigger(helpEvent);
                  }
                } else if (keyword === "" && codeOption.value[index.dataRow].value !== "") {
                  self._grid.setValue(index.itemIndex, column.fieldName, "");
                  if (typeof codeOption.gridCodeField !== "undefined") {
                    self._grid.setValue(index.itemIndex, codeOption.gridCodeField, keyword);
                  }
                  if (typeof codeOption.gridTextField !== "undefined") {
                    self._grid.setValue(index.itemIndex, codeOption.gridTextField, keyword);
                  }
                  codeOption.value[index.dataRow] = codeOptionValue(keyword, keyword, keyword);
                  delete self._useCodesearch;
                }
              }
            }
            if ((column === null || column === void 0 ? void 0 : (_column$editor7 = column.editor) === null || _column$editor7 === void 0 ? void 0 : (_column$editor7$type = _column$editor7.type) === null || _column$editor7$type === void 0 ? void 0 : _column$editor7$type.toLowerCase()) === "month") {
              column.monthpicker.close();
              column.monthpicker.off("change");
            }
            if ((column === null || column === void 0 ? void 0 : (_column$editor8 = column.editor) === null || _column$editor8 === void 0 ? void 0 : (_column$editor8$type = _column$editor8.type) === null || _column$editor8$type === void 0 ? void 0 : _column$editor8$type.toLowerCase()) === "time") {
              column.timepicker.close();
              column.timepicker.off("change");
            }
          },
          onContextMenuPopup: function onContextMenuPopup(self, currentCell, parameter) {
            var displayIndex = [],items = [],displayMenu = [];
            if ($.type(self._grid.getSortedFields() !== "null")) {
              parameter.row.index = currentCell.itemIndex;
              parameter.row.data = self.dataItem(currentCell.itemIndex);
              parameter.cell.data = self._grid.getValue(currentCell.itemIndex, currentCell.fieldName);
            }
            items = convertContextMenuOptions(self, self.options.contextMenu, parameter, false);
            self._grid.setContextMenu(items);
          },
          onContextMenuItemClicked: function onContextMenuItemClicked(self, index, label, parameter) {
            if ($.type(self._grid.getSortedFields() !== "null")) {
              parameter.row.index = index.itemIndex;
              parameter.row.data = self.dataItem(index.itemIndex);
              parameter.cell.data = self._grid.getValue(index.itemIndex, index.fieldName);
            }
            contextMenuCallBack(self, self.options.contextMenu, label, parameter);
          },
          onGetEditValue: function onGetEditValue(self, index, editResult) {
            var column = self.columns[index.fieldName];
            if (column && column.editor && column.editor.type.toLowerCase() === "dropdown" && $.type(column.editor.dataSource) === "function") {
              if (column.editor.dataValueField && column.editor.dataTextField) {
                if ($.type(column.editor.textField) === "undefined") {
                  self._grid.setValue(index.itemIndex, column.editor.dataTextField, editResult.text);
                } else {
                  self._grid.setValue(index.itemIndex, column.editor.textField, editResult.text);
                }
              }
            }
            if (column && column.editor && column.editor.type.toLowerCase() === "dropdown" && !column.editor.textReadOnly) {
              if (column.labels.indexOf(self._grid.getEditValue()) === -1 && column.values.indexOf(self._grid.getEditValue()) === -1) {
                self._grid.cancel();
              }
            }
          },
          onPaste: function onPaste(self, index, e) {
            var column = self.columns[self._grid.getCurrent().fieldName];
            if (column.editor.type.toLowerCase() === "dropdown" && self.options.copyMode !== "row") {
              var copyText = $.type(e.clipboardData) === "undefined" ? window.clipboardData.getData("Text") : e.clipboardData.getData("Text");
              if ($.type(column.labels) === "array" && column.labels.indexOf(copyText.trim()) !== -1) {
                var cellData = column.values[column.labels.indexOf(copyText.trim())];
                self._grid.setValue(index.itemIndex, index.column, cellData);
                return false;
              } else if ($.type(column.values) === "array" && column.values.indexOf(copyText.trim()) === -1) {
                return false;
              }
            }
          },
          extend__$_convertValue: function extend__$_convertValue(originFunc) {
            return function (ds, options, column, s, vals) {
              var idx = column.dataIndex();
              var fld = ds.getField(idx);
              if (fld.dataType() === "number") {
                s = s.replace(/(\()(\d+\.?\d+)(\))/g, "-$2");
              }
              if (column._editor === "dropDown") {
                var ddlSourceArray = column._editorOptions.dataSource.options.data,targetIndex = -1,i;
                if (ddlSourceArray && ddlSourceArray.length) {
                  for (i = 0; i < ddlSourceArray.length; i++) {
                    if (ddlSourceArray[i][column._editorOptions.dataTextField] === s || ddlSourceArray[i][column._editorOptions.dataValueField] === s) {
                      targetIndex = i;
                      break;
                    }
                  }
                  if (targetIndex > -1) {
                    s = column._lookupValues[targetIndex];
                  } else {
                    s = "";
                  }
                }
              } else if (column._valueType === "datetime") {
                if (column._editor === "month") {
                  if (kendo.parseDate(
                  s,
                  dews._environments.formats.monthValueFormat,
                  kendo.getCulture()) !==
                  null) {
                    s = kendo.parseDate(
                    s,
                    dews._environments.formats.monthValueFormat,
                    kendo.getCulture());

                  } else if (kendo.parseDate(s, dews._environments.formats.monthFormat, kendo.getCulture()) !== null) {
                    s = kendo.parseDate(s, dews._environments.formats.monthFormat, kendo.getCulture());
                  }
                } else if (column._editor === "time") {
                  if (kendo.parseDate(
                  s,
                  dews._environments.formats.timeValueFormat,
                  kendo.getCulture()) !==
                  null) {
                    s = kendo.parseDate(
                    s,
                    dews._environments.formats.timeValueFormat,
                    kendo.getCulture());

                  } else if (kendo.parseDate(s, dews._environments.formats.timeFormat, kendo.getCulture()) !== null) {
                    s = kendo.parseDate(s, dews._environments.formats.timeFormat, kendo.getCulture());
                  }
                } else if (column._editor === "date") {
                  if (kendo.parseDate(
                  s,
                  dews._environments.formats.dateValueFormat,
                  kendo.getCulture()) !==
                  null) {
                    s = kendo.parseDate(
                    s,
                    dews._environments.formats.dateValueFormat,
                    kendo.getCulture());

                  } else if (kendo.parseDate(s, dews._environments.formats.dateFormat, kendo.getCulture()) !== null) {
                    s = kendo.parseDate(s, dews._environments.formats.dateFormat, kendo.getCulture());
                  }
                }
              }
              return originFunc.call(null, ds, options, column, s, vals);
            };
          },
          extend__$_pasteSingleCell: function extend__$_pasteSingleCell(originFunc, clipboardManager) {
            return function (index, s, convert) {
              if (index._column._editable) {
                originFunc.call(clipboardManager, index, s, convert);
              }
            };
          },
          extend__$_cellWritable: function extend__$_cellWritable(originFunc, clipboardManager) {
            return function (index) {
              if (index._column._editable === false) {
                return false;
              }
              return originFunc.call(clipboardManager, index);
            };
          },
          onEditRowPasted: function onEditRowPasted(self, itemIndex, fieldName, fieldIndex, newValues, className, isCell) {
            var currentData = {
              itemIndex: itemIndex,
              column: fieldName,
              dataRow: self._grid.getDataRow(itemIndex),
              fieldIndex: fieldIndex,
              fieldName: fieldName
            };
            var column = self.columns[currentData.fieldName];
            changePastedData(self, currentData, itemIndex, column, newValues, className, isCell);
          },
          checkCriteriaVal: function checkCriteriaVal(value) {
            var replace;
            if (value && typeof value === "string" && value.indexOf("'") !== -1) {
              replace = value.replace(/\'/g, "\\'");
            } else {
              replace = value;
            }
            return replace;
          },
          nextFocus: function nextFocus(self, index, parameter) {
            if ($.type(parameter) !== "undefined") {
              index = {};
              index.itemIndex = self._grid.getItemIndex(parameter.row.index);
              index.dataRow = parameter.row.index;
              index.column = parameter.cell.field;
              index.fieldName = parameter.cell.field;
            }
            if ($.type(self._grid.getEditValue()) !== "undefined" || self._grid.getCurrent().itemIndex !== index.itemIndex || self._grid.getCurrent().fieldName !== index.fieldName || self._grid.getValue(index.itemIndex, index.fieldName) === null) {
              return;
            }
            var displayColumn = self.options.displayColumns,idxValue = 0,column,rowIndex = index.itemIndex,rowData = self.dataItem(self._grid.getDataRow(index.itemIndex)),rowLength = self._grid.getItemCount(),columnLength = displayColumn.length,editParams = {
                grid: self,
                row: {
                  index: rowIndex,
                  data: rowData
                },
                cell: {
                  field: ""
                }
              };
            $.each(displayColumn, function (idx, column2) {
              idxValue = column2.field === index.column ? idx : idxValue;
            });
            if ($.type(self.options.editSkip) !== "undefined" && self.options.editSkip) {
              for (var j = rowIndex; j < rowLength; j++) {
                editParams.row.index = self._grid.getDataRow(j);
                editParams.row.data = self.dataItem(j);
                for (var i = idxValue + 1; i < columnLength; i++) {
                  editParams.cell.field = displayColumn[i].fieldName;
                  column = self.columns[displayColumn[i].fieldName];
                  var condition = $.type(self.options.rowEditable) !== "undefined" ? !column.editor.flag ? !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable")) || !($.type(self.options.rowEditable) === "function" ? self.options.rowEditable.call(self, editParams) : self.options.rowEditable) : !self.options.rowEditable.call(self, editParams) : !($.type(column.editor.editable) === "function" ? column.editor.editable.call(self, editParams) : self._grid.getColumnProperty(column.field, "editable"));
                  if (!condition) {
                    self._grid.setCurrent({
                      itemIndex: j,
                      column: column.fieldName,
                      dataRow: j,
                      fieldIndex: i,
                      fieldName: column.fieldName
                    });
                    return;
                  }
                }
                idxValue = -1;
              }
            } else {
              if (idxValue === columnLength - 1 && rowIndex === rowLength - 1) {
                return;
              } else if (idxValue === columnLength - 1 && rowIndex < rowLength) {
                self._grid.setCurrent({
                  itemIndex: rowIndex + 1,
                  column: displayColumn[0].fieldName,
                  dataRow: index.dataRow + 1,
                  fieldIndex: 0,
                  fieldName: displayColumn[0].fieldName
                });
                return;
              } else if (idxValue < columnLength) {
                self._grid.setCurrent({
                  itemIndex: rowIndex,
                  column: displayColumn[idxValue + 1].fieldName,
                  dataRow: index.dataRow,
                  fieldIndex: idxValue + 1,
                  fieldName: displayColumn[idxValue + 1].fieldName
                });
                return;
              }
            }
          },
          initOneGridOptions: function initOneGridOptions(self, oneGridData, options) {
            if (oneGridData.items && oneGridData.items.length > 0) {
              var oneGridItems = oneGridData.items;
              var gridItem = oneGridItems.filter(function (oneGridItems2) {
                return oneGridItems2.type === self._onegrid._onegridType && oneGridItems2.id === self._onegrid._gridID;
              });
              if (gridItem.length > 0 && gridItem[0].content) {
                if (oneGridData.authority === 3) {
                  self._onegrid.loadData = gridItem[0].content.useColumns;
                } else {
                  self._onegrid.loadData = gridItem[0].content.columns;
                }
                self._onegrid.fixed = gridItem[0].content.fixed;
                options.fixed = self._onegrid.fixed;
              }
            }
            if (self._onegrid.loadData) {
              options.columns = dews.ui.gridUtil.setInitColumns(
              self._onegrid.baseColumns,
              self._onegrid.loadData);

              self._onegrid.initColumns = options.columns;
            }
          },
          setInitColumns: function setInitColumns(baseColumns, loadData) {
            var resultColumns = [],column;
            for (var i = 0; i < baseColumns.length; i++) {
              var baseColumn = $.extend(true, {}, baseColumns[i]);
              if (loadData && loadData.length > 0) {
                column = loadData.filter(function (c) {
                  if (baseColumn.field === c.field || baseColumn === c.name) {
                    baseColumn.width = c.width;
                    if (c.isVisible === false) {
                      baseColumn.visible = false;
                    } else {
                      baseColumn.visible = true;
                    }
                    return baseColumn;
                  }
                });
              }
              if (column) {
                if (column.length === 0) {
                  if (baseColumn.columns) {
                    baseColumn.columns = dews.ui.gridUtil.setInitColumns(baseColumn.columns);
                  }
                } else {
                  if (baseColumn.columns) {
                    baseColumn.columns = dews.ui.gridUtil.setInitColumns(
                    baseColumn.columns,
                    column[0].columns);

                  }
                }
              }
              resultColumns.push(baseColumn);
            }
            return resultColumns;
          },
          setDisplayIndexColumns: function setDisplayIndexColumns(grid, baseColumns, loadColumns) {
            var resultColumns = [];
            for (var i = 0; i < loadColumns.length; i++) {
              var column, resultColumn;
              column = baseColumns.filter(function (c) {
                if (c.field === loadColumns[i].field) {
                  return c;
                }
              });
              if (column.length > 0) {
                grid._grid.setColumnProperty(column[0].field, "displayIndex", i);
                resultColumn = column[0];
                resultColumn = grid._grid.columnByName(column[0].field);
                if (loadColumns[i].fixed) {
                  resultColumn._fixed = loadColumns[i].fixed;
                }
                if (loadColumns[i].columns) {
                  resultColumn.columns = dews.ui.gridUtil.setDisplayIndexColumns(
                  grid,
                  column[0].columns,
                  loadColumns[i].columns);

                }
                resultColumns.push(resultColumn);
              }
            }
            baseColumns.filter(function (col) {
              var check = true;
              loadColumns.forEach(function (c) {
                if (col.field === c.field) {
                  check = false;
                }
              });
              if (check) {
                if (typeof col.visible === "boolean" ? col.visible : true) {
                  return true;
                }
              }
            }).forEach(function (addCol) {
              resultColumns.push(grid._grid.columnByName(addCol.field));
            });
            return resultColumns;
          },
          setOnegridDialogColumns: function setOnegridDialogColumns(grid, columns) {
            var resultColumns = columns.slice(0);
            for (var i = 0; i < columns.length; i++) {
              var column = grid._grid.columnByName(columns[i].name);
              if (column) {
                var s;
                resultColumns.some(function (c, index) {
                  if (c.name === column.name) {
                    s = index;
                  }
                });
                if (columns[i].columns) {
                  column.columns = dews.ui.gridUtil.setOnegridDialogColumns(grid, columns[i].columns);
                }
                if (grid._onegrid.fixed.leftColumns.indexOf(column.name) > -1) {
                  column._fixed = column._fixed ? column._fixed : {};
                  column._fixed.type = "fixed";
                }
                if (grid._onegrid.fixed.rightColumns.indexOf(column.name) > -1) {
                  column._fixed = column._fixed ? column._fixed : {};
                  column._fixed.type = "fixed";
                }
                if (column.displayIndex !== -1) {
                  resultColumns.splice(s, 1);
                  resultColumns.splice(column.displayIndex, 0, column);
                }
              }
            }
            return resultColumns;
          },
          setDisplayColumns: function setDisplayColumns(grid, columnsField) {
            var columns = [];
            for (var i = 0; i < columnsField.length; i++) {
              var field = columnsField[i],column;
              if (field.columns) {
                column = grid._grid.columnByName(field.name);
                column.columns = dews.ui.gridUtil.setDisplayColumns(grid, field.columns);
                columns.push(column);
              } else {
                columns.push(grid._grid.columnByName(field));
              }
            }
            return columns;
          },
          getFixedColumns: function getFixedColumns(self) {
            var displayColumns = self._grid.getDisplayColumns();
            var fixedOptions = self._grid.getFixedOptions();
            var colCount = fixedOptions.colCount,rightColCount = fixedOptions.rightColCount;
            var leftColumns = [],rightColumns = [];
            for (var i = 0; i < displayColumns.length; i++) {
              if (_typeof(displayColumns[i]) === "object") {
                displayColumns[i] = displayColumns[i].name;
              }
              if (i < colCount) {
                leftColumns.push(displayColumns[i]);
              } else if (i >= displayColumns.length - rightColCount) {
                rightColumns.push(displayColumns[i]);
              }
            }
            return {
              leftColumns: leftColumns,
              rightColumns: rightColumns
            };
          },
          notExistFieldNaming: function notExistFieldNaming(columns, depth) {
            var d = depth;
            for (var idx = 0; idx < columns.length; idx++) {
              if (columns[idx].columns) {
                if (!columns[idx].field) {
                  columns[idx].field = "_he@der_name_" + d + idx;
                }
                dews.ui.gridUtil.notExistFieldNaming(columns[idx].columns, d + 1);
              }
            }
          },
          setSelectedStyle: function setSelectedStyle(self, opt) {
            self._grid.setDisplayOptions({
              focusColor: opt.selectedBorderColor,
              focusBackground: opt.selectedBackground
            });
          },
          getItemIndexFromDataIndex: function getItemIndexFromDataIndex(self, dataIndex) {
            var itemIndex = self._grid.getItemIndex(dataIndex);
            if (itemIndex < 0)
            return null;else

            return itemIndex;
          },
          getDataIndexFromItemIndex: function getDataIndexFromItemIndex(self, itemIndex) {
            var dataIndex = self._grid.getDataRow(itemIndex);
            if (dataIndex < 0)
            return null;else

            return dataIndex;
          },
          getDynamicColumn: function getDynamicColumn(self, field) {
            var dynamicOptions = {
              title: self._grid.columnByName(field).header.text,
              displayWidth: self._grid.columnByName(field).displayWidth
            };
            return dynamicOptions;
          },
          multiSelect: function multiSelect(self, startItem, endItem, startColumn, endColumn) {
            var colStart,colEnd,colIndex = [];
            var columns = self._grid.getColumnNames(true, true);
            if (arguments[1] === void 0) {
              colStart = self._grid.getSelection().startColumn;
              colEnd = self._grid.getSelection().endColumn;
              for (var i = 0; i < columns.length; i++) {
                if (columns[i] == colStart) {
                  colIndex.push(i);
                } else if (columns[i] == colEnd) {
                  colIndex.push(i);
                } else {
                }
              }
              if (colStart === colEnd) {
                colIndex.push(colIndex[0]);
              }
              var multiCells = {
                columns: columns.slice(colIndex[0], colIndex[1] + 1),
                rows: self._grid.getSelectedItems()
              };
              return multiCells;
            } else if (arguments[4] !== void 0) {
              var sel = {
                style: "block",
                startItem: startItem,
                endItem: endItem,
                startColumn: startColumn,
                endColumn: endColumn
              };
              self._grid.setSelection(sel);
            } else {
              return;
            }
          },
          openSimpleCalculatorDialog: function openSimpleCalculatorDialog(self) {
            if (!self || !self._grid)
            return;
            var selectionDatas = self._grid.getSelectionData();
            if (!selectionDatas || selectionDatas.length <= 0)
            return;
            var selectionColumns = Object.keys(selectionDatas[0]);
            var isNotNumber = false;
            var numberList = [];
            $.each(selectionColumns, function (idx, selectionColumn) {
              $.each(selectionDatas, function (idx2, selectionDataRow) {
                var cellData = selectionDataRow[selectionColumn];
                if (!cellData && cellData != 0) {
                  return true;
                }
                var cellDataNumber = convertNumber(cellData);
                if (!cellDataNumber && cellDataNumber != 0) {
                  isNotNumber = true;
                  return false;
                }
                if (cellDataNumber || cellDataNumber == 0) {
                  var pushData = {
                    calculator: "plus",
                    value: cellDataNumber
                  };
                  numberList.push(pushData);
                }
              });
              if (isNotNumber) {
                return false;
              }
            });
            if (isNotNumber) {
              dews.ui.snackbar.warning(
              dews.localize.get(
              "\uC120\uD0DD\uD55C \uC601\uC5ED\uC5D0 \uC22B\uC790 \uD0C0\uC785\uC774 \uC544\uB2CC \uCEEC\uB7FC\uC774 \uD3EC\uD568\uB418\uC5B4 \uC788\uC2B5\uB2C8\uB2E4.",
              "dews_\uC120\uD0DD\uD55C \uC601\uC5ED\uC5D0 \uC22B\uC790 \uD0C0\uC785\uC774 \uC544\uB2CC \uCEEC\uB7FC\uC774 \uD3EC\uD568\uB418\uC5B4 \uC788\uC2B5\uB2C8\uB2E4."));


              return;
            }
            if (numberList.length <= 0)
            return;
            try {
              var dialog2 = dews.ui.dialog("simpleCalculator");
              dialog2.grid.dataSource.data(numberList);
              setSimpleCalculatorResult.bind(dialog2)();
            } catch (e) {
              var dialog2 = dews.ui.dialog("simpleCalculator", {
                title: dews.localize.get("\uAC04\uC774\uACC4\uC0B0\uAE30", "dews_\uAC04\uC774\uACC4\uC0B0\uAE30"),
                modal: false,
                buttons: "close",
                width: 573,
                height: 526,
                content: "<div class=\"dews-dialog-contents-area\">\n  <div class=\"dews-grid-calculator-area\">\n    <div class=\"dews-grid-calculator\">\n      <div class=\"dews-grid-calculator-button-group\">\n        <div class=\"reset-button\">\n          <button id=\"btnClear\" class=\"dews-ui-button\">\uCD08\uAE30\uD654</button>\n        </div>\n        <div class=\"line-button\">\n          <button id=\"btnAddRow\" class=\"dews-ui-button\">\uB77C\uC778\uCD94\uAC00</button>\n        </div>\n        <div class=\"calculate-button\">\n          <button id=\"btnPlus\" class=\"dews-ui-button plus\"></button>\n          <button id=\"btnMinus\" class=\"dews-ui-button minus\"></button>\n          <button id=\"btnMultiply\" class=\"dews-ui-button multiply\"></button>\n          <button id=\"btnDivide\" class=\"dews-ui-button divide\"></button>\n        </div>\n      </div>\n      <div id=\"grid\" class=\"dews-ui-grid\"></div>\n      <div class=\"dews-grid-calculator-result\">\n        <span class=\"title\">\uACB0\uACFC\uAC12:</span>\n        <span id=\"resultValue\" class=\"result\">0</span>\n      </div>\n    </div>\n    <div class=\"dews-grid-calculator-info\">\n      <div class=\"calculator-info select\">\n        <span class=\"info-title\">\uACB0\uACFC \uAC12\uC5D0 \uB300\uD55C \uC18C\uC218\uC810 \uAD00\uB9AC</span>\n        <ul class=\"info \">\n          <li>\n            <span class=\"title\">\xB7\uC790\uB9BF\uC218</span>\n            <select id=\"digits\" class=\"dews-ui-dropdownlist\" data-dews-show-tooltip=\"true\">\n              <option value=\"0\">\uC18C\uC218\uC810\uC5C6\uC74C</option>\n              <option value=\"1\">1\uC9F8 \uC790\uB9AC</option>\n              <option value=\"2\">2\uC9F8 \uC790\uB9AC</option>\n              <option value=\"3\">3\uC9F8 \uC790\uB9AC</option>\n              <option value=\"4\">4\uC9F8 \uC790\uB9AC</option>\n            </select>\n          </li>\n          <li>\n            <span class=\"title\">\xB7\uC808\uC0AC</span>\n            <select id=\"cutting\" class=\"dews-ui-dropdownlist\" data-dews-show-tooltip=\"true\">\n              <option value=\"round\">\uBC18\uC62C\uB9BC</option>\n              <option value=\"floor\">\uC808\uC0AC</option>\n              <option value=\"ceil\">\uC808\uC0C1</option>\n            </select>\n          </li>\n        </ul>\n      </div>\n      <div class=\"calculator-info detail\">\n        <span class=\"info-title\">\uAC12\uC5D0 \uB300\uD55C \uAE30\uBCF8\uC815\uBCF4</span>\n        <ul class=\"info \">\n          <li><span class=\"title\">\xB7Min</span><span id=\"resultMin\" class=\"number\">NaN</span></li>\n          <li><span class=\"title\">\xB7Max</span><span id=\"resultMax\" class=\"number\">NaN</span></li>\n          <li><span class=\"title\">\xB7\uAC1C\uC218</span><span id=\"resultCount\" class=\"number\">0</span></li>\n          <li><span class=\"title\">\xB7\uD3C9\uADE0</span><span id=\"resultAvg\" class=\"number\">0</span></li>\n          <li><span class=\"title\">\xB7\uD569\uACC4</span><span id=\"resultSum\" class=\"number\">0</span></li>\n        </ul>\n      </div>\n    </div>\n  </div>\n  <div class=\"dews-grid-calculator-tip\">\n    <span class=\"title\">\uC0AC\uC6A9Tip</span>\n    <p>\n      \uCD94\uAC00(Ins), \uC0AD\uC81C(Del), \uCD08\uAE30\uD654(F8) \uB2E8\uCD95\uD0A4 \uD1B5\uD574 \uBC84\uD2BC \uC0AC\uC6A9\uC774 \uAC00\uB2A5\uD558\uACE0,<br>\n      Alt + \uB9C8\uC6B0\uC2A4 \uC88C\uD074\uB9AD + \uB4DC\uB798\uADF8\uB97C \uD1B5\uD574 \uADF8\uB9AC\uB4DC \uAC12\uC744 \uC0C8\uB85C \uAC00\uC838\uC62C \uC218 \uC788\uC2B5\uB2C8\uB2E4.\n    </p>\n  </div>",
                open: function open() {
                  dews.ready(function () {
                    var self2 = this;
                    var dialog3 = dews.ui.dialog(self2.$content.attr("ID"));
                    dialog3.buttons.ok.on("click", function (e2) {
                      dialog3.ok();
                    });
                    var gridDataSource = dews.ui.dataSource("dataSource", {
                      grid: true,
                      data: numberList,
                      schema: {
                        model: {
                          id: "data",
                          fields: [
                          { field: "calculator" },
                          { field: "value" },
                          { field: "delete" }]

                        }
                      }
                    });
                    var grid = dews.ui.grid("#grid", {
                      dataSource: gridDataSource,
                      editable: true,
                      sortable: false,
                      checkable: false,
                      filter: false,
                      height: 277,
                      autoBind: true,
                      editSkip: true,
                      useSimpleCalculator: false,
                      context: false,
                      columns: [
                      {
                        field: "calculator",
                        title: "C",
                        width: 30,
                        align: "center",
                        editable: false,
                        style: function style(e2) {
                          var style = {
                            icon: {
                              position: "center"
                            }
                          };
                          switch (e2.row.data.calculator) {
                            case "plus":
                              style.icon.image = dews._environments.scriptBase + "realgrid/assets/cir_plus.png";
                              break;
                            case "minus":
                              style.icon.image = dews._environments.scriptBase + "realgrid/assets/cir_minus.png";
                              break;
                            case "multiply":
                              style.icon.image = dews._environments.scriptBase + "realgrid/assets/cir_multiply.png";
                              break;
                            case "divide":
                              style.icon.image = dews._environments.scriptBase + "realgrid/assets/cir_divide.png";
                              break;}

                          return style;
                        }
                      },
                      {
                        field: "value",
                        title: dews.localize.get("\uAC12", "dews_\uAC12"),
                        align: "right",
                        formats: {
                          type: "number",
                          format: "#,###.####################"
                        }
                      },
                      {
                        field: "delete",
                        title: dews.localize.get("\uC0AD\uC81C", "dews_\uC0AD\uC81C"),
                        width: 30,
                        editable: false,
                        editor: {
                          type: "button",
                          buttonWidth: 21,
                          buttonHeight: 21,
                          basicImg: dews._environments.scriptBase + "realgrid/assets/sbtn-del-normal.png",
                          hoverImg: dews._environments.scriptBase + "realgrid/assets/sbtn-del-over.png",
                          clickImg: dews._environments.scriptBase + "realgrid/assets/sbtn-del-click.png",
                          click: function click(e2) {
                            simpleCalculatorGridRemoveRow.bind(self2)();
                          }
                        }
                      }],

                      rowAdd: function rowAdd(e2) {
                        var dataIndex = grid.getDataIndexFromItemIndex(grid.select());
                        grid.updateRow(dataIndex, {
                          calculator: "plus",
                          value: 0
                        });
                      },
                      pasted: function pasted(e2) {
                        $.each(e2.rows, function (idx, row) {
                          var calculator = grid.getCellValue(row, "calculator");
                          if (!calculator) {
                            grid.updateRow(row, {
                              calculator: "plus"
                            });
                          }
                        });
                      },
                      save: function save(e2) {
                        if (isNaN(e2.row.data.value)) {
                          grid.setCellValue(e2.row.index, e2.cell.field, 0);
                        }
                        setSimpleCalculatorResult.bind(self2)();
                      }
                    });
                    self2.digits.on("change", function (e2) {
                      setSimpleCalculatorResult.bind(self2)();
                    });
                    self2.cutting.on("change", function (e2) {
                      setSimpleCalculatorResult.bind(self2)();
                    });
                    self2.btnClear.on("click", function (e2) {
                      simpleCalculatorGridClear.bind(self2)();
                    });
                    self2.btnPlus.on("click", function (e2) {
                      simpleCalculatorCalculation("plus");
                    });
                    self2.btnMinus.on("click", function (e2) {
                      simpleCalculatorCalculation("minus");
                    });
                    self2.btnMultiply.on("click", function (e2) {
                      simpleCalculatorCalculation("multiply");
                    });
                    self2.btnDivide.on("click", function (e2) {
                      simpleCalculatorCalculation("divide");
                    });
                    self2.btnAddRow.on("click", function (e2) {
                      simpleCalculatorGridAddRow.bind(self2)();
                    });
                    setSimpleCalculatorResult.bind(self2)();
                    grid.select(0, "calculator");
                    grid.on("keyDown", function (e2) {
                      if (e2.keyCode == 45) {
                        simpleCalculatorGridAddRow.bind(self2)();
                        e2.preventDefault();
                      }
                      if (e2.keyCode == 46) {
                        if (grid.getEditCellValue() || grid.getEditCellValue() == "") {
                          return;
                        } else {
                          simpleCalculatorGridRemoveRow.bind(self2)();
                          e2.preventDefault();
                        }
                      }
                      if (e2.keyCode == 119) {
                        simpleCalculatorGridClear.bind(self2)();
                        e2.preventDefault();
                      }
                    });
                    function simpleCalculatorGridAddRow() {
                      grid.addRow();
                    }
                    function simpleCalculatorGridRemoveRow() {
                      grid.removeRow(grid.select());
                      setSimpleCalculatorResult.bind(self2)();
                    }
                    function simpleCalculatorGridClear() {
                      grid.dataSource.data([]);
                      setSimpleCalculatorResult.bind(self2)();
                    }
                    function simpleCalculatorCalculation(calculator) {
                      var rows = grid.multiSelect().rows;
                      if (rows) {
                        $.each(rows, function (idx, row) {
                          grid.setCellValue(row, "calculator", calculator);
                        });
                      }
                    }
                  });
                }
              });
              dialog2.open();
            }
            function setSimpleCalculatorResult() {
              var self2 = this;
              var min;
              var max;
              var count = 0;
              var avg = 0;
              var sum = 0;
              var result = 0;
              $.each(self2.grid.dataItems(), function (idx, data) {
                var calc = data["calculator"];
                var value = data["value"];
                if (!min && min != 0) {
                  min = value;
                } else {
                  if (min > value) {
                    min = value;
                  }
                }
                if (!max && max != 0) {
                  max = value;
                } else {
                  if (max < value) {
                    max = value;
                  }
                }
                count += 1;
                sum += value;
                avg = sum / count;
                switch (calc) {
                  case "plus":
                    result += value;
                    break;
                  case "minus":
                    result -= value;
                    break;
                  case "multiply":
                    result *= value;
                    break;
                  case "divide":
                    result /= value;
                    break;}

                result = Math.round(result * 1e3) / 1e3;
              });
              var digits = self2.digits.value();
              var cutting = self2.cutting.value();
              if (isNaN(min))
              min = "-";else

              min = simpleCalculatorDecimalProcessing(min, cutting, digits);
              if (isNaN(max))
              max = "-";else

              max = simpleCalculatorDecimalProcessing(max, cutting, digits);
              avg = simpleCalculatorDecimalProcessing(avg, cutting, digits);
              sum = simpleCalculatorDecimalProcessing(sum, cutting, digits);
              if (result === Infinity)
              result = "NaN";else

              result = simpleCalculatorDecimalProcessing(result, cutting, digits);
              $(".dews-dialog-contents-area").find("#resultMin").html(min);
              $(".dews-dialog-contents-area").find("#resultMax").html(max);
              $(".dews-dialog-contents-area").find("#resultCount").html(count);
              $(".dews-dialog-contents-area").find("#resultAvg").html(avg);
              $(".dews-dialog-contents-area").find("#resultSum").html(sum);
              $(".dews-dialog-contents-area").find("#resultValue").html(result);
            }
            function simpleCalculatorDecimalProcessing(value, cutting, digits) {
              var digitsMath;
              if (digits == 0) {
                digitsMath = 1;
              } else {
                digitsMath = Math.pow(10, digits);
              }
              switch (cutting) {
                case "round":
                  value = Math.round(value * digitsMath) / digitsMath;
                  break;
                case "ceil":
                  value = Math.ceil(value * digitsMath) / digitsMath;
                  break;
                case "floor":
                  value = Math.floor(value * digitsMath) / digitsMath;
                  break;}

              value = value.toFixed(digits);
              var regexp = /\B(?=(\d{3})+(?!\d))/g;
              var valueSplit = value.toString().split(".");
              value = valueSplit[0].replace(regexp, ",") + (valueSplit[1] ? "." + valueSplit[1] : "");
              return value;
            }
          },
          deleteNote: function deleteNote(self, options) {
            var $dfd = $.Deferred();
            var type = (options === null || options === void 0 ? void 0 : options.type) || "deleted";
            var noteService = new GridNoteService();
            var datas;
            if (type === "deleted") {
              datas = self.dataSource.getDirtyData().Deleted;
            } else {
              datas = self.dataSource.data();
            }
            var gridNoteModelList = [];
            if (datas.length > 0) {
              datas.forEach(function (data) {
                var key = "";
                key = self.options.note.key.filter(function (value) {
                  return data.hasOwnProperty(value);
                }).map(function (value) {
                  return value + ":" + data[value];
                }).join("|");
                var model = {
                  gridNoteKey: key,
                  gridCode: self.$element.parent().attr("ID"),
                  menuCode: dews.ui.page.menu.id
                };
                gridNoteModelList.push(model);
              });
              noteService.deleteNote(gridNoteModelList, true).done(function () {
                $dfd.resolve();
              });
            }
            return $dfd;
          },
          setDisabledNoteRows: function setDisabledNoteRows(self, dataIndex) {
            if (dews.ui.page.useGridNote === "Y" && self.options.note) {
              self._gridNote.disabledRow = dataIndex;
            }
          },
          _codeOptionValue: function _codeOptionValue(code, text, value) {
            return codeOptionValue(code, text, value);
          },
          getGridNoteInfo: function getGridNoteInfo(self, itemIndex) {
            if (itemIndex === -1) {
              return null;
            }
            if (dews.ui.page.useGridNote === "Y" && self.options.note) {
              if (self._gridNote && self._gridNote.disabledRow) {
                var disabledRow = self._gridNote.disabledRow;
                disabledRow = typeof disabledRow === "number" ? [disabledRow] : disabledRow;
                if (disabledRow.indexOf(self.getDataIndexFromItemIndex(itemIndex)) !== -1) {
                  return null;
                }
              }
              var gridNoteInfo = _getGridNoteInfo2(self, itemIndex);
              return gridNoteInfo;
            }
          },
          _getGridNoteInfo: function _getGridNoteInfo(grid, index) {
            return _getGridNoteInfo2(grid, index);
          }
        }
      }
    });
    function changePastedData(self, currentData, index, column, newValues, className, isCell) {var _dews$app$env$main$us;
      var useRemoveInvalidWord = (_dews$app$env$main$us = dews.app.env.main.useRemoveGridZwsp) !== null && _dews$app$env$main$us !== void 0 ? _dews$app$env$main$us : false;
      if (useRemoveInvalidWord) {
        newValues[0] = removeInvalidWord(newValues[0]);
        self._grid.setValue(index, column.fieldName, newValues[0]);
      }
      var codeOption = {};
      var keyword;
      var helpEvent;
      var cpMultiCallback = dews.app.env.main.callbackConfig.useGrdCodePickerMultiPaste;
      if (column.editor.type.toLowerCase() === "codepicker" && (cpMultiCallback || isCell)) {
        codeOption = column.codeOption;
        codeOption.codesearch = isCell;
        var progress;
        var copyDataLength = self.clipboard.length;
        if (!isCell) {
          codeOption.value[index] = codeOptionValue("", "", null);
          progress = dews.ui.progress("progress", {
            total: copyDataLength
          });
        }
        if (typeof self.options.callback === "function") {
          delete self.options.callback;
        }
        if (column.editor.callback) {
          self.options.callback = column.editor.callback;
        }
        if (typeof column.editor.helpParams === "function") {
          codeOption.params = column.editor.helpParams.call(self, {
            data: self._innerOptions._gridType === "GRID" ? self.dataItem(index) : self.dataItem(self._grid.getDataRow(index))
          });
        } else {
          codeOption.params = column.editor.helpParams;
        }
        keyword = newValues[0];
        codeOption.params = $.extend(true, codeOption.params, {
          keyword: keyword
        });
        codeOption.callbacks = function (data) {
          self.clipboard.cnt++;
          if (typeof data !== "undefined") {
            if (Array.isArray(data) && data.length !== 1 || !column.codeOption.useAjax) {
              if (isCell) {
                self._grid.onImageButtonClicked.call(self, self._grid, index, column);
              } else {
                if (codeOption.validation) {
                  codepickerValidation(self, column, currentData);
                }
              }
            } else {
              if (self.options._grid === true && typeof self.options._gridCallback === "function") {
                self.options._gridCallback(data, column, index);
                delete codeOption.codesearch;
                if (column.codeOption.moveFocus) {
                  dews.ui.gridUtil.nextFocus(self, currentData);
                }
              }
            }
          } else {
            if (isCell) {
              self._grid.onImageButtonClicked.call(self, self._grid, index, column);
            }
          }
          if (!isCell) {
            progress.setCurrent(self.clipboard.cnt);
          }
        };
        delete codeOption.callback;
        helpEvent = new $.Event("codesearch", codeOption);
        self.$element.closest(className).trigger(helpEvent);
        self.$element.on("codedialogclosed", function (e) {
          if (codeOption.validation) {
            codepickerValidation(self, column, currentData);
          }
          self.$element.off("codedialogclosed");
        });
      }
      if (column.editor.type.toLowerCase() === "time") {var _newValues$join;
        self._grid.setValue(index, column.fieldName, newValues === null || newValues === void 0 ? void 0 : (_newValues$join = newValues.join("")) === null || _newValues$join === void 0 ? void 0 : _newValues$join.replace(/[^0-9]/g, ""));
      }
    }
    function removeInvalidWord(value) {
      if (typeof value === "string") {
        value = value.replace(/[\u200B-\u200D\uFEFF]/g, "");
        value = value.replace(/[\x00-\x09]|[\x0B-\x0C]|[\x0E-\x1F]/gi, "");
      }
      return value;
    }
    function codepickerValidation(grid, column, current) {
      var dataIndex = current.dataRow;
      var itemIndex = current.itemIndex;
      var fieldName = column.fieldName;
      var codeOption = column.codeOption;
      var currentValue = grid._grid.getValue(itemIndex, fieldName);
      if ($.type(codeOption.value[dataIndex]) === "undefined") {
        codeOption.value[dataIndex] = codeOptionValue("", "", currentValue);
      }
      if (codeOption.value[dataIndex].value === void 0) {
        grid._grid.setValue(itemIndex, fieldName, "");
      } else {
        if (currentValue === "" || $.type(currentValue) === null) {
          grid._grid.setValue(itemIndex, fieldName, currentValue);
          if ($.type(codeOption.gridCodeField) !== "undefined") {
            grid._grid.setValue(itemIndex, codeOption.gridCodeField, currentValue);
          }
          if ($.type(codeOption.gridTextField) !== "undefined") {
            grid._grid.setValue(itemIndex, codeOption.gridTextField, currentValue);
          }
          codeOption.value[dataIndex].value = codeOptionValue(currentValue, currentValue, currentValue);
        } else {
          grid._grid.setValue(itemIndex, fieldName, codeOption.value[dataIndex].value);
        }
      }
    }
    function codeOptionValue(code, text, value) {
      return {
        code: code,
        text: text,
        value: value
      };
    }
    function convertContextMenuOptions(grid, innerOpt, parameter, allMenu) {
      var items = [];
      if (typeof allMenu === "undefined") {
        allMenu = true;
      }
      for (var i = 0; i < innerOpt.length; i++) {
        var item = {},bool = true;
        if (!allMenu) {
          bool = innerOpt[i].display.call(grid, parameter);
        }
        if (bool) {
          if (typeof innerOpt[i].text === "string") {
            item.label = innerOpt[i].text;
          }
          if (typeof innerOpt[i].enabled === "boolean") {
            item.enabled = innerOpt[i].enabled;
          }
          if (Array.isArray(innerOpt[i].children)) {
            item.children = convertContextMenuOptions(grid, innerOpt[i].children, parameter, allMenu);
          }
          items.push(item);
        }
      }
      return items;
    }
    function contextMenuCallBack(grid, contextMenu, label, parameter) {
      for (var i = 0; i < contextMenu.length; i++) {
        if (contextMenu[i].text === label.label) {
          contextMenu[i].handler.call(grid, parameter);
        }
        if (Array.isArray(contextMenu[i].children)) {
          contextMenuCallBack(grid, contextMenu[i].children, label, parameter);
        }
      }
    }
    function getFixedColumn(self, field) {
      var currentColumn = self._grid.columnByName(field);
      if ($.type(currentColumn.parent) !== "null") {
        currentColumn = getFixedColumn(self, currentColumn.parent);
      }
      return currentColumn;
    }
    function closeSearch(self) {
      self.options.searchText.remove();
      self.options.searchEndBtn.remove();
      self.options.searchDiv.remove();
      delete self.options.searchText;
      delete self.options.searchEndBtn;
      delete self.options.searchDiv;
    }
    function convertNumber(obj) {
      var regex = /^[+\-]?(([1-9][0-9]{0,2}(,[0-9]{3})*)|[0-9]+){1}(\.[0-9]+)?$/g;
      if (regex.test(obj)) {
        if (typeof obj == "number") {
          return obj;
        } else {
          obj = obj.replace(/,/g, "");
          obj *= 1;
          return obj;
        }
      } else {
        return null;
      }
    }
    function _getGridNoteInfo2(grid, index) {
      var gridCode = grid.$element.parent()[0].id;
      var selectRowData = grid.dataItem(index);
      var gridNoteKey = "";
      var noteOpt = grid.options.note;
      gridNoteKey = noteOpt.key.filter(function (value) {
        return selectRowData.hasOwnProperty(value);
      }).map(function (value) {
        return value + ":" + selectRowData[value];
      }).join("|");
      var gridNoteInfo = {
        gridNoteKey: gridNoteKey,
        gridCode: gridCode,
        menuCode: dews.ui.page.menu.id
      };
      return gridNoteInfo;
    }
  })(window.dews);
})();


(function () {
  // src/js/StyleConditionPanel.js
  var StyleConditionPanel = /*#__PURE__*/function () {"use strict";










    function StyleConditionPanel(element, options) {var _this7 = this;_classCallCheck(this, StyleConditionPanel);_defineProperty(this, "_element", void 0);_defineProperty(this, "$element", void 0);_defineProperty(this, "options", void 0);_defineProperty(this, "_background", void 0);_defineProperty(this, "_wrapper", void 0);_defineProperty(this, "_tracked", false);_defineProperty(this, "defaultOptions", { border: true });_defineProperty(this, "conditionBox", []);
      this._element = element;
      this.$element = $(element);
      var inlineOptions = this._getInlineOptions();
      this.options = _objectSpread(_objectSpread(_objectSpread({}, this.defaultOptions), inlineOptions), options);
      this.render();
      this.setStyle();
      this._bindEvent();
      dews.ready(function () {
        if (!_this7._tracked) {
          _this7._trackChanges();
          _this7._applyFocusManager();
          _this7._tracked = true;
        }
      });
    }_createClass(StyleConditionPanel, [{ key: "render", value:
      function render() {var _this8 = this;
        this._background = $("<div class=\"style-condition-panel-bg\"></div>");
        this._wrapper = $("<div class=\"style-condition-panel-wrapper\"></div>");
        $(".dews-condition-box", this.$element).each(function (index, item) {
          var conditionBox = new ConditionBox(item);
          _this8.conditionBox.push(conditionBox);
          _this8._wrapper.append(conditionBox.$element);
        });
        this.$element.empty();
        this.$element.append(this._background);
        this.$element.append(this._wrapper);
      } }, { key: "setStyle", value:
      function setStyle() {
        if (this.options.backgroundColor) {
          this._background.css("background-color", this.options.backgroundColor);
        }
        if (this.options.opacity) {
          this._background.css("opacity", this.options.opacity);
        }
        if (this.options.padding) {
          this._wrapper.css("padding", this.options.padding);
        }
        if (this.options.border) {
          this.$element.addClass("border");
        }
      } }, { key: "_bindEvent", value:
      function _bindEvent() {
        var self = this;
        var $el = self.$element;
        $el.find("*[class^=dews-ui-].dews-form-control").each(function (idx, target) {
          var $item = $(target);
          var dewsObj = $item.data("dews-control");
          if (dewsObj) {
            $item.closest(".dews-field-item").on("click", function (e) {
              e.stopPropagation();
            });
          }
        });
      } }, { key: "_getInlineOptions", value:
      function _getInlineOptions() {var _$element$data;
        var $element = this.$element;
        return {
          backgroundColor: $element.data("dews-background-color") || "",
          opacity: $element.data("dews-opacity") || "",
          padding: $element.data("dews-padding") || "",
          border: (_$element$data = $element.data("dews-border")) !== null && _$element$data !== void 0 ? _$element$data : true
        };
      } }, { key: "validate", value:
      function validate(options) {
        var self = this;
        var $el = self.$element;
        var result = true;
        var defaultOptions = { tooltip: true };
        var firstControlFlag = false;
        var firstControl;
        options = $.extend({}, defaultOptions, options);
        $el.find("*[class^=dews-ui-].dews-form-control.required").each(function (idx, target) {
          var $item = $(target);
          var dewsObj = $item.data("dews-control");
          var $li = $item.closest("li");
          if ($li.is(":visible")) {
            if (typeof dewsObj.validate === "function") {
              if (!dewsObj.validate()) {
                if (dews._environments.panelValidateFocus) {
                  if (!firstControlFlag) {
                    firstControl = dewsObj;
                    firstControlFlag = true;
                  }
                  if (firstControl && $.isFunction(firstControl.focus)) {
                    firstControl.focus();
                  }
                }
                if (options.tooltip) {
                  if (options.message) {
                    dews.ui.tooltip.show($item, {
                      type: "required",
                      text: options.message
                    });
                  } else {
                    dews.ui.tooltip.show($item, {
                      type: "required"
                    });
                  }
                }
                result = false;
              }
            }
          }
        });
        return result;
      } }, { key: "serialize", value:
      function serialize() {
        var self = this;
        var $el = self.$element;
        var value;
        $el.find("*[class^=dews-ui-][id].dews-form-control").each(function (idx, target) {
          var $item = $(target);
          var dewsObj = $item.data("dews-control");
          if (dewsObj && $.isFunction(dewsObj.serializeForPanel)) {
            var obj = dewsObj.serializeForPanel();
            if (obj) {
              value = value || {};
              $.extend(true, value, obj);
            }
          }
        });
        return value;
      } }, { key: "bindData", value:
      function bindData(data) {
        var self = this;
        var $el = self.$element;
        self.binding = true;
        if (data) {
          $el.find("*[class^=dews-ui-][id].dews-form-control").each(function (idx, target) {
            var $item = $(target);
            var dewsObj = $item.data("dews-control");
            if (dewsObj && $.isFunction(dewsObj.bindFromPanel)) {
              dewsObj.bindFromPanel(data);
            }
          });
        }
        self.binding = false;
      } }, { key: "bindTo", value:
      function bindTo(target) {
        var self = this;
        var instance, data;
        if (target instanceof jQuery) {
          instance = target.data("dews-control");
        } else {
          instance = target;
        }
        if (instance && $.isFunction(instance.updateRowFromPanel)) {
          data = self.serialize();
          if (data) {
            instance.updateRowFromPanel.call(instance, data);
          }
        } else {
          console.log(
          "# ConditionPanel \uC758 \uB370\uC774\uD130\uB97C \uC6D0\uBCF8 \uB370\uC774\uD130\uC18C\uC2A4\uB85C \uBC14\uC778\uB529\uD558\uB294\uB370 \uC2E4\uD328\uD558\uC600\uC2B5\uB2C8\uB2E4. #",
          target,
          instance);

        }
      } }, { key: "raiseEvent", value:
      function raiseEvent(event) {
        var self = this,$panel = self.$element,eventArray = ["lastFocus", "change"];
        try {
          if (eventArray.indexOf(event) !== -1) {
            if (event === "change") {
              $panel.trigger("_change");
            } else {
              $panel.trigger(event);
            }
          } else {
            throw "\uC81C\uACF5\uD558\uC9C0\uC54A\uB294 \uC774\uBCA4\uD2B8 \uD0C0\uC785\uC785\uB2C8\uB2E4.";
          }
        } catch (e) {
          console.log(e);
        }
      } }, { key: "on", value:
      function on() {
        var $panel = this.$element;
        switch (arguments[0]) {
          case "change":
            Array.prototype.splice.apply(arguments, [0, 1, "_change"]);
            $panel.on.apply($panel, arguments);
            break;
          default:
            $panel.on.apply($panel, arguments);
            break;}

      } }, { key: "_trackChanges", value:
      function _trackChanges() {
        var self = this;
        var $el = self.$element;
        var evt;
        $el.find("*[class^=dews-ui-].dews-form-control").each(function (idx, target) {
          var $item = $(target);
          var dewsObj = $item.data("dews-control");
          if (dewsObj && $.isFunction(dewsObj.on)) {
            dewsObj.on("change", function (e) {
              if (!self.binding) {
                evt = new $.Event("_change");
                evt.source = dewsObj;
                evt.$source = $item;
                $el.trigger(evt);
                if ($item.attr("class").match(/periodpicker|codepicker/) !== null) {
                  e.stopPropagation();
                }
              }
            });
            $item.closest(".dews-field-item").on("click", function (e) {
              e.stopPropagation();
            });
          }
        });
      } }, { key: "_applyFocusManager", value:
      function _applyFocusManager() {
        var self = this;
        var $el = $(self._element);
        var controls = [];
        $el.find("*[class^=dews-ui-].dews-form-control").each(function (idx, target) {
          var $item = $(target);
          var $ul = $item.closest("ul");
          var dewsObj = $item.data("dews-control");
          if (!dewsObj) {
            return;
          }
          if (typeof dewsObj.applyPanelFocus === "function") {
            dewsObj.applyPanelFocus(self.options.requiredCheck);
            dewsObj.on("nextFocus", function (e) {
              var next = getNextControl(e.control);
              if (next) {
                next.focus();
              } else {
                $el.trigger("lastFocus");
              }
            });
            var isCodePicker = $(dewsObj._element).hasClass("dews-ui-codepicker") || $(dewsObj.target).hasClass("dews-ui-multicodepicker");
            if (isCodePicker) {
              dewsObj.on("codedialogclosed", function (e) {
                if (dewsObj.options.moveFocus === true) {
                  var next = getNextControl(dewsObj);
                  if (next) {
                    if (dewsObj._focusMove === true) {
                      next.focus();
                      delete dewsObj._focusMove;
                    }
                  }
                }
              });
            }
            dewsObj.on("beforeFocus", function (e) {
              var before = getBeforeControl(e.control);
              if (before) {
                before.focus();
              }
            });
            controls.push({ dewsObj: dewsObj, $ul: $ul });
          }
        });
        var getNextControl = function getNextControl(current) {
          var idx;
          var next;
          for (var i = 0; i < controls.length; i++) {
            if (controls[i].dewsObj === current) {
              idx = i;
              break;
            }
          }
          if (idx >= 0 && idx < controls.length) {
            while (!next) {
              idx++;
              if (controls[idx] && controls[idx].dewsObj && $.isFunction(controls[idx].dewsObj.canFocusable) && controls[idx].dewsObj.canFocusable() && controls[idx].$ul.is(":visible")) {
                next = controls[idx].dewsObj;
              }
              if (idx >= controls.length) {
                break;
              }
            }
          }
          return next;
        };
        var getBeforeControl = function getBeforeControl(current) {
          var idx;
          var before;
          for (var i = 0; i < controls.length; i++) {
            if (controls[i].dewsObj === current) {
              idx = i;
              break;
            }
          }
          if (idx >= 0 && idx < controls.length) {
            while (!before) {
              idx--;
              if (controls[idx] && controls[idx].dewsObj && $.isFunction(controls[idx].dewsObj.canFocusable) && controls[idx].dewsObj.canFocusable() && controls[idx].$ul.is(":visible")) {
                before = controls[idx].dewsObj;
              }
              if (idx <= -1) {
                break;
              }
            }
          }
          return before;
        };
      } }]);return StyleConditionPanel;}();

  var ConditionBox = /*#__PURE__*/function () {"use strict";




    function ConditionBox(element, options) {_classCallCheck(this, ConditionBox);_defineProperty(this, "_element", void 0);_defineProperty(this, "$element", void 0);_defineProperty(this, "options", void 0);_defineProperty(this, "board", []);
      this._element = element;
      this.$element = $(element);
      var inlineOptions = this._getInlineOptions();
      this.options = _objectSpread(_objectSpread({}, inlineOptions), {}, { options: options });
      this.render();
      this.setStyle();
      this._bindEvent();
    }_createClass(ConditionBox, [{ key: "render", value:
      function render() {var _this9 = this;
        this._background = $("<div class=\"condition-box-bg\"></div>");
        this.$element.append(this._background);
        $(".dews-form-board, .dews-data-board", this.$element).each(function (index, item) {
          _this9.board.push(new Board(item));
        });
      } }, { key: "_bindEvent", value:
      function _bindEvent() {var _this10 = this;
        if (this.options.link) {
          this.$element.css("cursor", "pointer");
          this.$element.on("click", function (e) {
            if (_this10.options.linkType === "menu") {
              var module = _this10.options.link.split("/")[0];
              var menuId = _this10.options.link.split("/")[1];
              dews.ui.openMenu(module, menuId);
            } else {
              window.open(_this10.options.link);
            }
          });
        }
      } }, { key: "setStyle", value:
      function setStyle() {
        if (this.options.backgroundColor) {
          this._background.css("background-color", this.options.backgroundColor);
        }
        if (this.options.opacity) {
          this._background.css("opacity", this.options.opacity);
        }
        if (this.options.padding) {
          this.$element.css("padding", this.options.padding);
        }
        if (this.options.width) {
          this.$element.css("width", this.options.width);
        }
        if (this.options.border) {
          this.$element.addClass("border");
        }
        if (this.options.boxShadow) {
          this.$element.addClass("shadow");
        }
      } }, { key: "_getInlineOptions", value:
      function _getInlineOptions() {var _$element$data2, _$element$data3;
        var $element = this.$element;
        return {
          backgroundColor: $element.data("dews-background-color") || "",
          opacity: $element.data("dews-opacity") || "",
          border: (_$element$data2 = $element.data("dews-border")) !== null && _$element$data2 !== void 0 ? _$element$data2 : false,
          boxShadow: (_$element$data3 = $element.data("dews-box-shadow")) !== null && _$element$data3 !== void 0 ? _$element$data3 : true,
          linkType: $element.data("dews-link-type") || "menu",
          link: $element.data("dews-link") || "",
          padding: $element.data("dews-padding") || "",
          width: $element.data("dews-width") || ""
        };
      } }]);return ConditionBox;}();

  var Board = /*#__PURE__*/function () {"use strict";



    function Board(element, options) {_classCallCheck(this, Board);_defineProperty(this, "element", void 0);_defineProperty(this, "$element", void 0);_defineProperty(this, "options", void 0);
      this.element = element;
      this.$element = $(element);
      var inlineOptions = this._getInlineOptions();
      this.options = _objectSpread(_objectSpread({}, inlineOptions), {}, { options: options });
      this.setStyle();
    }_createClass(Board, [{ key: "_getInlineOptions", value:
      function _getInlineOptions() {
        var $element = this.$element;
        return {
          width: $element.data("dews-width") || "",
          border: $element.data("dews-border") || "",
          align: $element.data("dews-align") || "",
          padding: $element.data("dews-padding") || ""
        };
      } }, { key: "setStyle", value:
      function setStyle() {
        if (this.options.width) {
          this.$element.css("width", this.options.width);
        }
        if (this.options.padding) {
          this.$element.css("padding", this.options.padding);
        }
        if (this.options.align) {
          switch (this.options.align) {
            case "top":
              this.$element.addClass("vertical-top");
              break;
            case "middle":
              this.$element.addClass("vertical-center");
              break;
            case "bottom":
              this.$element.addClass("vertical-bottom");
              break;}

        } else {
          this.$element.addClass("vertical-center");
        }
        if (this.options.border) {
          this.$element.addClass("border");
          switch (this.options.border) {
            case "bold":
              this.$element.addClass("border-bold");
              break;
            case "dashed":
              this.$element.addClass("border-dashed");
              break;
            case "dotted":
              this.$element.addClass("border-dotted");
              break;}

        }
        $(".dews-field-item", this.$element).each(function (idx, element) {
          $(element).css("width", $(element).data("dews-width"));
        });
      } }]);return Board;}();


  // src/js/Text.js
  var Text = /*#__PURE__*/function () {"use strict";
    function Text(element, options) {_classCallCheck(this, Text);
      this._element = element;
      this.$element = $(element);
      this.render();
      var inlineOptions = this._getInlineOptions();
      this.options = _objectSpread(_objectSpread({}, inlineOptions), {}, { options: options });
      this.setStyle();
      this._bindEvent();
    }_createClass(Text, [{ key: "render", value:
      function render() {
        this.$element.wrapInner("<span></span>");
      } }, { key: "setStyle", value:
      function setStyle() {
        var element = this._element;
        var elementStyle = element.style;
        var text = element.getElementsByTagName("span")[0];
        if (elementStyle.backgroundColor) {
          text.style.backgroundColor = elementStyle.backgroundColor;
          elementStyle.backgroundColor = "";
        }
      } }, { key: "_getInlineOptions", value:
      function _getInlineOptions() {
        var $element = this.$element;
        return {
          linkType: $element.data("dews-link-type") || "menu",
          link: $element.data("dews-link") || "",
          linkHoverColor: $element.data("dews-link-hover-color") || ""
        };
      } }, { key: "_bindEvent", value:
      function _bindEvent() {var _this11 = this;
        if (this.options.link) {
          this.$element.addClass("link");
          this.$element.find("span").on("click", function () {
            if (_this11.options.linkType === "menu") {
              var module = _this11.options.link.split("/")[0];
              var menuId = _this11.options.link.split("/")[1];
              dews.ui.openMenu(module, menuId);
            } else {
              window.open(_this11.options.link);
            }
          });
          if (this.options.linkHoverColor) {var _this$_element$getAtt;
            var style = (_this$_element$getAtt = this._element.getAttribute("style")) !== null && _this$_element$getAtt !== void 0 ? _this$_element$getAtt : "";
            var _styles = style.split(";");
            var index = _styles.findIndex(function (item) {return item === "--hover-color";});
            _styles.splice(index, 1);
            this._element.setAttribute(
            "style", "".concat(
            _styles.concat("").join(";"), " --hover-color: ").concat(this.options.linkHoverColor, ";"));

          }
        }
      } }, { key: "text", value:
      function text(value) {
        if (value === void 0) {
          return this.$element.find("span").text();
        } else {
          this.$element.find("span").text(value);
        }
      } }, { key: "bindFromPanel", value:
      function bindFromPanel(data) {
        var self = this;
        var $element = this.$element;
        var column;
        if (data) {
          column = $element.data("dews-bind-column") || $element.attr("id");
          if (column && data.hasOwnProperty(column)) {
            if (typeof data[column] === "undefined" || data[column] === null) {
              data[column] = "";
            }
            self.text(data[column]);
          }
        }
      } }, { key: "serializeForPanel", value:
      function serializeForPanel() {
        var self = this;
        var $element = this.$element;
        var column;
        var data;
        column = $element.data("dews-bind-column") || $element.attr("id");
        if (column) {
          data = {};
          data[column] = self.text();
        }
        return data;
      } }]);return Text;}();


  // src/js/ProgressBar.js
  var ProgressBar = /*#__PURE__*/function () {"use strict";





    function ProgressBar(element, progressBarItem) {_classCallCheck(this, ProgressBar);_defineProperty(this, "$element", void 0);_defineProperty(this, "_progressBarItem", void 0);_defineProperty(this, "items", []);_defineProperty(this, "total", 4);_defineProperty(this, "currentStep", 0);
      this.$element = $(element);
      this._progressBarItem = progressBarItem;
      this._initialize();
    }_createClass(ProgressBar, [{ key: "_initialize", value:
      function _initialize() {
        this._addItems();
        this.total = this.items.length - 1;
        this._render();
      } }, { key: "_addItems", value:
      function _addItems() {var _this12 = this;
        $(".".concat(this._progressBarItem.className), this.$element).each(function (index, item) {
          if (index >= 9) {
            throw new Error("\uC544\uC774\uD15C\uC758 \uAC1C\uC218\uB294 9\uAC1C\uB97C \uCD08\uACFC\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");
          }
          _this12.items.push(new _this12._progressBarItem(item, index));
        });
      } }, { key: "_render", value:
      function _render() {
        this.$element.addClass("item".concat(this.total + 1));
        this._setStatus();
      } }, { key: "_setStatus", value:
      function _setStatus() {var _this13 = this;
        this.items.forEach(function (i, index) {
          i.removeStatus();
          if (index < _this13.currentStep) {
            i.complete();
          } else if (index === _this13.currentStep) {
            i.activate();
          }
        });
      } }, { key: "_triggerSelectEvent", value:
      function _triggerSelectEvent(index) {
        var event = $.Event("select", {
          sender: this,
          step: this.items[index]
        });
        this.$element.trigger(event);
        return !event.isDefaultPrevented();
      } }, { key: "on", value:
      function on(eventType, callBack) {
        this.$element.on(eventType, callBack);
      } }, { key: "select", value:
      function select(index) {
        if (!Number.isInteger(index) || !this._triggerSelectEvent(index)) {
          return this.items[this.currentStep];
        }
        if (index < 0 || index > this.total) {
          throw new Error("index\uB294 0 \uBBF8\uB9CC \uB610\uB294 ".concat(this.total, "\uC744 \uCD08\uACFC\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."));
        }
        this.currentStep = index;
        this._setStatus();
        return this.items[this.currentStep];
      } }, { key: "next", value:
      function next() {
        if (!this._triggerSelectEvent(this.currentStep + 1)) {
          return;
        }
        if (this.currentStep + 1 > this.total) {
          return;
        }
        this.currentStep = this.currentStep + 1;
        this._setStatus();
      } }, { key: "previous", value:
      function previous() {
        if (!this._triggerSelectEvent(this.currentStep - 1)) {
          return;
        }
        if (this.currentStep === 0) {
          return;
        }
        this.currentStep = this.currentStep - 1;
        this._setStatus();
      } }, { key: "insertAt", value:
      function insertAt(index, options) {var _data5, _options$label;
        if (index === null || index < 0 || this.items.length < index) {
          throw new Error("\uC778\uB371\uC2A4\uC5D0 \uD574\uB2F9\uD558\uB294 \uB2E8\uACC4\uAC00 \uC874\uC7AC\uD558\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4.");
        }
        if (this.items.length >= 9) {
          throw new Error("\uC544\uC774\uD15C\uC758 \uAC1C\uC218\uB294 9\uAC1C\uB97C \uCD08\uACFC\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");
        }
        var data;
        if (options) {
          data = this._toDewsDataFormat(options);
        }
        var $element = $("<li class=\"".concat(
        this._progressBarItem.className, "\" ").concat((_data5 = data) !== null && _data5 !== void 0 ? _data5 : "", ">").concat((_options$label = options === null || options === void 0 ? void 0 : options.label) !== null && _options$label !== void 0 ? _options$label : "", "</li>"));

        index === 0 ? this.items[0].$element.before($element) : this.items[index - 1].$element.after($element);
        this._changeIndices(index, "insert");
        this.items.splice(index, 0, new this._progressBarItem($element, index));
        this.items[index].render();
        if (index !== this.total && index <= this.currentStep) {
          this.currentStep++;
        }
        this.$element.removeClass("item".concat(this.total + 1));
        this.total++;
        this.$element.addClass("item".concat(this.total + 1));
        this._setStatus();
      } }, { key: "removeAt", value:
      function removeAt(index) {
        if (index === null || index < 0 || this.items.length <= index) {
          throw new Error("\uC778\uB371\uC2A4\uC5D0 \uD574\uB2F9\uD558\uB294 \uB2E8\uACC4\uAC00 \uC874\uC7AC\uD558\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4.");
        }
        this._changeIndices(index, "remove");
        this.items.splice(index, 1);
        var removeSelectedFirstStep = this.currentStep === 0 && index === 0;
        if (!removeSelectedFirstStep && index <= this.currentStep) {
          this.currentStep--;
        }
        this.$element.removeClass("item".concat(this.total + 1));
        this.total--;
        this.$element.addClass("item".concat(this.total + 1));
        this._setStatus();
      } }, { key: "_changeIndices", value:
      function _changeIndices(index, action) {
        switch (action) {
          case "insert":
            this.items.forEach(function (item, i) {
              if (i >= index) {
                item.index++;
              }
            });
            break;
          case "remove":
            this.items.forEach(function (item, i) {
              if (i === index) {
                item.$element.remove();
              }
              if (i >= index) {
                item.index--;
              }
            });
            break;}

      } }, { key: "_toDewsDataFormat", value:
      function _toDewsDataFormat(data) {
        var keys = Object.keys(data).map(function (k) {
          if (k === "label") {
            return;
          }
          return k.replace(/([A-Z])/g, "-$1").toLowerCase().replace("", "data-dews-");
        });
        var result = "";
        var values = Object.values(data);
        keys.forEach(function (k, index) {
          result += k + "=\"".concat(values[index], "\" ");
        });
        return result;
      } }]);return ProgressBar;}();

  var ProgressBarItem = /*#__PURE__*/function () {"use strict";
    function ProgressBarItem(element, index) {_classCallCheck(this, ProgressBarItem);
      this.$element = $(element);
      this.index = index;
      this.label = this.$element.text();
    }_createClass(ProgressBarItem, [{ key: "render", value:



      function render() {
        this.$element.text("");
      } }, { key: "_addLink", value:
      function _addLink() {
        var link = this.$element.data("dews-link");
        if (!link) {
          return false;
        }
        this.$element.addClass("link");
        return link;
      } }, { key: "complete", value:
      function complete() {
        this.$element.addClass("completed");
      } }, { key: "activate", value:
      function activate() {
        this.$element.addClass("active");
      } }, { key: "removeStatus", value:
      function removeStatus() {
        this.$element.removeClass("completed active");
      } }], [{ key: "className", get: function get() {return "";} }]);return ProgressBarItem;}();


  // src/js/StepProgressBar.js
  var StepProgressBar = /*#__PURE__*/function (_ProgressBar) {"use strict";_inherits(StepProgressBar, _ProgressBar);var _super13 = _createSuper(StepProgressBar);
    function StepProgressBar(element) {_classCallCheck(this, StepProgressBar);return _super13.call(this,
      element, StepProgressBarItem);
    }_createClass(StepProgressBar, [{ key: "_inlineOptions", get:
      function get() {
        return {
          type: this.$element.data("dews-type") || "number",
          color: this.$element.data("dews-color") || "theme"
        };
      } }, { key: "_render", value:
      function _render() {
        _get(_getPrototypeOf(StepProgressBar.prototype), "_render", this).call(this);
        this.items.forEach(function (i) {
          i.render();
        });
        if (this.items.some(function (i) {return i.label;})) {
          this.$element.addClass("label");
        }
        if (this._inlineOptions.type === "number" || "figure") {
          this.$element.addClass(this._inlineOptions.type);
        }
        if (this._inlineOptions.color === "theme" || "status") {
          this.$element.addClass(this._inlineOptions.color);
        }
      } }, { key: "error", value:
      function error(index) {var _this$items$index;
        if (index < 0 || index > this.total) {
          throw new Error("index\uB294 0 \uBBF8\uB9CC \uB610\uB294 ".concat(this.total, "\uC744 \uCD08\uACFC\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."));
        }
        (_this$items$index = this.items[index]) === null || _this$items$index === void 0 ? void 0 : _this$items$index.makeError();
        return this.items.filter(function (i) {return i.error === true;});
      } }, { key: "removeError", value:
      function removeError(index) {
        Number.isInteger(index) ? this.items[index].removeError() : this.error().forEach(function (i) {return i.removeError();});
      } }, { key: "insertAt", value:
      function insertAt(index, options) {
        _get(_getPrototypeOf(StepProgressBar.prototype), "insertAt", this).call(this, index, options);
        this.items.forEach(function (item, i) {
          if (i >= index) {
            item.changeIndex();
          }
        });
      } }, { key: "removeAt", value:
      function removeAt(index) {
        _get(_getPrototypeOf(StepProgressBar.prototype), "removeAt", this).call(this, index);
        this.items.forEach(function (item, i) {
          if (i >= index) {
            item.changeIndex();
          }
        });
      } }]);return StepProgressBar;}(ProgressBar);

  var StepProgressBarItem = /*#__PURE__*/function (_ProgressBarItem) {"use strict";_inherits(StepProgressBarItem, _ProgressBarItem);var _super14 = _createSuper(StepProgressBarItem);function StepProgressBarItem() {var _this14;_classCallCheck(this, StepProgressBarItem);for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {args[_key] = arguments[_key];}_this14 = _super14.call.apply(_super14, [this].concat(args));_defineProperty(_assertThisInitialized(_this14), "error",
      false);return _this14;}_createClass(StepProgressBarItem, [{ key: "render", value:



      function render() {
        _get(_getPrototypeOf(StepProgressBarItem.prototype), "render", this).call(this);
        var $div = $("<div></div>");
        this.$element.append($div);
        this._appendCounterTo($div);
        this._appendLabelTo($div);
      } }, { key: "_appendCounterTo", value:
      function _appendCounterTo($container) {
        var counter = $("\n                    <div class=\"counter\">\n                        <span>".concat(

        this.index + 1, "</span>\n                    </div>\n                "));


        $container.append(counter);
      } }, { key: "_appendLabelTo", value:
      function _appendLabelTo($container) {
        var $label;
        if (this.label) {
          $label = $("<div class=\"label\"><span class=\"text\">".concat(this.label, "</span></div>"));
          $container.append($label);
        }
        var subLabel = this.$element.data("dews-sub-label");
        if ($label && subLabel) {
          var $subLabel = $("<span class=\"sub-text\">".concat(subLabel, "</span>"));
          $label.prepend($subLabel);
        }
        this._addLink();
      } }, { key: "changeIndex", value:
      function changeIndex() {
        this.$element.find(".counter span").text(this.index + 1);
      } }, { key: "_addLink", value:
      function _addLink() {
        var link = _get(_getPrototypeOf(StepProgressBarItem.prototype), "_addLink", this).call(this);
        if (link) {
          this.$element.children()[0].onclick = function () {
            location.href = "".concat(link);
          };
        }
      } }, { key: "makeError", value:
      function makeError() {
        this.$element.addClass("error");
        this.error = true;
      } }, { key: "removeError", value:
      function removeError() {
        this.$element.removeClass("error");
        this.error = false;
      } }], [{ key: "className", get: function get() {return "dews-stepprogressbar-item";} }]);return StepProgressBarItem;}(ProgressBarItem);


  // src/js/ArrowProgressBar.js
  var ArrowProgressBar = /*#__PURE__*/function (_ProgressBar2) {"use strict";_inherits(ArrowProgressBar, _ProgressBar2);var _super15 = _createSuper(ArrowProgressBar);
    function ArrowProgressBar(element) {_classCallCheck(this, ArrowProgressBar);return _super15.call(this,
      element, ArrowProgressBarItem);
    }_createClass(ArrowProgressBar, [{ key: "_render", value:
      function _render() {
        _get(_getPrototypeOf(ArrowProgressBar.prototype), "_render", this).call(this);
        this.items.forEach(function (i) {return i.render();});
      } }]);return ArrowProgressBar;}(ProgressBar);

  var ArrowProgressBarItem = /*#__PURE__*/function (_ProgressBarItem2) {"use strict";_inherits(ArrowProgressBarItem, _ProgressBarItem2);var _super16 = _createSuper(ArrowProgressBarItem);function ArrowProgressBarItem() {_classCallCheck(this, ArrowProgressBarItem);return _super16.apply(this, arguments);}_createClass(ArrowProgressBarItem, [{ key: "render", value:



      function render() {
        _get(_getPrototypeOf(ArrowProgressBarItem.prototype), "render", this).call(this);
        var $label = $("<div class='label'></div>");
        var $span = $("<span>".concat(this.label, "</span>"));
        this.$element.append($label);
        $label.append($span);
        this._addLink();
      } }, { key: "_addLink", value:
      function _addLink() {
        var link = _get(_getPrototypeOf(ArrowProgressBarItem.prototype), "_addLink", this).call(this);
        if (link) {
          this.$element[0].onclick = function () {
            location.href = "".concat(link);
          };
        }
      } }], [{ key: "className", get: function get() {return "dews-arrowprogressbar-item";} }]);return ArrowProgressBarItem;}(ProgressBarItem);


  // src/js/import.js
  $.extend(true, dews, {
    ui: {
      styleConditionPanel: function styleConditionPanel(selector, options) {return registerControl(selector, options, StyleConditionPanel);},
      text: function text(selector, options) {return registerFormControl(selector, options, Text);},
      stepProgressBar: function stepProgressBar(selector, options) {return registerControl(selector, options, StepProgressBar);},
      arrowProgressBar: function arrowProgressBar(selector, options) {return registerControl(selector, options, ArrowProgressBar);}
    }
  });
  function registerControl(selector, options, constructor) {
    var $element = getElement(selector);
    if (typeof $element === "undefined") {
      return;
    }
    var component;
    $element.each(function () {
      var element = this;
      if ($(element).data("dews-control")) {
        return $(element).data("dews-control");
      }
      component = new constructor(element, options);
      $(element).data("dews-control", component);
    });
    return component;
  }
  function registerFormControl(selector, options, constructor) {
    var $element = getElement(selector);
    if (typeof $element === "undefined") {
      return;
    }
    var component;
    $element.each(function () {
      var element = this;
      if ($(element).data("dews-control")) {
        return $(element).data("dews-control");
      }
      component = new constructor(element, options);
      if (!$(element).hasClass("dews-form-control")) {
        $(element).addClass("dews-form-control");
      }
      $(element).data("dews-control", component);
    });
    return component;
  }
  var componentMap = {
    styleConditionPanel: "dews-ui-style-condition-panel",
    text: "dews-ui-text",
    stepProgressBar: "dews-ui-stepprogressbar",
    arrowProgressBar: "dews-ui-arrowprogressbar"
  };var _loop2 = function _loop2(componentMapKey)
  {
    dews.ui.addControlInitializer(componentMapKey, function (target) {
      var selector = ".".concat(componentMap[componentMapKey]);
      var $context = getContext(target);
      var $element = $(selector, $context);
      dews.ui[componentMapKey]($element);
    });
  };for (var componentMapKey in componentMap) {_loop2(componentMapKey);}
  function getElement(target) {
    if (target instanceof jQuery) {
      return target;
    }
    if (typeof target === "string") {
      return $(target);
    }
  }
  function getContext(target) {
    if (target instanceof jQuery) {
      return target;
    }
    if (typeof target === "string") {
      return $(target);
    }
    return $(document);
  }
})();


/*
 * 자동완성
 */
(function ($, dews, kendo) {
  function getInlineOptions($this, srcOptions) {
    var $el = $this,
      dataSource,
      dataSourceID,
      dataSourceUrl,
      dataOptions,
      options = {};

    if (srcOptions) {
      if (srcOptions.params) {
        options.params = srcOptions.params;
      }
    }

    if ($el.data("dews-params")) {
      options.params = $.deparam($el.data("dews-params"));
    }

    if ($el.data("dews-data-url")) {
      if ($el.attr("id")) {
        dataSourceID = $el.attr("id") + "_DataSource";
      } else {
        dataSourceID = new Date().toString() + "_DataSource";
      }
      if (options.params) {
        dataSourceUrl = dews.url.appendParameters(
        dews.url.getAbsoluteUrl($el.data("dews-data-url")),
        options.params);

        dataOptions = {
          transport: {
            read: {
              url: dataSourceUrl,
              dataType: "json"
            }
          },
          serverFiltering: true
        };
      } else {
        dataSourceUrl = dews.url.getAbsoluteUrl($el.data("dews-data-url"));
        dataOptions = {
          transport: {
            read: {
              url: dataSourceUrl,
              dataType: "json"
            }
          }
        };
      }
      dataSource = dews.ui.dataSource(dataSourceID, dataOptions);
      options.dataSource = dataSource;
    }
    if ($el.data("dews-text-field")) {
      options.dataTextField = $el.data("dews-text-field");
    }
    if ($el.data("dews-code-field")) {
      options.dataCodeField = $el.data("dews-code-field");
      options.template = $el.data("dews-code-field");
    }
    if ($el.data("dews-list-width")) {
      options.listWidth = $el.data("dews-list-width");
    }
    if ($el.data("dews-list-maxheight")) {
      options.height = $el.data("dews-list-maxheight");
    }
    if ($el.data("dews-filter")) {
      options.filter = $el.data("dews-filter");
    }
    if ($el.data("dews-min-length")) {
      options.minLength = $el.data("dews-min-length");
    }
    if ($.type($el.data("dews-visible-code")) === "boolean") {
      options.visibleCode = $el.data("dews-visible-code");
    }
    return options;
  }

  function getOptions($this, srcOptions) {
    var $el = $this,
      options,
      inlineOptions;

    inlineOptions = getInlineOptions($el, srcOptions);

    options = $.extend(true, {}, inlineOptions, srcOptions);

    if (options.template) {
      options.dataCodeField = options.template;

      if (options.template.match(/<[^>]+>/g) === null) {
        if (options.visibleCode === false) {
          options.template = "<span class='dews-autocomplete-text'>#:" + options.dataTextField + " #</span>";
        } else {
          options.template =
          "<span class='dews-autocomplete-text'>#:" +
          options.dataTextField +
          " #</span> <span class='dews-autocomplete-code'>#:" +
          options.template +
          "#</span>";
        }
      }
    } else {
      options.template = "<span class='dews-autocomplete-text'>#=" + options.dataTextField + " #</span>";
    }

    return options;
  }

  function initControl(auto, $el) {
    var wrapper = $el.parent(".k-autocomplete");

    if (wrapper.find(".k-icon.k-loading")) {
      wrapper.find(".k-icon.k-loading").remove();
    }

    if ($el.hasClass("k-input")) {
      $el.removeClass("k-input");
      $el.addClass("dews-ui-autocomplete");
      $el.addClass("k-textbox");
    }

    if (!wrapper.hasClass("dews-autocomplete-wrapper")) {
      wrapper.removeClass("dews-ui-autocomplete");
      wrapper.addClass("dews-autocomplete-wrapper");
    }

    if (wrapper.hasClass("required")) {
      wrapper.addClass("dews-state-required");
      wrapper.removeClass("required");
      $el.addClass("dews-state-required");
    }

    if (wrapper.hasClass("disabled") || $el.prop("disabled") === true) {
      wrapper.addClass("dews-state-disabled");
      wrapper.removeClass("disabled");
      $el.addClass("dews-state-disabled");
      $el.prop("disabled", true);
    }

    if (wrapper.hasClass("readonly") || $el.prop("readonly") === true) {
      wrapper.addClass("dews-state-readonly");
      wrapper.removeClass("readonly");
      $el.addClass("dews-state-readonly");
      $el.prop("readonly", true);
    }

    if (wrapper.hasClass("etc1")) {
      wrapper.addClass("dews-state-etc1");
      wrapper.removeClass("etc1");
      $el.addClass("dews-state-etc1");
    }

    if (wrapper.hasClass("etc2")) {
      wrapper.addClass("dews-state-etc2");
      wrapper.removeClass("etc2");
      $el.addClass("dews-state-etc2");
    }

    if (wrapper.hasClass("etc3")) {
      wrapper.addClass("dews-state-etc3");
      wrapper.removeClass("etc3");
      $el.addClass("dews-state-etc3");
    }

    if (!$el.hasClass("dews-form-control")) {
      $el.addClass("dews-form-control");
    }

    if (!$el.hasClass("dews-control-activate")) {
      $el.addClass("dews-control-activate");
    }

    if (auto.options.listWidth) {
      if (auto.options.listWidth < $el.parent(".dews-autocomplete-wrapper").width()) {
        auto.list.width($el.parent(".dews-autocomplete-wrapper").width());
      } else {
        auto.list.width(auto.options.listWidth);
      }
    }

    if ($el.attr("placeholder") && $el.data("dews-placeholder-localize-key")) {
      $el.attr(
      "placeholder",
      dews.localize.get(
      $el.attr("placeholder"),
      $el.data("dews-placeholder-localize-key"),
      $el.data("dews-placeholder-localize-lang") || null));


    }

    setUserGuideAPI($el);
  }

  function bindEvent(auto, $this) {
    if (auto.dataSource.transport.options) {
      auto.options.baseUrl = auto.dataSource.transport.options.read.url;
    }

    $this.on("focus", function () {
      if (auto && auto._prev !== "") {
        auto.search(auto._prev);
      }

      if ($this.prop("readonly") === false && $this.prop("disabled") === false) {
        $this.select();
      }
    });

    $this.on("keydown", function (e) {
      if (e.keyCode === 8 || e.keyCode === 46) {
        if (auto._prev && auto._prev.length <= auto.options.minLength) {
          auto.close();
        }
      }
    });

    auto.bind("filtering", function (e) {
      var filter = e.filter,
        value = filter.value;

      if (value === "") {
        auto.close();
        e.preventDefault();
      }

      if ($this.attr("readonly")) {
        e.preventDefault();
      }

      if (auto.dataSource.transport.options) {
        var filters = {
          keyword: value,
          field: filter.field,
          operator: filter.operator,
          ignoreCase: filter.ignoreCase
        };

        auto.dataSource.transport.options.read.url = dews.url.appendParameters(auto.options.baseUrl, filters);
      }
    });

    auto.bind("close", function () {
      if (auto !== undefined && auto._old !== "") {
        if (auto.dataItem(0)) {
          auto._prev = $(auto.dataItem(auto.listView.focus())).innerText;
        }
      }
    });

    auto.bind("dataBound", function (e) {
      var listItems = e.sender.ul.children();
      var list, innerText, innerHTML;
      var reg = new RegExp("(" + auto._prev + ")", "gi");
      if (listItems.length > 0) {
        $(listItems).each(function (i) {
          list = listItems[i];
          innerText = $(list).children(".dews-autocomplete-text")[0].innerText;
          innerHTML = innerText.replace(reg, "<strong>$1</strong>");
          $(list).children(".dews-autocomplete-text")[0].innerHTML = innerHTML;
        });
      }
    });
  }

  function setAPI(auto, $el, opt) {
    var code, text, url;

    auto.code = function () {
      if (auto && auto._old !== "") {
        code = $(auto.dataItem(auto.listView.focus()))[0];
        if (code[opt.dataTextField] === auto._old) {
          return code[opt.dataCodeField];
        }
      }
      return "";
    };

    auto.text = function () {
      if (auto && auto._old !== "") {
        text = $(auto.dataItem(auto.listView.focus()))[0];
        if (text[opt.dataTextField] === auto._old) {
          return text[opt.dataTextField];
        }
      }
      return "";
    };

    auto.setParams = function (params) {
      auto.options.params = params;
      auto.dataSource.options.serverFiltering = true;
      if (auto.dataSource.transport.options) {
        url = auto.dataSource.transport.options.read.url;
        auto.options.baseUrl = dews.url.appendParameters(url, auto.options.params);
      }
    };
  }

  /**
   * 시용자 가이드를 위한 API 를 추가합니다.
   * @param $element 대상 jQuery 요소
   * @param instance DEWS 컴포넌트 인스턴스
   */
  function setUserGuideAPI($element) {
    $element.on("focus", function () {
      if (dews.ui.page && dews.ui.page.hasUserGuide) {
        if ($.isFunction(dews.ui.page.focusGuideItem) && $element.attr("id")) {
          dews.ui.page.focusGuideItem("#" + $element.attr("id"));
        }
      }
    });
  }

  /**
   * 이벤트 핸들러를 on,off 를 사용하여 등록하고 해제할 수 있도록 설정합니다.
   * @param instance kendo 컴포넌트 인스턴스
   */
  function attachEventProxy(instance) {}

  $.extend(true, dews, {
    ui: {
      autocomplete: function autocomplete(selector, options) {
        var $el, autocomplete;

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector);
        }

        if ($.type(selector) === "undefined") {
          return;
        }

        $el.each(function () {
          var $this = $(this),
            auto,
            opt;

          auto = $this.data("dews-control");

          if (!auto) {
            opt = getOptions($this, options);

            $this.kendoAutoComplete(opt);
            auto = $this.data("kendoAutoComplete");

            $this.data("dews-control", auto);

            initControl(auto, $this);
            bindEvent(auto, $this);
            setAPI(auto, $this, opt);
          }
          autocomplete = auto;
        });

        return autocomplete;
      }
    }
  });
  kendo.ui.AutoComplete.fn.readonly = function (readonly) {
    return function (value) {
      var self = this;

      if (typeof value === "undefined") {
        return self.element.prop("readonly");
      } else {
        if (value) {
          if (!self.wrapper.hasClass("dews-state-readonly")) {
            self.wrapper.addClass("dews-state-readonly");
          }
        } else {
          if (self.wrapper.hasClass("dews-state-readonly")) {
            self.wrapper.removeClass("dews-state-readonly");
          }
        }
      }

      readonly.call(self, value);
    };
  }(kendo.ui.AutoComplete.fn.readonly);

  kendo.ui.AutoComplete.fn.value = function (value) {
    var self = this;
    if (value !== undefined) {
      self.listView.value(value);
      self._accessor(value);
      self._old = this._accessor();
      self._oldText = this._accessor();

      $.when($.ajax(self.focus()), $.ajax(self.focus())).done(function (result1, result2) {
        self.select(self.ul.children().eq(0));
        var e = jQuery.Event("keydown", { keyCode: 13 });
        self.element.trigger(e);
        // self._focused.trigger(e);
        // self.trigger(e);
      });
    } else {
      return this._accessor();
    }
  };

  kendo.ui.AutoComplete.fn.enable = function (enable) {
    return function (value) {
      var self = this;

      if (typeof value === "undefined") {
        return !self.element.prop("disabled");
      } else {
        if (value) {
          if (self.wrapper.hasClass("disabled")) {
            self.wrapper.removeClass("disabled");
            self.wrapper.removeClass("dews-state-disabled");
          }
          if (self.element.hasClass("disabled")) {
            self.element.removeClass("disabled");
            self.element.removeClass("dews-state-disabled");
          }
        } else {
          if (!self.wrapper.hasClass("disabled")) {
            self.wrapper.addClass("disabled");
            self.wrapper.addClass("dews-state-disabled");
          }
          if (!self.element.hasClass("disabled")) {
            self.element.addClass("disabled");
            self.element.addClass("dews-state-disabled");
          }
        }
      }

      enable.call(self, value);

      if (value) {
        if (self.wrapper.hasClass("dews-state-readonly")) {
          self.readonly(true);
        }
      }
    };
  }(kendo.ui.AutoComplete.fn.enable);

  /**
   * 자동완성텍스트박스의 visible 여부를 가져옵니다.
   * @returns {boolean}
   * @private
   */
  kendo.ui.AutoComplete.fn._visibleCheckFromPanel = function () {
    var self = this,
      $ctrl = self.element;
    isVisible = $ctrl.parent(".dews-autocomplete-wrapper").css("display") !== "none";

    return isVisible;
  };

  kendo.ui.AutoComplete.fn.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change", "open", "close", "dataBound"];
    try {
      if (eventArray.indexOf(event) !== -1) {
        self.trigger(event);
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  kendo.ui.AutoComplete.fn.on = function () {
    var self = this,
      $element = self.element;

    if (arguments[0] === "nextFocus" || arguments[0] === "beforeFocus") {
      $element.on.apply($element, arguments);
    } else {
      self.bind.apply(self, arguments);
    }
  };

  kendo.ui.AutoComplete.fn.off = function () {
    var self = this,
      $element = self.element;

    if (arguments[0] === "nextFocus" || arguments[0] === "beforeFocus") {
      $element.off.apply($element, arguments);
    } else {
      self.unbind.apply(self, arguments);
    }
  };

  kendo.ui.AutoComplete.fn.validate = function () {
    var self = this;

    return !!self.text();
  };

  kendo.ui.AutoComplete.fn.required = function (value) {
    var self = this;
    var $el = self.element;
    var $wrapper = self.wrapper;

    if ($.type(value) === "undefined") {
      return $el.hasClass("required");
    } else if (value === true) {
      $el.addClass("required");
      $wrapper.addClass("dews-state-required");
    } else if (value === false) {
      $el.removeClass("required");
      $wrapper.removeClass("dews-state-required");
    }
  };

  kendo.ui.AutoComplete.fn.bindFromPanel = function (data) {
    var self = this,
      $element = self.element;
    var column;

    if (data) {
      column = $element.data("dews-bind-column") || $element.attr("id");

      if (column && data.hasOwnProperty(column)) {
        self.text(data[column] || "");
      }
    }
  };

  kendo.ui.AutoComplete.fn.serializeForPanel = function () {
    var self = this,
      $element = self.element;
    var column;
    var data;

    column = $element.data("dews-bind-column") || $element.attr("id");

    if (column) {
      data = {};
      data[column] = self.text();
    }

    return data;
  };

  kendo.ui.AutoComplete.fn.applyPanelFocus = function (requiredCheck) {
    var self = this,
      $element = self.element;

    $element.on("keydown", function (e) {
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && $element.is(":enabled")) {
        e.preventDefault();
      } else if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();

        var evt = new $.Event("beforeFocus");
        evt.control = self;

        $element.trigger(evt);
      } else if (e.keyCode === 9 || e.keyCode === 13 && $element.is(":enabled")) {
        if (e.keyCode === 9) {
          //tab키 기본동작 막기
          e.preventDefault();
        }
        if (e.keyCode === 13 && requiredCheck && $element.hasClass("required")) {
          if (self.validate()) {
            var evt = new $.Event("nextFocus");
            evt.control = self;

            $element.trigger(evt);
          }
        } else {
          var evt = new $.Event("nextFocus");
          evt.control = self;

          $element.trigger(evt);
        }
      }
    });
  };

  kendo.ui.AutoComplete.fn.canFocusable = function () {
    var self = this,
      $element = self.element;

    return !$element.hasClass("readonly") && $element.is(":visible") && $element.is(":enabled");
  };
  /**
   * 자동완성 컨트롤 자동화 인쇄 관련 데이터 추출
   * @return {*} 값이 설정 된 경우 Object 반환, 없는 경우 undefined 반환
   * @private
   */
  kendo.ui.AutoComplete.fn._getPrintData = function () {
    var self = this,
      $el = self.element,
      data;

    if (self.text()) {
      data = {
        id: $el.attr("id"),
        text: self.text()
      };
    }

    return data;
  };

  /**
   * 자동완성텍스트박스 컨트롤 display none 하여 숨기는 API
   */
  kendo.ui.AutoComplete.fn.hide = function () {
    var self = this;

    if (!(self.wrapper.css("display") === "none")) {
      self.wrapper.css("display", "none");
    }
  };

  /**
   * 자동완성텍스트박스 컨트롤 display inline-block 하여 보이도록 하는 API
   */
  kendo.ui.AutoComplete.fn.show = function () {
    var self = this;

    if (self.wrapper.css("display") === "none") {
      self.wrapper.css("display", "inline-block");
    }
  };

  dews.ui.addControlInitializer("autocomplete", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.autocomplete($("input[type='text'].dews-ui-autocomplete", $container));
  });
})(jQuery, window.dews || {}, window.kendo);


/*
 * 바코드
 */
(function ($, dews, kendo) {
  var defaultOptions = {
    type: "code39",
    text: {
      visible: false
    },
    width: 280,
    height: 100
  };

  /**
   * 바코드 생성을 위한 옵션을 가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   * @param {object} srcOptions 소스코드에서 전달된 옵션
   * @returns {object} 옵션
   */
  function getOptions($el, srcOptions) {
    var inlineOptions,
      options = {};

    inlineOptions = getInlineOptions($el);

    $.extend(true, options, defaultOptions, inlineOptions, srcOptions);

    return options;
  }

  kendo.dataviz.ui.Barcode.fn.resize = function (sizeOptions) {
    var self = this,
      $element = self.element;

    // width - min : 125
    // height - min : 24
    if ($.type(sizeOptions) !== "undefined") {
      // width 변경
      if (sizeOptions.hasOwnProperty("width")) {
        self.options.width = sizeOptions.width;
      }
      // height 변경
      if (sizeOptions.hasOwnProperty("height")) {
        self.options.height = sizeOptions.height;
      }
      self.redraw();
    }
  };

  /**
   * HTML 코드 상에 설정된 옵션 정보를 가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   * @returns {object} 옵션
   */
  function getInlineOptions($el) {
    var options = {},
      width,
      height,
      color,
      value,
      type,
      text;

    width = $el.data("dews-width");
    height = $el.data("dews-height");
    color = $el.data("dews-color");
    value = $el.data("dews-value");
    type = $el.data("dews-type");
    text = $el.data("dews-text");

    if (width) {
      options.width = parseInt(width, 10);
    }
    if (height) {
      options.height = parseInt(height, 10);
    }
    if (color) {
      options.color = color;
    }
    if (value) {
      options.value = value;
    }
    if (type) {
      options.type = type;
    }
    if (text) {
      options.text = {
        visible: /true/i.test(text)
      };
    }

    return options;
  }

  $.extend(true, dews, {
    ui: {
      barcode: function barcode(selector, options) {
        var $ctl, barcode;

        if (selector instanceof jQuery) {
          $ctl = selector;
        } else if ($.type(selector) === "string") {
          $ctl = $(selector);
        } else {
          throw "바코드를 생성할 대상이 제공되지 않았습니다.";
        }

        $ctl.each(function () {
          var $this = $(this),
            opt;

          barcode = $this.data("dews-control");

          if (!barcode) {
            opt = getOptions($this, options);

            $this.kendoBarcode(opt);

            if (!$this.hasClass("dews-ui-barcode")) {
              $this.addClass("dews-ui-barcode");
            }
            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            barcode = $this.data("kendoBarcode");
            $this.data("dews-control", barcode);
          }
        });

        return barcode;
      }
    }
  });

  dews.ui.addControlInitializer("barcode", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.barcode($("span.dews-ui-barcode", $container));
  });
})(jQuery, window.dews, window.kendo);


/*
 * 날짜피커,  시간피커,  월피커
 */
(function ($, dews, kendo) {
  /**
   * HTML 태그에 지정된 옵션을 가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   * @param {object} defaultOptions 기본 옵션
   * @returns {object} 옵션
   */
  function getInlineOptions($el, defaultOptions) {
    var options = {};

    if ($el.data("dews-max")) {
      options.max = kendo.parseDate(
      $el.data("dews-max").toString(),
      defaultOptions.valueFormat,
      kendo.getCulture());

    }

    if ($el.data("dews-min")) {
      options.min = kendo.parseDate(
      $el.data("dews-min").toString(),
      defaultOptions.valueFormat,
      kendo.getCulture());

    }

    if ($el.data("dews-format")) {
      options.format = $el.data("dews-format");
    }

    var secondValue = $el.data("dews-second-value");
    if (typeof secondValue === "boolean" && secondValue === true) {
      options.secondValue = true;
      options.valueFormat = "HHmmss";
    }

    var holidays_disabled = $el.data("dews-holidays-disabled");
    if ($.type(holidays_disabled) === "boolean") {
      options.holidays = options.holidays || {};
      options.holidays.disabled = holidays_disabled;
    }

    var holidays_visible = $el.data("dews-holidays-visible");
    if ($.type(holidays_visible) === "boolean") {
      options.holidays = options.holidays || {};
      options.holidays.visible = holidays_visible;
    }

    var holidays_type = $el.data("dews-holidays-type");
    if ($.type(holidays_type) !== undefined) {
      options.holidays = options.holidays || {};
      options.holidays.type = holidays_type;
    }

    return options;
  }

  /**
   * 시용자 가이드를 위한 API 를 추가합니다.
   * @param $element 대상 jQuery 요소
   * @param instance DEWS 컴포넌트 인스턴스
   */
  function setUserGuideAPI($element) {
    $element.on("focus", function () {
      if (dews.ui.page && dews.ui.page.hasUserGuide) {
        if ($.isFunction(dews.ui.page.focusGuideItem) && $element.attr("id")) {
          dews.ui.page.focusGuideItem("#" + $element.attr("id"));
        }
      }
    });
  }

  /**
   * 값을 설정하거나 가져옵니다.
   * @param {function} value Kendo UI 의 value 함수
   */
  function getSetValue(value) {
    return function (val) {
      var self = this,
        formats;

      if (self.element.data("dewsControl")) {
        if (self.options.name.toUpperCase() === "DATEPICKER") {
          if (self.options.depth === "decade") {
            formats = dews._environments.formats.yearValueFormat;
          } else if (self.options.depth === "year") {
            formats = dews._environments.formats.monthValueFormat;
          } else if (self.options.depth === "month") {
            formats = dews._environments.formats.dateValueFormat;
          }
        } else if (self.options.name.toUpperCase() === "DATETIMEPICKER") {
          formats = dews._environments.formats.dateTimeValueFormat;
        } else if (self.options.name.toUpperCase() === "TIMEPICKER") {
          // formats = dews._environments.formats.timeValueFormat;
          formats = self.options.valueFormat;
        }

        if (typeof val === "undefined") {
          return kendo.toString(self._value, formats, kendo.getCulture());
        }
        if ($.type(val) === "string") {
          val = kendo.parseDate(val, formats, kendo.getCulture());
          self.options.valueFlag = true;
        } else if (val === null) {
          self.options.valueFlag = true;
        }

        value.call(self, val);
        self.options.valueFlag = false;

        // 값이 유효하지 않은 경우 값 비우기
        if (self._old === undefined && val === null) {
          self.element.val("");
          self._oldText = self.element.val();
        }
      } else {
        if (typeof val === "undefined") {
          return self._value;
        }

        value.call(self, val);
      }
    };
  }

  /**
   * readonly 함수를 확장합니다.
   * @param {function} readonly Kendo UI의 readonly 함수
   */
  function setReadonly(readonly) {
    return function (val) {
      var self = this,
        $state = self.wrapper.find(".k-picker-wrap");

      if (typeof val === "undefined") {
        return self.element.prop("readonly");
      } else {
        if (val === true) {
          if (!self.wrapper.hasClass("readonly")) {
            self.wrapper.addClass("readonly");
          }
          if (!self.element.hasClass("readonly")) {
            self.element.addClass("readonly");
          }
          if (!$state.hasClass("dews-state-readonly")) {
            $state.addClass("dews-state-readonly");
          }
        } else if (val === false) {
          if (self.wrapper.hasClass("readonly")) {
            self.wrapper.removeClass("readonly");
          }
          if (self.element.hasClass("readonly")) {
            self.element.removeClass("readonly");
          }
          if ($state.hasClass("dews-state-readonly")) {
            $state.removeClass("dews-state-readonly");
          }
        }
      }

      readonly.call(self, val);
    };
  }

  /**
   * enable 함수를 확장합니다.
   * @param {function} readonly Kendo UI의 원본 readonly 함수
   */
  function setEnable(readonly) {
    return function (val) {
      var self = this,
        $state = self.wrapper.find(".k-picker-wrap");

      if (typeof val === "undefined") {
        return !self.element.prop("disabled");
      } else {
        if (val === false) {
          if (!self.wrapper.hasClass("disabled")) {
            self.wrapper.addClass("disabled");
          }
          if (!self.element.hasClass("disabled")) {
            self.element.addClass("disabled");
          }
          if (!$state.hasClass("dews-state-disabled")) {
            $state.addClass("dews-state-disabled");
          }
        } else {
          if (self.wrapper.hasClass("disabled")) {
            self.wrapper.removeClass("disabled");
          }
          if (self.element.hasClass("disabled")) {
            self.element.removeClass("disabled");
          }
          if ($state.hasClass("dews-state-disabled")) {
            $state.removeClass("dews-state-disabled");
          }
        }
      }

      readonly.call(self, val);

      if (val) {
        if (self.element.hasClass("readonly")) {
          self.readonly(true);
        }
      }
    };
  }

  /**
   * 최소값을 설정하거나 가져옵니다.
   */
  function getSetMin(min) {
    return function (val) {
      var self = this,
        date;

      if (typeof val === "undefined") {
        return kendo.toString(self.options.min, self.options.valueFormat, kendo.getCulture());
      } else if (val == "") {
        date = kendo.parseDate("10000101", self.options.valueFormat, kendo.getCulture());
      } else {
        date = kendo.parseDate(val.toString(), self.options.valueFormat, kendo.getCulture());
      }

      min.call(self, date);
    };
  }

  /**
   *  최대값을 설정하거나 가져옵니다.
   */
  function getSetMax(max) {
    return function (val) {
      var self = this,
        date;

      if (typeof val === "undefined") {
        return kendo.toString(self.options.max, self.options.valueFormat, kendo.getCulture());
      } else if (val == "") {
        date = kendo.parseDate("99991231", self.options.valueFormat, kendo.getCulture());
      } else {
        date = kendo.parseDate(val.toString(), self.options.valueFormat, kendo.getCulture());
      }

      max.call(self, date);
    };
  }

  /**
   * 추가적인 작업을 위한 API 를 추가합니다.
   * @param $element 대상 jQuery 요소
   * @param instance DEWS 컴포넌트 인스턴스
   */
  function setAdditionalAPI($element, instance) {
    instance.on = function () {
      if (arguments[0] === "nextFocus" || arguments[0] === "beforeFocus") {
        $element.on.apply($element, arguments);
      } else {
        instance.bind.apply(instance, arguments);
      }
    };
  }

  /**
   * kendo의 _update 함수를 확장합니다.
   * @param val 입력폼의 값
   */
  function setUpdate(_update) {
    return function (val) {
      var opt,
        self = this,
        $this = $(self.element),
        oldValue,
        changeValue,
        valueChanged,
        invalidDate;
      oldValue = $this.val(); // 새로운 값 설정 전의 값

      var value = _update.call(self, val);

      changeValue = $this.val(); // 새로운 입력 값
      valueChanged = kendo.calendar.isEqualDate(oldValue, changeValue) ? false : true; // 값 변화가 일어났는지의 여부

      opt = self.options;

      if (opt !== undefined) {
        DatePickerBase.prototype.setMask($this, opt.format);

        invalidDate =
        kendo.parseDate(changeValue, opt.format, opt.culture) === null &&
        kendo.parseDate(self._oldText, opt.format, kendo.getCulture()) === null;

        if (
        (!opt.valueFlag || opt.valueFlag === undefined) && (
        valueChanged || self._typing) &&
        !invalidDate &&
        !$this.hasClass("dews-ui-timepicker") &&
        !$this.hasClass("dews-ui-datetimepicker"))
        {
          self._old = value;
          self._oldText = self.element.val();
        }
      }
    };
  }

  /**
   * DatePickerBase 생성자 함수
   * @param kendoInstance
   * @constructor
   */
  var DatePickerBase = function DatePickerBase(kendoInstance) {
    this.kendoInstance = kendoInstance;

    for (var key in kendoInstance) {
      if (kendoInstance.hasOwnProperty(key)) {
        this[key] = kendoInstance[key];
      }
    }
  };

  /**
   * DEWS Public Functions & Developer Site Show
   */

  DatePickerBase.prototype.value = function (value) {
    return this.kendoInstance.value.call(this.kendoInstance, value);
  };

  /**
   * 설정된 텍스트를 가져옵니다.
   */
  DatePickerBase.prototype.text = function () {
    return this.element.val();
  };

  DatePickerBase.prototype.readonly = function (isReadonly) {
    return this.kendoInstance.readonly.call(this.kendoInstance, isReadonly);
  };

  DatePickerBase.prototype.enable = function (isEnable) {
    return this.kendoInstance.enable.call(this.kendoInstance, isEnable);
  };

  /**
   * 필수 입력 상태로 설정하거나 해제합니다.
   */
  DatePickerBase.prototype.required = function (value) {
    var self = this;
    var $wrapper = self.kendoInstance.wrapper,
      $element = self.element,
      $state = $wrapper.find(".k-picker-wrap");
    if ($.type(value) === "undefined") {
      return $wrapper.hasClass("required");
    } else if (value === true) {
      $wrapper.addClass("required");
      $element.addClass("required");
      $state.addClass("dews-state-required");
    } else if (value === false) {
      $wrapper.removeClass("required");
      $element.removeClass("required");
      $state.removeClass("dews-state-required");
    }
  };

  DatePickerBase.prototype.max = function (maxVal) {
    return this.kendoInstance.max.call(this.kendoInstance, maxVal);
  };

  DatePickerBase.prototype.min = function (minVal) {
    return this.kendoInstance.min.call(this.kendoInstance, minVal);
  };

  DatePickerBase.prototype.open = function (isOpen) {
    return this.kendoInstance.open.call(this.kendoInstance, isOpen);
  };

  DatePickerBase.prototype.close = function (isClose) {
    return this.kendoInstance.close.call(this.kendoInstance, isClose);
  };

  /**
   * DEWS Public Functions & Developer Site Hide
   */

  DatePickerBase.prototype.focus = function () {
    var self = this,
      $element = self.element;
    $element.focus();
  };

  DatePickerBase.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["open", "close", "change"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        self.kendoInstance.trigger(event);
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  DatePickerBase.prototype.on = function () {
    var self = this.kendoInstance,
      $element = self.element;
    if (arguments[0] === "nextFocus" || arguments[0] === "beforeFocus") {
      $element.on.apply($element, arguments);
    } else {
      self.bind.apply(self, arguments);
    }
  };

  DatePickerBase.prototype.off = function () {
    var self = this.kendoInstance,
      $element = self.element;
    if (arguments[0] === "nextFocus" || arguments[0] === "beforeFocus") {
      $element.off.apply($element, arguments);
    } else {
      self.unbind.apply(self, arguments);
    }
  };

  /**
   *  validate 값을 가져옵니다.
   * @returns {boolean}
   */
  DatePickerBase.prototype.validate = function () {
    var self = this.kendoInstance;
    return !!self.value();
  };

  /**
   * 날짜 컨트롤 자동화 인쇄 관련 데이터 추출
   * @return {*} 값이 설정 된 경우 Object 반환, 없는 경우 undefined 반환
   * @private
   */
  DatePickerBase.prototype._getPrintData = function () {
    var self = this,
      $el = $(self.element),
      data;

    if (self.text()) {
      data = {
        id: $el.attr("id"),
        text: self.text()
      };
    }

    return data;
  };

  /**
   *  DEWS Private Functions
   */

  /**
   * 옵션을 가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery객체
   * @param {object} defaultOptions 기본 옵션
   * @param {object} srcOptions 스크립트 코드에서 전송된 옵션
   * @returns {object} 옵션 설정 값
   */
  DatePickerBase.prototype.getOptions = function ($el, defaultOptions, srcOptions) {
    var inlineOptions = {},
      preDefinedFormat,
      options;

    inlineOptions = getInlineOptions($el, defaultOptions);
    if (srcOptions) {
      srcOptions.format ? $el.data("dews-format", srcOptions.format) : "";
      srcOptions.predefined ? $el.data("dews-format-predefined", srcOptions.predefined) : "";
    }
    preDefinedFormat = dews.getPreDefinedFormat($el);

    if (preDefinedFormat) {
      var vf = preDefinedFormat.replace(/[^(a-z)]/gi, "");
      preDefinedFormat = {
        format: preDefinedFormat,
        valueFormat: vf
      };
      options = $.extend(true, {}, defaultOptions, inlineOptions, srcOptions, preDefinedFormat);
    } else if (preDefinedFormat !== false && inlineOptions) {
      options = $.extend(true, {}, defaultOptions, inlineOptions, srcOptions);
    } else {
      if (srcOptions !== undefined) {
        srcOptions.format =
        preDefinedFormat === false && srcOptions.format && srcOptions.predefined === true ?
        defaultOptions.format :
        srcOptions.format;
      }
      options = $.extend(true, {}, defaultOptions, srcOptions);
    }

    if ($el.val()) {
      options.value = kendo.parseDate($el.val(), options.valueFormat, kendo.getCulture());
    }

    return options;
  };

  /**
   * 코드피커를 초기화 합니다.
   * @param {jQuery} $el 적용할 대상 요소의 jQuery객체입니다.
   * @param {string} type 피커 타입입니다.
   */
  DatePickerBase.prototype.initControl = function ($el, type) {
    var $wrapper = $el.closest(".k-widget"),
      $state = $wrapper.find(".k-picker-wrap");

    if ($wrapper.hasClass("dews-ui-" + type)) {
      $wrapper.removeClass("dews-ui-" + type);
    }
    if ($wrapper.hasClass("dews-control-activate")) {
      $wrapper.removeClass("dews-control-activate");
    }
    if (!$wrapper.hasClass("dews-" + type + "-wrapper")) {
      $wrapper.addClass("dews-" + type + "-wrapper");
    }

    //
    // 상태정보 추가
    //
    if ($wrapper.hasClass("disabled")) {
      $state.addClass("dews-state-disabled");
      $wrapper.removeClass("disabled");
    }
    if ($wrapper.hasClass("readonly")) {
      $state.addClass("dews-state-readonly");
      $wrapper.removeClass("readonly");
    }
    if ($wrapper.hasClass("required")) {
      $state.addClass("dews-state-required");
      $wrapper.removeClass("required");
    }
    if ($wrapper.hasClass("etc1")) {
      $state.addClass("dews-state-etc1");
      $wrapper.removeClass("etc1");
    }
    if ($wrapper.hasClass("etc2")) {
      $state.addClass("dews-state-etc2");
      $wrapper.removeClass("etc2");
    }
    if ($wrapper.hasClass("etc3")) {
      $state.addClass("dews-state-etc3");
      $wrapper.removeClass("etc3");
    }

    setUserGuideAPI($el);
  };

  /**
   * 텍스트박스에 마스크를 적용합니다.
   * @param {jQuery} $el 적용할 대상 요소의 jQuery 객체
   * @param {string} format 적용 포맷
   */
  DatePickerBase.prototype.setMask = function ($el, format) {
    var maskJsUrl;
    var interval;

    // jquery.maskedinput.js 를 이용하여 마스크를 적용함
    // script 파일을 로드된 적이 없으면 동적으로 로드합니다.
    // 동시에 여러 컴포넌트 초기화 시 여러번 로드되지않도록 환경변수 두어서 1번만 로드하도록 수정
    maskJsUrl = dews.url.join(dews._environments.scriptBase || "/scripts/", "jquery.maskedinput.js");

    var applyMask = function applyMask() {
      $el.mask(format.replace(/[ymdhms]/gi, "9"));
    };

    if (dews._environments.loadJqueryMaskedinput && $.mask) {
      applyMask();
    } else if (dews._environments.loadJqueryMaskedinput && !$.mask) {
      interval = setInterval(function () {
        if ($.mask) {
          applyMask();
          clearInterval(interval);
        }
      }, 100);
    } else {
      $.getScript(maskJsUrl, function () {
        applyMask();
      });
      dews._environments.loadJqueryMaskedinput = true;
    }
  };

  /**
   * 공통 이벤트를 설정합니다.
   * @param {jQuery} $el 대상 요소의 jQuery객체 입니다.
   * @param {object} [options] 피커의 옵션입니다.
   */
  DatePickerBase.prototype.setEvent = function ($el, options) {
    var self = this;

    $el.on("click", function () {
      var $this = $(this);
      if ($this.prop("readonly") === false && $this.prop("disabled") === false) {
        // 읽기 전용/비활성화 상태가 아니면 포커스가 오면 텍스트 전체를 선택하도록 한다.
        $this.select();
      }
    }).
    on("blur", function (e) {
      var $this = $(this),
        ctrl = $this.data("dews-control"),
        inputDate;
      if ($this.prop("readonly") === false && $this.prop("disabled") === false) {
        if (!dews.date.validate($this.val(), options.format)) {
          ctrl.value("");
          // TODO: 입력된 값이 유효하지 않을 경우 오류 표시 및 포커스 처리 고도화
        } else {
          if ($this.val()) {
            inputDate = kendo.parseDate(
            $this.val(),
            $this.data("dews-control").options.format,
            kendo.getCulture());

            if (
            ctrl &&
            ctrl.dateView &&
            ctrl.dateView.options.max &&
            ctrl.dateView.options.max < inputDate)
            {
              ctrl.value(
              kendo.toString(
              ctrl.dateView.options.max,
              ctrl.options.valueFormat,
              kendo.getCulture()));


            }
            if (
            ctrl &&
            ctrl.dateView &&
            ctrl.dateView.options.min &&
            ctrl.dateView.options.min > inputDate)
            {
              ctrl.value(
              kendo.toString(
              ctrl.dateView.options.min,
              ctrl.options.valueFormat,
              kendo.getCulture()));


            }
          }
        }
      }
    }).
    on("keydown", function (e) {
      var $this = $(this),
        ctrl = $this.data("dews-control");
      // f4로 달력 팝업 활성화
      if (e.keyCode === 115) {
        ctrl.open();
        if (
        ctrl.text() === ctrl.options.format.replace(/[A-z]/gi, "_") &&
        $.type(ctrl.dateView) !== "undefined" &&
        $.type(ctrl.dateView.calendar) !== "undefined")
        {
          ctrl.dateView.calendar.navigate(new Date());
        } else if (
        $.type(ctrl.dateView) !== "undefined" &&
        $.type(ctrl.dateView.calendar) !== "undefined")
        {
          ctrl.dateView.calendar.navigate(ctrl.value());
        }

        e.stopPropagation();
        e.preventDefault();
      }

      if (e.keyCode === 13) {
        if (
        ctrl.text() === ctrl.options.format.replace(/[A-z]/gi, "_") &&
        $.type(ctrl.timeView) !== "undefined" &&
        ctrl.timeView.list.is(":visible"))
        {
          ctrl.value(new Date());
        }
      }

      if (e.keyCode === 113) {
        var regExp = /[-\ \:]/gi;
        var str = ctrl.element.val();

        if (regExp.test(str)) {
          if (self.options.format) {
            // 기본 포맷의 값이 아닐 경우(ex: MM-yyyy) value() 내에서 값 세팅이 안되므로 현재 포맷을 기준으로 date 값으로 변경하여 value() 호출
            var date = kendo.parseDate(str, self.options.format, kendo.getCulture());
            ctrl.value(date);
          }
          // else {
          //     ctrl.value(str.replace(regExp, ""));
          // }
        } else {
          ctrl.value(str);
        }
      }
    });
  };

  /**
   * 캘린더 옵션을 설정 합니다.
   * @param picker
   * @param options
   * @private
   */
  DatePickerBase.prototype._setOptions = function (picker, options) {
    picker.dateView._setOptions = function (options) {
      this.calendar.setOptions({
        focusOnNav: false,
        change: options.change,
        culture: options.culture,
        dates: options.dates,
        depth: options.depth,
        footer: options.footer,
        format: options.format,
        max: options.max,
        min: options.min,
        month: options.month,
        weekNumber: options.weekNumber,
        start: options.start,
        disableDates: options.disableDates,
        holidays: options.holidays,
        dateStyles: options.dateStyles
      });
    };
  };

  // DatePickerBase.prototype.applyPanelFocus = function (requiredCheck) {
  //     _applyPanelFocus.call( this, requiredCheck )
  // };

  /**
   * FormPanel, ConditionPanel: _applyFocusManager 내부적으로 사용
   * @param requiredCheck
   */
  DatePickerBase.prototype.applyPanelFocus = function (requiredCheck) {
    var self = this;
    var $element = self.kendoInstance.element;
    // var $element = self.element;

    $element.on("keydown", function (e) {
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && $element.is(":enabled")) {
        e.preventDefault();
      } else if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();

        var evt = new $.Event("beforeFocus");
        evt.control = self;

        $element.trigger(evt);
      } else if (e.keyCode === 9 || e.keyCode === 13 && $element.is(":enabled")) {
        if (e.keyCode === 9) {
          //tab키 기본동작 막기
          e.preventDefault();
        }

        if (e.keyCode === 13 && requiredCheck && $element.hasClass("required")) {
          if (self.validate()) {
            var evt = new $.Event("nextFocus");
            evt.control = self;

            $element.trigger(evt);
          }
        } else {
          var evt = new $.Event("nextFocus");
          evt.control = self;

          $element.trigger(evt);
        }
      }
    });
  };

  /**
   * FormPanel, ConditionPanel: focus 관련 내부적으로 사용
   * @returns {boolean|*}
   */
  DatePickerBase.prototype.canFocusable = function () {
    // var self = this, $element = self.element;
    var self = this,
      $element = self.kendoInstance.element;
    return !$element.hasClass("readonly") && $element.is(":visible") && $element.is(":enabled");
  };

  /**
   * FormPanel, ConditionPanel: bindData 함수 내부적으로 사용
   * @param data
   */
  DatePickerBase.prototype.bindFromPanel = function (data) {
    var self = this,
      $element = self.kendoInstance.element;
    var column;

    if (data) {
      column = $element.data("dews-bind-column") || $element.attr("id");

      if (column && data.hasOwnProperty(column)) {
        self.value(data[column] || "");
      }
    }
  };

  /**
   * FormPanel, ConditionPanel: serialize 함수 내부적으로 사용
   * @returns {{}}
   */
  DatePickerBase.prototype.serializeForPanel = function () {
    var self = this,
      $element = self.kendoInstance.element;
    var column, data;

    column = $element.data("dews-bind-column") || $element.attr("id");

    if (column) {
      data = {};
      data[column] = self.value();
    }

    return data;
  };

  /**
   * 기간피커의 visible 여부를 가져옵니다.
   * @desc FormPanel, ConditionPanel: _applyFocusManager 내부적으로 사용
   * @returns {boolean|*}
   * @private
   */
  DatePickerBase.prototype._visibleCheckFromPanel = function () {
    var self = this,
      $ctrl = self.element;
    isVisible = $ctrl.closest(".dews-datepicker-wrapper").css("display") !== "none";

    return isVisible;
  };

  DatePickerBase.prototype._update = function (value) {
    return this.kendoInstance._update.call(this.kendoInstance, value);
  };

  DatePickerBase.prototype.hide = function () {
    var self = this,
      $wrapper = self.kendoInstance.wrapper;

    if (!($wrapper.css("display") === "none")) {
      $wrapper.css("display", "none");
    }
  };

  DatePickerBase.prototype.show = function () {
    var self = this,
      $wrapper = self.kendoInstance.wrapper;

    if ($wrapper.css("display") === "none") {
      $wrapper.css("display", "inline-block");
    }
  };

  $.extend(true, dews, {
    ui: {
      DatePickerBase: DatePickerBase
    }
  });

  /**
   * 값을 설정하거나 가져옵니다.
   */
  kendo.ui.DatePicker.fn.value = getSetValue(kendo.ui.DatePicker.fn.value);
  kendo.ui.TimePicker.fn.value = getSetValue(kendo.ui.TimePicker.fn.value);
  kendo.ui.DateTimePicker.fn.value = getSetValue(kendo.ui.DateTimePicker.fn.value);

  // readonly 함수 확장
  kendo.ui.DatePicker.fn.readonly = setReadonly(kendo.ui.DatePicker.fn.readonly);
  kendo.ui.TimePicker.fn.readonly = setReadonly(kendo.ui.TimePicker.fn.readonly);
  kendo.ui.DateTimePicker.fn.readonly = setReadonly(kendo.ui.DateTimePicker.fn.readonly);

  // enable 함수 확장
  kendo.ui.DatePicker.fn.enable = setEnable(kendo.ui.DatePicker.fn.enable);
  kendo.ui.TimePicker.fn.enable = setEnable(kendo.ui.TimePicker.fn.enable);
  kendo.ui.DateTimePicker.fn.enable = setEnable(kendo.ui.DateTimePicker.fn.enable);

  //min, max 함수 확장
  kendo.ui.DatePicker.fn.min = getSetMin(kendo.ui.DatePicker.fn.min);
  kendo.ui.DatePicker.fn.max = getSetMax(kendo.ui.DatePicker.fn.max);
  kendo.ui.TimePicker.fn.min = getSetMin(kendo.ui.TimePicker.fn.min);
  kendo.ui.TimePicker.fn.max = getSetMax(kendo.ui.TimePicker.fn.max);
  kendo.ui.DateTimePicker.fn.min = getSetMin(kendo.ui.DateTimePicker.fn.min);
  kendo.ui.DateTimePicker.fn.max = getSetMax(kendo.ui.DateTimePicker.fn.max);

  // _update 함수 확장
  kendo.ui.DatePicker.fn._update = setUpdate(kendo.ui.DatePicker.fn._update);
  kendo.ui.TimePicker.fn._update = setUpdate(kendo.ui.TimePicker.fn._update);
  kendo.ui.DateTimePicker.fn._update = setUpdate(kendo.ui.DateTimePicker.fn._update);

  // text 함수 확장
  kendo.ui.DatePicker.fn.text = kendo.ui.TimePicker.fn.text = kendo.ui.DateTimePicker.fn.text = DatePickerBase.text;

  kendo.ui.DatePicker.fn.raiseEvent =
  kendo.ui.TimePicker.fn.raiseEvent =
  kendo.ui.DateTimePicker.fn.raiseEvent =
  DatePickerBase.raiseEvent;
  kendo.ui.DatePicker.fn.on = kendo.ui.TimePicker.fn.on = kendo.ui.DateTimePicker.fn.on = DatePickerBase.on;
  kendo.ui.DatePicker.fn.off = kendo.ui.TimePicker.fn.off = kendo.ui.DateTimePicker.fn.off = DatePickerBase.off;
  kendo.ui.DatePicker.fn.validate =
  kendo.ui.TimePicker.fn.validate =
  kendo.ui.DateTimePicker.fn.validate =
  DatePickerBase.validate;
  kendo.ui.DatePicker.fn.bindFromPanel =
  kendo.ui.TimePicker.fn.bindFromPanel =
  kendo.ui.DateTimePicker.fn.bindFromPanel =
  DatePickerBase.bindFromPanel;
  kendo.ui.DatePicker.fn.serializeForPanel =
  kendo.ui.TimePicker.fn.serializeForPanel =
  kendo.ui.DateTimePicker.fn.serializeForPanel =
  DatePickerBase.serializeForPanel;
  kendo.ui.DatePicker.fn.applyPanelFocus =
  kendo.ui.TimePicker.fn.applyPanelFocus =
  kendo.ui.DateTimePicker.fn.applyPanelFocus =
  DatePickerBase.applyPanelFocus;
  kendo.ui.DatePicker.fn.focus =
  kendo.ui.TimePicker.fn.focus =
  kendo.ui.DateTimePicker.fn.focus =
  DatePickerBase.focus;
  kendo.ui.DatePicker.fn.canFocusable =
  kendo.ui.TimePicker.fn.canFocusable =
  kendo.ui.DateTimePicker.fn.canFocusable =
  DatePickerBase.canFocusable;

  // 자동화 인쇄 관련 함수 확장
  kendo.ui.DatePicker.fn._getPrintData =
  kendo.ui.TimePicker.fn._getPrintData =
  kendo.ui.DateTimePicker.fn._getPrintData =
  DatePickerBase._getPrintData;

  // required 함수 추가
  kendo.ui.DatePicker.fn.required =
  kendo.ui.TimePicker.fn.required =
  kendo.ui.DateTimePicker.fn.required =
  DatePickerBase.required;

  // _visibleCheckFormPanel 함수 추가
  kendo.ui.DatePicker.fn._visibleCheckFromPanel =
  kendo.ui.TimePicker.fn._visibleCheckFromPanel =
  kendo.ui.DateTimePicker.fn._visibleCheckFromPanel =
  DatePickerBase._visibleCheckFromPanel;
})(jQuery, window.dews, window.kendo);


(function ($, dews, kendo) {
  // 기본 옵션
  var defaultOption = {};

  $.extend(true, dews, {
    ui: {
      /**
       * Button을 생성하거나 가져옵니다.
       * @param {string} selector 요소를 지정하는 셀렉터입니다.
       * @param {object} [options] 버튼 설정 값
       */
      button: function button(selector, options) {
        var $el, button;

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector);
        }

        if (kendo) {
          $el.each(function () {
            var $this = $(this),
              control,
              opt;

            button = $this.data("dews-control");

            if (!control) {
              opt = $.extend(true, {}, defaultOption, options);

              if (!$this.hasClass("dews-control")) {
                $this.addClass("dews-control");
              }

              if (!$this.hasClass("dews-ui-button")) {
                $this.addClass("dews-ui-button");
              }

              if (!$this.attr("type")) {
                $this.attr("type", "button");
              }

              if ($this.data("dews-localize-key")) {
                $this.text(
                dews.localize.get(
                $this.text(),
                $this.data("dews-localize-key"),
                $this.data("dews-localize-lang") || null));


              }

              $this.kendoButton(opt);

              button = $this.data("kendoButton");
              $this.data("dews-control", button);

              if (!$this.hasClass("dews-control-activate")) {
                $this.addClass("dews-control-activate");
              }
            }
          });

          return button;
        }
      }
    }
  });

  kendo.ui.Button.fn.on = function (e) {
    var self = this,
      $element = self.element;

    $element.on.apply($element, arguments);
  };

  kendo.ui.Button.fn.raiseEvent = function (event) {
    var self = this,
      eventArray = ["click"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        self.element.trigger(event);
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  dews.ui.addControlInitializer("button", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.button($(".dews-ui-button", $container));
  });
})(jQuery, window.dews, window.kendo);


/*
 * 캘린더
 */
(function ($, dews, kendo) {
  var defaultDateOptions = {
    format: dews._environments.formats.dateFormat,
    valueFormat: dews._environments.formats.dateValueFormat,
    holidays: {
      visible: false,
      disabled: false,
      type: "1"
    }
  };

  var defaultMonthOptions = {
    start: "year",
    depth: "year",
    format: dews._environments.formats.monthFormat,
    valueFormat: dews._environments.formats.monthValueFormat,
    holidays: {
      visible: false,
      disabled: false,
      type: "1"
    }
  };

  /**
   * 옵션을 가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   * @param {object} codeOptions 스크립트 코드에서 전송된 옵션
   */
  function getOptions($el, codeOptions) {
    var defaultOptions,
      inlineOptions,
      options = {};

    if ($el.hasClass("month")) {
      defaultOptions = defaultMonthOptions;
    } else {
      defaultOptions = defaultDateOptions;
    }

    defaultOptions.culture = dews.localize.getLanguage();

    inlineOptions = getInlineOptions($el, defaultOptions);

    if (codeOptions) {
      if (codeOptions.value && $.type(codeOptions.value) === "string") {
        codeOptions.value = kendo.parseDate(codeOptions.value, defaultOptions.valueFormat, kendo.getCulture());
      }

      if (codeOptions.max && $.type(codeOptions.max) === "string") {
        codeOptions.max = kendo.parseDate(codeOptions.max, defaultOptions.valueFormat, kendo.getCulture());
      }

      if (codeOptions.min && $.type(codeOptions.min) === "string") {
        codeOptions.min = kendo.parseDate(codeOptions.min, defaultOptions.valueFormat, kendo.getCulture());
      }
    }

    $.extend(true, options, defaultOptions, inlineOptions, codeOptions);

    return options;
  }

  /**
   * HTML 태그에 지정된 옵션을 가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   * @returns {object} 옵션
   */
  function getInlineOptions($el, defaultOptions) {
    var options = {};

    if ($el.data("dews-value")) {
      options.value = kendo.parseDate(
      $el.data("dews-value") + "",
      defaultOptions.valueFormat,
      kendo.getCulture());

    }

    if ($el.data("dews-max")) {
      options.max = kendo.parseDate($el.data("dews-max") + "", defaultOptions.valueFormat, kendo.getCulture());
    }

    if ($el.data("dews-min")) {
      options.min = kendo.parseDate($el.data("dews-min") + "", defaultOptions.valueFormat, kendo.getCulture());
    }

    if ($el.data("dews-format")) {
      options.format = $el.data("dews-format");
    }

    var holidays_disabled = $el.data("dews-holidays-disabled");
    if ($.type(holidays_disabled) === "boolean") {
      options.holidays = options.holidays || {};
      options.holidays.disabled = holidays_disabled;
    }

    var holidays_visible = $el.data("dews-holidays-visible");
    if ($.type(holidays_visible) === "boolean") {
      options.holidays = options.holidays || {};
      options.holidays.visible = holidays_visible;
    }

    return options;
  }

  function popupOpen(options) {
    if ($("#dateCalendarWrapper").length) {
      $("div").remove("#dateCalendarWrapper");
      return;
    }

    var $wrapper = $('<div id="dateCalendarWrapper" class="dews-calendar-wrapper">');
    var $title = $('<h3 id="calendarPopupTitle" class="dews-calendar-title">');
    var $cal = $('<div class="dews-ui-calendar">');
    var $container = $('<div class="dews-ui-calendar-button_penal">');
    var $doneButton = $('<button id="doneBtn" class="dews-ui-button"></button>');
    var $cancelButton = $('<button id="cancelBtn" class="dews-ui-button"></button>');

    if (options.popup.title != null && options.popup.title !== "") {
      $wrapper.append($title);
      $title.text(options.popup.title);
    }

    $wrapper.append($cal);
    $wrapper.append($container);

    calendar = dews.ui.calendar($cal, {
      value: options.value,
      min: options.min,
      max: options.max,
      selectable: options.selectable,
      holidays: options.holidays
    });

    if (options.popup.button != null) {
      if (options.popup.button === "saveAndCancel") {
        $container.append($doneButton);
        $container.append($cancelButton);
        $doneButton.text("저장");
        $cancelButton.text("취소");
      } else if (options.popup.button === "applyAndClose") {
        $container.append($doneButton);
        $container.append($cancelButton);
        $doneButton.text("적용");
        $cancelButton.text("닫기");
      } else if (options.popup.button === "close") {
        $container.append($cancelButton);
        $cancelButton.text("닫기");
      } else {
        calendar.bind("change", function () {
          options.popup.ok.call(calendar);
          $("div").remove("#dateCalendarWrapper");
        });
      }
    }
    $(document.body).append($wrapper);

    if (options.popup.target instanceof jQuery) {
      $("#dateCalendarWrapper").offset({
        top: options.popup.target.height() + options.popup.target.offset().top,
        left: options.popup.target.offset().left
      });
    } else if ($.type(options.popup.target) === "string") {
      $("#dateCalendarWrapper").offset({
        top: $(options.popup.target).height() + $(options.popup.target).offset().top,
        left: $(options.popup.target).offset().left
      });
    }

    $cal.removeClass("dews-ui-calendar");

    $("#doneBtn").on("click", function (e) {
      if (options.popup.ok != null) {
        options.popup.ok.call(calendar);
      }

      $("div").remove("#dateCalendarWrapper");
    });

    $("#cancelBtn").on("click", function (e) {
      $("div").remove("#dateCalendarWrapper");

      if (options.popup.cancel != null) {
        options.popup.cancel();
      }
    });

    // 버블링 이벤트 처리
    $("#dateCalendarWrapper").on("click", function (e) {
      e.preventDefault();
      e.stopPropagation();

      return false;
    });

    $(document.body).on("click", function (e) {
      if ($("#dateCalendarWrapper").length) {
        $("div").remove("#dateCalendarWrapper");
      }
    });

    return calendar;
  }

  $.extend(true, dews, {
    ui: {
      /**
       * 달력을 생성합니다.
       * @param {String|jQuery} selector 셀렉터 또는 jQuery 객체
       * @param {Object} [options] 설정 값, 생략하면 일별 default로 달력이 생성됩니다.
       */
      calendar: function calendar(selector, options) {
        var $el, calendar;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        if (options != null && options.popup != null) {
          return popupOpen(options);
        }

        $el.each(function () {
          var $this = $(this),
            opt;

          calendar = $this.data("dews-control");

          if (!calendar) {
            if ($this.data("dews-selectable")) {
              defaultDateOptions.selectable = $this.data("dews-selectable");
            }

            opt = getOptions($this, options);

            $this.kendoCalendar(opt);

            calendar = $this.data("kendoCalendar");
            calendar.options.valueFormat = opt.valueFormat;

            if (!$this.hasClass("dews-ui-calendar")) {
              $this.addClass("dews-ui-calendar");
            }

            if (!$this.hasClass("dews-form-control")) {
              $this.addClass("dews-form-control");
            }

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            $this.data("dews-control", calendar);

            // calendar = Calendar($this, options);
          }
        });

        return calendar;
      }
    }
  });

  // 현재 월에대한 선택한 데이터만 가져오기
  kendo.ui.Calendar.fn.currentMonthDates = function () {
    // 현재 월에 대한 선택된 데이터만 구하기
    var dates = [];
    if (calendar._current.getMonth() + 1 < 10) {
      var currentMonth = "0" + (calendar._current.getMonth() + 1);

      var selectDates = calendar.selectDates();
      for (var i = 0; i < selectDates.length; i++) {
        if (currentMonth === selectDates[i].substring(4, 6)) {
          dates.push(selectDates[i]);
        }
      }
    } else {
      var currentMonth = "" + (calendar._current.getMonth() + 1);

      var selectDates = calendar.selectDates();
      for (var i = 0; i < selectDates.length; i++) {
        if (currentMonth === selectDates[i].substring(4, 6)) {
          dates.push(selectDates[i]);
        }
      }
    }

    return dates;
  };

  //selectDates 함수 재정의
  kendo.ui.Calendar.fn.selectDates = function (dates) {
    var that = this,
      validSelectedDates,
      datesUnique,
      val;
    if (dates === undefined) {
      var array = [];
      for (var i = 0; i < that._selectDates.length; i++) {
        var d = new Date(that._selectDates[i]);
        var dY = d.getFullYear();
        var dM = d.getMonth() + 1;
        var dD = d.getDate();

        var format = dY + ("00" + dM.toString()).slice(-2) + ("00" + dD.toString()).slice(-2);

        array.push(format);
      }
      return array;
    }
    datesUnique = dates.
    map(function (date) {
      return date.getTime();
    }).
    filter(function (date, position, array) {
      return array.indexOf(date) === position;
    }).
    map(function (time) {
      return new Date(time);
    });

    validSelectedDates = $.grep(datesUnique, function (value) {
      if (value) {
        return +that._validateValue(new Date(value.setHours(0, 0, 0, 0))) === +value;
      }
    });
    that._selectDates = validSelectedDates.length > 0 ? validSelectedDates : that._selectDates;
    that._visualizeSelectedDatesInView();
  };

  //_onSelect 함수 재정의
  kendo.ui.Calendar.fn._onSelect = function (e) {
    var parseOptions = function parseOptions(selectable) {
      var asLowerString = typeof selectable === "string" && selectable.toLowerCase();
      return {
        multiple: asLowerString && asLowerString.indexOf("multiple") > -1,
        cell: asLowerString && asLowerString.indexOf("cell") > -1
      };
    };

    var that = this,
      eventArgs = e,
      selectableOptions = parseOptions(that.options.selectable);
    var DISABLED = "k-state-disabled";
    var CELLSELECTORVALID = "td:has(.k-link):not(." + DISABLED + ")";
    var CELLSELECTOR = "td:has(.k-link)";
    var CHANGE = "change";

    if (!selectableOptions.multiple) {
      if (
      $(eventArgs.event.currentTarget).is("td") &&
      !$(eventArgs.event.currentTarget).hasClass("k-state-selected"))
      {
        $(eventArgs.event.currentTarget).addClass("k-state-selected");
      } else {
        that._click($(eventArgs.event.currentTarget).find("a"));
      }
      return false;
    }
    if (eventArgs.event.ctrlKey || eventArgs.event.metaKey) {
      if ($(eventArgs.event.currentTarget).is(CELLSELECTORVALID)) {
        that._toggleSelection($(eventArgs.event.currentTarget));
      } else {
        that._cellsBySelector(CELLSELECTORVALID).each(function (index, element) {
          var value = that._toDateObject($(element).find("a"));
          that._deselect(value);
        });
        that._addSelectedCellsToArray();
      }
    } else if (eventArgs.event.shiftKey) {
      that._rangeSelection(that._cell);
    } else if ($(eventArgs.event.currentTarget).is(CELLSELECTOR)) {
      that.value(that._toDateObject($(eventArgs.event.currentTarget).find("a")));
    } else {
      that._selectDates = [];
      that._addSelectedCellsToArray();
    }
    that.trigger(CHANGE);

    return false;
  };

  // current 함수 재정의
  kendo.ui.Calendar.fn.current = function (current) {
    return function (useDate) {
      var self = this,
        date;

      if (self.element.data("dewsControl")) {
        date = current.call(self);

        if (useDate) {
          return date;
        } else {
          return kendo.toString(date, self.options.valueFormat, kendo.getCulture());
        }
      } else {
        return current.call(self);
      }
    };
  }(kendo.ui.Calendar.fn.current);

  // max 함수 재정의
  kendo.ui.Calendar.fn.max = function (max) {
    return function (value) {
      var self = this,
        date;

      if (self.element.data("dewsControl")) {
        if (typeof value === "undefined") {
          date = max.call(self);

          return kendo.toString(date, self.options.valueFormat, kendo.getCulture());
        } else {
          if ($.type(value) === "date") {
            date = value;
          } else {
            date = kendo.parseDate(value, self.options.valueFormat, kendo.getCulture());
          }

          return max.call(self, date);
        }
      } else {
        return max.call(self, value);
      }
    };
  }(kendo.ui.Calendar.fn.max);

  // min 함수 재정의
  kendo.ui.Calendar.fn.min = function (min) {
    return function (value) {
      var self = this,
        date;

      if (self.element.data("dewsControl")) {
        if (typeof value === "undefined") {
          date = min.call(self);

          return kendo.toString(date, self.options.valueFormat, kendo.getCulture());
        } else {
          if ($.type(value) === "date") {
            date = value;
          } else {
            date = kendo.parseDate(value, self.options.valueFormat, kendo.getCulture());
          }
          return min.call(self, date);
        }
      } else {
        return min.call(self, value);
      }
    };
  }(kendo.ui.Calendar.fn.min);

  // navigate 함수 재정의
  kendo.ui.Calendar.fn.navigate = function (navigate) {
    return function (value, view) {
      var self = this,
        date,
        stringDate,
        currentYear,
        changeView = self._changeView,
        valueFormat;

      if (changeView === undefined) {
        changeView = true;
      }

      if (self.options.valueFormat) {
        valueFormat = self.options.valueFormat;
      } else {
        valueFormat = dews._environments.formats.dateValueFormat;
      }

      if (value > self.options.max) {
        value = self.options.max;
      } else if (value < self.options.min) {
        value = self.options.min;
      }

      if (!value) {
        stringDate = kendo.toString(self._current, valueFormat, kendo.getCulture());
      } else if ($.type(value) !== "date") {
        stringDate = value;
        date = kendo.parseDate(value, self.options.valueFormat, kendo.getCulture());
      } else {
        stringDate = kendo.toString(value, valueFormat, kendo.getCulture());
        date = value;
      }

      if (!self._holidays) {
        self._holidays = {};
      }

      if (dews._environments.holidays) {
        $.extend(self._holidays, dews._environments.holidays);
      }

      currentYear = stringDate.substr(0, 4);

      navigate.call(self, date, view);

      // if (self.element.hasClass('dews-ui-calendar') && changeView) {
      if (self.options.holidays && changeView) {
        if (self._holidays[currentYear]) {
          holiday(self);
        } else {
          dews.api.
          post(dews.url.getApiUrl("CM", "HolidayInfoService", "Year/" + currentYear), {
            async: false,
            data: {
              type: "all",
              calendar: self.options.holidays.type
            }
          }).
          done(function (data) {
            if (data) {
              self._holidays[currentYear] = data;
              holiday(self);
            }
          }).
          fail(function (xhr, status, error) {
            console.log("error ", xhr, status, error);
          }).
          always(function () {});
        }
      }

      if (self.options.dateStyles && self.options.dateStyles.length > 0 && changeView) {
        self._dateStyle();
      }
    };
  }(kendo.ui.Calendar.fn.navigate);

  // 휴일 적용 함수
  function holiday(calendar) {
    var self = calendar,
      data;
    var currentYYYY = self._current.getFullYear();
    var currentMM = self._current.getMonth() + 1,
      tagText;
    var monthDays = self._table.find(".k-link"),
      dayData,
      dataIdx = 0,
      disableDates = [];
    if (currentYYYY < 10) {
      currentYYYY = "000" + currentYYYY;
    } else if (currentYYYY < 100) {
      currentYYYY = "00" + currentYYYY;
    } else if (currentYYYY < 1000) {
      currentYYYY = "0" + currentYYYY;
    }
    currentMM = currentMM >= 10 ? currentMM.toString() : "0" + currentMM;
    if (self._holidays.repeat) {
      data = self._holidays.repeat.concat(self._holidays[currentYYYY]);
    } else {
      data = self._holidays[currentYYYY];
    }
    // data = holidays;
    if (data) {
      for (dataIdx; dataIdx < data.length; dataIdx++) {
        dayData = data[dataIdx];
        if (currentMM === dayData.date.substr(0, 2)) {
          monthDays.each(function (idx, tag) {
            if (!$(tag).parent().hasClass("k-other-month")) {
              tagText = tag.innerText;
              tagText = tagText >= 10 ? tagText.toString() : "0" + tagText;
              if (tagText === dayData.date.substr(2, 2)) {
                if (self.options.holidays.visible) {
                  $(tag).parent().addClass("dews-holiday");
                }
                if (self.options.holidays.disabled) {
                  // $(tag).parent().css('disabled');
                  $(tag).parent().addClass("k-state-disabled");
                  disableDates.push(new Date("" + currentYYYY + "-" + currentMM + "-" + tagText));
                }
              }
            }
          });
        }
      }
    }
    self.options.disableDates = kendo.calendar.disabled(disableDates);
  }

  kendo.ui.Calendar.fn._dateStyle = function () {
    var self = this;
    var currentMM = self._current.getMonth() + 1,
      tagText;
    var monthDays = self._table.find(".k-link");
    var data = self.options.dateStyles,
      dayData;

    currentMM = currentMM >= 10 ? currentMM.toString() : "0" + currentMM;

    if (data) {
      for (var dateStyleIdx = 0; dateStyleIdx < data.length; dateStyleIdx++) {
        var dateStyleData = data[dateStyleIdx];
        if ($.type(dateStyleData.date) === "array") {
          for (var dataIdx = 0; dataIdx < dateStyleData.date.length; dataIdx++) {
            dayData = dateStyleData.date[dataIdx];

            if ($.type(dayData) === "date") {
              if (self.options.depth === "year") {
                dayData = kendo.toString(
                dayData,
                dews._environments.formats.monthValueFormat,
                kendo.getCulture());

              } else {
                dayData = kendo.toString(
                dayData,
                dews._environments.formats.dateValueFormat,
                kendo.getCulture());

              }
            }

            // if (currentMM === dayData.substr(4, 2)) {
            if (self.options.depth === "year") {
              setMonthPickerStyle(monthDays, dateStyleData, dayData);
            } else {
              setStyle(monthDays, dateStyleData, dayData);
            }

            // }
          }
        } else {
          if ($.type(dateStyleData.date) === "string") {
            dayData = dateStyleData.date;
          } else if ($.type(dateStyleData.date) === "date") {
            if (self.options.depth === "year") {
              dayData = kendo.toString(
              dateStyleData.date,
              dews._environments.formats.monthValueFormat,
              kendo.getCulture());

            } else {
              dayData = kendo.toString(
              dateStyleData.date,
              dews._environments.formats.dateValueFormat,
              kendo.getCulture());

            }
          }
          if (self.options.depth === "year") {
            var array = [];
            array.push(dateStyleData.date);
            dateStyleData.date = array;
            setMonthPickerStyle(monthDays, dateStyleData, dayData);
          } else {
            if (currentMM === dayData.substr(4, 2)) {
              setStyle(monthDays, dateStyleData, dayData);
            }
          }
        }
      }
    }

    function setMonthPickerStyle(monthDays, data, dayData) {
      monthDays.each(function (idx, tag) {
        if (!$(tag).parent().hasClass("k-other-month")) {
          tagText = $(tag).data("value").split("/");
          tagText = kendo.toString(
          new Date(tagText[0], tagText[1], tagText[2]),
          dews._environments.formats.monthValueFormat,
          kendo.getCulture());


          if (tagText === dayData) {
            $(tag).parent().addClass("dews-date-style");

            if (!data.style) {
              $(tag).parent().removeClass("dews-date-style");
            }

            $(tag).parent().attr("style", data.style);
          }
        }
      });
    }

    function setStyle(monthDays, data, dayData) {
      if (monthDays.length === 12 && String(monthDays[0].outerText).length < 4) {
        monthDays.each(function (idx, tag) {
          tagText = $(tag).data("value").split("/");

          if (!$(tag).parent().hasClass("k-other-month")) {
            Loop1: for (var i = 0; i < data.date.length; i++) {
              Loop2: for (var j = 1; j <= 31; j++) {
                var day = String(j);
                if (day.length < 2) {
                  day = "0" + day;
                }
                var dayText = kendo.toString(
                new Date(tagText[0], tagText[1], day),
                dews._environments.formats.dateValueFormat,
                kendo.getCulture());

                if (dayText === data.date[i]) {
                  $(tag).parent().addClass("dews-date-style");

                  if (!data.style) {
                    $(tag).parent().removeClass("dews-date-style");
                  }

                  $(tag).parent().attr("style", data.style);

                  break Loop1;
                }
              }
            }
          }
        });
      } else {
        monthDays.each(function (idx, tag) {
          if (!$(tag).parent().hasClass("k-other-month")) {
            // tagText = tag.innerText;
            // tagText = tagText >= 10 ? tagText.toString() : '0' + tagText;
            tagText = $(tag).data("value").split("/");
            tagText = kendo.toString(
            new Date(tagText[0], tagText[1], tagText[2]),
            dews._environments.formats.dateValueFormat,
            kendo.getCulture());

            if (tagText === dayData) {
              $(tag).parent().addClass("dews-date-style");

              if (!data.style) {
                $(tag).parent().removeClass("dews-date-style");
              }

              $(tag).parent().attr("style", data.style);
            }
          }
        });
      }
    }
  };

  // value 함수 재정의
  kendo.ui.Calendar.fn.value = function (value) {
    return function (val) {
      var self = this;

      if (self.element.data("dewsControl")) {
        if (typeof val === "undefined") {
          return kendo.toString(value.call(self), self.options.valueFormat, kendo.getCulture());
        } else {
          if (typeof val === "string") {
            val = kendo.parseDate(val, self.options.valueFormat, kendo.getCulture());
          }
        }

        value.call(self, val);
      } else {
        return value.call(self, val);
      }
    };
  }(kendo.ui.Calendar.fn.value);

  kendo.ui.Calendar.fn.text = function () {
    var self = this;

    return kendo.toString(self._value, self.options.format, kendo.getCulture());
  };

  kendo.ui.Calendar.fn.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        self.trigger(event);
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  kendo.ui.Calendar.fn.on = function () {
    var self = this,
      $element = self.element;

    if (arguments[0] === "nextFocus" || arguments[0] === "beforeFocus") {
      $element.on.apply($element, arguments);
    } else {
      self.bind.apply(self, arguments);
    }
  };

  kendo.ui.Calendar.fn.off = function () {
    var self = this,
      $element = self.element;

    if (arguments[0] === "nextFocus" || arguments[0] === "beforeFocus") {
      $element.off.apply($element, arguments);
    } else {
      self.unbind.apply(self, arguments);
    }
  };

  dews.ui.addControlInitializer("calendar", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.calendar($(".dews-ui-calendar", $container));
  });
})(jQuery, window.dews || {}, window.kendo);


/**
 * 카드리스트
 * */
(function ($, dews, kendo) {
  var defaultOptions = {
    editable: false,
    navigatable: true,
    selectable: true,
    headerCheck: false,
    selectedIndex: 0,
    autoBind: true,
    template: "",
    sort: [],
    headerTemplate: "<th></th>",
    previous: "",
    keepRow: false,
    totalCount: false,
    title: "",
    cardStyle: "default"
  };

  function getOptions($el, option) {var _opt$filter;
    var opt = {},
      template;

    if ($el.data("dews-cardlist-width")) {
      $el.css("width", $el.data("dews-cardlist-width") + "px");
      defaultOptions._width = parseInt($el.data("dews-cardlist-width"));
    }

    if ($el.data("dews-cardlist-height")) {
      $el.css("height", $el.data("dews-cardlist-height") + "px");
    }

    // if (window.location.hostname === 'prddemo.comet.duzon.net') {
    //     // defaultOptions.useTotalCount = true;
    //     defaultOptions.cardStyle = 'spacing';
    // }

    opt = $.extend(true, opt, defaultOptions, option);

    opt.headerTemplate = "<th></th>";

    // 헤더 체크 박스설정 [ HEADERCHECK ]
    if (opt.headerCheck) {
      // true
      opt.headerTemplate = $(opt.headerTemplate).append(
      $(
      '<span class="dews-checkbox-wrapper">' +
      '<input type="checkbox"  class="dews-ui-checkbox dews-control k-checkbox dews-control-activate">' +
      '   <label class="dews-checkbox-label k-checkbox-label" onclick="kendo.ui.Grid.fn._checkboxClick(this)"></label>' +
      "</span>"));


      opt.headerTemplate = opt.headerTemplate[0].outerHTML;
    }

    if (opt.title) {
      opt.headerTemplate = $(opt.headerTemplate).append($('<span class="title">' + opt.title + "</span>"));
    }

    if ((_opt$filter = opt.filter) !== null && _opt$filter !== void 0 && _opt$filter.useSearchFilter) {
      opt.headerTemplate = $(opt.headerTemplate).prepend(getFilterHTML());
    }

    if (opt.useTotalCount || opt.totalCount) {
      opt.totalCount = $.extend(
      true,
      {},
      {
        format: "#,##0",
        template: "{0}건"
      },
      opt.totalCount);


      opt.headerTemplate = $(opt.headerTemplate).append(
      '<span class="total">' +
      dews.string.format(opt.totalCount.template, '<span class="cnt"></span>') +
      "</span>");

    }

    if (opt.cardStyle === "spacing" || dews._environments.cardStyleTp === "2") {
      $el.addClass("theme-margin");
    }

    // 템플릿에 체크박스가 있을 경우 생성 [ TEMPLATE ]
    if (opt.template.match(/#\s?checkbox\s?#/gi)) {
      opt.template = opt.template.replace(/dews-cardlist-icon/gi, "dews-cardlist-icon checkbox");
      opt.template = opt.template.replace(
      /#\s?checkbox\s?#/gi,
      '<span class="dews-checkbox-wrapper">' +
      '   <input type="checkbox" class="dews-ui-checkbox dews-control k-checkbox dews-control-activate">' +
      '       <label class="dews-checkbox-label k-checkbox-label" onclick="kendo.ui.Grid.fn._checkboxClick(this)"></label>' +
      "</span>");

    }

    // 페이징 사용
    if (opt.dataSource && opt.dataSource.options.paging) {
      opt.scrollable = {
        virtual: true
      };
    }

    template = $('<tr class="k-alt" data-uid="#: uid #">' + "<td>" + opt.template + "</td>" + "</tr>");

    // 카드리스트 정렬 설정 [ SORT ]
    if (opt.sort && opt.sort.length !== 0) {
      var dropdownlist = $('<select class="dews-ui-dropdownlist"></select>');
      opt.sort.forEach(function (idx) {
        var options = $('<option value="' + idx.field + '">' + idx.title + "</option>");
        dropdownlist.append(options);
      });

      opt.headerTemplate = $(opt.headerTemplate).append(dropdownlist)[0].outerHTML;
    }

    // 카드리스트 css 설정 [ CSS ]
    if (opt.css) {
      var styles = $("<style></style>");
      opt.css.match(/([^{]+){[^}]+}/gi).forEach(function (style) {
        var target = "";
        if (opt.$content && opt.$content.attr("id")) {
          target += "#" + opt.$content.attr("id");
        }
        if ($el.attr("id")) {
          target += " #" + $el.attr("id");
        }

        styles[0].innerText += target + " " + style.trim();
      });
      opt.styles = styles;
    }

    // 데이터소스 aggregate 있는데 footerTemplate이 없는 경우 aggregate 삭제
    if (opt.dataSource && opt.dataSource._aggregate && !opt.footerTemplate) {
      delete opt.dataSource._aggregate;
    }

    // 카드리스트 footerTemplate 설정
    if (opt.footerTemplate) {
      opt.columns = [];
      opt.footerTemplate.match(/#:\s?[A-z]+\s?\([^)]+\s?\)\s?#/gi).forEach(function (idx, value) {
        var field = idx.replace(/#:\s?[A-z]+\s?\(/gi, "").replace(/\)\s?#/gi, ""),
          cal = idx.replace(/\([A-z]+\s?\)\s?/gi, "");
        opt.columns.push({
          field: field,
          footerTemplate: cal.toLowerCase()
        });
      });
    }

    opt.rowTemplate = template[0].outerHTML;

    return opt;
  }

  // 카드리스트 객체 생성
  function CardList($el, options) {
    var self = this,
      opt,
      card;

    if (options.hasOwnProperty("change")) {
      self.change = options.change;
      delete options.change;
    }

    if (options.hasOwnProperty("dataBound")) {
      self.dataBound = options.dataBound;
      delete options.dataBound;
    }

    opt = getOptions($el, options);

    $el.kendoGrid(opt);
    card = $el.data("kendoGrid");

    self.$element = $el;
    self.options = opt;
    self._card = card;

    self.options.change = function () {
      var uid = this.element.find("tr.k-state-selected").data("uid");
      var selected = this.element.find('tr[data-uid="' + uid + '"]');
      var previous = this.element.find('tr[data-uid="' + opt.previous + '"]');
      var changeParams = {
        cardlist: self,
        row: {
          index: selected.index(),
          data: this.dataItem(selected),
          previous: {
            index: previous.index(),
            data: this.dataItem(previous)
          }
        }
      };

      if (self.options.dataSource && self.options.dataSource.options.paging && self._card.options._lastSelected) {
        changeParams.row.index = self.options.dataSource._currentRangeStart + selected.index();
        changeParams.row.previous.index = self._card.options._lastSelected.index;
        changeParams.row.previous.data = self.options.dataSource.getByUid(self._card.options._lastSelected.uid);
      }

      var event = $.Event("change", changeParams);
      if (uid !== opt.previous) {
        self.options.selectedIndex = selected.index();
        opt.previous = uid;
        self._card.element.trigger(event);
      } else if (this.items().length === 0) {
        self._card.element.trigger(event);
      }

      if (self.options.dataSource && self.options.dataSource.options.paging) {
        var currentRangeStart = self.options.dataSource._currentRangeStart || 0;

        self._card.options._lastSelected = {};
        self._card.options._lastSelected.uid = uid;
        self._card.options._lastSelected.index = currentRangeStart + selected.index();
      }
      if (self.options.template.indexOf('progress-bar') !== -1) {
        self._adjustProgressBarWidth();
      }
    };

    self.options.dataBound = function (e) {
      if (this.options.totalCount) {
        var cnt = this.options.dataSource.options.paging ?
        this.options.dataSource.options.totalCount :
        e.sender.dataSource.data().length;

        $(".total .cnt", this.element).text(dews.number.format(cnt, this.options.totalCount.format));
        $(".total", this.element).css("display", "inline");
      }

      if (
      this.tbody.find('tr[data-uid="' + this.options.uid + '"]').length === 0 &&
      this.dataSource._destroyed.length === 0)
      {
        var boundParams = {
            cardlist: self,
            row: {
              data: this.items()
            }
          },
          event;

        if (self.options.dataSource && self.options.dataSource.options.paging) {
          var pagingStart;
          if (self.options.dataSource.options.pagingType === "background") {
            pagingStart =
            self.options.dataSource.options.pagingStart - self.options.dataSource.options.pagingCount;
          } else {
            pagingStart = self.options.dataSource.transport.options.pagingStart;
          }

          boundParams.paging = true;
          boundParams.page = {};
          boundParams.page.startIndex = pagingStart;

          if (self.options.dataSource._pristineData && self.options.dataSource._data.length > 0) {
            boundParams.page.endIndex = pagingStart + self.options.dataSource.options.pagingCount - 1;
          } else {
            boundParams.page.endIndex = pagingStart - 1;
          }

          if (self.options.dataSource.options.totalCount < boundParams.page.endIndex) {
            boundParams.page.endIndex = self.options.dataSource.options.totalCount - 1;
          }

          boundParams.page.totalCount = self.options.dataSource.options.totalCount;
        }

        event = $.Event("dataBound", boundParams);
        self._card.element.trigger(event);
        if (this.options.keepRow) {
          this.select(this.tbody.find("tr:eq(" + this.options.selectedIndex + ")"));
        } else {
          if (!this.options._virtualScroll) {
            this.select(this.tbody.find("tr:first-child"));
          }
        }
      }

      if (this.items().length === 0) {
        self._card.trigger("change");
      }

      if (self.focused && self.options.$content.is(":visible")) {
        if (!self._card.options._virtualScroll) {
          self.setFocus();
        }
      }
    };

    self._card.bind("change", self.options.change);
    self._card.bind("dataBound", self.options.dataBound);

    self._bindEvent();

    return self;
  }

  CardList.prototype._initControl = function () {var _opt$filter2, _dropDownList;
    var self = this,
      opt = self.options;

    // 그리드 내 컬럼을 비워줌
    self._card.element.find(".k-grid-header-wrap table tr").empty();
    self._card.element.find(".k-grid-header-wrap table colgroup").empty();
    self._card.element.find(".k-grid-content table colgroup").empty();
    self._card.element.find(".k-grid-header-wrap table tr").append($(opt.headerTemplate));

    if ((_opt$filter2 = opt.filter) !== null && _opt$filter2 !== void 0 && _opt$filter2.useSearchFilter) {
      self._initFilter();
    }

    var dropDownList;
    if (self._card.element.find(".k-grid-header-wrap table tr th .dews-ui-dropdownlist")) {
      dropDownList = dews.ui.dropdownlist(
      self._card.element.find(".k-grid-header-wrap table tr th .dews-ui-dropdownlist"));

    }

    self._card.bind("dataBound", function () {
      setRightStyle(self._card);
    });

    // 스타일 붙이기
    if ($.type(opt.styles) !== "undefined") {
      self.$element.append(self.options.styles);
    }

    // 컬럼 헤더 부분 드롭다운리스트 변경시 이벤트
    (_dropDownList = dropDownList) === null || _dropDownList === void 0 ? void 0 : _dropDownList.on("change", function (e) {
      var sortBy = e.sender.value();
      self._card.options.sortable = true;
      self._card.dataSource.sort({ field: sortBy, dir: "asc" });
      self._card.options.sortable = false;
      self.$element.trigger('sort');
    });

    $(self._card.element).on("dblclick", $(".k-grid-header-wrap table tr"), function (e) {
      var params = {
        cardlist: self,
        row: {
          index: $(e.target).closest(".k-alt").index(),
          data: self._card.dataItem($(e.target).closest(".k-alt"))
        }
      };

      if (self._card.dataSource && self._card.dataSource.options.paging) {
        params.row.index = self._card.options._lastSelected.index;
      }

      var event = $.Event("dblClicked", params);
      self._card.element.trigger(event);
    });
  };

  CardList.prototype._bindEvent = function () {
    var self = this;

    $(self._card.element).on("change", function (e) {
      if (self.change && $.type(self.change) === "function" && e.cardlist) {
        self.change.call(self, e);
      }

      if ($.type(e.cardlist) === "undefined") {
        e.stopImmediatePropagation();
      }
    });

    $(self._card.element).on("dataBound", function (e) {
      if (self.dataBound && $.type(self.dataBound) === "function" && e.cardlist) {
        self.dataBound.call(self, e);
      }

      if ($.type(e.cardlist) === "undefined") {
        e.stopImmediatePropagation();
      }
    });

    $(self._card.element).on("rowAdd", function (e) {
      if (self.options.rowAdd && $.type(self.options.rowAdd) === "function") {
        self.options.rowAdd.call(self, e);
      }
    });

    $(self._card.element).on("rowRemove", function (e) {
      if (self.options.rowRemove && $.type(self.options.rowRemove) === "function") {
        self.options.rowRemove.call(self, e);
      }
    });

    $(self._card.element).on("dblClicked", function (e) {
      if (self.options.dblClicked && $.type(self.options.dblClicked) === "function") {
        self.options.dblClicked.call(self, e);
      }
    });

    $(self._card.element).on("sort", self._adjustProgressBarWidth);
  };

  function getFilterHTML() {
    return '<div class="filter-wrapper">' +
    '<input type="text" class="dews-ui-textbox filter-input">' +
    '<button class="dews-ui-button filter-button"><span></span></button>' +
    '</div>';
  }

  CardList.prototype._initFilter = function () {var _this$options$filter$, _this$options$filter;
    var input = dews.ui.textbox($('.filter-input', this.$element));
    var button = dews.ui.button($('.filter-button', this.$element));

    input.element.attr("placeholder", (_this$options$filter$ = (_this$options$filter = this.options.filter) === null || _this$options$filter === void 0 ? void 0 : _this$options$filter.placeholder) !== null && _this$options$filter$ !== void 0 ? _this$options$filter$ : "결과 내 검색");

    this._addFilterEventListeners(input, button);
  };

  CardList.prototype._addFilterEventListeners = function (input, button) {var _this15 = this;
    // setOptions 로 필터를 다시 만들 경우
    // input 포커스가 안 되는 현상 때문에 이벤트 등록하였음
    var focusEventFired = false;
    input.on("click", function () {
      if (!focusEventFired) {
        input.focus();
      }
    });

    input.on("focus", function () {
      focusEventFired = true;
    });

    input.on("keyup", function (e) {
      if (e.key === "Enter") {
        button.raiseEvent("click");
      }
    });

    button.on("click", function () {
      _this15._onFilterButtonClick(input.text());
    });
  };

  CardList.prototype._onFilterButtonClick = function (keyword) {
    this.options.dataSource.filter({
      logic: "or",
      filters: this._getFilters(keyword)
    });
  };

  CardList.prototype._getFilters = function (keyword) {var _this$options$filter2;
    var searchColumnSet = (_this$options$filter2 = this.options.filter) === null || _this$options$filter2 === void 0 ? void 0 : _this$options$filter2.searchColumnSet;
    var result = [];

    if (Array.isArray(searchColumnSet)) {
      searchColumnSet.forEach(function (field) {
        addFilter(field);
      });
    } else if (searchColumnSet) {
      addFilter(searchColumnSet);
    } else {
      this._getFields().forEach(function (field) {
        addFilter(field);
      });
    }

    return result;

    function addFilter(field) {
      result.push({
        operator: "contains",
        value: keyword,
        field: field
      });
    }
  };

  CardList.prototype._getFields = function () {
    var data = this.options.dataSource.data();
    var result = new Set();

    Array.from(data).forEach(function (field) {
      for (var _i = 0, _Object$entries = Object.entries(field); _i < _Object$entries.length; _i++) {var _Object$entries$_i = _slicedToArray(_Object$entries[_i], 2),key = _Object$entries$_i[0],value = _Object$entries$_i[1];
        if (typeof value === "string") {
          result.add(key);
        }
      }
    });

    return result;
  };

  CardList.prototype._adjustProgressBarWidth = function () {
    $("tr.k-alt", this.$element).each(function (i, card) {
      // 계산된 퍼센트 값 (span.progress-txt에는 실제 계산된 퍼센트 값이 들어가 있어야 함)
      var progress = $(card).find(".progress-txt").text();

      // 해당 값을 .progressbar의 width 값으로 적용
      $(card).find(".progressbar").css("width", progress + "%");
    });
  };

  /**
   * 변경 사항이 원래대로 돌아왔을 경우 dirty 삭제
   * @private
   * @param idx 데이터아이템 인덱스
   * @param field 변경된 필드
   * @param newVal 변경된 값
   */
  CardList.prototype._originalDirtyState = function (idx, field, newVal) {
    var self = this;

    var cell = self._card.tbody.find("tr:eq(" + idx + ")").children("td");
    var model = self._card._modelForContainer(cell);
    var oldModel = self._card.dataSource._pristineForModel(model);
    var oldVal;
    if (oldModel) {
      oldVal = oldModel[field];
    }
    if (oldVal === newVal) {
      delete model.dirtyFields[field];
      if (Object.keys(model.dirtyFields).length === 0) {
        model.dirty = false;
      }
    }
  };

  dews = $.extend(true, dews, {
    ui: {
      cardlist: function cardlist(selector, options) {
        var $el, cardlist, $content;

        if (dews.ui.dialogPage) {
          $content = dews.ui.dialogPage.$content;
        } else if (dews.ui.page) {
          $content = dews.ui.page.$content;
        } else {
          $content = $(document);
        }

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector, $content);
        }

        if ($.type(selector) === "undefined") {
          return;
        }

        $el.each(function () {
          var $this = $(this),
            card;

          card = $this.data("dews-control");

          if (!card) {
            if ($.type(options) === "undefined") {
              options = {};
            }
            options.$content = $content;

            card = new CardList($this, options);
            $this.data("dews-control", card);
            card._initControl();

            if (!$this.hasClass("dews-ui-cardlist")) {
              $this.addClass("dews-ui-cardlist");
            }

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            if (!$this.hasClass("dews-data-control")) {
              $this.addClass("dews-data-control");
            }
          }
          cardlist = card;
        });

        return cardlist;
      }
    }
  });
  /**
   * 카드리스트 행 추가
   */
  CardList.prototype.addRow = function () {
    var self = this;

    self._card.addRow(self);
  };
  // 카드리스트 행 추가 관련 kendo addRow 수정
  kendo.ui.Grid.fn.addRow = function (cardlist) {
    var that = this,
      index,
      dataSource = that.dataSource,
      mode = that._editMode(),
      createAt = that.options.editable.createAt || "bottom",
      pageSize = dataSource.pageSize(),
      view = dataSource.view() || [];

    if (that.editable && that.editable.end() || !that.editable) {
      if (mode === "incell") {
        that.cancelRow();
      }

      that.options.addRow = true;

      index = dataSource.indexOf(view[0]);

      if (createAt.toLowerCase() === "bottom") {
        index += view.length;

        if (pageSize && !dataSource.options.serverPaging && pageSize <= view.length) {
          index -= 1;
        }

        if (dataSource.options.paging) {
          index = dataSource.data().length;
        }
      }

      if (index < 0) {
        if (dataSource.page() > dataSource.totalPages()) {
          index = (dataSource.page() - 1) * pageSize;
        } else {
          index = 0;
        }
      }

      var model = dataSource.insert(index, {}),
        id = model.uid,
        table = that.lockedContent ? that.lockedTable : that.table,
        row = table.find("tr[" + kendo.attr("uid") + "=" + id + "]"),
        cell = row.children("td:not(.k-group-cell,.k-hierarchy-cell)").eq(that._firstEditableColumnIndex(row));

      if (mode === "inline" && row.length) {
        that.editRow(row);
      } else if (mode === "popup") {
        that.editRow(model);
      }

      if (createAt.toLowerCase() === "bottom" && that.lockedContent) {
        //scroll the containers to the bottom
        that.lockedContent[0].scrollTop = that.content[0].scrollTop = that.content[0].offsetHeight;
      }

      if (that.options.dataSource.sort() && !that.options.dataSource.options.paging) {
        if (row.length > 0) {
          index = row.index();
        }
      }

      var addParams = {
          cardlist: cardlist,
          row: {
            index: index,
            data: that.dataItem(row)
          }
        },
        rowAddEvent;

      if (that.options.dataSource && that.options.dataSource.options.paging) {
        addParams.row.data = dataSource.getByUid(id);
      }

      rowAddEvent = $.Event("rowAdd", addParams);
      that.element.trigger(rowAddEvent);

      if (createAt.toLowerCase() === "bottom") {
        if (
        that.options.dataSource.options.paging &&
        that.content.height() + that._rowHeight <
        that.content.find(".k-virtual-scrollable-wrap table").height())
        {
          if (that.options.dataSource.options.pagingType === "background") {
            that._virtualPageToBottom(function () {
              that.virtualScrollable.scrollToBottom();
            });
          }

          row = table.find("tr[" + kendo.attr("uid") + "=" + id + "]");
          that.select(that.tbody.find('tr[data-uid="' + row.data("uid") + '"]'));
        } else {
          var position = $("tr:last", this.element.context).offset().top;
          $("div.k-grid-content", this.element.context).scrollTop(
          $("div.k-grid-content", this.element.context).scrollTop() + position);

        }
      } else {
        $("div.k-grid-content", this.element.context).scrollTop(0);
      }

      that.element.find("td.k-state-focused").removeClass("k-state-focused");
      that.select(that.tbody.find('tr[data-uid="' + row.data("uid") + '"]'));
    }
  };
  /**
   * 카드리스트 행 삭제
   * @param row (number || array) 삭제할 행의 index
   */
  CardList.prototype.removeRow = function (row) {
    var self = this,
      selected = self.select();

    var removeParams = {
        cardlist: self,
        row: {
          index: row,
          data: self.dataItems(row)
        }
      },
      rowRemoveEvent = $.Event("rowRemove", removeParams);
    var _currentRangeStart, dataItem, indexof;

    self._card.element.trigger(rowRemoveEvent);

    if (self._card.dataSource) {
      if ($.type(row) === "array") {
        for (var i = row.length - 1; i >= 0; i -= 1) {
          if ($.type(row[i]) === "number" && row[i] > -1) {
            if (self.options.dataSource.options.paging) {
              _currentRangeStart = self.options.dataSource._currentRangeStart;
            }

            if (dataItem) {
              self._card.dataSource.remove(dataItem);
            } else {
              self._card.dataSource.remove(self.dataItem(row[i]));
            }

            if (self.options.dataSource.options.paging) {
              self.options.dataSource._currentRangeStart = _currentRangeStart;
            }
          }
        }
      } else if ($.type(row) === "number" && row > -1) {
        if (self.options.dataSource.options.paging) {
          _currentRangeStart = self.options.dataSource._currentRangeStart;

          indexof = self.options.dataSource.indexOf(self.dataItem(row));
          self.options.dataSource._currentRangeStart = indexof;
        }

        if (dataItem) {
          self._card.dataSource.remove(dataItem);
        } else {
          self._card.dataSource.remove(self.dataItem(row));
        }

        if (self.options.dataSource.options.paging) {
          self.options.dataSource._currentRangeStart = _currentRangeStart;
        }
      }
    }
    setRightStyle(self._card);
    // 카드리스트 현재 선택된 행이 삭제 됬을 경우 행 자동 선택
    if (selected === row && self._card.dataSource.data().length !== 0) {
      if (self._card.dataSource.data().length === row) {
        self.select(row - 1);
      } else {
        self.select(row);
      }
      self._card.element.find("td.k-state-focused").removeClass("k-state-focused");
    } else {
      self._card.trigger("change");
    }
  };
  /**
   * 카드리스트 엑셀 다운로드
   * @param options
   */
  CardList.prototype.saveAsExcel = function (options) {
    var self = this,
      jsUrl,
      excelOptions;

    excelOptions = {
      allPages: true,
      fileName: "Download.xlsx"
    };

    // 엑셀관련 설정을 한다.
    self._card.options.excel = $.extend(true, self._card.options.excel || {}, excelOptions, options);

    if ($.type(window.JSZip) === "function") {
      self._card.saveAsExcel.call(self._card);
    } else {
      jsUrl = dews.url.join(dews._environments.scriptBase || "/scripts/", "/kendo/jszip.min.js");
      dews.ajax.script(jsUrl).done(function () {
        self._card.saveAsExcel.call(self._card);
      });
    }
  };

  CardList.prototype.importExcel = function (option) {
    var self = this,
      opt = {
        sheetName: undefined // 시트명 설정
      };
    var $inputFileElement = self.$element.find("> .dews-cardlist-excel-import-file"),
      fileList,
      $dfd = $.Deferred();

    opt = $.extend(true, opt, option);

    // if (opt.fileDialog) {
    if ($inputFileElement.length === 0) {
      $inputFileElement = $('<input type="file" class="dews-cardlist-excel-import-file" style="display: none">');
      self.$element.append($inputFileElement);
    }

    $inputFileElement.change(function (e) {
      fileList = e.target.files;
      opt.file = fileList;
      readExcel(self, opt).
      done(function () {
        $dfd.resolve();
      }).
      fail(function () {
        $dfd.reject();
      });
      $inputFileElement.remove();
    });

    $inputFileElement.trigger("click");

    return $dfd;
    // }

    function readExcel(self, opt) {
      var deferred = $.Deferred();
      loadExcelLibrary().done(function () {
        var input = opt;
        var reader = new FileReader();
        reader.onload = function () {
          var data = reader.result;
          var workBook = XLSX.read(data, { type: "binary" });
          workBook.SheetNames.forEach(function (sheetName) {
            // consolew.log('SheetName: ' + sheetName);
            var rows = XLSX.utils.sheet_to_json(workBook.Sheets[sheetName]);
            // console.log(JSON.stringify(rows));
            self._card.dataSource.data(rows);

            if (self.options.totalCount) {
              var cnt = self._card.dataSource.data().length;

              $(".total .cnt", this.element).text(
              dews.number.format(cnt, self.options.totalCount.format));

              $(".total", this.element).css("display", "inline");
            }
            deferred.resolve();
          });
        };

        reader.onerror = function () {
          deferred.reject(new Error("파일을 읽을 수 없습니다."));
        };
        reader.readAsBinaryString(input.file[0]);
      });

      return deferred;
    }
  };

  function loadExcelLibrary() {
    return dews.ajax.script(dews._environments.scriptBase + "xlsx.js", {
      once: true
    });
  }

  CardList.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change", "dataBound", "rowAdd", "rowRemove", "dblClicked"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "change" || event === "dataBound") {
          var evt = $.Event(event, {
            cardlist: self
          });
          $(self._card.element).trigger(evt);
        } else {
          $(self._card.element).trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  /**
   * 카드리스트 이벤트 추가
   */
  CardList.prototype.on = function () {
    var self = this;

    $(self._card.element).on.apply($(self._card.element), arguments);
  };
  /**
   * 카드리스트 이벤트 제거
   */
  CardList.prototype.off = function () {
    var self = this;

    $(self._card.element).off.apply($(self._card.element), arguments);
  };
  /**
   * 카드리스트 지정한 행 데이터 호출
   * @param row (number) 호출할 데이터의 행 index
   * @returns {object} 호출한 행의 데이터
   */
  CardList.prototype.dataItem = function (row) {
    var self = this;

    if (self._card.dataSource && row > -1) {
      if (self.options.dataSource.options.paging) {
        return self._card.dataSource.at(row);
      } else {
        return self._card.dataItem(self._card.element.find("tbody tr:eq(" + row + ")"));
      }
    }
  };
  /**
   * 카드리스트 지정한 행 데이터 혹은 전체 데이터 호출
   * @param row (number || array) 호출할 데이터의 행 index
   * @returns {Array} 호출한 행의 데이터 혹은 카드리스트 전체 데이터
   */
  CardList.prototype.dataItems = function (row) {
    var self = this,
      data = [];

    if (self._card.dataSource) {
      if ($.type(row) === "array") {
        for (var i = 0; i < row.length; i += 1) {
          if ($.type(row[i]) === "number" && row[i] > -1) {
            if (self._card.dataSource.options.paging) {
              data.push(self._card.dataSource.at(row[i]));
            } else {
              data.push(self._card.dataItem(self._card.element.find("tbody tr:eq(" + row[i] + ")")));
            }
          }
        }
      } else if ($.type(row) === "number" && row > -1) {
        if (self._card.dataSource.options.paging) {
          return self._card.dataSource.at(row);
        } else {
          data = self._card.dataItem(self._card.element.find("tbody tr:eq(" + row + ")"));
        }
      } else if ($.type(row) === "undefined") {
        data = self._card.dataSource.data();
      }
    }
    return data;
  };

  /**
   * 카드리스트에서 index에 해당하는 행을 반환합니다.
   * @param index 행의 인덱스
   * @return {JQuery}
   */
  CardList.prototype.getRow = function (index) {
    return this._card.items().eq(index);
  };

  /**
   * 카드리스트의 모든 행을 반환합니다.
   * @return {JQuery}
   */
  CardList.prototype.getRows = function () {
    return this._card.items();
  };

  /**
   * 카드리스트 행 지정 및 반환
   * @param row (number) 카드리스트의 포커스 할 행 index 설정
   * @returns {number} 카드리스트의 현재 선택 된 행의 index
   */
  CardList.prototype.select = function (row) {
    var self = this;

    if (self._card.dataSource) {
      if (typeof row === "number" && row > -1) {
        if (self.options.dataSource.options.paging) {
          var page = row / self.options.dataSource._pageSize;

          if (row <= self.options.dataSource.total()) {
            if (self.options.dataSource._pageSize > row) {
              self._card.wrapper.find(".k-scrollbar").scrollTop(self._card._rowHeight * row - 1);
            } else if (self.options.dataSource._pageSize > self.options.dataSource.total() - row) {
              self._card._virtualPageToBottom(function () {
                self._card.wrapper.find(".k-scrollbar").scrollTop(row * self._card._rowHeight);
              });
            } else {
              self._card.wrapper.
              find(".k-scrollbar").
              scrollTop(self._card._rowHeight * (self.options.dataSource.pageSize() * page - 1));
            }

            setTimeout(function () {
              var index = row - self.options.dataSource._currentRangeStart;

              self._card.current(self._card.element.find(".k-grid-content tr:eq(" + index + ") > td"));
              self._card.select(self._card.element.find(".k-grid-content tr:eq(" + index + ")"));
              self._card.element.find(".k-grid-content tr:eq(" + index + ") > td").trigger("mousedown");
            }, 10);
          }
        } else {
          self._card.current(self._card.element.find(".k-grid-content tr:eq(" + row + ") > td"));
          self._card.select(self._card.element.find(".k-grid-content tr:eq(" + row + ")"));
          self._card.element.find(".k-grid-content tr:eq(" + row + ") > td").trigger("mousedown");
        }
      } else if (typeof row === "undefined") {
        if (self.options.dataSource.options.paging && self._card.options._lastSelected) {
          var currentRangeStart = self.options.dataSource._currentRangeStart || 0;
          return self._card.select().index() + currentRangeStart;
        } else if (self._card.element.find(".k-grid-content tr.k-state-selected").length !== 0) {
          return self._card.select().index();
        }
      }
    }
  };
  /**
   * 카드리스트의 데이터소스 설정
   * @param dataSource (dataSource) 카드리스트 데이터소스 설정
   */
  CardList.prototype.setDataSource = function (dataSource) {
    this.options.dataSource = dataSource;
    this._card.setDataSource(dataSource);
  };
  /**
   * 카드리스트 옵션 설정
   * @param option (object)
   */
  CardList.prototype.setOptions = function (option) {
    var self = this,
      options;

    if (option && option.sort) {
      self.options.sort = [];
    }
    options = $.extend(true, {}, self.options, option);
    self.options = getOptions(self.$element, options);
    self._card.setOptions(self.options);
    self._initControl();
  };
  /**
   * 카드리스트 바인딩
   * @param panel (object) 바인딩할 폼패널 객체
   */
  CardList.prototype.bindPanel = function (panel) {
    var self = this,
      data = self.dataItem(self.select()),
      formpanel = panel;

    if (self._card.dataSource && self._card.dataSource.options.paging && self._card.options.sort) {
      data = self.selectedDataItem();
    }
    if ($.type(panel) === "object" && panel.length) {
      if (panel.hasClass("dews-ui-form-panel")) {
        formpanel = dews.ui.formpanel(panel);
      } else if (panel.hasClass("dews-ui-condition-panel")) {
        formpanel = dews.ui.conditionpanel(panel);
      }
    }

    if (data) {
      formpanel.bindData(data.toJSON());
    }
  };
  /**
   * 카드리스트 패널간 바인딩
   * @param data (object) 카드리스트에 설정할 데이터
   */
  CardList.prototype.updateRowFromPanel = function (data) {
    var self = this,
      idx = self.select(),
      dataItem,
      checkIdx;
    if (idx > -1) {
      dataItem = self._card.dataSource.options.paging ? self.selectedDataItem() : self.dataItem(idx);
      checkIdx = self._card.dataSource.options.paging ? [] : self.getCheckedIndex();
      for (var i = 0; i < Object.keys(data).length; i++) {
        var field = Object.keys(data)[i];
        var value = data[field];

        if ($.type(dataItem.get(field)) !== "undefined" && dataItem.get(field) !== value) {
          dataItem.set(field, value);
          // 데이터 변경 후에 체크 박스 상태 유지
          if (checkIdx.length > 0) {
            self.setCheck(checkIdx, true);
          }
          this._originalDirtyState(idx, field, value);
        }
      }
    }
  };
  /**
   * 카드리스트에서 체크된 항목의 데이터 가져오기
   * @returns {Array} 체크된 항목의 데이터
   */
  CardList.prototype.getCheckedRow = function () {
    var self = this,
      data = [];

    self._card.tbody.find(".k-checkbox:checked").each(function (idx, value) {
      data.push(self.dataItem($(value).closest("tr").index()));
    });

    return data;
  };
  /**
   * 카드리스트에서 체크된 항목의 행 index 가져오기
   * @returns {Array} 체크된 항목의 index
   */
  CardList.prototype.getCheckedIndex = function () {
    var self = this,
      index = [];

    self._card.tbody.find(".k-checkbox:checked").each(function (idx, value) {
      index.push($(value).closest("tr").index());
    });

    return index;
  };

  /**
   * 정렬 된 카드리스트에서 데이터를 가져옵니다.
   * @param indexArr {array} 가져올 데이터의 인덱스
   * @return {Array} 정렬 된 데이터
   */
  CardList.prototype.sortDataItems = function (indexArr) {
    var self = this,
      data,
      returnData = [];

    data = Array.prototype.slice.call(self.options.dataSource.view(), 0);

    if (indexArr) {
      if ($.type(indexArr) === "array") {
        for (var i = 0; i < indexArr.length; i++) {
          returnData.push(data[i]);
        }
      }
    } else {
      returnData = data;
    }

    return returnData;
  };

  // 카드리스트 체크박스 체크 이벤트
  kendo.ui.Grid.fn._checkboxClick = function (target) {
    var $label = $(target),
      $checkbox = $label.parent(".dews-checkbox-wrapper").find('input[type="checkbox"]'),
      cardlist = $checkbox.closest(".dews-ui-cardlist"),
      header = cardlist.find(".k-grid-header"),
      content = cardlist.find(".k-grid-content");

    if ($checkbox.length > 0) {
      $checkbox.click();
      // 헤더 체크박스가 존재하는지 확인
      if ($checkbox.closest(".k-grid-header").length !== 0) {
        if ($checkbox.filter(":checked").length !== 0) {
          content.find(".k-checkbox").prop("checked", true);
        } else {
          content.find(".k-checkbox").prop("checked", false);
        }
      }
      // 카드리스트 헤더 체크박스 자동 설정
      if (header.find(".k-checkbox").length !== 0 && content.find(".k-checkbox").length !== 0) {
        if (content.find(".k-checkbox").filter(":checked").length === content.find(".k-checkbox").length) {
          header.find(".k-checkbox").prop("checked", true);
        } else {
          header.find(".k-checkbox").prop("checked", false);
        }
      }
    }
  };
  /**
   * 카드리스트의 특정 컬럼 값 설정
   * @param index (number) 행 index
   * @param field (string) 설정할 field
   * @param value (string) 설정할 값
   */
  CardList.prototype.setValue = function (index, field, value) {
    var self = this,
      dataItem,
      idx;
    if (self._card.dataSource) {
      dataItem = self.dataItem(index);
      idx = self._card.dataSource.options.paging ? [] : self.getCheckedIndex();

      dataItem.set(field, value);

      // 데이터 변경 후에 체크 박스 상태 유지
      if (idx.length > 0) {
        self.setCheck(idx, true);
      }

      this._originalDirtyState(index, field, value);
    }
  };

  CardList.prototype._checkItem = function (row, value) {
    var self = this;

    var tr = self._card.tbody.find("tr:eq(" + row + ")");
    var $checkbox = tr.find('input[type="checkbox"]');
    if ($checkbox.filter(":checked").length !== 0) {
      // 체크 상태
      if (!value) {
        $checkbox.trigger("click"); // 체크 해제
      }
    } else {
      // 체크 안된 상태
      if (value) {
        $checkbox.trigger("click"); // 체크 설정
      }
    }
  };

  /**
   * 지정한 행의 체크바 컬럼에 체크, 체크해제를 설정합니다.
   * @param row {number | array} 체크바 컬럼에 체크, 체크해제를 설정할 행의 index 값 또는 index 배열의 값
   * @param value {boolean} 체크바 컬럼에 설정할 체크, 체크해제 값
   */
  CardList.prototype.setCheck = function (row, value) {
    var self = this;

    if (typeof row === "number") {
      self._checkItem(row, value);
    } else {
      if (row) {
        row.forEach(function (idx) {
          self._checkItem(idx, value);
        });
      }
    }
  };

  /**
   * 카드리스트의 특정 컬럼 값 호출
   * @param index (number) 행 index
   * @param field (string) 값을 가져올 field
   */
  CardList.prototype.getValue = function (index, field) {
    var self = this,
      dataItem;
    if (self._card.dataSource) {
      dataItem = self.dataItem(index);

      return dataItem.get(field);
    }
  };

  /**
   * 카드리스트 행 상태값 변경
   * @param index (number) 행 index
   * @param state (string) 변경할 상태값
   */
  CardList.prototype.setRowState = function (index, state) {
    var self = this,
      dataItem;
    if (self._card.dataSource && index > -1) {
      dataItem = self.dataItem(index);
      if (dataItem) {
        switch (state) {
          case "added":
            dataItem.id = dataItem._defaultId;
            break;
          case "updated":
            dataItem.dirty = true;
            break;
          default:
            dataItem.dirty = false;
            dataItem.id = dataItem.get(dataItem.idField);}

      }
    }
  };

  /**
   * 카드리스트의 현재 상태 반환
   * @param index (number) 행 index
   * @returns {*} (string) 현재 상태값
   */
  CardList.prototype.getRowState = function (index) {
    var self = this,
      dataItem;
    if (self._card.dataSource && index > -1) {
      dataItem = self.dataItem(index);
      if (dataItem.isNew && dataItem.isNew()) {
        return "added";
      } else if (dataItem.dirty) {
        return "updated";
      } else {
        return "none";
      }
    }
  };

  /**
   * 카드리스트 모든 행 상태값 제거
   */
  CardList.prototype.clearRowStates = function () {
    var self = this,
      dataItems = self.dataItems();

    if (dataItems) {
      dataItems.forEach(function (value, idx) {
        if (self.getRowState(idx) !== "none") {
          self.setRowState(idx, "none");
        }
      });
    }
  };

  /**
   * 카드리스트 마스터 디테일 구조 설정
   * @param target (object) 디테일 객
   */
  CardList.prototype.setDetail = function (target) {
    var self = this,
      master = self,
      detail = target,
      masterDataSource = master.options.dataSource,
      detailDataSource = detail.options.dataSource;

    detailDataSource.options.detail = true;
    detailDataSource.options.lineDataSources = {};
    detailDataSource.options.masterDataSource = masterDataSource;
    masterDataSource.options.master = {};
    masterDataSource.options.detailDataSource = detailDataSource;

    self.on("change", function (e) {
      var currentHDataItem, uid;

      if (self.options.dataSource && self.options.dataSource.options.paging) {
        currentHDataItem = master.selectedDataItem();
      } else {
        currentHDataItem = master.dataItem(master.select());
      }
      if ($.type(currentHDataItem) === "object") {
        uid = currentHDataItem._uid;
      }

      if (masterDataSource.options._dataChange) {
        detailDataSource._detailDataChange();
      }
      if ($.type(uid) !== "undefined" && $.type(detailDataSource.options.lineDataSources[uid]) === "undefined") {
        if (detailDataSource.options.tree) {
          detailDataSource.options.lineDataSources[uid] = dews.ui.treeDataSource(
          "__ds_" + uid,
          detailDataSource.options);

        } else {
          detailDataSource.options.lineDataSources[uid] = dews.ui.dataSource(
          "__ds_" + uid,
          detailDataSource.options);

        }
        detailDataSource.options.lineDataSources[uid].options.master = {};
        detailDataSource.options.id = detailDataSource.id;
        detail.setDataSource(detailDataSource.options.lineDataSources[uid]);
        detailDataSource.options.lineDataSources[uid].read();

        if (masterDataSource.options._dataChange) {
          detailDataSource.options.lineDataSources[uid].options.parentDataSource = detailDataSource;
          detailDataSource.options.lineDataSources[uid]._detailDataChange();
        }
      } else {
        if (self.dataItems().length === 0) {
          detail.setDataSource(detailDataSource);
          detailDataSource.read();
        } else if ($.type(detailDataSource.options.lineDataSources[uid]) !== "undefined") {
          detail.setDataSource(detailDataSource.options.lineDataSources[uid]);
        }
      }
      masterDataSource.options.master[detailDataSource.options.id] = detailDataSource;
    });

    self.on("rowAdd", function (e) {
      var data = master.dataItem(e.row.index);
      if (self.options.autoBind) {
        self._card.options.addRow = true;
      }
      data.set("_uid", guid());
    });

    self.on("rowRemove", function (e) {
      if ($.type(e.row.data) === "object") {
        if (
        e.row.data._uid !== undefined &&
        detailDataSource.options.lineDataSources[e.row.data._uid] !== undefined)
        {
          delete detailDataSource.options.lineDataSources[e.row.data._uid];
        }
      } else if ($.type(e.row.data) === "array") {
        $.each(e.row.data, function (idx, rowData) {
          if (
          rowData._uid !== undefined &&
          detailDataSource.options.lineDataSources[rowData._uid] !== undefined)
          {
            delete detailDataSource.options.lineDataSources[rowData._uid];
          }
        });
      }
    });

    function guid() {
      return "xxxxxxxx-xxxx-4xxx-9xxx-xxxxxxxxxxxx".replace(/[xy]/g, function (c) {
        var r = Math.random() * 16 | 0,
          v = c == "x" ? r : r & 0x3 | 0x8;
        return v.toString(16);
      });
    }
  };
  // 그리드 키보드로 이동 가능하게 수정하는 코드
  kendo.ui.Grid.fn._navigatable = function (navigator) {
    return function () {
      var self = this;

      navigator.call(self);

      self.element.find(".k-grid-content table").on("keydown", self.element, function (e) {
        if (e.keyCode >= 37 && e.keyCode <= 40) {
          var $target = $(e.target),
            selectedTr = $target.find("> tbody > tr.k-state-selected"),
            focusedTd = $target.find("> tbody> tr > td.k-state-focused");

          if (focusedTd.length === 0) {
            focusedTd = $target.find("> tbody > tr:first-child");
            self.element.find(".k-state-focused").removeClass("k-state-focused");
          }

          selectedTr.removeClass("k-state-selected");
          self.current(focusedTd);

          // ui 처리만 먼저 함
          var items = self.table.add(self.lockedTable).find(focusedTd.closest("tr"));

          items.each(function () {
            $(this).addClass("k-state-selected");
          });

          e.stopPropagation();
        }
      });

      // 상하방향키 누르고 있으면 change 이벤트 계속 발생하는 이슈로 인한 수정
      // 키다운에서 ui 처리만 해주고 키업됐을 때 change 발생시키도록
      self.element.find(".k-grid-content table").on("keyup", self.element, function (e) {
        if (e.keyCode >= 37 && e.keyCode <= 40) {
          var $target = $(e.target),
            selectedTr = $target.find("> tbody > tr.k-state-selected"),
            focusedTd = $target.find("> tbody> tr > td.k-state-focused");

          if (self.dataSource && self.dataSource.options.paging) {
            setTimeout(function () {
              self.select(focusedTd.closest("tr"));
            }, 1);
          } else {
            self.select(focusedTd.closest("tr"));
          }

          e.stopPropagation();
        }
      });
    };
  }(kendo.ui.Grid.fn._navigatable);

  kendo.ui.Grid.fn._rowsHtml = function (data, templates) {
    var that = this,
      html = "",
      idx,
      rowTemplate = templates.rowTemplate,
      altRowTemplate = templates.altRowTemplate,
      length;

    for (idx = 0, length = data.length; idx < length; idx++) {
      if (that._skipRerenderItemsCount > 0) {
        that._skipRerenderItemsCount--;
      } else {
        // 스크롤 방식일 때 맨 처음에 전체 데이터를 다 그리는 사항 수정
        if (that.options.dataSource.options.serverPaging && data.length !== that.options.dataSource._pageSize) {
          if (idx < that.options.dataSource._pageSize) {
            if (idx % 2) {
              html += altRowTemplate(data[idx]);
            } else {
              html += rowTemplate(data[idx]);
            }
          }
        } else {
          if (idx % 2) {
            html += altRowTemplate(data[idx]);
          } else {
            html += rowTemplate(data[idx]);
          }
        }

        that._data.push(data[idx]);
      }
    }
    return html;
  };

  kendo.ui.Grid.fn.refresh = function (e) {
    var that = this,
      length,
      idx,
      html = "",
      data = that.dataSource.view(),
      navigatable = that.options.navigatable,
      currentIndex,
      selected = that.tbody.find("tr.k-state-selected"),
      uid,
      current = $(that.current()),
      isCurrentInHeader = false,
      groups = (that.dataSource.group() || []).length,
      offsetLeft = that.content && that.content.scrollLeft(),
      colspan = that.columns.length;

    if (selected.length !== 0) {
      uid = selected.data("uid");
      that.options.uid = uid;
    }

    if (e && e.action === "itemchange" && that.editable) {
      // skip rebinding if editing is in progress
      return;
    }

    e = e || {};

    if (
    that.trigger("dataBinding", {
      action: e.action || "rebind",
      index: e.index,
      items: e.items
    }))
    {
      return;
    }

    that._angularItems("cleanup");

    if (
    navigatable && (
    that._isActiveInTable() || that._editContainer && that._editContainer.data("kendoWindow")))
    {
      isCurrentInHeader = current.is("th");
      currentIndex = 0;
      if (isCurrentInHeader) {
        currentIndex = that.thead.find("th:not(.k-group-cell)").index(current);
      }
    }

    that._destroyEditable();

    that._progress(false);

    that._hideResizeHandle();

    that._data = [];

    if (!that.columns.length) {
      that._autoColumns(that._firstDataItem(data[0], groups));
      colspan = groups + that.columns.length;
    }

    that._group = groups > 0 || that._group;

    if (that._group) {
      that._templates();
      that._updateCols();
      that._updateLockedCols();
      that._updateHeader(groups);
      that._group = groups > 0;
    }

    if (this.options.keepRow) {
      that.options.selectedIndex = selected.index();

      if (that.options.dataSource && that.options.dataSource.options.paging) {
        that.options.selectedIndex = that.options._lastSelected.index;
      }

      that._destroyed = [];
    }

    that._renderContent(data, colspan, groups);

    that._renderLockedContent(data, colspan, groups);

    that._footer();

    that._setContentHeight();

    that._setContentWidth(offsetLeft);

    if (that.lockedTable) {
      //requires manual trigger of scroll to sync both tables
      if (that.options.scrollable.virtual) {
        that.content.find(">.k-virtual-scrollable-wrap").trigger("scroll");
      } else if (that.touchScroller) {
        that.touchScroller.movable.trigger("change");
      } else {
        that.content.trigger("scroll");
      }
    }

    if (currentIndex >= 0) {
      that._removeCurrent();
      if (!isCurrentInHeader) {
        that.current(that.tbody.find('tr[data-uid="' + uid + '"] > td'));
      } else {
        that.current(that.thead.find("th:not(.k-group-cell)").eq(currentIndex));
      }
    }

    if (that.touchScroller) {
      that.touchScroller.contentResized();
    }

    if (that.selectable) {
      that.selectable.resetTouchEvents();
    }

    that._angularItems("compile");

    if (that.options.scrollable.virtual) {
      // 페이징 사용 시
      if (
      that.dataSource.options.pagingType === "background" &&
      $.type(that.dataSource.options.index) === "number" ||
      that.dataSource.transport.options.pageRead)
      {
        that.trigger("dataBound");
        that.options._virtualScroll = false;
        that.dataSource.transport.options.pageRead = false;
      } else {
        setRightStyle(that);
        that.select(that.tbody.find('tr[data-uid="' + uid + '"]'));
      }
    } else if (
    that.options.addRow !== true &&
    that.tbody.find('tr[data-uid="' + uid + '"]').length === 0 &&
    that.dataSource._destroyed.length === 0)
    {
      that.tbody.find("tr").removeClass("k-state-selected");

      if (that.element.data("dews-control") || !that.dataSource.transport.data) {
        that.trigger("dataBound");
      } else {
        // 카드리스트 컴포넌트 초기화 이전
        setRightStyle(that);
        that.select(that.tbody.find("tr:first-child"));
      }
    } else if (uid) {
      setRightStyle(that);
      that.select(that.tbody.find('tr[data-uid="' + uid + '"]'));
    }

    if (that.dataSource.options && that.dataSource.options.pagingType === "background") {
      var progress;

      if (data.length > 0 && that.dataSource.options.loadingData) {
        if (that.dataSource.options.index === 0) {
          if (defaultOptions._width >= 500) {
            progress = dews.ui.progress("largeData", {
              total: that.dataSource.options.totalCount,
              textTemplate:
              dews.localize.get("데이터를 불러오고 있습니다.", "dews_데이터를 불러오고 있습니다.") +
              " <strong>#=percent#</strong>",
              target: that.content,
              _paging: true
            });
          } else {
            progress = dews.ui.progress("largeData", {
              total: that.dataSource.options.totalCount,
              textTemplate:
              dews.localize.get("데이터를 불러오고 있습니다.", "dews_데이터를 불러오고 있습니다.") +
              " <strong>#=percent#</strong>",
              target: that.content,
              _paging: true,
              position: {
                align: "bottom",
                margin: [0, 0, 0, 0]
              }
            });
          }
        }
        if (!that.options._virtualScroll) {
          progress = dews.ui.progress("largeData");
          progress.setCurrent(that.dataSource._data.length);
        }
      }
    }

    // 다시 READ 할때 값 초기화
    if (that.dataSource.options && that.dataSource.options.paging) {
      if (that.dataSource.options.index === 0 || that.dataSource.options.index === undefined) {
        that.dataSource._skip = 0;
        that.dataSource._page = 1;
      }

      // 버추얼 스크롤 방식 사용 시 전에 선택했던 아이템 찾기위해
      if (that.options._lastSelected) {
        for (var i = 0; i < data.length; i++) {
          if (that.options._lastSelected.uid === data[i].uid) {
            that.tbody.
            find('tr[data-uid= "' + that.options._lastSelected.uid + '"]').
            addClass("k-state-selected");
          }
        }
      }
    }

    that.options.keepRow = false;
    that.options.addRow = false;

    // if (that.options.dataSource.options.paging && that.options.dataSource.index !== that.options.dataSource.totalLength) {
    //     that.options.keepRow = true;
    // }
  };

  kendo.ui.Grid.fn._onVirtualPaging = function () {
    var that = this;
    that._cacheEditableState();
    if (that._isVirtualIncellEditable()) {
      that._shouldClearEditableState = false;
      that.closeCell();
      that._shouldClearEditableState = true;
      that.options._virtualScroll = true;
    }
  };
  /**
   * 카드리스트 이전 행 선택
   */
  CardList.prototype.keepRow = function () {
    var self = this;

    self._card.options.keepRow = true;
  };

  /**
   * 카드리스트 포커스 설정
   */
  CardList.prototype.setFocus = function () {
    var self = this,
      selectedIndex = self._card.select().index();

    self.select(selectedIndex);
  };
  // 카드리스트 스타일 설정
  function setRightStyle(card) {
    var cardlist = card;
    // 1줄 사용 코드
    if ($(".dews-cardlist-template", cardlist.element).hasClass("single")) {
      if ($(".dews-cardlist-main-text", cardlist.element).length !== 0) {
        $(".dews-cardlist-main-text", cardlist.element).css(
        "top",
        "calc(50% - " + $(".dews-cardlist-main-text", cardlist.element).height() / 2 + "px)");

      }
    }

    // icon 영역이 존재하는 경우 설정
    if ($(".dews-cardlist-icon.checkbox", cardlist.element).length !== 0) {
      $(".dews-cardlist-icon.checkbox", cardlist.element).css(
      "top",
      "calc(50% - " + $(".dews-cardlist-icon.checkbox", cardlist.element).height() / 2 + "px)");

    }

    // 오른쪽 텍스트 가운데 설정
    if (
    $(".dews-cardlist-right-text", cardlist.element).length !== 0 &&
    !$(".dews-cardlist-right-text", cardlist.element).hasClass("bottom"))
    {
      $(".dews-cardlist-right-text", cardlist.element).css(
      "top",
      "calc(50% - " + $(".dews-cardlist-right-text", cardlist.element).height() / 2 + "px)");

    }

    if ($(".dews-cardlist-right-text", cardlist.element).length !== 0) {
      $(".dews-cardlist-template", cardlist.element).addClass("hasRightText");
    }

    if (cardlist.items().length === 0) {
      cardlist.element.
      find(".k-grid-content-expander").
      css("width", cardlist.element.find(".k-grid-content > table").width());
      cardlist.element.find(".k-grid-content-expander").empty();
      cardlist.element.
      find(".k-grid-content-expander").
      append("<span>" + dews.localize.get("데이터가 없습니다.", "dews_데이터가 없습니다.") + "</span>");
    }
  }

  /**
   * 카드리스트에서 부모 데이터 컨트롤의 데이터 반환
   * @return {*} 부모 데이터 컨트롤의 데이터
   */
  CardList.prototype.getParentData = function () {
    var self = this;

    if (self.options.dataSource && self.options.dataSource.options.parent) {
      return self.options.dataSource.options.parent.data();
    }
  };

  /**
   * 카드리스트에서 자식 데이터 컨트롤의 데이터 반환
   * @param index 가져올 행의 자식 데이터의 인덱스
   * @return {*} 가져올 자식 데이터
   */
  CardList.prototype.getChildData = function (index, gridId) {
    var self = this,
      data = self.dataItem(index),
      uid,
      detail,
      dataSourceId,
      masterDataSource = self.options.dataSource,
      detailDatSource;

    if ($.type(data) === "undefined") {
      return;
    }

    if ($.type(masterDataSource) !== "undefined") {
      detailDatSource = masterDataSource.options.detailDataSource;
    }

    if ($.type(gridId) !== "undefined") {
      detail = $("#" + gridId, self.$content).data("dews-control");
      if (detail.options.dataSource && detail.options.dataSource.options.parentDataSource) {
        dataSourceId = detail.options.dataSource.options.parentDataSource.id;
      }

      if ($.type(dataSourceId) !== "undefined") {
        detailDatSource = masterDataSource.options.master[dataSourceId];
      }
    }

    uid = data._uid;
    if ($.type(uid) !== "undefined") {
      if (masterDataSource && detailDatSource && detailDatSource.options.lineDataSources[uid]) {
        return detailDatSource.options.lineDataSources[uid].data();
      }
    }
  };

  /**
   * 페이징 & 소트 사용 시 선택된 요소의 데이터소스 인덱스 반환
   * @return {number} 데이터소스에서의 인덱스 반환
   */
  CardList.prototype.selectedIndex = function () {
    var self = this,
      uid,
      dataItem;

    if (self._card.dataSource) {
      if (self._card.element.find(".k-grid-content tr.k-state-selected").length !== 0) {
        uid = self._card.element.find(".k-grid-content tr.k-state-selected").data("uid");
      } else if (self._card.options._lastSelected) {
        uid = self._card.options._lastSelected.uid;
      }

      dataItem = self._card.dataSource.getByUid(uid);
      return self._card.dataSource.indexOf(dataItem);
    }
  };

  /**
   * 페이징 & 소트 사용 시 선택된 요소의 데이터소스 데이터아이템 반환
   * @return {number} 데이터소스에서의 데이터아이템 반환
   */
  CardList.prototype.selectedDataItem = function () {
    var self = this,
      uid;

    if (self._card.dataSource) {
      if (self._card.element.find(".k-grid-content tr.k-state-selected").length !== 0) {
        uid = self._card.element.find(".k-grid-content tr.k-state-selected").data("uid");
      } else if (self._card.options._lastSelected) {
        uid = self._card.options._lastSelected.uid;
      }

      return self._card.dataSource.getByUid(uid);
    }
  };

  /**
   * 데이터소스의 데이터아이템을 기준으로 데이터 삭제
   * @param {object} 데이터소스의 데이터아이템
   */
  CardList.prototype.removeByDataItem = function (dataItem) {
    var self = this,
      selected = self._card.options._lastSelected,
      indexOf = self.options.dataSource.indexOf(dataItem),
      _currentRangeStart;
    var removeParams = {
        cardlist: self,
        row: {
          index: indexOf,
          data: dataItem
        }
      },
      rowRemoveEvent = $.Event("rowRemove", removeParams);

    self._card.element.trigger(rowRemoveEvent);

    if (self._card.dataSource) {
      if ($.type(dataItem) === "object") {
        if (self._card.dataSource.options.paging) {
          _currentRangeStart = self.options.dataSource._currentRangeStart;
          self._card.dataSource._currentRangeStart = indexOf;
        }

        self._card.dataSource.remove(dataItem);

        if (self._card.dataSource.options.paging) {
          self._card.dataSource._currentRangeStart = _currentRangeStart;
        }
      }
    }

    setRightStyle(self._card);

    if (selected && dataItem && selected.uid === dataItem.uid && self._card.dataSource.data().length !== 0) {
      if (self._card.dataSource.data().length === selected.index) {
        setTimeout(function () {
          self._card._virtualPageToBottom(function () {
            self._card.virtualScrollable.scrollToBottom();
            self.select(selected.index - 1);
          });
        }, 1);
      } else {
        self.select(selected.index);
      }
      self._card.element.find("td.k-state-focused").removeClass("k-state-focused");
    } else if (indexOf > -1) {
      if (self._card.dataSource.data().length === indexOf) {
        self.select(indexOf - 1);
      } else {
        self.select(indexOf);
      }
    } else {
      self._card.trigger("change");
    }
  };

  CardList.prototype.view = function () {
    return this.options.dataSource.view();
  };
})(jQuery, window.dews, window.kendo);


/*
 * 챠트
 */
(function ($, dews, kendo) {
  var defaultOptions = {
    type: "",
    chartType: "",
    title: {
      position: "top",
      align: "left",
      color: "#4a4a4a",
      font: "16px 'Graphic",
      padding: {
        bottom: 10
      }
    },
    seriesColors: [
    "#6994f3",
    "#49c6d5",
    "#6fd859",
    "#f7c631",
    "#f78462",
    "#637697",
    "#917aff",
    "#cc81f3",
    "#9dc70e",
    "#4367c4"],

    seriesDefaults: {
      type: "column",
      stack: false,
      labels: {
        visible: false,
        background: "transparent"
      },
      overlay: {
        gradient: "none"
      },
      border: {
        width: 0
      }
    },
    chartArea: {
      background: "transparent"
    },
    autoBind: true,
    tooltip: {
      visible: true,
      color: "#000",
      border: {
        width: 2,
        opacity: 1
      },
      opacity: 0.85
    },
    legend: {
      visible: true,
      position: "top",
      align: "start",
      color: "#4a4a4a",
      icon: "circle",
      item: {}
    },
    categoryAxis: {
      color: "#8c8c8c",
      line: {
        visible: false
      },
      majorGridLines: {
        visible: false
      }
    },
    valueAxis: {
      color: "#8c8c8c",
      line: {
        visible: false,
        color: "#e8e8e8",
        width: 1
      },
      minorGridLines: {
        visible: false
      }
    },
    xAxis: {
      color: "#8c8c8c",
      title: {
        font: "13px Graphic",
        color: "#000"
      }
    },
    yAxis: {
      color: "#8c8c8c",
      title: {
        font: "13px Graphic",
        color: "#000"
      }
    }
  };var _event3 = /*#__PURE__*/new WeakMap();var _shape = /*#__PURE__*/new WeakMap();var

  Legend = /*#__PURE__*/function () {"use strict";


    function Legend(event, shape) {_classCallCheck(this, Legend);_classPrivateFieldInitSpec(this, _event3, { writable: true, value: void 0 });_classPrivateFieldInitSpec(this, _shape, { writable: true, value: void 0 });
      _classPrivateFieldSet(this, _event3, event);
      _classPrivateFieldSet(this, _shape, shape);
    }_createClass(Legend, [{ key: "createLegendLayout", value:























      function createLegendLayout() {
        var rect = new kendo.geometry.Rect([0, 0], [300, 50]);
        return new kendo.drawing.Layout(rect, {
          spacing: 5,
          alignItems: "center"
        });
      } }, { key: "createLegendMarkerCircle", value:

      function createLegendMarkerCircle() {
        // create a circle geometry centered at x=10, y=5, with a radius of 5
        var circle = new kendo.geometry.Circle([10, 5], 5);
        // draw the circle using the geometry and set the color (could have no stroke)
        return new kendo.drawing.Circle(circle, {
          stroke: {
            color: _classPrivateFieldGet(this, _event3).options.markers.background,
            width: 1
          },
          fill: { color: _classPrivateFieldGet(this, _event3).options.markers.background }
        });
      } }, { key: "createLegendMarkerSquare", value:

      function createLegendMarkerSquare() {
        // create a square geometry centered at x=0, y=0, with width=7 height=7
        var square = new kendo.geometry.Rect([0, 0], [7, 7]);
        return new kendo.drawing.Rect(square, {
          stroke: {
            color: _classPrivateFieldGet(this, _event3).options.markers.background,
            width: 1
          },
          fill: { color: _classPrivateFieldGet(this, _event3).options.markers.background }
        });
      } }, { key: "createLegendLabel", value:

      function createLegendLabel() {
        var type = _classPrivateFieldGet(this, _event3).sender.options.type || _classPrivateFieldGet(this, _event3).series.type;
        var name = _classPrivateFieldGet(this, _event3).series.name;

        if (type === "donut" || type === "pie") {
          var field = _classPrivateFieldGet(this, _event3).series.categoryField || "category";
          name = _classPrivateFieldGet(this, _event3).series.data[_classPrivateFieldGet(this, _event3).pointIndex][field];
        }

        return new kendo.drawing.Text(name, [0, 0], {
          fill: {
            color: _classPrivateFieldGet(this, _event3).options.labels.color
          }
        });
      } }], [{ key: "create", value: function create(event, shape) {var legend = new Legend(event, shape);var marker;switch (shape) {case "circle":marker = legend.createLegendMarkerCircle();break;case "square":marker = legend.createLegendMarkerSquare();break;default:console.error("There is no such type of marker: ".concat(shape));marker = legend.createLegendMarkerCircle();}var result = legend.createLegendLayout();result.append(marker, legend.createLegendLabel());result.reflow();return result;} }]);return Legend;}();


  /**
   * 챠트 생성을 위한 옵션을 생성합니다.
   * @param {object} srcOptions 소스코드에서 전달된 옵션
   * @returns {object} 옵션
   */
  function getOptions(srcOptions) {
    var options = $.extend(true, {}, defaultOptions);

    if (srcOptions) {
      // 차트 타입에 따른 옵션 설정
      if ($.type(srcOptions.type) === "string") {
        switch (srcOptions.type.toLowerCase()) {
          case "pie":
          case "donut":
            options.legend.position = "bottom";
            options.legend.align = "center";
            break;
          case "area":
            $.extend(true, options.seriesDefaults, {
              markers: {
                visible: true,
                type: "circle",
                size: 6,
                background: "#fff",
                border: {
                  width: 1
                }
              },
              area: {
                opacity: 0.1,
                line: {
                  width: 2
                }
              }
            });
            options.categoryAxis.justified = false;
            break;
          case "line":
            $.extend(true, options.seriesDefaults, {
              markers: {
                visible: true,
                type: "circle",
                size: 6,
                background: "#fff",
                border: {
                  width: 1
                }
              }
            });
            break;
          case "polarscatter":
          case "scatter":
            $.extend(true, options.seriesDefaults, {
              markers: {
                visible: true,
                type: "circle",
                size: 6,
                background: function background(e) {
                  return e.series.color;
                },
                border: {
                  width: 1
                }
              }
            });
            break;
          case "bar":
          case "column":
            options.seriesDefaults.labels.visible = true;
            if ($.type(srcOptions.stack) === "boolean" && srcOptions.stack) {
              options.seriesDefaults.labels.position = "center";
            }
            break;
          case "boxplot":
          case "verticalboxplot":
            srcOptions.series[0].outliersField = "outliers";
            break;}

      }
      // 제목 설정
      if ($.type(srcOptions.title) === "string") {
        srcOptions.title = {
          text: srcOptions.title
        };
      }
      // 도넛 내 텍스트 설정
      if (
      $.type(srcOptions.inner) === "object" &&
      srcOptions.type.toLowerCase() === "donut" &&
      $.type(srcOptions.series) === "array")
      {
        var center, radius;
        srcOptions.series[0].visual = function (e) {
          center = e.center;
          radius = e.radius;

          return e.createVisual();
        };

        var fontsize = $.type(srcOptions.inner.fontSize) === "number" ? srcOptions.inner.fontSize : 18;

        options.render = function (e) {
          var draw = kendo.drawing;
          var geom = kendo.geometry;
          var chart = e.sender;
          var circleGeometry = new geom.Circle(center, radius);
          var bbox = circleGeometry.bbox();
          var text = new draw.Text(srcOptions.inner.text, [0, 0], {
            font: fontsize + "px Graphic"
          });
          draw.align([text], bbox, "center");
          draw.vAlign([text], bbox, "center");

          e.sender.surface.draw(text);
        };
      }
    }

    return customizingOptions($.extend(true, options, srcOptions));
  }

  /**
   * 차트의 옵션 설정
   * @param opt 설정할 옵션
   * @return {*} 변경된 옵션
   */
  function customizingOptions(opt) {
    var options = $.extend(true, {}, opt);

    // 차트 타입 설정
    if (typeof options.type === "string" && options.type !== "") {
      options.seriesDefaults.type = options.type;
    }

    // 차트 너비 설정
    if (typeof options.width === "number") {
      options.chartArea.width = options.width;
    }

    // 차트 높이 설정
    if (typeof options.height === "number") {
      options.chartArea.height = options.height;
    }

    // 차트 색상 설정
    if (Array.isArray(options.colors)) {
      options.seriesDefault = options.colors;
    }

    // 차트 스택 설정
    if (typeof options.stack === "boolean") {
      options.seriesDefaults.stack = options.stack;
    }

    // 범례 모양 설졍
    if (options.legend.icon !== "rectangle") {
      options.legend.item.visual = function (e) {return Legend.create(e, options.legend.icon);};
    }

    return options;
  }

  function Chart($el, opt) {
    var self = this;

    var options = getOptions(opt);
    self._$element = $el;

    if (options.type.toLowerCase() === "sparkline") {
      delete options.seriesDefaults.markers;
      options.type = options.chartType;
      options.chartType = "sparkline";

      // 스파크라인의 선에 대한 설정을 지정하지 않았을 때 기본 값 지정
      if (options.seriesDefaults.area === undefined) {
        options.seriesDefaults.area = {
          line: {
            width: 2
          },
          opacity: 0.1
        };
      }
      self._chart = $el.kendoSparkline(options).data("kendoSparkline");
    } else if (options.type.toLowerCase() === "stock") {
      options.type = options.chartType;
      options.chartType = "stock";
      self._chart = $el.kendoStockChart(options).data("kendoStockChart");
    } else if (options.type.toLowerCase() === "treemap") {
      options.colors = options.seriesColors;
      options.type = options.chartType;
      options.chartType = "treemap";
      self._chart = $el.kendoTreeMap(options).data("kendoTreeMap");
    } else if (options.type.toLowerCase() === "gauge") {
      options.gaugeArea = options.chartArea;
      options.type = options.chartType;
      options.chartType = "gauge";

      if (options.type.toLowerCase() === "linear") {
        self._chart = $el.kendoLinearGauge(options).data("kendoLinearGauge");
      } else {
        self._chart = $el.kendoRadialGauge(options).data("kendoRadialGauge");
      }

      // 2021-11-22 PD1C-889
      // gauge Chart setOptions 후 자동으로 redraw() 되지 않는 현상 수정
      // kendo.all.js 의 setOptions 함수 재정의
      // 옵션 병합 후 this.redraw() 추가
      self._chart.setOptions = function (options) {
        this._setEvents(options);
        $.extend(true, this.options, options);
        this.redraw();
      };
    } else if (options.type.toLowerCase() === "range") {
      if (options.chartType.toLowerCase() === "area" || options.chartType === "") {
        options.type = "rangeArea";
        options.seriesDefaults.type = "rangeArea";
      } else if (options.chartType.toLowerCase() === "bar") {
        options.type = "rangeBar";
        options.seriesDefaults.type = "rangeBar";
      } else if (options.chartType.toLowerCase() === "column") {
        options.type = "rangeColumn";
        options.seriesDefaults.type = "rangeColumn";
      }
      self._chart = $el.kendoChart(options).data("kendoChart");
    } else if (options.type.toLowerCase() === "radar") {
      if (options.chartType.toLowerCase() === "line" || options.chartType === "") {
        options.type = "radarLine";
        options.seriesDefaults.type = "radarLine";
      } else if (options.chartType.toLowerCase() === "column") {
        options.type = "radarColumn";
        options.seriesDefaults.type = "radarColumn";
      } else if (options.chartType.toLowerCase() === "area") {
        options.type = "radarArea";
        options.seriesDefaults.type = "radarArea";
      }
      self._chart = $el.kendoChart(options).data("kendoChart");
    } else if (options.type.toLowerCase() === "bullet") {
      if (options.chartType.toLowerCase() === "horizontal" || options.chartType === "") {
        options.type = "bullet";
        options.seriesDefaults.type = "bullet";
      } else if (options.chartType.toLowerCase() === "vertical") {
        options.type = "verticalBullet";
        options.seriesDefaults.type = "verticalBullet";
      }
      self._chart = $el.kendoChart(options).data("kendoChart");
    } else if (options.type.toLowerCase() === "boxplot") {
      if (options.chartType.toLowerCase() === "horizontal" || options.chartType === "") {
        options.type = "boxPlot";
        options.seriesDefaults.type = "boxPlot";
      } else if (options.chartType.toLowerCase() === "vertical") {
        options.type = "verticalBoxPlot";
        options.seriesDefaults.type = "verticalBoxPlot";
      }
      self._chart = $el.kendoChart(options).data("kendoChart");
    } else {
      self._chart = $el.kendoChart(options).data("kendoChart");
    }
    self.options = options;
    self.dataSource = options.dataSource;

    self._bindEvent();

    if (self.options.autoBind && $.type(self.options.dataSource) === "object" && self.options.dataSource.id) {
      self.options.dataSource.read();
    }

    return self;
  }

  /**
   *  차트의 기본 이벤트를 설정합니다.
   */
  Chart.prototype._bindEvent = function () {
    var self = this,
      $tabPanel;

    $tabPanel = self._$element.closest(".dews-ui-tab-panel");

    if ($tabPanel.length > 0) {
      var tabPanel = $tabPanel.data("dews-control");
      var tabItemId = self._$element.closest(".dews-tab-item").attr("id");

      if (tabPanel) {
        tabPanel.on("change", function (e) {
          if (e.openItem._item.attr("id") === tabItemId) {
            self.redraw();
          }
        });
      }
    }

    $(window).on("resize", function () {
      self.redraw();
    });

    // 폴라 라인일 경우 사용
    if (self.options.type.toLowerCase() === "polarline") {
      self._chart.bind("dataBound", function (e) {
        if ($.type(self.options.dataSource) !== "undefined") {
          var data = self.options.dataSource.data();
          var seriesIndex = 0;
          var xField = self.options.series[0].xField;
          var yField = self.options.series[0].yField;
          var preData = "";
          self.options.series = [];
          $.each(data, function (idx, value) {
            if (idx === 0) {
              preData = value[self.options.seriesDefaults.categoryField];
            }

            if (preData !== value[self.options.seriesDefaults.categoryField]) {
              seriesIndex++;
              preData = value[self.options.seriesDefaults.categoryField];
            }

            if (value.hasOwnProperty(self.options.seriesDefaults.categoryField)) {
              if ($.type(self.options.series[seriesIndex]) === "undefined") {
                self.options.series[seriesIndex] = {
                  data: []
                };
              }
              self.options.series[seriesIndex].data.push([value[xField], value[yField]]);
            }
          });

          self._chart.setOptions(self.options);
          self._chart.refresh();
        }
      });
    }

    // 박스플롯일 경우 사용
    if (self.options.type.toLowerCase() === "boxplot" || self.options.type.toLowerCase() === "verticalboxplot") {
      if (!self.options.dataSource.data) {
        self._chart.bind("dataBound", function (e) {
          if ($.type(self.options.dataSource) !== "undefined") {
            var data = self.options.dataSource._data;
            var url = self.options.dataSource.options.transport.read.url;
            var paramField = self.options.dataSource.options.schema.model.id;

            $.each(data, function (idx, item) {
              var obj = {};
              obj[paramField] = item[paramField];
              dews.api.
              get(url, {
                async: false,
                data: obj
              }).
              done(function (result) {
                var data = [];
                $.each(result, function (index, value) {
                  data.push(value[Object.keys(value)[0]]);
                });
                item.outliers = data;
              }).
              fail(function () {
                console.log(arguments);
              });
            });
          }
        });
      }
    }
  };

  /**
   * 차트의 데이터소스를 설정합니다.
   * @param dataSource 데이터소스 객체
   */
  Chart.prototype.setDataSource = function (dataSource) {
    var self = this;

    self._chart.setDataSource(dataSource);
    self.options.dataSource = dataSource;
    self.dataSource = dataSource;
  };

  Chart.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["click", "dataBound"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        self._$element.trigger(event);
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  /**
   * 차트의 이벤트를 설정합니다.
   */
  Chart.prototype.on = function () {
    var self = this,
      $element = self._$element;

    $element.bind.apply($element, arguments);
  };

  /**
   * 차트의 이벤트를 제거합니다.
   */
  Chart.prototype.off = function () {
    var self = this;

    self._chart.unbind.apply(self._chart, arguments);
  };

  /**
   * 차트의 옵션을 새로 정의합니다.
   * @param options 적용할 옵션
   */
  Chart.prototype.setOptions = function (options) {
    var self = this,
      opt;
    var dataSource = self.options.dataSource;

    opt = $.extend(true, self.options, options);
    self.options = customizingOptions(opt);

    self._chart.setOptions(self.options);

    if (dataSource && self.dataSource) {
      self.options.dataSource = self.dataSource;
    }
  };

  /**
   * 차트를 새로 고칩니다.
   */
  Chart.prototype.refresh = function () {
    var self = this;

    self._chart.refresh();
  };

  /**
   * 차트를 새로 그립니다.
   */
  Chart.prototype.redraw = function () {
    var self = this;

    if (self._chart.redraw instanceof Function) {
      self._chart.redraw();
    }
  };

  $.extend(true, dews, {
    ui: {
      /**
       * 챠트를 생성하거나 가져옵니다.
       * @param {jQuery|string} selector 챠트가 될 대상의 jQuery 객체 또는 셀렉터
       * @param {object} [options] 생성 옵션
       */
      chart: function chart(selector, options) {
        var $ctl, chart;

        if (selector instanceof jQuery) {
          $ctl = selector;
        } else if ($.type(selector) === "string") {
          $ctl = $(selector);
        } else {
          throw "챠트를 생성할 대상이 제공되지 않았습니다.";
        }

        $ctl.each(function () {
          var $this = $(this),
            opt,
            charts;

          chart = $this.data("dews-control");

          if (!chart) {
            charts = new Chart($this, options);

            if (!$this.hasClass("dews-ui-chart")) {
              $this.addClass("dews-ui-chart");
            }
            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            $this.data("dews-control", charts);

            chart = charts;
          }
        });

        return chart;
      }
    }
  });
})(jQuery, window.dews, window.kendo);


/**
 * 체크 박스
 */
(function ($, dews, kendo) {
  function Checkbox(selector) {
    var self = this;
    self.target = selector;

    self._createLabel();

    self._setClass();
  }

  Checkbox.prototype._setClass = function () {
    var self = this,
      $this = self.target;

    if (!$this.hasClass("dews-control")) {
      $this.addClass("dews-control");
    }

    if (!$this.hasClass("dews-ui-checkbox")) {
      $this.addClass("dews-ui-checkbox");
    }

    if (!$this.hasClass("k-checkbox")) {
      $this.addClass("k-checkbox");
    }

    if (!$this.hasClass("dews-control-activate")) {
      $this.addClass("dews-control-activate");
    }
  };

  Checkbox.prototype._createLabel = function () {
    var self = this,
      $label = $('<label class="dews-checkbox-label k-checkbox-label"></label>');
    var $textLabel,
      context = undefined,
      clickedLabel = undefined;

    var $wrapper = $("<span/>").addClass("dews-checkbox-wrapper");

    self.target.wrap($wrapper);
    self.target.after($label);

    $textLabel = self.target.parent().siblings("label[for=" + self.target.attr("id") + "]");
    if ($textLabel[0] && $textLabel.data("dews-localize-key")) {
      $textLabel.text(
      dews.localize.get(
      $textLabel.text(),
      $textLabel.data("dews-localize-key"),
      $textLabel.data("dews-localize-lang") || null));


    }

    // 체크박스 라벨 말줄임 표시 처리
    if (dews._environments.useLabelOverflow === "2") {
      $wrapper = self.target.parent();

      if ($wrapper.parent().hasClass("dews-checkbox-group")) {
        if (!$wrapper.parent().hasClass("ellipsis")) {
          $wrapper.parent().addClass("ellipsis");
        }
      } else {
        if (
        $wrapper.siblings(".dews-ui-checkbox").length === 0 &&
        $wrapper.siblings(".dews-checkbox-wrapper").length === 0)
        {
          $wrapper.addClass("ellipsis");
        }
      }
    }

    // 말줄임 표시에 tooltip 표시
    $textLabel.on("mouseenter", function (e) {
      var targetLabel = e.currentTarget;
      if (targetLabel.scrollWidth > targetLabel.offsetWidth) {
        if (!$(targetLabel).attr("title")) {
          $(targetLabel).attr("title", targetLabel.innerText);
        }
      }
    });

    $label.on("click", function (e) {
      self.target.click();
    });

    $textLabel.on("click", function (e) {
      e.preventDefault();
    });

    if (dews.ui.dialogPage) {
      context = $(dews.ui.dialogPage.$content[0]);
    } else if (dews.ui.page) {
      context = $(dews.ui.page.$content[0]);
    } else {
      context = self.target.parents("div.container");
    }

    if (context !== undefined && context.find("label[for=" + self.target.attr("id") + "]")[0] !== undefined) {
      // for 로 연결되어 있는 label
      clickedLabel = context.find("label[for=" + self.target.attr("id") + "]");
    } else if (context !== undefined && self.target.parent().next("label")[0] !== undefined) {
      // for 없이 체크박스 뒤에 오는 label
      clickedLabel = self.target.parent().next("label");
    } else if (context !== undefined && self.target.parent().prev("label")[0] !== undefined) {
      // for 없이 체크박스 앞에 오는 label
      clickedLabel = self.target.parent().prev("label");
    }

    if (clickedLabel !== undefined) {
      clickedLabel.on("click", function () {
        context.find("#" + self.target.attr("id")).click();
      });
    }
  };

  Checkbox.prototype.focus = function () {
    var self = this;

    self.target.focus();
  };

  Checkbox.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change", "click"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        self.target.trigger(event);
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  Checkbox.prototype.on = function () {
    var self = this;

    self.target.on.apply(self.target, arguments);
  };

  Checkbox.prototype.off = function () {
    var self = this;

    self.target.off.apply(self.target, arguments);
  };

  Checkbox.prototype.bindFromPanel = function (data) {
    var self = this,
      $element = $(self.target);
    var column;

    if (data) {
      column = $element.data("dews-bind-column") || $element.attr("id");

      if (column && data.hasOwnProperty(column)) {
        if ($element.data("dews-bind-checked-value") || $element.data("dews-bind-unchecked-value")) {
          var trueValue, falseValue;
          var checked;

          if ($element.data("dews-bind-checked-value")) {
            trueValue = $element.data("dews-bind-checked-value");
          }
          if ($element.data("dews-bind-unchecked-value")) {
            falseValue = $element.data("dews-bind-unchecked-value");
          }

          if (data[column] === trueValue) {
            checked = true;
          } else if (data[column] === falseValue) {
            checked = false;
          }

          if ($.type(checked) !== "undefined") {
            $element.prop("checked", checked || "");
          }
        } else {
          $element.prop("checked", data[column] || "");
        }
      }
    }
  };

  Checkbox.prototype.serializeForPanel = function () {
    var self = this,
      $element = $(self.target);
    var column, data;
    var value;

    column = $element.data("dews-bind-column") || $element.attr("id");

    if (column) {
      data = {};
      value = self.value();

      if ($.type(value) !== "boolean") {
        var checked = $element.is(":checked");
        var trueValue = true,
          falseValue = false;

        if (checked) {
          if ($element.data("dews-bind-checked-value")) {
            trueValue = $element.data("dews-bind-checked-value");
            value = trueValue;
          }
        } else {
          if ($element.data("dews-bind-unchecked-value")) {
            falseValue = $element.data("dews-bind-unchecked-value");
            value = falseValue;
          }
        }
        data[column] = value;
      } else {
        data[column] = $element.prop("checked");
      }
    }

    return data;
  };

  Checkbox.prototype.applyPanelFocus = function () {
    var self = this,
      $element = $(self.target);

    $element.on("keydown", function (e) {
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && $element.is(":enabled")) {
        e.preventDefault();
      } else if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();

        var evt = new $.Event("beforeFocus");
        evt.control = self;

        $element.trigger(evt);
      } else if (e.keyCode === 9 || e.keyCode === 13 && $element.is(":enabled")) {
        if (e.keyCode === 9) {
          //tab키 기본동작 막기
          e.preventDefault();
        }
        var evt = new $.Event("nextFocus");
        evt.control = self;

        $element.trigger(evt);
      }
    });
  };

  Checkbox.prototype.canFocusable = function () {
    var self = this,
      $element = $(self.target);

    return !$element.hasClass("readonly") && $element.is(":visible") && $element.is(":enabled");
  };
  /**
   * 체크박스 컨트롤 자동화 인쇄 관련 데이터 추출
   * @return {*} 값이 설정 된 경우 Object 반환, 없는 경우 undefined 반환
   * @private
   */
  Checkbox.prototype._getPrintData = function () {
    var self = this,
      $el = $(self.target),
      data;

    if ($el.is(":checked")) {
      data = {
        id: $el.attr("id"),
        text: true
      };
    }

    return data;
  };

  Checkbox.prototype.check = function (value) {
    var self = this,
      $el = $(self.target),
      checked;

    checked = $el.is(":checked");

    if (typeof value !== "undefined") {
      if (value === true) {
        $el.prop("checked", true);
        if (checked === false) {
          $el.trigger("change");
        }
      } else if (value === false) {
        $el.prop("checked", false);
        if (checked !== false) {
          $el.trigger("change");
        }
      }
    } else {
      return checked;
    }
  };

  Checkbox.prototype.value = function () {
    var self = this,
      $el = $(self.target),
      checked;
    var trueValue = true,
      falseValue = false;

    checked = $el.is(":checked");

    if (checked) {
      if ($el.data("dews-bind-checked-value")) {
        trueValue = $el.data("dews-bind-checked-value");
        checked = trueValue;
      }
    } else {
      if ($el.data("dews-bind-unchecked-value")) {
        falseValue = $el.data("dews-bind-unchecked-value");
        checked = falseValue;
      }
    }

    return checked;
  };

  Checkbox.prototype.disable = function (value) {
    var self = this,
      $el = $(self.target),
      disable;

    disable = $el.prop("disabled");

    if (typeof value !== "undefined") {
      if (value === true) {
        $el.prop("disabled", true);
      } else if (value === false) {
        $el.prop("disabled", false);
      }
    } else {
      return disable;
    }
  };

  $.extend(true, dews, {
    ui: {
      /**
       * Checkbox를 생성하거나 가져옵니다.
       * @param {string|jQuery} selector 요소를 지정하는 셀렉터 또는 jQuery객체입니다.
       */
      checkbox: function checkbox(selector) {
        var $el, box;

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector);
        }

        $el.each(function () {
          var $this = $(this),
            chkBox;

          chkBox = $this.data("dews-control");

          if (!chkBox) {
            if (!$this.hasClass("dews-form-control")) {
              $this.addClass("dews-form-control");
            }

            chkBox = new Checkbox($this);
            $this.data("dews-control", chkBox);
          }

          box = chkBox;
        });

        return box;
      }
    }
  });

  dews.ui.addControlInitializer("checkbox", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.checkbox($("input[type=checkbox].dews-ui-checkbox", $container));
  });
})(jQuery, window.dews, window.kendo);


/**
 * 코드도움 AJAX 및 다이얼로그 처리
 */
(function ($, dews, kendo) {
  /**
   * 코드도움 AJAX 요청 객체
   * @param {string} code 코드도움 코드
   * @param {object} params 코드도움 AJAX 요청에 필요한 추가적인 파라미터 객체
   * @constructor
   */
  var CodeHelpAjax = function CodeHelpAjax(code, params, custom, apiUrl) {
    var self = this;

    self.code = code;
    self.params = params;

    if (custom) {
      self.url = apiUrl;
    } else {
      self.url = dews.string.format(dews._environments.codeDataUrlFormat, self.code);
    }
  };

  /**
   * AJAX 요청을 보냅니다.
   * @returns {Promise} AJAX 요청에 대한 Promise 객체
   */
  CodeHelpAjax.prototype.getCodeData = function () {
    var self = this,
      options = {};

    options.data = self.params;

    return dews.ajax.get(self.url, options);
  };

  /**
   * @typedef {Object} CodeHelpDialogData
   * @property {string} code 코드도움창 코드
   * @property {object} params 추가적인 파라미터
   * @property {string} title 코드도움창 타이틀
   * @property {string} mode 코드도움창 작동 방식(single|multi)
   * @property {number} width 코드도움창 너비
   * @property {number} height 코드도움창 높이
   * @property {object} initData 코드도움창 초기 데이터
   * @property {boolean} custom 사용자 정의 도움창 여부
   * @property {string} viewUrl 사용자 정의 도움창 url
   * @property $target
   */
  /**
   * 코드 도움을 위한 다이얼로그 입니다.
   * @param {CodeHelpDialogData} data
   * @constructor
   */
  var CodeHelpDialog = function CodeHelpDialog(data) {
    var self = this;

    self.code = data.code;
    self.codeField = data.codeField;
    self.params = data.params;
    self.title = data.title;
    self.mode = data.mode;
    self.width = data.width;
    self.height = data.height;
    self.initData = data.initData;
    self.custom = data.custom;
    self.viewUrl = data.viewUrl;

    self.$target = data.$target;
  };

  /**
   * 코드도움 다이얼로그를 엽니다.
   * @param {function} callback 다이얼로그에서 데이터를 설정할 때 실행할 콜백 함수
   */
  var multiSearchGbn = false; //멀티검색을 위한 구분값
  CodeHelpDialog.prototype.open = function (callback) {
    var self = this,
      dialog,
      options,
      initData = {},
      buttonArea;

    // 다이얼로그 옵션을 생성합니다.
    options = {
      url: dews.url.getCodeViewUrl(self.code),
      iframe: false,
      buttons: "applyAndClose",
      ok: callback,
      cancel: null
    };

    if (self.custom) {
      options.url = self.viewUrl;
    }

    if (self.code) {
      $.extend(true, initData, { code: self.code });
    }

    if (self.codeField) {
      $.extend(true, initData, { codeField: self.codeField });
    }

    if (self.params) {
      $.extend(true, initData, { params: self.params });
    }

    if ($.type(self.title) !== "undefined" && $.trim(self.title)) {
      options.title = self.title;
      options.url = dews.url.appendParameters(options.url, {
        tl: self.title
      });
      $.extend(true, initData, { title: self.title });
    }

    if ($.type(self.width) !== "undefined" && self.width) {
      options.width = self.width;
    }

    if ($.type(self.height) !== "undefined" && self.height) {
      options.height = self.height;
    }

    if (self.mode) {
      $.extend(true, initData, { mode: self.mode });

      if (self.mode === "multi") {
        options.url = dews.url.appendParameters(options.url, { mt: 1 });
      }
    }

    // 다이얼로그 작성
    dialog = dews.ui.dialog(self.code, options);

    if (initData) {
      $.extend(true, initData, { data: self.initData });
      dialog.setInitData(initData);
    }

    dews.log("## dews-ui-codehelp : 다이얼로그 열기 ## \n" + "초기화 데이터: " + JSON.stringify(initData));
    // 다이얼로그 열기
    dialog.open();

    if (dialog._kendoWindow) {
      dialog._kendoWindow.bind("deactivate", function () {
        // deactivate 로 바꾼 이유는 애니메이션이 끝나고 실행하기 위함
        setTimeout(
        function () {
          self.$target.trigger("codedialogclosed");
        },
        $(".k-window.dialog").length > 1 ? 200 : 0);
        // 다이얼로그가 2개 이상의 다이얼로그가 떠있을 때만, 0.2초를 지연시킴. 아닐때는 똑같이 처리.
      });

      dialog._kendoWindow.bind("open", function () {
        dews.ui.loading.hide();
      });

      //멀티검색 활성화/비활성화 판단(multiSearchGbn) - true/false
      if (window.location.hostname === "dev.comet.duzon.net") {
        //prd서버에서만 실행하도록 임시 처리
        if (multiSearchGbn) {
          dialog._kendoWindow.bind("activate", function () {
            if (self.mode === "multi") {
              contextMenu(self, dialog); //멑티검색함수호출
            }
            multiSearchGbn = false; //구분자 초기화
          });
        }
      }
    }
  };

  //멀티검색기능추가
  var contextMenu = function contextMenu(self, dialog) {
    var intervalStop = false;
    var intervalCount = 0;

    if ($("#contextmenu").data("kendoContextMenu")) {
      $("#contextmenu").data("kendoContextMenu").destroy();
    }

    var interval = setInterval(function () {
      if (!intervalStop) {
        var setInput = null;
        if ($(dialog.$content).find(".dews-condition-panel-form").length > 0) {
          setInput = $(dialog.$content).find(".dews-condition-panel-form");
        }

        // 무한 루프 방지
        if (intervalCount === 20) {
          clearInterval(interval);
        }

        if ($("#contextmenu").data("kendoContextMenu")) {
          $("#contextmenu").data("kendoContextMenu").destroy();
        }

        if (setInput !== null) {
          intervalStop = true;

          var ul = document.createElement("ul");
          ul.id = "contextmenu";
          ul.style = "background-color : #FFF";
          document.body.appendChild(ul);

          var contxt = $("#contextmenu").kendoContextMenu({
            target: setInput,
            select: function select(e) {
              // handle event

              var innerHtml =
              "\n" +
              '<div class="dews-dialog-contents-area">\n' +
              '<div class="dews-button-group">\n' +
              '<span style="float:left; font-size: 14px"><b>검색어 목록</b></span>' +
              '<button class="dews-ui-button" id="addRowBtn">추가</button>\n' +
              "</div>\n" +
              '<div class="dews-container-panel" data-dews-container-height="198">\n' +
              '<div class="dews-container-item">\n' +
              '<div class="dews-ui-grid" id="MultiSearchGrid"></div>\n' +
              "</div>\n" +
              "</div>\n" +
              '<div class="dews-ui-referbox" data-dews-title="사용 Tip" data-dews-button="true" data-dews-closed="true" >\n' +
              '<p style="color: #4a4a4a">\n' +
              "· 검색어 입력은 직접입력과 엑셀에서 작성한 내용을 <br> &nbsp&nbsp&nbsp 복사하여 붙여넣기 할 수 있습니다.\n<br>" +
              "· 1줄당 최대 20자까지 입력 가능합니다.\n<br>" +
              "· 한글/영문, 숫자, 특수문자 입력이 가능합니다\n<br>" +
              "· 멀티검색은 최대 50줄까지 입력 할 수 있습니다\n" +
              "</p>\n" +
              "</div>";

              var dialog2 = dews.ui.dialog("largeDialog", {
                content: innerHtml,
                title: "멀티검색",
                width: 360,
                height: 352,
                buttons: "applyAndClose",
                open: function open(e) {
                  dews.ready(function () {
                    var self = this;

                    var gridDataSource = dews.ui.dataSource("dataSource", {
                      grid: true,
                      data: [
                      { cel1: "" },
                      { cel1: "" },
                      { cel1: "" },
                      { cel1: "" },
                      { cel1: "" }],

                      schema: {
                        model: {
                          id: "data",
                          fields: [{ field: "cel1" }, { field: "cel2" }]
                        }
                      }
                    });

                    var MultiSearchGrid = dews.ui.grid("#MultiSearchGrid", {
                      dataSource: gridDataSource,
                      selectable: true,
                      editable: true,
                      sortable: true,
                      checkable: false,
                      height: 198,
                      autoBind: true,
                      columns: [
                      {
                        field: "cel1",
                        title: "검색어",
                        width: 200,
                        align: "left",
                        editor: {
                          maxLength: 20
                        }
                      },
                      {
                        field: "cel2",
                        title: "삭제",
                        width: 40,
                        editor: {
                          editable: false,
                          type: "button",
                          buttonWidth: 25,
                          buttonHeight: 20,
                          basicImg:
                          "data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAABUAAAAVBAMAAABbObilAAAAKlBMVEWoqKiqqqqnp6etra3z8/P7+/v+/v739/empqZwcHDl5eXZ2dmzs7PBwcHMPIVjAAAABHRSTlPeHh0fEcRHowAAAIFJREFUCNdjUOiAggYBBq40KMhiYGiDsdMaGFpTYQDIDoUBCPvmzKtw9lQgBLPDI2eCQGh4A0N7afl0d3f36eXlQHZ5+ZRTp05NLw8Hs2d1d3fBxLGyW0pcZgHVT3EpAbJdXKa4gDGQ7e5yE2j8FXcXsDgU4GZzw5jeDAwCcP8aAADdzmKDaT6/oAAAAABJRU5ErkJggg==",
                          hoverImg:
                          "data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAMAAACeyVWkAAAAM1BMVEWPj4/09PSMjIzl5eX39/fd3d3h4eGLi4uQkJCMjIzp6ent7e1wcHDx8fGmpqbHx8fX19eMjBmMAAAACnRSTlPe////////HR4fcliPtwAAAIhJREFUGNN1kQEKAyEMBPf0tO0lav7/2ibRs0XbWQLuEEQQD4QVPAE5VwQI505AOHa6LcuoLQ41Zm79XMySh8dY1BJp/aCVuiViujwuzV4G5yqazN7cktpUm0bY29yVaftuNKb1Nm3ye79s1nBMHvamNiuxjtdWa3nYSbxt2vln0VYnDfj1b683jr4LroIb1qgAAAAASUVORK5CYII=",
                          clickImg:
                          "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVBAMAAABbObilAAAAMFBMVEWPj4+MjIyPj4/w8PDf39/j4+Pz8/Pn5+fr6+uMjIzb29twcHDHx8egoKCtra3V1dXVQrZ9AAAAA3RSTlPfHt1QgCdlAAAAoklEQVQI12MQmgkFEwQYeFZBwRoFhlkw9qoJDFO8XFxcwBjIdoEBCPv17idg9lRXV9etQOgaCmSHRu8GgVAwO3QrSArMLi/d9f79q+2l5RMYppeX77pz5/72cjj7Fpg9o6ICxN5RUQFkd3Rsff/+yY6ODjAbKFYBZk82tjgNNP6wsTGQbWHcbGxs3GHcDBKHgQkM08xgYAIDfxoU5CswIPkXAKEScVDDI9PaAAAAAElFTkSuQmCC",

                          click: function click(e) {
                            MultiSearchGrid.removeRow(e.row.index);
                          }
                        }
                      }],

                      pasting: function pasting(e) {
                        var startIndex = e.start.index;
                        var copyParams;
                        var userOS = navigator.userAgent;
                        var copyParamsLen = 0;

                        if (userOS.indexOf("Macintosh") != -1) {
                          //맥PC인 경우
                          copyParams = e.copyData[0];

                          if (copyParams.length >= 1) {
                            if (copyParams.toString().match(/\n/g) == null) {
                              //1건 복사 붙여넣기시
                              copyParamsLen = 1;
                            } else {
                              copyParamsLen =
                              e.copyData[0].toString().match(/\n/g).length + 1;
                            }
                          }
                        } else {
                          copyParams = e.copyData;
                          copyParamsLen = copyParams.length;
                        }

                        if (startIndex + copyParamsLen > 50) {
                          dews.alert("멀티검색은 50건까지 지원합니다");
                          e.preventDefault();
                        }
                      }
                    });

                    //스타일지정
                    $(".dews-ui-referbox").css({
                      border: "1px solid #d0d7dd",
                      "background-color": "#e8eff4"
                    });

                    $(".dews-referbox-title").css({
                      padding: "7px 0 10px 20px",
                      color: "#3f5675",
                      top: "10px",
                      "font-size": "12px",
                      background:
                      "url(data:image/svg+xml;base64,PHN2ZyBpZD0iaWNvX2luZm9fcmVmZXIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ij4KICAgIDxkZWZzPgogICAgICAgIDxzdHlsZT4KICAgICAgICAgICAgLmNscy0xe2ZpbGw6IzZmODE5Y30KICAgICAgICA8L3N0eWxlPgogICAgPC9kZWZzPgogICAgPHBhdGggaWQ9Iuu5vOq4sF8zIiBkYXRhLW5hbWU9Iuu5vOq4sCAzIiBjbGFzcz0iY2xzLTEiIGQ9Ik04IDE2YTggOCAwIDEgMSA4LTggOC4wMDggOC4wMDggMCAwIDEtOCA4ek04IDFhNyA3IDAgMSAwIDcgNyA3LjAwOCA3LjAwOCAwIDAgMC03LTd6Ii8+CiAgICA8cGF0aCBpZD0i7ZWp7LmY6riwXzIxIiBkYXRhLW5hbWU9Iu2Vqey5mOq4sCAyMSIgY2xhc3M9ImNscy0xIiBkPSJNMCA4VjdoLjk3MVY0SDBWM2gyLjkxdjRoLjk3djF6bS45NzEtNlYwSDIuOTF2MnoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDYgNCkiLz4KPC9zdmc+Cg==)",
                      "background-repeat": "no-repeat",
                      "background-position-y": "9px"
                    });

                    $(".dews-referbox-content").css({
                      "background-color": "#eff5f9",
                      padding: "12px 0px 12px 15px"
                    });

                    $(".dews-ui-referbox button").css({
                      background:
                      "url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNSIgaGVpZ2h0PSIxNSI+CiAgICA8ZyBzdHlsZT0ib3BhY2l0eTouNCI+CiAgICAgICAgPHBhdGggZD0iTTkyLjE0MiAyNS44MzQgODYuNSAyMC4yMjZsLTUuNjQzIDUuNjA4YS41LjUgMCAwIDEtLjctLjdsNS44NC01LjhhLjQ4Mi40ODIgMCAwIDEgLjExOC0uMTg3QS40OTQuNDk0IDAgMCAxIDg2LjUgMTlhLjUuNSAwIDAgMSAuMzg3LjE0NC40OTIuNDkyIDAgMCAxIC4xMTkuMTlsNS44MzkgNS44YS41LjUgMCAwIDEgMCAuNy41LjUgMCAwIDEtLjM1My4xNDQuNS41IDAgMCAxLS4zNS0uMTQ0eiIgdHJhbnNmb3JtPSJyb3RhdGUoMTgwIDQ3LjAwNSAxNSkiIHN0eWxlPSJvcGFjaXR5Oi44Ii8+CiAgICA8L2c+Cjwvc3ZnPgo=)",
                      "background-repeat": "no-repeat",
                      "background-position-y": "-5px"
                    });

                    $(".dews-ui-referbox").
                    find("button").
                    on("click", function () {
                      if ($(".dialog").last()[0].clientHeight > 460) {
                        $(".dialog").last().css("height", 352);
                        $(".dews-ui-referbox button").css({
                          background:
                          "url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNSIgaGVpZ2h0PSIxNSI+CiAgICA8ZyBzdHlsZT0ib3BhY2l0eTouNCI+CiAgICAgICAgPHBhdGggZD0iTTkyLjE0MiAyNS44MzQgODYuNSAyMC4yMjZsLTUuNjQzIDUuNjA4YS41LjUgMCAwIDEtLjctLjdsNS44NC01LjhhLjQ4Mi40ODIgMCAwIDEgLjExOC0uMTg3QS40OTQuNDk0IDAgMCAxIDg2LjUgMTlhLjUuNSAwIDAgMSAuMzg3LjE0NC40OTIuNDkyIDAgMCAxIC4xMTkuMTlsNS44MzkgNS44YS41LjUgMCAwIDEgMCAuNy41LjUgMCAwIDEtLjM1My4xNDQuNS41IDAgMCAxLS4zNS0uMTQ0eiIgdHJhbnNmb3JtPSJyb3RhdGUoMTgwIDQ3LjAwNSAxNSkiIHN0eWxlPSJvcGFjaXR5Oi44Ii8+CiAgICA8L2c+Cjwvc3ZnPgo=)",
                          "background-position-y": "-5px"
                        });
                      } else {
                        $(".dialog").last().css("height", 472);
                        $(".dews-ui-referbox button").css({
                          background:
                          "url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNSIgaGVpZ2h0PSIxNSI+CiAgICA8ZyBzdHlsZT0ib3BhY2l0eTouNCI+CiAgICAgICAgPHBhdGggZD0iTTExLjc2NiA2LjgzNCA2LjI5MyAxLjIyNy44MiA2LjgzNGEuNDc0LjQ3NCAwIDAgMS0uNjggMCAuNTA4LjUwOCAwIDAgMSAwLS43TDUuOC4zMzJhLjQ4NS40ODUgMCAwIDEgLjExOS0uMTg3QS40NzEuNDcxIDAgMCAxIDYuMjkzIDBhLjQ3Ni40NzYgMCAwIDEgLjM3NS4xNDQuNS41IDAgMCAxIC4xMTYuMTlsNS42NjQgNS44YS41MDguNTA4IDAgMCAxIDAgLjcuNDc5LjQ3OSAwIDAgMS0uMzQyLjE0NC40NzQuNDc0IDAgMCAxLS4zNC0uMTQ0eiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLjk3MSA0KSIgc3R5bGU9Im9wYWNpdHk6LjgiLz4KICAgIDwvZz4KPC9zdmc+Cg==)",
                          "background-position-y": "-5px"
                        });
                      }
                    });

                    self.$addRowBtn.on("click", function (e) {
                      if (MultiSearchGrid.dataSource.dataProvider.getRowCount() < 50) {
                        MultiSearchGrid.addRow();
                      } else {
                        dews.alert("멀티검색은 50건까지 지원합니다");
                      }
                    });

                    self.buttons.ok.on("click", function (e) {
                      var dataSet = MultiSearchGrid.dataItems();
                      var fieldDatas = "";
                      var multiSearchObj = {
                        multiSearchGbn: "Y"
                      };
                      var rowCount = 0;

                      for (var i = 0; i < dataSet.length; i++) {
                        if (dataSet[i].cel1 != undefined && dataSet[i].cel1 != "") {
                          fieldDatas += dataSet[i].cel1 + ",";
                          rowCount++;
                        }
                      }
                      fieldDatas = fieldDatas.replace(/,\s*$/, ""); //마지막 콤마 제거

                      var fieldDataObj = {
                        datas: fieldDatas
                      };
                      var sendParams = $.extend(multiSearchObj, fieldDataObj);

                      //50건 이하 제한
                      if (rowCount > 0 && rowCount <= 50) {
                        self.ok(sendParams);
                      } else {
                        dews.alert("데이터가 비어있거나 검색어가 50개 이상입니다");
                        return 0;
                      }
                    });
                  });
                },

                ok: function ok(data) {
                  $.extend(self.params, { keyword: data.datas }, { multi_srch_use_yn: "Y" });
                  var apiUrlName = self.code;

                  dews.api.
                  post("/api/CM/codehelp/CodeHelpDataService/" + apiUrlName, {
                    data: self.params
                  }).
                  done(function (dataSource) {
                    var codeFieldValue = $(self.$target[0]).attr("data-dews-code-field");
                    var checkedObj = $("#code_grid").data("dews-control").getCheckedRows(); //기존 체크된 객체
                    var resultObj = checkedObj.concat(dataSource); //체크객체에 데이터 결과 객체 병합
                    var sendObj = [];
                    var codeFieldArr = [];

                    for (var i = 0; i < resultObj.length; i++) {
                      if (codeFieldArr.indexOf(resultObj[i][codeFieldValue]) == -1) {
                        //중복이 아닌경우
                        codeFieldArr.push(resultObj[i][codeFieldValue]);
                        sendObj.push(resultObj[i]);
                      }
                    }

                    $("#code_grid").data("dews-control").dataSource.data(sendObj);

                    var checkArr = [];
                    for (
                    var _i2 = 0;
                    _i2 <
                    $("#code_grid").
                    data("dews-control").
                    dataSource.dataProvider.getRowCount();
                    _i2++)
                    {
                      checkArr.push(_i2);
                    }
                    $("#code_grid").data("dews-control").setCheck(checkArr, true);
                  });
                }
              });
              dialog2.open();
            }
          });

          var contextMenu = $("#contextmenu").data("kendoContextMenu");

          if (contextMenu) {
            contextMenu.append([
            {
              cssClass: "multi",
              text: "멀티검색"
            }]);

          }

          $("#contextmenu .multi").on("mouseover", function () {
            $("#contextmenu .multi").css("background-color", "#eeeeee");
          });

          $("#contextmenu .multi").on("mouseleave", function () {
            $("#contextmenu .multi").css("background-color", "#FFF");
          });
        } else {
          intervalCount++;
        }
      } else {
        clearInterval(interval);
      }
    }, 500);
  };

  $(document).ready(function () {
    // 코드피커에서 생성된 이벤트들의 처리를 담당한다.

    // 코드도움 데이터 요청에 대한 설정은 이벤트 객체에 함께 들어오므로 그 정보로 AJAX 요청을 수행한다..
    $(document).on("codesearch", ".dews-ui-codepicker, .dews-ui-grid, .dews-ui-treegrid", function (e) {
      var code = e.code || "", // 코드도움 코드
        params = e.params || {}, // 코드도움 요청을 위한 파라미터
        custom = e.custom,
        url = e.apiUrl, // 코드도움 사용자 정의 데이터 URL
        callback = e.callback, // 데이터를 설정하는 콜백 함수
        $target = $(e.target), // 이벤트를 발생시킨 엘리먼트(코드피커 컨트롤 외)
        ajax,
        data;

      if ($.type(e.custom) === "boolean" && e.custom && $.type(e.helpApiUrl) !== "undefined") {
        url = e.helpApiUrl;
      }

      if ($(e.target).closest(".dews-data-control").length === 1) {
        if ($.type(e.callback) === "undefined") {
          callback = e.callbacks;
        }
      }

      // AJAX로 데이터를 요청
      if (code) {
        ajax = new CodeHelpAjax(code, params, custom, url);

        // AJAX 로 데이터 요청을 시작했다는 이벤트를 발생시킨다.
        // 컨트롤에서 이벤트로 로딩처리 등을 수행합니다.
        $target.trigger("ajaxstart");

        if (url) {
          dews.ui.loading.show();
        }
        ajax.getCodeData().
        done(function (data) {
          // 서버에서 가져온 데이터를 요청 컨트롤에 전달
          if (data && data.data) {
            dews.log("## dews-ui-codehelp: 코드 데이터 ##\n" + JSON.stringify(data.data));

            if (typeof callback === "function") {
              callback.call(e.target, data.data);
            }
          } else if (data.state === "error") {
            if (typeof callback === "function") {
              callback.call(e.target);
            }
          }
        }).
        fail(function () {
          // 서버 오류가 발생했거나 요청이 실패했을 경우
          $target.trigger("ajaxerror");
        }).
        always(function () {
          // AJAX 데이터 요청이 끝났음을 해당 컨트롤에 알려줍니다.
          $target.trigger("ajaxcomplete");
          dews.ui.loading.hide();
        });
      }
    });

    // 코드 도움 다이얼로그 오픈 이벤트 처리
    $(document).on(
    "codedialog",
    ".dews-ui-codepicker, .dews-ui-multicodepicker, .dews-ui-grid, .dews-ui-treegrid",
    function (e) {
      var code = e.code || "",
        size = e.size || "medium",
        params = e.params || {},
        title = e.title || "",
        mode = e.mode || "single",
        width = e.width,
        height = e.height,
        initData = e.initData,
        callback = e.callback,
        custom = e.custom,
        viewUrl = e.viewUrl,
        dialog,
        codeHelpId,
        convert,
        $target = $(e.target);

      if ($.type(e.custom) === "boolean" && e.custom && $.type(e.helpViewUrl) !== "undefined") {
        viewUrl = e.helpViewUrl;
      }

      if (code && viewUrl) {
        dews.ui.loading.show();
      }

      if (custom) {
        var arr = viewUrl.split("/");
        codeHelpId = arr[arr.length - 1];
      } else {
        codeHelpId = code;
      }

      // 도움창 변환
      try {
        dews.api.
        get(dews.url.getApiUrl("CM", "CodeHelpVerifyService", "getCodeHelpVerifyInfo"), {
          data: {
            codeHelpId: codeHelpId,
            moduleCd: dews.ui.page && dews.ui.page.menu ? dews.ui.page.menu.module : ""
          },
          async: false
        }).
        done(function (data) {
          convert = data.conv_yn === "Y";
          if (convert) {
            var id = data.conv_hwnd_id.split(" ").join("");
            var module = data.module_cd;
            code = id;
            custom = data.hwnd_tp_cd === "C";
            title = data.hwnd_nm || title;
            size = data.hwnd_size_cd || size;

            if (custom) {
              // 커스텀 도움창
              viewUrl = "~/codehelp/" + module + "/" + id;
            }
          } else {
            //멀티검색 활성화
            if (data.multi_srch_use_yn == "Y") {
              multiSearchGbn = true;
            }
          }
        }).
        fail(function (data) {
          throw data.responseJSON.message;
        });
      } catch (e) {
        console.log(e);
      }

      if ($(e.target).closest(".dews-data-control").length === 1) {
        if ($.type(e.callback) === "function") {
          var grid = $(e.target).closest(".dews-data-control").data("dews-control");
          var customCallback = e.callback;
          callback = function callback(e) {
            customCallback.apply(grid, arguments);

            var codeOption = grid.columns[grid.getCurrentColumn()].codeOption;
            if (codeOption.validation) {
              var _code = e[codeOption.codeField];
              var text = e[codeOption.textField];
              var value = grid._grid.getValue(
              grid._grid.getCurrent().itemIndex,
              grid.getCurrentColumn());

              codeOption.value[grid._grid.getCurrent().itemIndex] = dews.ui.gridUtil._codeOptionValue(
              _code,
              text,
              value);

            }
            delete codeOption.codesearch;
            if (codeOption.moveFocus) {
              dews.ui.gridUtil.nextFocus(grid, grid._grid.getCurrent());
            }
          };
        } else {
          callback = e.callbacks;
        }
      }

      if (code) {
        switch (size.toUpperCase()) {
          case "SMALL":
            width = width || 360;
            height = height || 397;
            size = "small";
            break;
          case "LARGE":
          case "BIG":
            width = width || 746;
            height = height || 537;
            size = "large";
            break;
          case "EXTRA":
          case "LARGEBIG":
            width = width || 818;
            height = height || 630;
            size = "large";
            break;
          default:
            width = width || 560;
            height = height || 537;
            size = "medium";
            break;}

      }

      if (e.isDefaultPrevented()) {
        dews.ui.loading.hide();
        return;
      }

      var data = {
        code: code,
        codeField: e.codeField || "",
        params: params,
        title: title,
        mode: mode,
        width: width,
        height: height,
        initData: initData,
        custom: custom,
        viewUrl: viewUrl,
        $target: $target
      };

      dialog = new CodeHelpDialog(data);

      $.extend(true, dews, {
        ui: {
          codehelp: {
            setKeyboardNavigation: function setKeyboardNavigation(textbox, grid, dialog) {
              textbox.on("keydown", function (e) {
                e.stopPropagation();
                if (e.keyCode === 13) {
                  grid.dataSource.read();
                  grid.setFocus();
                } else if (e.keyCode === 27) {
                  if ($("#contextmenu").length > 0) {
                    $("#contextmenu").remove();
                  }
                  dialog.close();
                }
              });

              grid._grid.onKeyDown = function (_grid, key) {
                e.stopPropagation();
                if (key === 13) {
                  if (dialog.getInitData().mode === "multi") {
                    dialog.ok(grid.getCheckedRows());
                  } else {
                    dialog.ok(grid.dataItem(grid.select()));
                  }
                } else if (key === 27) {
                  dialog.close();
                }
              };

              dialog.$content.on("keydown", function (e) {
                e.stopPropagation();
                if (e.keyCode === 13) {
                  if (dialog.getInitData().mode === "multi") {
                    dialog.ok(grid.getCheckedRows());
                  } else {
                    dialog.ok(grid.dataItem(grid.select()));
                  }
                }
              });
            }
          }
        }
      });
      dialog.open(callback);
    });

  });
})(jQuery, window.dews, window.kendo);


/**
 * 코드 도움 에디터
 */
(function ($, dews) {
  // 기본 옵션 값
  var defaultOptions = {
    useButton: true, // 찾기 버튼의 사용 여부
    useKeyword: true, // 검색어 입력을 받는지 여부
    codeField: "code", // 검색 결과에서의 코드 필드명
    textField: "text", // 검색 결과에서의 텍스트 필드명
    useAjax: true, // 도움창 오픈 전 AJAX를 통해서 먼저 확인할 지 여부
    helpCode: null, // 도움창의 아이디 및 코드 도움 요청 코드
    helpSize: "medium", // 도움창의 코드 타입
    helpParams: null, // 코드 도움 및 도움창 요청에 추가적으로 필요한 파라미터
    helpTitle: "", // 도움창의 타이틀
    helpCustom: false, // 사용자 정의 도움창 사용 여부
    helpViewUrl: "", // 도움창 View URL (생략시 도움창 View URL을 자동 생성)
    helpApiUrl: "", // 도움창 Data URL (생략시 도움창 Data URL을 자동 생성)
    helpWidth: null, // 도움창 기본 너비
    helpHeight: null, // 도움창 기본 높이
    moveFocus: true, // 코드피커 값 설정 후 패널에서 포커스 넘어갈것인지 여부
    autocomplete: false, // 자동완성 사용 여부
    blockTyping: false //코드피커 키보드 입력 방지 여부
  };

  /**
   * 코드피커 요소에 지정되어 있는 코드 도움 추가 파라미터를 객체로 가져옵니다.
   * @param $element 코드피커 요소의 jQuery 객체
   * @returns {object} QueryString형태로 지정된 코드 도움 파라미터를 객체로 변경한 것
   */
  function getHelpParams($element) {
    var str = $element.data("dews-help-params"),
      data = defaultOptions.helpParams;

    if (str) {
      data = $.deparam(str);
    }

    return data;
  }

  /**
   * 코드피커를 생성하기 위한 클래스
   * @param {HTMLElement} element 코드피커 요소
   * @param {object} options 코드피커 옵션
   * @constructor
   */
  var CodePicker = function CodePicker(element, options) {
    var self = this,
      $element = $(element);
    var inlineOptions;

    inlineOptions = getInlineOptions($element, defaultOptions);

    self.options = $.extend(true, {}, defaultOptions, inlineOptions, options);

    self._element = element;
  };

  function getInlineOptions($element, defaultOptions) {
    var options = {};

    // 자동완성 기능 사용 여부(data-dews-autocomplete 또는 html 속성 autocomplete 둘 다 사용 가능 - 둘 다 설정했을 경우 data-dews-autocomplete가 적용됨)
    var autocomplete = false;
    if ($element.data("dews-autocomplete")) {
      autocomplete = true;
    } else if (
    typeof $element.data("dews-autocomplete") === "undefined" &&
    typeof $element.attr("autocomplete") === "undefined")
    {
      autocomplete = false;
    } else if (
    typeof $element.data("dews-autocomplete") === "undefined" && (
    $element.attr("autocomplete") === "on" || typeof $element.attr("autocomplete") === "undefined"))
    {
      autocomplete = true;
    }
    var inlineData = {
      useButton: $element.data("dews-use-button") || defaultOptions.useButton,
      useKeyword: $element.data("dews-use-keyword") || defaultOptions.useKeyword,
      codeField: $element.data("dews-code-field") || defaultOptions.codeField,
      textField: $element.data("dews-text-field") || defaultOptions.textField,
      useAjax: $element.data("dews-ajax"),
      helpCode: $element.data("dews-help-code") || defaultOptions.helpCode,
      helpSize: $element.data("dews-help-size") || defaultOptions.helpSize,
      helpParams: getHelpParams($element),
      helpTitle:
      dews.localize.get(
      $element.data("dews-help-title"),
      $element.data("dews-localize-key"),
      $element.data("dews-localize-lang") || null) ||
      defaultOptions.helpTitle,
      helpCustom: $element.data("dews-help-custom") || defaultOptions.helpCustom,
      helpViewUrl: $element.data("dews-help-view-url") || defaultOptions.helpViewUrl,
      helpApiUrl: $element.data("dews-help-api-url") || defaultOptions.helpApiUrl,
      helpWidth: $element.data("dews-help-width") || defaultOptions.helpWidth,
      helpHeight: $element.data("dews-help-height") || defaultOptions.helpHeight,
      moveFocus:
      $.type($element.data("dews-move-focus")) === "boolean" ?
      $element.data("dews-move-focus") :
      defaultOptions.moveFocus,
      autocomplete: autocomplete,
      blockTyping: $element.data("dews-block-typing") === true ? true : defaultOptions.blockTyping
    };

    options = $.extend(true, options, defaultOptions, inlineData);

    return options;
  }

  /**
   * 시용자 가이드를 위한 API 를 추가합니다.
   * @param $element 대상 jQuery 요소
   */
  function setUserGuideAPI($element) {
    $element.on("focus", function () {
      if (dews.ui.page && dews.ui.page.hasUserGuide) {
        if ($.isFunction(dews.ui.page.focusGuideItem) && $element.siblings(".dews-ui-codepicker").attr("id")) {
          dews.ui.page.focusGuideItem("#" + $element.siblings(".dews-ui-codepicker").attr("id"));
        }
      }
    });
  }

  /**
   * 코드피커의 외부 컨테이너를 생성합니다.
   * @private
   */
  CodePicker.prototype._createContainer = function () {
    var $element = $(this._element);
    var $wrapper = $("<span />").addClass("dews-codepicker-wrapper dews-control k-textbox");

    copyStyle($wrapper, $element);

    // 상태 클래스 추가
    if ($element.prop("readonly") || $element.hasClass("readonly")) {
      $element.addClass("readonly");
      $element.prop("readonly", true);
    }

    if ($element.prop("disabled") || $element.hasClass("disabled")) {
      $element.addClass("disabled");
      $element.prop("disabled", true);
    }

    dispatchClassToWrapper("readonly");
    dispatchClassToWrapper("disabled");
    dispatchClassToWrapper("required");
    dispatchClassToWrapper("etc1");
    dispatchClassToWrapper("etc2");
    dispatchClassToWrapper("etc3");

    if ($element.attr("id")) {
      $wrapper.attr("id", $element.attr("id") + "-wrapper");
    }

    $element.wrap($wrapper);

    if (!$element.hasClass("dews-ui-codepicker")) {
      $element.addClass("dews-ui-codepicker");
    }

    if (!$element.attr("name") && $element.attr("id")) {
      // 코드피커 요소에 id는 지정되어 있는데 name이 지정되어 있지 않으면 name을 id와 동일하게 설정한다.
      $element.attr("name", $element.attr("id"));
    }

    function dispatchClassToWrapper(className) {
      if ($element.hasClass(className)) {
        $wrapper.addClass("dews-state-".concat(className));
      }
    }
  };

  /**
   * targetElement에 styledElement의 style을 적용합니다.
   * @param $targetElement
   * @param $styledElement
   */
  function copyStyle($targetElement, $styledElement) {
    $targetElement.attr("style", getStyles($styledElement));
  }

  function getStyles($element) {
    return $element.attr("style");
  }

  /**
   * 코드피커의 찾기 버튼을 생성합니다.
   * @private
   */
  CodePicker.prototype._createButton = function () {
    var self = this,
      $el = $(self._element),
      $wrapper = $el.parent(".dews-codepicker-wrapper"),
      $button;

    if (self.options.useButton === true && $el.prop("readonly") === false && $el.prop("disabled") === false) {
      // 찾기 버튼은 옵션에서 useButton이 설정되어 있고, 대상 컨트롤이 readonly가 아니어야 합니다.
      if (!$wrapper.hasClass("k-space-right")) {
        $wrapper.addClass("k-space-right");
      }

      if ($wrapper.find("button.dews-codepicker-button").length === 0) {
        $button = $('<button type="button"><span class="dews-icon icon-search"></span></button>').addClass(
        "dews-codepicker-button");


        // 대상 요소의 뒤에 버튼을 추가
        $el.after($button);

        $button.on("click", function (e) {
          // 찾기 버튼 클릭에 대한 이벤트 발생
          var keyword, $text;

          $text = $(".dews-codepicker-text", $wrapper);
          keyword = $text.val();

          self._triggerCodeDialog(keyword, null);
        });
      }
    }
  };

  /**
   * 코드피커의 찾기 버튼을 제거합니다.
   * @private
   */
  CodePicker.prototype._removeButton = function () {
    var self = this,
      $el = $(self._element),
      $wrapper = $el.parent(".dews-codepicker-wrapper"),
      $button = $wrapper.find("button.dews-codepicker-button");

    if (self.options.useButton && $button.length > 0) {
      $wrapper.removeClass("k-space-right"); // 래퍼에서 우측 버튼 클래스를 제거한다.
      $button.remove(); // 버튼을 제거한다.
    }
  };

  /**
   * 코드 정보를 보관할 메인 텍스트박스 엘리먼트에 추가적인 부분을 꾸밉니다.
   * @private
   */
  CodePicker.prototype._decorateCodeElement = function () {
    var self = this,
      $el = $(self._element);

    $el.addClass("dews-codepicker-code");
    $el.css("display", "none");
  };

  /**
   * 텍스트 출력 및 검색 값 입력을 위한 엘리먼트를 생성해서 추가합니다.
   * @private
   */
  CodePicker.prototype._createTextElement = function () {
    var self = this,
      $el = $(self._element),
      $wrapper = $el.parent(".dews-codepicker-wrapper"),
      $text,
      text_id;

    text_id = $el.attr("id") + "_text";
    $text = $('<input type="text" />').
    attr("id", text_id).
    prop("readonly", $el.prop("readonly")).
    prop("disabled", $el.prop("disabled")).
    addClass("dews-codepicker-text");

    // autocomplete 설정
    if (self.options.autocomplete) $text.attr("autocomplete", "on");else
    $text.attr("autocomplete", "off");

    if (!self.options.useKeyword) {
      $text.prop("readonly", true);
    }

    if (self.options.blockTyping) {
      $text.prop("readonly", true);
    }

    // 포커스를 받았을 때 외부 컨테이너에 포커스 효과를 주기 위한 처리
    $text.
    on("focus", function () {
      $wrapper.addClass("dews-codepicker-wrapper-focused");
    }).
    on("blur", function () {
      $wrapper.removeClass("dews-codepicker-wrapper-focused");
    });

    // 텍스트용 input을 추가한다.
    $el.after($text);
  };

  /**
   * 컨트롤에 설정된 기본 코드 및 텍스트를 적용합니다.
   * @private
   */
  CodePicker.prototype._setDefaultData = function () {
    var self = this,
      $el = $(self._element),
      code,
      text,
      data;

    code = $el.data("code") || "";
    text = $el.data("text") || "";

    data = {};
    data[self.options.codeField] = code;
    data[self.options.textField] = text;

    self.setData(data);
  };

  /**
   * 코드피커의 코드나 텍스트가 변경되어 정보가 유효하지 않다는 표시를 추가합니다.
   * @private
   */
  CodePicker.prototype._setDirtyFlag = function () {
    var self = this,
      $el = $(self._element),
      $wrapper = $el.parent(".dews-codepicker-wrapper");

    $wrapper.addClass("dews-dirty-data");
  };

  /**
   * 코드피커의 코드나 텍스트 정보가 유효하지 않다는 표시를 제거합니다.
   * @private
   */
  CodePicker.prototype._removeDirtyFlag = function () {
    var self = this,
      $el = $(self._element),
      $wrapper = $el.parent(".dews-codepicker-wrapper"),
      $text = $(".dews-codepicker-text", $wrapper);

    $wrapper.removeClass("dews-dirty-data");
  };

  CodePicker.prototype._setTooltip = function ($text) {
    var self = this;
    var $item = $(self._element);

    self._tooltip = dews.ui.tooltip.show($item, {
      type: "normal",
      text: $text.attr("data-original-title"),
      fadeOutTime: 0
    });
  };

  /**
   * 코드피커에 이벤트들을 등록합니다.
   * @private
   */
  CodePicker.prototype._bindEvents = function () {
    var self = this,
      $btn,
      $el = $(self._element),
      $wrapper = $el.parent(".dews-codepicker-wrapper"),
      $text = $(".dews-codepicker-text", $wrapper),
      helpEvent,
      keyword;

    // 입력 텍스트박스(temp)에 대한 이벤트 바인딩
    $text.
    on("keyup", function (e) {
      var $this = $(this),
        isDirty = false;

      if ($this.prop("readonly") === false && $this.prop("disabled") === false) {
        // 키보드 키 입력 처리
        var key = e.keyCode || e.which;
        if (key !== 13 && key !== 115) {
          // 엔터키 제외
          // 텍스트가 변경되면 컨트롤의 Dirty 플래그를 변경한다.
          isDirty = $this.val() !== $el.data("text");

          if (isDirty) {
            if ($this.val() === "") {
              // 텍스트박스(temp)의 내용을 전부 지우면 코드피커의 데이터를 초기화합니다.
              self.clearData();
            } else {
              self._setDirtyFlag();
            }
          } else {
            self._removeDirtyFlag();
          }
        }
      }
    }).
    on("keydown", function (e) {
      if (this.hasOwnProperty("readonly") || this.hasOwnProperty("disabled")) {
        return;
      }

      if ((e.key === "Tab" || e.keyCode === 9) && e.shiftKey) {
        e.preventDefault();
        self.previousFocus();
      } else if ((e.key === "Enter" || e.keyCode === 13) && (e.shiftKey || e.ctrlKey || e.altKey)) {//13
        e.preventDefault();
      } else if (e.key === "Enter" || e.keyCode === 13) {
        onEnterKeyDown(e, self);
      } else if (e.key === "Tab" || e.keyCode === 9) {
        e.preventDefault();
        onTabKeyDown(e, self);
      }

      if (e.key === "F4" || e.keyCode === 115) {
        $btn = $(".dews-codepicker-button", $wrapper);

        // F4 - 도움창 띄우기 단축키
        e.preventDefault();
        if ($btn.is(":visible:enabled")) {
          // 버튼이 활성화 되어 있을 경우가 도움창 띄우기가 가능한 경우
          e.stopPropagation();
          $btn.click(); // 버튼 클릭 이벤트와 동일한 작업이 필요하므로 버튼 클릭 이벤트를 발생
        }
      }
      if (e.key === "Backspace" || e.keyCode === 8) {
        // 백스페이스, 데이터를 전체 지움과 동시에 빠르게 조회를 했을 경우 발생하는 케이스를 위해 (이 상황에는 keyup보다 메인조회버튼 클릭이 먼저 발생해서 keydown에서 처리)
        var keyword = e.target.value;
        var selection = window.getSelection().toString();

        if (keyword === selection) {
          // 입력되어있는 키워드와 셀렉션되어있는 부분이 동일하면(전체 지움일 때)
          self.clearData();
        }
      }
    }).
    on("dblclick", function (e) {
      var $this = $(this);

      // 기본 이벤트 실행 및 이벤트 전파를 무효화 시킵니다.
      e.preventDefault();
      e.stopPropagation();

      if ($this.prop("readonly") === false && $this.prop("disabled") === false) {
        // 마우스 더블클릭으로 텍스트 전체가 선택되는 현상을 막습니다.
        if (this.setSelectionRange) {
          this.setSelectionRange($this.val().length, $this.val().length);
        }

        keyword = $this.val();

        // 마우스 더블클릭 => 도움창 띄우기
        self._triggerCodeDialog(keyword, null);
      }
    }).
    on("focus click", function () {
      // 포커스 이벤트를 이용할 경우 전체 선택 후 다시 선택이 해제되므로 클릭 이벤트에서 처리합니다.
      if ($(this).prop("readonly") === false && $(this).prop("disabled") === false) {
        // 읽기 전용이 아닐 경우에는 포커스가 오면 텍스트 전체를 선택합니다.
        $(this).select();
      }
    }).
    on("focus", function () {
      if (!$wrapper.hasClass("dews-state-focused")) {
        $wrapper.addClass("dews-state-focused");
      }
    }).
    on("blur", function (e) {
      if ($wrapper.hasClass("dews-state-focused")) {
        self.search(e.target.value);
        $wrapper.removeClass("dews-state-focused");
      }
    }).
    on("mouseover", function () {
      if ($text.attr("data-original-title")) {
        self._setTooltip($text);
      }
    }).
    on("mouseleave", function () {
      self._removeTooltip();
    });

    $el.on("codedialogclosed", function (e) {
      // 공통도움창에서 ESC키 혹은 close 시켰을 경우에만 발생하게 설정
      if (self.isDirty()) {
        if (self.code() === "" && self.text() === "") {
          self.clearData();
        } else {
          var data = {};
          data[$el.data("dews-code-field")] = self.code();
          data[$el.data("dews-text-field")] = self.text();
          self.setData(data);
        }
      }
      self.focus();
    });

    $el.on("setData", function () {
      self.focus();
    });
  };

  function onEnterKeyDown(event, codePicker) {
    var keyword = event.target.value;
    var previousKeyword = codePicker.text();
    if (hasTextChanged(keyword, previousKeyword)) {
      codePicker.onCompleteTyping(keyword);
    } else if (codePicker.hasOwnProperty("usePanelFocus") && codePicker.usePanelFocus) {
      codePicker.requiredCheck && codePicker.required() ?
      codePicker.validate() && codePicker.nextFocus() :
      codePicker.nextFocus();
    }
  }

  function onTabKeyDown(event, codePicker) {
    var keyword = event.target.value;
    var previousKeyword = codePicker.text();
    if (hasTextChanged(keyword, previousKeyword)) {
      codePicker.onCompleteTyping(keyword);
    } else {
      codePicker.nextFocus();
    }
  }

  function hasTextChanged(currentText, previousText) {
    return currentText && currentText !== previousText;
  }

  /**
   * 타이핑이 완료되었다고 판단하면 키워드를 검색하거나 다음 코드피커로 넘어갑니다.
   * 현재 입력된 키워드가 이전에 선택한 항목과 다를 때만 이벤트를 발생시킵니다.
   * @param {string} keyword
   * @private
   */
  CodePicker.prototype.onCompleteTyping = function (keyword) {
    this.canCodeSearch() ?
    this._triggerCodeSearch(keyword) :
    this._triggerCodeDialog(keyword, null);
  };

  /**
   * 코드피커의 툴팁을 제거합니다.
   */
  CodePicker.prototype._removeTooltip = function () {
    var self = this;

    if (self._tooltip) {
      self._tooltip._delete();
    }
  };

  /**
   * 코드피커 컨트롤을 활성화 시킵니다.
   * @private
   */
  CodePicker.prototype._activate = function () {
    var self = this,
      $el = $(self._element),
      $wrapper = $el.parent(".dews-codepicker-wrapper"),
      eChange;

    if (!$wrapper.hasClass("dews-control-activate")) {
      $wrapper.addClass("dews-control-activate");
    }
  };

  /**
   * 코드피커 AJAX 코드 찾기 이벤트를 발생시킵니다.
   * @param {string} [keyword] 검색어
   * @private
   */
  CodePicker.prototype._triggerCodeSearch = function (keyword) {
    var self = this,
      $el = $(self._element),
      helpEvent,
      params;

    if ($.isFunction(self.options.helpParams)) {
      params = self.options.helpParams.call(self);
    } else {
      params = self.options.helpParams;
    }

    helpEvent = new $.Event("codesearch", {
      code: self.options.helpCode,
      params: $.extend(true, {}, params, { keyword: keyword }),
      custom: self.options.helpCustom,
      apiUrl: self.options.helpApiUrl,
      callback: function callback(data) {
        // 데이터를 설정하는 콜백
        if (typeof data !== "undefined") {
          dews.log(
          "## dews-ui-codepicker: codesearch 이벤트 콜백함수 실행 ##\n" + "data: " + JSON.stringify(data));

          self.setData(data);

          // 그리드
          if (self.options._grid === true && $.type(self.options._gridCallback) === "function") {
            if ($.isArray(data) && data.length === 1) {
              self.options._gridCallback(data[0]);
            } else if ($.type(data) === "object") {
              self.options._gridCallback(data);
            }
          } else {
            if (data.length === 1) {
              self.nextFocus();
            }
          }
        }
      }
    });

    dews.log(
    "## dews-ui-codepicker: codesearch 이벤트 발생 ##\n" +
    "e.code: " +
    helpEvent.code +
    "\n" +
    "e.params: " +
    JSON.stringify(helpEvent.params));


    $el.trigger(helpEvent);
  };

  /**
   * 코드 도움 다이얼로그 이벤트를 발생시킵니다.
   * @param {string} [keyword] 검색어
   * @param {object|array} [initData] 초기화 데이터
   * @private
   */
  CodePicker.prototype._triggerCodeDialog = function (keyword, initData) {
    var self = this,
      $el = $(self._element),
      helpEvent,
      params;

    // PD1C-944 2021-11-26
    // 도움창환경설정등록에서 자동조회 여부 No 시, 코드피커에 값이 들어있으면 값이 조회되는 현상 수정
    // codepicker html 에 data-dews-clear-keyword 옵션 추가하여 처리
    // data-dews-clear-keyword 옵션 값을 받아와서 isClearKeyword 값에 따라 keyword 값 설정
    var isClearKeyword = false;
    if (!(typeof $el.data("dews-clear-keyword") === "undefined")) {
      isClearKeyword = JSON.parse($el.data("dews-clear-keyword"));
    }
    if (isClearKeyword) {
      keyword = "";
    }

    initData = initData || null;

    if ($.isFunction(self.options.helpParams)) {
      params = self.options.helpParams.call(self);
    } else {
      params = self.options.helpParams;
    }

    helpEvent = new $.Event("codedialog", {
      code: self.options.helpCode,
      size: self.options.helpSize,
      params: $.extend(true, {}, params, { keyword: keyword }),
      title: self.options.helpTitle,
      mode: "single",
      width: self.options.helpWidth,
      height: self.options.helpHeight,
      custom: self.options.helpCustom,
      viewUrl: self.options.helpViewUrl,
      initData: initData,
      callback: function callback(data) {
        // 데이터를 설정하는 콜백
        if (typeof data !== "undefined") {
          dews.log(
          "## dews-ui-codepicker: codesearch 이벤트 콜백함수 실행 ##\n" + "data: " + JSON.stringify(data));

          if ($.isArray(data)) {
            // 코드피커는 하나만 수용 가능하므로 코드도움 다이얼로그에서 최종 선택한 항목은 배열이 되면 안됨
            throw "두 개 이상의 항목을 코드피커에 설정할 수 없습니다.";
          } else {
            if (self.options._grid === true && $.type(self.options._gridCallback) === "function") {
              // 그리드에서의 호출일 경우
              // 그리드에서는 다이얼로그가 생성되면 코드피커는 사라지므로 데이터의 전달을 직접 그리드
              // 쪽으로 해주어야 함
              self.options._gridCallback(data);
            } else {
              self.setData(data);
              self._focusMove = true;
            }
          }
        }
      }
    });

    dews.log(
    "## dews-ui-codepicker: codedialog 이벤트 발생 ##\n" +
    "e.code: " +
    helpEvent.code +
    "\n" +
    "e.size: " +
    helpEvent.size +
    "\n" +
    "e.params: " +
    JSON.stringify(helpEvent.params) +
    "\n" +
    "e.title: " +
    helpEvent.title +
    "\n" +
    "e.mode: " +
    helpEvent.mode +
    "\n" +
    //'e.url: ' + helpEvent.url + '\n' +
    "e.width: " +
    helpEvent.width +
    "\n" +
    "e.height: " +
    helpEvent.height +
    "\n" +
    "e.initData: " +
    JSON.stringify(helpEvent.initData));


    $el.trigger(helpEvent);
  };

  /**
   * 코드피커를 작성합니다.
   * @private
   */
  CodePicker.prototype._render = function () {
    var self = this,
      $el = $(self._element);

    // 코드피커의 래퍼인 컨테이너를 생성합니다.
    self._createContainer();

    // 메인 엘리먼트를 꾸밉니다.
    self._decorateCodeElement();

    // 찾기 버튼을 생성합니다.
    self._createButton();

    // 입력 필드를 생성합니다.
    self._createTextElement();

    // 기본 데이터를 설정합니다.
    self._setDefaultData();

    // 이벤트를 셋팅합니다.
    self._bindEvents();

    setUserGuideAPI($(".dews-codepicker-text", $el.parent(".dews-codepicker-wrapper")));
  };

  /**
   * 컨트롤을 읽기 전용 상태로 만듭니다.
   * @private
   */
  CodePicker.prototype._setReadonly = function () {
    var self = this,
      $el = $(self._element),
      $wrapper = $el.parent(".dews-codepicker-wrapper"),
      $text = $(".dews-codepicker-text", $wrapper);

    if (!$wrapper.hasClass("dews-state-readonly")) {
      $wrapper.addClass("dews-state-readonly");
    }

    $el.prop("readonly", true); // code 컨트롤에 readonly를 설정

    if (!$el.hasClass("readonly")) {
      $el.addClass("readonly");
    }

    $text.prop("readonly", true); // text 컨트롤에 readonly를 설정
  };

  /**
   * 컨트롤의 읽기 전용 상태를 해제합니다.
   * @private
   */
  CodePicker.prototype._removeReadonly = function () {
    var self = this,
      $el = $(self._element),
      $wrapper = $el.parent(".dews-codepicker-wrapper"),
      $text = $(".dews-codepicker-text", $wrapper);

    if ($wrapper.hasClass("dews-state-readonly")) {
      $wrapper.removeClass("dews-state-readonly");
    }

    $el.prop("readonly", false); // code 컨트롤에서 reaodonly를 설정

    if ($el.hasClass("readonly")) {
      $el.removeClass("readonly");
    }

    $text.prop("readonly", false); // 텍스트 컨트롤에 readonly를 설정
  };

  /**
   * 컨트롤을 비활성화 상태로 만듭니다.
   * @private
   */
  CodePicker.prototype._setDisabled = function () {
    var self = this,
      $el = $(self._element),
      $wrapper = $el.parent(".dews-codepicker-wrapper"),
      $text = $(".dews-codepicker-text", $wrapper);

    if (!$wrapper.hasClass("dews-state-disabled")) {
      $wrapper.addClass("dews-state-disabled");
    }

    $el.prop("disabled", true);

    if (!$el.hasClass("disabled")) {
      $el.addClass("disabled");
    }

    $text.prop("disabled", true);
    self._removeTooltip();
  };

  /**
   * 컨트롤을 활성화 상태로 돌립니다.
   * @private
   */
  CodePicker.prototype._removeDisabled = function () {
    var self = this,
      $el = $(self._element),
      $wrapper = $el.parent(".dews-codepicker-wrapper"),
      $text = $(".dews-codepicker-text", $wrapper);

    if ($wrapper.hasClass("dews-state-disabled")) {
      $wrapper.removeClass("dews-state-disabled");
    }

    $el.prop("disabled", false);

    if ($el.hasClass("disabled")) {
      $el.removeClass("disabled");
    }

    $text.prop("disabled", false);
  };

  /**
   * 코드 피커를 읽기 전용 여부를 설정하거나 가져옵니다.
   * @param {boolean} [value] 읽기 전용으로 설정할 것인지 여부 (생략하면 현재 읽기전용 여부를 가져옵니다.)
   * @returns {boolean} 읽기전용 여부
   */
  CodePicker.prototype.readonly = function (value) {
    var self = this,
      $el = $(self._element),
      readonly;

    readonly = $el.prop("readonly");

    if (typeof value !== "undefined") {
      // 설정
      if (value === true) {
        self._removeButton();
        self._setReadonly();
        readonly = value;
      } else if (value === false) {
        self._removeReadonly();
        self._createButton();
        readonly = value;
      }
    }

    return readonly;
  };

  /**
   * 코드 피커의 활성화 여부를 설정하거나 가져옵니다.
   * @param {boolean} [value] 설정할 활성화 여부(생략하면 현재 활성화 여부를 반환합니다.)
   * @returns {boolean} 활성화 여부
   */
  CodePicker.prototype.enable = function (value) {
    var self = this,
      $el = $(self._element),
      enabled;

    enabled = !$el.prop("disabled");

    if (typeof value !== "undefined") {
      // 설정
      if (value === false) {
        self._removeButton();
        self._setDisabled();
      } else if (value === true) {
        self._removeDisabled();
        self._createButton();
      }
    } else {
      return enabled;
    }
  };

  /**
   * 코드피커의 visible 여부를 가져옵니다.
   * @returns {boolean}
   * @private
   */
  CodePicker.prototype._visibleCheckFromPanel = function () {
    var self = this,
      $ctrl = $(self._element),
      isVisible = $ctrl.closest(".dews-codepicker-wrapper").css("display") !== "none";

    return isVisible;
  };

  /**
   * 코드 피커의 필수 여부를 설정하거나 가져옵니다.
   * @param {boolean} [value] required 상태값
   */
  CodePicker.prototype.required = function (value) {
    var self = this;
    var $el = $(self._element);
    var $wrapper = $el.parent(".dews-codepicker-wrapper");

    if ($.type(value) === "undefined") {
      return $el.hasClass("required");
    } else if (value === true) {
      $el.addClass("required");
      $wrapper.addClass("dews-state-required");
    } else if (value === false) {
      $el.removeClass("required");
      $wrapper.removeClass("dews-state-required");
    }
  };

  /**
   * 코드 피커의 코드 도움 파라미터를 설정합니다.
   * @param {object|function} params 설정할 파라미터 객체 또는 함수
   */
  CodePicker.prototype.setHelpParams = function (params) {
    var self = this;

    self.options.helpParams = params;
  };

  /**
   * 코드피커에 코드와 텍스트를 설정합니다.
   * @param {object} data 코드와 텍스트
   */
  CodePicker.prototype.setData = function (data) {
    var self = this,
      $el = $(self._element),
      $wrapper = $el.parent(".dews-codepicker-wrapper"),
      $text = $(".dews-codepicker-text", $wrapper),
      isArray = false,
      isTrigger = true,
      selected,
      code = "",
      text = "",
      setDataEvent,
      changeEvent;

    if ($.type(data) === "object" && !$.isEmptyObject(data)) {
      selected = data;
    } else if (Array.isArray(data)) {
      isArray = true;

      if (isDataTreeGrid(data)) {
        selected = self._findSelectedTreeGridData($text.val(), data);
      } else if (data.length === 1) {
        selected = data[0];
      }
    }

    if (selected) {
      // 설정할 데이터가 단독일 경우에는 바로 설정한다.
      if (selected.hasOwnProperty(self.options.codeField)) {
        code = selected[self.options.codeField];
      }
      if (selected.hasOwnProperty(self.options.textField)) {
        text = selected[self.options.textField];
      }

      if ($.type(arguments[1]) === "boolean" && !arguments[1]) {
        isTrigger = false;
      }
      // setData 이벤트 발생
      setDataEvent = new $.Event("setData");
      // 값이 false 일 경우 실행하지 않음
      if (isTrigger) {
        setDataEvent.code = code;
        setDataEvent.text = text;

        $el.trigger(setDataEvent, [selected]);
      }

      if (setDataEvent.isDefaultPrevented()) {
        // 이벤트 핸들러에서 preventDefault를 호출했을 때는
        // 값의 변경등을 더 이상 진행하지 않습니다.
        return;
      }

      $el.data("code", code).data("text", text).val(code);
      $text.val(text).attr("data-original-title", code); // 툴팁처리 - 툴팁 정보를 갱신합니다.

      // Dirty 표시를 제거합니다.
      self._removeDirtyFlag();

      if (isTrigger) {
        // change 이벤트 발생
        changeEvent = new $.Event("_change");
        changeEvent.code = code;
        changeEvent.text = text;

        $el.trigger(changeEvent);
      }
    } else if (isArray) {
      // 설정할 데이터가 다수일 경우에는 코드다이얼로그를 열도록 codedialog 이벤트를 발생시킨다.
      self._triggerCodeDialog($text.val(), data);
    }
  };

  /**
   * items 컬럼이 있으면 트리그리드로 간주합니다.
   * @param {Object} data 검색 후 백엔드에서 받아온 데이터
   * @return {boolean}
   */
  function isDataTreeGrid(data) {var _data$;
    return !!((_data$ = data[0]) !== null && _data$ !== void 0 && _data$.items);
  }

  /**
   * 데이터가 트리그리드 형식일 때 데이터에서 검색어에 해당하는 아이템을 리턴합니다.
   * 일치하는 데이터가 두 개 이상이면 false를 리턴합니다.
   * @param {string} keyword 검색어
   * @param {Object} data 검색 후 백엔드에서 받아온 데이터
   * @return {Object | boolean} 일치하는 아이템
   * @private
   */
  CodePicker.prototype._findSelectedTreeGridData = function (keyword, data) {
    var result = $.extend(true, {}, data)[0];
    var matched = 0;

    while (true) {
      if (result.items.length > 1) {
        return false;
      }

      var code = result[this.options.codeField];
      var text = result[this.options.textField];

      if (code !== null && code !== void 0 && code.indexOf(keyword) !== -1 || text !== null && text !== void 0 && text.indexOf(keyword) !== -1) {
        matched++;
      }

      if (matched > 1) {
        return false;
      }

      if (result.items.length !== 0) {
        result = result.items[0];
      } else {
        break;
      }
    }

    return result;
  };

  /**
   * 코드피커의 코드와 텍스트를 모두 빈 값으로 초기화합니다.
   */
  CodePicker.prototype.clearData = function () {
    var self = this,
      data = {};

    data[self.options.codeField] = data[self.options.textField] = "";

    self.setData(data, arguments[0]);

    self._clearData = true;
  };

  /**
   * 코드피커의 코드나 텍스트가 변경되어 정보가 유효하지 않은지 여부를 가져옵니다.
   * @returns {boolean} 유효하지 않은지 여부
   */
  CodePicker.prototype.isDirty = function () {
    var self = this,
      $el = $(self._element),
      $wrapper = $el.parent(".dews-codepicker-wrapper");

    return $wrapper.hasClass("dews-dirty-data");
  };

  /**
   * 코드피커에 포커스를 줍니다.
   * @returns {CodePicker} 코드피커
   */
  CodePicker.prototype.focus = function () {
    var self = this,
      $el = $(self._element),
      $wrapper = $el.parent(".dews-codepicker-wrapper"),
      $text = $(".dews-codepicker-text", $wrapper);

    if ($text.prop("disabled") === false) {
      $text.focus();
    }

    return self;
  };

  /**
   * 코드피커의 텍스트를 모두 선택합니다.
   * @returns {CodePicker} 코드피커
   */
  CodePicker.prototype.select = function () {
    var self = this,
      $el = $(self._element),
      $wrapper = $el.parent(".dews-codepicker-wrapper"),
      $text = $(".dews-codepicker-text", $wrapper);

    if ($text.prop("readonly") === false && $text.prop("disabled") === false) {
      $text.select();
    }

    return self;
  };

  /**
   * 코드 피커에 설정된 코드를 가져옵니다.
   * @returns {string} 코드
   */
  CodePicker.prototype.code = function () {
    var self = this,
      $el = $(self._element);

    return $el.data("code");
  };

  /**
   * 코드 피커에 설정된 텍스트를 가져옵니다.
   * @returns {string} 텍스트
   */
  CodePicker.prototype.text = function () {
    var self = this,
      $el = $(self._element);

    return $el.data("text");
  };

  /**
   * 코드 피커에 새로운 옵션을 적용합니다.
   * @param options
   */
  CodePicker.prototype.setOptions = function (options) {
    options = $.extend(true, {}, this.options, options);

    this.options = options;
  };

  /**
   * 코드 피커에 설정된 옵션을 가져옵니다.
   * @returns {object} 옵션 설정값
   */
  CodePicker.prototype.getOptions = function () {
    return this.options;
  };

  CodePicker.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change", "codedialog", "setData"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "change") {
          $(self._element).trigger("_change");
        } else {
          $(self._element).trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  /**
   * DEWS 객체에 직접 이벤트 핸들러를 등록합니다.
   */
  CodePicker.prototype.on = function () {
    var self = this;
    var $el = $(self._element);
    var args;

    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    }
    $el.on.apply($el, arguments);
  };

  /**
   * DEWS 객체에 직접 등록한 이벤트 핸들러를 해제합나다.
   */
  CodePicker.prototype.off = function () {
    var self = this;
    var $el = $(self._element);

    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    }
    $el.off.apply($el, arguments);
  };

  CodePicker.prototype.validate = function () {
    var self = this;
    return !!self.code();
  };

  CodePicker.prototype.bindFromPanel = function (data) {
    var self = this,
      $element = $(self._element),
      codeColumn,
      textColumn,
      value;

    if (data) {
      codeColumn =
      $element.data("dews-bind-code") ||
      $element.data("dews-code-field") ||
      self.options.codeField ||
      $element.attr("id");
      textColumn = $element.data("dews-bind-text") || $element.data("dews-text-field") || self.options.textField;

      if (codeColumn && data.hasOwnProperty(codeColumn)) {
        value = {};

        value[$element.data("dews-code-field") || self.options.codeField] = data[codeColumn] || "";

        if (textColumn && data.hasOwnProperty(textColumn)) {
          value[$element.data("dews-text-field") || self.options.textField] = data[textColumn] || "";
        }

        self.setData(value, false);
      }
    }
  };

  CodePicker.prototype.serializeForPanel = function () {
    var self = this,
      $element = $(self._element),
      codeColumn,
      textColumn,
      data;

    codeColumn =
    $element.data("dews-bind-code") ||
    $element.data("dews-code-field") ||
    self.options.codeField ||
    $element.attr("id");
    textColumn = $element.data("dews-bind-text") || $element.data("dews-text-field") || self.options.textField;

    if (codeColumn) {
      data = {};
      data[codeColumn] = self.code();

      if (textColumn) {
        data[textColumn] = self.text();
      }
    }

    return data;
  };

  CodePicker.prototype.applyPanelFocus = function (requiredCheck) {
    var self = this;

    self.requiredCheck = requiredCheck;
    self.usePanelFocus = true;
  };

  CodePicker.prototype.canFocusable = function () {
    var self = this,
      $element = $(self._element);
    var $wrapper = $element.parent(".dews-codepicker-wrapper");
    var $text = $(".dews-codepicker-text", $wrapper);

    return !$element.hasClass("readonly") && $text.is(":enabled") && $text.is(":visible");
  };

  /**
   * @returns {boolean}
   * @private
   */
  CodePicker.prototype.canCodeSearch = function () {
    // api url이 없을 때는 바로 코드도움창 띄우도록 처리하였음
    return !!(this.options.useAjax && (!this.options.helpCustom || this.options.helpApiUrl));
  };

  /**
   * 코드피커 컨트롤 자동화 인쇄 관련 데이터 추출
   * @return {*} 값이 설정 된 경우 Object 반환, 없는 경우 undefined 반환
   * @private
   */
  CodePicker.prototype._getPrintData = function () {
    var self = this,
      $el = $(self._element),
      data;

    if (self.text()) {
      data = {
        id: $el.attr("id"),
        text: self.text()
      };
    }

    return data;
  };

  /**
   * 코드피커 컨트롤 display none 하여 숨기는 API
   */
  CodePicker.prototype.hide = function () {
    var self = this,
      $el = $(self._element),
      $wrapper = $el.parent(".dews-codepicker-wrapper");

    if (!($wrapper.css("display") === "none")) {
      $wrapper.css("display", "none");
    }
  };

  /**
   * 코드피커 컨트롤 display inline-block 하여 보이도록 하는 API
   */
  CodePicker.prototype.show = function () {
    var self = this,
      $el = $(self._element),
      $wrapper = $el.parent(".dews-codepicker-wrapper");

    if ($wrapper.css("display") === "none") {
      $wrapper.css("display", "inline-block");
    }
  };

  /**
   * 코드피커의 다이얼로그를 여는 API 입니다.
   */
  CodePicker.prototype.open = function () {
    var self = this;
    var $wrapper = $(self._element).parent();

    $(".dews-codepicker-button", $wrapper).trigger("click");
  };

  /**
   * 파라미터로 받은 키워드를 검색하는 API 입니다.
   * @param {string} keyword 검색할 키워드
   */
  CodePicker.prototype.search = function (keyword) {
    var previousKeyword = this.text();
    if (hasTextChanged(keyword, previousKeyword)) {
      $(this._element).siblings('.dews-codepicker-text').val(keyword);
      this.onCompleteTyping(keyword);
    }
  };

  /**
   * @private
   */
  CodePicker.prototype.nextFocus = function () {
    var evt = new $.Event("nextFocus");
    evt.control = this;

    $(this._element).trigger(evt);
  };

  CodePicker.prototype.previousFocus = function () {
    var evt = new $.Event("beforeFocus");
    evt.control = this;
    $(this._element).trigger(evt);
  };

  $.extend(true, dews, {
    /**
     * @namespace
     */
    ui: {
      /**
       * 지정한 요소를 코드피커로 만들거나 가져옵니다.
       * @param {string|jQuery} selector 코드피커로 만들 셀렉터 또는 jQuery 객체
       * @param {object} options 코드피커 옵션
       * @returns {object|Array} 코드피커 인스턴스
       */
      codepicker: function codepicker(selector, options) {
        var $el, obj;

        obj = [];

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var picker,
            element = this;

          if ($(element).data("dews-control")) {
            picker = $(element).data("dews-control");
          } else {
            if (!$(element).hasClass("dews-ui-codepicker")) {
              $(element).addClass("dews-ui-codepicker");
            }
            if (!$(element).hasClass("dews-form-control")) {
              $(element).addClass("dews-form-control");
            }

            picker = new CodePicker(element, options);
            picker._render();
            picker._activate();
            $(element).data("dews-control", picker);
          }

          obj.push(picker);
        });

        return obj.length == 1 ? obj[0] : obj;
      }
    }
  });

  dews.ui.addControlInitializer("codepicker", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.codepicker($(".dews-ui-codepicker", $container));
  });
})(jQuery, window.dews);


/*
 * 컬러라인
 */
(function ($, dews) {
  /**
   * 컬러라인을 생성합니다.
   * @constructor
   */var
  ColorLine = /*#__PURE__*/function () {"use strict";












    function ColorLine($element, opt) {_classCallCheck(this, ColorLine);_defineProperty(this, "saveColorLineCallBack", []);_defineProperty(this, "grid", void 0);_defineProperty(this, "gridNoteKey", "");_defineProperty(this, "gridCode", "");_defineProperty(this, "menuCode", dews.ui.page.menu.id);_defineProperty(this, "options", { activateState: true });_defineProperty(this, "$element", void 0);_defineProperty(this, "recentColor", void 0);_defineProperty(this, "noteService", void 0);
      this.$element = $element;
      this.noteService = new GridNoteService();
      this.recentColor = [];
      this.options = $.extend({}, this.options, opt);

      $element.append($element);
      this.$element.addClass("grid-note-box");
      this.enable(false);

      this.init($element);
    }_createClass(ColorLine, [{ key: "on", value:

      function on(type, callBack) {
        if (type === "onSavedColorLine") {
          this.saveColorLineCallBack.push(callBack);
        }
      } }, { key: "setOptions", value:

      function setOptions(option) {
        var self = this;

        self.options = $.extend({}, self.options, option);
      } }, { key: "enable", value:

      function enable(bool) {
        var self = this;

        if (typeof bool !== "undefined") {
          if (bool) {
            // 활성화
            if (self.$element.hasClass("disabled")) {
              self.$element.removeClass("disabled");
            }
            self.$element.addClass("collapse active");
          } else {
            if (self.$element.hasClass("collapse")) {
              self.$element.removeClass("collapse");
            }
            if (self.$element.hasClass("active")) {
              self.$element.removeClass("active");
            }

            self.$element.addClass("disabled");
          }
        } else {
          return !self.$element.hasClass("disabled");
        }
      }

      /**
       *
       * @param bool {boolean | undefined}
       * @return {*}
       */ }, { key: "useColor", value:
      function useColor() {var bool = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;
        var self = this;
        if (typeof bool === "undefined") {
          return self.options.activateState;
        } else {
          self.enable(true);
          self.toggle.prop("checked", bool);
          self.setOptions({ activateState: bool });
          self["delete"].enable(bool);
          if (bool) {
            $(".colorLine-list .color-chip", self.$element).removeAttr("disabled");
          } else {
            $(".colorLine-list .color-chip", self.$element).attr("disabled", "true");
          }
        }
      } }, { key: "value", value:
      function value(val) {
        var self = this;
        var list = $(".colorLine-list .color-chip", self.$element);

        self.enable(true);
        if (typeof val === "string") {
          list.removeClass("selected");

          list.each(function (idx, color) {
            var $color = $(color);
            if ($color.data("color-name") === val || $color.data("color-code") === val) {
              $color.addClass("selected");
            }
          });
        } else if (val === null) {
          list.removeClass("selected");
        } else {
          return $(".colorLine-list .color-chip.selected", self.$element).data("color-code");
        }
      } }, { key: "searchData", value:

      function searchData(grid, key, data) {
        var self = this;
        this.grid = grid;

        if (key) {
          this.gridNoteKey = key.gridNoteKey || "";
          this.gridCode = key.gridCode || "";
          this.menuCode = key.menuCode || "";
        }

        if (this.grid.options.note && this.gridNoteKey) {
          var bool = data.glcUseYn === "Y";
          var color = data.glcCode;

          this.enable(true);
          self.useColor(bool);
          self.value(color);
        } else {
          this.enable(false);
        }
      } }, { key: "init", value:

      function init($element) {
        var self = this;

        self.$content = $content();
        $element.append(self.$content);
        $element.prepend($title());

        initialize();

        function initialize() {
          self.save = dews.ui.button($(".dews-ui-button.save", $element));
          self["delete"] = dews.ui.button($(".dews-ui-button.delete", $element));
          self.toggle = $("#".concat(dews.ui.page.menu.id, "-colorLine-toggle"), $element);

          // 저장
          self.save.on("click", function () {
            self.noteService.
            saveColor({
              gridNoteKey: self.gridNoteKey,
              gridCode: self.gridCode,
              menuCode: self.menuCode,
              glcCode: self.value(),
              glcUseYn: self.useColor() ? "Y" : "N"
            }).
            done(function () {var _self$saveColorLineCa;
              var name = $(".colorLine-list .color-chip.selected", self.$element).data("color-name");

              self.recentColor = self.recentColor.filter(function (data) {
                return data !== name;
              });
              var len;
              if (name) {
                len = self.recentColor.unshift(name);
              }

              if (len > 4) {
                self.recentColor.pop();
              }
              // 현재 사용색 설정
              $(".colorLine-recently .color-chip.present", $element).removeClass();
              $(".colorLine-recently button:first-child", $element).addClass(
              "color-chip present " + name);


              // 최근 샤용색 설정
              setRecentColor();

              (_self$saveColorLineCa = self.saveColorLineCallBack) === null || _self$saveColorLineCa === void 0 ? void 0 : _self$saveColorLineCa.forEach(function (callBack) {
                callBack.call(self, self.useColor(), self.value());
              });
              dews.ui.snackbar.ok("컬러라인이 적용 되었습니다.");
            });
          });

          // 삭제
          self["delete"].on("click", function () {
            $(".colorLine-list .color-chip.selected", $element).removeClass("selected");
            $(".colorLine-recently .color-chip.present", $element).removeClass().addClass("color-chip present");
            setRecentColor();
            self.save.raiseEvent("click");
          });

          self.toggle.on("click", function (e) {
            e.stopPropagation();
          });

          self.toggle.on("change", function (e) {
            var $target = $(e.target);

            var val = $target.prop("checked");
            self.useColor(val);
            self.noteService.
            saveColor({
              gridNoteKey: self.gridNoteKey,
              gridCode: self.gridCode,
              menuCode: self.menuCode,
              glcCode: self.value(),
              glcUseYn: self.useColor() ? "Y" : "N"
            }).
            done(function () {var _self$saveColorLineCa2;
              (_self$saveColorLineCa2 = self.saveColorLineCallBack) === null || _self$saveColorLineCa2 === void 0 ? void 0 : _self$saveColorLineCa2.forEach(function (callBack) {
                callBack.call(self, self.useColor(), self.value());
              });

              if (val) {
                dews.ui.snackbar.ok("컬러라인이 활성화 되었습니다.");
              } else {
                dews.ui.snackbar.ok("컬러라인이 비활성화 되었습니다.");
              }
            });
          });

          function setRecentColor() {
            var $colors = $(".colorLine-recently .color-chip:not(.present)", $element);
            $colors.removeClass().addClass("color-chip");

            self.recentColor.forEach(function (color, idx) {
              $colors.eq(idx).addClass(color);
            });
          }
        }

        function $content() {
          var $content = $("\n                <div class=\"content\" style=\"height: 158px;\">\n                    <div class=\"colorLine-list\">\n                        <button class=\"color-chip chip01\" data-color-name=\"chip01\" data-color-code=\"#bd3e41\"></button>\n                        <button class=\"color-chip chip02\" data-color-name=\"chip02\" data-color-code=\"#fc5356\"></button>\n                        <button class=\"color-chip chip03\" data-color-name=\"chip03\" data-color-code=\"#ff9987\"></button>\n                        <button class=\"color-chip chip04\" data-color-name=\"chip04\" data-color-code=\"#ffa94d\"></button>\n                        <button class=\"color-chip chip05\" data-color-name=\"chip05\" data-color-code=\"#ffe748\"></button>\n                        <button class=\"color-chip chip06\" data-color-name=\"chip06\" data-color-code=\"#156cbc\"></button>\n                        <button class=\"color-chip chip07\" data-color-name=\"chip07\" data-color-code=\"#1c90fb\"></button>\n                        <button class=\"color-chip chip08\" data-color-name=\"chip08\" data-color-code=\"#60bcff\"></button>\n                        <button class=\"color-chip chip09\" data-color-name=\"chip09\" data-color-code=\"#8b8bff\"></button>\n                        <button class=\"color-chip chip10\" data-color-name=\"chip10\" data-color-code=\"#bc8bff\"></button>\n                    </div>\n                    <div class=\"colorLine-recently\">\n                        <button class=\"color-chip present\"></button>\n                        <button class=\"color-chip\"></button>\n                        <button class=\"color-chip\"></button>\n                        <button class=\"color-chip\"></button>\n                        <button class=\"color-chip\"></button>\n                    </div>\n                <div class=\"colorLine-button\">\n                    <button class=\"dews-ui-button small save\" style=\"display: none\">\uC801\uC6A9</button>\n                    <button class=\"dews-ui-button small delete\">\uC0AD\uC81C</button>\n                </div>\n            </div>");


























          // 컬러 선택
          $(".colorLine-list .color-chip", $content).on("click", function (e) {
            var $target = $(e.target);
            var grid = self.grid;

            if (grid.getRowState(grid.select()) !== "added") {
              $target.addClass("selected");
              $target.siblings(".color-chip").removeClass("selected");
              self.save.raiseEvent("click");
            } else {
              dews.ui.snackbar.warning("저장되지 않은 정보가 있습니다.");
            }
          });

          return $content;
        }

        function $title() {
          var $title = $("<div class=\"title\">\n                <h2>\uCEEC\uB7EC\uB77C\uC778</h2>\n                <div class=\"colorLine-toggle\">\n                    <input type=\"checkbox\" id=\"".concat(


          dews.ui.page.menu.id, "-colorLine-toggle\" checked=\"true\">\n                    <label for=\"").concat(
          dews.ui.page.menu.id, "-colorLine-toggle\"></label>\n                </div>\n                <div class=\"title-collapse\"></div>\n            </div>"));




          $(".colorLine-toggle", $title).on("click", function (e) {
            e.stopPropagation();
          });

          $title.on("click", function (e) {
            var $content = $(".content", $element);
            if (self.enable()) {
              if ($element.hasClass("collapse")) {
                $content.css("height", 0);
                $element.removeClass("active");
                $element.removeClass("collapse");
              } else {
                $content.css("height", 158);
                $element.addClass("active");
                $element.addClass("collapse");
              }
            }
          });

          return $title;
        }
      } }]);return ColorLine;}();


  dews = $.extend(true, dews, {
    ui: {
      colorLine: function colorLine(selector, options) {
        var $control, box;

        if (selector instanceof jQuery) {
          $control = selector;
        } else if ($.type(selector) === "string") {
          $control = $(selector);
        } else {
          throw "대상이 지정되지 않았습니다.";
        }

        $control.each(function () {
          var $this = $(this),
            colorLine;

          colorLine = $this.data("dews-control");

          if (!colorLine) {
            colorLine = new ColorLine($this, options);
            $this.data("dews-control", colorLine);

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }
          }

          box = colorLine;
        });
        return box;
      }
    }
  });
})(jQuery, window.dews || {});


/*
 * 콤보박스
 */
(function ($, dews, kendo) {
  var defaultOptions = {
    dataTextField: "text",
    dataValueField: "value"
  };

  /**
   * 설정 값을  가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   * @param {object} codeOptions 스크립트 코드에서 전송된 옵션
   */
  function getOptions($el, codeOptions) {
    var inlineOptions;

    inlineOptions = getInlineOptions($el);
    codeOptions = codeOptions || {};

    return $.extend(true, {}, defaultOptions, inlineOptions, codeOptions);
  }

  /**
   * HTML 코드 상에 선언되어 있는 옵션을 가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   */
  function getInlineOptions($el) {
    var options = {},
      dataSource,
      dataSourceID,
      dataSourceUrl,
      dataSourceParams,
      dataSourceOptions;

    if ($el) {
      // AJAX를 이용한 데이터 바인딩을 사용할지 여부의 판단
      // - 코드도움 코드나 DATA 요청 URL 이 지정되어 있으면 AJAX 를 이용한 데이터 바인딩
      if ($el.data("dews-help-code") || $el.data("dews-data-url")) {
        if ($el.attr("id")) {
          dataSourceID = $el.attr("id") + "_DataSource";
        } else {
          dataSourceID = new Date().toString() + "_DataSource";
        }

        if ($el.data("dews-data-url")) {
          dataSourceUrl = dews.url.getAbsoluteUrl($el.data("dews-data-url"));

          dataSourceOptions = {
            transport: {
              read: {
                url: dataSourceUrl,
                dataType: "json"
              }
            }
          };

          dataSource = dews.ui.dataSource(dataSourceID, dataSourceOptions);
        } else {
          dataSourceUrl = dews.url.getCodeDataUrl($el.data("dews-help-code"));

          dataSourceOptions = {
            transport: {
              read: {
                url: dataSourceUrl,
                dataType: "json"
              }
            }
          };

          if ($el.data("dews-help-params")) {
            dataSourceParams = $.deparam($el.data("dews-help-params"));
            dataSourceOptions.transport.read.data = dataSourceParams;
          }

          dataSource = dews.ui.dataSource(dataSourceID, dataSourceOptions);
        }

        options.dataSource = dataSource;
      }

      if ($el.data("dews-value-field")) {
        options.dataValueField = $el.data("dews-value-field");
      }

      if ($el.data("dews-text-field")) {
        options.dataTextField = $el.data("dews-text-field");
      }

      if ($el.data("dews-selectable")) {
        options.dataSelectable = $el.data("dews-selectable");
      }

      options.dataSelectableTrueValue = $el.data("dews-selectable-true-value") ?
      $el.data("dews-selectable-true-value") :
      defaultOptions.dataSelectableTrueValue;
      options.dataSelectableFalseValue = $el.data("dews-selectable-false-value") ?
      $el.data("dews-selectable-false-value") :
      defaultOptions.dataSelectableFalseValue;

      if ($el.hasClass("readonly")) {
        $el.attr("readonly", true);
      }
    }

    return options;
  }

  /**
   * 컨트롤을 초기화합니다.
   * @param {jQuery} $el 대상 DOM 요소의 jQuery 객체
   * @param {object} [options] 설정 값
   */
  function initControl($el, options) {
    var $wrapper, $state;

    $wrapper = $el.closest(".k-combobox");
    $state = $wrapper.find(".k-dropdown-wrap");

    if ($wrapper.hasClass("dews-ui-combobox")) {
      $wrapper.removeClass("dews-ui-combobox");
    }
    if ($wrapper.hasClass("dews-control-activate")) {
      $wrapper.removeClass("dews-control-activate");
    }
    if (!$wrapper.hasClass("dews-combobox-wrapper")) {
      $wrapper.addClass("dews-combobox-wrapper");
    }
    if ($wrapper.find(".k-input").hasClass("dews-ui-combobox")) {
      $wrapper.find(".k-input").removeClass("dews-ui-combobox");
    }

    //
    // 상태정보 추가
    //
    if ($wrapper.hasClass("disabled")) {
      $state.addClass("dews-state-disabled");
      $wrapper.removeClass("disabled");
    }
    if ($wrapper.hasClass("readonly")) {
      $state.addClass("dews-state-readonly");
      $wrapper.removeClass("readonly");
    }
    if ($wrapper.hasClass("required")) {
      $state.addClass("dews-state-required");
      $wrapper.removeClass("required");
    }

    $wrapper.find(".dews-form-control").on("focus", function () {
      if ($el.prop("readonly") === false && $el.prop("disabled") === false) {
        $wrapper.find(".dews-form-control").select();
      }
    });

    setUserGuideAPI($wrapper.find(".dews-form-control"));
  }

  /**
   * 시용자 가이드를 위한 API 를 추가합니다.
   * @param $element 대상 jQuery 요소
   */
  function setUserGuideAPI($element) {
    $element.on("focus", function () {
      if (dews.ui.page && dews.ui.page.hasUserGuide) {
        if (
        $.isFunction(dews.ui.page.focusGuideItem) &&
        $element.closest("select.dews-ui-combobox").attr("id"))
        {
          dews.ui.page.focusGuideItem("#" + $element.closest("select.dews-ui-combobox").attr("id"));
        }
      }
    });
  }

  $.extend(true, dews, {
    ui: {
      /**
       * 콤보박스를 만들거나 가져옵니다.
       * @param {string|jQuery} selector 대상 요소에 대한 셀렉터 또는 jQuery 객체
       * @param {object} [options] 드롭다운리스트 옵션
       */
      combobox: function combobox(selector, options) {
        var $el, combo;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var $this = $(this),
            control,
            $wrapper,
            opt;

          control = $this.data("dews-control");

          if (!control) {
            opt = getOptions($this, options);

            if (!$this.hasClass("dews-ui-combobox")) {
              $this.addClass("dews-ui-combobox");
            }
            if (!$this.hasClass("dews-form-control")) {
              $this.addClass("dews-form-control");
            }

            dews.ui.util.ConvertClassAndProperty($this);

            $this.find(">option[data-dews-localize-key]").each(function (idx, value) {
              var $list = $(value);
              $list.text(
              dews.localize.get(
              $list.text(),
              $list.data("dews-localize-key"),
              $list.data("dews-localize-lang") || null));


            });

            $this.kendoComboBox(opt);
            control = $this.data("kendoComboBox");

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            initControl($this, opt);

            $this.data("dews-control", control);

            control._bindEvents();

            control._selectableValue();
          }

          combo = control;
        });

        return combo;
      }
    }
  });

  kendo.ui.ComboBox.fn._selectableValue = function () {
    var self = this,
      options = self.options;

    if (typeof options.dataSelectable === "string") {
      options._dataSelectable = options.dataSelectable;

      if (options.hasOwnProperty("dataSelectableFalseValue")) {
        options._dataSelectableFalseValue = options.dataSelectableFalseValue;
      } else {
        options._dataSelectableFalseValue = false;
      }
      if (options.hasOwnProperty("dataSelectableTrueValue")) {
        options._dataSelectableTrueValue = options.dataSelectableTrueValue;
      } else {
        options._dataSelectableTrueValue = true;
      }
    } else if (_typeof(options.dataSelectable) === "object") {
      options._dataSelectable = options.dataSelectable.field;

      if (options.dataSelectable.hasOwnProperty("falseValue")) {
        options._dataSelectableFalseValue = options.dataSelectable.falseValue;
      } else {
        options._dataSelectableFalseValue = false;
      }
      if (options.dataSelectable.hasOwnProperty("trueValue")) {
        options._dataSelectableTrueValue = options.dataSelectable.trueValue;
      } else {
        options._dataSelectableTrueValue = true;
      }
    }
  };

  kendo.ui.ComboBox.fn.readonly = function (readonly) {
    return function (value) {
      var self = this,
        state;

      if (typeof value === "undefined") {
        return self.element.hasClass("readonly");
      } else {
        state = self.wrapper.find(".k-dropdown-wrap");

        if (!value) {
          if (self.wrapper.hasClass("readonly")) {
            self.wrapper.removeClass("readonly");
          }
          if (self.element.hasClass("readonly")) {
            self.element.removeClass("readonly");
          }
          if (state.hasClass("dews-state-readonly")) {
            state.removeClass("dews-state-readonly");
          }
        } else {
          if (!self.wrapper.hasClass("readonly")) {
            self.wrapper.addClass("readonly");
          }
          if (!self.element.hasClass("readonly")) {
            self.element.addClass("readonly");
          }
          if (!state.hasClass("dews-state-readonly")) {
            state.addClass("dews-state-readonly");
          }
        }
      }

      readonly.call(self, value);
    };
  }(kendo.ui.ComboBox.fn.readonly);

  kendo.ui.ComboBox.fn.enable = function (enable) {
    return function (value) {
      var self = this,
        state;

      if (typeof value === "undefined") {
        return !self.element.prop("disabled");
      } else {
        state = self.wrapper.find(".k-dropdown-wrap");

        if (value) {
          if (self.wrapper.hasClass("disabled")) {
            self.wrapper.removeClass("disabled");
          }
          if (self.element.hasClass("disabled")) {
            self.element.removeClass("disabled");
          }
          if (state.hasClass("dews-state-disabled")) {
            state.removeClass("dews-state-disabled");
          }
        } else {
          if (!self.wrapper.hasClass("disabled")) {
            self.wrapper.addClass("disabled");
          }
          if (!self.element.hasClass("disabled")) {
            self.element.addClass("disabled");
          }
          if (!state.hasClass("dews-state-disabled")) {
            state.addClass("dews-state-disabled");
          }
        }
      }

      enable.call(self, value);

      if (value) {
        if (self.element.hasClass("readonly")) {
          self.readonly(true);
        }
      }
    };
  }(kendo.ui.ComboBox.fn.enable);

  /**
   * 콤보박스의 visible 여부를 가져옵니다.
   * @returns {boolean}
   * @private
   */
  kendo.ui.ComboBox.fn._visibleCheckFromPanel = function () {
    var self = this,
      $ctrl = self.element;
    isVisible = $ctrl.closest(".dews-combobox-wrapper").css("display") !== "none";

    return isVisible;
  };

  kendo.ui.ComboBox.fn.setDataSource = function (data) {
    return function (dataSource) {
      var that = this;
      var parent;
      that.options.dataSource = dataSource;
      that._dataSource();
      if (that.listView.bound()) {
        that._initialIndex = null;
        that.listView._current = null;
      }
      that.listView.setDataSource(that.dataSource);
      if (that.options.autoBind) {
        that.dataSource.fetch().done(function () {
          if (that.select() === -1) {
            that.select(0);
          }
        });
      }
      parent = that._parentWidget();
      if (parent) {
        that._cascadeSelect(parent);
      }
    };
  }(kendo.ui.ComboBox.fn.setDataSource);

  kendo.ui.ComboBox.fn._bindEvents = function () {
    var self = this,
      $element = self.element;
    var $wrapper = $element.parent(".dews-combobox-wrapper");

    $wrapper.find(".dews-form-control").on("keydown", function (e) {
      if (e.keyCode === 115 && $element.prop("readonly") === false && $element.prop("disabled") === false) {
        self.open();
        e.stopPropagation();
        e.preventDefault();
      }
    });

    self.bind("open", function () {
      var self = this;

      if (self.list.length > 0 && !self.list.hasClass("dews-combobox-container")) {
        self.list.addClass("dews-combobox-container");
      }

      for (var i = 0; i < self.list.find("ul>li.k-item").not(".hidden").length; i++) {
        if (i < 9) {
          if (self.list.find("ul>li.k-item").not(".hidden").eq(i).find(".usenum").length < 1) {
            self.list.
            find("ul>li.k-item").
            not(".hidden").
            eq(i).
            append('<span class="usenum">' + (i + 1) + "</span>");
          }
        }
      }
    });
  };

  kendo.ui.ComboBox.fn.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change", "open", "close", "select", "dataBound"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        self.trigger(event);
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  kendo.ui.ComboBox.fn.on = function () {
    var self = this,
      $element = self.element;

    if (arguments[0] === "nextFocus" || arguments[0] === "beforeFocus") {
      $element.on.apply($element, arguments);
    } else {
      self.bind.apply(self, arguments);
    }
  };

  kendo.ui.ComboBox.fn.off = function () {
    var self = this,
      $element = self.element;

    if (arguments[0] === "nextFocus" || arguments[0] === "beforeFocus") {
      $element.off.apply($element, arguments);
    } else {
      self.unbind.apply(self, arguments);
    }
  };

  kendo.ui.ComboBox.fn.validate = function () {
    var self = this;
    return !!self.text();
  };

  kendo.ui.ComboBox.fn.required = function (value) {
    var self = this;
    var $el = self.element;
    var $wrapper = self.wrapper;
    var state = self.wrapper.find(".k-dropdown-wrap");

    if ($.type(value) === "undefined") {
      return $el.hasClass("required");
    } else if (value === true) {
      $el.addClass("required");
      $wrapper.addClass("required");
      state.addClass("dews-state-required");
    } else if (value === false) {
      $el.removeClass("required");
      $wrapper.removeClass("required");
      state.removeClass("dews-state-required");
    }
  };

  kendo.ui.ComboBox.fn.bindFromPanel = function (data) {
    var self = this,
      $element = self.element;
    var valueColumn, textColumn, value;

    if (data) {
      valueColumn = $element.data("dews-bind-value") || $element.data("dews-value-field") || $element.attr("id");
      textColumn = $element.data("dews-bind-text") || $element.data("dews-text-field");

      if (valueColumn && data.hasOwnProperty(valueColumn)) {
        value = {};

        self.value(data[valueColumn] || "");

        if (textColumn && data.hasOwnProperty(textColumn)) {
          self.text(data[textColumn] || "");
        }
      }
    }
  };

  kendo.ui.ComboBox.fn.serializeForPanel = function () {
    var self = this,
      $element = self.element;
    var valueColumn, textColumn;
    var data;

    valueColumn = $element.data("dews-bind-value") || $element.data("dews-value-field") || $element.attr("id");
    textColumn = $element.data("dews-bind-text") || $element.data("dews-text-field");

    if (valueColumn) {
      data = {};
      data[valueColumn] = self.value();

      if (textColumn) {
        data[textColumn] = self.text();
      }
    }

    return data;
  };

  kendo.ui.ComboBox.fn.applyPanelFocus = function (requiredCheck) {
    var self = this,
      $element = self.element;
    var $wrapper = $element.parent(".dews-combobox-wrapper");
    var $el = $wrapper.find(".dews-form-control");

    $el.on("keydown", function (e) {
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && $el.is(":enabled")) {
        e.preventDefault();
      } else if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();

        var evt = new $.Event("beforeFocus");
        evt.control = self;

        $element.trigger(evt);
      } else if (e.keyCode === 9 || e.keyCode === 13 && $el.is(":enabled")) {
        if (e.keyCode === 9) {
          //tab키 기본동작 막기
          e.preventDefault();
        }
        if (e.keyCode === 13 && requiredCheck && $element.hasClass("required")) {
          if (self.validate()) {
            var evt = new $.Event("nextFocus");
            evt.control = self;

            $element.trigger(evt);
          }
        } else {
          var evt = new $.Event("nextFocus");
          evt.control = self;

          $element.trigger(evt);
        }
      }
    });
  };

  kendo.ui.ComboBox.fn.canFocusable = function () {
    var self = this,
      $element = self.element;
    var $wrapper = $element.parent(".dews-combobox-wrapper");
    var $el = $wrapper.find(".dews-form-control");
    return !$el.hasClass("readonly") && $el.is(":visible") && $el.is(":enabled");
  };

  /**
   * 콤보박스 컨트롤 자동화 인쇄 관련 데이터 추출
   * @return {*} 값이 설정 된 경우 Object 반환, 없는 경우 undefined 반환
   * @private
   */
  kendo.ui.ComboBox.fn._getPrintData = function () {
    var self = this,
      $el = $(self.element),
      data;

    if (self.text()) {
      data = {
        id: $el.attr("id"),
        text: self.text()
      };
    }

    return data;
  };

  /**
   * 콤보박스 컨트롤 display none 하여 숨기는 API
   */
  kendo.ui.ComboBox.fn.hide = function () {
    var self = this;

    if (!(self.wrapper.css("display") === "none")) {
      self.wrapper.css("display", "none");
    }
  };

  /**
   * 콤보박스 컨트롤 display inline-block 하여 보이도록 하는 API
   */
  kendo.ui.ComboBox.fn.show = function () {
    var self = this;

    if (self.wrapper.css("display") === "none") {
      self.wrapper.css("display", "inline-block");
    }
  };

  dews.ui.addControlInitializer("combobox", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.combobox($("select.dews-ui-combobox, input[type='text'].dews-ui-combobox", $container));
  });

  /**
   * kendo의 _listBound 함수를 재정의합니다.
   * 리스트가 바인딩될 때 타는 로직
   */
  function listBound(_listBound) {
    return function () {
      var self = this;
      var data = self.dataSource.flatView();

      if (self.element.hasClass("dews-ui-combobox") && self.options.dataSelectable) {
        for (var i = 0; self.element.find(">option").length > i; i++) {
          if (
          self.element.find(">option").eq(i).attr(self.options.dataSelectable) === (
          self.element.data("dews-selectable-false-value") || "false"))
          {
            self.options._dataSelectable = self.options.dataSelectable;
            self.options._dataSelectableFalseValue =
            self.element.data("dews-selectable-false-value") || false;
            data[i][self.options.dataSelectable] =
            self.element.data("dews-selectable-false-value") || false;
          }
        }
      }

      _listBound.call(self);

      if (self.element.hasClass("dews-ui-combobox") && self.options.dataSelectable) {
        for (var i = 0; i < data.length; i++) {
          if (
          data[i][self.options._dataSelectable] !== undefined &&
          data[i][self.options._dataSelectable] === self.options._dataSelectableFalseValue)
          {
            self.ul.find(">li.k-item").eq(i).css("display", "none");
            self.ul.find(">li.k-item").eq(i).addClass("hidden");
          }
        }
      }
    };
  }

  kendo.ui.ComboBox.fn._listBound = listBound(kendo.ui.ComboBox.fn._listBound);
})(jQuery, window.dews, window.kendo);


/*
 * 컨테이너 패널
 */

(function ($, dews) {
  // 기본 옵션 설정
  var defaultOptions = {
    isVisible: true
  };

  // 컨테이너 아이템 생성
  function ContainerItem(element, parent) {
    var self = this;

    self.element = $(element);
    self.parent = parent;

    return self;
  }

  /**
   * 컨테이너 아이템 출력 유무 설정
   * @param display (string)
   */
  ContainerItem.prototype.display = function (display) {
    var self = this;

    if (display === "none") {
      self.element.css("display", "none");
    } else {
      self.element.css("display", "block");
    }

    setStyle(self.parent, self.parent.options);
    // 컨테이너 아이템 내부에 그리드가 있을 경우 사이즈 재조정, 그리드 생성 이전에는 로직 타지 않음
    if (self.element.find("> .dews-ui-grid canvas")[0]) {
      var grid = dews.ui.grid(self.element.find("> .dews-ui-grid"));
      grid._grid.resetSize();
    }
  };

  // 컨테이너 패널 fit-bottom 설정
  ContainerPanel.prototype.setFitBottom = function () {
    var self = this,
      target = self.container;

    if (!target.data("dews-fit-bottom")) {
      return;
    }

    // 하단 끝선 관련 문제
    target.addClass("fit-bottom");

    // 탭 패널이 있을 경우  열려지지 않은 탭에 대해서는 display: none이기 때문에 설정이 되지 않기 때문에 다 열어주고 설정
    openTab(target);

    // 컨테이너 패널의 fit-bottom이 해당 자식 노드에서 마지막인지 확인
    this._isLastItem() ?
    this._fitBottomLastItem() :
    this._fitBottomNotLastItem();

    var containerItem = self.container.find("> .dews-container-item");
    for (var child = 0; child < containerItem.length; child += 1) {
      if (
      $(containerItem[child].lastElementChild).offset() &&
      $(containerItem[child].lastElementChild).offset().top - target.offset().top < target.height() &&
      containerItem[child].childElementCount !== 1 &&
      !$(containerItem[child].lastElementChild).prev().hasClass("dews-form-panel-edit-mode"))
      {
        if (
        $(containerItem[child].lastElementChild).is(
        ".dews-container-panel, .dews-ui-container-panel"))

        {
          $(containerItem[child].lastElementChild).css(
          "height",
          target.height() -
          $(containerItem[child].lastElementChild).offset().top +
          target.offset().top +
          5 +
          "px");

        } else {
          $(containerItem[child].lastElementChild).css(
          "height",
          target.height() -
          $(containerItem[child].lastElementChild).offset().top +
          target.offset().top +
          "px");

        }
      }
    }

    this._adjustWidthToWindow();
    // 탭 패널이 있을 경우 다시 보여줬던 탭 아이템을 숨긴다.
    hideTab(target);
  };

  ContainerPanel.prototype._fitBottomLastItem = function () {
    var container = this.container;

    if (this._isTopLevel()) {
      if (this._isInDialog()) {
        this._fitBottomDialog();
      } else {
        container.css("min-height", 760 - container.offset().top - 25 + "px");
        container.css("height", $(window).height() - container.offset().top - 25 + "px");
      }
    } else if (container.parent().css("height") !== "100%") {
      // 다른 메뉴 이동 후 핏 바텀 높이가 깨지는 현상을 막기 위한 조건
      container.css(
      "min-height",
      container.parent().outerHeight() -
      container.offset().top +
      container.parent().offset().top +
      "px");

      container.css(
      "height",
      container.parent().outerHeight() -
      container.offset().top +
      container.parent().offset().top +
      "px");

    }
  };

  ContainerPanel.prototype._fitBottomNotLastItem = function () {
    var container = this.container;

    var containerPanels = container.parent().find("> .dews-container-panel");
    var flag = false;
    var totalHeight = 0;
    $.each(containerPanels, function (idx, target) {
      var $container = $(target);

      // data-dews-container-height 로 높이를 지정한 컨테이너 패널이 있을 경우
      if ($container.data("dews-container-height")) {
        $container.css("height", $container.data("dews-container-height") + "px");
      }

      if (flag) {
        totalHeight = $container.height() + 5 + totalHeight; // height+ 되는 곳
      }

      if ($container.hasClass("fit-bottom")) {
        flag = true;
      }
    });

    if (this._isTopLevel()) {
      if (this._isInDialog()) {
        this._fitBottomDialog();
      } else {
        container.css("min-height", 760 - container.offset().top - 25 - totalHeight + "px");
        container.css("height", $(window).height() - container.offset().top - 25 - totalHeight + "px");
      }
    } else {
      container.css(
      "min-height",
      container.parent().outerHeight() -
      container.offset().top +
      container.parent().offset().top -
      totalHeight +
      "px");

      container.css(
      "height",
      container.parent().outerHeight() -
      container.offset().top +
      container.parent().offset().top -
      totalHeight +
      "px");

    }
  };

  ContainerPanel.prototype._fitBottomDialog = function () {
    var target = this.container;
    var $dialog = target.closest(".dews-ui-dialog");
    var targetMarginBottom = parseInt(target.css("margin-bottom")) || 0;
    var marginBottom = parseInt($dialog.find(".dews-dialog-contents-area").css("margin-bottom")) || 0;
    var btnGroupHeight = $dialog.find(".dews-dialog-button-group.bottom").outerHeight() || 0;

    target.css(
    "min-height",
    $dialog.outerHeight() -
    target.offset().top +
    $dialog.offset().top -
    btnGroupHeight -
    marginBottom -
    targetMarginBottom +
    "px");

    target.css(
    "height",
    $dialog.outerHeight() -
    target.offset().top +
    $dialog.offset().top -
    btnGroupHeight -
    marginBottom -
    targetMarginBottom +
    "px");

  };

  ContainerPanel.prototype._adjustWidthToWindow = function () {
    var normalItem = this.container.find(">.dews-container-item.normal");
    var marginRight = parseInt(normalItem.css("marginRight"));
    var marginLeft = parseInt(normalItem.css("marginLeft"));
    var totalWidth = marginRight + marginLeft + normalItem.width();
    // 윈도우 사이즈보다 너비가 작을 경우 설정하는 코드
    if ($(window).width() >= 1280) {
      if ($(window).width() - this.container.offset().left - 15 < totalWidth) {
        var leftItem = this.container.children().filter(".left");
        var rightItem = this.container.children().filter(".right");
        // fit-bottom / normal 아이템 너비 설정
        if (leftItem.length === 1 && rightItem.length === 0) {
          normalItem.css("width", this.container.width() - marginLeft + "px");
        } else if (leftItem.length === 0 && rightItem.length === 1) {
          normalItem.css("width", this.container.width() - marginRight + "px");
        } else if (leftItem.length === 1 && rightItem.length === 1) {
          normalItem.css("width", this.container.width() - marginLeft - marginRight + "px");
        } else if (leftItem.length === 0 && rightItem.length === 0) {
          normalItem.css("width", this.container.width() + "px");
        }

        normalItem.css("right", "");
      } else {
        normalItem.css("width", "");
        normalItem.css("right", "0px");
      }
    } else {
      normalItem.css("right", "");
      normalItem.css("width", this.container.width() - (marginRight + marginLeft) + "px");
    }
    // 폼패널의 최소 사이즈 설정
    if (normalItem.find("> .dews-form-panel").length !== 0) {
      normalItem.css("minWidth", normalItem.find("> .dews-form-panel").css("minWidth"));
    }
  };

  ContainerPanel.prototype._isLastItem = function () {
    return this.container.parent().find(">.dews-container-panel").length !== 0 &&
    this.container.parent().find(">.dews-container-panel:last").hasClass("fit-bottom") ===
    this.container.hasClass("fit-bottom");
  };

  ContainerPanel.prototype._isTopLevel = function () {
    return this.container.parent().closest(".dews-container-panel").length === 0;
  };

  ContainerPanel.prototype._isInDialog = function () {
    return this.container.parent().closest(".dews-dialog-contents").length !== 0;
  };

  // 컨테이너 패널 포지션 위치 정의 (left, normal, right)
  function setStyle(containerpanel, opt) {
    var self = containerpanel,
      options = opt,
      containerItem = self.container.find(">.dews-container-item"),
      marginLeft = 0,
      marginRight = 0,
      target = self.container,
      totalWidth = 0;

    // 탭 패널이 있을 경우 열려지지 않은 탭에 대해서는 display: none이기 때문에 설정이 되지 않기 때문에 다 열어주고 설정
    openTab(target);

    // 아코디언 패널이 있을 경우 열려지지 않은 탭에 대해서는 display: none이기 때문에 설정이 되지 않기 때문에 다 열어주고 설정
    if (target.closest(".dews-ui-arcodien").length !== 0 && target.closest(".dews-arcodien-item")) {
      target.closest(".dews-arcodien-contents").css("display", "block");
    }

    if (self.container.data("dews-container-height")) {
      self.container[0].style.minHeight = self.container.data("dews-container-height") + "px";
    }

    if (containerItem) {
      if (options === undefined) {
        for (var j = 0; j < containerItem.length; j += 1) {
          var $containerItem = $(containerItem[j]);

          if ($containerItem.data("dews-position")) {
            $containerItem.addClass($containerItem.data("dews-position"));

            if (
            !$containerItem.hasClass("normal") &&
            $containerItem.data("dews-width") &&
            $containerItem.css("display") !== "none")
            {
              var itemWidth = $containerItem.data("dews-width");

              $containerItem.css("width", itemWidth);
            }
          } else {
            if (j === containerItem.length - 1) {
              $containerItem.addClass("normal");
            } else {
              $containerItem.addClass("left");
            }
          }
        }
      } else if ($.type(options.items) !== "undefined") {
        for (var k = 0; k < options.items.length; k += 1) {
          var $containerItem = $(containerItem[k]);
          if ($(options.items[k]).css("display") !== "none") {
            if (options.items[k].position === "normal") {
              $containerItem.addClass("normal");
            } else if (options.items[k].position === "left") {
              $containerItem.addClass("left");
              $containerItem.css("width", options.items[k].width + "px");
            } else if (options.items[k].position === "right") {
              $containerItem.addClass("right");
              $containerItem.css("width", options.items[k].width + "px");
              marginRight += options.items[k].width + 8;
            }
          }
        }
      }

      for (var i = 0; i < containerItem.length; i += 1) {
        var $containerItem = $(containerItem[i]);

        if ($containerItem.css("display") !== "none") {
          if ($containerItem.hasClass("normal")) {
            $containerItem.css("margin-left", marginLeft);
          } else if ($containerItem.hasClass("left")) {
            $containerItem.css("left", marginLeft);
            marginLeft += $(containerItem[i]).width() + 8;
          }
        }
      }

      for (var r = containerItem.length - 1; r >= 0; r -= 1) {
        var $containerItem = $(containerItem[r]);

        if ($containerItem.css("display") !== "none") {
          if ($containerItem.hasClass("normal")) {
            $containerItem.css("margin-right", marginRight);
          } else if ($containerItem.hasClass("right")) {
            $containerItem.css("right", marginRight);
            marginRight += $(containerItem[r]).width() + 8;
          }
        }
      }

      if (self.container.data("dews-fit-bottom")) {
        dews.ready(function () {
          // self.container가 현재 페이지에 있는 container일 경우만 실행
          if (self.container.closest("div.tab-page.tab-focus").is(":visible")) {
            self.setFitBottom();
          } else if (self.container.closest("div.dews-ui-dialog").is(":visible")) {
            //dialog 내에 container일 경우 실행
            self.setFitBottom();
          }
        });
      } else {
        self.container.find(">.dews-container-item.normal").css("height", "");
      }
    }

    // 탭 패널이 있을 경우 다시 보여줬던 탭 아이템을 숨긴다.
    if (target.parents(".dews-ui-tab-panel").length !== 0 && target.parents(".dews-tab-content")) {
      target.
      parents(".dews-ui-tab-panel").
      find("> .dews-tab-items > .dews-tab-item > .dews-tab-content").
      css("display", "");
      target.parents(".dews-ui-tab-panel").find("> .dews-tab-items >.dews-tab-item").css("display", "");
      if (target.parents(".dews-tab-item").data("dews-hide")) {
        target.parents(".dews-tab-item").css("display", "none");
        target.parents(".dews-tab-content").css("display", "none");
      } else {
        target.parents(".dews-tab-item").css("display", "");
        target.parents(".dews-tab-content").css("display", "");
      }
    }

    // 아코디언 패널이 있을 경우 다시 보여줬던 아코디언 아이템을 숨긴다.
    if (target.closest(".dews-ui-arcodien").length !== 0 && target.closest(".dews-arcodien-item")) {
      target.closest(".dews-arcodien-contents").css("display", "");
      if (target.closest(".dews-arcodien-item").data("dews-item-open")) {
        target.closest(".dews-arcodien-contents").css("display", "");
      }
      if (target.closest(".dews-arcodien-item").data("dews-item-hide")) {
        target.closest(".dews-arcodien-contents").css("display", "none");
      }
    }
  }

  // 컨테이너 패널 생성
  var useResizeGbn = false;
  function ContainerPanel(element, options) {
    var self = this,
      target = element;

    self.container = target;
    self.items = [];
    setStyle(self, options);
    self.options = $.extend(true, {}, defaultOptions, options);
    self._bindEvent();

    for (var j = 0; j < self.container.find(">.dews-container-item").length; j += 1) {
      self.items.push(new ContainerItem(self.container.find(">.dews-container-item")[j], self));
    }

    self.items.getById = function (id) {
      var self = this;

      for (var i = 0; i < self.length; i += 1) {
        if (self[i].element.attr("ID") === id) {
          return self[i];
        }
      }

      return null;
    };

    //컨테이너 패널 리사이징
    if (self.container.data("dews-container-resize")) {
      useResizeGbn = true;
      appendResizer("H", self.container);

      if (!self.container.data("dews-fit-bottom")) {
        //fitBottom에 해당하는 컨테이너는 필요없음
        appendResizer("V", self.container);
      }
    }

    return self;
  }

  function openTab(target) {
    if (target.parents(".dews-ui-tab-panel").length === 0 || !target.parents(".dews-tab-item")) {
      return;
    }
    target.
    parents(".dews-ui-tab-panel").
    find("> .dews-tab-items >.dews-tab-item > .dews-tab-content").
    css("display", "none");
    target.parents(".dews-ui-tab-panel").find("> .dews-tab-items >.dews-tab-item").css("display", "none");
    target.parents(".dews-tab-item").css("display", "block");
    target.parents(".dews-tab-content").css("display", "block");
  }

  function hideTab(target) {
    if (target.parents(".dews-ui-tab-panel").length === 0 || !target.parents(".dews-tab-content")) {
      return;
    }

    target.
    parents(".dews-ui-tab-panel").
    find("> .dews-tab-items > .dews-tab-item > .dews-tab-content").
    css("display", "");
    target.parents(".dews-ui-tab-panel").find("> .dews-tab-items >.dews-tab-item").css("display", "");
    $.each(
    target.parents(".dews-ui-tab-panel").find("> .dews-tab-items >.dews-tab-item"),
    function (idx, item) {
      if ($(item).data("dews-hide")) {
        $(item).css("display", "none");
      } else {
        $(item).css("display", "");
      }
    });

  }
  //컨테이너 패널 리사이징 - 스플리터바 생성작업
  function appendResizer(direction, container) {
    dews.ready(function () {
      openTab(container);
      if (direction === "H") {
        //너비바 생성
        appendWidthResizer(container, dews.ui.page.$content);
      }

      if (direction === "V") {
        appendHeightResizer(container);
      }
      hideTab(container);
    });
  }

  function appendHeightResizer(container) {
    var template = document.createElement("template");
    template.innerHTML = '<div class="v_spilter"></div>';
    var resizer = template.content.firstElementChild;

    resizer.style.width = "".concat(container.width(), "px");
    // container의 margin-bottom이 늦게 추가되는 문제 때문에 컨테이너패널의 기본 margin-bottom 값을 기준으로 작성하였다.
    resizer.style.transform = "translateY(-5px)"; // translateY(-${container.css('margin-bottom')})

    container[0].insertAdjacentElement("afterend", resizer);

    dragElement(resizer, "V");
  }

  function appendWidthResizer(container, content) {
    var containerItems = $(container).find(".dews-container-item", content);

    for (var i = 0; i < containerItems.length - 1; i++) {var _containerItems$clien, _containerItems;
      var template = document.createElement("template");
      template.innerHTML = '<div class="spilter"></div>';
      var resizer = template.content.firstElementChild;

      var previousItemWidth = (_containerItems$clien = (_containerItems = containerItems[i - 1]) === null || _containerItems === void 0 ? void 0 : _containerItems.clientWidth) !== null && _containerItems$clien !== void 0 ? _containerItems$clien : 0;
      var resizerWidth = 8;
      var resizerLeft = previousItemWidth + resizerWidth * i + containerItems[i].clientWidth;
      resizer.style.left = "".concat(resizerLeft, "px");
      resizer.style.height = "".concat(containerItems[i].clientHeight, "px");

      containerItems[i].insertAdjacentElement("afterend", resizer);

      dragElement(resizer, "H");
    }
  }

  //컨테이너 패널 리사이징 - 드래그이벤트_위치이동
  function dragElement(element, direction) {
    var md; //그래그 전 객체 정보 저장

    var first = $(element).prev()[0]; //스플리터바 기준 이전 항목
    var second = $(element).next()[0]; //스프리터바 기준 이후 항목

    element.onmousedown = onMouseDown;

    function onMouseDown(e) {
      md = {
        e: e,
        offsetLeft: element.offsetLeft,
        offsetTop: element.offsetTop,
        firstWidth: first.offsetWidth,
        secondWidth: second.offsetWidth,
        firstHeight: first.offsetHeight,
        secondHeight: second.offsetHeight
      };

      document.onmousemove = onMouseMove;
      document.onmouseup = function () {
        document.onmousemove = document.onmouseup = null;
      };
    }

    function onMouseMove(e) {
      var delta = {
        x: e.clientX - md.e.clientX,
        y: e.clientY - md.e.clientY
      };

      // 너비조절
      if (direction === "H") {
        // Horizontal
        resizeWidth(delta);
      }

      //높이조절
      if (direction === "V") {
        resizeHeight(delta);
      }
    }

    function resizeWidth(delta) {var _$2, _$2$data, _$3, _$3$data;
      delta.x = Math.min(Math.max(delta.x, -md.firstWidth), md.secondWidth);
      element.style.left = md.offsetLeft + delta.x + "px";

      if (second.dataset.dewsPosition === "normal") {
        first.style.width = md.firstWidth + delta.x + "px";
        second.style.width = md.secondWidth - delta.x + "px";

        second.style.marginLeft = md.firstWidth + delta.x + 8 + "px";
      }

      if (second.dataset.dewsPosition === "right") {
        var temp = first.style.width;

        first.style.width = md.firstWidth + delta.x + "px";
        second.style.width =
        parseInt(second.style.width) + (parseInt(temp) - parseInt(first.style.width)) + "px";
      }

      (_$2 = $(".dews-ui-grid, .dews-ui-treegrid", first)) === null || _$2 === void 0 ? void 0 : (_$2$data = _$2.data("dews-control")) === null || _$2$data === void 0 ? void 0 : _$2$data._grid.resetSize();
      (_$3 = $(".dews-ui-grid, .dews-ui-treegrid", second)) === null || _$3 === void 0 ? void 0 : (_$3$data = _$3.data("dews-control")) === null || _$3$data === void 0 ? void 0 : _$3$data._grid.resetSize();
    }

    function resizeHeight(delta) {
      if ($(second).hasClass("dews-container-panel")) {
        delta.y = Math.min(Math.max(delta.y, -md.firstHeight), md.secondHeight);
      } else {
        delta.y = Math.max(delta.y, -md.firstHeight);
      }

      element.style.top = md.offsetTop + delta.y + "px";

      first.style.height = md.firstHeight + delta.y + "px";

      if ($(second).hasClass("dews-container-panel")) {
        //다음패널이 폼패널등이 온다면 오류 발생 가능성 있음. 따라서 컨테이너 패널일떄만 작동
        second.style.minHeight = "0px";
        second.style.height = md.secondHeight - delta.y + "px";
      }

      $(element).prev().find(".spilter").css("height", first.style.height);
      $(element).next().find(".spilter").css("height", second.style.height);

      first.style.minHeight = "0px"; //다음패널이 컨테이너 패널이 아닌경우 minHeight 이하로 더이상 줄어 들지 않는 현상 때문에 처리, 원래는 안되는 기능임.... 혹시 몰라서 처리
      var temp = md.firstHeight + delta.y;
      second.style.height =
      parseInt(second.style.height) + (parseInt(temp) - parseInt(first.style.height)) + "px";
      $(".dews-ui-grid, .dews-ui-treegrid", first).children().css("height", first.style.height);
      $(".dews-ui-grid, .dews-ui-treegrid", second).children().css("height", second.style.height);

      var gridList = $(".dews-ui-grid, .dews-ui-treegrid", first);
      var gridList2 = $(".dews-ui-grid, .dews-ui-treegrid", second);

      for (var i = 0; i < gridList.length; i++) {
        $(".dews-ui-grid, .dews-ui-treegrid", first).eq(i).data("dews-control")._grid.resetSize();
      }

      for (var _i3 = 0; _i3 < gridList2.length; _i3++) {
        $(".dews-ui-grid, .dews-ui-treegrid", second).eq(_i3).data("dews-control")._grid.resetSize();
      }
    }
  }

  //컨테이너 패널 리사이징 - 브라우저리사이즈시_스플리터바 이동
  window.onresize = function (event) {
    if (useResizeGbn) {
      setTimeout(function () {
        var nowContent = dews.ui.page.$content;
        var containerObj = $(".dews-container-panel", nowContent);

        for (var i = 0; i < containerObj.length; i++) {
          var position =
          containerObj.eq(i).find(".spilter").last().prev().offset().left -
          $("#contents").offset().left +
          containerObj.eq(i).find(".spilter").last().prev().width() -
          16;

          containerObj.
          eq(i).
          find(".spilter").
          last().
          css("left", position + "px");
          containerObj.
          eq(i).
          find(".spilter").
          last().
          next().
          css(
          "width",
          containerObj.eq(i).width() - containerObj.eq(i).find(".spilter").last().position().left - 8);


          containerObj.
          eq(i).
          children().
          last().
          find(".dews-ui-grid, .dews-ui-treegrid").
          data("dews-control").
          _grid.resetSize();
        }

        $(".v_spilter").css("width", containerObj.eq(0).width() + "px");
      }, 800);
    }
  };

  // 컨테이너 패널 이벤트 설정
  ContainerPanel.prototype._bindEvent = function () {
    var self = this;

    $(window).on("resize", function (e) {
      if (isVisible(self)) {
        self.setFitBottom();
        setStyle(self, self.options);
        self.options.isVisible = true;
      } else {
        self.options.isVisible = false;
      }
    });

    // 좌측 메인 메뉴의 리사이즈가 발생할 경우 컨테이너아이템 너비 재조정
    if (dews.app && dews.app.menuSectionResized) {
      dews.app.menuSectionResized.on(function () {
        if (isVisible(self)) {
          self.setFitBottom();
        }
      });
    }

    /* 2021-05-14 KHJ
     * 컨디션패널에서 optional=true를 사용하여 우측 상단에 버튼이 생성됨.
     * 그 버튼을 눌렀을 때, 애니메이션이 시작되는데,
     * '펼쳐지는 애니메이션 끝난 후 이벤트'(expandedSlideComplete)는 필요 없어서 작성 안했고,
     * '접히는 애니메이션 끝난 후 이벤트'(collapsedSlideComplete) 호출시 컨테이너를 다시 그려줌
     *
     * 2021-06-07 KHJ 수정
     * 여러 개의 메뉴를 열 경우, 모든 메뉴의 컨디션패널 이벤트를 등록해버리는 버그가 발생함
     * 내가 속해 있는 메뉴의 이벤트만 바라볼 수 있도록 수정
     */
    var $page;
    if (dews.ui.dialogPage && self.container.closest(dews.ui.dialogPage.$content).length) {
      $page = dews.ui.dialogPage.$content;
    } else if (dews.ui.page && self.container.closest(dews.ui.page.$content).length) {
      $page = dews.ui.page.$content;
    } else {
      $page = $(document);
    }
    $.each($page.find("div.dews-ui-condition-panel"), function (idx, selectPanels) {
      var conditionPanel = dews.ui.conditionpanel($(selectPanels));
      var optionArea = conditionPanel.$element.find(".optional-area");

      // 옵션 영역을 사용하는지 체크
      if (optionArea.length > 0) {
        // 접히는 애니메이션이 끝난 후 이벤트
        conditionPanel.on("collapsedSlideComplete", function (e) {
          self.refresh.bind(self)();
        });
      }
    });

    // 다른 페이지에서 resizing 시 배치 깨짐 방지
    setInterval(function () {
      if (isVisible(self) && !self.options.isVisible) {
        self.refresh.bind(self)();
      }
    }, 100);
  };

  ContainerPanel.prototype.refresh = function () {
    var self = this;

    self.setFitBottom();
    setStyle(self, self.options);
    self.options.isVisible = true;

    // 그리드 너비 조정이 먼저 일어나고 컨테이너패널의 조정이 일어나기 때문에 그리드 사이즈 조정
    $.each(self.items, function (idx, item) {
      var containerItem = $(item.element);

      if (containerItem.find("> .dews-ui-grid canvas")[0]) {
        var grid = dews.ui.grid(containerItem.find("> .dews-ui-grid"));
        grid._grid.resetSize();
      }
    });
  };

  // 컨테이너 패널 visible 유무 함수
  function isVisible(container) {
    return container.container.is(":visible");
  }

  dews = $.extend(true, dews, {
    ui: {
      containerpanel: function containerpanel(selector, options) {
        var $panel, panel;

        if (selector instanceof jQuery) {
          $panel = selector;
        } else if ($.type(selector) === "string") {
          $panel = $(selector);
        } else {
          throw "대상이 지정되지 않았습니다.";
        }

        $panel.each(function () {
          var $ctrl = $(this),
            opt = options;

          panel = $ctrl.data("dews-control");

          if (!$ctrl.hasClass("dews-ui-container-panel")) {
            $ctrl.addClass("dews-ui-container-panel");
          }

          if (!$ctrl.hasClass("dews-container-panel")) {
            $ctrl.addClass("dews-container-panel");
          }

          if (!panel) {
            panel = new ContainerPanel($ctrl, opt);
            $ctrl.data("dews-control", panel);
          }
        });

        return panel;
      }
    }
  });

  dews.ui.addControlInitializer("containerpanel", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    // TODO: dews-container-panel 로만 초기화하도록 되어 있어 추가하였으나 dews-ui-container-panel 로만 초기화 시켜도록 변경되어야 함
    dews.ui.containerpanel($("div.dews-container-panel, div.dews-ui-container-panel", $container));
  });
})(jQuery, window.dews || {});


(function ($, dews) {
  /**
   * 컨텍스트메뉴를 생성하기 위한 클래스
   * @param {HTMLElement} selector 컨텍스트메뉴 타겟 요소
   * @param {object} options  컨텍스트 메뉴 옵션
   * @constructor
   */
  var ContextMenu = function ContextMenu(selector, options) {
    var self = this;

    self.target = selector;

    self.options = options;
    self.eventArg = null;

    var $position = 0;

    $(window).scroll(function () {
      $position = $(this).scrollTop();
    });

    self.target.on("contextmenu", function (e) {
      var positionX = e.pageX - $(this).offset().left;
      var positionY = e.pageY - $(this).offset().top;

      e.preventDefault(); // 기본 이벤트 핸들러의 실행을 취소
      e.stopPropagation(); // 부모로 이벤트가 전달되는 것을 막음

      self.eventArg = $.Event("contextmenuclick", {
        target: e.target,
        currentTarget: e.currentTarget
      });

      $(".dews-ui-contextmenu").remove();

      self._createMenu(positionX, positionY, $position);
    });

    // 커스텀 컨텍스트 메뉴의 클릭 이벤트 핸들러를 호출해주고 이벤트 처리 완료 시킴
    self.target.on("contextmenuclick", function (e) {
      var handler;

      $.each(self.options.items, function (idx, item) {
        if (item.id === e.action) {
          if (item.hasOwnProperty("handler")) {
            item.handler(e);
          }

          self.container.remove();
          return false;
        }
      });
    });
  };

  /**
   * 컨텍스트메뉴의 외부 컨테이너를 생성하고 위치 설정 합니다.
   * @private
   */
  ContextMenu.prototype._createMenu = function (x, y, position) {
    var self = this,
      $container,
      $list,
      $position = position;

    $container = $("<div/>").addClass("dews-ui-contextmenu");
    $list = $("<ul/>").addClass("dews-contextmenu-list");

    $container.css({ position: "absolute", top: y + "px", left: x + "px" });

    self.container = $container;

    $(document.body).append($container);
    $container.append($list);

    self._createList();

    if ($container.outerWidth() + $container.offset().left + self.target.offset().left > $(window).width()) {
      $container.css("left", $(window).width() - $container.outerWidth() - 10 + "px");
      //    $container.css("left", x + self.target.offset().left - $container.outerWidth() + "px");
    } else {
      $container.css("left", x + self.target.offset().left + "px");
    }

    if (
    $container.offset().top + $container.outerHeight() - $position + self.target.offset().top >
    $(window).height())
    {
      $container.css("top", $(window).height() + $position - $container.outerHeight() + "px");
    } else {
      $container.css("top", y + self.target.offset().top + "px");
    }

    if ($(".dews-contextmenu-list li", self.container).length === 0) {
      $container.remove();
    }
  };

  /**
   * 컨텍스트메뉴 리스트를 생성합니다.
   * @private
   */
  ContextMenu.prototype._createList = function () {
    var self = this;

    self._contextMenuItemTrigger();

    $.each(self.options.items, function (idx, item) {
      if (item.display(self.eventArg) === true) {
        self.container.
        children("ul").
        append('<li data-action="' + item.id + '"><button type="button">' + item.text + "</button></li>");
      }
    });

    self.container.
    find(".dews-contextmenu-list li").
    bind("click contextmenu", { instance: self }, self._contextMenuItemClick);

    self.container.bind("click contextmenu", function (e) {
      self.container.remove();
      e.preventDefault();
    });

    self.container.on("mousewheel", function (e) {
      e.preventDefault();
    });

    $(window).scroll(function () {
      self.container.remove();
    });

    $(window).bind("mousedown blur", function (e) {
      var l_position = self.container.offset();
      l_position.right = parseInt(l_position.left) + self.container.width();
      l_position.bottom = parseInt(l_position.top) + parseInt(self.container.height());

      if (
      l_position.left <= e.pageX &&
      e.pageX <= l_position.right &&
      l_position.top <= e.pageY &&
      e.pageY <= l_position.bottom)
      {
      } else {
        self.container.remove();
      }
    });
  };

  /**
   * 컨텍스트메뉴 리스트 클릭시 옵션값 확장 및 이벤트 바인딩합니다.
   * @private
   */
  ContextMenu.prototype._contextMenuItemClick = function (e) {
    var self = e.data.instance;

    self.eventArg.action = $(e.target).parent().data("action");

    if (e.which === 3) {
      e.preventDefault();
    }

    self._contextMenuItemTrigger();
  };

  ContextMenu.prototype._contextMenuItemTrigger = function () {
    var self = this;

    if (self.options && $.isFunction(self.options.extendEventArgs)) {
      $.extend(true, self.eventArg, self.options.extendEventArgs.call(self, self.eventArg));
    }

    self.target.trigger(self.eventArg);
  };

  $.extend(true, dews, {
    ui: {
      contextmenu: function contextmenu(selector, options) {
        var $el, context;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        } else {
          $el = document;
        }

        if ($.isArray(options)) {
          options = {
            items: options
          };
        }

        $el.each(function () {
          var contextmenu,
            $this = $(this);

          contextmenu = $this.data("dews-control");

          if (!contextmenu) {
            if ($.type(selector) === "array") {
              contextmenu = new ContextMenu($el, selector);
            } else {
              contextmenu = new ContextMenu($el, options);
            }

            $this.data("dews-control", contextmenu);
          }

          context = contextmenu;
        });

        return context;
      }
    }
  });
})(jQuery, window.dews);


/**
 * 대시보드
 **/
(function ($, dews) {
  /**
   * 대시보드 뷰어 생성
   * @param element 대시보드 엘리먼트
   * @return {DashboardViewer}
   * @constructor
   */
  var DashboardViewer = function DashboardViewer(element) {
    var self = this;

    self.$element = element;
    self.tabItem = [];
    self.options = {
      type: "viewer",
      openTab: "",
      closeTab: "",
      error: false
    };

    return self;
  };

  /**
   * 태시보드 초기화 설정
   * @private
   */
  DashboardViewer.prototype._init = function () {
    var self = this;

    self.$tabPanel = $('<div class="dews-dashboard-tab-panel linkable"></div>');
    self.$buttonGroup = $('<div class="dews-button-group"></div>');
    self.$titleArea = $('<div class="dews-dashboard-tab-titles">');
    self.$contents = $('<div class="dews-dashboard-tab-contents">');

    self.$element.append(self.$tabPanel);
    self.$tabPanel.append(self.$buttonGroup);
    self.$tabPanel.append(self.$titleArea);
    self.$tabPanel.append(self.$contents);
  };

  /**
   * 대시보드 뷰어 이벤트 설정
   * @private
   */
  DashboardViewer.prototype._bindEvent = function () {
    var self = this;
  };

  /**
   * 대시보드 뷰어 렌더
   * @param data json 데이터
   */
  DashboardViewer.prototype.render = function (data) {
    var self = this;

    self.tabItem = [];
    self.options.data = data;
    self.options.orginData = data;

    if (data.TABITEMS.length === 0) {
      self.$element.append(
      '<div class="dews-dashboard-tab-panel linkable">' +
      '   <div class="dews-dashboard-tab-titles">' +
      '       <span class="dews-dashboard-tab-title tab-selected"><a>' +
      dews.localize.get("dews_탭") +
      "</a></span>" +
      "   </div>" +
      '   <div class="dews-dashboard-tab-contents">' +
      '       <div class="dews-dashboard-tab-content dews-tab-activate tab-selected" style="position: relative;">' +
      '           <div class="section dews-widget dews-widget-activate" style="position: absolute; left: 0px; top: 0px; height:320px; background: #e9eaec; border-radius: 5px">' +
      '               <div class="dews-enroll-widget" style="text-align: center; font-size: 18px; margin-top: 139px; font-weight: normal;">' +
      dews.localize.get("dews_등록된 위젯이 없습니다.") +
      "</div>" +
      "           </div>" +
      "       </div>" +
      "   </div>" +
      "</div>");

    } else {
      self._init();
      self._bindEvent();
      self.addTab(data.TABITEMS);
    }
  };

  /**
   * 대시보드 탭 추가
   * @param option 추가할 탭의 json 데이터
   */
  DashboardViewer.prototype.addTab = function (option) {
    var self = this,
      data = [];

    if ($.type(option) === "object") {
      data.push(option);
    } else if ($.type(option) === "array") {
      data = option;
    }

    $.each(data, function (idx, tabData) {
      self.tabItem.push(new TabItem(tabData, self));
      if (idx === 0) {
        self.tabItem[0].$title.click();
      }
    });
  };

  /**
   * 대시보드 뷰어 이벤트 추가
   */
  DashboardViewer.prototype.on = function () {
    var self = this;

    self.$element.on.apply(self.$element, arguments);
  };

  /**
   * 대시보드 뷰어 이벤트 삭제
   */
  DashboardViewer.prototype.off = function () {
    var self = this;

    self.$element.off.apply(self.$element, arguments);
  };

  /**
   * 대시보드 뷰어에서 에러 발생하는지 확인
   * @return {boolean} 에러 발생 유무
   */
  DashboardViewer.prototype.isError = function () {
    var self = this;

    return self.options.error;
  };

  /**
   * 대시보드 뷰어 미리보기에서 전체 탭이 열렸는지 확인
   * @return {boolean} 전체 열림 유무
   */
  DashboardViewer.prototype.isAllOpened = function () {
    var self = this,
      flag = true;

    $.each(self.tabItem, function (idx, tab) {
      if (!tab.options.opened) {
        flag = false;
        return false;
      }
    });

    return flag;
  };

  // 위젯 드래그 시작 이벤트
  function dragStartEvent(e) {
    var self = e.data;

    if (e.which === 1) {
      var target = self.$content;
      var dashboardTop = target.offset().top;
      var dashboardLeft = target.offset().left;

      self._startY = e.clientY - dashboardTop;
      self._startX = e.clientX - dashboardLeft;
      self.$content.addClass("drag");
      self.options.tabItem.options.widgetDrag = true;

      self._$insertArea = $('<div class="dews-widget-activate background dews-widget-alt-area"></div>');
      self._$insertArea.css({
        position: "absolute",
        top: dashboardTop - self.options.tabItem.options.dashboard.$tabPanel.offset().top - 31,
        left: dashboardLeft - self.options.tabItem.options.dashboard.$tabPanel.offset().left,
        height: target.outerHeight() + "px",
        background: "#f2f2f2"
      });
      self.$content.before(self._$insertArea);

      $(window).on("mousemove", self, dragEvent);
      $(window).on("mouseup", self, dragEndEvent);

      e.stopPropagation();
    }
  }

  // 위젯 드래그 이벤트
  function dragEvent(e) {
    var self = e.data,
      panel = self.options.tabItem.$content,
      findTarget = [],
      $target;

    self.$content.css({
      top: e.clientY - self._startY - panel.offset().top,
      left: e.clientX - self._startX - panel.offset().left
    });

    // 크롬 IE 실행 문제 ( 사파리 안됨)
    if (
    navigator.appName === "Netscape" && navigator.userAgent.toLowerCase().indexOf("trident") !== -1 ||
    navigator.userAgent.toLowerCase().indexOf("msie") !== -1 ||
    navigator.userAgent.toLowerCase().indexOf("edge") !== -1)
    {
      var nodeList = document.msElementsFromPoint(e.clientX, e.clientY);
      findTarget = Array.prototype.slice.call(nodeList);
    } else {
      findTarget = document.elementsFromPoint(e.clientX, e.clientY);
    }

    $.each(findTarget, function (idx, html) {
      if (
      $(html).hasClass("dews-widget-activate") &&
      !$(html).hasClass("drag") &&
      !$(html).hasClass("background") &&
      !$(html).hasClass("dews-widget-add"))
      {
        $target = $(html);
        return false;
      }
    });

    if ($target) {
      var height = self.options.tabItem.$content.height();
      if (
      $target.offset().top + $target.height() / 2 < self.$content.offset().top ||
      $target.offset().left + $target.width() / 2 < self.$content.offset().left)
      {
        $target.after(self.$content);
        self._$insertArea.after($target);
        self._$insertArea.detach();

        self.options.tabItem.masonry.masonry("destroy");
        self.options.tabItem.$content.css("height", height);
        self.options.tabItem.masonry.masonry({
          columnWidth: self.options.tabItem.columnWidth
        });

        self._$insertArea.css({
          top: self.$content.offset().top - panel.offset().top,
          left: self.$content.offset().left - panel.offset().left
        });
        self.$content.after(self._$insertArea);
      } else if (
      $target.offset().top + $target.height() / 2 > self.$content.offset().top ||
      $target.offset().left + $target.width() / 2 > self.$content.offset().left)
      {
        $target.before(self.$content);
        self._$insertArea.before($target);
        self._$insertArea.detach();

        self.options.tabItem.masonry.masonry("destroy");
        self.options.tabItem.$content.css("height", height);
        self.options.tabItem.masonry.masonry({
          columnWidth: self.options.tabItem.columnWidth
        });

        self._$insertArea.css({
          top: self.$content.offset().top - panel.offset().top,
          left: self.$content.offset().left - panel.offset().left
        });
        self.$content.before(self._$insertArea);
      }
    }

    e.stopPropagation();
  }

  // 위젯 드래그 종료 이벤트
  function dragEndEvent(e) {
    var self = e.data;

    $(window).off("mousemove", dragEvent);
    $(window).off("mouseup", dragEndEvent);

    self.$content.removeClass("drag");
    self._$insertArea.remove();
    delete self._$insertArea;
    delete self._startX;
    delete self._startY;
    self.options.tabItem.options.widgetDrag = false;

    if (self.options.tabItem.$content.find(".dews-widget-alt-area").length !== 0) {
      self.options.tabItem.$content.find(".dews-widget-alt-area").remove();
    }
    var height = self.options.tabItem.$content.height();
    self.options.tabItem.masonry.masonry("destroy");
    self.options.tabItem.$content.css("height", height);
    self.options.tabItem.masonry.masonry({
      columnWidth: self.options.tabItem.columnWidth
    });

    e.stopPropagation();
  }

  /**
   * 대시보드 모델러
   * @param element
   * @constructor
   */
  var DashboardModeler = function DashboardModeler(element) {
    var self = this;

    self.$element = element;
    self.tabItem = [];
    self.widget = [];
    self.options = {
      type: "modeler",
      openTab: "",
      closeTab: "",
      page: self.$element.data("dews-dashboard-page") || "admin",
      addedTab: [],
      deletedTab: [],
      addedWidget: [],
      deletedWidget: [],
      error: false
    };

    self._init();
    self._bindEvent();

    return self;
  };

  /**
   * 대시보드 모델러 초기화
   * @private
   */
  DashboardModeler.prototype._init = function () {
    var self = this;

    if (dews._environments.dispWidgetCnt > 0) {
      self.$element.addClass("dashboard-fixed-" + dews._environments.dispWidgetCnt);
    }

    self.$tabPanel = $('<div class="dews-dashboard-tab-panel draggable"></div>');
    self.$buttonGroup = $('<div class="dews-button-group"></div>');
    self.$previewBtn = $(
    '<button class="dews-ui-button dews-control k-button dews-control-activate">' +
    dews.localize.get("dews_위젯검증") +
    "</button>");

    self.$titleArea = $('<div class="dews-dashboard-tab-titles">');
    self.$contents = $('<div class="dews-dashboard-tab-contents">');
    self.$tabAddBtn = $('<button type="button" class="dews-tab-add-btn"></button>');

    if (self.options.page === "admin") {
      self.$copyBtn = $(
      '<button class="dews-ui-button dews-control k-button dews-control-activate">' +
      dews.localize.get("dews_대시보드 복사") +
      "</button>");

      self.$buttonGroup.append(self.$copyBtn);
    }

    self.$buttonGroup.append(self.$previewBtn);
    self.$titleArea.append(self.$tabAddBtn);
    self.$tabPanel.append(self.$buttonGroup);
    self.$tabPanel.append(self.$titleArea);
    self.$tabPanel.append(self.$contents);
    self.$element.append(self.$tabPanel);
  };

  /**
   * 대시보드 모델러 이벤트 설정
   * @private
   */
  DashboardModeler.prototype._bindEvent = function () {
    var self = this;

    // 탭 추가 버튼 클릭시
    self.$tabAddBtn.on("click", function (e) {
      var data = {
        TAB_ID:
        "TAB" + kendo.toString(new Date(), "yyyyMMdd" + Math.round(Math.random() * 100000) + 1).toString(),
        TAB_NM: "탭",
        TAB_SQ: self.tabItem.length,
        USER_ID: dews.ui.page.user.userid,
        WIDGETS: []
      };
      self.addTab(data);
      self.options.addedTab.push(data);
      e.stopPropagation();
    });

    // 미리보기 버튼 클릭시
    self.$previewBtn.on("click", function (e) {
      var previewParams = {
        dashboard: self
      };
      var previewEvent = new $.Event("preview", previewParams);
      self.$element.trigger(previewEvent);
    });

    if (self.options.page === "admin") {
      self.$copyBtn.on("click", function (e) {
        var copyParams = {
          dashboard: self
        };

        var copyEvent = new $.Event("dashboardCopy", copyParams);
        self.$element.trigger(copyEvent);
      });
    }
  };

  /**
   * 대시보드 모델러 렌더
   * @param data 대시보드 뷰어를 구성할 json 데이터
   */
  DashboardModeler.prototype.render = function (data) {
    var self = this;

    self.tabItem = [];
    self.options.data = data;
    self.options.orginData = data;
    self.options.addedTab = [];
    self.options.deletedTab = [];
    self.options.addedWidget = [];
    self.options.deletedWidget = [];

    self.addTab(data.TABITEMS);

    if (data.TABITEMS.length === 0) {
      self.$tabAddBtn.click();
    }
  };

  /**
   * 대시보드 뷰어 새로 고침 이벤트
   */
  DashboardModeler.prototype.refresh = function () {
    var self = this;

    self.$buttonGroup.empty();
    self.$titleArea.empty();
    self.$contents.empty();
    self.render(self.options.data);
  };

  /**
   * 대시보드 모델러 탭 추가
   * @param option 추가할 탭 json 데이터
   */
  DashboardModeler.prototype.addTab = function (option) {
    var self = this,
      data = [];

    if ($.type(option) === "object") {
      data.push(option);
    } else if ($.type(option) === "array") {
      data = option;
    }

    $.each(data, function (idx, tabData) {
      self.tabItem.push(new TabItem(tabData, self));
      if (idx === 0) {
        self.tabItem[0].$title.click();
      }
    });
  };

  /**
   * 대시보드 모델러 데이터 획득
   * @return {*} 대시보드 json 데이터
   */
  DashboardModeler.prototype.getData = function () {
    var self = this,
      data = [];

    self.options.data.changeIndex = false;
    self.widget = [];

    $.each(self.tabItem, function (idx, value) {
      data.push(self.tabItem[idx].getData());
    });

    if (self.options.data) {
      self.options.data.TABITEMS = data;
    }

    return self.options.data;
  };

  /**
   * 대시보드 모델러에서 탭 아이디 검색
   * @param id 검색할 탭 id
   * @return {*} 탭 아이템 객체
   */
  DashboardModeler.prototype.getByTabId = function (id) {
    var self = this,
      tabItem;

    $.each(self.tabItem, function (idx, value) {
      if (value.id === id) {
        tabItem = value;
      }
    });

    return tabItem;
  };

  /**
   * 대시보드 모델러 이벤트 추가
   */
  DashboardModeler.prototype.on = function () {
    var self = this;

    self.$element.on.apply(self.$element, arguments);
  };

  /**
   * 대시보드 모델러 이벤트 삭제
   */
  DashboardModeler.prototype.off = function () {
    var self = this;

    self.$element.off.apply(self.$element, arguments);
  };

  /**
   * 탭 아이템 객체 생성
   * @param option 탭 아이템 json 데이터
   * @param dashboard 대시보드 뷰어 혹은 대시보드 모델러 객체
   * @return {TabItem} 탭 아이템 객체
   * @constructor
   */
  var TabItem = function TabItem(option, dashboard) {
    var self = this;

    self.options = {
      data: option,
      dashboard: dashboard,
      type: dashboard.options.type,
      opened: false,
      closed: false,
      widgetDrag: false
    };
    self.widgets = [];
    self.id = option.TAB_ID;
    self.columnWidth = 330;

    self._init();
    self._bindEvent();

    return self;
  };

  /**
   * 탭 아이템 html 구성
   * @private
   */
  TabItem.prototype._init = function () {
    var self = this,
      data = self.options.data;

    self.$title = $(
    '<span class="dews-dashboard-tab-title" id=' +
    self.id +
    "><a>" +
    dews.localize.get(data.TAB_NM) +
    "</a></span>");


    self.$content = $('<div class="dews-dashboard-tab-content" id="' + self.id + '_content"></div>');
    self.options.dashboard.$contents.append(self.$content);

    if (self.options.type === "modeler") {
      self.$title.insertBefore(self.options.dashboard.$tabAddBtn);

      self.$addBtn = $(
      '<div class="dews-widget-activate dews-widget-add"><button type="button" class="dews-widget-add-btn"></button></div>');

      self.$content.append(self.$addBtn);
    } else {
      self.options.dashboard.$titleArea.append(self.$title);
    }
  };

  /**
   * 탭 아이템 이벤트
   * @private
   */
  TabItem.prototype._bindEvent = function () {
    var self = this,
      dashboard = self.options.dashboard;

    // 탭 변경 이벤트
    self.$title.on("click", function (e) {
      if (!self.$title.hasClass("tab-selected")) {
        var params = {
          openTab: self,
          closeTab: self.options.dashboard.openTab
        };
        var changingEvent = new $.Event("_changing", params);
        var chageEvent = new $.Event("_change", params);
        // changing 이벤트
        self.$title.trigger(changingEvent);

        if (changingEvent.isDefaultPrevented()) {
          e.preventDefault();
          return false;
        }

        if (self.options.dashboard.openTab) {
          self.options.dashboard.openTab.options.closed = true;
        }

        self.options.dashboard.$titleArea.find(".tab-selected").removeClass("tab-selected");
        self.options.dashboard.$contents.find(".tab-selected").removeClass("tab-selected");
        if (!self.$content.hasClass("dews-tab-activate")) {
          self.$content.addClass("dews-tab-activate");
          self.masonry = self.$content.masonry({
            itemSelector: ".section",
            percentPosition: true,
            horizontalOrder: false
          });
          self.addWidget(self.options.data.WIDGETS);
        }
        self.$title.addClass("tab-selected");
        self.$content.addClass("tab-selected");
        self.masonry.masonry("destroy");
        // 고정갯수에 따른 컬럼 가로 길이 설정 ( 안할 경우 첫번째 아이템의 가로 길이가 모든 컬럼의 길이가 됨)
        self.columnWidth =
        dews._environments.dispWidgetCnt === "0" ?
        self.columnWidth :
        Math.floor(self.$content.width() / dews._environments.dispWidgetCnt) < self.columnWidth ?
        self.columnWidth :
        Math.floor(self.$content.width() / dews._environments.dispWidgetCnt);
        self.masonry.masonry({ columnWidth: self.columnWidth });
        self.options.dashboard.closeTab = self.options.dashboard.openTab;
        self.options.dashboard.openTab = self;
        self.options.opened = true;
        // change 이벤트
        self.$title.trigger(chageEvent);

        var interval = setInterval(function () {
          if (self.masonry && self.$content.is(":visible") && !self.options.widgetDrag) {
            var height = self.$content.height();
            self.masonry.masonry("destroy");
            self.$content.css("height", height);
            self.masonry.masonry({ columnWidth: self.columnWidth });
          } else if (
          !self.$content.is(":visible") &&
          self.options.dashboard.closeTab &&
          self.options.dashboard.closeTab.options.closed)
          {
            clearInterval(interval);
            self.options.dashboard.closeTab.options.closed = false;
          }
        }, 200);
      }
      e.stopPropagation();
    });

    if (self.options.type === "modeler") {
      // 다극어 요청 url
      var langCode;
      dews.api.get(dews.url.getApiUrl("CM", "UserInfoService", "info")).done(function (data) {
        $.each(data.companies, function (idx, value) {
          if (dews.ui.page.user.companyCode === value.companyCode) {
            langCode = value.languages;
          }
        });
      });

      // 탭 아이템 드래그 이벤트
      self.$title.find("> a").on("mousedown", self, tabItemDragStart);

      // 탭 추가 버튼 클릭 이벤트
      self.$addBtn.on("click", function (e) {
        var params = {
          tab: self
        };
        var event = new $.Event("addWidget", params);
        self.options.dashboard.$element.trigger(event);
        e.preventDefault();
        e.stopPropagation();
      });

      // 탭 타이틀 우클릭 이벤트
      self.$title.on("contextmenu", function (e) {
        if (self.options.data.TAB_LOCK_YN !== "Y") {
          if ($(".dews-edit-contents", self.$title).length === 0) {
            self.panel = $(
            '<div class="dews-edit-contents">' +
            "<ul>" +
            '<li class="dews-tab-title-edit">' +
            dews.localize.get("dews_탭명 변경") +
            "</li>" +
            '<li class="dews-tab-title-global">' +
            dews.localize.get("dews_탭명 다국어설정") +
            "</li>" +
            '<li class="dews-tab-remove">' +
            dews.localize.get("dews_탭 삭제") +
            "</li>" +
            "</ul>" +
            "</div>");

            self.panel.css({
              top: e.clientY - self.$title.offset().top,
              left: e.clientX - self.$title.offset().left
            });
            self.$title.append(self.panel);

            $(document).on("click", self, contextClose);
          }
          e.preventDefault();
          e.stopPropagation();
        } else {
          dews.alert("탭 편집 권한이 없습니다.", "warning");
          e.preventDefault();
          e.stopPropagation();
        }
      });

      // 탭명 수정 버튼 클릭 이벤트
      self.$title.on("click", ".dews-tab-title-edit", function (e) {
        self.startEditTitle();
        self.panel.remove();
        $(document).off("click", contextClose);
        delete self.panel;
        e.stopPropagation();
      });

      // 탭명 다국어 설정 버튼 클릭 이벤트
      self.$title.on("click", ".dews-tab-title-global", function (e) {
        self.panel.remove();
        $(document).off("click", contextClose);
        delete self.panel;
        if (self.options.data.STATUS === "NONE") {
          var dialog = dews.ui.dialog("globalDialog", {
            title: self.$title.find("> a").text() + " " + dews.localize.get("다국어설정"),
            buttons: "applyAndClose",
            width: 560,
            height: 540,
            content: '<div class="dews-ui-grid" id="globalGrid" style="height: 452px"></div>'
          });

          dialog.open();

          if (dialog._kendoWindow) {
            var langUrl =
            self.options.dashboard.options.page === "admin" ?
            "/api/MA/AdminDashboard/" :
            "/api/MP/UserDashboard/";
            var grid;
            dialog._kendoWindow.bind("activate", function (e) {
              var data = [];
              var dataSource = dews.ui.dataSource("dataSource", {
                grid: true,
                data: [],
                schema: {
                  model: {
                    id: "TAB_ID",
                    fields: [
                    { field: "LANG_CD" },
                    { field: "LANG_NM" },
                    { field: "TAB_ID" },
                    { field: "TAB_NM" }]

                  }
                }
              });

              $.each(self.options.dashboard.options.tabLangCode, function (idx, value) {
                data.push({
                  LANG_CD: value.langCode.toUpperCase(),
                  LANG_NM: value.langName,
                  TAB_ID: self.options.data.TAB_ID
                });
              });

              dataSource.data(data);
              dews.api.
              get(langUrl + "GetTabLocalize", {
                data: {
                  TAB_ID: self.options.data.TAB_ID
                }
              }).
              done(function (result) {
                $.each(data, function (idx, value) {
                  $.each(result, function (index, resultData) {
                    if (value.LANG_CD === resultData.LANG_CD) {
                      $.extend(true, value, resultData);
                    }
                  });
                });
                dataSource.data(data);
                grid.setDataSource(dataSource);
              });

              grid = dews.ui.grid($("#globalGrid", $("#globalDialog")), {
                dataSource: dataSource,
                autoBind: true,
                selectable: true,
                checkable: false,
                editable: true,
                height: 452,
                columns: [
                {
                  field: "LANG_CD",
                  title: "다국어",
                  visible: false,
                  editable: false
                },
                {
                  field: "LANG_NM",
                  title: "다국어",
                  editable: false
                },
                {
                  field: "TAB_ID",
                  title: "탭아이디",
                  visible: false
                },
                { field: "TAB_NM", title: "탭명" }]

              });
            });

            dialog.buttons.ok.on("click", function (e) {
              grid.commitCell();
              dews.api.post(langUrl + "SetTabLocalize", {
                data: {
                  localize: JSON.stringify(grid.dataItems())
                }
              });
              dialog.close();
              dews.ui.snackbar.ok(dews.localize.get("다국어 설정을 하였습니다."));
            });
          }
        } else {
          dews.alert("저장을 하고 다국어를 설정해주시기 바랍니다.", "warning");
        }

        e.stopPropagation();
      });

      // 탭 삭제 버튼 클릭 이벤트
      self.$title.on("click", ".dews-tab-remove", function (e) {
        self.panel.remove();
        $(document).off("click", contextClose);
        delete self.panel;
        self.remove();
        e.stopPropagation();
      });
    }
  };

  // 컨텍스트 메뉴 닫기 이벤트
  function contextClose(e) {
    var self = e.data;
    self.panel.remove();
    delete self.panel;
    $(document).off("click", contextClose);
  }

  // 탭 아이템 드래그 시작 이벤트
  function tabItemDragStart(e) {
    var self = e.data;

    if (e.which === 1) {
      var dashboardTop = self.$title.offset().top;
      var dashboardLeft = self.$title.offset().left;

      self._startY = e.clientY - dashboardTop;
      self._startX = e.clientX - dashboardLeft;
      self.$title.addClass("drag");

      self._$insertArea = $('<span class="dews-dashboard-tab-title background"></span>');
      self._$insertArea.text(self.options.data.TAB_NM);
      self._$insertArea.css({
        position: "relative",
        height: self.$title.height() + "px",
        padding: "0 15px",
        background: "#f2f2f2",
        width: self.$title.width() + "px"
      });
      self.$title.css({
        position: "absolute",
        left: self.$title.offset().left - self.options.dashboard.$tabPanel.offset().left,
        top: self.$title.offset().top - self.options.dashboard.$tabPanel.offset().top
      });
      self.$title.before(self._$insertArea);

      $(window).on("mousemove", self, tabItemDrag);
      $(window).on("mouseup", self, tabItemDragEnd);

      e.stopPropagation();
    }
  }

  // 탭 아이템 드래그 중 이벤트
  function tabItemDrag(e) {
    var self = e.data,
      panel = self.options.dashboard.$element,
      findTarget = [],
      $target;

    self.$title.css({
      top: e.clientY - self._startY - panel.offset().top,
      left: e.clientX - self._startX - panel.offset().left
    });

    // 크롬 IE 실행 문제 ( 사파리 안됨)
    if (
    navigator.appName === "Netscape" && navigator.userAgent.toLowerCase().indexOf("trident") !== -1 ||
    navigator.userAgent.toLowerCase().indexOf("msie") !== -1 ||
    navigator.userAgent.toLowerCase().indexOf("edge") !== -1)
    {
      var nodeList = document.msElementsFromPoint(e.clientX, e.clientY);
      findTarget = Array.prototype.slice.call(nodeList);
    } else {
      findTarget = document.elementsFromPoint(e.clientX, e.clientY);
    }

    $.each(findTarget, function (idx, html) {
      if ($(html).hasClass("dews-dashboard-tab-title") && !$(html).hasClass("drag")) {
        $target = $(html);
        return false;
      }
    });

    if ($target) {
      if ($target.offset().left + $target.width() / 2 < self.$title.offset().left) {
        $target.after(self.$title);
        self._$insertArea.after($target);
        $target.css({ position: "", top: "", left: "" });
        self.$title.after(self._$insertArea);
      } else if ($target.offset().left + $target.width() / 2 > self.$title.offset().left) {
        $target.before(self.$title);
        self._$insertArea.before($target);
        $target.css({ position: "", top: "", left: "" });
        self.$title.before(self._$insertArea);
      }
    }

    e.stopPropagation();
  }

  // 탭 아이템 드래그 종료 이벤트
  function tabItemDragEnd(e) {
    var self = e.data;

    self.$title.removeClass("drag");
    self._$insertArea.remove();
    delete self._startX;
    delete self._startY;
    delete self._$insertArea;

    self.$title.css({ position: "", left: "", top: "" });

    $(window).off("mousemove", tabItemDrag);
    $(window).off("mouseup", tabItemDragEnd);
  }

  /**
   * 탭 아이템 수정 시작
   */
  TabItem.prototype.startEditTitle = function () {
    var self = this;

    self.$editInput = $(
    '<input type="text" class="dews-ui-textbox dews-dashboard-title-text k-textbox dews-control-activate dews-form-control">');

    self.$editInput.val(self.options.data.TAB_NM);
    self.$editInput.css({
      position: "absolute",
      left: self.$title.offset().left - self.options.dashboard.$tabPanel.offset().left,
      top: self.$title.offset().top - self.options.dashboard.$tabPanel.offset().top,
      width: self.$title.outerWidth(),
      zIndex: 100
    });
    self.$title.after(self.$editInput);
    self.$editInput.focus();

    self.$editInput.on("keydown", function (e) {
      if (e.keyCode === 13) {
        self.endEditTitle();
      } else if (e.keyCode === 27) {
        self.$editInput.val(self.$title.find("> a").text());
        self.endEditTitle();
      }
    });

    $(document).on("click", self, documentClick);
  };

  function documentClick(e) {
    var self = e.data;
    if ($(e.target).closest(".dews-dashboard-title-text").length === 0) {
      self.endEditTitle();
    }
  }

  /**
   * 탭 아이템 수정 종료
   */
  TabItem.prototype.endEditTitle = function () {
    var self = this;

    self.$title.find("> a").text(self.$editInput.val());
    self.$editInput.remove();
    delete self.$editInput;
    self.options.data.TAB_NM = self.$title.find("> a").text();
    dews.ui.snackbar.ok("저장이 완료 되었습니다.");

    $(document).off("click", documentClick);
  };

  /**
   * 탭 아이템 하위 위젯 추가
   * @param data 추가할 위젯의 json 데이터
   */
  TabItem.prototype.addWidget = function (data) {
    var self = this,
      widgetDatas = [];

    if ($.type(data) === "object") {
      widgetDatas.push(data);
    } else if ($.type(data) === "array") {
      widgetDatas = data;
    }

    $.each(widgetDatas, function (idx, widgetData) {
      self.widgets.push(new Widget(widgetData, self));
    });
  };

  /**
   * 탭 아이템 활성화 비활성화 설정
   * @param enable 활성화 비활성화 설정 유무
   * @return {*} 활성화 비활성화 결과
   */
  TabItem.prototype.enable = function (enable) {
    var self = this,
      result;

    return result;
  };

  /**
   * 탭 아이템 삭제
   */
  TabItem.prototype.remove = function () {
    var self = this,
      index = self.$content.index(),
      dashboard = self.options.dashboard,
      flag = true;

    $.each(dashboard.options.addedTab, function (idx, value) {
      if (value.TAB_ID === self.options.data.TAB_ID) {
        flag = false;
        dashboard.options.addedTab.splice(idx, 1);
        return false;
      }
    });
    if (flag) {
      dashboard.options.deletedTab.push(self.options.data);
    }

    var widgetData = self.getData();
    $.each(widgetData.WIDGETS, function (idx, value) {
      var widgetFlag = true;
      $.each(dashboard.options.addedWidget, function (index, addedValue) {
        if (value.WIDGET_ID === addedValue.WIDGET_ID) {
          dashboard.options.addedWidget.splice(index, 1);
          widgetFlag = false;
          return false;
        }
      });

      if (widgetData) {
        var mergetData = self.options.data;
        delete mergetData.WIDGETS;
        delete mergetData.TAB_SQ;
        delete mergetData.STATUS;
        dashboard.options.deletedWidget.push(
        $.extend(true, self.getByWidgetId(value.WIDGET_ID).getData(), mergetData));

      }
    });

    self.$content.remove();
    var flag = false;
    if (self.$title.hasClass("tab-selected")) {
      flag = true;
    }
    self.$title.remove();

    var titles = self.options.dashboard.$element.find(".dews-dashboard-tab-title");
    if (titles.length !== 0) {
      titles.eq(0).click();
    }

    dashboard.tabItem.splice(index, 1);
  };

  /**
   * 탭 아이템 데이터 반홬
   * @return {*} 탭 아이템 json 데이터
   */
  TabItem.prototype.getData = function () {
    var self = this,
      data = [];

    if (parseInt(self.options.data.TAB_SQ) !== self.$title.index()) {
      self.options.dashboard.options.data.changeIndex = true;
    }

    if (self.options.opened) {
      $.each(self.widgets, function (idx) {
        data.push(self.widgets[idx].getData());
      });
    } else {
      data = self.options.data.WIDGETS;
    }

    self.options.data.TAB_SQ = self.$title.index();
    self.options.data.WIDGETS = data;

    return self.options.data;
  };
  /**
   * 탭 아이템 하위 위젯 검색
   * @param id 검색할 위젯 id
   * @return {*} 위젯 객체
   */
  TabItem.prototype.getByWidgetId = function (id) {
    var self = this,
      widget;

    $.each(self.widgets, function (idx, value) {
      if (value.id === id) {
        widget = value;
      }
    });

    return widget;
  };

  /**
   * 탭 아이템 이벤트 추가
   */
  TabItem.prototype.on = function () {
    var self = this;

    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    } else if (arguments[0] === "changing") {
      Array.prototype.splice.call(arguments, 0, 1, "_changing");
    }

    self.$title.on.apply(self.$title, arguments);
  };

  /**
   * 탭 아이템 이벤트 삭제
   */
  TabItem.prototype.off = function () {
    var self = this;

    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    } else if (arguments[0] === "changing") {
      Array.prototype.splice.call(arguments, 0, 1, "_changing");
    }

    self.$title.off.apply(self.$title, arguments);
  };

  /**
   * 위젯 객체 생성
   * @param data 위젯을 생설할 json 데이터
   * @param tabItem 위젯 부모 탭 아이템 객체
   * @return {Widget} 위젯 객체
   * @constructor
   */
  var Widget = function Widget(data, tabItem) {
    var self = this;

    self.options = {
      data: data,
      tabItem: tabItem,
      type: tabItem.options.type
    };
    self.id = data.WIDGET_ID;
    self.col =
    dews._environments.dispWidgetCnt !== "0" && data.WIDGET_BT > dews._environments.dispWidgetCnt ?
    dews._environments.dispWidgetCnt :
    data.WIDGET_BT;
    data.TAB_ID = tabItem.options.data.TAB_ID;

    if ($.type(self.options.data.WIDGET_LOCK_YN) === "undefined") {
      self.options.data.WIDGET_LOCK_YN = "N";
    }

    if ($.type(self.options.data.STATUS) === "undefined" || $.type(self.options.data.STATUS) === "null") {
      self.options.data.STATUS = "NONE";
    }

    self._init();
    self._bindEvent();

    self.$content.data("dews-control", self);

    return self;
  };

  /**
   * 위젯 html 생성
   * @private
   */
  Widget.prototype._init = function () {
    var self = this,
      data = self.options.data;

    self.$content = $('<div class="section dews-widget"></div>');

    self.$content.addClass("theme-shadow");

    if (self.options.type === "viewer") {
      self.isViewer = true;
    } else {
      self.isViewer = false;
    }
    // 컨피규레이션 조회조건 저장
    self.config = {
      data: {}
    };
    self.sample = {
      data: new SampleData()
    };
    self.env = $.type(dews.ui.page) === "object" ? dews.ui.page.env : {};
    dews.ui[self.id] = self;

    // 환경설정 파라미터 존재시 파라미터 설정
    if (self.options.data.CONFIG && self.options.data.CONFIG.length !== 0) {
      var params = {};
      $.each(self.options.data.CONFIG, function (idx, value) {
        params[value.MST_WIDGET_COL_VR] = value.WIDGET_COND_CD;
      });
      self.config.params = params;
    }

    if ($.type(self.id) !== "undefined") {
      self.$content.attr("ID", self.id);
    }

    if (self.col > 1) {
      self.$content.addClass("section--width-" + self.col);
    }

    if (self.options.type === "modeler") {
      self.$content.insertBefore(self.options.tabItem.$addBtn);
    } else {
      self.options.tabItem.$content.append(self.$content);
    }

    var url = "/widget/" + data.WIDGET_ID;

    self.$content.load(url, null, function () {
      if (self.$content.find("> div.dews-widget-container").length === 0) {
        var allData = self.$content.find("> *");
        self.$content.append($('<div class="dews-widget-container"></div>'));
        self.$content.find("> div.dews-widget-container").append(allData);
      }

      $(document).trigger("inituicontrols", [self.$content]);
      if (dews.ui[self.id]._error && self.options.type === "viewer") {
        self.options.tabItem.options.dashboard.options.error = dews.ui[self.id]._error;
        self._createError();
      }
      delete dews.ui[self.id];

      if (self.options.type === "modeler") {
        self._updateWidgetArea();
      }

      if (data.WIDGET_NM_DISP_YN === "Y") {
        self.$content.
        find(".dews-widget-container").
        prepend(
        $(
        '<div class="area-title">' +
        '        <h3 class="tit">' +
        data.WIDGET_NM +
        "</h3>" +
        '        <div class="btn-actions">' +
        "        </div>" +
        "      </div>"));


      }

      self.$content.addClass("dews-widget-activate");

      // 환경설정 아이콘 추가
      if (self.config.data.control && self.config.data.control.length !== 0) {
        self.$content.
        find(".area-title .btn-actions").
        append(
        $('<a role="button" href="#" class="btn-link"><span class="icon-config">환경설정</span></a>'));

      }

      // 새로고침 주기 아이콘 표시
      if (self.options.data.REFRESH_USE_YN === "Y") {
        self.$content.
        find(".area-title .btn-actions").
        append(
        $('<a role="button" href="#" class="btn-link"><span class="icon-refresh">reload</span></a>'));

      }

      // 연결 안함을 제외하고 링크 표시
      if (self.options.data.CONN_TP !== "1") {
        self.$content.
        find(".area-title .btn-actions").
        append($('<a role="button" class="btn-link"><span class="icon-arrow"></span></a>'));
      }

      var height = self.options.tabItem.$content.height();
      self.options.tabItem.masonry.masonry("destroy");
      self.options.tabItem.$content.css("height", height);
      self.options.tabItem.masonry.masonry({
        columnWidth: self.options.tabItem.columnWidth
      });

      var params = {
        widget: self
      };
      var event = new $.Event("widgetLoad", params);
      self.$content.trigger(event);

      dews.ready(function () {
        if (self.options.tabItem.$content.is(":visible")) {
          self.options.tabItem.masonry.masonry({
            columnWidth: self.options.tabItem.columnWidth
          });
        }
      });
    });
  };

  /**
   * 위젯 마우스 오버시 나타나는 영역 생성
   * @private
   */
  Widget.prototype._updateWidgetArea = function () {
    var self = this,
      data = self.options.data,
      dashboard = self.options.tabItem.options.dashboard;

    // 마우스 hover 영역 생성
    self.$updateWidgetArea = $('<div class="dews-widget-update-area"></div>');
    self.$content.find(".dews-widget-container").append(self.$updateWidgetArea);

    var buttonArea = $('<div class="dews-widget-button-area"></div>');
    self.$updateWidgetArea.after(buttonArea);

    if (dashboard.options.page === "user" && data.WIDGET_LOCK_YN === "Y") {
      var authority = $('<div class="dews-widget-authority">편집권한이 없습니다.</div>');
      buttonArea.append(authority);
    } else {
      // 관리자 위젯 고정 버튼 영역 생성
      // if (dashboard.options.page === 'admin') {
      //     self.$widgetFixBtn = $('<button type="button" class="dews-ui-button dews-control k-button dews-control-activate dews-widget-fix-btn"></button>');
      //     if (self.options.data.WIDGET_LOCK_YN === 'Y') {
      //         self.$content.addClass('dews-fixed');
      //         self.$widgetFixBtn.addClass('dews-fixed');
      //     }
      //     buttonArea.append(self.$widgetFixBtn);
      // }

      // 관리자 위젯 환경설정 버튼 영역 생성
      if (Object.keys(self.config.data).length !== 0) {
        self.$widgetConfigBtn = $(
        '<button type="button" class="dews-ui-button dews-control k-button dews-control-activate dews-widget-config-btn"></button>');

        buttonArea.append(self.$widgetConfigBtn);
      }

      // 관리자 위젯 수정 버튼 영역 생성
      if ($.type(self.$editContent) !== "undefined") {
        self.$widgetEditBtn = $(
        '<button type="button" class="dews-ui-button dews-control k-button dews-control-activate dews-widget-edit-btn"></button>');

        buttonArea.append(self.$widgetEditBtn);
      }

      // 위젯 삭제 버튼 영역 생성
      self.$widgetRemoveBtn = $(
      '<button type="button" class="dews-ui-button dews-control k-button dews-control-activate dews-widget-remove-btn"></button>');

      buttonArea.append(self.$widgetRemoveBtn);
    }
  };

  /**
   * 위젯 미리보기 사용시 오류가 발생하였을때 발생
   * @private
   */
  Widget.prototype._createError = function () {
    var self = this;

    var errorBg = $(
    '<div class="dews-widget-error-background"><p class="dews-widget-error-text">' +
    dews.localize.get("위젯로딩중 오류가 발생하였습니다.") +
    "</p></div>");


    self.$content.find(".dews-widget-container").append(errorBg);
  };

  /**
   * 위젯 이벤트
   * @private
   */
  Widget.prototype._bindEvent = function () {
    var self = this,
      data = self.options.data;

    // 대시보드 뷰어일 경우 타이틀 클릭시 해당 링크로 이동하는 이벤트
    if (self.options.type === "viewer") {
      self.$content.on("click", ".dews-widget-container > .area-title .btn-actions .icon-arrow", function (e) {
        if (data.CONN_TP === "2") {
          if (data.MODULE_CD && data.MENU_CD) {
            dews.ui.openMenu(data.MODULE_CD, data.MENU_CD, {
              widget: true
            });
          }
        } else if (data.CONN_TP === "3") {
          if (data.CONN_URL) {
            dews.ui.openCustomPage(data.CONN_URL);
          }
        } else if (data.CONN_TP === "4") {
          if (data.CONN_URL) {
            window.location.href = data.CONN_URL;
          }
        } else if (data.CONN_TP === "5") {
          if (data.CONN_URL) {
            window.open(data.CONN_URL);
          }
        }
        e.stopPropagation();
      });

      // 대시보드 새로 고침 이벤트
      self.$content.on("click", ".dews-widget-container > .area-title .btn-actions .icon-refresh", function (e) {
        self.reload();
      });

      // 대시보드 환경설정 이벤트
      self.$content.on("click", ".dews-widget-container > .area-title .btn-actions .icon-config", function (e) {
        var params = {
            widget: self
          },
          event = new $.Event("setConfig", params);

        self.options.tabItem.options.dashboard.$element.trigger(event);
      });
    }

    // 대시보드 모델러일경우 이벤트
    if (self.options.type === "modeler") {
      // 대시보드 드래그 앤 드롭 이벤트
      self.$content.on("mousedown", self, dragStartEvent);

      // 위젯 삭제 버튼
      self.$content.on("click", ".dews-widget-remove-btn", function (e) {
        self.remove();
        e.stopPropagation();
      });

      // 위젯 수정 버튼
      self.$content.on("click", ".dews-widget-edit-btn .icon-arrow", function (e) {
        var dialog = dews.ui.dialog("editDialog", {
          title: self.options.data.WIDGET_NM + " 설정",
          content: self.$editContent,
          buttons: "applyAndClose",
          ok: function ok(data) {
            $.each(Object.keys(data), function (idx, value) {
              self.options.data[value] = data[value];
            });
          }
        });

        dialog.setInitData();

        dialog.open();

        dialog.buttons.ok.on("click", function () {
          var formpanel = dews.ui.dialogPage.$content.find(".dews-form-panel").data("dews-control");
          dialog.ok(formpanel.serialize());
        });
        e.stopPropagation();
      });

      // 위젯 환경설정 버튼
      self.$content.on("click", ".dews-widget-config-btn", function (e) {
        var configParams = {
          widget: self
        };
        var configEvent = new $.Event("setConfig", configParams);
        self.options.tabItem.options.dashboard.$element.trigger(configEvent);
      });

      // 위젯 고정 버틐
      self.$content.on("click", ".dews-widget-fix-btn", function (e) {
        if (self.options.data.WIDGET_LOCK_YN === "Y") {
          self.$content.removeClass("dews-fixed");
          self.options.data.WIDGET_LOCK_YN = "N";
        } else {
          self.$content.addClass("dews-fixed");
          self.options.data.WIDGET_LOCK_YN = "Y";
        }

        if (self.options.data.STATUS === "NONE") {
          self.options.data.STATUS = "UPDATED";
        } else {
          self.options.data.STATUS = "NONE";
        }

        e.stopPropagation();
      });
    }
  };

  /**
   * 위젯 변수 선언 설정 하는 부분
   * @param $controls 위젯 컨트롤 객체
   */
  Widget.prototype.makeProperties = function ($controls) {
    var self = this;
    if ($controls.length > 0) {
      $.each($controls, function (idx, item) {
        var $item = $(item);
        if ($item.prop("id")) {
          if ($item.is("[class*=dews-ui-]")) {
            Object.defineProperty(self, item.id, {
              get: function get() {
                return getDewsComponentInstance($item);
              }
            });
          }

          if (!self.hasOwnProperty("$" + item.id)) {
            Object.defineProperty(self, "$" + item.id, {
              get: function get() {
                return $item;
              }
            });
          }
        }
      });
    }
  };

  function getDewsComponentInstance($control) {
    var dewsComponent = null;
    if ($control.length === 1) {
      // 각 컨트롤 별로 컨트롤의 인스턴스를 반환합니다.
      if ($control.data("dews-control")) {
        dewsComponent = $control.data("dews-control");
      }
    }
    return dewsComponent;
  }

  /**
   * 위젯 활성화 비활성화 설정
   * @param enable 활성화 비활성화 설정 유무
   * @return {*} 활성화 비활성화 결과
   */
  Widget.prototype.enable = function (enable) {
    var self = this,
      result;

    return result;
  };

  /**
   * 위젯 삭제
   */
  Widget.prototype.remove = function () {
    var self = this,
      index = self.$content.index(),
      tabItem = self.options.tabItem,
      dashboard = tabItem.options.dashboard;

    // 삭제 로직 추가
    var flag = true;
    $.each(dashboard.options.deletedWidget, function (idx, value) {
      if (value.WIDGET_ID === self.options.data.WIDGET_ID) {
        flag = false;
        dashboard.splice(idx, 1);
        return false;
      }
    });
    if (flag) {
      dashboard.options.deletedWidget.push(self.options.data);
    }
    self.$content.remove();
    tabItem.masonry.masonry("remove", self.$content);
    tabItem.widgets.splice(index, 1);
    tabItem.masonry.masonry({ columnWidth: tabItem.columnWidth });
  };

  /**
   * 위젯 json 데이터 반환
   * @return {*} 위젯 json 데이터
   */
  Widget.prototype.getData = function () {
    var self = this,
      data = self.options.data;

    if (parseInt(data.WIDGET_SQ) !== self.$content.index()) {
      self.options.tabItem.options.dashboard.options.data.changeIndex = true;
    }

    data.WIDGET_SQ = self.$content.index();
    self.options.tabItem.options.dashboard.widget.push(data.WIDGET_ID);

    return data;
  };

  /**
   * 위젯 이벤트 추가
   */
  Widget.prototype.on = function () {
    var self = this;

    self.$content.on.apply(self.$content, arguments);
  };

  /**
   * 위젯 이벤트 종료
   */
  Widget.prototype.off = function () {
    var self = this;

    self.$content.off.apply(self.$content, arguments);
  };

  /**
   * 위젯 새로 고침
   */
  Widget.prototype.reload = function () {
    var self = this,
      data = self.options.data;

    var url = "/widget/" + data.WIDGET_ID;
    dews.ui[self.id] = $.extend(true, {}, self);
    self.$content.load(url, null, function () {
      if (self.$content.find("> div.dews-widget-container").length === 0) {
        var allData = self.$content.find("> *");
        self.$content.append($('<div class="dews-widget-container"></div>'));
        self.$content.find("> div.dews-widget-container").append(allData);
      }

      $(document).trigger("inituicontrols", [self.$content]);
      delete dews.ui[self.id];

      if (self.options.type === "modeler") {
        self._updateWidgetArea();
      }

      if (data.WIDGET_NM_DISP_YN === "Y" && self.$content.find(".area-title").length === 0) {
        self.$content.
        find(".dews-widget-container").
        prepend(
        $(
        '<div class="area-title">' +
        '        <h3 class="tit">' +
        data.WIDGET_NM +
        "</h3>" +
        '        <div class="btn-actions">' +
        "        </div>" +
        "      </div>"));


      }

      self.$content.addClass("dews-widget-activate");

      var $titleArea = $(".area-title", self.$content);

      // 환경설정 아이콘 추가
      if (
      self.options.data.CONFIG &&
      self.options.data.CONFIG.length !== 0 &&
      $titleArea &&
      $titleArea.find(".icon-config").length === 0)
      {
        self.$content.
        find(".area-title .btn-actions").
        append(
        $('<a role="button" href="#" class="btn-link"><span class="icon-config">환경설정</span></a>'));

      }

      // 새로고침 주기 아이콘 표시
      if (
      self.options.data.REFRESH_USE_YN === "Y" &&
      $titleArea &&
      $titleArea.find(".icon-refresh").length === 0)
      {
        self.$content.
        find(".area-title .btn-actions").
        append(
        $('<a role="button" href="#" class="btn-link"><span class="icon-refresh">reload</span></a>'));

      }

      // 연결 안함을 제외하고 링크 표시
      if (self.options.data.CONN_TP !== "1" && $titleArea && $titleArea.find(".icon-arrow").length === 0) {
        self.$content.
        find(".area-title .btn-actions").
        append($('<a role="button" class="btn-link"><span class="icon-arrow"></span></a>'));
      }

      var height = self.options.tabItem.$content.height();
      self.options.tabItem.masonry.masonry("destroy");
      self.options.tabItem.$content.css("height", height);
      self.options.tabItem.masonry.masonry({
        columnWidth: self.options.tabItem.columnWidth
      });

      var params = {
        widget: self
      };
      var event = new $.Event("widgetLoad", params);
      self.$content.trigger(event);

      dews.ready(function () {
        if (self.options.tabItem.$content.is(":visible")) {
          self.options.tabItem.masonry.masonry({
            columnWidth: self.options.tabItem.columnWidth
          });
        }
      });
    });
  };

  /**
   * 샘플데이터 객체 생성
   */
  var SampleData = function SampleData() {
    var self = this;

    self.options = {
      data: {}
    };

    return self;
  };

  /**
   * 샘플 데이터 추가
   * @param key 샘플데이터 명
   * @param value 샘플데이터
   */
  SampleData.prototype.add = function (key, value) {
    var self = this;
    if ($.type(self.options.data[key]) === "undefined") {
      self.options.data[key] = value;
    }
  };

  /**
   * 샘플 데이터 호출
   * @param key 샘플데이터 명
   * @return {*} 샘플데이터
   */
  SampleData.prototype.get = function (key) {
    var self = this;

    return self.options.data[key];
  };

  $.extend(true, dews, {
    ui: {
      dashboardviewer: function dashboardviewer(element) {
        var $el, dashboardviewer;

        if (element instanceof jQuery) {
          $el = element;
        } else if ($.type(element) === "string") {
          $el = $(element);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var dv,
            $this = $(this);

          dv = $this.data("dews-control");

          if (!dv) {
            if (!$this.hasClass("dews-ui-dashboardviewer")) {
              $this.addClass("dews-ui-dashboardviewer");
            }

            dv = new DashboardViewer($this);

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            $this.data("dews-control", dv);
          }

          dashboardviewer = dv;
        });

        return dashboardviewer;
      },
      dashboardmodeler: function dashboardmodeler(element) {
        var $el, dashboardmodeler;

        if (element instanceof jQuery) {
          $el = element;
        } else if ($.type(element) === "string") {
          $el = $(element);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var dm,
            $this = $(this);

          dm = $this.data("dews-control");

          if (!dm) {
            if (!$this.hasClass("dews-ui-dashboardmodeler")) {
              $this.addClass("dews-ui-dashboardmodeler");
            }

            dm = new DashboardModeler($this);

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            $this.data("dews-control", dm);
          }

          dashboardmodeler = dm;
        });

        return dashboardmodeler;
      }
    }
  });

  dews.ui.addControlInitializer("dashboardmodeler", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.dashboardmodeler($("div.dews-ui-dashboardmodeler", $container));
  });

  dews.ui.addControlInitializer("dashboardviewer", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.dashboardviewer($("div.dews-ui-dashboardviewer", $container));
  });
})(jQuery, window.dews);


/*
 * 날짜피커,  시간피커,  월피커
 */
(function ($, dews, kendo) {
  var DatePickerBase = dews.ui.DatePickerBase;

  function getDefaultDateOptions() {
    return {
      format: dews._environments.formats.dateFormat,
      valueFormat: dews._environments.formats.dateValueFormat,
      footer: false,
      holidays: {
        type: "1",
        visible: false,
        disabled: false
      },
      max: kendo.parseDate("99991231", dews._environments.formats.dateValueFormat, kendo.getCulture()),
      min: kendo.parseDate("10000101", dews._environments.formats.dateValueFormat, kendo.getCulture()),
      dateStyles: []
    };
  }

  var DatePicker = function DatePicker($this, options) {
    var datepicker;
    var opt = this.getOptions($this, getDefaultDateOptions(), options);

    if (!$this.hasClass("dews-ui-datepicker")) {
      $this.addClass("dews-ui-datepicker");
    }

    if (!$this.hasClass("dews-form-control")) {
      $this.addClass("dews-form-control");
    }

    if (!$this.hasClass("dews-control-activate")) {
      $this.addClass("dews-control-activate");
    }

    dews.ui.util.ConvertClassAndProperty($this);

    $this.kendoDatePicker(opt);

    datepicker = $this.data("kendoDatePicker");
    datepicker.options.valueFormat = opt.valueFormat;

    this.initControl($this, "datepicker");
    this.setMask($this, opt.format);
    this.setEvent($this, opt);
    this._setOptions(datepicker, opt);

    DatePickerBase.call(this, datepicker);
  };

  DatePicker.prototype = Object.create(DatePickerBase.prototype);
  DatePicker.prototype.constructor = DatePicker;

  DatePicker.prototype.setDateStyle = function (date, css) {
    var self = this;

    if (date && $.type(css) === "string") {
      self.options.dateStyles.push({ date: date, style: css });
      console.log("wlstjr2", self.dateView);

      if (self.dateView.calendar) {
        self.dateView.calendar._dateStyle();
      }
    }
  };

  $.extend(true, dews, {
    ui: {
      /**
       * 년월일을 받아오는 날짜 피커를 생성하거나 가져옵니다.
       * @param {string|jQuery} selector 피커로 변경될 요소를 지정하는 셀럭터 또는 jQuery 객체입니다.
       * @param {object} [options] 피커 설정 값입니다.
       */
      datepicker: function datepicker(selector, options) {
        var $el, datepicker;

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var picker,
            $this = $(this);

          picker = $this.data("dews-control");

          if (!picker) {
            picker = new DatePicker($this, options);

            $this.data("dews-control", picker);
          }

          datepicker = picker;
        });

        return datepicker;
      }
    }
  });

  dews.ui.addControlInitializer("datepicker", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.datepicker($('input[type="text"].dews-ui-datepicker', $container));
  });
})(jQuery, window.dews, window.kendo);


/*
 * 년월일시분을 받아오는 일시 피커
 */
(function ($, dews, kendo) {
  var DatePickerBase = dews.ui.DatePickerBase;

  function getDefaultDateTimeOptions() {
    return {
      format: dews._environments.formats.dateTimeFormat,
      valueFormat: dews._environments.formats.dateTimeValueFormat,
      holidays: {
        type: "1",
        visible: false,
        disabled: false
      },
      max: kendo.parseDate("99991231235959", dews._environments.formats.dateTimeValueFormat, kendo.getCulture()),
      min: kendo.parseDate("10000101000000", dews._environments.formats.dateTimeValueFormat, kendo.getCulture()),
      dateStyles: []
    };
  }

  var DateTimePicker = function DateTimePicker($ctrl, options) {
    var datetimepicker;
    var opt = this.getOptions($ctrl, getDefaultDateTimeOptions(), options);

    if (!$ctrl.hasClass("dews-ui-datetimepicker")) {
      $ctrl.addClass("dews-ui-datetimepicker");
    }

    if (!$ctrl.hasClass("dews-form-control")) {
      $ctrl.addClass("dews-form-control");
    }

    if (!$ctrl.hasClass("dews-control-activate")) {
      $ctrl.addClass("dews-control-activate");
    }

    dews.ui.util.ConvertClassAndProperty($ctrl);
    $ctrl.kendoDateTimePicker(opt);

    datetimepicker = $ctrl.data("kendoDateTimePicker");
    datetimepicker.options.valueFormat = opt.valueFormat;

    this.initControl($ctrl, "datetimepicker");
    this.setMask($ctrl, opt.format);
    this.setEvent($ctrl, opt);
    this._setOptions(datetimepicker, opt);

    DatePickerBase.call(this, datetimepicker);
  };

  DateTimePicker.prototype = Object.create(DatePickerBase.prototype);
  DateTimePicker.prototype.constructor = DateTimePicker;

  kendo.ui.DateTimePicker.fn._keydown = function (e) {
    var that = this,
      dateView = that.dateView,
      timeView = that.timeView,
      value = that.element.val(),
      isDateViewVisible = dateView.popup.visible();
    var stopPropagation = that._dateInput && e.stopImmediatePropagation;
    if (value.indexOf("_") === 0) {
      value = "";
    }
    if (e.altKey && e.keyCode === kendo.keys.DOWN) {
      that.toggle(isDateViewVisible ? "time" : "date");
    } else if (isDateViewVisible) {
      dateView.move(e);
      that._updateARIA(dateView._current);
    } else if (timeView.popup.visible()) {
      timeView.move(e);
    } else if (e.keyCode === kendo.keys.ENTER && value !== that._oldText) {
      that._change(value);
    } else {
      that._typing = true;
      stopPropagation = false;
    }
    if (stopPropagation) {
      e.stopImmediatePropagation();
    }
  };

  kendo.ui.DateTimePicker.fn._editable = function (options) {
    var that = this,
      ns = ".kendoDateTimePicker",
      element = that.element.off(ns),
      dateIcon = that._dateIcon.off(ns),
      timeIcon = that._timeIcon.off(ns),
      wrapper = that._inputWrapper.off(ns),
      readonly = options.readonly,
      disable = options.disable;
    if (!readonly && !disable) {
      wrapper.addClass("k-state-default").removeClass("k-state-disabled").on("mouseenter", that._toggleHover);
      element.
      removeAttr("disabled").
      removeAttr("readonly").
      attr("aria-disabled", false).
      on("keydown" + ns, $.proxy(that._keydown, that)).
      on("focus" + ns, function () {
        that._inputWrapper.addClass("k-state-focused");
      }).
      on("focusout" + ns, function () {
        var value = element.val();
        if (value.indexOf("_") === 0) {
          value = "";
        }
        that._inputWrapper.removeClass("k-state-focused");
        if (value !== that._oldText) {
          that._change(element.val());
        }
        that.close("date");
        that.close("time");
      });
      dateIcon.on("mousedown.kendoDateTimePicker", preventDefault).on("click.kendoDateTimePicker", function () {
        that.toggle("date");
        if (!kendo.support.touch && element[0] !== kendo._activeElement()) {
          element.focus();
        }
      });
      timeIcon.on("mousedown.kendoDateTimePicker", preventDefault).on("click.kendoDateTimePicker", function () {
        that.toggle("time");
        if (!kendo.support.touch && element[0] !== kendo._activeElement()) {
          element.focus();
        }
      });
    } else {
      wrapper.
      addClass(disable ? "k-state-disabled" : "k-state-default").
      removeClass(disable ? "k-state-default" : "k-state-disabled");
      element.attr("disabled", disable).attr("readonly", readonly).attr("aria-disabled", disable);
    }
  };

  DateTimePicker.prototype.setDateStyle = function (date, css) {
    var self = this;

    if (date && $.type(css) === "string") {
      self.options.dateStyles.push({ date: date, style: css });

      if (self.dateView.calendar) {
        self.dateView.calendar._dateStyle();
      }
    }
  };

  function preventDefault(e) {
    e.preventDefault();
  }

  $.extend(true, dews, {
    ui: {
      /**
       * 년월일시분을 받아오는 일시 피커를 생성하거나 가져옵니다.
       * @param {string|jQuery} selector 피커로 변경될 요소를 지정하는 셀렉터 또는 jQuery객체입니다.
       * @param {object} [options] 피커 설정 값입니다.
       */
      datetimepicker: function datetimepicker(selector, options) {
        var $el,
          datetimepicker = null;

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var picker,
            $ctrl = $(this);

          picker = $ctrl.data("dews-control");

          if (!picker) {
            picker = new DateTimePicker($ctrl, options);

            $ctrl.data("dews-control", picker);
          }

          datetimepicker = picker;
        });

        return datetimepicker;
      }
    }
  });

  dews.ui.addControlInitializer("datetimepicker", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.datetimepicker($('input[type="text"].dews-ui-datetimepicker', $container));
  });
})(jQuery, window.dews, window.kendo);


/*
 * 다이얼로그 창
 */
(function ($, dews, kendo) {
  dews.preReadies = dews.preReadies || [];

  /*
   * 도움창에 그리드가 없을 경우 포커스가 페이지에 남아있어서,
   * 다이얼로그 내의 첫번째 폼컨트롤을 찾아서 포커스를 줍니다.
   */
  dews.preReadies.push(function () {
    if (dews.ui.dialogPage && dews.ui.dialogPage.dialog) {
      if (dews.ui.dialogPage.dialog.element && dews.ui.dialogPage.dialog.element.length > 0) {
        var $kWin = dews.ui.dialogPage.dialog.element;
        var $control = $kWin.find("*[class^=dews-ui-].dews-form-control").eq(0);

        if ($control.length > 0 && findDataControl($kWin)) {
          var instance = $control.data("dews-control");

          if (instance && $.isFunction(instance.focus)) {
            if (
            $control.hasClass("dews-ui-yearpicker") ||
            $control.hasClass("dews-ui-datepicker") ||
            $control.hasClass("dews-ui-timepicker") ||
            $control.hasClass("dews-ui-monthpicker") ||
            $control.hasClass("dews-ui-datetimepicker") ||
            $control.attr("class").match(/periodpicker/) !== null)
            {
              setTimeout(function () {
                instance.focus();
              }, 20);
            } else {
              instance.focus();
            }
          }
        }
      }
    }
  });

  /*
   * 다이얼로그 내에 데이터 컨트롤이 있는지 확인합니다. (초기화 전이라 클래스 명으로 판단)
   */
  function findDataControl($element) {
    var checkDataControl = ".dews-ui-grid, .dews-ui-treegrid, .dews-ui-cardlist, .dews-ui-treeview";

    return !($element.find(checkDataControl) && $element.find(checkDataControl).length > 0);
  }

  /*
   * iframe 형식(메인 프레임 내부의 iframe에 비지니스 페이지가 임베딩되는 형식)으로 구성된 레이아웃에서는
   * 모달 다이얼로그 창은 iframe 내부가 아닌 메인 프레임에서 떠야 합니다.
   */

  var defaultTargetFrame = "_main",
    makingDialogId = [],
    makeDialog = true,
    defaultOptions = {
      modal: true, // 모달 여부
      width: 640, // 다이얼로그 너비(px)
      height: 240, // 다이얼로그 높이(px)
      size: "medium", // 다이얼로그의 사이즈 설정 (small, medium, large, extra)
      draggable: true, // 다이얼로그 이동 가능 여부
      resizable: false, // 다이얼로그 사이즈 조절 가능 여부
      url: "", // 다이얼로그 컨텐츠 URL
      iframe: false, // 아이프레임 사용여부,
      buttons: "none", // 다이얼로그 버튼 영역을 설정
      buttonFocus: false, // 방향키로 버튼그룹간의 포커스이동 여부 설저
      border: "",
      animation: {
        open: { duration: 100 },
        close: { duration: 100 }
      }
    };

  // 에러 페이지 정의
  var transparentImg = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA",
    error401Page =
    '<div class="dews-dialog-error">' +
    '<img src="' +
    transparentImg +
    '" class="dews-dialog-error-img">' +
    '<div class="dews-dialog-error-title">401 Unauthorized</div>' +
    "</div>",
    error404Page =
    '<div class="dews-dialog-error">' +
    '<img src="' +
    transparentImg +
    '" class="dews-dialog-error-img">' +
    '<div class="dews-dialog-error-title">404 page not found</div>' +
    "</div>",
    error500Page =
    '<div class="dews-dialog-error">' +
    '<img src="' +
    transparentImg +
    '" class="dews-dialog-error-img">' +
    '<div class="dews-dialog-error-title">500 Internal server error</div>' +
    "</div>";

  /**
   * 다이얼로그 창
   * @param {string} id 다이얼로그 아이디
   * @param {object} [options] 다이얼로그 설정 값
   * @param {boolean} [useMain] 다이얼로그가 메인 프레임에 생성되는지 여부
   * @constructor
   */
  function DialogWindow(id, options, useMain) {
    var self = this;
    var modal = options.modal;

    self.id = id;
    self.options = $.extend(true, {}, defaultOptions, options);
    self.initData = null;
    self.buttons = {
      ok: $('<button class="dews-ui-button confirm ok"></button>'),
      cancel: $('<button class="dews-ui-button confirm cancel"></button>')
    };

    // 옵션 사이즈 별로 너비 높이 설정
    switch (self.options.size.toLowerCase()) {
      case "small":
        self.options.width = 360;
        self.options.height = 240;
        break;
      case "large":
        self.options.width = 746;
        self.options.height = 630;
        break;
      case "extra":
        self.options.width = 1095;
        self.options.height = 630;
        break;
      default:
        self.options.width = 560;
        self.options.height = 600;
        break;}

    // 옵션 너비 설정
    if ($.type(options.width) !== "undefined") {
      self.options.width = options.width;
    }
    // 옵션 높이 설정
    if ($.type(options.height) !== "undefined") {
      self.options.height = options.height;
    }

    if (options.width === "large") {
      if (!options.height) {
        self.options.height = 630;
      }
    } else if (options.width === "medium") {
      if (!options.height) {
        self.options.height = 600;
      }
    }

    if (useMain) {
      self.target = getMainFrameWindowObject(window);
    } else {
      self.target = window;
    }

    if (options) {
      if (options.hasOwnProperty("initData")) {
        // 초기화 데이터 설정
        self.initData = options.initData;
        delete options.initData;
      }
    }
  }

  /**
   * 다이얼로그 창을 엽니다.
   * @param {boolean} center 화면 중앙에 다이얼로그를 표시할지 여부
   */
  DialogWindow.prototype.open = function (center) {
    var self = this,
      kendoOptions,
      contentUrl,
      $kWin,
      kWin;

    if (!makeDialog) {
      makeDialog = true;
      return;
    }

    if ($.type(center) !== "boolean") {
      if (self.options.hasOwnProperty("position")) {
        center = false;
      } else {
        center = true;
      }
    }

    // kendo Dialog 옵션
    kendoOptions = $.extend(true, {}, self.options);

    if (kendoOptions.url) {
      // 다이얼로그 내부 URL 을 설정
      contentUrl = dews.url.getAbsoluteUrl(kendoOptions.url);

      if (kendoOptions.iframe) {
        // iframe 방식 로드
        if (!kendoOptions.content) {
          kendoOptions.content = contentUrl;
        }
      }

      delete kendoOptions.url;
      delete kendoOptions.buttonFocus;
    }

    kendoOptions.open = function (e) {
      if (self.options && $.type(self.options.open) === "function") {
        self.options.open.call(self, e);
      }
      self._initControl();
    };

    kendoOptions.activate = function () {
      // self._initControl();
      self._renderButtons();

      // 컨테이너 내부에서 신규로 로드된 컨트롤의 초기화하기 위해서 이벤트를 발생시킨다.
      $(document).trigger("inituicontrols", ["#" + self.id, self]);
    };

    kendoOptions.close = function (e) {
      if ($.type(self.options.close) === "function") {
        // 옵션에 설정되어 있는 close 함수를 호출한다.
        self.options.close.call(self, e);
      }

      // 메시지박스를 띄운 후 dialogPage를 삭제해서 발생하는 다국어 이슈로 인한 코드 삭제
      // delete dews.ui.dialogPage;
    };

    /*
    다이얼로그 창이 닫히면 다이얼로그 엘리먼트 자체를 삭제해야 합니다.
    그렇지 않으면 다시 동일한 아이디의 다이얼로그를 띄울 때
    이전 내용이 보이다 새로운 내용으로 교체되는 현상이 발생합니다.
    */
    kendoOptions.deactivate = function () {
      makingDialogId.splice(makingDialogId.indexOf(self.id), 1);
      self._kendoWindow.destroy();

      // 다이얼로그 내의 코드피커/멀티코드피커에서 값 세팅된 채로 마우스오버하면 툴팁이 나오는데
      // 마우스오버된 채로 esc키로 닫을 시, 툴팁이 그대로 남아있는 현상 수정 => 다이얼로그 id로 찾아서 그에 속하는 툴팁만 삭제
      var tooltipClass = ".tooltip." + self.id;
      $(tooltipClass).remove();
    };

    $kWin = self.target.$("#" + self.id + ".dews-ui-dialog");

    if ($kWin.length > 0) {
      kWin = $kWin.eq(0).data("kendoWindow");
    } else {
      $kWin = self.target.$(dews.string.format('<div id="{0}" />', self.id));
      $kWin.addClass("dews-ui-dialog");

      if (kendoOptions.size === "small") {
        $kWin.addClass("dews-ui-dialog small");
      } else if (kendoOptions.size === "medium") {
        $kWin.addClass("dews-ui-dialog medium");
      } else if (kendoOptions.size === "large") {
        $kWin.addClass("dews-ui-dialog large");
      } else if (kendoOptions.size === "extra") {
        $kWin.addClass("dews-ui-dialog extra");
      }

      var $content;
      if (typeof kendoOptions.content === "string") {
        if (typeof contentUrl === "undefined") {
          $content = $(kendoOptions.content);

          delete kendoOptions.content;
        }
      } else if (kendoOptions.content instanceof jQuery) {
        $content = kendoOptions.content;

        delete kendoOptions.content;
      }

      kendoOptions.dragend = onDragEnd;

      $kWin.kendoWindow(kendoOptions);

      kWin = $kWin.data("kendoWindow");

      kWin.bind("resize", function (e) {
        var $container = kWin.element.find(".dews-container-panel");

        if ($container.length > 0) {
          for (var i = 0; i < $container.length; i++) {
            var containerPanel = $container.eq(i).data("dews-control");
            containerPanel.refresh();
          }
        }
      });

      $kWin.data("dews-control", self);
      self._kendoWindow = kWin;
      self.$innerContent = $content;
      self.options.center = center;
    }

    if (!$kWin.hasClass("dews-ui-msgbox-dialog")) {
      $kWin.parent().addClass("dialog");
    }

    if (self.options.modal === false) {
      $kWin.parent().addClass("modaless");
    }

    if (center) {
      kWin.center();
    }
    // 다이얼로그 객체를 전역으로 등록
    // 메시지박스를 띄운 후 dialogPage를 삭제해서 발생하는 다국어 이슈로 인한 코드 삭제
    // dews.ui.dialogPage = {
    //     id: self.id,
    //     dialog: kWin,
    //     $content: $kWin
    // };

    // // 컨텍스트를 구성
    self.dialog = kWin;
    self.$content = $kWin;

    if (!kendoOptions.iframe && contentUrl) {
      // 다이얼로그 화면을 로드하기 위한 Promise
      var loadPromise = function loadPromise() {
        var $loadDfd = $.Deferred();

        $.get(contentUrl).
        done(function (html) {
          $kWin.html(html);
          $loadDfd.resolve();
        }).
        fail(function (xhr) {
          switch (xhr.status) {
            case 401:
              $kWin.html(error401Page);
              break;
            case 500:
              $kWin.html(error500Page);
              break;
            case 404:
              $kWin.html(error404Page);
              break;}

          console.log("## 다이얼로그 로드 에러:", contentUrl);
          $loadDfd.reject();
        });

        return $loadDfd.promise();
      };
      // 다국어 리소스를 로드하기 위한 Promise
      var localizePromise = function localizePromise() {
        var $localizeDfd = $.Deferred();

        if (dews._environments.useLocalization && dews.localize.mode() === "multiple") {
          dews.localize.load(dews.localize.language(), self.id).always(function () {
            $localizeDfd.resolve();
          });
        } else {
          $localizeDfd.resolve();
        }
        return $localizeDfd.promise();
      };

      loadPromise().
      then(localizePromise).
      always(function () {
        kWin.open();
        // 다이얼로그 열었을 때 방향키로 버튼 그룹 컨트롤 설정
        if ($.type(self._kendoWindow) !== "undefined") {
          self._kendoWindow.bind("activate", function () {
            if (self.options.buttonFocus) {
              if (kendoOptions.buttons === "close") {
                if (self.options.buttonFocus === true || self.options.buttonFocus === "cancel") {
                  self.buttons.cancel.focus();
                }
              } else {
                if (self.options.buttonFocus === true || self.options.buttonFocus === "ok") {
                  self.buttons.ok.focus();
                } else if (self.options.buttonFocus === "cancel") {
                  self.buttons.cancel.focus();
                }

                // 개발자가 만든 버튼의 경우 (버튼 타입 : none, buttonFocus: 해당 버튼의 id값)
                if (kendoOptions.buttons === "none" && self.options.buttonFocus) {
                  var buttonID = self.options.buttonFocus;

                  self.dialog.element.
                  find(".dews-dialog-button-group").
                  find("#" + buttonID).
                  focus();
                }
              }
            }
          });
        }
      });
    } else {
      kWin.open();
    }
    // if(defaultOptions.iframe === false) {
    //     dews.ajax.load('#'+self.id, kendoOptions.content);
    // }
    // kWin.open();

    // url 이 없는 경우의 방향키로 버튼 그룹 컨트롤 설정
    if ($.type(kendoOptions.url) === "undefined") {
      if ($.type(self._kendoWindow) !== "undefined") {
        self._kendoWindow.bind("activate", function () {
          if (self.options.buttonFocus) {
            if (kendoOptions.buttons === "close") {
              if (self.options.buttonFocus === true || self.options.buttonFocus === "cancel") {
                self.buttons.cancel.focus();
              }
            } else {
              if (self.options.buttonFocus === true || self.options.buttonFocus === "ok") {
                self.buttons.ok.focus();
              } else if (self.options.buttonFocus === "cancel") {
                self.buttons.cancel.focus();
              }
            }
          }
        });
      }
    }
  };

  /**
   * 다이얼로그 구조 설정
   * @private
   */
  DialogWindow.prototype._initControl = function () {
    var self = this,
      $kWin = self._kendoWindow.element,
      $content = self.$innerContent,
      wrapper = $('<div class="dews-dialog-contents"></div>');

    if ($content && $content.length > 0) {
      $kWin.append($content);
    }

    wrapper.append($kWin.children());
    $kWin.append(wrapper);

    if (self.options.center) {
      self._kendoWindow.center();
    }
  };

  /**
   * 다이얼로그 버튼 설정
   */
  DialogWindow.prototype._renderButtons = function () {
    var self = this,
      $kWin = self._kendoWindow.element,
      kendoOptions = self._kendoWindow.options;

    var $buttons = $('<div class="dews-button-group dews-dialog-button-group bottom"></div>');

    if (kendoOptions.buttons === "applyAndClose") {
      $buttons.append(self.buttons.ok);
      dews.ui.button(self.buttons.ok);
      self.buttons.ok.text(dews.localize.get("적용", "dews_적용"));
      self.buttons.cancel.text(dews.localize.get("닫기", "dews_닫기"));
      $kWin.append($buttons);
    } else if (kendoOptions.buttons === "saveAndCancel") {
      $buttons.append(self.buttons.ok);
      dews.ui.button(self.buttons.ok);
      self.buttons.ok.text(dews.localize.get("저장", "dews_저장"));
      self.buttons.cancel.text(dews.localize.get("취소", "dews_취소"));
      $kWin.append($buttons);
    } else if (kendoOptions.buttons === "close") {
      self.buttons.cancel.text(dews.localize.get("닫기", "dews_닫기"));
      $kWin.append($buttons);
    }

    $buttons.append(self.buttons.cancel);
    dews.ui.button(self.buttons.cancel);

    //bottom 버튼 그룹이 있는경우 dialog-contents 길이 수정
    if ($kWin.find(".dews-dialog-button-group.bottom").length === 0) {
      $kWin.find(".dews-dialog-contents").innerHeight("100%");
    } else {
      var height = $kWin.find(".dews-dialog-button-group.bottom").outerHeight() || 0;
      $kWin.find(".dews-dialog-contents").css("height", "calc(100% - " + height + "px)");
    }

    self.buttons.cancel.on("click", function (e) {
      e.preventDefault();

      dews.ui.dialog(self.id)._kendoWindow._close(false);
    });

    self.$buttonGroup = $buttons;
  };

  /**
   * 다이얼로그를 닫습니다.
   */
  DialogWindow.prototype.close = function () {
    var self = this;

    if (self._kendoWindow) {
      self._kendoWindow.close();

      // 다이얼로그 객체를 정리
      // 메시지박스를 띄운 후 dialogPage를 삭제해서 발생하는 다국어 이슈로 인한 코드 삭제
      // dews.ui.dialogPage = null;
    }
  };

  /**
   * 다이얼로그 윈도우의 처리가 정상적으로 끝나 다이얼로그를 닫습니다.
   * @param {object} [data] 처리 결과 데이터
   */
  DialogWindow.prototype.ok = function (data) {
    var self = this;

    if (self._kendoWindow) {
      self._kendoWindow.close();

      if (self.options.hasOwnProperty("ok") && $.type(self.options.ok) === "function") {
        self.options.ok.call(self, data);
      }
    }
  };

  /**
   * 다이얼로그 윈도우의 처리를 취소하고 다이얼로그를 닫습니다.
   */
  DialogWindow.prototype.cancel = function () {
    var self = this;

    if (self._kendoWindow) {
      self._kendoWindow.close();

      if (self.options.hasOwnProperty("cancel") && $.type(self.options.cancel) === "function") {
        self.options.cancel.call(self);
      }
    }
  };

  /**
   * 다이얼로그 윈도우의 초기화 데이터를 가져옵니다.
   */
  DialogWindow.prototype.getInitData = function () {
    var self = this;

    return self.initData;
  };

  /**
   * 다이얼로그 윈도우의 초기화 데이터를 설정합니다.
   * @param {*} data 초기화 데이터
   */
  DialogWindow.prototype.setInitData = function (data) {
    var self = this;

    if ($.type(data) === "undefined") {
      data = null;
    }

    self.initData = data;
  };

  /**
   * 다이얼로그 윈도우의 사이즈를 조정합니다.
   * @param {number} width 너비
   * @param {number} height 높이
   * @param {boolean} [center] 가운데 여부(기본값: 가운데)
   */
  DialogWindow.prototype.resize = function (width, height, center) {
    var self = this,
      $wrapper;

    if ($.type(center) === "undefined") {
      center = true;
    }

    $wrapper = self._kendoWindow.wrapper;

    if ($wrapper) {
      $wrapper.kendoStop(true, true);
      $wrapper.width(width).height(height);
      if (center) {
        self._kendoWindow.center();
      }
    }
  };

  /**
   * 다이얼로그의 제목을 설정하거나 가져옵니다.
   * @param {string} [title] 다이얼로그 제목
   * @returns {string} 다이얼로그 제목
   */
  DialogWindow.prototype.title = function (title) {
    var self = this;

    if (typeof title === "undefined") {
      title = self._kendoWindow.title();
    } else {
      self._kendoWindow.title(title);
    }

    return title;
  };

  DialogWindow.prototype.on = function () {
    var dialog = this.dialog;

    if (arguments[0] === "closed") {
      Array.prototype.splice.apply(arguments, [0, 1, "deactivate"]);
      dialog.bind.apply(dialog, arguments);
    } else if (arguments[0] === "closing") {
      Array.prototype.splice.apply(arguments, [0, 1, "close"]);
      dialog.bind.apply(dialog, arguments);
    }
  };

  DialogWindow.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["closing", "closed"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "closed") {
          self.dialog.trigger("deactivate");
        } else if (event === "closing") {
          self.dialog.trigger("close");
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  kendo.ui.Window.fn._deactivate = _deactivate(kendo.ui.Window.fn._deactivate);

  /**
   * kendo _deactivate 재정의
   * @private
   */
  function _deactivate() {
    return function () {
      var that = this;
      that.wrapper.hide().css("opacity", "");
      if (that.options.modal) {
        var lastModal = that._object(that._modals().last());
        if (lastModal) {
          lastModal.toFront();
        }
      }

      that.trigger("deactivate");
    };
  }

  /**
   * 다이얼로그가 출력된 메인 프레임 윈도우 객체를 찾아서 반환합니다.
   * @param {object} win 대상 윈도우 객체
   */
  function getMainFrameWindowObject(win) {
    if (win.dews && win.dews.isMainFrame()) {
      return win;
    } else if (win !== window.top) {
      return getMainFrameWindowObject(win.parent); // 메인 프레임이 아니고 부모 프레임이 존재하면 부모 프레임 검사
    } else {
      return win; // 어떤 프레임도 메인 프레임이 아닐 경우에는 현재 프레임 객체를 메인 프레임으로 반환
    }
  }

  /**
   * 이미 생성되어 있는 다이얼로그 객체를 찾아서 반환합니다.
   * @param {string} dialogId 다이얼로그의 아이디
   * @param {object} [win] 다이얼로그를 찾을 프레임의 윈도우 객체
   * @returns {DialogWindow} 다이얼로그 객체
   */
  function findDialog(dialogId, win) {
    var dialog, $dialog, rootWin;

    if (!win) {
      win = window;
    }

    $dialog = win.$("#" + dialogId + ".dews-ui-dialog");

    if ($dialog.length > 0) {
      dialog = $dialog.eq(0).data("dews-control");
    } else {
      rootWin = getMainFrameWindowObject(win);

      if (rootWin !== win) {
        dialog = findDialog(dialogId, rootWin);
      }
    }

    return dialog;
  }

  /**
   * 현재 띄워져있는 다이얼로그 중 z-index 가 가장 높은 다이얼로그를 찾아서 반환합니다.
   * @param {object} dialogs 현재 띄워져있는 다이얼로그 리스트
   */
  function findHighestZIndexDialog(dialogs) {
    var dialog;

    for (var i = 0; i < dialogs.length; i++) {
      var $kWin = dialogs.eq(i).closest(".k-window.dialog");

      if (parseInt($kWin.css("zIndex"), 10) > (dialog ? dialog.closest(".k-window.dialog").css("zIndex") : 0)) {
        dialog = dialogs.eq(i);
      }
    }

    return dialog.data("dews-control");
  }

  // 다이얼로그가 동서남북방향 모두 브라우저 밖으로 못나가게 처리
  function onDragEnd(e) {
    if (isTopOutOfBrowser(e)) {
      e.sender.setOptions({
        position: {
          top: e.sender.wrapper.find(".k-window-titlebar").height()
        }
      });
    }
    if (isBottomOutOfBrowser(e)) {
      e.sender.setOptions({
        position: {
          top: window.innerHeight - e.sender.wrapper.find(".dews-ui-dialog").height()
        }
      });
    }
    if (isRightOutOfBrowser(e)) {
      e.sender.setOptions({
        position: {
          left: window.innerWidth - e.sender.wrapper.find(".k-window-titlebar").width()
        }
      });
    }
    if (isLeftOutOfBrowser(e)) {
      e.sender.setOptions({
        position: {
          left: 0
        }
      });
    }
  }

  function isTopOutOfBrowser(e) {var _e$sender, _e$sender$options$pos;
    return ((_e$sender = e.sender) === null || _e$sender === void 0 ? void 0 : (_e$sender$options$pos = _e$sender.options.position) === null || _e$sender$options$pos === void 0 ? void 0 : _e$sender$options$pos.top) < e.sender.wrapper.find(".k-window-titlebar").height();
  }

  function isBottomOutOfBrowser(e) {var _e$sender2, _e$sender2$options$po;
    return ((_e$sender2 = e.sender) === null || _e$sender2 === void 0 ? void 0 : (_e$sender2$options$po = _e$sender2.options.position) === null || _e$sender2$options$po === void 0 ? void 0 : _e$sender2$options$po.top) > window.innerHeight - e.sender.wrapper.find(".dews-ui-dialog").height();
  }

  function isRightOutOfBrowser(e) {var _e$sender3, _e$sender3$options$po;
    return (
      ((_e$sender3 = e.sender) === null || _e$sender3 === void 0 ? void 0 : (_e$sender3$options$po = _e$sender3.options.position) === null || _e$sender3$options$po === void 0 ? void 0 : _e$sender3$options$po.left) > window.innerWidth - e.sender.wrapper.find(".k-window-titlebar").width());

  }

  function isLeftOutOfBrowser(e) {var _e$sender4, _e$sender4$options$po;
    return ((_e$sender4 = e.sender) === null || _e$sender4 === void 0 ? void 0 : (_e$sender4$options$po = _e$sender4.options.position) === null || _e$sender4$options$po === void 0 ? void 0 : _e$sender4$options$po.left) < 0;
  }

  $.extend(true, dews, {
    /**
     * @namespace
     */
    ui: {
      /**
       * 다이얼로그를 생성합니다.
       * @param {string} id 다이얼로그 아이디
       * @param {object} [options] 다이얼로그 생성 옵션 값
       * @param {boolean} [useMain] 다이얼로그를 메인 프레임에 생성할지 여부
       */
      dialog: function dialog(id, options, useMain) {
        var dialog, // 다이얼로그 객체
          dialogId, // 다이얼로그의 아이디
          dialogOptions = {}, // 다이얼로그의 옵션 값
          find = false; // 기존에 만들어진 다이얼로그를 찾아야 하는지 여부

        if (arguments[0] && $.type(arguments[0]) === "string") {
          dialogId = arguments[0];
        } else {
          throw "다이얼로그의 아이디가 지정되지 않았습니다.";
        }

        if (arguments.length === 1) {
          find = true;
        }

        if (!find) {
          // 다이얼로그를 신규로 생성합니다.
          if (
          makingDialogId.filter(function (value) {
            return value === dialogId;
          }).length === 0)
          {
            if ($.isPlainObject(arguments[1])) {
              dialogOptions = options;
            }

            if ($.type(useMain) !== "boolean") {
              useMain = true;
            }

            dialog = new DialogWindow(dialogId, dialogOptions, useMain);
            makingDialogId.push(dialogId);
          } else {
            dialog = findDialog(dialogId);
            makeDialog = false;
          }
        }

        if (!dialog) {
          // 기존에 생성된 다이얼로그의 인스턴스를 찾아서 반환합니다.
          dialog = findDialog(dialogId);

          if (!dialog) {
            throw "지정한 아이디의 다이얼로그를 찾을 수 없습니다.";
          }
        }

        return dialog;
      }
    }
  });

  Object.defineProperty(dews.ui, "dialogPage", {
    get: function get() {
      // 현재 윈도우 내에서 다이얼로그 중에서 가장 상위에 출력되는 다이얼로그 인스턴스를 반환
      var findDialogs = $(document).find(".dews-ui-dialog:not([id^=dews-msgbox-])");

      if (findDialogs && findDialogs.length === 1) {
        return findDialogs.data("dews-control");
      } else if (findDialogs && findDialogs.length > 0) {
        return findHighestZIndexDialog(findDialogs);
      } else {
        return;
      }
    }
  });
})(jQuery, window.dews, window.kendo);


/*
 * 드롭다운버튼
 */

(function ($, dews) {
  function ChildButton(element) {
    var self = this;

    self.element = $(element);
    self.id = element.id;

    return self;
  }

  ChildButton.prototype.text = function (text) {
    var self = this;

    if (typeof text !== "undefined") {
      self.element[0].innerText = text;
    } else {
      return self.element[0].innerText;
    }
  };

  ChildButton.prototype.enable = function (value) {
    var self = this,
      state;

    state = !self.element.attr("disabled");

    if (typeof value !== "undefined") {
      if (value === true) {
        self.element.removeClass("dews-state-disabled");
        self.element.attr("disabled", false);
      } else if (value === false) {
        self.element.addClass("dews-state-disabled");
        self.element.attr("disabled", "disabled");
      }
      state = value;
    }

    return state;
  };

  ChildButton.prototype.on = function () {
    var self = this;

    self.element.on.apply(self.element, arguments);
  };

  ChildButton.prototype.off = function () {
    var self = this;

    self.element.off.apply(self.element, arguments);
  };

  function setElement($this, options) {
    var element = $this,
      opt = options;

    if (opt) {
      if (opt.text) {
        var label = $("<label/>").text(opt.text);
        $(element).append(label);
      }

      if (opt.button && opt.button.length !== 0) {
        for (var i = 0; i < opt.button.length; i++) {
          var button = $('<button type="button" id="' + opt.button[i].id + '">').text(opt.button[i].text);

          if (typeof opt.button[i].enable === "function") {
            button.attr("disabled", !opt.button[i].enable());
          }

          $(element).append(button);
        }
      }
    }

    return $(element);
  }

  var DropDownButton = function DropDownButton(element, options) {
    var self = this;

    self.element = setElement(element, options);
    self.div = $('<div class="dews-dropdownbutton-list"/>');
    self.label = self.element.find("label");
    self.position = 0;
    self.buttons = [];

    self._bindButton();
    self._bindEvent();
    self._initControl();

    self.buttons.getById = function (id) {
      var self = this;

      for (var i = 0; i < self.length; i += 1) {
        if (self[i].id === id) {
          return self[i];
        }
      }
      return null;
    };
  };

  DropDownButton.prototype._initControl = function () {
    var self = this;

    if (self.element.attr("disabled") === "disabled" || self.element.attr("disabled") === true) {
      self.element.addClass("dews-state-disabled");
    }

    self.div.find("button[disabled]").addClass("dews-state-disabled");
    self.label.addClass("dews-dropdown-label");
  };
  // 드롭다운 버튼의 버튼의 구조를 바꿔줌
  DropDownButton.prototype._bindButton = function () {
    var self = this;

    self.element.find("button").each(function () {
      self.div.append(this);
      self.buttons.push(new ChildButton(this));
    });

    $("body").append(self.div);
  };

  DropDownButton.prototype._getFontSize = function () {
    var self = this;

    //글자 크기 상태값 받아오기
    if (self.element.hasClass("confirm")) {
      self.div.addClass("confirm");
    } else if (self.element.hasClass("small")) {
      self.div.addClass("small");
    }
  };

  /**
   * 드롭다운버튼 리스트 위치 설정.
   * @private
   */
  DropDownButton.prototype._setListPosition = function () {
    var self = this;
    //드롭다운버튼의 위치
    var buttonX = self.element.offset().left;
    var buttonY = self.element.offset().top;
    var buttonHeight = self.element.height();
    var buttonWidth = self.element.width();
    var margin = self.div.width() - buttonWidth;
    var zIndex = dews.ui.getDialogMaxZIndex();

    if (zIndex > parseInt(self.div.css("zIndex"), 10)) {
      self.div.css("zIndex", zIndex + 2);
    }

    //오른쪽 아래로 열릴 떄
    function openDefault() {
      self.div.css({
        "min-width": buttonWidth,
        top: buttonY + buttonHeight,
        left: buttonX
      });
    }

    //왼쪽 아래로 열릴 때
    function openLeftDown() {
      self.div.css({
        "min-width": buttonWidth,
        top: buttonY + buttonHeight,
        left: buttonX - margin + "px"
      });
    }

    //왼쪽 위로 열릴 때
    function openLeftUp() {
      self.div.css({
        top: buttonY,
        left: buttonX - margin + "px",
        "min-width": buttonWidth
      });
    }

    //오른쪽 위로 열릴 떄
    function openRightUp() {
      self.div.css({
        "min-width": buttonWidth,
        top: buttonY,
        left: buttonX + "px"
      });
    }

    //리스트 잘림 현상 수정
    if (self.element.offset().top - self.position + self.div.height() >= $(window).height()) {
      //위로 열릴 때
      if (self.element.offset().left + self.div.width() >= $(window).width()) {
        //오른쪽을 기준으로 열릴 때
        openLeftUp();
      } else {
        //왼쪽을 기준으로 열릴 때
        openRightUp();
      }

      self.listPosition = "up";
    } else {
      //아래로 열릴 때
      if (self.element.offset().left + self.div.width() >= $(window).width()) {
        //오른쪽을 기준으로 열릴 때
        openLeftDown();
      } else {
        //왼쪽을 기준으로 열릴 때
        openDefault();
      }

      self.listPosition = "down";
    }
    self.div.removeClass("up down");
    self.div.addClass(self.listPosition);
  };

  /**
   * 드롭다운버튼 리스트 열기.
   * @private
   */
  DropDownButton.prototype._listUp = function () {
    var self = this;

    self.div.removeClass("selected");
    self.label.removeClass("selected");
  };

  /**
   * 드롭다운버튼 리스트 닫기.
   * @private
   */
  DropDownButton.prototype._listDown = function () {
    var self = this;
    var dynamicListHeight = self.div.height();

    //기존에 열려 있던 드롭다운버튼 닫기
    self.div.addClass("selected");
    self.label.addClass("selected");

    if (self.listPosition === "up") {
      self.div.css({
        marginTop: -dynamicListHeight
      });
    }

    if (self.listPosition === "down") {
      self.div.css({
        marginTop: 0
      });
    }
  };

  DropDownButton.prototype._bindEvent = function () {
    var self = this;

    // text 클릭시 이벤트
    self.label.on("click", function (e) {
      e.stopPropagation();

      self._getFontSize();
      self._setListPosition();

      if (!self.element.hasClass("dews-state-disabled")) {
        if (self.label.hasClass("selected")) {
          self._listUp();
        } else {
          self._listDown();
          window.addEventListener("click", documentClick, true);
          window.addEventListener("scroll", documentWheel, true);
        }
      }
    });

    // 다른 부분을 클릭및 스크롤시 버튼 리스트 닫기
    function documentClick(e) {
      if (!self.element.is($(e.target).closest(".dews-ui-dropdownbutton"))) {
        self._listUp();
      }
      window.removeEventListener("click", documentClick, true);
      window.removeEventListener("scroll", documentWheel, true);
    }

    // 스크롤시 리스트 닫기
    function documentWheel(e) {
      self._listUp();
      window.removeEventListener("click", documentClick, true);
      window.removeEventListener("scroll", documentWheel, true);
    }

    $(window).bind("resize mousewheel DOMMouseScroll", function () {
      self.position = $(this).scrollTop();
      self._initControl();
    });
  };

  DropDownButton.prototype.enable = function (value) {
    var self = this,
      state;

    state = !self.element.attr("disabled");

    if (typeof value !== "undefined") {
      if (value === true) {
        self.element.removeClass("dews-state-disabled");
        self.element.attr("disabled", false);
      } else if (value === false) {
        self.element.addClass("dews-state-disabled");
        self.element.attr("disabled", true);
      }

      state = value;
    }

    return state;
  };

  ChildButton.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["click"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        self.element.trigger(event);
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  $.extend(true, dews, {
    ui: {
      dropdownbutton: function dropdownbutton(selector, options) {
        var $el, dropdownbutton;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var button,
            $this = $(this);

          button = $this.data("dews-control");

          if (!button) {
            if (!$this.hasClass("dews-ui-dropdownbutton")) {
              $this.addClass("dews-ui-dropdownbutton");
            }

            if ($this.data("dews-localize-key")) {
              $this.
              find(">label[data-dews-localize-key]").
              text(
              dews.localize.get(
              $this.find(">label").text(),
              $this.data("dews-localize-key"),
              $this.data("dews-localize-lang") || null));



              $this.find(">button[data-dews-localize-key]").each(function (idx, value) {
                var $list = $(value);
                $list.text(
                dews.localize.get(
                $list.text(),
                $list.data("dews-localize-key"),
                $list.data("dews-localize-lang") || null));


              });
            }

            button = new DropDownButton(this, options);

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            $this.data("dews-control", button);
          }

          dropdownbutton = button;
        });

        return dropdownbutton;
      }
    }
  });

  dews.ui.addControlInitializer("dropdownbutton", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.dropdownbutton($("div.dews-ui-dropdownbutton", $container));
  });
})(jQuery, window.dews || {});


/*
 * 드롭다운리스트
 */
(function ($, dews, kendo) {
  var defaultOptions = {
    useNumkey: true,
    autoOpen: false,
    autoBind: true,
    showTooltip: false,
    dataTextField: "text",
    dataValueField: "value"
  };

  /**
   * 설정 값을  가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   * @param {object} codeOptions 스크립트 코드에서 전송된 옵션
   */
  function getOptions($el, codeOptions) {
    var inlineOptions;

    inlineOptions = getInlineOptions($el, defaultOptions);
    codeOptions = codeOptions || {};

    return $.extend(true, {}, defaultOptions, inlineOptions, codeOptions);
  }

  /**
   * HTML 코드 상에 선언되어 있는 옵션을 가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   */
  function getInlineOptions($el, defaultOptions) {
    var options = {},
      dataSource,
      dataSourceID,
      dataSourceUrl,
      dataSourceParams,
      dataSourceOptions;

    if ($el) {
      // AJAX를 이용한 데이터 바인딩을 사용할지 여부의 판단
      // - 코드도움 코드나 DATA 요청 URL 이 지정되어 있으면 AJAX 를 이용한 데이터 바인딩
      if ($el.data("dews-help-code") || $el.data("dews-data-url")) {
        if ($el.attr("id")) {
          dataSourceID = $el.attr("id") + "_DataSource";
        } else {
          dataSourceID = new Date().toString() + "_DataSource";
        }

        if ($el.data("dews-data-url")) {
          dataSourceUrl = dews.url.getAbsoluteUrl($el.data("dews-data-url"));

          dataSourceOptions = {
            transport: {
              read: {
                url: dataSourceUrl,
                dataType: "json"
              }
            }
          };

          dataSource = dews.ui.dataSource(dataSourceID, dataSourceOptions);
        } else {
          dataSourceUrl = dews.url.getCodeDataUrl($el.data("dews-help-code"));

          dataSourceOptions = {
            transport: {
              read: {
                url: dataSourceUrl,
                dataType: "json"
              }
            }
          };

          if ($el.data("dews-help-params")) {
            dataSourceParams = $.deparam($el.data("dews-help-params"));
            dataSourceOptions.transport.read.data = dataSourceParams;
          }

          dataSource = dews.ui.dataSource(dataSourceID, dataSourceOptions);
        }

        options.dataSource = dataSource;
      }

      options.dataValueField = $el.data("dews-value-field") ?
      $el.data("dews-value-field") :
      defaultOptions.dataValueField;
      options.dataTextField = $el.data("dews-text-field") ?
      $el.data("dews-text-field") :
      defaultOptions.dataTextField;
      options.dataSelectable = $el.data("dews-selectable") ?
      $el.data("dews-selectable") :
      defaultOptions.dataSelectable;
      options.dataSelectableTrueValue = $el.data("dews-selectable-true-value") ?
      $el.data("dews-selectable-true-value") :
      defaultOptions.dataSelectableTrueValue;
      options.dataSelectableFalseValue = $el.data("dews-selectable-false-value") ?
      $el.data("dews-selectable-false-value") :
      defaultOptions.dataSelectableFalseValue;

      // 숫자를 이용해서 항목을 선택하는 기능 추가
      if ($el.data("dews-use-numkey") === false) {
        options.useNumkey = $el.data("dews-use-numkey");
      }

      // 포커스가 들어갔을 때, 자동으로 항목을 여는 기능 추가
      if ($el.data("dews-auto-open")) {
        options.autoOpen = $el.data("dews-auto-open");
      }

      // 텍스트가 넘칠 때 아이템 마우스 오버 시 툴팁으로 표시
      if ($el.data("dews-show-tooltip")) {
        options.showTooltip = $el.data("dews-show-tooltip");
      }

      // 아이템 마우스 오버 시 valueField 값 좌측에 표시
      if ($el.data("dews-show-value-tooltip")) {
        options.showValueTooltip = $el.data("dews-show-value-tooltip");
      }

      // 옵션라벨 설정
      if ($.type($el.data("dews-option-label-text")) !== "undefined") {
        options.optionLabel = {};

        if ($.type($el.data("dews-option-localize-key")) !== "undefined") {
          options.optionLabel[options.dataTextField] = dews.localize.get(
          $el.data("dews-option-label-text"),
          $el.data("dews-option-localize-key"));

        } else {
          options.optionLabel[options.dataTextField] = $el.data("dews-option-label-text");
        }

        if ($.type($el.data("dews-option-label-value")) !== "undefined") {
          options.optionLabel[options.dataValueField] = $el.data("dews-option-label-value");
        }
      }
      // autoBind 유무 설정
      if ($.type($el.data("dews-auto-bind")) === "boolean") {
        options.autoBind = $el.data("dews-auto-bind");
      }

      if ($el.hasClass("readonly")) {
        $el.attr("readonly", true);
      }
    }

    return options;
  }

  /**
   * 컨트롤을 초기화합니다.
   * @param {jQuery} $el 대상 DOM 요소의 jQuery 객체
   * @param {object} [options] 설정 값
   */
  function initControl($el, options) {
    var $wrapper, $state;

    $wrapper = $el.closest(".k-dropdown");
    $state = $wrapper.find(".k-dropdown-wrap");

    if ($wrapper.hasClass("dews-ui-dropdownlist")) {
      $wrapper.removeClass("dews-ui-dropdownlist");
    }
    if ($wrapper.hasClass("dews-control-activate")) {
      $wrapper.removeClass("dews-control-activate");
    }
    if (!$wrapper.hasClass("dews-dropdownlist-wrapper")) {
      $wrapper.addClass("dews-dropdownlist-wrapper");

      //css:background 인라인 속성사용시 미적용문제 예외처리
      if ($wrapper.css("background-color") != "rgb(255, 255, 255)") {
        $wrapper.find(".k-input").css("background", $wrapper.css("background-color"));
        $wrapper.find(".k-select").css("background", $wrapper.css("background-color"));
      }
    }

    //
    // 상태정보 추가
    //
    if ($wrapper.hasClass("disabled")) {
      $state.addClass("dews-state-disabled");
      $wrapper.removeClass("disabled");
    }
    if ($wrapper.hasClass("readonly")) {
      $state.addClass("dews-state-readonly");
      $wrapper.removeClass("readonly");
    }
    if ($wrapper.hasClass("required")) {
      $state.addClass("dews-state-required");
      $wrapper.removeClass("required");
    }

    if (options.useNumkey === true) {
      $el.closest(".k-dropdown").addClass("dews-use-numkey");
      useNumKey($el);
    }

    $el.data("dews-control")._bindEvents();

    $el.data("dews-control")._selectableValue();

    setUserGuideAPI($wrapper);
  }

  /**
   * 시용자 가이드를 위한 API 를 추가합니다.
   * @param $element 대상 jQuery 요소
   */
  function setUserGuideAPI($element) {
    $element.on("focus", function () {
      if (dews.ui.page && dews.ui.page.hasUserGuide) {
        if (
        $.isFunction(dews.ui.page.focusGuideItem) &&
        $element.children("select.dews-ui-dropdownlist").attr("id"))
        {
          dews.ui.page.focusGuideItem("#" + $element.children("select.dews-ui-dropdownlist").attr("id"));
        }
      }
    });
  }

  function useNumKey($element) {
    var $wrapper = $element.closest(".k-dropdown");

    $wrapper.on("keydown", function (e) {
      if (defaultOptions.useNumkey) {
        var key = e.key,
          regex = /[1-9]/;

        if ($wrapper.hasClass("k-state-border-down") || $element.attr("aria-expanded") === "true") {
          if (regex.test(key) && $element.data("dews-control").items().length >= key) {
            if ($($element.data("dews-control").items()).not(".hidden").length >= key) {
              $element.data("dews-control").select(
              $($element.data("dews-control").items()).
              not(".hidden").
              eq(parseInt(key) - 1));

              $element.data("dews-control").trigger("change");
              $element.data("dews-control").close();
            } else if (!$($element.data("dews-control").items()).hasClass("hidden")) {
              $element.data("dews-control").select(parseInt(key) - 1);
              $element.data("dews-control").trigger("change");
              $element.data("dews-control").close();
            }
          }
        }
      }
    });
  }

  kendo.ui.DropDownList.fn._selectableValue = function () {
    var self = this,
      options = self.options;

    if (typeof options.dataSelectable === "string") {
      options._dataSelectable = options.dataSelectable;

      if (options.hasOwnProperty("dataSelectableFalseValue")) {
        options._dataSelectableFalseValue = options.dataSelectableFalseValue;
      } else {
        options._dataSelectableFalseValue = false;
      }
      if (options.hasOwnProperty("dataSelectableTrueValue")) {
        options._dataSelectableTrueValue = options.dataSelectableTrueValue;
      } else {
        options._dataSelectableTrueValue = true;
      }
    } else if (_typeof(options.dataSelectable) === "object") {
      options._dataSelectable = options.dataSelectable.field;

      if (options.dataSelectable.hasOwnProperty("falseValue")) {
        options._dataSelectableFalseValue = options.dataSelectable.falseValue;
      } else {
        options._dataSelectableFalseValue = false;
      }
      if (options.dataSelectable.hasOwnProperty("trueValue")) {
        options._dataSelectableTrueValue = options.dataSelectable.trueValue;
      } else {
        options._dataSelectableTrueValue = true;
      }
    }
  };

  $.extend(true, dews, {
    ui: {
      /**
       * 드롭다운리스트를 만들거나 가져옵니다.
       * @param {string|jQuery} selector 대상 요소에 대한 셀렉터 또는 jQuery 객체
       * @param {object} [options] 드롭다운리스트 옵션
       */
      dropdownlist: function dropdownlist(selector, options) {
        var $el, ddl;

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var dropdown,
            $this = $(this),
            opt;

          dropdown = $this.data("dews-control");

          if (!dropdown) {
            opt = getOptions($this, options, defaultOptions);

            if (!$this.hasClass("dews-ui-dropdownlist")) {
              $this.addClass("dews-ui-dropdownlist");
            }

            if (!$this.hasClass("dews-form-control")) {
              $this.addClass("dews-form-control");
            }

            dews.ui.util.ConvertClassAndProperty($this);

            $this.find(">option[data-dews-localize-key]").each(function (idx, value) {
              var $list = $(value);
              $list.text(
              dews.localize.get(
              $list.text(),
              $list.data("dews-localize-key"),
              $list.data("dews-localize-lang") || null));


            });

            $this.kendoDropDownList(opt);

            dropdown = $this.data("kendoDropDownList");

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            $this.data("dews-control", dropdown);

            initControl($this, opt);
          }

          ddl = dropdown;
        });

        return ddl;
      }
    }
  });

  kendo.ui.DropDownList.fn._bindEvents = function () {
    var self = this,
      $element = self.element;
    var $wrapper = $element.parent(".dews-dropdownlist-wrapper");
    var list = self.items();

    var arrShowValueTooltip = [];

    $wrapper.
    on("keydown", function (e) {
      if ($element.prop("readonly") === false && $element.prop("disabled") === false) {
        if (e.keyCode === 115) {
          self.open();
          e.stopPropagation();
          e.preventDefault();
        }
      }
    }).
    on("focus", function (e) {
      if (self.options.autoOpen === true) {
        if ($element.prop("readonly") === false && $element.prop("disabled") === false) {
          self.open();
          e.stopPropagation();
          e.preventDefault();
        }
      }
    }).
    on("mousedown", function (e) {
      e.preventDefault();
    });

    self.bind("open", function () {
      var self = this;
      if (self.list.length > 0 && !self.list.hasClass("dews-dropdownlist-container")) {
        self.list.addClass("dews-dropdownlist-container");
      }

      // numkey 스타일 적용
      if (self.wrapper.hasClass("dews-use-numkey")) {
        if (self.options.useNumkey) {
          self.list.addClass("dews-use-numkey");
          defaultOptions.useNumkey = true;
        } else {
          self.list.removeClass("dews-use-numkey");
          defaultOptions.useNumkey = false;
        }

        for (var i = 0; i < self.list.find("ul>li.k-item").not(".hidden").length; i++) {
          if (i < 9) {
            if (self.list.find("ul>li.k-item").not(".hidden").eq(i).find(".usenum").length < 1) {
              self.list.
              find("ul>li.k-item").
              not(".hidden").
              eq(i).
              append('<span class="usenum">' + (i + 1) + "</span>");
            }
          }
        }

        if (!self.options.useNumkey) {
          $(".usenum").remove();
        }
      }

      setTimeout(function () {
        var windowHeight = $(window).height();
        var windowScrollPosition = $(window).scrollTop();
        var containerHeight = self.list.height();
        var wrapperY = self.wrapper.offset().top;
        var wrapperHeight = self.element.height();
        var containerMargin = 10;
        var vaTopHeight = wrapperY - windowScrollPosition - containerMargin;
        var vaBottomHeight = windowHeight - (vaTopHeight + wrapperHeight) - containerMargin;
        var openToTop = containerHeight > vaBottomHeight && vaTopHeight > vaBottomHeight; // boolean

        self.list.removeClass("up down");
        self.direction = openToTop === true ? "up" : "down";
        self.list.addClass(self.direction);
      });
    });

    self.bind("close", function () {
      var self = this;
      // data-dews-show-value-tooltip 사용 - tooltip이 있을 경우 지우기(close 중에 mouseover 이벤트가 발생할 수 있어서 timeout 줌)
      if (self.options.showValueTooltip && arrShowValueTooltip.length > 0) {
        setTimeout(function () {
          for (var idx = 0; idx < arrShowValueTooltip.length; idx++) {
            dews.ui.tooltip.hide(arrShowValueTooltip[idx]);
            arrShowValueTooltip.splice(idx, 1);
          }
        }, 100);
      }
    });

    self.list.
    on("mouseover", ".k-item, .k-list-optionlabel", function (e) {
      // data-dews-show-tooltip
      if (self.options.showTooltip) {
        if (e.target && e.target.scrollWidth) {
          e.target.scrollWidth > e.target.offsetWidth ?
          $(e.target).attr("title", $($(e.target).contents().get(0)).text()) :
          $(e.target).removeAttr("title");
        }
      }

      // data-dews-show-value-tooltip
      if (self.options.showValueTooltip) {
        var value = self.options.optionLabel[self.options.dataValueField];
        if (!$(e.target).hasClass("k-list-optionlabel")) {
          if ($(e.target).hasClass("usenum")) {
            e.target = $(e.target).closest(".k-item");
          }

          var optionLabelNum = $(e.target).closest(".k-list-container").find(".k-list-optionlabel") ?
          $(e.target).closest(".k-list-container").find(".k-list-optionlabel").length :
          0;
          var itemIndex =
          $.type(self.options.optionLabel) === "undefined" ?
          $(e.target).data("offset-index") :
          $(e.target).data("offset-index") + optionLabelNum;
          value = self.dataItem(itemIndex)[self.options.dataValueField];
        }

        if (value) {
          dews.ui.tooltip.show($(e.target), {
            type: "normal",
            fadeOutTime: 0,
            position: "left",
            text: value
          });
        }
        arrShowValueTooltip.push($(e.target));
      }
    }).
    on("mouseleave", ".k-item, .k-list-optionlabel", function (e) {
      dews.ui.tooltip.hide($(e.target));

      // 띄워져있는 tooltip 있을 경우 지우기
      if (self.options.showValueTooltip) {
        if (arrShowValueTooltip.length > 0) {
          for (var idx = 0; idx < arrShowValueTooltip.length; idx++) {
            dews.ui.tooltip.hide(arrShowValueTooltip[idx]);
            arrShowValueTooltip.splice(idx, 1);
          }
        }
      }
    }).
    on("mouseout", ".k-item, .k-list-optionlabel", function (e) {
      dews.ui.tooltip.hide($(e.target));

      // 띄워져있는 tooltip 있을 경우 지우기
      if (self.options.showValueTooltip) {
        if (arrShowValueTooltip.length > 0) {
          for (var idx = 0; idx < arrShowValueTooltip.length; idx++) {
            dews.ui.tooltip.hide(arrShowValueTooltip[idx]);
            arrShowValueTooltip.splice(idx, 1);
          }
        }
      }
    });
  };

  kendo.ui.DropDownList.fn.enable = function (enable) {
    return function (value) {
      var self = this,
        state;

      if (typeof value === "undefined") {
        return !self.element.prop("disabled");
      } else {
        state = self.wrapper.find(".k-dropdown-wrap");

        if (value) {
          if (self.wrapper.hasClass("disabled")) {
            self.wrapper.removeClass("disabled");
          }
          if (self.element.hasClass("disabled")) {
            self.element.removeClass("disabled");
          }
          if (state.hasClass("dews-state-disabled")) {
            state.removeClass("dews-state-disabled");
          }
        } else {
          if (!self.wrapper.hasClass("disabled")) {
            self.wrapper.addClass("disabled");
          }
          if (!self.element.hasClass("disabled")) {
            self.element.addClass("disabled");
          }
          if (!state.hasClass("dews-state-disabled")) {
            state.addClass("dews-state-disabled");
          }
        }
      }

      enable.call(self, value);

      if (value) {
        if (self.element.hasClass("readonly")) {
          self.readonly(true);
        }
      }
    };
  }(kendo.ui.DropDownList.fn.enable);

  /**
   * 드롭다운리스트의 visible 여부를 가져옵니다.
   * @returns {boolean}
   * @private
   */
  kendo.ui.DropDownList.fn._visibleCheckFromPanel = function () {
    var self = this,
      $ctrl = self.element;
    isVisible = $ctrl.closest(".dews-dropdownlist-wrapper").css("display") !== "none";

    return isVisible;
  };

  kendo.ui.DropDownList.fn.setDataSource = function (data) {
    return function (dataSource) {
      var that = this;
      var parent;
      that.options.dataSource = dataSource;
      that._dataSource();
      if (that.listView.bound()) {
        that._initialIndex = null;
        that.listView._current = null;
      }
      that.listView.setDataSource(that.dataSource);
      if (that.options.autoBind) {
        that.dataSource.fetch().done(function () {
          if (that.select() === -1) {
            that.select(0);
          }
        });
      }
      parent = that._parentWidget();
      if (parent) {
        that._cascadeSelect(parent);
      }
    };
  }(kendo.ui.DropDownList.fn.setDataSource);

  kendo.ui.DropDownList.fn.readonly = function (readonly) {
    return function (value) {
      var self = this,
        state;

      if (typeof value === "undefined") {
        return self.element.hasClass("readonly");
      } else {
        state = self.wrapper.find(".k-dropdown-wrap");

        if (!value) {
          if (self.wrapper.hasClass("readonly")) {
            self.wrapper.removeClass("readonly");
          }
          if (self.element.hasClass("readonly")) {
            self.element.removeClass("readonly");
          }
          if (state.hasClass("dews-state-readonly")) {
            state.removeClass("dews-state-readonly");
          }
        } else {
          if (!self.wrapper.hasClass("readonly")) {
            self.wrapper.addClass("readonly");
          }
          if (!self.element.hasClass("readonly")) {
            self.element.addClass("readonly");
          }
          if (!state.hasClass("dews-state-readonly")) {
            state.addClass("dews-state-readonly");
          }
        }
      }

      readonly.call(self, value);
    };
  }(kendo.ui.DropDownList.fn.readonly);

  kendo.ui.DropDownList.fn.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change", "open", "close", "select", "dataBound"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        self.trigger(event);
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  kendo.ui.DropDownList.fn.on = function () {
    var self = this,
      $element = self.element;

    if (arguments[0] === "nextFocus" || arguments[0] === "beforeFocus") {
      $element.on.apply($element, arguments);
    } else {
      self.bind.apply(self, arguments);
    }
  };

  kendo.ui.DropDownList.fn.off = function () {
    var self = this,
      $element = self.element;

    if (arguments[0] === "nextFocus" || arguments[0] === "beforeFocus") {
      $element.off.apply($element, arguments);
    } else {
      self.unbind.apply(self, arguments);
    }
  };

  kendo.ui.DropDownList.fn.validate = function () {
    var self = this;
    return !!self.value();
  };

  kendo.ui.DropDownList.fn.required = function (value) {
    var self = this;
    var $element = self.element;
    var $wrapper = self.wrapper;
    var state = self.wrapper.find(".k-dropdown-wrap");

    if ($.type(value) === "undefined") {
      return $element.hasClass("required");
    } else if (value === true) {
      $element.addClass("required");
      $wrapper.addClass("required");
      state.addClass("dews-state-required");
    } else if (value === false) {
      $element.removeClass("required");
      $wrapper.removeClass("required");
      state.removeClass("dews-state-required");
    }
  };

  kendo.ui.DropDownList.fn.bindFromPanel = function (data) {
    var self = this,
      $element = self.element;
    var valueColumn, textColumn, value;

    if (data) {
      valueColumn = $element.data("dews-bind-value") || $element.data("dews-value-field") || $element.attr("id");
      textColumn = $element.data("dews-bind-text") || $element.data("dews-text-field");

      if (valueColumn && data.hasOwnProperty(valueColumn)) {
        value = {};

        self.value(data[valueColumn] || "");

        if (textColumn && data.hasOwnProperty(textColumn)) {
          self.text(data[textColumn] || "");
        }
      }
    }
  };

  kendo.ui.DropDownList.fn.serializeForPanel = function () {
    var self = this,
      $element = self.element;
    var valueColumn, textColumn;
    var data;

    valueColumn = $element.data("dews-bind-value") || $element.data("dews-value-field") || $element.attr("id");
    textColumn = $element.data("dews-bind-text") || $element.data("dews-text-field");

    if (valueColumn) {
      data = {};
      data[valueColumn] = self.value();

      if (textColumn) {
        data[textColumn] = self.text();
      }
    }

    return data;
  };

  kendo.ui.DropDownList.fn.applyPanelFocus = function (requiredCheck) {
    var self = this,
      $element = self.element;
    var $wrapper = $element.parent(".dews-dropdownlist-wrapper");

    $wrapper.on("keydown", function (e) {
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && $element.is(":enabled")) {
        e.preventDefault();
      } else if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();

        var evt = new $.Event("beforeFocus");
        evt.control = self;

        $element.trigger(evt);
      } else if (e.keyCode === 9 || e.keyCode === 13 && $element.is(":enabled")) {
        if (e.keyCode === 9) {
          //tab키 기본동작 막기
          e.preventDefault();
        }
        if (e.keyCode === 13 && requiredCheck && $element.hasClass("required")) {
          if (self.validate()) {
            var evt = new $.Event("nextFocus");
            evt.control = self;

            $element.trigger(evt);
          }
        } else {
          var evt = new $.Event("nextFocus");
          evt.control = self;

          $element.trigger(evt);
        }
      }
    });
  };

  kendo.ui.DropDownList.fn.canFocusable = function () {
    var self = this,
      $element = self.element;
    return (
      !$element.hasClass("readonly") && $element.is(":enabled") && $element.closest(".k-dropdown").is(":visible"));

  };

  /**
   * 드롭다운 컨트롤 자동화 인쇄 관련 데이터 추출
   * @return {*} 값이 설정 된 경우 Object 반환, 없는 경우 undefined 반환
   * @private
   */
  kendo.ui.DropDownList.fn._getPrintData = function () {
    var self = this,
      $el = $(self.element),
      data;

    if (self.text()) {
      data = {
        id: $el.attr("id"),
        text: self.text()
      };
    }

    return data;
  };

  /**
   * 드롭다운 컨트롤 display none 하여 숨기는 API
   */
  kendo.ui.DropDownList.fn.hide = function () {
    var self = this;

    if (!(self.wrapper.css("display") === "none")) {
      self.wrapper.css("display", "none");
    }
  };

  /**
   * 드롭다운 컨트롤 display inline-block 하여 보이도록 하는 API
   */
  kendo.ui.DropDownList.fn.show = function () {
    var self = this;

    if (self.wrapper.css("display") === "none") {
      self.wrapper.css("display", "inline-block");
    }
  };

  dews.ui.addControlInitializer("dropdownlist", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.dropdownlist($("select.dews-ui-dropdownlist", $container));
  });

  /**
   * kendo의 Select의 _move 함수를 재정의합니다.
   * 포커스상태에서 방향키를 이용하거나 리스트가 오픈된 상태에서 방향키를 이용하여 아이템 선택 시 타는 로직
   */
  function move(_move) {
    return function (e) {
      var self = this,
        element = self.element;

      if (element.data("dewsControl")) {
        var that = this;
        var listView = that.listView;
        var key = e.keyCode;
        var keys = kendo.keys;
        var down = key === keys.DOWN;
        var dataItem;
        var pressed;
        var current;
        if (key === keys.UP || down) {
          if (e.altKey) {
            that.toggle(down);
          } else {
            if (!listView.bound()) {
              if (!that._fetch) {
                that.dataSource.one("change", function () {
                  that._fetch = false;
                  that._move(e);
                });
                that._fetch = true;
                that._filterSource();
              }
              e.preventDefault();
              return true;
            }
            current = that._focus();
            if (!that._fetch && (!current || current.hasClass("k-state-selected"))) {
              if (down) {
                that._nextItem();
                if (!that._focus()) {
                  that._lastItem();
                }
              } else {
                that._prevItem();
                if (!that._focus()) {
                  that._firstItem();
                }
              }
            }
            dataItem = listView.dataItemByIndex(listView.getElementIndex(that._focus()));

            // selectable 옵션 관련하여 수정
            if (that.options.dataSelectable) {
              if (
              dataItem &&
              dataItem[that.options._dataSelectable] === self.options._dataSelectableFalseValue)
              {
                var target;

                if (down) {
                  if (
                  that.
                  _focus().
                  nextAll().
                  not(".hidden").
                  not(".k-state-selected").
                  eq(0).
                  index() !== -1)
                  {
                    dataItem = listView.dataItemByIndex(
                    that.
                    _focus().
                    nextAll().
                    not(".hidden").
                    not(".k-state-selected").
                    eq(0).
                    index());

                    target = that._focus().nextAll().not(".hidden").not(".k-state-selected").eq(0);
                  } else {
                    dataItem = listView.dataItemByIndex(
                    listView.element.find(">li.k-state-selected").index());

                    target = listView.element.find(">li.k-state-selected");
                    that._focus(target);
                  }
                } else {
                  if (
                  that.
                  _focus().
                  prevAll().
                  not(".hidden").
                  not(".k-state-selected").
                  eq(0).
                  index() !== -1)
                  {
                    dataItem = listView.dataItemByIndex(
                    that.
                    _focus().
                    prevAll().
                    not(".hidden").
                    not(".k-state-selected").
                    eq(0).
                    index());

                    target = that._focus().prevAll().not(".hidden").not(".k-state-selected").eq(0);
                  } else {
                    dataItem = listView.dataItemByIndex(
                    listView.element.find(">li.k-state-selected").index());

                    target = listView.element.find(">li.k-state-selected");
                    that._focus(target);
                  }
                }

                current = target;
              }
            }

            if (
            that.trigger("select", {
              dataItem: dataItem,
              item: target || that._focus()
            }))
            {
              that._focus(current);
              return;
            }
            that._select(target || that._focus(), true).done(function () {
              if (!that.popup.visible()) {
                that._blur();
              }
              that._oldIndex = that.selectedIndex;
            });
          }
          e.preventDefault();
          pressed = true;
        } else if (key === keys.ENTER || key === keys.TAB) {
          if (that.popup.visible()) {
            e.preventDefault();
          }
          current = that._focus();
          dataItem = that.dataItem();
          if (!that.popup.visible() && (!dataItem || that.text() !== that._text(dataItem))) {
            current = null;
          }
          var activeFilter = that.filterInput && that.filterInput[0] === activeElement();
          if (current) {
            dataItem = listView.dataItemByIndex(listView.getElementIndex(current));
            var shouldTrigger = true;
            if (dataItem) {
              shouldTrigger =
              that._value(dataItem) !==
              kendo.ui.List.unifyType(that.value(), _typeof(that._value(dataItem)));
            }
            if (
            shouldTrigger &&
            that.trigger("select", {
              dataItem: dataItem,
              item: current
            }))
            {
              return;
            }
            that._select(current);
          } else if (that.input) {
            that._accessor(that.input.val());
            that.listView.value(that.input.val());
          }
          if (that._focusElement) {
            that._focusElement(that.wrapper);
          }
          if (activeFilter && key === keys.TAB) {
            that.wrapper.focusout();
          } else {
            that._blur();
          }
          that.close();
          pressed = true;
        } else if (key === keys.ESC) {
          if (that.popup.visible()) {
            e.preventDefault();
          }
          that.close();
          pressed = true;
        } else if (that.popup.visible() && (key === keys.PAGEDOWN || key === keys.PAGEUP)) {
          e.preventDefault();
          var direction = key === keys.PAGEDOWN ? 1 : -1;
          listView.scrollWith(direction * listView.screenHeight());
          pressed = true;
        }
        return pressed;
      } else {
        _move.call(self, e);
      }
    };
  }
  kendo.ui.Select.fn._move = move(kendo.ui.Select.fn._move);

  /**
   * kendo의 _listBound 함수를 재정의합니다.
   * 리스트가 바인딩될 때 타는 로직
   */
  function listBound(_listBound) {
    return function () {
      var self = this;
      var data = self.dataSource.flatView();

      if (self.element.hasClass("dews-ui-dropdownlist") && self.options.dataSelectable) {
        for (var i = 0; self.element.find(">option").length > i; i++) {
          if (
          self.element.find(">option").eq(i).attr(self.options.dataSelectable) === (
          self.element.data("dews-selectable-false-value") || "false"))
          {
            self.options._dataSelectable = self.options.dataSelectable;
            self.options._dataSelectableFalseValue =
            self.element.data("dews-selectable-false-value") || false;
            data[i][self.options.dataSelectable] =
            self.element.data("dews-selectable-false-value") || false;
          }
        }
      }

      _listBound.call(self);

      // selectable 옵션 관련하여 수정
      if (self.element.hasClass("dews-ui-dropdownlist") && self.options.dataSelectable) {
        for (var i = 0; i < data.length; i++) {
          if (
          data[i][self.options._dataSelectable] !== undefined &&
          data[i][self.options._dataSelectable] === self.options._dataSelectableFalseValue)
          {
            self.ul.find(">li.k-item").eq(i).css("display", "none");
            self.ul.find(">li.k-item").eq(i).addClass("hidden");
          }
        }
      }
    };
  }

  kendo.ui.DropDownList.fn._listBound = listBound(kendo.ui.DropDownList.fn._listBound);
})(jQuery, window.dews || {}, window.kendo);


(function ($, dews, kendo) {
  var editorDefaultOption = {
      tools: [
      {
        name: "fontName",
        items: [
        { text: "맑은고딕", value: "'Malgun Gothic'" },
        { text: "돋움", value: "Dotum" },
        { text: "돋움체", value: "DotumChe" },
        { text: "굴림", value: "Gulim" },
        { text: "굴림체", value: "GulimChe" },
        { text: "바탕", value: "Batang" },
        { text: "바탕체", value: "BatangChe" },
        { text: "궁서", value: "Gungsuh" },
        { text: "Arial", value: "Arial" },
        { text: "Courier New", value: "'Courier New'" },
        { text: "Verdana", value: "Verdana" },
        { text: "Tahoma", value: "Tahoma" }]

      },
      {
        name: "fontSize",
        items: [
        { text: "8pt", value: "8pt" },
        { text: "9pt", value: "9pt" },
        { text: "10pt", value: "10pt" },
        { text: "12pt", value: "12pt" },
        { text: "14pt", value: "14pt" },
        { text: "18pt", value: "18pt" },
        { text: "24pt", value: "24pt" },
        { text: "36pt", value: "36pt" }]

      },
      "foreColor",
      "backColor",
      "bold",
      "italic",
      "underline",
      "strikethrough",
      "justifyLeft",
      "justifyCenter",
      "justifyRight",
      "justifyFull",
      "indent",
      "outdent"],

      messages: {
        bold: "굵게",
        italic: "기울임",
        underline: "밑줄",
        strikethrough: "취소선",
        superscript: "Superscript",
        subscript: "Subscript",
        justifyCenter: "가운데 맞춤",
        justifyLeft: "왼쪽 맞춤",
        justifyRight: "오른쪽 맞춤",
        justifyFull: "양쪽 맞춤",
        insertUnorderedList: "글머리 기호",
        insertOrderedList: "번호 매기기",
        indent: "들여쓰기",
        outdent: "내어쓰기",
        createLink: "하이퍼링크 추가",
        unlink: "하이퍼링크 제거",
        insertImage: "이미지 추가",
        insertFile: "파일 추가",
        insertHtml: "HTML 추가",
        fontName: "글꼴",
        fontNameInherit: "글꼴",
        fontSize: "크기",
        fontSizeInherit: "크기",
        formatBlock: "포맷",
        formatting: "포맷",
        style: "스타일",
        viewHtml: "HTML 보기",
        emptyFolder: "빈 폴더",
        uploadFile: "업로드",
        orderBy: "Arrange by:",
        orderBySize: "사이즈",
        orderByName: "이름",
        invalidFileType: 'The selected file "{0}" is not valid. Supported file types are {1}.',
        deleteFile: 'Are you sure you want to delete "{0}"?',
        overwriteFile:
        'A file with name "{0}" already exists in the current directory. Do you want to overwrite it?',
        directoryNotFound: "A directory with this name was not found.",
        imageWebAddress: "Web address",
        imageAltText: "Alternate text",
        fileWebAddress: "Web address",
        fileTitle: "Title",
        linkWebAddress: "Web address",
        linkText: "Text",
        linkToolTip: "ToolTip",
        linkOpenInNewWindow: "Open link in new window",
        dialogInsert: "Insert",
        dialogUpdate: "Update",
        dialogButtonSeparator: "or",
        dialogCancel: "Cancel",
        createTable: "테이블 생성",
        addColumnLeft: "왼쪽에 열 추가",
        addColumnRight: "오른쪽에 열 추가",
        addRowAbove: "위쪽에 행 추가",
        addRowBelow: "아래쪽에 행 추가",
        deleteRow: "행 삭제",
        deleteColumn: "열 삭제"
      },
      stylesheets: []
    },
    defaultTools = kendo.ui.Editor.defaultTools;

  if (defaultTools) {
    defaultTools.insertLineBreak.options.shift = false;
    defaultTools.insertParagraph.options.shift = true;
  }

  function getOptions($el, codeOptions) {
    var inlineOptions;

    inlineOptions = getInlineOptions($el);
    codeOptions = codeOptions || {};

    return $.extend(true, {}, editorDefaultOption, inlineOptions, codeOptions);
  }

  function getInlineOptions($el) {
    var options = {},
      inlineStylesheets,
      stylesheets = [],
      styleUrl;

    if ($el.data("dews-stylesheets")) {
      inlineStylesheets = $el.data("dews-stylesheets");
      stylesheets = inlineStylesheets.split(",");

      if (stylesheets.length > 0) {
        for (var i = 0; i < stylesheets.length; i++) {
          if (stylesheets[i]) {
            styleUrl = dews.url.getAbsoluteUrl($.trim(stylesheets[i]));

            if (!options.hasOwnProperty("stylesheets")) {
              options.stylesheets = [];
            }

            options.stylesheets.push(styleUrl);
          }
        }
      }
    }

    if ($el.data("dews-max-length")) {
      options.maxLength = $el.data("dews-max-length");
    }

    return options;
  }

  $.extend(true, dews, {
    ui: {
      editor: function editor(selector, options) {
        var $el, editor;

        if (options && options.tools) {
          options.tools = editorDefaultOption.tools.concat(options.tools);
        }

        options = $.extend({}, editorDefaultOption, options);

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if (kendo) {
          $el.each(function () {
            var $this = $(this),
              ctrl,
              opt;

            ctrl = $this.data("dews-control");

            if (!ctrl) {
              opt = getOptions($this, options);

              if (!$this.hasClass("dews-ui-editor")) {
                $this.addClass("dews-ui-editor");
              }
              if (!$this.hasClass("dews-form-control")) {
                $this.addClass("dews-form-control");
              }

              $this.addClass("dews-control-activate");

              $this.css({ height: $this.height() + "px" });
              $this.kendoEditor(opt);

              ctrl = $this.data("kendoEditor");

              // Range에 이미지가 있는지 확인시켜주는 함수 (파라미터 range)
              ctrl.getSelectedImage = kendo.ui.editor.RangeUtils.image;

              var watchContentFrame = function watchContentFrame() {
                $("iframe", ctrl.wrapper).
                off("load").
                on("load", function (e) {
                  if (!$(this.contentDocument.body).attr("contenteditable")) {
                    if (!$this.hasClass("readonly") && !$this.hasClass("disabled"))
                    ctrl.refresh();
                  }
                  // textarea 태그에 개발자가 설정한 id값을 iframe id로 설정하기. (높이설정)
                  var editorIframe = $("iframe", dews.ui.page.$content);
                  if (editorIframe.parents(".k-editor").length === 1) {
                    var editorId = editorIframe.siblings().attr("id");
                    editorIframe.attr("id", editorId);
                  }
                });
              };

              watchContentFrame();
              setInterval(function () {
                watchContentFrame();
              }, 1000);

              if (!$this.closest(".k-editor").hasClass("dews-editor-wrapper")) {
                $this.closest(".k-editor").addClass("dews-editor-wrapper");
              }

              if ($this.hasClass("readonly")) {
                ctrl.wrapper.addClass("readonly");
                $("iframe.k-content", ctrl.wrapper).attr(
                "style",
                "height: " + (
                parseInt($("iframe.k-content", ctrl.wrapper).css("height")) + 42) +
                "px !important");

                $(ctrl.body).attr("contenteditable", false);
              }

              if ($this.hasClass("disabled")) {
                ctrl.wrapper.addClass("disabled");
                $("iframe.k-content", ctrl.wrapper).attr(
                "style",
                "height: " + (
                parseInt($("iframe.k-content", ctrl.wrapper).css("height")) + 42) +
                "px !important");

                $(ctrl.body).attr("contenteditable", false);
                $(ctrl.body).css("color", "#a6a6a6");
                $(ctrl.body).css("pointer-events", "none");
              }

              // 글꼴 드롭다운 너비조정
              $(".k-fontName", $this.closest(".k-editor")).
              parents("span.k-dropdown, span.k-combobox").
              width(120);
              // 사이즈 드롭 너비조정
              $(".k-fontSize", $this.closest(".k-editor")).
              parents("span.k-dropdown, span.k-combobox").
              width(90);

              $(window).trigger("resize");

              $this.data("dews-control", ctrl);

              if (opt.maxLength) {
                ctrl.bind("keyup", function (e) {
                  checkMaxLength(ctrl, e);
                });
              }
            }

            editor = ctrl;
          });
        }

        return editor;
      }
    }
  });

  kendo.ui.Editor.fn.addCustomTool = function (options) {
    var self = this;

    var $toolTemplate = $(
    '<li class="k-tool-group k-button-group" role="presentation">' +
    '<a tabindex="0" role="button" class="k-tool k-group-start k-group-end" title="' +
    options.title +
    '">' +
    '<span unselectable="on" class="k-tool-icon k-icon ' + (
    options.iconClass ? options.iconClass : "") +
    '"></span><span class="k-tool-text">' +
    options.title +
    "</span>" +
    "</a></li>");


    if (!options.iconClass && options.iconUrl) {
      $(".k-tool-icon", $toolTemplate).css("background", "url(" + options.iconUrl + ") no-repeat 50%");
    }

    var $toolbar = $("tr", self.element.closest("tbody")).first();
    var $tools = $("ul", $toolbar);
    $tools.append($toolTemplate);
    $toolTemplate.on("click", function (e) {
      options.callback.call(self);
    });
  };

  kendo.ui.Editor.fn.on = function () {
    var self = this,
      $element = self.element;

    if (arguments[0] === "nextFocus" || arguments[0] === "beforeFocus") {
      $element.on.apply($element, arguments);
    } else {
      self.bind.apply(self, arguments);
    }
  };

  kendo.ui.Editor.fn.off = function () {
    var self = this,
      $element = self.element;

    if (arguments[0] === "nextFocus" || arguments[0] === "beforeFocus") {
      $element.off.apply($element, arguments);
    } else {
      self.unbind.apply(self, arguments);
    }
  };

  kendo.ui.Editor.fn.validate = function () {
    var self = this;
    return !!self.value();
  };

  kendo.ui.Editor.fn.bindFromPanel = function (data) {
    var self = this,
      $element = self.element;
    var column;

    if (data) {
      column = $element.data("dews-bind-column") || $element.attr("id");

      if (column && data.hasOwnProperty(column)) {
        self.value(data[column] || "");
      }
    }
  };

  kendo.ui.Editor.fn.serializeForPanel = function () {
    var self = this,
      $element = self.element;
    var column;
    var data;

    column = $element.data("dews-bind-column") || $element.attr("id");

    if (column) {
      data = {};
      data[column] = self.value();
    }

    return data;
  };

  // PD1C-948 에디터, 스타일이 있는 텍스트 줄바뀜 오류 수정
  // kendo.all.js. dom trim 함수 재정의
  var Dom = kendo.ui.editor.Dom;
  Dom.trim = function (parent) {
    for (var i = parent.childNodes.length - 1; i >= 0; i--) {
      var node = parent.childNodes[i];
      if (Dom.isDataNode(node)) {
        if (!Dom.stripBom(node.nodeValue).length) {
          Dom.remove(node);
        }
      } else if (node.className != "k-marker") {
        Dom.trim(node);
        if (
        !Dom.isEmpty(node) && node.childNodes.length === 0 ||
        Dom.isBlock(node) && Dom.allWhitespaceContent(node))
        {
          Dom.remove(node);
        }
      }
    }
    return parent;
  };

  // PD1C-1119 에디터 엔터입력 시 줄바꿈 라인 스크롤을 따라가지 못하는 현상 수정
  // kendo.all.js의 dom scrollContainer 함수 재정의
  // kendo.all js의 에디터 텍스트 입력하는 곳을 생성하는 함수(_createContentElement 재정의)
  Dom.scrollContainer = function (doc) {
    var wnd = Dom.windowFromDocument(doc),
      scrollContainer = (wnd.contentWindow || wnd).document || wnd.ownerDocument || wnd;
    if (scrollContainer.compatMode == "BackCompat") {
      scrollContainer = scrollContainer.body;
    } else {
      scrollContainer = scrollContainer.scrollingElement || scrollContainer.documentElement;
    }
    return scrollContainer;
  };

  // PD1C-1153 에디터 텍스트 입력영역 포커스하지 못하는 현상 수정
  // 텍스트 입력영역 body 부분 css 수정
  var os = kendo.support.mobileOS;
  kendo.ui.Editor.fn._createContentElement = function (stylesheets) {
    var editor = this;
    var iframe, wnd, doc;
    var textarea = editor.textarea;
    var specifiedDomain = editor.options.domain;
    var domain = specifiedDomain || document.domain;
    var domainScript = "";
    var src = 'javascript:""';
    var lang = "";
    textarea.hide();
    iframe = $("<iframe />", {
      title: editor.options.messages.editAreaTitle,
      frameBorder: "0"
    })[0];
    $(iframe).
    css("display", "").
    addClass("k-content").
    attr("tabindex", textarea[0].tabIndex).
    insertBefore(textarea);
    if (specifiedDomain || domain != location.hostname) {
      domainScript = '<script>document.domain="' + domain + '"</script>';
      src = "javascript:document.write('" + domainScript + "')";
      iframe.src = src;
    }
    wnd = iframe.contentWindow || iframe;
    doc = wnd.document || iframe.contentDocument;
    $(iframe).one("load", function () {
      editor.toolbar.decorateFrom(doc.body);
    });
    lang = document.getElementsByTagName("html")[0].getAttribute("lang") || DEFAULT_LANGUAGE;
    doc.open();
    doc.write(
    "<!DOCTYPE html><html lag='" +
    lang +
    "'><head>" +
    "<meta charset='utf-8' />" +
    "<title>Kendo UI Editor content</title>" +
    "<style>" +
    "html{padding:0;margin:0;height:100%;min-height:100%;cursor:text;}" +
    "body{padding:0;margin:0;min-height:100%}" +
    "body{box-sizing:border-box;font-size:12px;font-family:Verdana,Geneva,sans-serif;margin-top:-1px;padding:5px .4em 0;" +
    "word-wrap: break-word;-webkit-nbsp-mode: space;-webkit-line-break: after-white-space;" + (
    kendo.support.isRtl(textarea) ? "direction:rtl;" : "") + (
    os.ios ? "word-break:keep-all;" : "") +
    "}" +
    "h1{font-size:2em;margin:.67em 0}h2{font-size:1.5em}h3{font-size:1.16em}h4{font-size:1em}h5{font-size:.83em}h6{font-size:.7em}" +
    "p{margin:0 0 1em;}.k-marker{display:none;}.k-paste-container,.Apple-style-span{position:absolute;left:-10000px;width:1px;height:1px;overflow:hidden}" +
    "ul,ol{padding-left:2.5em}" +
    "span{-ms-high-contrast-adjust:none;}" +
    "a{color:#00a}" +
    "code{font-size:1.23em}" +
    "telerik\\3Ascript{display: none;}" +
    ".k-table{width:100%;border-spacing:0;margin: 0 0 1em;}" +
    ".k-table td{min-width:1px;padding:.2em .3em;}" +
    ".k-table,.k-table td{outline:0;border: 1px dotted #ccc;}" +
    ".k-table p{margin:0;padding:0;}" +
    ".k-column-resize-handle-wrapper {position: absolute; height: 10px; width:10px; cursor: col-resize; z-index: 2;}" +
    ".k-column-resize-handle {width: 100%; height: 100%;}" +
    ".k-column-resize-handle > .k-column-resize-marker {width:2px; height:100%; margin:0 auto; background-color:#00b0ff; display:none; opacity:0.8;}" +
    ".k-row-resize-handle-wrapper {position: absolute; cursor: row-resize; z-index:2; width: 10px; height: 10px;}" +
    ".k-row-resize-handle {display: table; width: 100%; height: 100%;}" +
    ".k-row-resize-marker-wrapper{display: table-cell; height:100%; width:100%; margin:0; padding:0; vertical-align: middle;}" +
    ".k-row-resize-marker{margin: 0; padding:0; width:100%; height:2px; background-color: #00b0ff; opacity:0.8; display:none;}" +
    ".k-table-resize-handle-wrapper {position: absolute; background-color: #fff; border: 1px solid #000; z-index: 100; width: 5px; height: 5px;}" +
    ".k-table-resize-handle {width: 100%; height: 100%;}" +
    ".k-table-resize-handle.k-resize-east{cursor:e-resize;}" +
    ".k-table-resize-handle.k-resize-north{cursor:n-resize;}" +
    ".k-table-resize-handle.k-resize-northeast{cursor:ne-resize;}" +
    ".k-table-resize-handle.k-resize-northwest{cursor:nw-resize;}" +
    ".k-table-resize-handle.k-resize-south{cursor:s-resize;}" +
    ".k-table-resize-handle.k-resize-southeast{cursor:se-resize;}" +
    ".k-table-resize-handle.k-resize-southwest{cursor:sw-resize;}" +
    ".k-table-resize-handle.k-resize-west{cursor:w-resize;}" +
    ".k-table.k-table-resizing{opacity:0.6;}" +
    ".k-placeholder{color:grey}" +
    "k\\:script{display:none;}" +
    "</style>" +
    domainScript +
    $.map(stylesheets, function (href) {
      return "<link rel='stylesheet' href='" + href + "'>";
    }).join("") +
    "</head><body autocorrect='off' contenteditable='true'></body></html>");

    doc.close();
    return wnd;
  };

  kendo.ui.Editor.fn.applyPanelFocus = function () {
    var self = this,
      $element = self.element;

    // 엔터키에 대한 동작은 없음
    self.bind("keydown", function (e) {
      if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();

        var evt = new $.Event("beforeFocus");
        evt.control = self;

        $element.trigger(evt);
      } else if (e.keyCode === 9) {
        e.preventDefault(); //tab키 기본동작 막기

        var evt = new $.Event("nextFocus");
        evt.control = self;

        $element.trigger(evt);
      }
    });
  };

  kendo.ui.Editor.fn.canFocusable = function () {
    var self = this,
      $element = self.wrapper;
    return $element.is(":visible");
  };

  kendo.ui.Editor.fn.value = getSetValue(kendo.ui.Editor.fn.value);

  kendo.ui.Editor.fn.enable = function (value) {
    var self = this,
      $body = $(self.body),
      $wrapper = $(self.wrapper);

    if (typeof value === "undefined") {
      if ($wrapper.hasClass("disabled")) {
        return false;
      } else {
        return true;
      }
    } else {
      if (value) {
        // 활성화
        if ($wrapper.hasClass("disabled")) {
          if (!$wrapper.hasClass("readonly")) {
            $("iframe.k-content", $wrapper).removeAttr("style");
          }

          // $body.attr('contenteditable', true);
          this.refresh();
          $body.css("color", "");
          $body.css("pointer-events", "");

          if ($wrapper.hasClass("disabled")) {
            $wrapper.removeClass("disabled");
          }
        }
      } else {
        // 비활성화
        if (!$wrapper.hasClass("disabled")) {
          var height =
          $("iframe.k-content", $wrapper).outerHeight() +
          $(".k-editor-toolbar-wrap", $wrapper).outerHeight();
          $("iframe.k-content", $wrapper).attr("style", "height: " + height + "px !important");

          $body.attr("contenteditable", false);
          $body.css("color", "#a6a6a6");
          $body.css("pointer-events", "none");
          $wrapper.addClass("disabled");
        }
      }
    }
  };

  kendo.ui.Editor.fn.readonly = function (value) {
    var self = this,
      $wrapper = $(self.wrapper);

    if (typeof value === "undefined") {
      if ($wrapper.hasClass("readonly")) {
        return true;
      } else {
        return false;
      }
    } else {
      if (value) {
        // 읽기 전용 설정
        if (!$wrapper.hasClass("readonly")) {
          var height =
          $("iframe.k-content", $wrapper).outerHeight() +
          $(".k-editor-toolbar-wrap", $wrapper).outerHeight();
          $("iframe.k-content", $wrapper).attr("style", "height: " + height + "px !important");

          $(self.body).attr("contenteditable", false);
          $wrapper.addClass("readonly");
        }
      } else {
        //읽기 전용 해제
        if (!$wrapper.hasClass("disabled")) {
          $("iframe.k-content", $wrapper).removeAttr("style");
        }

        // $(self.body).attr('contenteditable', true);
        this.refresh();

        if ($wrapper.hasClass("readonly")) {
          $wrapper.removeClass("readonly");
        }
      }
    }
  };

  /**
   * 값을 설정하거나 가져옵니다.
   * @param {function} value Kendo UI 의 value 함수
   */
  function getSetValue(value) {
    return function (val) {
      var self = this;

      if (self.element.data("dewsControl")) {
        var html;

        html = value.call(self, val);

        if (self.options.maxLength && html) {
          checkMaxLength(self);
        }

        return html;
      } else {
        return value.call(self, val);
      }
    };
  }

  function getValue(editor) {
    var body = editor.body,
      editorNS = kendo.ui.editor,
      options = editor.options,
      currentHtml = editorNS.Serializer.domToXhtml(body, options.serialization);

    return currentHtml;
  }

  function setValue(editor, html) {
    var body = editor.body,
      editorNS = kendo.ui.editor,
      options = editor.options;

    editorNS.Serializer.htmlToDom(html, body, options.deserialization);
    editor.selectionRestorePoint = null;
    // editor.update();

    if (editor.textarea) {
      editor.textarea.val(html);
    } else {
      editor._oldValue = html;
    }

    editor.toolbar.refreshTools();
  }

  // 붙여넣기, 텍스트 입력
  function checkMaxLength(editor, event) {
    var maxLength = editor.options.maxLength,
      textByte = 0,
      text = getValue(editor),
      rlen;

    for (var i = 0; i < text.length; i++) {
      var _char = text.charAt(i);
      if (escape(_char).length > 4) {
        textByte += 2; //한글 2Byte
      } else {
        textByte++; //영문 등 나머지 1Byte
      }

      if (textByte <= maxLength) {
        rlen = i + 1;
      }
    }

    if (textByte > maxLength) {
      // 45:insert, 46:Delete, 8:Backspace, 9:TAB, 27:ESC, 16:shift, 17:control // Allow: Ctrl+A // Allow: home, end, left, right
      if (
      event && (
      $.inArray(event.keyCode, [8, 9, 27, 45, 46, 91, 92, 144, 145]) !== -1 ||
      event.keyCode >= 16 && event.keyCode <= 20 ||
      event.keyCode >= 33 && event.keyCode <= 40 ||
      event.keyCode >= 112 && event.keyCode <= 123 ||
      event.keyCode == 90 && event.ctrlKey === true ||
      event.keyCode == 65 && event.ctrlKey === true))
      {
        return;
      } else {
        if (event) {
          event.preventDefault();
          // setValue(editor, text.substring(0, rlen));
        } else {
          setValue(editor, text.substring(0, rlen));
        }

        alertMaxLength(editor);
      }
    }
  }

  function alertMaxLength(editor) {
    dews.alert("입력 가능한 최대 글자수를 초과했습니다.", "warning").done(function () {
      moveCaret(editor);
    });
  }

  function moveCaret(editor) {
    var range = editor.getRange();
    if (range.collapsed) {
      var textNode = editor.body.lastChild;
      if (textNode) {
        range.setStart(textNode, textNode.length);
        range.collapse(true); // collapse to start
        editor.selectRange(range);
      }
    }
  }

  dews.ui.addControlInitializer("editor", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.editor($("textarea.dews-ui-editor", $container));
  });
})(jQuery, window.dews || {}, window.kendo);


/**
 * 파일 컴포넌트
 */
(function ($, dews) {
  /**
   * @typedef {Object} FileData 업로드된 파일 정보
   * @property {boolean} [isNew = true] 임시 업로드 파일 여부
   * @property {string} fileKey 파일의 유니크 키
   * @property {string} [filename] 파일명
   * @property {string} [extension] 확장자
   * @property {number} [size] 파일 크기
   */

  /**
   * @typedef {Object} UploadOptions 업로드 설정
   * @property {boolean} use 업로드 기능의 사용 여부
   * @property {string} url 업로드 API URL
   */

  /**
   * @typedef {Object} DownloadOptions 다운로드 설정
   * @property {boolean} use 다운로드 기능의 사용 여부
   * @property {string} url 다운로드 API URL
   * @property {string} tempUrl 임시파일 다운로드 API URL
   * @property {string} param 다운로드에서 파일 키의 파라미터 명
   */

  /**
   * @typedef {Object} TokenOptions 임시 인증토큰 설정
   * @property {boolean} use 임시 인증토큰 사용 여부
   * @property {string} url 임시 인증토큰 발급 API URL
   * @property {string} param 다운로드 시 인증토큰을 전달할 파라미터 명
   */

  /**
   * @typedef {Object} BindingOptions 바인딩 설정
   * @property {string} fileKey 파일키
   * @property {string} filename 파일명
   * @property {string} extension 확장자
   * @property {number} size 파일사이즈
   * @property {boolean} [isNew] 신규로 등록된 임시파일 여부
   */

  /**
   * @typedef {Object} FileOptions 파일 컴포넌트 옵션
   * @property {UploadOptions} [upload] 업로드 설정
   * @property {DownloadOptions} [download] 다운로드 설정
   * @property {TokenOptions} [token] 임시 인증토큰 설정
   * @property {FileData} [file] 업로드된 파일 정보
   * @property {BindingOptions} [binding] 바인딩 정보
   * @property {[string]} [filters] 확장자 기반의 파일 필터
   * @property {boolean} [readonly = false] 읽기 전용 여부
   * @property {boolean} [disabled = false] 비활성화 여부
   * @property {boolean} [required = false] 필수 입력 여부
   */

  /**
   * 기본 옵션
   * @type {FileOptions}
   */
  var defaultOptions = {
    upload: {
      use: true,
      url: "/upload/file"
    },
    download: {
      use: true,
      url: "/download/file",
      tempUrl: "/download/tempfile",
      param: "key"
    },
    token: {
      use: true,
      url: "/auth/temporary/token",
      param: "token"
    },
    readonly: false,
    disabled: false,
    required: false,
    usePreview: false,
    files: []
  };

  /**
   * DOM 요소에 설정된 파일 컴포넌트 옵션을 수집하여 가져옵니다.
   * @param {Element} el 옵션이 포함된 DOM 요소
   * @returns {FileOptions}
   */
  function getInlineOptions(el) {
    var $el = $(el);

    /**
     * @type {FileOptions}
     */
    var options = {};

    // 업로드 기능 사용 여부
    if ($.type($el.data("dews-upload-use")) === "boolean") {
      options.upload = options.upload || {};
      options.upload.use = $el.data("dews-upload-use");
    }

    // 업로드 API URL
    var uploadUrl = $el.data("dews-upload-url");
    if ($.trim(uploadUrl)) {
      options.upload = options.upload || {};
      options.upload.url = uploadUrl;
    }

    // 다운로드 기능 사용 여부
    if ($.type($el.data("dews-download-use")) === "boolean") {
      options.download = options.download || {};
      options.download.use = $el.data("dews-download-use");
    }

    // 멀티 업로드 가능 여부
    if ($.type($el.data("dews-multiple")) === "boolean") {
      options.multiple = options.multiple || {};
      options.multiple = $el.data("dews-multiple");
      if ($el.data("dews-multiple")) {
        $el.attr("multiple", "multiple");
      }
    } else {
      options.multiple = options.multiple || {};
      options.multiple = false;
    }

    // 다운로드 API URL
    var downloadUrl = $el.data("dews-download-url");
    if ($.trim(downloadUrl)) {
      options.download = options.download || {};
      options.download.url = downloadUrl;
    }

    // 임시파일 다운로드 API URL
    var downloadTempUrl = $el.data("dews-download-temp-url");
    if ($.trim(downloadTempUrl)) {
      options.download = options.download || {};
      options.download.tempUrl = downloadTempUrl;
    }

    // 다운로드 API URL 에 파일 키를 전달할 파라미터 이름
    var downloadParam = $el.data("dews-download-param");
    if ($.trim(downloadParam)) {
      options.download = options.download || {};
      options.download.param = downloadParam;
    }

    // 토큰 사용 여부
    if ($.type($el.data("dews-token-use")) === "boolean") {
      options.token = options.token || {};
      options.token.use = $el.data("dews-token-use");
    }

    // 임시 토큰 발급 API URL
    var tokenUrl = $el.data("dews-token-url");
    if ($.trim(tokenUrl)) {
      options.token = options.token || {};
      options.token.url = $.trim(tokenUrl);
    }

    // 토큰을 전달하는 파라미터 이름
    var tokenParam = $el.data("dews-token-param");
    if ($.trim(tokenParam)) {
      options.token = options.token || {};
      options.token.param = tokenParam;
    }

    // 확장자 기반의 파일 필터
    var strFilters = $el.data("dews-filters");
    if ($.trim(strFilters)) {
      options.filters = $.map(strFilters.split(","), function (item) {
        return $.trim(item);
      });
    }

    // 첨부파일 정보
    if (
    $el.data("dews-file-key") ||
    $el.data("dews-filename") ||
    $el.data("dews-extension") ||
    $el.data("dews-size"))
    {
      options.file = { isNew: false };
      if ($el.data("dews-file-key")) {
        options.file.fileKey = $el.data("dews-file-key");
      }
      if ($el.data("dews-filename")) {
        options.file.filename = $el.data("dews-filename");
      }
      if ($el.data("dews-extension")) {
        options.file.extension = $el.data("dews-extension");
      }
      if ($el.data("dews-size")) {
        options.file.size = parseInt($el.data("dews-size"), 10);
      }
    }

    // 읽기 전용
    if ($el.prop("readonly") || $el.hasClass("readonly")) {
      options.readonly = true;
    }

    // 비활성화
    if ($el.prop("disabled") || $el.hasClass("disabled")) {
      options.disabled = true;
    }

    // 필수입력
    if ($el.hasClass("required")) {
      options.required = true;
    }

    // 바인딩 정보
    if (
    $el.data("dews-bind-file-key") ||
    $el.data("dews-bind-filename") ||
    $el.data("dews-bind-extension") ||
    $el.data("dews-bind-size") ||
    $el.data("dews-bind-is-new"))
    {
      options.binding = options.binding || {};
      var bindFileKey = $el.data("dews-bind-file-key");
      if ($.trim(bindFileKey)) {
        options.binding.fileKey = $.trim(bindFileKey);
      }
      var bindFilename = $el.data("dews-bind-filename");
      if ($.trim(bindFilename)) {
        options.binding.filename = $.trim(bindFilename);
      }
      var bindExtension = $el.data("dews-bind-extension");
      if ($.trim(bindExtension)) {
        options.binding.extension = $.trim(bindExtension);
      }
      var bindSize = $el.data("dews-bind-size");
      if ($.trim(bindSize)) {
        options.binding.size = $.trim(bindSize);
      }
      var bindIsNew = $el.data("dews-bind-is-new");
      if ($.trim(bindIsNew)) {
        options.binding.isNew = $.trim(bindIsNew);
      }
    }

    // 미리보기
    if ($el.data("dews-use-preview")) {
      options.usePreview = true;
    }

    return options;
  }

  /**
   * 파일 컴포넌트의 UI를 초기화합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   */
  function initialize(file) {
    /** 컨테이너를 생성합니다. */
    var createContainer = function createContainer() {
      var $wrapper = $('<div class="dews-file-wrapper"><div class="dews-file-wrap"></div></div>'),
        width;

      file.$element.wrap($wrapper);
      file._$wrapper = file.$element.parents(".dews-file-wrapper");
      file._$fileBox = file._$wrapper.find("> .dews-file-wrap");

      if (file.$element.attr("style")) {
        var matches = file.$element.attr("style").match(/width:([^;]+);?/i);

        if (matches) {
          width = $.trim(matches[1]);
          file._$wrapper.width(width);
        }
      }

      updateUploadable(file, file._options.upload.use);
      updateDownloadable(file, file._options.download.use);
      updateFileExists(file, !!file._options.file);
    };
    /** 파일명 영역을 생성합니다. */
    var createFileText = function createFileText() {
      var $text = $('<input type="text" class="dews-file-text" readonly>');
      file.$text = $text;
      file.$element.after($text);

      file.$text.
      on("focus", function () {
        setFocus(file);
      }).
      on("blur", function () {
        removeFocus(file);
      }).
      on("keydown", function (e) {
        if (
        file._usePanelFocus && (
        e.keyCode === 13 || e.keyCode === 9) &&
        !file._$wrapper.hasClass("readonly") &&
        !file._$wrapper.hasClass("disabled"))
        {
          // 패널 내에서의 포커스 처리
          e.preventDefault();
          if (e.keyCode === 9 && e.shiftKey) {
            triggerPreviousFocus(file);
          } else {
            if (!(e.shiftKey || e.ctrlKey || e.altKey)) {
              triggerNextFocus(file);
            }
          }
        } else if (e.keyCode === 115) {
          // F4 키 처리
          e.preventDefault();
          if (file._options.upload.use) {
            file.$buttons.$upload.click();
          }
        }
      });

      if (file._options.file) {
        setFileData(file, file._options.file);
      }
    };
    /** 버튼들을 생성합니다. */
    var createButtons = function createButtons() {
      var $buttonContainer = $('<div class="dews-file-button-box"></div>');
      file.$buttons = {
        $preview: $('<button type="button" class="dews-file-button icon-preview"></button>'),
        $delete: $('<button type="button" class="dews-file-button icon-delete"></button>'),
        $upload: $('<button type="button" class="dews-file-button icon-upload"></button>'),
        $download: $('<button type="button" class="dews-file-button icon-download"></button>')
      };

      // 버튼을 추가
      $buttonContainer.append(file.$buttons.$preview);
      $buttonContainer.append(file.$buttons.$delete);
      $buttonContainer.append(file.$buttons.$upload);
      $buttonContainer.append(file.$buttons.$download);

      file._$fileBox.append($buttonContainer);
    };
    /** 기본 이벤트를 바인딩 합니다. */
    var bindEvents = function bindEvents() {
      /** 업로드 중 취소 이벤트를 발생시킴 */
      var triggerUploadCancel = function triggerUploadCancel() {
        var $evt = new $.Event("_uploadCancel");
        file.$element.trigger($evt);
      };

      /** 설정된 파일을 삭제하는 이벤트를 발생시킴 */
      var triggerDelete = function triggerDelete() {
        var $evt = new $.Event("_fileDelete");
        file.$element.trigger($evt);
      };

      // 업로드 대상 파일의 선택이 완료되었을 경우
      file.$element.on("change", function (e) {
        if (file._options.upload.use && e.target.files.length < 2) {
          // 업로드 기능을 사용할 경우만 동작해야 함
          var blob = e.target.files[0],
            preUploadParameter;

          // 업로드 제한 확장자 체크
          if (!isLimitExtension(blob.name)) {
            preUploadParameter = {
              file: {
                filename: blob.name,
                extension: getExtension(blob.name, false),
                size: blob.size
              }
            };

            var evt = $.Event("preUpload", preUploadParameter);
            file.$element.trigger(evt);

            if (evt.isDefaultPrevented()) {
              return;
            }

            file.$text.val(e.target.files[0].name);
            updateUploading(file, true);
            file.uploading = true; // 파일이 업로드 중 임을 설정

            // 파일 업로드 시작
            startUploading(file, blob); // 파일 컴포넌트 업로드 시작
          }
        } else {
          var blob = [],
            preUploadParameter = [];

          file.options.files = [];

          for (var i = 0; i < e.target.files.length; i++) {
            blob.push(e.target.files[i]);

            // 업로드 제한 확장자
            if (isLimitExtension(e.target.files[i].name)) {
              return;
            }
          }

          for (var i = 0; i < blob.length; i++) {
            preUploadParameter.push({
              file: {
                filename: blob[i].name,
                extension: getExtension(blob[i].name, false),
                size: blob[i].size
              }
            });

            var evt = $.Event("preUpload", preUploadParameter[i]);
            file.$element.trigger(evt);

            if (evt.isDefaultPrevented()) {
              return;
            }

            updateUploading(file, true);
            file.uploading = true; // 파일이 업로드 중 임을 설정

            // 파일 업로드 시작
            startUploadingFiles(file, blob[i], blob.length); // 파일 컴포넌트 업로드 시작
          }

          file.$text.val(e.target.files[0].name + "외 " + (blob.length - 1));
        }
      });

      // 드래그 파일 요소 지정
      file.$text.on("dragover", function (e) {
        e.preventDefault();
      });

      // 업로드 파일 드랍하였을 경우
      file.$text.on("drop", function (e) {
        e.preventDefault();
        var data = e.originalEvent.dataTransfer.files,
          filters = file._options.filters,
          blob,
          preUploadParameter;
        if (
        file._options.upload.use &&
        data.length &&
        !file._$wrapper.hasClass("readonly") &&
        !file._$wrapper.hasClass("disabled"))
        {
          if (data.length > 1) {
            if (file._options.multiple) {
              blob = [];
              preUploadParameter = [];

              file.options.files = [];

              for (var i = 0; i < data.length; i++) {
                blob.push(data[i]);

                // 업로드 제한 확장자
                if (isLimitExtension(data[i].name)) {
                  return;
                }
              }

              for (var i = 0; i < blob.length; i++) {
                preUploadParameter.push({
                  file: {
                    filename: blob[i].name,
                    extension: getExtension(blob[i].name, false),
                    size: blob[i].size
                  }
                });

                var evt = $.Event("preUpload", preUploadParameter[i]);
                file.$element.trigger(evt);

                if (evt.isDefaultPrevented()) {
                  return;
                }

                updateUploading(file, true);
                file.uploading = true; // 파일이 업로드 중 임을 설정

                // 파일 업로드 시작
                startUploadingFiles(file, blob[i], blob.length); // 파일 컴포넌트 업로드 시작
              }

              file.$text.val(data[0].name + "외 " + (blob.length - 1));
            }
            return; //파일 두개 이상일 경우 설정
          }
          if (filters) {
            for (var i = 0; i < filters.length; i++) {
              if (compareExtension(data, filters[i]) || filters[i] === getExtension(data[0].name)) {
                blob = data[0];
              }
            }
          } else {
            blob = data[0];
          }
        } else {
          return; //업로드 제한 될 경우 설정
        }

        if (blob) {
          // 업로드 제한 확장자 체크
          if (!isLimitExtension(blob.name)) {
            preUploadParameter = {
              file: {
                filename: blob.name,
                extension: getExtension(blob.name, false),
                size: blob.size
              }
            };
            var evt = $.Event("preUpload", preUploadParameter);
            file.$element.trigger(evt);

            if (evt.isDefaultPrevented()) {
              return;
            }

            file.$text.val(blob.name);
          } else return;
        } else {
          return;
        }

        updateUploading(file, true);
        file.uploading = true; // 파일이 업로드 중 임을 설정

        startUploading(file, blob); // 파일 컴포넌트 업로드 시작
      });

      // 파일명을 출력하는 텍스트박스를 더블클릭 한 경우
      file.$text.on("dblclick", function (e) {
        e.preventDefault();
        if (
        file._options.upload.use &&
        !file._$wrapper.hasClass("readonly") &&
        !file._$wrapper.hasClass("disabled"))
        {
          file.$element.click(); // 파일 선택 다이얼로그를 출력
        }
      });

      // 업로드 버튼을 클릭하였을 경우
      file.$buttons.$upload.on("click", function (e) {
        e.preventDefault();
        if (file._options.upload.use) {
          file.$element.click(); // 파일 선택 다이얼로그를 출력
        }
      });

      // 삭제 버튼을 클릭하였을 경우
      file.$buttons.$delete.on("click", function (e) {
        e.preventDefault();
        if (file.uploading) {
          triggerUploadCancel(); // 진행중인 파일의 업로드를 중단하는 아벤트 발생
        } else {
          triggerDelete(); // 설정된 파일을 삭제하는 이벤트 발생
          updateFileExists(file, false);
        }
      });

      // 미리보기 버튼을 클릭하였을 경우
      file.$buttons.$preview.on("click", function (e) {
        e.preventDefault();
        filePreview(file);
      });

      // 다운로드 버튼을 클릭하였을 경우
      file.$buttons.$download.on("click", function (e) {
        e.preventDefault();
        if (file._options.download.use && $.isPlainObject(file._options.file) && file._options.file.fileKey) {
          downloadFile(file);
        } else {
          if (file._options.download.use && $.type(file._options.file) === "array") {
            downloadFiles(file);
          }
        }
      });

      // 컴포넌트의 레이아웃이 변경되었을 경우
      file._$wrapper.on("_layoutChange", function (e) {
        e.preventDefault();
        var type = e.changeType;
        // 파일명 출력 텍스트박스의 너비를 재설정한다.
        var buttonAreaSize = file._$wrapper.find(".dews-file-button-box").outerWidth(true);
        var containerSize = file._$wrapper.innerWidth();

        file.$text.outerWidth(containerSize - buttonAreaSize);
      });

      // 컴포넌트에 등록된 파일을 삭제
      file._$wrapper.on("_fileDelete", function (e) {
        e.preventDefault();

        deleteFile(file);
      });

      file._$wrapper.
      on("mouseenter", function (e) {
        triggerLayoutChange(file, "filename");
        // 툴팁 적용
        if (file.uploading) {
          showProgressTooltip(file);
        } else if (file._options.file) {
          showFileInfoTooltip(file);
        }
        var $text = $(
        '<p class="placeholder">' +
        dews.localize.get("여기에 드래그하세요.", "dews_여기에 드래그하세요.") +
        "</p>");

        if (
        file._options.upload.use &&
        !file.$text.val() &&
        !file._$wrapper.hasClass("readonly") &&
        !file._$wrapper.hasClass("disabled"))
        {
          file.$text.after($text);
        }
      }).
      on("mouseleave", function (e) {
        triggerLayoutChange(file, "filename");
        hideTooltip(file);
        if (file._$fileBox.find(".placeholder")) {
          file._$fileBox.find(".placeholder").remove();
        }
      });
    };

    if (!file.initialized) {
      // 컨테이너를 생성합니다.
      createContainer();
      // 파일명 영역을 생성합니다.
      createFileText();
      // 버튼들을 생성합니다.
      createButtons();
      // 파일 확장자 필더를 설정합니다.
      attachExtensionFilters(file);
      // 기본 이벤트를 바인딩합니다.
      bindEvents();

      // 필수 입력 처리
      file._options.required && setRequired(file);
      // 읽기전용 처리
      file._options.readonly && setReadonly(file);
      // 비활성화 처리
      file._options.disabled && setDisable(file);

      file.initialized = true;
    }
  }

  /**
   * 파일 컴포넌트의 UI를 종료합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   */
  function terminate(file) {
    /** 이벤트를 제거합니다. */
    var unbindEvents = function unbindEvents() {};
    /** 파일 확장자 필터를 제거합니다. */
    var detachFileExtensionFilter = function detachFileExtensionFilter() {};
    /** 버튼을 제거합니다. */
    var removeButtons = function removeButtons() {};
    /** 파일명 영역을 제거합니다. */
    var removeFileText = function removeFileText() {};
    /** 컨테이너를 제거합니다. */
    var removeContainer = function removeContainer() {};

    if (file.initialized) {
      unbindEvents();
      detachFileExtensionFilter();
      removeButtons();
      removeFileText();
      removeContainer();
      file.initialized = false;
    }
  }

  /**
   * 파일타입에서 타입 비교
   * @param {Filelist} dragfile 업로드 파일
   * @param {Array} filter 필터 옵션의 제한 된 확장자
   * @returns {boolean} 타입 비교 여부
   */
  function compareExtension(dragfile, filter) {
    var typeParam = typeof filter === "string" ? filter.replace(/\s/g, "") : "image/*",
      file,
      regex;

    typeParam = typeParam.
    replace(/[\-\[\]\/\{\}\(\)\+\?\.\\\^\$\|]/g, "\\$&").
    replace(/,/g, "|").
    replace(/\/\*/g, "/.*");

    if (dragfile) {
      regex = new RegExp(".?(" + typeParam + ")$", "i");
      file = dragfile[0];

      if (!file.type.match(regex)) {
        if (filter.match(/.?(xlsx|xls)$/i)) {
          // 엑셀(xlsx | xls) 필터 설정 시 type 명이 달라서 (sheet | excel)로 찾아줘야함
          if (!file.type.match(/.?(sheet|excel)$/i)) {
            return false;
          }
        } else {
          return false;
        }
      }
    }
    return true;
  }

  /**
   * 파일명에서 확장자명 추출
   * @param {string} filename 파일명
   * @returns {string} 확장자명
   */
  function getExtension(filename, addDot) {
    var fileLen = filename.length;
    var lastDot = filename.lastIndexOf(".");
    if (!addDot) {
      lastDot += 1;
    }
    var fileExt = filename.substring(lastDot, fileLen).toLowerCase();
    return fileExt;
  }

  /**
   * 파일 확장자 필터를 설정합니다.
   * @param {FileComponent} file 파일 컴포넌트 인스턴스
   */
  function attachExtensionFilters(file) {
    var filter = "";
    if ($.isArray(file._options.filters) && file._options.filters.length > 0) {
      filter = file._options.filters.join(",");
    }
    if (filter) {
      file.$element.attr("accept", filter);
    }
  }

  /**
   * 파일 확장자 필터를 비웁니다.
   * @param {FileComponent} file 파일 컴포넌트 인스턴스
   */
  function clearExtensionFilters(file) {
    file.$element.removeAttr("accept");
  }

  /**
   * 파일 컴포넌트의 업로드 가능 여부 UI 처리를 수행합니다.
   * @param {FileComponent} file 파일 컴포넌트 인스턴스
   * @param {boolean} use 업로드 가능 여부
   */
  function updateUploadable(file, use) {
    var $wrapper = file._$wrapper;
    var className = "uploadable";

    if (use) {
      if (!$wrapper.hasClass(className)) {
        $wrapper.addClass(className);
      }
    } else {
      $wrapper.removeClass(className);
    }
    triggerLayoutChange(file, "filename");
  }

  /**
   * 파일 컴포넌트의 다운로드 가능 여부 UI 처리를 수행합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   * @param {boolean} use 다운로드 사용 여부
   */
  function updateDownloadable(file, use) {
    var $wrapper = file._$wrapper;
    var className = "downloadable";

    if (use) {
      if (!$wrapper.hasClass(className)) {
        $wrapper.addClass(className);
      }
    } else {
      $wrapper.removeClass(className);
    }
    triggerLayoutChange(file, "filename");
  }

  /**
   * 파일 컴포넌트의 선택 파일이 존재하는 경우에 대한 UI 처리를 수행합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   * @param {boolean} exists 파일 존재 여부
   */
  function updateFileExists(file, exists) {
    var $wrapper = file._$wrapper;
    var className = "exists";

    if (exists) {
      if (!$wrapper.hasClass(className)) {
        $wrapper.addClass(className);
      }
      checkOkPreview(file, $wrapper);
    } else {
      $wrapper.removeClass(className);
      $wrapper.removeClass("ok-preview");
    }

    triggerLayoutChange(file, "filename");
  }

  /**
   * 파일 컴포넌트의 업로드가 진행 중인지 여부에 대한 UI 처리를 수행합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   * @param {boolean} uploading 업로드 진행중인지 여부
   */
  function updateUploading(file, uploading) {
    var $wrapper = file._$wrapper;
    var className = "uploading";

    if (uploading) {
      if (!$wrapper.hasClass(className)) {
        $wrapper.addClass(className);
      }
    } else {
      $wrapper.removeClass(className);
    }
    triggerLayoutChange(file, "filename");
  }

  /**
   * 파일 컴포넌트의 업로드를 시작합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   * @param {Blob} blob 첨부파일
   */
  function startUploading(file, blob) {
    var uploaded,
      uploadedParameter = {};

    // 파일 업로드 시작
    uploadFile(blob, file).
    done(function (fileData) {
      updateUploading(file, false);
      updateFileExists(file, true);
      deleteUpdateError(file);

      uploadedParameter = {
        file: {
          state: "success",
          filename: fileData.filename,
          extension: fileData.extension,
          size: fileData.size,
          fileKey: fileData.fileKey
        }
      };

      file._options.file = fileData;

      setFileData(file, fileData);
    }).
    fail(function (type) {
      // 업로드 실패
      updateUploading(file, false);

      uploadedParameter = {
        file: {
          state: "fail",
          filename: blob.name,
          extension: getExtension(blob.name, false),
          size: blob.size,
          fileKey: blob.fileKey
        }
      };

      switch (type) {
        case "cancel":
          setFileData(file, file._options.file);
          updateFileExists(file, false);
          break;
        case "error":
          updateError(file, true);
          break;}

    }).
    always(function () {
      updateUploading(file, false);

      uploaded = new $.Event("uploaded", uploadedParameter);
      file.$element.trigger(uploaded);

      file.$element.val("");
      file.uploading = false; // 업로드 중이 아님을 설정
    });
  }

  /**
   * 파일 컴포넌트의 업로드를 시작합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   * @param {Blob} blob 첨부파일
   */
  function startUploadingFiles(file, blob, length) {
    var uploaded,
      uploadedParameter = [];
    var self = this;

    // 파일 업로드 시작
    uploadFile(blob, file).
    done(function (fileData) {
      file.options.files.push(fileData);

      if (length !== file.options.files.length) {
        return;
      }

      updateUploading(file, false);
      updateFileExists(file, true);
      deleteUpdateError(file);

      for (var i = 0; i < file.options.files.length; i++) {
        var object = {
          file: {
            state: "success",
            filename: file.options.files[i].filename,
            extension: file.options.files[i].extension,
            size: file.options.files[i].size,
            fileKey: file.options.files[i].fileKey
          }
        };
        uploadedParameter.push(object);
      }

      file._options.file = file.options.files;

      setFileData(file, file.options.files);
    }).
    fail(function (type) {
      // 업로드 실패
      updateUploading(file, false);

      for (var i = 0; i < file.length; i++) {
        var object = {
          file: {
            state: "fail",
            filename: blob[i].name,
            extension: getExtension(blob[i].name, false),
            size: blob[i].size,
            fileKey: blob[i].fileKey
          }
        };
        uploadedParameter.push(object);
      }

      switch (type) {
        case "cancel":
          setFileData(file, file._options.file);
          updateFileExists(file, false);
          break;
        case "error":
          updateError(file, true);
          break;}

    }).
    always(function () {
      updateUploading(file, false);

      for (var i = 0; i < uploadedParameter.length; i++) {
        uploaded = new $.Event("uploaded", uploadedParameter);
        file.$element.trigger(uploaded);

        file.$element.val("");
        file.uploading = false; // 업로드 중이 아님을 설정
      }
    });
  }

  /**
   * 파일 컴포넌트의 에러 상태에 대한 UI 처리를 수행합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   * @param {boolean} error 에러 발생 여부
   */
  function updateError(file, error) {
    var $wrapper = file._$wrapper;
    var className = "error";

    if (error) {
      if (!$wrapper.hasClass(className)) {
        $wrapper.addClass(className);
      }
    } else {
      $wrapper.removeClass(className);
    }
    triggerLayoutChange(file, "filename");
  }

  /**
   * 파일 컴포넌트 에러상태 제거
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   */
  function deleteUpdateError(file) {
    var $wrapper = file._$wrapper;

    if ($wrapper.hasClass("error")) {
      $wrapper.removeClass("error");
    }
  }

  /**
   * 파일 정보를 설정합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   * @param {FileData} data 설정할 파일 데이터
   * @param {boolean} [ev = true] 이벤트 발생 여부
   */
  function setFileData(file, data, ev) {
    var $wrapper = file._$wrapper;

    if ($.type(data) === "array") {
      ev = $.type(ev) === "undefined" ? true : ev;
      file.$text.val(data && data[0].filename ? data[0].filename + "외 " + (data.length - 1) : "");

      if ($.isPlainObject(data) && data.filename && ev) {
        triggerFileChange(file, data);
      }

      checkOkPreview(file, $wrapper);
    } else {
      ev = $.type(ev) === "undefined" ? true : ev;
      file.$text.val(data && data.filename ? data.filename : "");

      if ($.isPlainObject(data) && data.filename && ev) {
        triggerFileChange(file, data);
      }

      checkOkPreview(file, $wrapper);
    }
  }

  /**
   * 설정된 파일 정보를 삭제합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   * @param {element} 파일 컴포넌트 wrapper
   */
  function checkOkPreview(file) {
    var $wrapper = file._$wrapper;

    if (
    file.options.usePreview &&
    file.getFile() &&
    file.getFile().extension.match(/(gif|png|jpg|jpeg|pdf|html)$/i))
    {
      $wrapper.addClass("ok-preview");
    } else {
      $wrapper.removeClass("ok-preview");
    }
  }

  /**
   * 설정된 파일 정보를 삭제합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   * @param {boolean} [ev = true] 이벤트 발생 여부
   */
  function deleteFile(file, ev) {
    var deleteParameter,
      data = file.getFile();
    ev = $.type(ev) === "undefined" ? true : ev;
    var $wrapper = file._$wrapper;

    if (data) {
      deleteParameter = {
        file: {
          filename: file.options.file.filename,
          extension: file.options.file.extension,
          fileKey: file.options.file.fileKey
        }
      };
      var evt = $.Event("preDelete", deleteParameter);
      file.$element.trigger(evt);

      if (evt.isDefaultPrevented()) {
        return;
      }

      file._options.file = undefined;
      file.$text.val("");
      hideTooltip(file);

      if (file.options.usePreview) {
        $wrapper.removeClass("ok-preview");
      }
    }
    if (ev) {
      triggerFileChange(file);
    }
  }

  /**
   * 파일 컴포넌트에 포커스 UI 처리를 설정합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   */
  function setFocus(file) {
    var $wrapper = file._$wrapper;
    if (!$wrapper.hasClass("focused")) {
      $wrapper.addClass("focused");
      setFocusUserGuidItem(file);
    }
  }

  /**
   * 파일 컴포넌트에 포커스가 진입하면 사용자 가이드의 매핑 항목을 표시할 수 있도록 처리합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   */
  function setFocusUserGuidItem(file) {
    file.$text.on("focus", function () {
      var page = dews.ui.page;
      if (page && page.hasUserGuide) {
        if ($.isFunction(page.focusGuideItem) && file.$element.attr("id")) {
          page.focusGuideItem("#" + file.$element.attr("id"));
        }
      }
    });
  }

  /**
   * 파일 컴포넌트의 포커스 UI 처리를 제거합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   */
  function removeFocus(file) {
    var $wrapper = file._$wrapper;
    $wrapper.removeClass("focused");
  }

  /**
   * 파일 정보 툴팁을 표시합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   */
  function showFileInfoTooltip(file) {
    if ($.type(file.options.file) === "array") {
      var size = 0;

      for (var i = 0; i < file.options.file.length; i++) {
        size += file.options.file[i].size;
      }

      dews.ui.tooltip.show(file._$wrapper, {
        fadeOutTime: 0,
        text:
        file._options.file[0].filename +
        "외 " + (
        file._options.file.length - 1) + (
        size ? " <small>(" + humanReadableFileSize(size) + ")</small>" : "")
      });
    } else {
      dews.ui.tooltip.show(file._$wrapper, {
        fadeOutTime: 0,
        text:
        file._options.file.filename + (
        file._options.file.size ?
        " <small>(" + humanReadableFileSize(file._options.file.size) + ")</small>" :
        "")
      });
    }
  }

  /**
   * 파일 업로드 진행사항 툴팁을 표시합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   */
  function showProgressTooltip(file) {




    // dews.ui.tooltip.show(file._$wrapper, {
    //     fadeOutTime: 0
    // });
    // 툴팁 텍스트 변경 시 위치 문제로 인해 업데이트가 될 때 마다 툴팁 출력으로 변경
  } /**
   * 파일 업로드 진행사항 툴팁을 갱신합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   * @param {number} uploaded 업로드된 용량
   * @param {number} total 전체 용량
   * @param {number} percent 진행률
   */function updateProgressTooltip(file, uploaded, total, percent) {dews.ui.tooltip.hide(file._$wrapper);
    dews.ui.tooltip.show(file._$wrapper, {
      fadeOutTime: 0,
      text:
      percent +
      "% <small>(" +
      humanReadableFileSize(uploaded) +
      "/" +
      humanReadableFileSize(total) +
      ")</small>"
    });
  }

  /**
   * 출력 중인 툴팁을 제거합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   */
  function hideTooltip(file) {
    dews.ui.tooltip.hide(file._$wrapper);
  }

  /**
   * 파일 컴포넌트를 읽기 전용으로 설정합니다.
   * @param file
   */
  function setReadonly(file) {
    var $wrapper = file._$wrapper;
    var $element = file.$element;

    if (!$wrapper.hasClass("readonly")) {
      $wrapper.addClass("readonly");
    }
    if (!$element.prop("readonly")) {
      $element.prop("readonly", true);
    }
    updateUploadable(file, false);
    updateDownloadable(file, false);
  }

  /**
   * 파일 컴포넌트를 읽기 전용 상태에서 해제합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   */
  function removeReadonly(file) {
    var $wrapper = file._$wrapper;
    var $element = file.$element;

    if ($wrapper.hasClass("readonly")) {
      $wrapper.removeClass("readonly");
    }
    if ($element.prop("readonly")) {
      $element.prop("readonly", false);
    }
    updateUploadable(file, file._options.upload.use);
    updateDownloadable(file, file._options.download.use);
  }

  /**
   * 파일 컴포넌트를 비활성화 상태로 설정합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   */
  function setDisable(file) {
    var $wrapper = file._$wrapper;
    var $element = file.$element;
    var $text = file.$text;

    if (!$wrapper.hasClass("disabled")) {
      $wrapper.addClass("disabled");
    }
    if (!$element.prop("disabled")) {
      $element.prop("disabled", true);
    }
    if (!$text.prop("disabled")) {
      $text.prop("disabled", true);
    }
    updateUploadable(file, false);
    updateDownloadable(file, false);
  }

  /**
   * 파일 컴포넌트를 활성화 상태로 설정합니다.
   * @param file
   */
  function removeDisable(file) {
    var $wrapper = file._$wrapper;
    var $element = file.$element;
    var $text = file.$text;

    if ($wrapper.hasClass("disabled")) {
      $wrapper.removeClass("disabled");
    }
    if ($element.prop("disabled")) {
      $element.prop("disabled", false);
    }
    if ($text.prop("disabled")) {
      $text.prop("disabled", false);
    }
    updateUploadable(file, file._options.upload.use);
    updateDownloadable(file, file._options.download.use);
  }

  /**
   * 파일 컴포넌트를 필수 입력 상태로 설정합니다.
   * @param {FileComponent} file 파일 컴포넌트 인스턴스
   */
  function setRequired(file) {
    var $wrapper = file._$wrapper;
    var $element = file.$element;

    if (!$wrapper.hasClass("required")) {
      $wrapper.addClass("required");
    }
    if (!$element.hasClass("required")) {
      $element.addClass("required");
    }
  }

  /**
   * 파일 컴포넌트를 필수 입력 상태에서 해제합니다.
   */
  function removeRequired(file) {
    var $wrapper = file._$wrapper;
    var $element = file.$element;

    if ($wrapper.hasClass("required")) {
      $wrapper.removeClass("required");
    }
    if ($element.hasClass("required")) {
      $element.removeClass("required");
    }
  }

  /**
   * 레이아웃 변경이 일어났다는 이벤트를 발생시킴
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   * @param {string} mode 변경된 레이아웃의 형식
   */
  function triggerLayoutChange(file, mode) {
    var $evt = new $.Event("_layoutChange");
    $evt.changeType = mode;
    file._$wrapper.trigger($evt);
  }

  /**
   * 파일이 변경되었다는 이벤트를 발생시킴
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   * @param {FileData} [data] 설정된 파일의 인스턴스
   */
  function triggerFileChange(file, data) {
    var $evt = new $.Event("_change");

    if ($.type(data) === "array") {
      for (var i = 0; i < data.length; i++) {
        $evt.file = data[i];
        $evt.isDeleted = false;
        if ($.type(data) === "undefined") {
          $evt.isDeleted = true;
        }
        file.$element.trigger($evt);
      }
    } else {
      $evt.file = data;
      $evt.isDeleted = false;
      if ($.type(data) === "undefined") {
        $evt.isDeleted = true;
      }
      file.$element.trigger($evt);
    }
  }

  /**
   * 패널 내에서 다음 컴포넌트로 포커스를 이동시키는 이벤트를 발생시킵니다.
   * @param {FileComponent} file 파일 컴포넌트 인스턴스
   */
  function triggerNextFocus(file) {
    var evt = new $.Event("nextFocus");
    evt.control = file;

    file.$element.trigger(evt);
  }

  /**
   * 패널 내에서 다음 컴포넌트로 포커스를 이동시키는 이벤트를 발생시킵니다.
   * @param {FileComponent} file 파일 컴포넌트 인스턴스
   */
  function triggerPreviousFocus(file) {
    var evt = new $.Event("beforeFocus");
    evt.control = file;

    file.$element.trigger(evt);
  }

  /**
   * 서버로 파일을 업로드합니다.
   *
   * @param {Blob} blob 업로드 할 파일입니다.
   * @param {FileComponent} file 파일 컴포넌트 인스턴스입니다.
   */
  function uploadFile(blob, file) {
    var $dfd = $.Deferred();
    var $wrapper = file._$wrapper;

    // 업로드 프로그래스 요소 생성
    var createProgress = function createProgress() {
      file._$wrapper.prepend('<span class="progress-bar" style="width: 0px;"></span>');
      file._$wrapper.addClass("uploading");
    };
    // 업로드 프로그래스 요소 제거
    var removeProgress = function removeProgress() {
      file._$wrapper.find(".progress-bar").remove();
      file._$wrapper.removeClass("uploading");
    };
    // 업로드 프로그래스 값 변경
    var updateProgress = function updateProgress(percent) {
      var $progress = file._$wrapper.find(".progress-bar");
      $progress.css("width", percent + "%");
    };

    // 업로드 진행률 변경에 대한 핸들러
    var progressHandler = function progressHandler(e) {
      var percentCompleted = Math.round(e.loaded / e.total * 100);
      console.log("## 첨부파일 업로드 ##", e.loaded, e.total, percentCompleted);
      updateProgress(percentCompleted);
      updateProgressTooltip(file, e.loaded, e.total, percentCompleted);
    };

    // 업로드 완료에 대한 핸들러
    var completeHandler = function completeHandler(e) {
      /**
       * @type {FileData}
       */
      var fileData = {};
      removeProgress();
      clearCancelEvent();
      if (this.status === 200) {
        var data = JSON.parse(this.responseText);

        if (data.success === "true") {
          data = data.data;
          fileData.fileKey = data.newFilename;
          fileData.filename = data.originalFilename;
          fileData.extension = data.originalExtension;
          fileData.size = parseInt(data.fileSize, 10);
          fileData.isNew = true;
        }
      }
      hideTooltip(file);
      $dfd.resolve(fileData);
    };
    // 업로드 중 에러에 대한 핸들러
    var errorHandler = function errorHandler(e) {
      removeProgress();
      clearCancelEvent();
      $dfd.reject("error");
    };
    // 업로드 중 취소에 대한 핸들러
    var cancelHandler = function cancelHandler(e) {
      removeProgress();
      clearCancelEvent();
      $dfd.reject("cancel");
    };

    // 업로드 취소에 이벤트에 등록된 핸들러를 제거
    var clearCancelEvent = function clearCancelEvent() {
      $wrapper.off("_uploadCancel");
    };

    if (!blob) return;

    var token = dews.ui.page ? JSON.parse(dews.ui.page.token).access_token : "";

    var formData = new FormData();
    formData.append("file", blob);
    formData.append("isText", "false");
    formData.append(file._options.token.param, token);

    var xhr = new XMLHttpRequest();
    xhr.open("POST", file._options.upload.url, true);

    xhr.upload.addEventListener("progress", progressHandler);
    xhr.addEventListener("load", completeHandler);
    xhr.addEventListener("error", errorHandler);
    xhr.addEventListener("abort", cancelHandler);

    createProgress();

    $wrapper.on("_uploadCancel", function () {
      if (xhr && xhr.readyState === 1 && file.uploading) {
        xhr.abort();
        xhr = null;
      }
    });

    xhr.send(formData);

    return $dfd.promise();
  }

  /**
   * 서버에서 파일을 다운로드합니다.
   * @param {FileComponent} file 파일 컴포넌트 인스턴스입니다.
   */
  function downloadFile(file) {
    // 다운로드 프레임 확보
    var $frame = file._$wrapper.find(".download-frame");
    if ($frame.length === 0) {
      $frame = $('<iframe style="display: none; width: 0; height: 0;"></iframe>');
      file._$wrapper.append($frame);
    }

    // 첨부파일 다운로드
    /**
     * 첨부파일 다운로드를 시작합니다.
     * @param {string} [url] 다운로드 경로
     */
    var startDownload = function startDownload(url) {
      var downloadStartedParameter;

      $frame.prop("src", url);

      downloadStartedParameter = {
        file: {
          filename: file.options.file.filename,
          extension: file.options.file.extension,
          size: file.options.file.size,
          fileKey: file.options.file.fileKey
        }
      };

      var downloadStarted = new $.Event("downloadStarted", downloadStartedParameter);
      file.$element.trigger(downloadStarted);
    };

    getDownloadUrl(file).then(startDownload);
  }

  /**
   * 서버에서 여러개의 파일을 다운로드합니다.
   * @param {FileComponent} files 파일 컴포넌트 인스턴스입니다.
   */
  function downloadFiles(files) {
    var $frame;

    for (var i = 0; i < files.options.file.length; i++) {
      $frame = files._$wrapper.find(".download-frame");

      if ($frame.length === 0) {
        $frame = $('<iframe style="display: none; width: 0; height: 0;"></iframe>');
        files._$wrapper.append($frame);
      }
    }

    var startDownload = function startDownload(url) {
      $frame.prop("src", url);
      var downloadStartedParameter = {
        files: []
      };
      for (var i = 0; i < files.options.file.length; i++) {
        downloadStartedParameter.files.push({
          filename: files.options.file[i].filename,
          extension: files.options.file[i].extension,
          size: files.options.file[i].size,
          fileKey: files.options.file[i].fileKey
        });
      }

      // 다운로드 시작 이벤트
      var downloadStarted = new $.Event("downloadStarted", downloadStartedParameter);
      files.$element.trigger(downloadStarted);
    };

    getDownloadUrlFiles(files).then(startDownload);
  }

  /**
   * 첨부파일 다운로드를 위한 임시 인증 토큰을 획득합니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   * @returns {$.Deferred} Promise 객체
   */
  function getTemporaryToken(file) {
    var $dfd = $.Deferred();
    var token = "";

    if (file._options.token && file._options.token.use) {
      dews.api.
      get(file._options.token.url, {}).
      done(function (tokenData) {
        token = tokenData;
      }).
      always(function () {
        $dfd.resolve(token);
      });
    } else {
      $dfd.resolve(token);
    }

    return $dfd;
  }

  /**
   * 파일 컴포넌트에 설정된 파일의 다운로드가 가능한 URL을 가져옵니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   * @return {$.Deferred} Promise 객체
   */
  function getDownloadUrl(file) {
    var $dfd = $.Deferred();

    var makeUrl = function makeUrl(token) {
      var url;
      var preDownloadParameter, evt;

      preDownloadParameter = {
        file: {
          filename: file._options.file.filename,
          extension: file._options.file.extension,
          fileKey: file._options.file.fileKey
        }
      };
      evt = $.Event("preDownload", preDownloadParameter);
      file.$element.trigger(evt);

      if (evt.isDefaultPrevented()) {
        return;
      }

      if (file._options.file.isNew) {
        // 임시파일
        url =
        file._options.download.tempUrl +
        "?" +
        file._options.download.param +
        "=" +
        encodeURIComponent(file._options.file.fileKey) +
        "&filename=" +
        encodeURIComponent(file._options.file.filename);
        if (token) {
          url += "&" + file._options.token.param + "=" + encodeURIComponent(token);
        }
      } else {
        // 기존파일
        url =
        file._options.download.url +
        "?" +
        file._options.download.param +
        "=" +
        encodeURIComponent(file._options.file.fileKey);
        if (token) {
          url += "&" + file._options.token.param + "=" + encodeURIComponent(token);
        }
      }

      return url;
    };

    if (file._options.file) {
      getTemporaryToken(file).done(function (token) {
        $dfd.resolve(makeUrl(token));
      });
    } else {
      $dfd.resolve("");
    }

    return $dfd;
  }

  /**
   * 파일 컴포넌트에 설정된 파일의 다운로드가 가능한 URL을 가져옵니다.
   * @param {FileComponent} file 파일 컴포넌트의 인스턴스
   * @return {$.Deferred} Promise 객체
   */
  function getDownloadUrlFiles(file) {
    var $dfd = $.Deferred();

    var makeUrl = function makeUrl(token) {
      var url;
      var preDownloadParameter, evt;

      url = "/download/files" + "?" + "keys=";
      for (var i = 0; i < file.options.file.length; i++) {
        preDownloadParameter = {
          file: {
            filename: file.options.file[i].filename,
            extension: file.options.file[i].extension,
            fileKey: file.options.file[i].fileKey
          }
        };

        evt = $.Event("preDownload", preDownloadParameter);
        file.$element.trigger(evt);

        if (evt.isDefaultPrevented()) {
          continue;
        }

        if (file.options.file[i].isNew) {
          url +=
          encodeURIComponent(file.options.file[i].fileKey) +
          ":" +
          encodeURIComponent(file.options.file[i].filename);
        } else {
          url += encodeURIComponent(file.options.file[i].fileKey);
        }
        if (i !== file.options.file.length - 1) {
          url += ",";
        }
      }
      url += "&zipname=";
      url += "undefined";
      if (token) {
        url += "&" + file._options.token.param + "=" + encodeURIComponent(token);
      }
      return url;
    };

    getTemporaryToken(file).done(function (token) {
      $dfd.resolve(makeUrl(token));
    });

    return $dfd;
  }

  /**
   * 파일 크기를 사용자가 인식할 수 있는 포맷으로 변경합니다.
   * @param {number} size 파일크기
   * @returns {string} 포맷이 적용된 파일 크기
   */
  function humanReadableFileSize(size) {
    var i = Math.floor(Math.log(size) / Math.log(1024));
    return (size / Math.pow(1024, i)).toFixed(2) * 1 + " " + ["B", "kB", "MB", "GB", "TB"][i];
  }

  /**
   * 업로드 제한할 확장자 파일인지 확인 합니다.
   * @param {string} 파일명
   * @returns {boolean} 업로드 제한할 확장자 파일인지 여부
   */
  function isLimitExtension(fileNm) {
    var isLimit = false;

    var ext = getExtension(fileNm);

    if (
    dews._environments.files &&
    dews._environments.files.ignored &&
    dews._environments.files.ignored.extensions)
    {
      var arrExt = dews._environments.files.ignored.extensions;

      if (arrExt.indexOf(ext) > -1) {
        isLimit = true;
        dews.alert(
        "[" +
        fileNm +
        "]\n" +
        dews.localize.get("업로드 제한된 확장자입니다.", "dews_업로드 제한된 확장자입니다."),
        "error");

      }
    }

    return isLimit;
  }

  /**
   * 단일 파일 컴포넌트의 생성자입니다.
   *
   * @class FileComponent
   * @classdesc 단일 파일 컴포넌트입니다.
   *
   * @property {FileOptions} options 컴포넌트 초기화 시에 설정된 옵션 정보 입니다.
   * @property {Element} element 컴포넌트 생성 대상 요소입니다.
   * @property {jQuery} $element 컴포넌트 생성 대상 요소의 jQuery 객체입니다.
   * @property {boolean|undefined} initialized 컴포넌트가 초기화 되어 있는 상태인지 여부입니다.
   * @property {{$upload: jQuery, $download: jQuery, $delete: jQuery}} $buttons 파일 컴포넌트 버튼
   * @property {jQuery} $text 파일명을 표시하는 요소의 jQuery 객체입니다.
   * @property {boolean} uploading 현재 업로드 중인지 여부를 가져옵니다.
   *
   * @property {FileOptions} _options 컴포넌트 내부에서 실제 사용되는 옵션입니다.
   * @property {jQuery} _$wrapper 컨테이너 요소의 jQuery 객체입니다.
   * @property {jQuery} _$fileBox 파일 컴포넌트의 박스 영역의 jQuery 객체입니다.
   * @property {boolean} _usePanelFocus 패널 내부에서의 포커스 처리를 수행하는지 여부입니다.
   *
   * @param {Element} el 변환 대상 요소
   * @param {FileOptions} [opt] 옵션
   */
  function FileComponent(el, opt) {
    var self = this;
    var options = $.extend(true, {}, defaultOptions, getInlineOptions(el), opt);

    self.element = el;
    self.$element = $(el);
    self._options = options; // 실제 사용되는 옵션
    self.options = options; // 초기화 시 할당된 옵션 정보

    initialize(self);
  }

  /**
   * 파일 컴포넌트에 파일 정보를 설정합니다.
   * @param {FileData} file
   */
  FileComponent.prototype.setFile = function (file) {
    var self = this;
    if (file && $.isPlainObject(file)) {
      self._options.file = $.extend(true, {}, { isNew: false }, file);
      updateFileExists(self, true);
      setFileData(self, self._options.file, false);
    }
  };

  /**
   * 파일 컴포넌트에 설정된 파일 정보를 삭제합니다.
   */
  FileComponent.prototype.deleteFile = function () {
    var self = this;
    deleteFile(self, false);
    updateFileExists(self, false);
  };

  /**
   * 파일 컴포넌트에 설정된 파일 정보를 가져옵니다.
   */
  FileComponent.prototype.getFile = function () {
    var self = this;
    return self._options.file;
  };
  /**
   * 파일 컴포넌트의 읽기전용 상태 설정 여부를 가져오거나 설정합니다.
   * @param {boolean|undefined} val 값이 있으면 읽기전용 상태를 설정합니다.
   * @returns {*} 파리미터가 없을 때는 설정된 읽기전용 여부를 가져옵니다.
   */
  FileComponent.prototype.readonly = function (val) {
    var self = this;
    if ($.type(val) === "undefined") {
      return self.$element.prop("readonly");
    } else {
      val ? setReadonly(self) : removeReadonly(self);
    }
  };
  /**
   * 파일 컴포넌트의 읽기전용 상태 설정 여부를 가져오거나 설정합니다.
   * @param {boolean|undefined} val 값이 있으면 읽기전용 상태를 설정합니다.
   * @returns {*} 파리미터가 없을 때는 설정된 읽기전용 여부를 가져옵니다.
   */
  FileComponent.prototype.enable = function (val) {
    var self = this;
    if ($.type(val) === "undefined") {
      return !self.$element.prop("disabled");
    } else {
      !val ? setDisable(self) : removeDisable(self);
    }
  };

  /**
   * 파일컴포넌트의 visible 여부를 가져옵니다.
   * @returns {boolean}
   * @private
   */
  FileComponent.prototype._visibleCheckFromPanel = function () {
    var self = this,
      $ctrl = self.$element;
    isVisible = $ctrl.closest(".dews-file-wrapper").css("display") !== "none";

    return isVisible;
  };

  /**
   * 파일 컴포넌트의 필수입력 상태 설정 여부를 설정하거나 해제합니다.
   * @param {boolean} required 상태값
   */
  // FileComponent.prototype.required = function (val) {
  //     var $wrapper = file._$wrapper;
  //
  //     if (!$wrapper.hasClass('required')) {
  //         $wrapper.addClass('required');
  //     }
  // };

  /**
   * 파일 컴포넌트의 필수입력 상태 설정 여부를 가져오거나 설정합니다.
   * @param {boolean|undefined} val 값이 있으면 필수입력 상태를 설정합니다.
   * @returns {*|boolean} 파라미터가 없을 때는 설정된 필수입력 여부를 가져옵니다.
   */
  FileComponent.prototype.required = function (val) {
    var self = this;
    if ($.type(val) === "undefined") {
      return self.$element.hasClass("required");
    } else {
      val ? setRequired(self) : removeRequired(self);
    }
  };

  FileComponent.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change", "preUpload", "preDownload", "preDelete", "uploaded", "downloadStarted"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "change") {
          self.$element.trigger("_change");
        } else {
          self.$element.trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  /**
   * 이벤트 핸들러를 등록합니다.
   */
  FileComponent.prototype.on = function () {
    var self = this;

    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    }

    self.$element.on.apply(self.$element, arguments);
  };

  /**
   * 이벤트 핸들러를 제거합니다.
   */
  FileComponent.prototype.off = function () {
    var self = this;

    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    }

    self.$element.off.apply(arguments);
  };

  /**
   * 업로드 파일 선택 다이얼로그에 파일 필터를 추가합니다.
   * @param {...string} extensions 필터로 설정할 확장자 입니다.
   */
  FileComponent.prototype.addFileFilters = function (extensions) {
    var self = this;
    var newFilters = Array.prototype.slice.call(arguments);
    if (!$.isArray(self._options.filters)) {
      self._options.filters = [];
    }

    if (newFilters.length > 0) {
      self._options.filters = self._options.filters.concat(newFilters);

      attachExtensionFilters(self);
    }
  };

  /**
   * 업로드 파일 선택 다이얼로그의 파일 필터에서 지정한 항목들을 제거합니다.
   * @param {...string} extensions 필터에서 제거할 확장자 입니다.
   */
  FileComponent.prototype.removeFileFilters = function (extensions) {
    var self = this;

    if (!$.isArray(self._options.filters)) {
      self._options.filters = [];
    }

    var removes = Array.prototype.slice.call(arguments);
    self._options.filters = self._options.filters.filter(function (item) {
      return removes.indexOf(item) < 0;
    });

    attachExtensionFilters(self);
  };

  /**
   * 업로드 파일 선택 다이얼로그의 파일 필터를 초기화합니다.
   */
  FileComponent.prototype.clearFileFilters = function () {
    var self = this;
    self._options.filters = [];
    clearExtensionFilters(self);
  };

  /**
   * 설정된 파일 선택 다이얼로그의 파일 필터를 가져옵니다.
   * @returns {string[]} 파일 필더 배열 객체
   */
  FileComponent.prototype.getFileFilters = function () {
    var self = this;
    return self._options.filters || [];
  };

  /**
   * 파일 컴포넌트가 포커스를 받을 수 있는 지 여부를 판별합니다.
   */
  FileComponent.prototype.canFocusable = function () {
    var self = this;
    var $wrapper = self._$wrapper;

    return !$wrapper.hasClass("readonly") && !$wrapper.hasClass("disabled") && $wrapper.is(":visible");
  };

  FileComponent.prototype.applyPanelFocus = function () {
    var self = this;
    self._usePanelFocus = true;

    self.on("change", function (e) {
      if (!e.isDeleted) {
        triggerNextFocus(self);
      }
    });
  };

  /**
   * 파일 컴포넌트에 포커스를 설정합니다.
   */
  FileComponent.prototype.focus = function () {
    var self = this;
    self.$text.focus();
  };

  /**
   * 파일 컴포넌트의 필수입력에 대한 유효성을 검사합니다.
   * @returns {boolean} 유효성
   */
  FileComponent.prototype.validate = function () {
    var self = this;
    return !!self._options.file;
  };

  /**
   * 패널 컨테이너에서 전달된 JSON 데이터를 파일 컴포넌트에 바인딩합니다.
   * @param {{}} data 전달된 바인딩 대상 데이터
   */
  FileComponent.prototype.bindFromPanel = function (data) {
    var self = this;
    var convertData = function convertData(source) {
      /** @type {FileData} */
      var converted;
      var fields, fileKey, filename, extension, size, isNew;

      if (self._options.binding) {
        converted = {};
        fields = self._options.binding;
        fileKey = fields.fileKey ? source[fields.fileKey] : undefined;
        filename = fields.filename ? source[fields.filename] : undefined;
        extension = fields.extension ? source[fields.extension] : undefined;
        size = fields.size ? source[fields.size] : undefined;
        isNew = fields.isNew ? [fields.isNew] : undefined;

        if (fileKey) {
          converted.fileKey = fileKey;
        }
        if (filename) {
          converted.filename = filename;
        }
        if ($.type(extension) === "number") {
          converted.size = size;
        } else if ($.type(extension) === "string") {
          converted.size = parseInt(size, 10);
        }
        if ($.type(isNew) === "boolean") {
          converted.isNew = isNew;
        } else if ($.type(isNew) === "string") {
          converted.isNew = isNew === "true";
        }
      }

      return converted;
    };

    if (data && $.isPlainObject(data)) {
      var bindData = convertData(data);
      self.setFile(bindData);
    }
  };

  /**
   * 패널 컴포넌트들에서 사용하기 위해서 컴포넌트의 데이터를 JSON 객체로 직렬화 합니다.
   * @returns {{}}
   */
  FileComponent.prototype.serializeForPanel = function () {
    var self = this;
    var data;
    /** @param {FileData} fileData */
    var convertData = function convertData(fileData) {
      /** @type {BindingOptions} */
      var bindings = self._options.binding;
      var converted;

      if (bindings && $.isPlainObject(bindings)) {
        converted = {};

        bindings.fileKey && (converted[bindings.fileKey] = fileData.fileKey);
        bindings.filename && (converted[bindings.filename] = fileData.filename);
        bindings.extension && (converted[bindings.extension] = fileData.extension);
        bindings.size && (converted[bindings.size] = fileData.size);
        bindings.isNew && (converted[bindings.isNew] = fileData.isNew);
      }

      return converted;
    };

    if (self._options.file && $.isPlainObject(self._options.file)) {
      data = convertData(self._options.file);
    }

    return data;
  };

  /**
   * 파일 컴포넌트에 설정된 파일의 다운로드가 가능한 주소를 가져옵니다.
   * @return {$.Deferred}
   */
  FileComponent.prototype.getDownloadUrl = function () {
    var self = this;
    return getDownloadUrl(self);
  };

  /**
   * 파일 컨트롤 자동화 인쇄 관련 데이터 추출
   * @return {*} 값이 설정 된 경우 Object 반환, 없는 경우 undefined 반환
   * @private
   */
  FileComponent.prototype._getPrintData = function () {
    return undefined;
  };

  /**
   * 파일 컨트롤 display none 하여 숨기는 API
   */
  FileComponent.prototype.hide = function () {
    var self = this;

    if (!(self._$wrapper.css("display") === "none")) {
      self._$wrapper.css("display", "none");
    }
  };

  /**
   * 파일 컨트롤 display inline-block 하여 보이도록 하는 API
   */
  FileComponent.prototype.show = function () {
    var self = this;

    if (self._$wrapper.css("display") === "none") {
      self._$wrapper.css("display", "inline-block");
    }
  };

  FileComponent.prototype.setOptions = function (options) {
    this._options = $.extend(true, {}, this._options, options);
    updateUploadable(this, this._options.upload.use);
    updateDownloadable(this, this._options.download.use);
    updateFileExists(this, !!this._options.file);
  };

  /**
   * 파일 컨트롤에 설정되어 있는 파일의 미리보기를 제공하는 API
   * => image, pdf, html 에 한해서
   */
  function filePreview(file) {
    var self = file;
    var fileInfo = self.getFile();

    if (self.options.usePreview && fileInfo) {
      var extension = fileInfo.extension;

      if (extension.match(/(gif|png|jpg|jpeg|pdf|html)$/i)) {
        if (extension.match(/(gif|png|jpg|jpeg)$/i)) {
          // 이미지 파일은 기존대로 download/image/ 경로
          extension = "image";
        }

        var previewUrl = "/download/" + extension + "/" + fileInfo.fileKey;

        if (fileInfo.isNew) {
          // temp일 경우 :파일명 붙여줌
          var fileName = fileInfo.filename;

          if (fileInfo.extension.match(/(html)$/i)) {
            // temp html파일에 한하여 확장자 떼고 호출(서버쪽에서 html을 붙이면 호출이 잘못 된다고 함)
            fileName = fileInfo.filename.replace(/.?(html)$/i, "");
          }

          previewUrl += ":" + fileName;
        }

        window.open(previewUrl);
      }
    }
  }

  $.extend(true, dews, {
    /**
     * @namespace
     */
    ui: {
      /**
       * 지정한 요소를 파일 컴포넌트로 생성하거나 이미 생성된 컴포넌트의 인스턴스를 가져옵니다.
       * @param selector {string|jQuery} 파일 컴포넌트로 생성할 대상을 찾을 셀렉터 문자열이거나 jQuery 객체입니다.
       * @param options {object} 파일 컴포넌트 옵션입니다.
       * @returns {FileComponent} 생성된 파일 컴포넌트의 인스턴스입니다.
       */
      file: function file(selector, options) {
        var $el, obj;
        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var file,
            element = this;

          if ($(element).data("dews-control")) {
            file = $(element).data("dews-control");
            $.extend(file._options, options);
            $.extend(file.options, options);

            if (file._options.multiple) {
              $el.attr("multiple", "multiple");
            }
          } else {
            if (!$(element).hasClass("dews-ui-file")) {
              $(element).addClass("dews-ui-file");
            }
            if (!$(element).hasClass("dews-form-control")) {
              $(element).addClass("dews-form-control");
            }

            file = new FileComponent(element, options);
            $(element).data("dews-control", file);

            // setAdditionalAPI($(element), file);
            // setUserGuideAPI($(element));
          }

          obj = file;
        });

        return obj;
      }
    }
  });

  dews.ui.addControlInitializer("file", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.file($("input[type=file].dews-ui-file", $container));
  });
})(jQuery, window.dews);


(function ($, dews, kendo) {
  // 기본 옵션
  var defaultOption = {};

  var FileButton = function FileButton(element, option) {
    var self = this,
      $element = $(element);

    self.$element = $element;
    self.options = option;

    self._initControl();

    return self;
  };

  FileButton.prototype._initControl = function () {
    var self = this;

    self._createContainer();

    self._createInput();

    self._bindEvent();
  };
  // 버튼을 감쌀 wrapper를 만듭니다.
  FileButton.prototype._createContainer = function () {
    var self = this,
      container;

    container = $('<sapn class="dews-filebutton-wrapper">');

    if (self.$element.hasClass("disabled")) {
      container.addClass("dews-state-disabled");
      self.$element.prop("disabled", "disabled");
    }

    self.$element.wrap(container);
  };
  // input[type="file"]의 텍스트박스를 만듭니다.
  FileButton.prototype._createInput = function () {
    var self = this,
      input;

    input = $('<input type="file" class="dews-filebutton-input" style="display: none">');

    self.$element.closest(".dews-filebutton-wrapper").append(input);

    self.$input = input;
  };
  // fileButton 이벤트
  FileButton.prototype._bindEvent = function () {
    var self = this;

    self.$element.on("click", function (e) {
      if (!self.$element.hasClass("disabled")) {
        self.$input.click();
      }
      e.stopPropagation();
    });

    self.$input.on("change", function (e) {
      var event;

      if (e.target.files.length && e.target.files.length !== 0) {
        e.file = e.target.files;
        e.type = "fileSelect";
      } else {
        return false;
      }

      event = new $.Event("fileSelect", e);

      self.$element.trigger(event);
    });
  };
  // fileButton에 이벤트를 등록합니다.
  FileButton.prototype.on = function () {
    var self = this;

    if (arguments[0] === "fileSelect") {
      Array.prototype.splice.call(arguments, 0, 1, "change");
      self.$input.on.apply(self.$input, arguments);
    } else {
      self.$element.on.apply(self.$element, arguments);
    }
  };
  // fileButton에 이벤트를 해제합니다.
  FileButton.prototype.off = function () {
    var self = this;

    if (arguments[0] === "fileSelect") {
      Array.prototype.splice.call(arguments, 0, 1, "change");
      self.$input.off.apply(self.$input, arguments);
    } else {
      self.$element.off.apply(self.$element, arguments);
    }
  };
  /**
   * 파일 버튼의 활성화 유무를 설정하거나 값을 가져옵니다.
   * @param value {boolean} 활성화 유무를 설정할 값
   */
  FileButton.prototype.enable = function (value) {
    var self = this;

    if ($.type(value) === "undefined") {
      return !self.$element.hasClass("disabled");
    } else if ($.type(value) === "boolean") {
      if (value) {
        self.$element.removeClass("disabled");
        self.$element.prop("disabled", "");
        self.$element.closest(".dews-filebutton-wrapper").removeClass("dews-state-wrapper");
      } else {
        self.$element.addClass("disabled");
        self.$element.prop("disabled", "disabled");
        self.$element.closest(".dews-filebutton-wrapper").addClass("dews-state-wrapper");
      }
    }
  };

  $.extend(true, dews, {
    ui: {
      /**
       * fileButton 생성하거나 가져옵니다.
       * @param {string} selector 요소를 지정하는 셀렉터입니다.
       * @param {object} [options] 버튼 설정 값
       */
      filebutton: function filebutton(selector, options) {
        var $el, filebutton;

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var $this = $(this),
            file,
            opt;

          file = $this.data("dews-control");

          if (!file) {
            opt = $.extend(true, {}, defaultOption, options);

            if (!$this.hasClass("dews-control")) {
              $this.addClass("dews-control");
            }

            if (!$this.hasClass("dews-ui-filebutton")) {
              $this.addClass("dews-ui-filebutton");
            }

            if ($this.data("dews-localize-key")) {
              $this.text(
              dews.localize.get(
              $this.text(),
              $this.data("dews-localize-key"),
              $this.data("dews-localize-lang") || null));


            }

            file = new FileButton($this, opt);
            $this.data("dews-control", file);

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }
          }

          filebutton = file;
        });

        return filebutton;
      }
    }
  });

  dews.ui.addControlInitializer("filebutton", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.filebutton($("button.dews-ui-filebutton", $container));
  });
})(jQuery, window.dews, window.kendo);


/**
 * 간트 컴포넌트
 */
(function ($, dews, kendo) {
  /**
   * 기본 옵션
   * @type {GanttOptions}
   */
  var defaultOptions = {
    autoBind: true,
    taskMapping: {
      id: "id",
      end: "end",
      expanded: "expanded",
      orderId: "orderId",
      parentId: "parentId",
      percentComplete: "percentComplete",
      start: "start",
      summary: "summary",
      title: "title",
      color: "color"
    },
    dependenciesMapping: {
      id: "id",
      predecessorId: "predecessorId",
      successorId: "successorId",
      type: "type"
    },
    calender: "1",
    holidays: true
  };

  /**
   * 옵션을 설정합니다.
   *
   * @param {jQuery} $el jQuery 요소
   * @param {object} options Gantt 옵션
   * @return {{}}
   */
  function getOptions($el, options) {
    var opt = {},
      column,
      columnsIdx = 0;
    var taskMapping, dependenciesMapping;

    defaultOptions.messages = {
      actions: {
        addChild: dews.localize.get("자식 추가", "dews_자식 추가"),
        append: dews.localize.get("태스크", "dews_작업추가"),
        insertAfter: dews.localize.get("아래에 추가", "dews_아래에 추가"),
        insertBefore: dews.localize.get("위에 추가", "dews_위에 추가")
      },
      editor: {
        editorTitle: dews.localize.get("작업", "dews_작업"),
        assignButton: dews.localize.get("할당", "dews_할당"),
        start: dews.localize.get("시작", "dews_시작"),
        end: dews.localize.get("종료", "dews_종료"),
        title: dews.localize.get("제목", "dews_제목"),
        percentComplete: dews.localize.get("진행률", "dews_진행률"),
        resources: dews.localize.get("자원", "dews_자원"),
        resourcesEditorTitle: dews.localize.get("자원", "dews_자원"),
        resourcesHeader: dews.localize.get("자원", "dews_자원"),
        unitsHeader: dews.localize.get("진행률", "dews_진행률")
      },
      views: {
        day: dews.localize.get("일간", "dews_일간"),
        week: dews.localize.get("주간", "dews_주간"),
        month: dews.localize.get("월간", "dews_월간"),
        year: dews.localize.get("연간", "dews_연간"),
        end: dews.localize.get("종료", "dews_종료"),
        start: dews.localize.get("시작", "dews_시작")
      }
    };

    opt = $.extend(true, opt, defaultOptions, options);
    taskMapping = opt.taskMapping;
    dependenciesMapping = opt.dependenciesMapping;

    // height 설정
    if ($el.closest(".dews-ui-container-panel")) {
      var containerPanel = $el.closest(".dews-ui-container-panel");

      if (containerPanel.data("dews-fit-bottom")) {
        dews.ready(function () {
          $el.css("height", containerPanel.height());
        });
      }
    }

    if (opt.columns) {
      // 컬럼 필드 gantt field 명으로 변환
      for (columnsIdx; columnsIdx < opt.columns.length; columnsIdx++) {
        column = opt.columns[columnsIdx];

        switch (column.field) {
          case taskMapping.id:
            opt.columns[columnsIdx].field = "id";
            break;
          case taskMapping.orderId:
            opt.columns[columnsIdx].field = "orderId";
            break;
          case taskMapping.parentId:
            opt.columns[columnsIdx].field = "parentId";
            break;
          case taskMapping.start:
            opt.columns[columnsIdx].field = "start";
            if (column.format) {
              opt.columns[columnsIdx].format = "{0:" + column.format + "}";
            }
            break;
          case taskMapping.end:
            opt.columns[columnsIdx].field = "end";
            if (column.format) {
              opt.columns[columnsIdx].format = "{0:" + column.format + "}";
            }
            break;
          case taskMapping.title:
            opt.columns[columnsIdx].field = "title";
            break;
          case taskMapping.percentComplete:
            opt.columns[columnsIdx].field = "percentComplete";
            break;
          case taskMapping.summary:
            opt.columns[columnsIdx].field = "summary";
            break;
          case taskMapping.expanded:
            opt.columns[columnsIdx].field = "expanded";
            break;}


        /* 정해진 컬럼들 외의 컬럼 사용 시 새로 추가 시 undefined로 설정되는 현상 수정 */
        for (var key in taskMapping) {
          if (taskMapping[key] === opt.columns[columnsIdx].field) {
            opt.columns[columnsIdx].field = key;
          }
        }
      }
    }

    //#region 데이터소스
    // 간트 데이터소스
    if (opt.dataSource) {
      opt.dataSource = _createTaskDataSource(opt.dataSource, taskMapping);
    }

    // 간트 연결 데이터소스
    if (opt.dependencies) {
      opt.dependencies = _createDependencyDataSource(opt.dependencies, dependenciesMapping);
    }
    //#endregion

    //#region 시간 옵션 설정이 string 형식 일 경우 date 형식으로 변환
    if (opt.date) {
      if ($.type(opt.date) === "string") {
        opt.workDayStart = kendo.parseDate(
        opt.date,
        dews._environments.formats.dateTimeValueFormat,
        kendo.getCulture());

      }
    }
    if (opt.workDayStart) {
      if ($.type(opt.workDayStart) === "string") {
        opt.workDayStart = kendo.parseDate(
        opt.workDayStart,
        dews._environments.formats.dateTimeValueFormat,
        kendo.getCulture());

      }
    }
    if (opt.workDayEnd) {
      if ($.type(opt.workDayEnd) === "string") {
        opt.workDayStart = kendo.parseDate(
        opt.workDayEnd,
        dews._environments.formats.dateTimeValueFormat,
        kendo.getCulture());

      }
    }
    if (opt.range) {
      if (opt.range.start && $.type(opt.range.start) === "string") {
        opt.range.start = kendo.parseDate(
        opt.range.start,
        dews._environments.formats.dateTimeValueFormat,
        kendo.getCulture());

      }
      if (opt.range.end && $.type(opt.range.end) === "string") {
        opt.range.end = kendo.parseDate(
        opt.range.end,
        dews._environments.formats.dateTimeValueFormat,
        kendo.getCulture());

      }
    }
    if (opt.views) {
      for (var vIdx = 0; vIdx < opt.views.length; vIdx++) {
        var viewObj = opt.views[vIdx];
        if ($.type(viewObj) === "object") {
          if (viewObj.date && $.type(viewObj.date) === "string") {
            viewObj.date = kendo.parseDate(
            viewObj.date,
            dews._environments.formats.dateTimeValueFormat,
            kendo.getCulture());

          }
          if (viewObj.range) {
            if (viewObj.range.start && $.type(viewObj.range.start) === "string") {
              viewObj.range.start = kendo.parseDate(
              viewObj.range.start,
              dews._environments.formats.dateTimeValueFormat,
              kendo.getCulture());

            }
            if (viewObj.range.end && $.type(viewObj.range.end) === "string") {
              viewObj.range.end = kendo.parseDate(
              viewObj.range.end,
              dews._environments.formats.dateTimeValueFormat,
              kendo.getCulture());

            }
          }
        }
      }
    }
    //#endregion

    return opt;
  }

  /**
   * Gantt 컴포넌트의 생성자를 생성합니다.
   *
   * @class Gantt
   *
   * @param {jQuery} $el jquery 요소
   * @param {object} options Gantt 옵션
   * @return {Gantt}
   * @constructor
   */
  function Gantt($el, options) {
    var self = this,
      opt,
      gt;

    self.dataProvider = {};
    self._formats = {};

    self.dataProvider.dataSource = options.dataSource;
    self.dataProvider.dependencies = options.dependencies;

    opt = getOptions($el, options);

    self.dataProvider._ganttDataSource = opt.dataSource;
    self.dataProvider._ganttDependencyDataSource = opt.dependencies;

    $el.kendoGantt(opt);

    gt = $el.data("kendoGantt");

    self.$element = $el;
    // self.options = $.extend(true, defaultOptions, options);
    self.options = opt;
    self._gantt = gt;
    self.resources = self._gantt.resources;
    self.assignments = self._gantt.assignments;

    // formats
    self._formats.dateTimeValueFormat = dews._environments.formats.dateTimeValueFormat;
    self._formats.dateValueFormat = dews._environments.formats.dateValueFormat;

    self._taskDataSourceBindEvent();
    self._dependenciesDataSourceBindEvent();
    self._bindEvent();

    var $title = self.$element.prev(".dews-ui-title");
    if ($title.length > 0) {
      $(".k-header.k-gantt-toolbar", self.$element).prepend($title);
    }

    if (self.dataProvider.dataSource && self.options.autoBind !== false) {
      self.dataProvider.dataSource.read();
      self.dataProvider.dependencies.read();
    } else if (!self.options.autoBind) {
      // autoBind가 false 일 때 노데이터 띄우기
      self.$element.addClass("no-data");
      self._gantt.list.content.append(
      '<div class="k-grid-norecords"><div class="k-grid-norecords-template">' +
      dews.localize.get("데이터가 없습니다.", "dews_데이터가 없습니다.") +
      "</div></div>");

    }

    return self;
  }

  Gantt.prototype._bindEvent = function () {
    var self = this;

    if (self.options.openDialog) {
      self._gantt.bind("openDialog", self.options);
    }

    self._gantt.bind("change", function (e) {
      e.gantt = self;
    });

    self._gantt.bind("dataBound", function (e) {
      var ganttView = e.sender.view();
      var years,
        getYears = [],
        index = 0;
      var getReturnFn = function getReturnFn(getYears) {
        self._holidays._getApiFlag = true;
        if (index < getYears.length) {
          getHoliday(getYears[index]).done(function (data) {
            self._holidays[getYears[index]] = data;
            index++;
            return getReturnFn(getYears);
          });
        } else {
          self._holidays._getApiFlag = false;
          self._gantt.refresh();
        }
      };

      if (!self._holidays) {
        self._holidays = {};
      }

      if (self.options.holidays && !self._holidays._getApiFlag) {
        years = ganttView._years(ganttView.start, ganttView.end);

        for (var idx = 0; idx < years.length; idx++) {
          var currentYear = years[idx].start.getFullYear();

          if (!self._holidays[currentYear]) {
            getYears.push(currentYear);
          }
        }

        if (getYears.length > 0) {
          getReturnFn(getYears);
        }
      }

      self.$element.find(".k-task").each(function (e) {
        var dataItem = self._gantt.dataSource.getByUid($(this).attr("data-uid"));
        var $task = $(this);
        // 완료된 일정
        if (!(dataItem.percentComplete < 1)) {
          $task.addClass("dews-task-finish");
          $task.removeClass("dews-task-noprogress");
        } else if (dataItem.percentComplete === 0) {
          $task.removeClass("dews-task-finish");
          $task.addClass("dews-task-noprogress");
        } else {
          $task.removeClass("dews-task-finish");
          $task.removeClass("dews-task-noprogress");
        }

        // task 컬러 설정
        var colorField = self.options.taskMapping.color || "color";
        var color = dataItem[colorField] || "";
        var wrapper = $task.closest(".k-task-wrap");
        var tr = $task.closest("tr");
        var themeUrl =
        $.type(dews.theme) === "undefined" ?
        $('head link[data-role="dews-theme"]').attr("href") :
        dews.theme.getCurrentThemeUrl();
        var theme = $.isFunction(window.getThemes) ? window.getThemes() : "";
        var arrTheme = ["blue", "cyan", "green", "indigo", "orange", "purple", "red", "gray"];
        var defaultTheme = "blue";

        if (theme && theme[0] && theme[0].colors) {
          arrTheme = [];
          $.each(theme[0].colors, function (idx, item) {
            if (themeUrl.match(item.name)) {
              defaultTheme = item.name;
            }
            arrTheme.push(item.name);
          });
        }

        if (color) {
          // 지정된 테마가 있을 때
          tr.removeClass(arrTheme.join(" ")).addClass(color);
          wrapper.removeClass(arrTheme.join(" ")).addClass(color);
        } else {
          // 디폴트테마
          tr.data("color", defaultTheme);
          tr.removeClass(arrTheme.join(" ")).addClass(defaultTheme);
          wrapper.removeClass(arrTheme.join(" ")).addClass(defaultTheme);
        }
      });

      self._gantt.timeline.wrapper.off("click", ".k-gantt-tables");

      self._gantt.element.find(".k-gantt-tasks tbody tr").on("click", function (e) {
        var idx = $(this).index();
        var $tr = $(self._gantt.element.find(".k-treelist tbody tr")[idx]);

        self.select($tr);
      });

      self.$element.find(".k-treelist .k-grid-content tbody tr").on("mouseover", function (e) {
        _mouseOverEvent($(this));
      });

      self.$element.find(".k-timeline .k-gantt-tasks tbody tr").on("mouseover", function (e) {
        _mouseOverEvent($(this));
      });

      self.$element.find(".k-treelist .k-grid-content tbody tr").on("mouseout", function (e) {
        removeHover();
      });

      self.$element.find(".k-timeline .k-gantt-tasks tbody tr").on("mouseout", function (e) {
        removeHover();
      });

      e.gantt = self;
    });

    self._gantt.bind("navigate", function (e) {
      e.gantt = self;
    });

    self._gantt.bind("edit", function (e) {
      e.gantt = self;
    });

    function removeHover() {
      var hover = self.$element.find(".k-treelist tr.dews-state-hover, .k-gantt-tasks tbody tr.dews-state-hover");

      hover.length > 0 ? hover.removeClass("dews-state-hover") : "";
    }

    function _mouseOverEvent($tr) {
      removeHover();

      var idx;
      if ($tr) {
        idx = $tr.index();
      }

      if (idx) {
        var $timeLineSelect = $(self._gantt.element.find(".k-timeline .k-gantt-tasks tbody tr")[idx]);
        var $treeListSelect = $(self._gantt.element.find(".k-treelist tbody tr")[idx]);

        $timeLineSelect.addClass("dews-state-hover");
        $treeListSelect.addClass("dews-state-hover");
      }
    }

    var listDrag = self._gantt.list._reorderDraggable;
    // editable: false 이면 드래그 이벤트 없음
    if (listDrag) {
      // 간트 리스트 드래그 시작
      listDrag._events.dragstart.push(function () {
        this.hint.siblings(".dews-drag-line").remove();

        var $before = $('<div class="dews-drag-line before"></div>');
        var $after = $('<div class="dews-drag-line after"></div>');
        this.hint.before($before);
        this.hint.after($after);
      });

      // 간트 리스트 드래그 시작
      listDrag._events.drag.push(function () {
        var $before = this.hint.siblings(".dews-drag-line.before");
        var $after = this.hint.siblings(".dews-drag-line.after");

        var hintTop = parseInt(this.hint.css("top"));
        var hintLeft = parseInt(this.hint.css("left"));
        var hintWidth = this.hint.innerWidth();
        var listLeft = self._gantt.list.element.offset().left;
        var timelineLeft = self._gantt.timeline.element.offset().left;

        var top = hintTop + this.hint.innerHeight() / 2;

        $before.css("top", top);
        $before.css("left", listLeft);
        $before.css("width", hintLeft - listLeft);

        $after.css("top", top);
        $after.css("left", hintLeft + hintWidth);
        $after.css("width", timelineLeft - (hintLeft + hintWidth));

        this.hint.css("width", "");
        this.hint.css("padding", "");
        this.hint.css("line-height", "");
      });

      // 간트 리스트 드래그 종료
      listDrag._events.dragend.push(function () {
        this.hint.siblings(".dews-drag-line").remove();
      });
    }
  };

  Gantt.prototype._taskDataSourceBindEvent = function () {
    var self = this;
    var dataProvider = self.dataProvider;
    var taskMapping = self.options.taskMapping;
    var ds = dataProvider.dataSource,
      ganttDs = dataProvider._ganttDataSource;

    ds._getByTaskId = function (taskId) {
      var idx,
        length,
        data = this._flatData(this._data, this.options.useRanges);
      for (idx = 0, length = data.length; idx < length; idx++) {
        if (data[idx][self.options.taskMapping.id] === taskId) {
          return data[idx];
        }
      }
    };

    // task DataSource change 이벤트
    ds.bind("change", function (e) {
      var items,
        idx = 0;
      var addItem, ganttItem, ganttDSField;
      // items GanttTask Define 형태의 값
      items = $.extend(e.items, {});

      if (items && items.toJSON) {
        items = items.toJSON();
      }

      if (!e.action) {
        for (idx; idx < items.length; idx++) {
          if ($.type(items[idx][taskMapping.start]) === "string") {
            items[idx][taskMapping.start] = kendo.parseDate(
            items[idx][taskMapping.start],
            self._formats.dateTimeValueFormat,
            kendo.getCulture());

          }

          if ($.type(items[idx][taskMapping.end]) === "string") {
            items[idx][taskMapping.end] = kendo.parseDate(
            items[idx][taskMapping.end],
            self._formats.dateTimeValueFormat,
            kendo.getCulture());

          }

          items[idx] = self._convertGanttData(items[idx]);
        }
        ganttDs.data(items);
      } else if (e.action === "add") {
        addItem = items[0];

        if (addItem._newItem) {
          addItem._newItem = false;
        } else {
          addItem = self._convertGanttData(addItem);
          $.extend(e.items[0], addItem);
          addItem._newItem = true;
          ganttDs.add(addItem);
        }
      } else if (e.action === "itemchange") {
        ganttItem = ganttDs.get(e.items[0].id);
        ganttDSField = reTaskMapping(e.field, taskMapping);

        ganttItem[ganttDSField] = e.items[0][e.field];
        self._gantt.refresh();
      } else if (e.action === "remove") {
        ganttItem = ganttDs.get(e.items[0].id);
        if (ganttItem) {
          ganttDs.remove(ganttItem);
        }
      }

      /* 바인딩된 데이터가 0건일 때 no-data 설정 */
      if (ganttDs && ganttDs.data().length === 0) {
        self.$element.addClass("no-data");
        self._gantt.list.content.append(
        '<div class="k-grid-norecords"><div class="k-grid-norecords-template">' +
        dews.localize.get("데이터가 없습니다.", "dews_데이터가 없습니다.") +
        "</div></div>");

      } else {
        self.$element.removeClass("no-data");
        self._gantt.list.content.find(".k-grid-norecords").remove();
      }
    });

    // task GanttDataSource change 이벤트
    ganttDs.bind("change", function (e) {
      var items;
      var addItem, dsItem;
      items = $.extend(e.items, {});

      if (items && items.toJSON) {
        items = items.toJSON();
      }

      if (!e.action) {
      } else if (e.action === "add") {
        addItem = items[0];

        if (addItem._newItem) {
          addItem._newItem = false;
        } else {
          addItem = self._convertData(addItem);
          addItem._newItem = true;
          ds.add(addItem);
        }
      } else if (e.action === "itemchange") {
        // dsItem = ds.get(e.items[0].id);
        dsItem = ds._getByTaskId(e.items[0].id);
        if (dsItem) {
          dsItem.dirty = true;
          dsItem.dirtyFields[taskMapping[e.field]] = true;
          dsItem[taskMapping[e.field]] = e.items[0][e.field];
        }
        e.items[0][taskMapping[e.field]] = e.items[0][e.field];
      } else if (e.action === "remove") {
        // dsItem = ds.get(e.items[0].id);
        dsItem = ds._getByTaskId(e.items[0].id);
        if (dsItem) {
          ds.remove(dsItem);
        }
      }
    });
  };

  Gantt.prototype._dependenciesDataSourceBindEvent = function () {
    var self = this;
    var dataProvider = self.dataProvider;
    var dependenciesMapping = self.options.dependenciesMapping;
    var dpDs = dataProvider.dependencies,
      ganttDpDs = dataProvider._ganttDependencyDataSource;

    // dependency DataSource change 이벤트
    dpDs.bind("change", function (e) {
      var items,
        idx = 0;
      var addItem, ganttItem, ganttDPDSField;

      // items GanttDependency Define 형태의 값
      items = $.extend(e.items, {});

      if (items && items.toJSON) {
        items = items.toJSON();
      }

      for (idx; idx < items.length; idx++) {
        items[idx] = self._convertGanttDependencyData(items[idx]);
      }

      if (!e.action) {
        ganttDpDs.data(items);
      } else if (e.action === "add") {
        addItem = items[0];

        if (addItem._newItem) {
          addItem._newItem = false;
        } else {
          addItem = self._convertGanttDependencyData(addItem);
          $.extend(e.items[0], addItem);
          addItem._newItem = true;
          ganttDpDs.add(addItem);
        }
      } else if (e.action === "itemchange") {
        ganttItem = ganttDpDs.get(e.items[0].id);
        ganttDPDSField = reDependencyMapping(e.field, dependenciesMapping);

        ganttItem[ganttDPDSField] = e.items[0][e.field];
        self._gantt.refreshDependencies();
      } else if (e.action === "remove") {
        ganttItem = ganttDpDs.get(e.items[0].id);
        if (ganttItem) {
          ganttDpDs.remove(ganttItem);
        }
      }
    });

    // dependency GanttDataSource chagne 이벤트
    ganttDpDs.bind("change", function (e) {
      var items;
      var addItem, dsItem;

      items = $.extend(e.items, {});

      if (items && items.toJSON) {
        items = items.toJSON();
      }

      if (!e.action) {
      } else if (e.action === "add") {
        addItem = items[0];

        if (addItem._newItem) {
          addItem._newItem = false;
        } else {
          addItem = self._convertDependencyData(addItem);
          addItem._newItem = true;
          dpDs.add(addItem);
        }
      } else if (e.action === "itemchange") {
        dsItem = dpDs.get(e.items[0].id);
        dsItem.dirty = true;
        dsItem.dirtyFields[dependenciesMapping[e.field]] = true;
        dsItem[dependenciesMapping[e.field]] = e.items[0][e.field];
        e.items[0][dependenciesMapping[e.field]] = e.items[0][e.field];
      } else if (e.action === "remove") {
        dsItem = dpDs.get(e.items[0].id);
        if (dsItem) {
          dpDs.remove(dsItem);
        }
      }
    });
  };

  // gantt 데이터소스 필드 형식 -> dews 데이터소스 필드 형식
  Gantt.prototype._convertData = function (ganttData) {
    var self = this,
      data = {};
    var taskMapping = self.options.taskMapping;

    if (ganttData && ganttData.toJSON) {
      ganttData = ganttData.toJSON();
    }

    if (ganttData.id) {
      data[taskMapping.id] = ganttData.id;
    }
    if (ganttData.orderId) {
      data[taskMapping.orderId] = ganttData.orderId;
    }
    if (ganttData.parentId) {
      data[taskMapping.parentId] = ganttData.parentId;
    }
    if (ganttData.start) {
      if ($.type(ganttData.start) === "date") {
        data[taskMapping.start] = kendo.toString(
        ganttData.start,
        dews._environments.formats.dateTimeValueFormat,
        kendo.getCulture());

      } else {
        data[taskMapping.start] = ganttData.start;
      }
    }
    if (ganttData.end) {
      if ($.type(ganttData.end) === "date") {
        data[taskMapping.end] = kendo.toString(
        ganttData.end,
        dews._environments.formats.dateTimeValueFormat,
        kendo.getCulture());

      } else {
        data[taskMapping.end] = ganttData.end;
      }
    }
    if (ganttData.title) {
      data[taskMapping.title] = ganttData.title;
    }
    if (ganttData.percentComplete) {
      data[taskMapping.percentComplete] = ganttData.percentComplete;
    }
    if ($.type(ganttData.summary) === "boolean") {
      data[taskMapping.summary] = ganttData.summary;
    }
    if ($.type(ganttData.expanded) === "boolean") {
      data[taskMapping.expanded] = ganttData.expanded;
    }

    return data;
  };

  // gantt 데이터소스 필드 형식 -> dews 데이터소스 필드 형식
  Gantt.prototype._convertDependencyData = function (ganttData) {
    var self = this,
      data = {};
    var dependenciesMapping = self.options.dependenciesMapping;
    if (ganttData && ganttData.toJSON) {
      ganttData = ganttData.toJSON();
    }

    data[dependenciesMapping.id] = ganttData.id;
    data[dependenciesMapping.predecessorId] = ganttData.predecessorId;
    data[dependenciesMapping.successorId] = ganttData.successorId;
    data[dependenciesMapping.type] = ganttData.type;

    return data;
  };

  // dews 데이터소스 필드 형식 - > gantt 데이터소스 필드 형식
  Gantt.prototype._convertGanttData = function (data) {
    var self = this,
      ganttData = {};
    var taskMapping = self.options.taskMapping;
    if (data && data.toJSON) {
      data = data.toJSON();
    }

    if (self.options.columns) {
      self.options.columns.forEach(function (col) {
        ganttData[col.field] = "";
      });
    }

    ganttData = $.extend(true, ganttData, data);

    ganttData.id = data[taskMapping.id];
    ganttData.orderId = data[taskMapping.orderId];
    ganttData.parentId = data[taskMapping.parentId];
    if ($.type(data[taskMapping.start]) === "date") {
      ganttData.start = data[taskMapping.start];
      ganttData[taskMapping.start] = kendo.toString(
      data[taskMapping.start],
      dews._environments.formats.dateTimeValueFormat,
      kendo.getCulture());

    } else {
      ganttData.start = kendo.parseDate(
      data[taskMapping.start],
      dews._environments.formats.dateTimeValueFormat,
      kendo.getCulture());

    }
    if ($.type(data[taskMapping.end]) === "date") {
      ganttData.end = data[taskMapping.end];
      ganttData[taskMapping.end] = kendo.toString(
      data[taskMapping.end],
      dews._environments.formats.dateTimeValueFormat,
      kendo.getCulture());

    } else {
      ganttData.end = kendo.parseDate(
      data[taskMapping.end],
      dews._environments.formats.dateTimeValueFormat,
      kendo.getCulture());

    }
    ganttData.title = data[taskMapping.title];
    ganttData.percentComplete = data[taskMapping.percentComplete];
    ganttData.summary = data[taskMapping.summary];
    ganttData.expanded = data[taskMapping.expanded];
    ganttData.color = data[taskMapping.color];
    Object.keys(ganttData).forEach(function (key) {
      if (key !== "parentId") {
        if (ganttData[key] === null) {
          ganttData[key] = "";
        }
      }
    });
    return ganttData;
  };

  // dews 데이터소스 필드 형식 - > ganttDependency 데이터소스 필드 형식
  Gantt.prototype._convertGanttDependencyData = function (data) {
    var self = this,
      ganttData = {};
    var dependenciesMapping = self.options.dependenciesMapping;
    if (data && data.toJSON) {
      data = data.toJSON();
    }

    ganttData = $.extend(true, ganttData, data);

    ganttData.id = data[dependenciesMapping.id];
    ganttData.predecessorId = data[dependenciesMapping.predecessorId];
    ganttData.successorId = data[dependenciesMapping.successorId];
    ganttData.type = data[dependenciesMapping.type];

    return ganttData;
  };

  // kendo Gantt assignments 수정 내부함수
  kendo.ui.Gantt.fn._updateAssignments = function (id, resources) {
    var dataSource = this.assignments.dataSource;
    var taskId = this.assignments.dataTaskIdField;
    var resourceId = this.assignments.dataResourceIdField;
    var hasMatch = false;
    var assignments = new kendo.data.Query(dataSource.view()).
    filter({
      field: taskId,
      operator: "eq",
      value: id
    }).
    toArray();
    var assignment;
    var resource;
    var value;
    while (assignments.length) {
      assignment = assignments[0];
      for (var i = 0, length = resources.length; i < length; i++) {
        resource = resources[i];
        if (assignment.get(resourceId) === resource.get("id")) {
          value = resources[i].get("value");
          this._updateAssignment(assignment, value);
          resources.splice(i, 1);
          hasMatch = true;
          break;
        }
      }
      if (!hasMatch) {
        this._removeAssignment(assignment);
      }
      hasMatch = false;
      assignments.shift();
    }
    for (var j = 0, newLength = resources.length; j < newLength; j++) {
      resource = resources[j];
      this._createAssignment(resource, id);
    }
    // dataSource.sync();
    this.refresh();
  };

  // kendo Gantt task edit 함수
  kendo.ui.Gantt.fn.editTask = function (uid) {
    var task = typeof uid === "string" ? this.dataSource.getByUid(uid) : uid;
    if (!task) {
      return;
    }
    var taskCopy = this.dataSource._createNewModel(task.toJSON());
    taskCopy.uid = task.uid;
    this.cancelTask();
    this._editTask(taskCopy);
  };

  // kendo Gantt task remove 함수
  kendo.ui.Gantt.fn.removeTask = function (uid) {
    var self = this;
    var task = typeof uid === "string" ? this.dataSource.getByUid(uid) : uid;
    if (!task) {
      return;
    }

    dews.confirm(dews.localize.get("작업을 삭제하시겠습니까?", "dews_작업을 삭제하시겠습니까?")).yes(function () {
      self._removeTask(task);
    });
  };

  // kendo Gantt dependency remove 함수
  kendo.ui.Gantt.fn.removeDependency = function (uid) {
    var self = this;
    var dependency = typeof uid === "string" ? this.dependencies.getByUid(uid) : uid;
    if (!dependency) {
      return;
    }

    dews.confirm(dews.localize.get("연결을 삭제하시겠습니까?", "dews_연결을 삭제하시겠습니까?")).yes(function () {
      self._removeDependency(dependency);
    });
  };

  // kendo Gantt task 생성 내부 함수
  kendo.ui.Gantt.fn._createTask = function (task, index) {
    var self = this,
      dewsGantt = self.element.data("dewsControl");
    if (task.id === "") {
      task.id = guid();
    }
    task.title = dews.localize.get("새 작업", "dews_새 작업");
    var eventTask = dewsGantt._convertData(task);
    if (
    !this.trigger("add", {
      gantt: dewsGantt,
      task: eventTask,
      dependency: null
    }))
    {
      var dataSource = this.dataSource;
      this._preventRefresh = true;
      // eventTask = dewsGantt._convertData(task);
      $.extend(task, eventTask);
      if (index === undefined) {
        dataSource.add(task);
      } else {
        dataSource.insert(index, task);
      }
      this._scrollToUid = task.uid;
      this._syncDataSource();
    }
  };

  // kendo Gantt dependency 생성 내부 함수
  kendo.ui.Gantt.fn._createDependency = function (dependency) {
    var self = this,
      dewsGantt = self.element.data("dewsControl");
    if (dependency.id === "") {
      dependency.id = guid();
    }
    var eventDependency = dewsGantt._convertDependencyData(dependency);
    if (
    !this.trigger("add", {
      task: null,
      dependency: eventDependency,
      gantt: dewsGantt
    }))
    {
      this._preventDependencyRefresh = true;
      // eventDependency = dewsGantt._convertDependencyData(dependency);
      $.extend(dependency, eventDependency);
      this.dependencies.add(dependency);
      this._preventDependencyRefresh = false;
      // this.dependencies.sync();
      this.refreshDependencies();
    }
  };

  // kendo Gantt task 업데이트 내부 함수
  kendo.ui.Gantt.fn._updateTask = function (task, updateInfo) {
    var resourcesField = this.resources.field;
    // edit Event 호출 개발
    this._preventRefresh = true;
    if (task.start) {
      this.dataSource.update(task, updateInfo);
    }
    if (updateInfo[resourcesField]) {
      this._updateAssignments(task.get("id"), updateInfo[resourcesField]);
    }
    this._syncDataSource();
  };

  // kendo Gantt task 변경 다이얼로그 생성 내부 함수
  kendo.ui.Gantt.fn._editTask = function (task) {
    var self = this;
    var dewsGantt = self.element.data("dewsControl");
    var editDlg,
      initData = { gantt: dewsGantt, task: task };
    var data = dewsGantt.dataProvider.dataSource.get(task.id);
    var eventParameter = { task: data, gantt: dewsGantt };
    var messages = dewsGantt.options.messages;
    var editEvent = self.trigger("edit", { task: data, gantt: dewsGantt });
    var openDialog = self.trigger("openDialog", eventParameter);
    if (!editEvent) {
      if (!openDialog) {
        // region dialogHtml
        var innerHtml =
        '<div class="dews-dialog-contents-area">\n' +
        '  <div class="dews-gantt-dialog-panel">\n' +
        "    <form>\n" +
        "      <ul>\n" +
        '        <li class="dews-gantt-dialog-title">\n' +
        "          <label>" +
        messages.editor.title +
        "</label>\n" +
        "          <span>\n" +
        '            <input type="text" class="dews-ui-textbox" style="width: 350px">\n' +
        "          </span>\n" +
        "        </li>\n" +
        '        <li class="dews-gantt-dialog-start">\n' +
        "          <label>" +
        messages.editor.start +
        "</label>\n" +
        "          <span>\n" +
        '            <input type="text" class="dews-ui-datetimepicker required" style="width: 350px">\n' +
        "          </span>\n" +
        "        </li>\n" +
        '        <li class="dews-gantt-dialog-end">\n' +
        "          <label>" +
        messages.editor.end +
        "</label>\n" +
        "          <span>\n" +
        '            <input type="text" class="dews-ui-datetimepicker required" style="width: 350px">\n' +
        "          </span>\n" +
        "        </li>\n" +
        '        <li class="dews-gantt-dialog-percentComplete">\n' +
        "          <label>" +
        messages.editor.percentComplete +
        "</label>\n" +
        "          <span>\n" +
        '            <input type="text" class="dews-ui-numerictextbox" data-dews-spinners="true" data-dews-step="1"\n' +
        '                   data-dews-format="# \\%" data-dews-decimals="0" data-dews-max="100" data-dews-min="0">\n' /* data-dews-format="# \%" 은 포커스아웃일 때 숫자 뒤에 % 붙여주기위함(100 곱하지않고) */ +
        "          </span>\n" +
        "        </li>\n" +
        '        <li class="dews-gantt-dialog-resources" style="display: none">\n' +
        "          <label>" +
        messages.editor.resources +
        "</label>\n" +
        "          <span>\n" +
        '            <button class="dews-ui-button">' +
        messages.editor.assignButton +
        "</button>\n" +
        "          </span>\n" +
        "        </li>\n" +
        '        <li class="dews-gantt-dialog-color">\n' +
        "          <label>" +
        dews.localize.get("색", "dews_색") +
        "</label>\n" +
        "          <span>\n" +
        '           <input type="text" class="dews-ui-textbox" style="display: none;">' +
        '           <input type="checkbox" id="defaultTheme" class="dews-ui-checkbox">\n' +
        '           <label for="chk1">ERP 10 테마 색상</label>' +
        '           <ul class="theme-color" id="listThemeColor">' +
        '               <li class="blue" data-color-name="blue"></li>' +
        '               <li class="cyan" data-color-name="cyan"></li>' +
        '               <li class="green" data-color-name="green"></li>' +
        '               <li class="indigo" data-color-name="indigo"></li>' +
        '               <li class="orange" data-color-name="orange"></li>' +
        '               <li class="purple" data-color-name="purple"></li>' +
        '               <li class="red" data-color-name="red"></li>' +
        '               <li class="gray" data-color-name="gray"></li>' +
        "           </ul>" +
        "          </span>\n" +
        "        </li>\n" +
        "      </ul>\n" +
        "    </form>\n" +
        "  </div>\n" +
        "</div>\n" +
        '<div class="dews-dialog-button-group bottom">\n' +
        '  <button class="dews-ui-button confirm dews-gantt-dialog-saveBtn">' +
        dews.localize.get("저장", "dews_저장") +
        "</button>\n" +
        '  <button class="dews-ui-button confirm dews-gantt-dialog-cancelBtn">' +
        dews.localize.get("취소", "dews_취소") +
        "</button>\n" +
        '  <button class="dews-ui-button confirm dews-gantt-dialog-deleteBtn">' +
        dews.localize.get("삭제", "dews_삭제") +
        "</button>\n" +
        "</div>";
        // endregion
        editDlg = dews.ui.dialog("dewsGanttEditDlg", {
          content: innerHtml,
          initData: initData,
          title: messages.editor.editorTitle,
          width: 560,
          height: 278,
          open: function open(e) {
            dews.ready(function () {
              var self = this,
                dewsControl = {};
              var initData = self.initData;
              var gantt = initData.gantt,
                task = initData.task,
                dialogHeight;
              var tasks = gantt.$element.find(".k-gantt-tasks");

              var panel = self.$content.find(".dews-gantt-dialog-panel");
              var title = panel.find(".dews-gantt-dialog-title .dews-ui-textbox");
              var start = panel.find(".dews-gantt-dialog-start .dews-ui-datetimepicker");
              var end = panel.find(".dews-gantt-dialog-end .dews-ui-datetimepicker");
              var percentComplete = panel.find(
              ".dews-gantt-dialog-percentComplete .dews-ui-numerictextbox");

              var resources = panel.find(".dews-gantt-dialog-resources .dews-ui-button");
              var themeColor = panel.find(".dews-gantt-dialog-color #listThemeColor");
              var colorText = panel.find(".dews-gantt-dialog-color .dews-ui-textbox");
              var defaultTheme = panel.find(".dews-gantt-dialog-color .dews-ui-checkbox");

              var buttonGroup = self.$content.find(".dews-dialog-button-group");
              var saveBtn = buttonGroup.find(".dews-gantt-dialog-saveBtn");
              var cancelBtn = buttonGroup.find(".dews-gantt-dialog-cancelBtn");
              var deleteBtn = buttonGroup.find(".dews-gantt-dialog-deleteBtn");

              dewsControl.title = title.data("dewsControl");
              dewsControl.start = start.data("dewsControl");
              dewsControl.end = end.data("dewsControl");
              dewsControl.percentComplete = percentComplete.data("dewsControl");
              dewsControl.resources = resources.data("dewsControl");
              dewsControl.colorText = colorText.data("dewsControl");
              dewsControl.defaultTheme = defaultTheme.data("dewsControl");

              dewsControl.saveBtn = saveBtn.data("dewsControl");
              dewsControl.cancelBtn = cancelBtn.data("dewsControl");
              dewsControl.deleteBtn = deleteBtn.data("dewsControl");

              if (gantt.options.resources) {
                panel.find(".dews-gantt-dialog-resources").css("display", "block");
                dialogHeight = panel.height() + 84;

                self.resize(self.options.width, dialogHeight);
              }

              dewsControl.title.text(task.title);
              dewsControl.start.value(task.start);
              dewsControl.end.value(task.end);
              dewsControl.percentComplete.value(
              task.percentComplete == 1 ? 100 : task.percentComplete * 100);
              // 0~100 까지 표현하기 위해(0.0 ~ 1이 아닌)
              task.color ?
              themeColor.find("." + task.color).addClass("select") :
              dewsControl.defaultTheme.check(true);

              // dewsControl.percentComplete.value(kendo.toString(task.percentComplete, "%"));// 0이 반환안됨

              dewsControl.defaultTheme.on("change", function () {
                themeColor.find("li").removeClass("select");
              });

              // 컬러 선택 이벤트
              themeColor.on("click", "li", function (e) {
                dewsControl.defaultTheme.check(false);
                themeColor.find("li").removeClass("select");
                $(this).addClass("select");
              });

              // resources button click
              resources.on("click", function (e) {
                var resourcesDlg, data;
                data = {
                  task: task,
                  gantt: gantt,
                  data: gantt._gantt._wrapResourceData(task.get("id")),
                  resourceField: gantt._gantt.resources.field
                };

                // region dlgHtml
                var dlgHtml =
                '<div class="dews-dialog-contents-area">\n' +
                '  <div class="dews-ui-container-panel">\n' +
                '    <div class="dews-ui-container-item">\n' +
                '      <div class="dews-gantt-resources-grid">\n' +
                '        <div id="grid" class="dews-ui-grid"></div>\n' +
                "      </div>\n" +
                "    </div>\n" +
                "  </div>\n" +
                "</div>\n" +
                '<div class="dews-dialog-button-group bottom">\n' +
                '  <button class="dews-ui-button confirm dews-gantt-dialog-saveBtn">' +
                dews.localize.get("저장", "dews_저장") +
                "</button>\n" +
                '  <button class="dews-ui-button confirm dews-gantt-dialog-cancelBtn">' +
                dews.localize.get("취소", "dews_취소") +
                "</button>\n" +
                "</div>";
                //endregion

                resourcesDlg = dews.ui.dialog("dewsGanttResourceDlg", {
                  content: dlgHtml,
                  initData: data,
                  title: messages.editor.resourcesEditorTitle,
                  width: "500",
                  height: "400",
                  open: function open() {
                    dews.ready(function () {
                      var self = this;
                      var initData = self.initData;
                      var gantt = initData.gantt,
                        task = initData.task,
                        grid,
                        gridDataSource,
                        gridDiv;

                      var buttonGroup = self.$content.find(".dews-dialog-button-group");
                      var saveBtn = buttonGroup.find(".dews-gantt-dialog-saveBtn");
                      var cancelBtn = buttonGroup.find(".dews-gantt-dialog-cancelBtn");

                      gridDataSource = dews.ui.dataSource("gridDatasource", {
                        grid: true,
                        data: initData.data,
                        schema: {
                          model: {
                            id: "id",
                            fields: [
                            {
                              field: "id"
                            },
                            {
                              field: "name"
                            },
                            {
                              field: "value"
                            }]

                          }
                        }
                      });

                      var dataSource = dews.ui.dataSource("dataSource", {
                        schema: {
                          model: {
                            id: "id",
                            fields: [
                            {
                              field: "id"
                            },
                            {
                              field: "name"
                            },
                            {
                              field: "value"
                            }]

                          }
                        }
                      });

                      grid = dews.ui.grid(self.$grid, {
                        dataSource: gridDataSource,
                        editable: true,
                        rowNo: false,
                        height: 310,
                        checkBar: {
                          showAll: false
                        },
                        columns: [
                        {
                          title: messages.editor.resourcesHeader,
                          field: "name",
                          width: 100,
                          editable: false
                        },
                        {
                          title: messages.editor.unitsHeader,
                          field: "value",
                          width: 100,
                          editor: {
                            type: "number",
                            format: "0.##"
                          },
                          formats: {
                            type: "function",
                            format: function format(value) {
                              if (value) {
                                return (value * 100).toString() + "%";
                              }
                            }
                          }
                        }],

                        selected: function selected(e) {
                          if (e.cell.isClicked) {
                            if (!e.row.data.value) {
                              this.setCellValue(e.row.index, "value", 1);
                            }
                          } else {
                            if (e.row.data.value) {
                              this.setCellValue(e.row.index, "value", null);
                            }
                          }
                        },
                        dataBound: function dataBound(e) {
                          var index = 0,
                            checkArr = [];
                          for (index; index < e.row.data.length; index++) {
                            if (e.row.data[index].value) {
                              checkArr.push(index);
                            }
                          }
                          this.setCheck(checkArr, true);
                        },
                        save: function save(e) {
                          if (e.cell.field === "value") {
                            if (e.row.data.value) {
                              this.setCheck(e.row.index, true);
                            } else {
                              this.setCheck(e.row.index, false);
                            }
                          }
                        }
                      });

                      saveBtn.on("click", function () {
                        dataSource.data(gridDataSource.data());
                        var data = dataSource.data();
                        var resources = [],
                          value;
                        for (var i = 0; i < data.length; i++) {
                          value = data[i].get("value");
                          if (value !== null && value > 0) {
                            resources.push(data[i]);
                          }
                        }

                        task[initData.resourceField] = resources;
                        gantt._gantt._updateAssignments(
                        task.get("id"),
                        task.get(initData.resourceField));

                        self.ok();
                      });

                      cancelBtn.on("click", function () {
                        self.cancel();
                      });
                    });
                  }
                });

                resourcesDlg.open();
              });

              // save button click
              saveBtn.on("click", function () {
                var outData = {},
                  startDate,
                  endDate,
                  check = true;

                startDate = kendo.toString(
                task.start,
                dews._environments.formats.dateTimeValueFormat,
                kendo.getCulture());

                endDate = kendo.toString(
                task.end,
                dews._environments.formats.dateTimeValueFormat,
                kendo.getCulture());


                if (task.title !== dewsControl.title.text()) {
                  outData.title = dewsControl.title.text();
                }
                if (startDate !== dewsControl.start.value()) {
                  outData.start = dewsControl.start.text();
                }
                if (endDate !== dewsControl.end.value()) {
                  outData.end = dewsControl.end.text();
                }
                if (task.percentComplete !== dewsControl.percentComplete.value() / 100) {
                  // 저장할 때는 0.0~1로 저장해야해서 변환
                  outData.percentComplete = dewsControl.percentComplete.value() / 100;
                }

                var color = task.color;
                var selectColor = themeColor.find(".select").data("color-name") || "";
                if (color !== selectColor) {
                  outData.color = selectColor;
                }

                if (!dewsControl.start.validate()) {
                  dews.ui.tooltip.show(dewsControl.start.element, {
                    type: "required"
                  });
                  check = false;
                }
                if (!dewsControl.end.validate()) {
                  dews.ui.tooltip.show(dewsControl.end.element, {
                    type: "required"
                  });
                  check = false;
                }

                if (check) {
                  self.ok(outData);
                }
              });

              cancelBtn.on("click", function () {
                self.cancel();
              });

              deleteBtn.on("click", function () {
                gantt._gantt.removeTask(task);
                self.cancel();
              });
            });
          },
          ok: function ok(updateInfo) {
            task = self.dataSource.get(task.id);
            var dewsTask = dewsGantt.dataProvider.dataSource.get(task.id);
            var dewsUpdateInfo = dewsGantt._convertData(updateInfo);
            if (
            !self.trigger("save", {
              task: dewsTask,
              values: dewsUpdateInfo,
              gantt: dewsGantt
            }))
            {
              self._updateTask(task, updateInfo);
            }
          }
        });

        editDlg.open();
      }
    }
  };

  kendo.ui.Gantt.fn._removeTaskAssignments = function (task) {
    var dataSource = this.assignments.dataSource;
    var assignments = dataSource.view();
    var filter = {
      field: this.assignments.dataTaskIdField,
      operator: "eq",
      value: task.get("id")
    };
    assignments = new kendo.data.Query(assignments).filter(filter).toArray();
    this._preventRefresh = true;
    for (var i = 0, length = assignments.length; i < length; i++) {
      dataSource.remove(assignments[i]);
    }
    this._preventRefresh = false;
    // dataSource.sync();
    this.refresh();
  };

  kendo.ui.Gantt.fn._removeTask = function (task) {
    var self = this,
      dewsGantt = self.element.data("dewsControl");
    var eventTask = dewsGantt.dataProvider.dataSource.get(task.id);
    var dependencies = this.dependencies.dependencies(task.id);
    if (
    !this.trigger("remove", {
      gantt: dewsGantt,
      task: eventTask,
      dependencies: dependencies
    }))
    {
      this._removeTaskDependencies(task, dependencies);
      this._removeTaskAssignments(task);
      this._preventRefresh = true;
      if (this.dataSource.remove(task)) {
        this._syncDataSource();
      }
      this._preventRefresh = false;
    }
  };

  kendo.ui.Gantt.fn._removeDependency = function (dependency) {
    var self = this,
      dewsGantt = self.element.data("dewsControl");
    var eventDependency = dewsGantt.dataProvider.dependencies.get(dependency.id);
    if (
    !this.trigger("remove", {
      task: null,
      dependencies: [eventDependency]
    }))
    {
      if (this.dependencies.remove(dependency)) {
        this.refreshDependencies();
      }
    }
  };

  kendo.ui.Gantt.fn._syncDataSource = function () {
    this._preventRefresh = false;
    this._requestStart();
    this.refresh();
  };

  // kendo GanttView footer 삭제
  kendo.ui.Gantt.fn._footer = function () {
    this.footer = $([]);
  };

  function _isHoliday(date, holidaysData) {
    var currentYear = date.getFullYear(),
      currentMonth = date.getMonth() + 1,
      currentDate = date.getDate().toString(),
      data;

    if (holidaysData) {
      data = holidaysData[currentYear];
    }

    currentMonth = currentMonth >= 10 ? currentMonth.toString() : "0" + currentMonth;
    currentDate = currentDate >= 10 ? currentDate.toString() : "0" + currentDate;

    if (data) {
      for (var idx = 0; idx < data.length; idx++) {
        if (data[idx].date.substr(0, 2) === currentMonth && data[idx].date.substr(2, 2) === currentDate) {
          return data[idx];
        }
      }
    }
    return false;
  }

  function _isWeekend(date) {
    var day = date.getDay();
    if (day === 0) {
      return "dews-gantt-sun";
    } else if (day === 6) {
      return "dews-gantt-sat";
    }
  }

  // kendo GanttView day slot 생성
  kendo.ui.GanttView.fn._days = function (start, end) {
    var self = this;
    var slotEnd;
    var slots = [];
    var isWorkDay, isHoliday;
    var dewself = self.content.closest(".dews-ui-gantt").data("dewsControl");
    var holidaysData, holidayData;

    if (dewself) {
      holidaysData = dewself._holidays;
    }
    start = new Date(start);
    end = new Date(end);
    while (start < end) {
      slotEnd = end < kendo.date.nextDay(start) ? end : kendo.date.nextDay(start);
      isWorkDay = this._isWorkDay(start);
      if (self.options.holidays) {
        holidayData = _isHoliday(start, holidaysData);
        if (holidayData) {
          isHoliday = "dews-gantt-holiday";
        } else {
          isHoliday = _isWeekend(start);
        }

        if (isHoliday) {
          isWorkDay = false;
        }
      }
      if (!this.options.showWorkDays || isWorkDay) {
        slots.push({
          start: start,
          end: slotEnd,
          isNonWorking: !isWorkDay,
          span: 1,
          isHoliday: isHoliday
        });
      }
      start = slotEnd;
    }
    return slots;
  };

  kendo.ui.GanttView.fn._slotHeaders = function (slots, template) {
    var columns = [];
    var slot;
    for (var i = 0, l = slots.length; i < l; i++) {
      slot = slots[i];
      columns.push({
        text: template(slot),
        isNonWorking: !!slot.isNonWorking,
        span: slot.span,
        isHoliday: slot.isHoliday
      });
    }
    return columns;
  };

  // kendo GanttView header 생성
  kendo.ui.GanttView.fn._headers = function (columnLevels) {
    var rows = [];
    var level;
    var headers;
    var column;
    var headerText;
    var styles = kendo.ui.GanttView.styles;
    for (var levelIndex = 0, levelCount = columnLevels.length; levelIndex < levelCount; levelIndex++) {
      level = columnLevels[levelIndex];
      headers = [];
      for (var columnIndex = 0, columnCount = level.length; columnIndex < columnCount; columnIndex++) {
        column = level[columnIndex];
        headerText = kendo.dom.html(column.text);
        headers.push(
        kendo.dom.element(
        "th",
        {
          colspan: column.span,
          className:
          styles.header + (
          column.isNonWorking ? " " + styles.nonWorking : "") + (
          column.isHoliday ? " " + column.isHoliday : "")
        },
        [headerText]));


      }
      rows.push(kendo.dom.element("tr", null, headers));
    }
    return rows;
  };

  $.extend(true, kendo.ui.GanttDayView.fn, {
    options: {
      timeHeaderTemplate: kendo.template("#=kendo.toString(start, 'HH:mm')#"),
      dayHeaderTemplate: kendo.template("#=kendo.toString(start, 'MM-dd(ddd)')#")
    }
  });

  kendo.ui.GanttDayView.fn._layout = function () {
    var rows = [];
    var options = this.options;
    rows.push(this._slotHeaders(this._slots[0], convertTemplate("day", options.dayHeaderTemplate)));
    rows.push(this._slotHeaders(this._slots[1], convertTemplate("time", options.timeHeaderTemplate)));
    return rows;
  };

  $.extend(true, kendo.ui.GanttWeekView.fn, {
    options: {
      dayHeaderTemplate: kendo.template("#=kendo.toString(start, 'MM-dd(ddd)')#"),
      weekHeaderTemplate: kendo.template(
      "#=kendo.toString(start, 'MM-dd dddd')# - #=kendo.toString(kendo.date.addDays(end, -1), 'MM-dd dddd')#")

    }
  });

  kendo.ui.GanttWeekView.fn._layout = function () {
    var rows = [];
    var options = this.options;

    rows.push(this._slotHeaders(this._slots[0], convertTemplate("week", options.weekHeaderTemplate)));
    rows.push(this._slotHeaders(this._slots[1], convertTemplate("day", options.dayHeaderTemplate)));
    return rows;
  };

  $.extend(true, kendo.ui.GanttMonthView.fn, {
    options: {
      weekHeaderTemplate: kendo.template(
      "#=kendo.toString(start, 'MM-dd dddd')# - #=kendo.toString(kendo.date.addDays(end, -1), 'MM-dd dddd')#"),

      monthHeaderTemplate: kendo.template("#=kendo.toString(start, 'Y')#")
    }
  });

  kendo.ui.GanttMonthView.fn._layout = function () {
    var rows = [];
    var options = this.options;
    rows.push(this._slotHeaders(this._slots[0], convertTemplate("month", options.monthHeaderTemplate)));
    rows.push(this._slotHeaders(this._slots[1], convertTemplate("week", options.weekHeaderTemplate)));
    return rows;
  };

  $.extend(true, kendo.ui.GanttYearView.fn, {
    options: {
      monthHeaderTemplate: kendo.template("#=kendo.toString(start, 'Y')#"),
      yearHeaderTemplate: kendo.template("#=kendo.toString(start, 'yyyy')#")
    }
  });

  kendo.ui.GanttYearView.fn._layout = function () {
    var rows = [];
    var options = this.options;
    rows.push(this._slotHeaders(this._slots[0], convertTemplate("year", options.yearHeaderTemplate)));
    rows.push(this._slotHeaders(this._slots[1], convertTemplate("month", options.monthHeaderTemplate)));
    return rows;
  };

  function convertTemplate(type, template) {
    if (typeof template === "function") {
      return template;
    } else if (typeof template === "string") {
      if (template.startsWith("#=kendo.toString")) {
        // kendo style 로 지정
        return kendo.template(template);
      } else {
        if (type === "week") {
          return kendo.template(
          "#=kendo.toString(start, '" +
          template +
          "')# - #=kendo.toString(kendo.date.addDays(end, -1), '" +
          template +
          "')#");

        } else {
          return kendo.template("#=kendo.toString(start, '" + template + "')#");
        }
      }
    }
  }

  // // kendo GanttView content columnsTable 생성
  // kendo.ui.GanttView.fn._columnsTable = function () {
  //     var cells = [];
  //     var row;
  //     var styles = kendo.ui.GanttView.styles;
  //     var slots = this._timeSlots();
  //     var slotsCount = slots.length;
  //     var slot;
  //     var slotSpan;
  //     var totalSpan = 0;
  //     var attributes;
  //     for (var i = 0; i < slotsCount; i++) {
  //         slot = slots[i];
  //         attributes = {};
  //         slotSpan = slot.span;
  //         totalSpan += slotSpan;
  //         if (slotSpan !== 1) {
  //             attributes.colspan = slotSpan;
  //         }
  //         if (slot.isNonWorking) {
  //             attributes.className = styles.nonWorking;
  //         }
  //         if (slot.isHoliday) {
  //             attributes.className += ' ' + slot.isHoliday + '';
  //         }
  //         cells.push(kendo.dom.element('td', attributes, [kendo.dom.text('\xA0')]));
  //     }
  //     row = kendo.dom.element('tr', null, cells);
  //     return this._createTable(totalSpan, [row], { className: styles.columnsTable });
  // };

  // tooltip 생성
  kendo.ui.GanttView.fn._createTaskTooltip = function (task, element, mouseLeft) {
    var templateString =
    '<div class="#=kendo.htmlEncode(styles.taskDetails)#">' +
    "<strong>#=kendo.htmlEncode(task.title)#</strong>" +
    '<div class="#=styles.taskDetailsPercent#">#=kendo.toString(task.percentComplete, "p0")#</div>' +
    '<ul class="#=styles.reset#">' +
    "<li>" +
    dews.localize.get("기간", "dews_기간") +
    ' : #=kendo.toString(task.start, "tt h:mm, MM-dd")# ~ #=kendo.toString(task.end, "tt h:mm, MM-dd")#</li>';
    // '<li>' + dews.localize.get('기간', 'dews_기간') + ' : #=kendo.toString(task.start, "tt h:mm, MM")#' + dews.localize.get('월', 'dews_월') + ' #=kendo.toString(task.start, "MM dd")#' + dews.localize.get('일', 'dews_일') + '~ #=kendo.toString(task.end, "tt h:mm, MM월 d일")#</li>' + // 다국어에 있는 d 나 m 등이 켄도 날짜 toString 에 영향을 끼쳐서 변환이 돼버림
    // '<li>#=messages.end#: #=kendo.toString(task.end, "h:mm tt ddd, MMM d")#</li>' +

    if (task.resources && task.resources.length > 0) {
      var assignments = "";

      task.resources.map(function (assign, idx) {
        assignments += assign.name;

        if (task.resources.length !== idx + 1) {
          assignments += ", ";
        }
      });

      templateString += "<li>" + dews.localize.get("담당자", "dews_담당자") + " : " + assignments + "</li>";
    }

    templateString += "</ul>" + "</div>";

    var TASK_TOOLTIP_TEMPLATE = kendo.template(templateString);
    var isRtl = false;
    var styles = kendo.ui.GanttView.styles;
    var options = this.options;
    var content = this.content;
    var contentOffset = content.offset();
    var contentWidth = content.width();
    var contentScrollLeft = kendo.scrollLeft(content);
    var row = $(element).parents("tr").first();
    var rowOffset = row.offset();
    var template =
    options.tooltip && options.tooltip.template ?
    kendo.template(options.tooltip.template) :
    TASK_TOOLTIP_TEMPLATE;
    var left = isRtl ?
    mouseLeft - (contentOffset.left + contentScrollLeft + kendo.support.scrollbar()) :
    mouseLeft - (contentOffset.left - contentScrollLeft);
    var top = rowOffset.top + kendo._outerHeight(row) - contentOffset.top + content.scrollTop();
    var tooltip = this._taskTooltip = $(
    '<div style="z-index: 100002;" class="' +
    styles.tooltipWrapper +
    '" >' +
    '<div class="' +
    styles.taskContent +
    '"></div></div>');

    var tooltipWidth;
    tooltip.
    css({
      left: left,
      top: top
    }).
    appendTo(content).
    find("." + styles.taskContent).
    append(
    template({
      styles: styles,
      task: task,
      messages: options.messages.views
    }));

    if (kendo._outerHeight(tooltip) < rowOffset.top - contentOffset.top) {
      tooltip.css("top", rowOffset.top - contentOffset.top - kendo._outerHeight(tooltip) + content.scrollTop());
    }
    tooltipWidth = kendo._outerWidth(tooltip);
    if (tooltipWidth + left - contentScrollLeft > contentWidth) {
      left -= tooltipWidth;
      if (left < contentScrollLeft) {
        left = contentScrollLeft + contentWidth - (tooltipWidth + 17);
      }
      tooltip.css("left", left);
    }
  };

  kendo.ui.GanttView.fn._renderCurrentTime = function () {
    var currentTime = this._getCurrentTime();
    var timeOffset = this._offset(currentTime);
    var element = $("<div class='k-current-time'></div>");
    var viewStyles = kendo.ui.GanttView.styles;
    var tablesWrap = $("." + viewStyles.tasksWrapper);
    var tasksTable = $("." + viewStyles.tasksTable);
    var slot;
    if (!this.content || !this._timeSlots().length) {
      return;
    }
    this.content.find(".k-current-time").remove();
    slot = this._timeSlots()[this._slotIndex("start", currentTime)];
    if (currentTime < slot.start || currentTime > slot.end) {
      return;
    }
    if (tablesWrap.length && tasksTable.length) {
      timeOffset += tasksTable.offset().left - tablesWrap.offset().left;
    }

    var height = this._contentHeight;

    if (this.content.height() > this.content.find(".k-gantt-columns").height()) {
      height = this.content.height() - 7;
    } else if (this.content.find(".k-gantt-columns").height() > element.height()) {
      height = this.content.find(".k-gantt-columns").height() - 7;
    }

    element.
    css({
      left: timeOffset + "px",
      top: "0px",
      width: "1px",
      height: height + "px"
    }).
    appendTo(this.content);
  };

  kendo.ui.GanttTimeline.fn.select = function (value) {
    var element = this.wrapper.find(value);
    if (element.length) {
      this.clearSelection();
      element.closest("tr").addClass("k-state-selected");
      element.addClass("k-state-selected");
      if (kendo.support.mobileOS) {
        element.parent().addClass(styles.taskWrapActive);
      }
      return;
    }
    return this.wrapper.find(".k-task.k-state-selected");
  };

  /**
   * 간트에 task 를 추가 합니다.
   *
   * @param {object} task
   */
  Gantt.prototype.addTask = function (task) {
    var self = this;
    var prevented = self._gantt.trigger("add", {
      gantt: self,
      task: task,
      dependency: null
    });

    if (!prevented) {
      self.dataProvider.dataSource.add(task);
    }
  };

  /**
   * 간트에 task 를 삭제 합니다.
   *
   * @param {uid | taskModel} task
   */
  Gantt.prototype.removeTask = function (uid) {
    var self = this;
    var task = typeof uid === "string" ? self.dataProvider.dataSource.getByUid(uid) : uid;
    var ganttTask = self.dataProvider._ganttDataSource.get(task.id);

    if (!ganttTask) {
      return;
    }
    self._gantt._removeTask(ganttTask);
  };

  /**
   * 간트에 dependency 를 추가 합니다.
   *
   * @param dependency
   */
  Gantt.prototype.addDependency = function (dependency) {
    var self = this;
    var prevented = self._gantt.trigger("add", {
      gantt: self,
      dependency: dependency,
      task: null
    });

    if (!prevented) {
      self.dataProvider.dependencies.add(dependency);
    }
  };

  /**
   * 간트에 dependency 를 삭제 합니다.
   *
   * @param {uid | dependencyModel} dependency
   */
  Gantt.prototype.removeDependency = function (uid) {
    var self = this;
    var dependency = typeof uid === "string" ? self.dataProvider.dependencies.getByUid(uid) : uid;
    var ganttDependency = self.dataProvider._ganttDependencyDataSource.get(dependency.id);

    if (!ganttDependency) {
      return;
    }
    self._gantt._removeDependency(ganttDependency);
  };

  /**
   * 선택 된 테이블 행을 가져오거나 설정합니다.
   *
   * @param {string | Element | jQuery} row 선택 할 문자열 또는 DOM 요소 또는 jQuery
   * @return {jQuery}
   */
  Gantt.prototype.select = function (row) {
    var self = this;

    if (row) {
      self._gantt.select(row);
    } else {
      return self._gantt.select();
    }
  };

  /**
   * row 의 data 정보를 가져옵니다.
   *
   * @param {string | jQuery | Element} row
   * @return {taskModel}
   */
  Gantt.prototype.dataItem = function (row) {
    var self = this,
      ganttData,
      data;

    ganttData = self._gantt.dataItem(row);
    data = self.dataProvider.dataSource.get(ganttData.id);
    return data;
  };

  /**
   * 간트에 현재 설정 된 날짜를 보여주거나 설정합니다.
   *
   * @param {date | string} value
   * @return {string}
   */
  Gantt.prototype.date = function (value) {
    var self = this,
      date;

    if (value) {
      if (!($.type(value) === "date")) {
        value = kendo.parseDate(value, dews._environments.formats.dateTimeValueFormat, kendo.getCulture());
      }

      self._gantt.date(value);
    } else {
      date = self._gantt.date();
      date = kendo.toString(date, dews._environments.formats.dateTimeValueFormat, kendo.getCulture());

      return date;
    }
  };

  /**
   * 간트에 설정 된 범위를 보여주거나 설정합니다.
   *
   * @param {object} range
   * @return {object}
   */
  Gantt.prototype.range = function (range) {
    var self = this,
      viewRange;

    if (range) {
      if (!($.type(range.start) === "date")) {
        range.start = kendo.parseDate(
        range.start,
        dews._environments.formats.dateTimeValueFormat,
        kendo.getCulture());

      }
      if (!($.type(range.end) === "date")) {
        range.end = kendo.parseDate(
        range.end,
        dews._environments.formats.dateTimeValueFormat,
        kendo.getCulture());

      }
      self._gantt.range(range);
    } else {
      viewRange = self._gantt.range();
      viewRange.start = kendo.toString(
      viewRange.start,
      dews._environments.formats.dateTimeValueFormat,
      kendo.getCulture());

      viewRange.end = kendo.toString(
      viewRange.end,
      dews._environments.formats.dateTimeValueFormat,
      kendo.getCulture());


      return viewRange;
    }
  };

  /**
   * 간트의 선택을 해제 합니다.
   */
  Gantt.prototype.clearSelection = function () {
    var self = this;

    self._gantt.clearSelection();
  };

  /**
   * 간트 task dataSource 를 바인딩합니다.
   *
   * @param {dataSource} dataSource
   */
  Gantt.prototype.setDataSource = function (dataSource) {
    var self = this;
    var taskMapping = self.options.taskMapping;
    var ganttDataSource = _createTaskDataSource(dataSource, taskMapping);

    if (self.dataProvider._ganttDataSource) {
      self.dataProvider._ganttDataSource.data([]);
    }
    self.options.dataSource = dataSource;
    self.dataProvider.dataSource = dataSource;
    self.dataProvider._ganttDataSource = ganttDataSource;
    self._gantt.setDataSource(ganttDataSource);
    self._taskDataSourceBindEvent();

    if (self.options.autoBind) {
      self.dataProvider.dataSource.read();
    }
  };

  /**
   * 간트 dependency dataSource 를 바인딩합니다.
   *
   * @param {dataSource} dataSource
   */
  Gantt.prototype.setDependenciesDataSource = function (dataSource) {
    var self = this;
    var dependenciesMapping = self.options.dependenciesMapping;
    var ganttDependencyDataSource = _createDependencyDataSource(dataSource, dependenciesMapping);

    if (self.dataProvider._ganttDependencyDataSource) {
      self.dataProvider._ganttDependencyDataSource.data([]);
    }
    self.options.dependencies = dataSource;
    self.dataProvider.dependencies = dataSource;
    self.dataProvider._ganttDependencyDataSource = ganttDependencyDataSource;
    self._gantt.setDependenciesDataSource(ganttDependencyDataSource);
    self._dependenciesDataSourceBindEvent();

    if (self.options.autoBind) {
      self.dataProvider.dependencies.read();
    }
  };

  Gantt.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change", "dataBound", "openDialog", "add", "edit", "remove"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        self._gantt.trigger(event);
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  /**
   * 이벤트 핸들러를 등록합니다.
   */
  Gantt.prototype.on = function () {
    var self = this;

    self._gantt.bind.apply(self._gantt, arguments);
  };

  /**
   * 이벤트 핸들러를 해제합니다.
   */
  Gantt.prototype.off = function () {
    var self = this;

    self._gantt.unbind.apply(self._gantt, arguments);
  };

  function _createDependencyDataSource(dataSource, dependenciesMapping) {
    var dependenciesDataSourceOpt;

    if (dataSource) {
      dependenciesDataSourceOpt = {
        schema: {
          model: {
            id: "id",
            fields: {
              id: {
                from: dependenciesMapping.id,
                type: "string"
              },
              predecessorId: {
                from: dependenciesMapping.predecessorId,
                type: "string"
              },
              successorId: {
                from: dependenciesMapping.successorId,
                type: "string"
              },
              type: {
                from: dependenciesMapping.type,
                type: "number"
              }
            }
          }
        }
      };

      return new kendo.data.GanttDependencyDataSource(dependenciesDataSourceOpt);
    }
  }

  function _createTaskDataSource(dataSource, taskMapping) {
    var ganttDataSourceOpt;

    if (dataSource) {
      ganttDataSourceOpt = {
        schema: {
          model: {
            id: "id",
            fields: {
              id: { from: taskMapping.id, type: "string" },
              end: { from: taskMapping.end, type: "date" },
              expanded: {
                from: taskMapping.expanded,
                type: "boolean"
              },
              orderId: {
                from: taskMapping.orderId,
                type: "number"
              },
              parentId: {
                from: taskMapping.parentId,
                type: "string",
                defaultValue: null
              },
              percentComplete: {
                from: taskMapping.percentComplete,
                type: "number"
              },
              start: { from: taskMapping.start, type: "date" },
              summary: {
                from: taskMapping.summary,
                type: "boolean"
              },
              title: { from: taskMapping.title, type: "string" }
            }
          }
        }
      };

      /* 정해진 컬럼들 외의 컬럼 사용 시 새로 추가 시 undefined로 설정되는 현상 수정 */
      for (var key in taskMapping) {
        if (!ganttDataSourceOpt.schema.model.fields.hasOwnProperty(key)) {
          ganttDataSourceOpt.schema.model.fields[key] = {
            from: taskMapping[key],
            type: "string"
          };
        }
      }

      return new kendo.data.GanttDataSource(ganttDataSourceOpt);
    }
  }

  function reTaskMapping(field, mapping) {
    if (mapping.title === field) {
      return "title";
    } else if (mapping.start === field) {
      return "start";
    } else if (mapping.end === field) {
      return "end";
    } else if (mapping.id === field) {
      return "id";
    } else if (mapping.orderId === field) {
      return "orderId";
    } else if (mapping.parentId === field) {
      return "parentId";
    } else if (mapping.percentComplete === field) {
      return "percentComplete";
    } else if (mapping.summary === field) {
      return "summary";
    } else if (mapping.expanded === field) {
      return "expanded";
    }
  }

  function reDependencyMapping(field, mapping) {
    if (mapping.id === field) {
      return "id";
    } else if (mapping.predecessorId === field) {
      return "predecessorId";
    } else if (mapping.successorId === field) {
      return "successorId";
    } else if (mapping.type === field) {
      return "type";
    }
  }

  function guid() {
    return "xxxxxxxx-xxxx-4xxx-9xxx-xxxxxxxxxxxx".replace(/[xy]/g, function (c) {
      var r = Math.random() * 16 | 0,
        v = c === "x" ? r : r & 0x3 | 0x8;
      return v.toString(16);
    });
  }

  function getHoliday(currentYear) {
    var $dfd = $.Deferred();
    dews.api.
    post(dews.url.getApiUrl("CM", "HolidayInfoService", "Year/" + currentYear), {
      data: {
        type: "all",
        calendar: "1"
      }
    }).
    done(function (data) {
      $dfd.resolve(data);
    }).
    fail(function (xhr, status, error) {
      console.log("error ", xhr, status, error);
      $dfd.resolve();
    });

    return $dfd.promise();
  }

  $.extend(true, dews, {
    /**
     * @namespace
     */
    ui: {
      gantt: function gantt(selector, options) {
        var $el, gantt, $content;

        if (dews.ui.dialogPage) {
          $content = dews.ui.dialogPage.$content;
        } else if (dews.ui.page) {
          $content = dews.ui.page.$content;
        } else {
          $content = $(document);
        }

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector, $content);
        }

        if ($.type(selector) === "undefined") {
          return;
        }

        $el.each(function () {
          var $this = $(this),
            gt;

          gt = $this.data("dews-control");

          if (!gt) {
            if ($.type(options) === "undefined") {
              options = {};
            }

            options.$content = $content;

            gt = new Gantt($this, options);
            $this.data("dews-control", gt);

            if (!$this.hasClass("dews-ui-gantt")) {
              $this.addClass("dews-ui-gantt");
            }

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }
          }
          gantt = gt;
        });

        return gantt;
      }
    }
  });
})(jQuery, window.dews || {}, window.kendo);


/*
 * 레이아웃 관련 기능
 */
(function ($, dews, kendo) {
  /**
   * 버튼그룹
   */
  function buttonGroup($container) {
    // 공백문자를 제거
    $(".dews-button-group").htmlClean();
    $(".dews-dialog-button-group").htmlClean(); // TODO: 다이얼로그 버튼 그룹이라는 클래스는 제거 해야 함 - 제거 후 이 라인 삭제할 것
  }

  $(function () {
    $(document).on("inituicontrols", function (e, target) {
      var $container;

      if (target instanceof jQuery) {
        $container = target;
      } else if ($.type(target) === "string") {
        $container = $(target);
      } else {
        $container = $(document);
      }

      // 버튼그룹 관련 처리
      buttonGroup($container);
    });

    // DOM내의 버튼 그룹에 keyup
    $(document).on(
    "keyup",
    "div.dews-button-group, div.dews-msgbox-botton-group, div.dews-dialog-button-group",
    function (e) {
      var target = $(e.target);

      if (e.keyCode === 39) {
        // 오른쪽
        var next;
        next = target.nextAll(".dews-ui-button").first();
        while (next.hasClass("k-state-disabled") || next.css("display") === "none") {
          next = next.nextAll(".dews-ui-button").first();
        }
        next.focus();
        target = next;
      } else if (e.keyCode === 37) {
        // 왼쪽
        var prev;
        prev = target.prevAll(".dews-ui-button").first();
        while (prev.hasClass("k-state-disabled") || prev.css("display") === "none") {
          prev = prev.prevAll(".dews-ui-button").first();
        }
        prev.focus();
        target = prev;
      }
    });

  });
})(jQuery, window.dews, window.kendo);


/*
 * 로딩 화면
 */
(function ($, dews, kendo) {
  function getTarget(main) {
    var target, win;
    if ($.type(main) === "boolean" || $.type(main) === "undefined") {
      if (main) {
        win = dews.getMainFrameWindowObject(window);
      } else {
        win = window;
      }
      target = win.$(win.document.body);
    }

    return target;
  }

  function getOptions(options) {
    var defaultOptions = {
      text: "LOADING...",
      type: "default"
    };

    return $.extend(true, defaultOptions, options);
  }

  function LoadingIndicator(target, forElement, options) {
    var self = this,
      opt;

    opt = getOptions(options);

    self.target = target;
    self.forElement = forElement;
    self.option = opt;
  }

  /**
   * 로딩, 배경을 생성합니다.
   */
  LoadingIndicator.prototype.create = function () {
    var self = this,
      $bg,
      $loading;

    $bg = $('<div class="dews-loading-bg" />');
    $loading = $(
    '<div class="dews-ui-loading"><div class="dews-loading-container">' +
    '<div class="dews-loading-img"></div></div><p class="dews-loading-text"></p></div>');


    if (self.forElement) {
      self.target.css({ position: "relative" });
      $loading.css({ position: "absolute" });
      $bg.css({
        width: self.target.width() + "px",
        height: self.target.height() + "px",
        position: "absolute"
      });
    }
    self.target.append($loading);
    self.target.append($bg);

    if (self.option.text !== false) {
      $loading.find("> .dews-loading-text")[0].innerHTML = this.option.text;
    }

    switch (self.option.type) {
      case "full":
        $loading.addClass("loading-full");
        $bg.addClass("loading-full");
        break;
      case "tiny":
        $loading.addClass("loading-tiny");
        break;
      case "snackbar":
        $loading.addClass("loading-snack");
        break;
      default:
        break;}

  };

  /**
   * 로딩, 배경을 삭제합니다.
   */
  LoadingIndicator.prototype.remove = function () {
    var self = this;

    self.target.find("> .dews-loading-bg").remove();
    self.target.find("> .dews-ui-loading").remove();
  };

  $.extend(true, dews, {
    ui: {
      loading: {
        show: function show(options) {
          var $target,
            loading,
            forElement = false;

          if ($.type(options) === "undefined") {
            options = { target: undefined };
          }

          if (options.target instanceof jQuery) {
            forElement = true;
            $target = options.target;
          } else if ($.type(options.target) === "string") {
            forElement = true;
            if (options.target === "page") {
              if (dews.ui.page && dews.ui.page.$content) {
                $target = dews.ui.page.$content;
              }
            } else {
              $target = $(options.target);
            }
          } else {
            $target = getTarget(options.target);
          }

          loading = $target.data("dews-control");

          if (!loading) {
            loading = new LoadingIndicator($target, forElement, options);
            loading.create();

            $target.data("dews-control", loading);
          }
        },
        hide: function hide(options) {
          var $target, loading;

          if ($.type(options) === "undefined") {
            options = { target: undefined };
          }

          if (options.target instanceof jQuery) {
            $target = options.target;
          } else if ($.type(options.target) === "string") {
            $target = $(options.target);
          } else {
            $target = getTarget(options.target);
          }

          loading = $target.data("dews-control");

          if (loading) {
            $target.removeData("dews-control");
            loading.remove();
          }
        }
      }
    }
  });
})(jQuery, window.dews, window.kendo);


(function (dews) {
  var dictionary = [
  { key: "dews_확인", ko: "확인", en: "Check", ja: "確認", zh: "确认" },
  { key: "dews_선택", ko: "선택", en: "Select", ja: "選択", zh: "选择" },
  { key: "dews_오류", ko: "오류", en: "Error", ja: "エラー", zh: "错误" },
  { key: "dews_예", ko: "예", en: "Yes", ja: "例", zh: "是" },
  { key: "dews_아니요", ko: "아니요", en: "No", ja: "いいえ", zh: "否" },
  {
    key: "dews_취소",
    ko: "취소",
    en: "Cancel",
    ja: "キャンセル",
    zh: "取消"
  },
  {
    key: "dews_자세히",
    ko: "자세히",
    en: "Detail",
    ja: "詳細",
    zh: "详细"
  },
  { key: "dews_적용", ko: "적용", en: "Apply", ja: "適用", zh: "适用" },
  { key: "dews_오늘", ko: "오늘", en: "Today ", ja: "今日 ", zh: "今天" },
  {
    key: "dews_어제",
    ko: "어제",
    en: "Yesterday",
    ja: "昨日",
    zh: "昨天"
  },
  { key: "dews_주간", ko: "주간", en: "Weekly", ja: "週間", zh: "周" },
  {
    key: "dews_전주",
    ko: "전주",
    en: "Last week",
    ja: "先週",
    zh: "上周"
  },
  { key: "dews_당월", ko: "당월", en: "Month", ja: "当月", zh: "本月" },
  {
    key: "dews_전월",
    ko: "전월",
    en: "Last month",
    ja: "前月",
    zh: "上月"
  },
  {
    key: "dews_오늘까지",
    ko: "오늘까지",
    en: "Until today",
    ja: "今日まで",
    zh: "今天为止"
  },
  {
    key: "dews_전년도",
    ko: "전년도",
    en: "Last year",
    ja: "昨年",
    zh: "去年"
  },
  {
    key: "dews_전전년도",
    ko: "전전년도",
    en: "Year before last",
    ja: "一昨年",
    zh: "前年"
  },
  {
    key: "dews_1/4분기",
    ko: "1분기",
    en: "1Q",
    ja: "第1四半期",
    zh: "一季度"
  },
  {
    key: "dews_2/4분기",
    ko: "2분기",
    en: "2Q",
    ja: "第2四半期",
    zh: "二季度"
  },
  {
    key: "dews_3/4분기",
    ko: "3분기",
    en: "3Q",
    ja: "第3四半期",
    zh: "三季度"
  },
  {
    key: "dews_4/4분기",
    ko: "4분기",
    en: "4Q",
    ja: "第4四半期",
    zh: "四季度"
  },
  {
    key: "dews_상반기",
    ko: "상반기",
    en: "First half",
    ja: "上半期",
    zh: "上半年"
  },
  {
    key: "dews_하반기",
    ko: "하반기",
    en: "Second half",
    ja: "下半期",
    zh: "下半年"
  },
  { key: "dews_1월", ko: "1월", en: "Jan", ja: "1月", zh: "1月" },
  { key: "dews_2월", ko: "2월", en: "Feb", ja: "2月", zh: "2月" },
  { key: "dews_3월", ko: "3월", en: "Mar", ja: "3月", zh: "3月" },
  { key: "dews_4월", ko: "4월", en: "Apr", ja: "4月", zh: "4月" },
  { key: "dews_5월", ko: "5월", en: "May", ja: "5月", zh: "5月" },
  { key: "dews_6월", ko: "6월", en: "Jun", ja: "6月", zh: "6月" },
  { key: "dews_7월", ko: "7월", en: "Jul", ja: "7月", zh: "7月" },
  { key: "dews_8월", ko: "8월", en: "Aug", ja: "8月", zh: "8月" },
  { key: "dews_9월", ko: "9월", en: "Sep", ja: "9月", zh: "9月" },
  { key: "dews_10월", ko: "10월", en: "Oct", ja: "10月", zh: "10月" },
  { key: "dews_11월", ko: "11월", en: "Nov", ja: "11月", zh: "11月" },
  { key: "dews_12월", ko: "12월", en: "Dec", ja: "12月", zh: "12月" },
  {
    key: "dews_선택한 기간",
    ko: "선택한 기간",
    en: "Selected period",
    ja: "選択した期間",
    zh: "选择其间"
  },
  {
    key: "dews_선택 기간",
    ko: "선택 기간",
    en: "Selection period",
    ja: "選択期間",
    zh: "选择其间"
  },
  {
    key: "dews_올해",
    ko: "올해",
    en: "This year",
    ja: "今年",
    zh: "今年"
  },
  {
    key: "dews_적용하기",
    ko: "적용하기",
    en: "Apply",
    ja: "反映する",
    zh: "适用"
  },
  { key: "dews_닫기", ko: "닫기", en: "Close", ja: "閉じる", zh: "关闭" },
  { key: "dews_저장", ko: "저장", en: "Save", ja: "保存", zh: "保存" },
  {
    key: "dews_전체삭제",
    ko: "전체삭제",
    en: "Delete all",
    ja: "すべて削除",
    zh: "全部删除"
  },
  {
    key: "dews_데이터가 없습니다.",
    ko: "데이터가 없습니다.",
    en: "No data exists.",
    ja: "データがありません。",
    zh: "没有数据。"
  },
  { key: "dews_외", ko: "외", en: "etc.", ja: "他", zh: "外" },
  { key: "dews_건", ko: "건", en: "transaction", ja: "件", zh: "件" },
  {
    key: "dews_필수 입력 항목입니다.",
    ko: "필수 입력 항목입니다.",
    en: "Field as required entry",
    ja: "必須入力項目です。",
    zh: "必填。"
  },
  {
    key: "dews_처음",
    ko: "처음",
    en: "First",
    ja: "最初のページ",
    zh: "第一页"
  },
  {
    key: "dews_이전",
    ko: "이전",
    en: "Previous",
    ja: "前へ",
    zh: "上一页"
  },
  {
    key: "dews_다음",
    ko: "다음",
    en: "Next",
    ja: "次へ",
    zh: "下一页"
  },
  {
    key: "dews_마지막",
    ko: "마지막",
    en: "Last",
    ja: "最後のページ",
    zh: "最后一页"
  },
  {
    key: "dews_이전 페이지 목록이 없습니다.",
    ko: "이전 페이지 목록이 없습니다.",
    en: "There is no list of previous pages.",
    ja: "以前のページのリストがありません。",
    zh: "上一页列表不存在。"
  },
  {
    key: "dews_다음 페이지 목록이 없습니다.",
    ko: "다음 페이지 목록이 없습니다.",
    en: "There is no list of the following pages.",
    ja: "次のページのリストがありません。",
    zh: "下一页列表不存在。"
  },
  {
    key: "dews_번호",
    ko: "번호",
    en: "No",
    ja: "NO",
    zh: "NO"
  },
  {
    key: "dews_전체선택",
    ko: "전체선택",
    en: "Select All",
    ja: "全選択",
    zh: "选择全部"
  },
  {
    key: "dews_업로드",
    ko: "업로드",
    en: "Upload",
    ja: "アップロード",
    zh: "上传"
  },
  {
    key: "dews_다운로드",
    ko: "다운로드",
    en: "Download",
    ja: "ダウンロード",
    zh: "下载"
  },
  { key: "dews_삭제", ko: "삭제", en: "Delete", ja: "削除", zh: "删除" },
  {
    key: "dews_초기화",
    ko: "초기화",
    en: "Initialize",
    ja: "初期化する",
    zh: "初始化"
  },
  { key: "dews_년Y", ko: "년", en: "Year", ja: "年", zh: "年" },
  {
    key: "dews_여기에 드래그하세요.",
    ko: "여기에 드래그하세요.",
    en: "Drag here.",
    ja: "ここにドラッグしてください.",
    zh: "拖动到这里。"
  },
  {
    key: "dews_위의 항목을 드래그해서 여기로 끌어놓으면 화면에서 보여지지 않습니다.",
    ko: "위의 항목을 드래그해서 여기로 끌어놓으면 화면에서 보여지지 않습니다.",
    en: "Drag-and-drop the above item here to hide from the screen. ",
    ja: "上の項目をドラッグアンドドロップすると、画面に表示されません。.",
    zh: "如果拖放上述项目，它们将不会显示在屏幕上。"
  },
  {
    key: "dews_업로드 제한된 확장자입니다.",
    ko: "업로드 제한된 확장자입니다.",
    en: "Extension file not allowed to upload",
    ja: "アップロードすることができない拡張ファイルです。",
    zh: "无法上传相应的扩展名。"
  },
  {
    key: "dews_전체 영역",
    ko: "전체 영역",
    en: "All area",
    ja: "すべてのフィールド",
    zh: "所有字段"
  },
  {
    key: "dews_열 영역",
    ko: "열 영역",
    en: "Column area",
    ja: "列のフィールド",
    zh: "列字段"
  },
  {
    key: "dews_값 영역",
    ko: "값 영역",
    en: "Value area",
    ja: "データ  フィールド",
    zh: "数据字段"
  },
  {
    key: "dews_필터 영역",
    ko: "필터 영역",
    en: "Filter area",
    ja: "フィルター フィールド",
    zh: "过滤字段"
  },
  {
    key: "dews_행 영역",
    ko: "행 영역",
    en: "Row area",
    ja: "行のフィールド",
    zh: "行字段"
  },
  {
    key: "dews_필드 선택창",
    ko: "필드 선택",
    en: "Field selection",
    ja: "フィールドの選択",
    zh: "字段选择器"
  },
  {
    key: "dews_행 영역입니다.",
    ko: "행 영역입니다.",
    en: "is row area",
    ja: "行フィールドをこちらへドラッグ＆ドロップ",
    zh: "将行字段拖到到此次"
  },
  {
    key: "dews_값 영역입니다.",
    ko: "값 영역입니다.",
    en: "is value area",
    ja: "データ フィールドをこちらへドラッグ＆ドロップ",
    zh: "将数据拖动到此处"
  },
  {
    key: "dews_열 영역입니다.",
    ko: "열 영역입니다.",
    en: "is column area",
    ja: "列フィールドをこちらへドラッグ＆ドロップ",
    zh: "将列拖动到此处"
  },
  {
    key: "dews_필터 영역입니다.",
    ko: "필터 영역입니다.",
    en: "is filter area",
    ja: "フィルター フィールドをこちらへドラッグ＆ドロップ",
    zh: "拖动筛选字段到此处"
  },
  {
    key: "dews_전체 접기",
    ko: "전체 접기",
    en: "Collapse All",
    ja: "すべて折りたたむ",
    zh: "全部收起"
  },
  {
    key: "dews_전체 펼치기",
    ko: "전체 필치기",
    en: "Expand All",
    ja: "すべて展開",
    zh: "全部展开"
  },
  {
    key: "dews_엑셀 내보내기",
    ko: "엑셀 내보내기",
    en: "Export to Excel file",
    ja: "Excel ファイルにエクスポート",
    zh: "导出Excel文件"
  },
  {
    key: "dews_엑셀 내보내기(화면)",
    ko: "엑셀 내보내기(화면)",
    en: "Export to Excel file(Screen)",
    ja: "Excel ファイルにエクスポート(画面)",
    zh: "导出Excel文件(屏幕)"
  },
  {
    key: "dews_엑셀 내보내기(코드)",
    ko: "엑셀 내보내기(코드)",
    en: "Export to Excel file(Code)",
    ja: "Excel ファイルにエクスポート(コード)",
    zh: "导出Excel文件(编码)"
  },
  {
    key: "dews_엑셀 내려 받기 (화면)",
    ko: "엑셀 내려 받기 (화면)",
    en: "Download Excel (Screen)",
    ja: "Excelをダウンロード (画面)",
    zh: "下载Excel (屏幕)"
  },
  {
    key: "dews_엑셀 내려 받기 (코드)",
    ko: "엑셀 내려 받기 (코드)",
    en: "Download Excel (Code)",
    ja: "Excelをダウンロード (コード)",
    zh: "下载Excel (编码)"
  },
  {
    key: "dews_엑셀 내보내기(화면, 숨김 컬럼 포함)",
    ko: "엑셀 내보내기(화면, 숨김 컬럼 포함)",
    en: "Download Excel (Screen, Include hidden columns)",
    ja: "Excelをダウンロード (画面, 非表示の列を含める)",
    zh: "下载Excel (屏幕, 包括隐藏的列)"
  },
  {
    key: "dews_엑셀 내보내기(코드, 숨김 컬럼 포함)",
    ko: "엑셀 내보내기(코드, 숨김 컬럼 포함)",
    en: "Download Excel (Code, Include hidden columns)",
    ja: "Excelをダウンロード (コード, 非表示の列を含める)",
    zh: "下载Excel (编码, 包括隐藏的列)"
  },
  {
    key: "dews_엑셀 내보내기(화면기준 스타일제거)",
    ko: "엑셀 내보내기(화면기준 스타일제거)",
    en: "Download Excel (Screen, Remove style)",
    ja: "Excelをダウンロード (画面, 文体を削除する)",
    zh: "下载Excel (屏幕, 删除样式)"
  },
  {
    key: "dews_사용자 정의 내보내기",
    ko: "사용자 정의 내보내기",
    en: "Custom Export",
    ja: "カスタムエクスポート",
    zh: "定制出口"
  },
  {
    key: "dews_리스트 컬럼(드롭다운, 콤보, 코드변환) 화면에 표시된 대로 출력",
    ko: "리스트 컬럼(드롭다운, 콤보, 코드변환) 화면에 표시된 대로 출력",
    en: "Output as displayed on the list column (drop down, combo, code conversion) screen",
    ja: "リスト列（ドロップダウン、コンボ、コード変換）画面に表示されたとおりの出力",
    zh: "输出显示在列表列（下拉，组合，代码转换）屏幕上"
  },
  {
    key: "dews_데이터 병합 해제",
    ko: "데이터 병합 해제",
    en: "Unmerge data",
    ja: "データのマージを解除",
    zh: "数据合并解除"
  },
  {
    key: "dews_컬럼 병합 해제",
    ko: "컬럼 병합 해제",
    en: "Unmerge column",
    ja: "カラムの併合解除",
    zh: "取消合并列"
  },
  {
    key: "dews_전체 합계",
    ko: "전체 합계",
    en: "Total sum",
    ja: "総計",
    zh: "合计"
  },
  {
    key: "dews_정렬 초기화",
    ko: "정렬 초기화",
    en: "Initialize alignment",
    ja: "すべての並べ替えを削除",
    zh: "排列初始化"
  },
  {
    key: "dews_필드 선택창 보이기",
    ko: "필드 선택창 보이기",
    en: "Show Field Selection Window",
    ja: "フィールドの選択を表示",
    zh: "显示字段选择器"
  },
  {
    key: "dews_열 정렬",
    ko: '"{0}" 열 정렬',
    en: '"{0}" Column Alignment',
    ja: 'この列で "{0}" を並べ替え',
    zh: '按 "{0}" 列排序'
  },
  {
    key: "dews_행 정렬",
    ko: '"{0}" 행 정렬',
    en: '"{0}" Row Alignment',
    ja: "この行で {0} を並べ替え",
    zh: '按 "{0}" 行排序'
  },
  {
    key: "dews_합계",
    ko: "{0}",
    en: "{0}",
    ja: "{0} 合計",
    zh: "{0} 总计"
  },
  { key: "dews_없음", ko: "없음", en: "None", ja: "なし", zh: "没有" },
  { key: "dews_매일", ko: "매일", en: "Daily", ja: "毎日", zh: "每天" },
  { key: "dews_매주", ko: "매주", en: "Weekly", ja: "毎週", zh: "每周" },
  { key: "dews_매월", ko: "매월", en: "Monthly", ja: "毎月", zh: "每月" },
  { key: "dews_매년", ko: "매년", en: "Yearly", ja: "毎年", zh: "每年" },
  { key: "dews_일", ko: "일", en: "day", ja: "日", zh: "天" },
  { key: "dews_일간", ko: "일간", en: "day", ja: "日", zh: "天" },
  { key: "dews_주", ko: "주", en: "week", ja: "週", zh: "周" },
  { key: "dews_주간", ko: "주간", en: "week", ja: "週", zh: "周" },
  { key: "dews_평일", ko: "평일", en: "weekday", ja: "平日", zh: "平日" },
  { key: "dews_월", ko: "월", en: "month", ja: "月", zh: "月" },
  { key: "dews_월간", ko: "월간", en: "month", ja: "月", zh: "月" },
  { key: "dews_년", ko: "년", en: "year", ja: "年", zh: "年" },
  { key: "dews_연간", ko: "연간", en: "year", ja: "年", zh: "年" },
  {
    key: "dews_타임라인",
    ko: "타임라인",
    en: "timeline",
    ja: "タイムライン",
    zh: "时间轴"
  },
  {
    key: "dews_아젠다",
    ko: "아젠다",
    en: "agenda",
    ja: "議題",
    zh: "议程"
  },
  {
    key: "dews_일정",
    ko: "일정",
    en: "schedule",
    ja: "一定",
    zh: "日程"
  },
  {
    key: "dews_하루 종일",
    ko: "하루 종일",
    en: "All Day Long",
    ja: "一日中",
    zh: "一整天"
  },
  {
    key: "dews_설명",
    ko: "설명",
    en: "description",
    ja: "説明",
    zh: "描述"
  },
  { key: "dews_시작", ko: "시작", en: "start", ja: "開始", zh: "开始" },
  { key: "dews_종료", ko: "종료", en: "end", ja: "終了", zh: "结束" },
  {
    key: "dews_반복",
    ko: "반복",
    en: "repeat",
    ja: "繰り返し",
    zh: "重复"
  },
  {
    key: "dews_제목",
    ko: "제목",
    en: "title",
    ja: "タイトル",
    zh: "主题"
  },
  {
    key: "dews_반복간격",
    ko: "반복간격",
    en: "Repetition interval",
    ja: "繰り返し間隔",
    zh: "重复间隔"
  },
  {
    key: "dews_반복주기",
    ko: "반복주기",
    en: "Repetition cycle",
    ja: "繰り返し周期",
    zh: "重复循环"
  },
  {
    key: "dews_반복종료",
    ko: "반복종료",
    en: "End repetition",
    ja: "繰り返し終了",
    zh: "重复结束"
  },
  { key: "dews_회", ko: "회", en: "times", ja: "発生", zh: "发生" },
  {
    key: "dews_전체 시간",
    ko: "전체 시간",
    en: "Total time",
    ja: "フルタイム",
    zh: "总时间"
  },
  {
    key: "dews_업무 시간",
    ko: "업무 시간",
    en: "Working time",
    ja: "営業時間",
    zh: "营业时间"
  },
  { key: "dews_날짜", ko: "날짜", en: "date", ja: "日付", zh: "日期" },
  { key: "dews_일요일", ko: "일", en: "Sunday", ja: "日", zh: "日" },
  { key: "dews_월요일", ko: "월", en: "Monday", ja: "月", zh: "一" },
  { key: "dews_화요일", ko: "화", en: "Tuesday", ja: "火", zh: "二" },
  { key: "dews_수요일", ko: "수", en: "Wednesday", ja: "水", zh: "三" },
  { key: "dews_목요일", ko: "목", en: "Thursday", ja: "木", zh: "四" },
  { key: "dews_금요일", ko: "금", en: "Friday", ja: "金", zh: "五" },
  { key: "dews_토요일", ko: "토", en: "Saturday", ja: "土", zh: "六" },
  {
    key: "dews_선택일",
    ko: "선택일",
    en: "Selection day",
    ja: "日",
    zh: "选择日"
  },
  {
    key: "dews_자식 추가",
    ko: "자식 추가",
    en: "Add Child",
    ja: "子を追加",
    zh: "增加子女"
  },
  {
    key: "dews_작업추가",
    ko: "태스크",
    en: "Add job",
    ja: "タスクを追加",
    zh: "添加任务"
  },
  {
    key: "dews_아래에 추가",
    ko: "아래에 추가",
    en: "Add Below",
    ja: "下に追加",
    zh: "在下面添加"
  },
  {
    key: "dews_위에 추가",
    ko: "위에 추가",
    en: "Add Above",
    ja: "上に追加",
    zh: "添加上面"
  },
  { key: "dews_작업", ko: "작업", en: "Job", ja: "仕事", zh: "任务" },
  {
    key: "dews_할당",
    ko: "할당",
    en: "Allocate",
    ja: "割り当てます",
    zh: "分配"
  },
  {
    key: "dews_진행률",
    ko: "진행",
    en: "Proceed",
    ja: "コンプリート",
    zh: "完成"
  },
  {
    key: "dews_자원",
    ko: "자원",
    en: "Resources",
    ja: "リソース",
    zh: "资源"
  },
  {
    key: "dews_새 작업",
    ko: "새 작업",
    en: "New job",
    ja: "新しい仕事",
    zh: "新任务"
  },
  {
    key: "dews_작업을 삭제하시겠습니까?",
    ko: "작업을 삭제하시겠습니까?",
    en: "Do you want to delete job?",
    ja: "この依存関係を削除してもよろしいですか？",
    zh: "您确定要删除此操作吗？"
  },
  {
    key: "dews_연결을 삭제하시겠습니까?",
    ko: "연결을 삭제하시겠습니까?",
    en: "Do you want to delete link?",
    ja: "このタスクを削除してもよろしいですか？",
    zh: "您确定要删除此连接吗？"
  },
  {
    key: "dews_틀 고정",
    ko: "틀 고정",
    en: "Fixed frame",
    ja: "ウィンドウ枠の固定",
    zh: "固定框架"
  },
  {
    key: "dews_틀 고정 취소",
    ko: "틀 고정 취소",
    en: "Fixed frame cancel",
    ja: "ィンドウ枠の固定解除",
    zh: "取消固定框架"
  },
  {
    key: "dews_위젯검증",
    ko: "위젯검증",
    en: "Widget validate",
    ja: "ウィジェットの検証",
    zh: "小部件验证"
  },
  {
    key: "dews_대시보드 복사",
    ko: "대시보드 복사",
    en: "Dashboard copy",
    ja: "ダッシュボードのコピー",
    zh: "仪表板副本"
  },
  { key: "dews_탭", ko: "탭", en: "Tab", ja: "タブ", zh: "标签" },
  {
    key: "dews_등록된 위젯이 없습니다.",
    ko: "등록된 위젯이 없습니다.",
    en: "There is no registered widget",
    ja: "登録されたウィジェットがありません。",
    zh: "没有注册的小部件。"
  },
  {
    key: "dews_탭명 변경",
    ko: "탭명 변경",
    en: "Change tab name",
    ja: "タブの名前を変更する",
    zh: "重命名选项卡"
  },
  {
    key: "dews_탭명 다국어설정",
    ko: "탭명 다국어설정",
    en: "Tab name International setting",
    ja: "グリッドエクセルダウンロード",
    zh: "网格excel下载"
  },
  {
    key: "dews_탭 삭제",
    ko: "탭 삭제",
    en: "Delete tab",
    ja: "タブの削除",
    zh: "删除标签"
  },
  {
    key: "dews_검색",
    ko: "검색",
    en: "Search",
    ja: "検索。",
    zh: "搜索。"
  },
  {
    key: "dews_그리드 엑셀 다운로드",
    ko: "그리드 엑셀 다운로드",
    en: "Grid Excel Download",
    ja: "タブの名前を変更する",
    zh: "重命名选项卡"
  },
  {
    key: "dews_컬럼명",
    ko: "컬럼명",
    en: "Column Name",
    ja: "列名",
    zh: "标签名称国际设置"
  },
  {
    key: "dews_필드명",
    ko: "필드명",
    en: "Field Name",
    ja: "フィールド名",
    zh: "删除标签"
  },
  {
    key: "dews_화면데이터",
    ko: "화면데이터",
    en: "Screen data",
    ja: "画面データ",
    zh: "屏幕数据"
  },
  {
    key: "dews_다운로드 컬럼을 선택하세요.",
    ko: "다운로드 컬럼을 선택하세요.",
    en: "Please select a download column.",
    ja: "ダウンロード列を選択してください。",
    zh: "请选择下载列。"
  },
  {
    key: "dews_컬럼 에디터",
    ko: "컬럼 에디터",
    en: "Column Editor",
    ja: "列エディター",
    zh: "列编辑器"
  },
  { key: "dews_너비", ko: "너비", en: "Width", ja: "幅", zh: "宽度" },
  {
    key: "dews_출력여부",
    ko: "출력여부",
    en: "Visible",
    ja: "目に見える",
    zh: "可见"
  },
  {
    key: "dews_고정여부",
    ko: "고정여부",
    en: "Fixed or Not",
    ja: "固定かどうか",
    zh: "固定与否"
  },
  {
    key: "dews_저장하시겠습니까?",
    ko: "저장하시겠습니까?",
    en: "Would you like to save?",
    ja: "保存しますか？",
    zh: "您要保存吗？"
  },
  {
    key: "dews_초기화하시겠습니까?",
    ko: "초기화하시겠습니까?",
    en: "Would you like to reset?",
    ja: "リセットしますか？",
    zh: "您想重设吗？"
  },
  {
    key: "dews_고정 여부가 정상적으로 설정되지 않았습니다.",
    ko: "고정 여부가 정상적으로 설정되지 않았습니다.",
    en: "Fixation is not set properly.",
    ja: "固定が正しく設定されていません.",
    zh: "定影设置不正确."
  },
  {
    key: "dews_주소",
    ko: "주소",
    en: "Address",
    ja: "アドレス",
    zh: "住址"
  },
  {
    key: "dews_우편번호",
    ko: "우편번호",
    en: "Zipcode",
    ja: "郵便番号",
    zh: "郵遞區號"
  },
  {
    key: "dews_검색결과",
    ko: "검색결과",
    en: "Search Results",
    ja: "検索結果",
    zh: "搜索結果"
  },
  {
    key: "dews_시/도를 선택하세요.",
    ko: "시/도를 선택하세요.",
    en: "Please select a city",
    ja: "市、道を選択してください。",
    zh: "請選擇詩,圖"
  },
  {
    key: "dews_시군구를 선택하세요.",
    ko: "시군구를 선택하세요.",
    en: "Please select the city, county and district.",
    ja: "市郡区を選択してください。",
    zh: "請選擇市郡區。"
  },
  {
    key: "dews_우편번호 검색",
    ko: "우편번호 검색",
    en: "Search address",
    ja: "検索アドレス",
    zh: "请输入搜索关键词"
  },
  {
    key: "dews_검색어를 입력해주세요.",
    ko: "검색어를 입력해주세요.",
    en: "Please enter a search keyword.",
    ja: "検索キーワードを入力してください",
    zh: "搜索地址"
  },
  {
    key: "dews_주소를 선택 후 적용 버튼을 눌러주세요.",
    ko: "주소를 선택 후 적용 버튼을 눌러주세요.",
    en: "Please click the Apply button, after selecting the address.",
    ja: "アドレスを選択後、「適用」ボタンをクリックしてください。",
    zh: "選擇地址後，請單擊“應用”按鈕。"
  },
  {
    key: "dews_시, 도를 선택하고 지번 및 도로명을 입력 후 검색을 눌러주세요.",
    ko: "시, 도를 선택하고 지번 및 도로명을 입력 후 검색을 눌러주세요.",
    en: "Please click the Apply button, after selecting the address.",
    ja: "アドレスを選択後、「適用」ボタンをクリックしてください。",
    zh: "選擇地址後，請單擊“應用”按鈕。"
  },
  {
    key: "dews_시/도와 시군구 선택 후 검색어를 입력하셔야 검색이 가능합니다.",
    ko: "시/도와 시군구 선택 후 검색어를 입력하셔야 검색이 가능합니다.",
    en: "You can search if you select the city and province, and enter a search keyword.",
    ja: "市/道·市郡区を選択した後、検索キーワードを入力しないと検索できません。",
    zh: "選擇市/道和市郡區後輸入搜索詞才能搜索。"
  },
  {
    key: "dews_검색결과가 없습니다.",
    ko: "검색결과가 없습니다.",
    en: "No search results found.",
    ja: "検索結果がありません。",
    zh: "搜索結果不存在"
  },
  {
    key: "dews_검색어를 다시 한번 확인해 주세요.",
    ko: "검색어를 다시 한번 확인해 주세요.",
    en: "Please check the search keyword",
    ja: "検索キーワードをもう一度確認してください。",
    zh: "請重新確認一下搜索詞。"
  },
  {
    key: "dews_필터",
    ko: "필터",
    en: "Filter",
    ja: "フィルタ",
    zh: "过滤"
  },
  {
    key: "dews_필터 아이콘 표시",
    ko: "필터 아이콘 표시",
    en: "Show filter icon",
    ja: "フィルターアイコンを表示",
    zh: "显示过滤器图标"
  },
  {
    key: "dews_필터 아이콘 표시 취소",
    ko: "필터 아이콘 표시 취소",
    en: "Undisplay the filter icon",
    ja: "フィルターアイコンを非表示にする",
    zh: "取消显示过滤器图标"
  },
  {
    key: "dews_필터해제",
    ko: "필터해제",
    en: "Clear filter",
    ja: "フィルターをクリア",
    zh: "清除筛选"
  },
  {
    key: "dews_기타 필터",
    ko: "기타 필터",
    en: "Other filters",
    ja: "その他のフィルター",
    zh: "其他过滤器"
  },
  {
    key: "dews_퀵 필터",
    ko: "퀵 필터",
    en: "Quick Filter",
    ja: "クイックフィルタ",
    zh: "快速过滤"
  },
  {
    key: "dews_필터 옵션",
    ko: "필터 옵션",
    en: "Filter Options",
    ja: "フィルタオプション",
    zh: "过滤选项"
  },
  {
    key: "dews_조건",
    ko: "조건",
    en: "Condition",
    ja: "条件",
    zh: "状况"
  },
  { key: "dews_값", ko: "값", en: "Value", ja: "値", zh: "值" },
  {
    key: "dews_필터 값",
    ko: "필터 값",
    en: "Filter Value",
    ja: "フィルタ値",
    zh: "过滤器值"
  },
  {
    key: "dews_시작 문자",
    ko: "시작 문자",
    en: "Starting character",
    ja: "開始文字",
    zh: "起始字符"
  },
  {
    key: "dews_제외 할 시작 문자",
    ko: "제외 할 시작 문자",
    en: "Starting character to exclude",
    ja: "除外する開始文字",
    zh: "要排除的起始字符"
  },
  {
    key: "dews_끝 문자",
    ko: "끝 문자",
    en: "End character",
    ja: "終了文字",
    zh: "结束符"
  },
  {
    key: "dews_제외 할 끝 문자",
    ko: "제외 할 끝 문자",
    en: "End character to exclude",
    ja: "除外する終了文字",
    zh: "结束字符以排除"
  },
  { key: "dews_포함", ko: "포함", en: "Include", ja: "含む", zh: "包括" },
  {
    key: "dews_포함하지 않음",
    ko: "포함하지 않음",
    en: "Not included",
    ja: "含まない",
    zh: "不包含"
  },
  { key: "dews_범위", ko: "범위", en: "Range", ja: "範囲", zh: "范围" },
  {
    key: "dews_빈 값",
    ko: "빈 값",
    en: "Empty value",
    ja: "空の値",
    zh: "空值"
  },
  {
    key: "dews_빈 값 제외",
    ko: "빈 값 제외",
    en: "Exclude blank values",
    ja: "空白の値を除外する",
    zh: "排除空白值"
  },
  {
    key: "dews_값을 입력하세요",
    ko: "값을 입력하세요",
    en: "Please enter a value",
    ja: "値を入力してください",
    zh: "请输入一个值"
  },
  { key: "dews_추가", ko: "추가", en: "Add", ja: "追加", zh: "加" },
  {
    key: "dews_찾을 조건",
    ko: "찾을 조건",
    en: "Find condition",
    ja: "検索条件",
    zh: "查找条件"
  },
  { key: "dews_그리고", ko: "그리고", en: "And", ja: "そして", zh: "和" },
  { key: "dews_또는", ko: "또는", en: "Or", ja: "または", zh: "要么" },
  {
    key: "dews_저장할 내역이 없습니다.",
    ko: "저장할 내역이 없습니다.",
    en: "There is nothing to save",
    ja: "保存する履歴がありません",
    zh: "没有什么可以保存的"
  },
  {
    key: "dews_현재 필터 레이어 내역이 저장되었습니다.",
    ko: "현재 필터 레이어 내역이 저장되었습니다.",
    en: "The current filter layer history has been saved",
    ja: "現在のフィルターレイヤーの履歴が保存されました",
    zh: "当前滤镜层的历史记录已保存"
  },
  {
    key: "dews_현재 필터 레이어 내역이 저장에 실패하였습니다.",
    ko: "현재 필터 레이어 내역이 저장에 실패하였습니다.",
    en: "Failed to save current filter layer details",
    ja: "現在のフィルタ層の内訳は保存に失敗しました",
    zh: "当前过滤层的细分无法保存"
  },
  {
    key: "dews_데이터 로딩 중 입니다.",
    ko: "데이터 로딩 중 입니다.",
    en: "Loading Data",
    ja: "データのロード",
    zh: "加载数据中"
  },
  {
    key: "dews_데이터를 불러오고 있습니다.",
    ko: "데이터를 불러오고 있습니다.",
    en: "Loading Data",
    ja: "データをロードしています",
    zh: "数据正在加载"
  },
  { key: "dews_년yr", ko: "년", en: "yr", ja: "年", zh: "年" },
  { key: "dews_월mo", ko: "월", en: "mo", ja: "月", zh: "月" },
  { key: "dews_주wk", ko: "주", en: "wk", ja: "週", zh: "周" },
  {
    key: "dews_폼패널의 ID를 설정해주세요.",
    ko: "폼패널의 ID를 설정해주세요.",
    en: "Please set the ID of the form panel ",
    ja: "フォームパネルのIDを設定してください",
    zh: "设置表单面板的ID。"
  },
  {
    key: "dews_적용중",
    ko: "적용중",
    en: "apply",
    ja: "適用する",
    zh: "应用"
  },
  {
    key: "dews_파일을 직접 끌어다 놓으면 추가됩니다.",
    ko: "파일을 직접 끌어다 놓으면 추가됩니다.",
    en: "It is added by dragging and dropping the file.",
    ja: "ファイルをドラッグアンドドロップし追加します。",
    zh: "通过拖放文件来添加它。"
  },
  {
    key: "dews_파일을 삭제하시겟습니까?",
    ko: "파일을 삭제하시겟습니까?",
    en: "Do you want to delete the file?",
    ja: "ファイルを削除しますか？",
    zh: "您要删除文件吗？"
  },
  {
    key: "dews_스타일 관리",
    ko: "스타일 관리",
    en: "Style management",
    ja: "スタイル管理",
    zh: "风格管理"
  },
  {
    key: "dews_스타일 추가",
    ko: "스타일 추가",
    en: "Add Style",
    ja: "スタイル追加",
    zh: "添加风格"
  },
  {
    key: "dews_스타일 삭제",
    ko: "스타일 삭제",
    en: "Delete Style",
    ja: "スタイル削除",
    zh: "删除样式"
  },
  {
    key: "dews_스타일 가져오기",
    ko: "스타일 가져오기",
    en: "Import Style",
    ja: "スタイル持ってくる",
    zh: "导入风格"
  },
  {
    key: "dews_기본 스타일",
    ko: "기본 스타일",
    en: "Default Style",
    ja: "デフォルトスタイル",
    zh: "基本风格"
  },
  {
    key: "dews_스타일명",
    ko: "스타일명",
    en: "Style Name",
    ja: "スタイル名",
    zh: "样式名称"
  },
  {
    key: "dews_스타일 ID",
    ko: "스타일 ID",
    en: "Style ID",
    ja: "スタイルID",
    zh: "样式标识"
  },
  {
    key: "dews_검색어",
    ko: "검색어",
    en: "Keyword",
    ja: "検索語",
    zh: "检索语"
  },
  {
    key: "dews_사원명",
    ko: "사원명",
    en: "Name",
    ja: "社員名",
    zh: "员工姓名"
  },
  {
    key: "dews_전체삭제 하시겠습니까?",
    ko: "전체삭제 하시겠습니까?",
    en: "Do you want to delete all?",
    ja: "すべて削除しますか？",
    zh: "您要全部删除吗？"
  },
  {
    key: "dews_삭제 하시겠습니까?",
    ko: "삭제 하시겠습니까?",
    en: "Are you sure you want to delete?",
    ja: "消去してもよろしいですか？",
    zh: "你确定你要删除？"
  },
  {
    key: "dews_저장 이름 설정",
    ko: "저장 이름 설정",
    en: "Set save name",
    ja: "保存名を設定する",
    zh: "设置保存名称"
  },
  {
    key: "dews_저장 이름",
    ko: "저장 이름",
    en: "Set save name",
    ja: "名前を保存",
    zh: "保存名字"
  },
  {
    key: "dews_간이계산기",
    ko: "간이계산기",
    en: "Simple Calculator",
    ja: "簡易電卓",
    zh: "简单的计算器"
  },
  {
    key: "dews_선택한 영역에 숫자 타입이 아닌 컬럼이 포함되어 있습니다.",
    ko: "선택한 영역에 숫자 타입이 아닌 컬럼이 포함되어 있습니다.",
    en: "The selected area contains non-numeric columns.",
    ja: "選択した領域に数値型ではなく、カラムが含まれています。",
    zh: "所选区域包含非数字列。"
  },
  { key: "dews_기간", ko: "기간", en: "period", ja: "期間", zh: "时期" },
  { key: "dews_색", ko: "색", en: "color", ja: "色", zh: "颜色" },
  {
    key: "dews_담당자",
    ko: "담당자",
    en: "assign",
    ja: "割当",
    zh: "分配"
  },
  {
    key: "dews_파일을 삭제하시겠습니까?",
    ko: "파일을 삭제하시겠습니까?",
    en: "Are you sure you want to delete the file?",
    ja: "ファイルを削除しますか？",
    zh: "您确定要删除该文件吗？"
  },
  {
    key: "dews_엑셀 내보내기 중입니다.",
    ko: "엑셀 내보내기 중입니다.",
    en: "Excel exporting",
    ja: "Excelのエクスポート中です。",
    zh: "Excel 导出。"
  }];


  // dews.localization 에 언어별 등록
  var dicForLang = {};
  var language, page;

  if (dews.localize.mode() === "multiple") {
    page = "global";
  }

  for (var i = 0; i < dictionary.length; i++) {
    for (var prop in dictionary[i]) {
      if (dictionary[i].hasOwnProperty(prop) && prop !== "key") {
        if (!dicForLang.hasOwnProperty(prop)) {
          dicForLang[prop] = {};
        }
        language = dicForLang[prop];
        language[dictionary[i].key] = dictionary[i][prop];
      }
    }
  }

  for (var lang in dicForLang) {
    if (dicForLang.hasOwnProperty(lang)) {
      dews.localize.setResource(dicForLang[lang], lang, page);
    }
  }
})(window.dews);


/*
 * 메인버튼
 */

(function ($, dews) {
  function MainButton(selector) {
    var self = this;
    self._element = selector;

    return self;
  }

  MainButton.prototype.show = function () {
    var self = this;
    $(self._element).parent("li").show();
  };

  MainButton.prototype.hide = function () {
    var self = this;
    $(self._element).parent("li").hide();
  };

  MainButton.prototype.disable = function (bool) {
    var self = this,
      button;

    button = $(self._element);

    bool = typeof bool === "undefined" ? true : bool;

    button.attr("disabled", bool);

    return button.prop("disabled");
  };

  MainButton.prototype.on = function () {
    var self = this;
    var $button = $(self._element);
    $button.on.apply($button, arguments);
  };

  MainButton.prototype.click = function () {
    var self = this;
    var $button = $(self._element);
    $button.click.apply($button, arguments);
  };

  dews = $.extend(true, dews, {
    ui: {
      mainbuttons: {
        approval: new MainButton(".main-button.approval"),
        add: new MainButton(".main-button.add"),
        "delete": new MainButton(".main-button.delete"),
        save: new MainButton(".main-button.save"),
        search: new MainButton(".main-button.lookup"),
        print: new MainButton(".main-button.print"),
        configure: new MainButton(".main-button.configure")
      }
    }
  });
})(jQuery, window.dews || {});


/*
 * 맵
 */
(function ($, dews) {
  var defaultOptions = {
    mapProvider: dews._environments.map && dews._environments.map.type ? dews._environments.map.type : "kakao", // 회사에서 설정한 맵타입이 있을 경우 사용
    center: { lat: 37.5664884462972, lng: 126.981025044659 },
    height: "500px",
    width: "100%",
    zoom: 10,
    draggable: true,
    useZoomControl: true,
    doubleClickZoom: true
  };

  /**
   * 맵 생성을 위한 옵션을 가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   * @param {object} srcOptions 소스코드에서 전달된 옵션
   * @returns {object} 옵션
   */
  function getOptions($el, srcOptions) {
    var inlineOptions,
      options = {};

    inlineOptions = getInlineOptions($el);

    $.extend(true, options, defaultOptions, inlineOptions, srcOptions);

    return options;
  }

  /**
   * HTML 코드 상에 설정된 옵션 정보를 가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   * @returns {object} 옵션
   */
  function getInlineOptions($el) {
    var options = {};

    if ($el.data("dews-lat") || $el.data("dews-lng")) {
      options.center = {};
    }

    if ($el.data("dews-lat")) {
      options.center.lat = $el.data("dews-lat");
    }

    if ($el.data("dews-lng")) {
      options.center.lng = $el.data("dews-lng");
    }

    if ($el.data("dews-zoom")) {
      options.zoom = $el.data("dews-zoom");
    }

    if ($el.data("dews-maptype")) {
      options.mapType = $el.data("dews-maptype");
    }

    if (typeof $el.data("dews-draggable") === "boolean") {
      options.draggable = $el.data("dews-draggable");
    }

    if (typeof $el.data("dews-use-zoomcontrol") === "boolean") {
      options.useZoomControl = $el.data("dews-use-zoomcontrol");
    }

    if (typeof $el.data("dews-doubleclick-zoom") === "boolean") {
      options.doubleClickZoom = $el.data("dews-doubleclick-zoom");
    }

    if ($el.data("dews-map-provider")) {
      options.mapProvider = $el.data("dews-map-provider");
    }

    if ($el.data("dews-height")) {
      options.height = $el.data("dews-height");
      $el.css("height", $el.data("dews-height"));
    }

    if ($el.data("dews-width")) {
      options.width = $el.data("dews-width");
      $el.css("width", $el.data("dews-width"));
    }

    return options;
  }

  var Map = function Map($element, options) {
    var self = this;
    var map = new dews.ui.Map.DewsMap($element.attr("id"), options);

    self.$element = $element;
    self.options = options;
    self._map = map;

    return self;
  };

  // Map.prototype.getOptions = function () {
  //     var self = this;
  //
  //     return self.options;
  // };

  // Map.prototype.setOptions = function (option) {
  //     var self = this, options;
  //
  //     options = $.extend(true, {}, self.options, option);
  //     self.options = getOptions(self.$element, options);
  //
  //     self._map.setOptions(self.options);
  // };
  //
  Map.prototype.refresh = function () {
    var self = this;

    self._map.refresh();
  };

  Map.prototype.getCenter = function () {
    var self = this;

    return self._map.getCenter();
  };

  Map.prototype.setCenter = function (lat, lng) {
    var self = this;

    if (lat && lng) {
      self._map.setCenter(lat, lng);
    } else if (lat && typeof lat === "string") {
      return self._map.setCenter(lat);
    }
  };

  Map.prototype.getZoom = function () {
    var self = this;
    return self._map.getZoom();
  };

  Map.prototype.setZoom = function (zoom) {
    var self = this;
    self._map.setZoom(zoom);
  };

  Map.prototype.panTo = function (lat, lng) {
    var self = this;
    self._map.panTo(lat, lng);
  };

  Map.prototype.panBy = function (dx, dy) {
    var self = this;
    self._map.panBy(dx, dy);
  };

  Map.prototype.getMapType = function () {
    var self = this;
    return self._map.getMapType();
  };

  Map.prototype.setMapType = function (mapType) {
    var self = this;
    self._map.setMapType(mapType);
  };

  Map.prototype.addInfoWindow = function (options) {
    var self = this;

    if (options.marker) {
      return self._map.addInfoWindow({}, options.content, options.marker);
    } else if (options.position) {
      return self._map.addInfoWindow(options.position, options.content, {});
    }
  };

  Map.prototype.infoWindowItems = function () {
    var self = this;
    return self._map.infoWindowItems();
  };

  Map.prototype.addMarker = function (position) {
    var self = this;

    return self._map.addMarker(self, position);
  };

  Map.prototype.markerItems = function () {
    var self = this;
    return self._map.markerItems();
  };

  Map.prototype.convertAddrToLatLng = function (address) {
    var self = this;
    return self._map.convertAddToLatLng(address);
  };

  Map.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["click", "dblclick", "center_changed", "zoom_changed"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "click") {
          self.$element.trigger("_click");
        } else if (event === "dblclick") {
          self.$element.trigger("_dblclick");
        } else {
          self.$element.trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  Map.prototype.on = function () {
    var self = this,
      $element = self.$element;

    if (arguments[0] === "click") {
      Array.prototype.splice.apply(arguments, [0, 1, "_click"]);
    } else if (arguments[0] === "dblclick") {
      Array.prototype.splice.apply(arguments, [0, 1, "_dblclick"]);
    }

    $element.on.apply($element, arguments);
  };

  Map.prototype._bindEvents = function () {
    var self = this,
      $element = self.$element;

    $element.on("__click", function (e) {
      var parameter = {
        map: self,
        latLng: e.latLng
      };

      var event = new $.Event("_click", parameter);
      $element.trigger(event);
    });

    $element.on("__dblclick", function (e) {
      var parameter = {
        map: self,
        latLng: e.latLng
      };

      var event = new $.Event("_dblclick", parameter);
      $element.trigger(event);
    });

    $element.on("_center_changed", function (e) {
      var parameter = {
        map: self,
        center: self.getCenter()
      };

      var event = new $.Event("center_changed", parameter);
      $element.trigger(event);
    });

    $element.on("_zoom_changed", function (e) {
      var parameter = {
        map: self,
        zoom: self.getZoom(),
        previousZoom: e.previous
      };

      var event = new $.Event("zoom_changed", parameter);
      $element.trigger(event);
    });
  };

  $.extend(true, dews, {
    ui: {
      map: function map(selector, options) {
        var dfd = $.Deferred();
        var $ctl, context;
        var interval;

        if (dews.ui.dialogPage) {
          context = dews.ui.dialogPage.$content;
        } else if (dews.ui.page) {
          context = dews.ui.page.$content;
        } else {
          context = $(document);
        }

        if (selector instanceof jQuery) {
          $ctl = selector;
        } else if ($.type(selector) === "string") {
          $ctl = $("#" + selector, context);
        } else {
          console.error("맵을 생성할 대상이 제공되지 않았습니다.");
          dfd.reject();
          return;
        }

        var createComponent = function createComponent() {
          var $dfd = $.Deferred();
          var self = this;
          var $control = $ctl.eq(0);
          var opt = getOptions($control, options);
          var newMap;

          if ($control.data("dews-control")) {
            newMap = $control.data("dews-control");
          } else {
            if (!$control.hasClass("dews-ui-map")) {
              $control.addClass("dews-ui-map");
            }

            if (!$control.hasClass("dews-control-activate")) {
              $control.addClass("dews-control-activate");
            }

            newMap = new Map($control, opt);
            var $promiseMap = newMap._map.initialize();
            $promiseMap.done(function (map) {
              $control.data("dews-control", newMap);

              newMap._bindEvents();

              $dfd.resolve(newMap);
            });

            self.$element = $control;
            self.options = opt;
          }
          return $dfd.promise();
        };

        if (typeof dews.ui.Map !== "undefined" && typeof dews.ui.Map.DewsMap === "function") {
          var $promise = createComponent();
          $promise.done(function (map) {
            dfd.resolve(map);
          });
        } else {
          interval = setInterval(function () {
            if (
            dews._environments.loadDewsMap &&
            window.dews.ui.Map &&
            typeof window.dews.ui.Map.DewsMap === "function")
            {
              try {
                var $promise = createComponent();
                clearInterval(interval);
                $promise.done(function (map) {
                  dfd.resolve(map);
                });
              } catch (e) {
                clearInterval(interval);
                dfd.reject(e);
              }
            } else if (!dews._environments.loadDewsMap) {
              var dewsMapUrl = dews._environments.scriptBase + "dews.map.js";
              $.getScript(dewsMapUrl, function () {
                try {
                  var $promise = createComponent();
                  clearInterval(interval);
                  $promise.done(function (map) {
                    dfd.resolve(map);
                  });
                } catch (e) {
                  clearInterval(interval);
                  dfd.reject(e);
                }
              });
              dews._environments.loadDewsMap = true;
            }
          }, 100);
        }
        return dfd.promise();
      }
    }
  });
  dews.ui.addAsyncControlInitializer("map", function (target) {
    var $container;
    var $dfd = $.Deferred();

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    var $controls = $container.find("div.dews-ui-map");
    var $promises = [];

    if ($controls.length > 0) {
      $controls.each(function (idx, item) {
        $promises.push(dews.ui.map($(item)));
      });
      $.when.apply(null, $promises).always(function () {
        $dfd.resolve();
      });
    } else {
      $dfd.resolve();
    }

    return $dfd.promise();
  });
})(jQuery, window.dews);


/*
 * 마스크 텍스트 박스
 */
(function ($, dews, kendo) {
  var defaultOptions = {
    predefined: false,
    unmaskOnPost: true
  };

  /**
   * 옵션을 가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   * @param {object} codeOptions 스크립트 코드에서 전송된 옵션
   */
  function getOptions($el, codeOptions) {
    var inlineOptions;
    // preDefinedFormat;

    codeOptions = codeOptions || {};
    if (codeOptions.mask) {
      // script에서 설정한 옵션일 경우 element에 data로 옵션 추가
      if (!$el.data("dews-mask") && codeOptions.mask) {
        $el.data("dews-mask", codeOptions.mask);
      }
      if (!$el.data("dews-predefined") && codeOptions.predefined) {
        $el.data("dews-predefined", codeOptions.predefined);
      }
      if (!$el.data("dews-secure-mask") && codeOptions.secureMask) {
        $el.data("dews-secure-mask", codeOptions.secureMask);
      }
      if (!$el.data("dews-prompt") && codeOptions.promptChar) {
        $el.data("dews-prompt", codeOptions.promptChar);
      }
      if (codeOptions.value) {
        $el.val(codeOptions.value);
      }

      codeOptions = {};
    }

    inlineOptions = getInlineOptions($el);

    // preDefinedFormat = dews.getPreDefinedFormat($el);

    // if (preDefinedFormat) {
    //     preDefinedFormat = {mask: preDefinedFormat};
    //     return $.extend(true, {}, defaultOptions, inlineOptions, codeOptions, preDefinedFormat);
    // } else { //마스크텍스트박스에는 기본포맷이 없으므로
    // return $.extend(true, {}, defaultOptions, inlineOptions, codeOptions);
    // }

    return $.extend(true, {}, defaultOptions, inlineOptions, codeOptions);
  }

  /**
   * HTML 코드 상에 선언되어 있는 옵션을 가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   * @returns {object} 설정 값
   */
  function getInlineOptions($el) {
    var options = {},
      mask,
      prompt;

    if ($el) {
      if ($el.data("dews-mask")) {
        var maskFormat = $el.data("dews-mask");

        if ($el.data("dews-predefined")) {
          options.predefined = true;
        } else {
          options.predefined = false;
        }
        options.mask = maskFormat;
        if ($el.data("dews-secure-mask")) options.secureMask = $el.data("dews-secure-mask");
      }
      if ($el.data("dews-prompt")) {
        options.promptChar = $el.data("dews-prompt");
        if (!($.type(options.promptChar) === "string" && options.promptChar.length === 1)) {
          delete options.promptChar;
        }
      }
      if ($el.data("dews-unmask-on-post")) {
        options.unmaskOnPost = /true/i.test($el.data("dews-unmask-on-post"));
      }
    }

    return options;
  }

  /**
   * 컨트롤을 초기화 합니다.
   * @param {jQuery} $el 대상 요소의 jQuery객체
   * @param {object} [options] 설정 값
   */
  function initControl($el, options) {
    var wrapper = $el.closest(".k-maskedtextbox");

    if (wrapper.hasClass("dews-ui-maskedtextbox")) {
      wrapper.removeClass("dews-ui-maskedtextbox");
    }

    if (wrapper.hasClass("dews-form-control")) {
      wrapper.removeClass("dews-form-control");
    }

    if (!wrapper.hasClass("dews-maskedtextbox-wrapper")) {
      wrapper.addClass("dews-maskedtextbox-wrapper");
    }

    if ($el.attr("placeholder") && $el.data("dews-placeholder-localize-key")) {
      $el.attr(
      "placeholder",
      dews.localize.get(
      $el.attr("placeholder"),
      $el.data("dews-placeholder-localize-key"),
      $el.data("dews-placeholder-localize-lang") || null));


    }

    $el.on("focus", function (e) {
      var self = this,
        $el = $(e.target);
      if ($el.prop("readonly") === false && $el.prop("disabled") === false) {
        setTimeout(function () {
          $el.select();
        }, 50);
      }
    });

    wrapper.prepend(
    "<input type='text' class='k-formatted-value dews-ui-maskedtextbox dews-form-control k-textbox dews-control-activate' tabindex='0' style='display:inline-block;'>");

    if (options.secureMask) wrapper.find(".k-formatted-value").data("dews-secure-mask", options.secureMask);
    var secureStr = $el.val();
    if ($el.val() !== "") {
      if (options.predefined) {
        if (options.secureMask) {
          var secureMask = dews.getSecureMaskFormat(options.secureMask);
          if (secureMask) {
            secureStr = dews.string.secureMask($el.val(), options.secureMask, options.predefined);
            wrapper.find(".k-formatted-value").val(secureStr);
          }
        }
        wrapper.find(".k-formatted-value").val(secureStr);
      } else {
        if (options.secureMask) {
          var secureMask = dews.getSecureMaskFormat(options.secureMask);
          if (!secureMask) {
            if (options.secureMask.match(/[,]/g) && options.secureMask.match(/[,]/g).length > 1) {
              secureStr = dews.string.secureMask($el.val(), options.secureMask, false);
            }
          }
        }
        wrapper.find(".k-formatted-value").val(secureStr);
      }
    }

    if ($el.hasClass("readonly")) {
      wrapper.find(".k-formatted-value").addClass("readonly");
      wrapper.find(".k-formatted-value").prop("readonly", true);
    }
    if ($el.hasClass("disabled")) {
      wrapper.find(".k-formatted-value").addClass("disabled");
      wrapper.find(".k-formatted-value").prop("disabled", true);
    }
    if ($el.hasClass("required")) {
      wrapper.find(".k-formatted-value").addClass("required");
    }
    if ($el.hasClass("error")) {
      wrapper.find(".k-formatted-value").addClass("error");
    }

    // display용 보이기 위해 입력박스 숨김(초기화)
    $el.hide();

    setUserGuideAPI($el);
  }

  /**
   * 시용자 가이드를 위한 API 를 추가합니다.
   * @param $element 대상 jQuery 요소
   */
  function setUserGuideAPI($element) {
    var $wrapper = $element.closest(".k-maskedtextbox");
    var $displayInput = $wrapper.find(".k-formatted-value");

    $element.on("focus", function () {
      if (dews.ui.page && dews.ui.page.hasUserGuide) {
        if ($.isFunction(dews.ui.page.focusGuideItem) && $element.attr("id")) {
          dews.ui.page.focusGuideItem("#" + $element.attr("id"));
        }
      }
    });

    $element.on("blur", function (e) {
      if (!$(this).hasClass("readonly") && !$(this).hasClass("disabled")) {
        $element.hide();
        $displayInput.css("display", "inline-block");

        // data-dews-mask 셋팅 안했을 경우
        if (!$element.data("dews-mask")) $displayInput.val($element.data("kendoMaskedTextBox").value());
      }
    });

    $displayInput.on("focus", function () {
      if (!$(this).hasClass("readonly") && !$(this).hasClass("disabled")) {
        $element.css("display", "inline-block").focus();
        $displayInput.hide();
      }
      // PD1C-1001 마스크텍스트박스 readonly 상태일때, 드래그 안되는 현상 수정
      // 기존코드 : else {$(this).blur();} 삭제
      // initControl, readonly, enable 함수에 .k-formatted-value input 태그에 property 추가하는 코드 추가
    });
  }

  $.extend(true, dews, {
    ui: {
      /**
       * 마스크 텍스트 박스를 생성하거나 가져옵니다.
       * @param {string|jQuery} selector 마스크 텍스트 박스를 생성하거나 가져올 요소에 대한 셀렉터 또는 jQuery 객체
       * @param {object} [options] 생성 시 사용할 옵션
       */
      maskedtextbox: function maskedtextbox(selector, options) {
        var $el, textbox;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var $this = $(this),
            text,
            opt,
            $wrapper,
            value;

          text = $this.data("dews-control");
          $wrapper = $this.closest(".k-maskedtextbox");

          value = $this.val();

          if (!text) {
            opt = getOptions($this, options);

            if (!$this.hasClass("dews-ui-maskedtextbox")) {
              $this.addClass("dews-ui-maskedtextbox");
            }

            if (!$this.hasClass("dews-form-control")) {
              $this.addClass("dews-form-control");
            }

            dews.ui.util.ConvertClassAndProperty($this);

            $this.kendoMaskedTextBox(opt);
            text = $this.data("kendoMaskedTextBox");

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            initControl($this, opt);

            $this.data("dews-control", text);
          }

          textbox = text;
        });

        return textbox;
      }
    }
  });

  kendo.ui.MaskedTextBox.fn._change = function () {
    var that = this;
    var value = that.value();
    if (that.element.data("dewsControl") && value === that._emptyMask) {
      value = "";
    }
    if (value !== that._oldValue) {
      that._oldValue = value;
      that.trigger("change");
      that.element.trigger("change");
    } else if (value === "" && that.__changing) {
      that.element.trigger("change");
    }
  };

  /**
   * kendo 의 value 함수를 확장합니다.
   * @param {string} 마스크텍스트박스에 설정할 값
   */
  kendo.ui.MaskedTextBox.fn.value = function (value) {
    return function (val) {
      var self = this;
      var $element = self.element;
      var $wrapper = $element.closest(".k-maskedtextbox");
      var $secureEl = $wrapper.find(".k-formatted-value");

      if (self.element.data("dewsControl")) {
        if (arguments.length == 0 && typeof val === "undefined") {
          return $element.val();
        } else {
          if (val === undefined) val = "";
          if (val === null) val = "";

          var secureStr = dews.string.secureMask(val, $element.data("dews-mask"), false);
          var dataSecureMask = $element.data("dews-secure-mask");
          if ($element.data("dews-predefined")) {
            if (dataSecureMask) {
              var secureMask = dews.getSecureMaskFormat(dataSecureMask);
              if (secureMask) {
                secureStr = dews.string.secureMask(secureStr, dataSecureMask, true);
              }
            }
          } else {
            if (dataSecureMask) {
              var secureMask = dews.getSecureMaskFormat(dataSecureMask);
              if (!secureMask) {
                if (dataSecureMask.match(/[,]/g) && dataSecureMask.match(/[,]/g).length > 1) {
                  secureStr = dews.string.secureMask(secureStr, dataSecureMask, false);
                }
              }
            }
          }

          if (secureStr === "") secureStr = val;
          $secureEl.val(secureStr);

          value.call(self, val);
        }
      } else {
        value.call(self, val);
      }
    };
  }(kendo.ui.MaskedTextBox.fn.value);

  // dews-secure-mask 적용된 값 가져오기
  kendo.ui.MaskedTextBox.fn.text = function () {
    var self = this;
    var $element = self.element;
    var $wrapper = $element.closest(".k-maskedtextbox");
    var $secureEl = $wrapper.find(".k-formatted-value");

    var resultValue = "";
    if ($secureEl.val()) resultValue = $secureEl.val();

    return resultValue;
  };

  // readonly 함수 확장
  kendo.ui.MaskedTextBox.fn.readonly = function (readonly) {
    return function (value) {
      var self = this;
      var wrapper = self.element.closest(".k-maskedtextbox");
      var secureEl = wrapper.find(".k-formatted-value");

      if (typeof value === "undefined") {
        // 값을 반환
        return self.element.prop("readonly");
      } else {
        // 읽기전용 여부 설정
        if (value) {
          if (!self.element.hasClass("readonly")) {
            self.element.addClass("readonly");
            secureEl.addClass("readonly");
            self.element.prop("readonly", true);
            secureEl.prop("readonly", true);
          }
        } else {
          if (self.element.hasClass("readonly")) {
            self.element.removeClass("readonly");
            secureEl.removeClass("readonly");
            self.element.prop("readonly", false);
            secureEl.prop("readonly", false);
          }
        }
      }

      readonly.call(self, value);
    };
  }(kendo.ui.MaskedTextBox.fn.readonly);

  // enable 함수 확장
  kendo.ui.MaskedTextBox.fn.enable = function (enable) {
    return function (value) {
      var self = this;
      var wrapper = self.element.closest(".k-maskedtextbox");
      var secureEl = wrapper.find(".k-formatted-value");

      if (typeof value === "undefined") {
        // 값을 반환
        return !self.element.prop("disabled");
      } else {
        // 활성화 설정
        if (value) {
          if (self.element.hasClass("disabled")) {
            self.element.removeClass("disabled");
            secureEl.removeClass("disabled");
            self.element.prop("disabled", false);
            secureEl.prop("disabled", false);
          }
        } else {
          if (!self.element.hasClass("disabled")) {
            self.element.addClass("disabled");
            secureEl.addClass("disabled");
            self.element.prop("disabled", true);
            secureEl.prop("disabled", true);
          }
        }
      }

      enable.call(self, value);

      if (value) {
        if (self.element.hasClass("readonly")) {
          self.readonly(true);
        }
      }
    };
  }(kendo.ui.MaskedTextBox.fn.enable);

  /**
   * 마스크텍스트박스의 visible 여부를 가져옵니다.
   * @returns {boolean}
   * @private
   */
  kendo.ui.MaskedTextBox.fn._visibleCheckFromPanel = function () {
    var self = this,
      $ctrl = self.element;
    isVisible = $ctrl.closest(".dews-maskedtextbox-wrapper").css("display") !== "none";

    return isVisible;
  };

  kendo.ui.MaskedTextBox.fn.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change", "focus", "blur", "keyup", "keydown"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "change") {
          self.trigger(event);
        } else {
          self.element.trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  kendo.ui.MaskedTextBox.fn.on = function () {
    var self = this,
      $element = self.element;

    if (arguments[0] === "change") {
      self.bind.apply(self, arguments);
    } else {
      // kendo 이벤트가 아닌 모든 이벤트
      $element.on.apply($element, arguments);
    }
  };

  kendo.ui.MaskedTextBox.fn.off = function () {
    var self = this,
      $element = self.element;

    if (arguments[0] === "nextFocus" || arguments[0] === "beforeFocus") {
      $element.off.apply($element, arguments);
    } else {
      self.unbind.apply(self, arguments);
    }
  };

  kendo.ui.MaskedTextBox.fn.validate = function () {
    var self = this;
    return !!self.value();
  };

  /**
   * 텍스트박스를 필수입력 상태로 설정 및 해제합니다.
   * @param {jQuery} required 상태값
   */
  kendo.ui.MaskedTextBox.fn.required = function (value) {
    var self = this,
      $element = self.element;
    var $wrapper = $element.closest(".k-maskedtextbox");
    var $secureEl = $wrapper.find(".k-formatted-value");

    if ($.type(value) === "undefined") {
      return $element.hasClass("required");
    } else if (value === true) {
      $element.addClass("required");
      $secureEl.addClass("required");
    } else if (value === false) {
      $element.removeClass("required");
      $secureEl.removeClass("required");
    }
  };

  kendo.ui.MaskedTextBox.fn.bindFromPanel = function (data) {
    var self = this,
      $element = self.element;
    var column;

    if (data) {
      column = $element.data("dews-bind-column") || $element.attr("id");

      if (column && data.hasOwnProperty(column)) {
        if (typeof data[column] === "undefined" || data[column] === null) {
          data[column] = "";
        }
        self.value(data[column]);
      }
    }
  };

  kendo.ui.MaskedTextBox.fn.serializeForPanel = function () {
    var self = this,
      $element = self.element;
    var column, data;

    column = $element.data("dews-bind-column") || $element.attr("id");

    if (column) {
      data = {};
      if (self.options.unmaskOnPost) {
        data[column] = self.raw();
      } else {
        data[column] = self.value();
      }
    }

    return data;
  };

  kendo.ui.MaskedTextBox.fn.applyPanelFocus = function (requiredCheck) {
    var self = this,
      $element = self.element;
    var $wrapper = $element.closest(".k-maskedtextbox");
    var $displayInput = $wrapper.find(".k-formatted-value");

    $element.on("keydown", function (e) {
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && $element.is(":enabled")) {
        e.preventDefault();
      } else if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();

        var evt = new $.Event("beforeFocus");
        evt.control = self;

        $element.trigger(evt);
      } else if ((e.keyCode === 9 || e.keyCode === 13) && $element.is(":enabled")) {
        if (e.keyCode === 9) {
          //tab키 기본동작 막기
          e.preventDefault();
        }
        if (e.keyCode === 13 && requiredCheck && $element.hasClass("required")) {
          if (self.validate()) {
            var evt = new $.Event("nextFocus");
            evt.control = self;

            $element.trigger(evt);
          }
        } else {
          var evt = new $.Event("nextFocus");
          evt.control = self;

          $element.trigger(evt);
        }
      }
    });
  };

  kendo.ui.MaskedTextBox.fn.focus = function () {
    var self = this,
      $element = self.element;
    var $wrapper = $element.closest(".k-maskedtextbox");
    var $displayInput = $wrapper.find(".k-formatted-value");

    //$element.focus();
    $displayInput.focus();
  };

  kendo.ui.MaskedTextBox.fn.canFocusable = function () {
    var self = this,
      $element = self.element;
    var $wrapper = $element.closest(".k-maskedtextbox");
    var $displayInput = $wrapper.find(".k-formatted-value");

    return (
      !$element.hasClass("readonly") &&
      $element.closest(".k-maskedtextbox").is(":visible") &&
      $element.is(":enabled"));

  };

  /**
   * 마스크텍스트박스 컨트롤 자동화 인쇄 관련 데이터 추출
   * @return {*} 값이 설정 된 경우 Object 반환, 없는 경우 undefined 반환
   * @private
   */
  kendo.ui.MaskedTextBox.fn._getPrintData = function () {
    var self = this,
      $el = self.element,
      data;

    if (self.value()) {
      data = {
        id: $el.attr("id"),
        text: self.value()
      };
    }

    return data;
  };

  /**
   * 마스크텍스트박스 컨트롤 display none 하여 숨기는 API
   */
  kendo.ui.MaskedTextBox.fn.hide = function () {
    var self = this;

    if (!(self.wrapper.css("display") === "none")) {
      self.wrapper.css("display", "none");
    }
  };

  /**
   * 마스크텍스트박스 컨트롤 display inline-block 하여 보이도록 하는 API
   */
  kendo.ui.MaskedTextBox.fn.show = function () {
    var self = this;

    if (self.wrapper.css("display") === "none") {
      self.wrapper.css("display", "inline-block");
    }
  };

  /**
   * 마스크텍스트박스 마스크 문자열를 설정합니다.
   * @param mask 마스크 문자열
   */
  kendo.ui.MaskedTextBox.fn.setMask = function (mask) {
    var self = this;

    self.setOptions({ mask: mask });
    self.element.data("dews-mask", mask);
    self.element.attr("data-dews-mask", mask);

    self.value(self.value());
  };

  dews.ui.addControlInitializer("maskedtextbox", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.maskedtextbox($('input[type="text"].dews-ui-maskedtextbox:not(.k-formatted-value)', $container));
  });

  /**
   * 마스크텍스트박스에 값을 입력할 때 실행되는 함수입니다.
   */
  function inputChange() {
    return function (backward) {
      var self = this;
      var old = self._old;
      var element = self.element[0];
      var wrapper = self.element.closest(".k-maskedtextbox");
      var secureEl = wrapper.find(".k-formatted-value");
      var value = element.value;
      var secureStr = dews.string.secureMask(self.raw(), self.element.data("dews-mask"));
      var dataSecureMask = self.element.data("dews-secure-mask");
      if (self.element.data("dews-predefined")) {
        if (dataSecureMask) {
          var secureMask = dews.getSecureMaskFormat(dataSecureMask);
          if (secureMask) {
            secureStr = dews.string.secureMask(secureStr, dataSecureMask, true);
          }
        }
      } else {
        if (dataSecureMask) {
          var secureMask = dews.getSecureMaskFormat(dataSecureMask);
          if (!secureMask) {
            if (dataSecureMask.match(/[,]/g) && dataSecureMask.match(/[,]/g).length > 1) {
              secureStr = dews.string.secureMask(secureStr, dataSecureMask, false);
            }
          }
        }
      }
      secureEl.val(secureStr);
      var selection = kendo.caret(element);
      var cursor = selection[1];
      var lengthDiff = value.length - old.length;
      var mobile = kendo.support.mobileOS;
      if (self.__dropping && lengthDiff < 0) {
        return;
      }
      if (lengthDiff === -1 && mobile.android && mobile.browser === "chrome") {
        backward = true;
      }
      var contentStart = Math.min(cursor, stringDiffStart(value, old));
      var content = value.substring(contentStart, cursor);
      if (content === "" && !backward && !self.__delete) {
        content = value.substring(contentStart, ++cursor);
      }
      element.value = value.substring(0, contentStart) + self._emptyMask.substring(contentStart);
      var caretPos = self._mask(contentStart, cursor, content);
      var endContent = self._trimStartPromptChars(
      value.substring(cursor),
      Math.min(lengthDiff, caretPos - contentStart));

      var unmasked = self._unmask(endContent, old.length - endContent.length);
      self._mask(caretPos, caretPos, unmasked);
      if (backward) {
        caretPos = self._findCaretPosBackwards(contentStart);
      }
      kendo.caret(element, caretPos);
      self.__dropping = false;
    };
  }

  /**
   * 마스크텍스트박스의 값을 입력하기 전과 후의 문자열을 비교하여 몇 번째 자리에 값이 입력됐는지를 반환해줍니다.
   * @param str1 값 입력 후의 마스크텍스트박스의 value
   * @param str2 값 입력 전의 마스크텍스트박스의 value
   * @return {number} 몇 번째 자리에 값이 입력됐는지를 반환해줍니다.
   */
  function stringDiffStart(str1, str2) {
    var i = 0;
    while (i < str2.length) {
      if (str1[i] !== str2[i]) {
        break;
      }
      i++;
    }
    return i;
  }

  /**
   * _keydown 함수를 확장합니다.
   * @param {function} keydown Kendo UI 의 _keydown 함수
   */
  function _keydown(keydown) {
    return function (e) {
      var self = this;

      if (self.element.data("dewsControl")) {
        // window Chrome 에서 한글 입력 후 delete 키를 누르면 '-' 가 생기는 문제 때문에 추가한 코드
        self.__delete = e.keyCode === kendo.keys.DELETE;
        keydown.call(self, e);
      } else {
        keydown.call(self, e);
      }
    };
  }

  /**
   * kendo 의 raw 함수를 확장합니다.
   */
  function raw(raw) {
    return function () {
      var self = this,
        $el;

      if (self.element.data("dewsControl")) {
        $el = $(self.element);
        // data-dews-mask 가 설정돼있지 않고, 입력 값과 _unmaskedValue가 서로 다를 때
        if (
        ($el.data("dews-mask") === undefined || $el.data("dews-mask") === "") &&
        self._unmaskedValue !== self.element.val())
        {
          // data-dews-mask 가 설정되어 있지 않은 마스크텍스트박스에서 raw 함수 호출 시 빈 문자열이 나오지 않게 하기 위한 코드
          self._unmaskedValue = self.element.val();
        }

        return raw.call(self);
      } else {
        return raw.call(self);
      }
    };
  }

  kendo.ui.MaskedTextBox.fn.inputChange = inputChange(kendo.ui.MaskedTextBox.fn.inputChange);
  kendo.ui.MaskedTextBox.fn._keydown = _keydown(kendo.ui.MaskedTextBox.fn._keydown);
  kendo.ui.MaskedTextBox.fn.raw = raw(kendo.ui.MaskedTextBox.fn.raw);
})(jQuery, window.dews, window.kendo);


/*
 * 메모 박스
 */
(function ($, dews) {
  /**
   * 메모를 생성합니다.
   * @constructor
   */var
  MemoBox = /*#__PURE__*/function () {"use strict";







    function MemoBox($element, option) {_classCallCheck(this, MemoBox);_defineProperty(this, "saveMemoCallBack", []);_defineProperty(this, "grid", void 0);_defineProperty(this, "gridNoteKey", "");_defineProperty(this, "gridCode", "");_defineProperty(this, "gridNoteService", void 0);_defineProperty(this, "menuCode", dews.ui.page.menu.id);
      var self = this;

      this.gridNoteService = new GridNoteService();
      self.options = option;
      self.$element = $element;
      $element.addClass("grid-note-box");
      this.setOptions(self.options);

      self.init($element);
      this.enable(false);
    }_createClass(MemoBox, [{ key: "on", value:

      function on(type, callBack) {
        if (type === "onSavedMemo") {
          this.saveMemoCallBack.push(callBack);
        }
      } }, { key: "enable", value:

      function enable(bool) {
        var self = this;

        if (typeof bool !== "undefined") {
          if (bool) {
            // 활성화
            if (self.$element.hasClass("disabled")) {
              self.$element.removeClass("disabled");
            }
            self.$element.addClass("collapse active");
          } else {
            if (self.$element.hasClass("collapse")) {
              self.$element.removeClass("collapse");
            }
            if (self.$element.hasClass("active")) {
              self.$element.removeClass("active");
            }
            self.$element.addClass("disabled");
            self.setActiveMemo();
          }
        } else {
          return !self.$element.hasClass("disabled");
        }
      } }, { key: "init", value:

      function init($element) {
        var self = this;
        self.$content = $content();

        $element.append($title());
        $element.append(self.$content);

        self.$activeMemo = self.addMemo();
        self.$content.append(self.$activeMemo);

        self.addBtn = dews.ui.button($(".dews-ui-button.ico-add", $element));
        self.textbox = dews.ui.textbox($(".dews-ui-textbox", self.$activeMemo));
        self.textbox.setMaxLength(200);
        self.file = dews.ui.file($(".dews-ui-file", self.$activeMemo));

        self.textbox.on("keyup", function () {
          changeLength();
        });

        self.addBtn.on("click", function () {
          self.$activeMemo.siblings(".memo:not(.active)").each(function (idx, item) {
            var $item = $(item);
            if ($item.hasClass("open")) {
              $item.removeClass("open");
            }
            $item.css("display", "flex");
            $item.removeClass("editing");
            self.$content.append(self.$activeMemo);
            self.$activeMemo.css("display", "none");
          });
          self.setActiveMemo();
          self.$content.prepend(self.$activeMemo);
          self.$activeMemo.css("display", "block");
          self.setHeight();
        });

        function changeLength() {
          var $length = self.textbox.element.siblings(".memo-text-length").children(".length");
          var text = self.textbox.text();
          $length.text(text.length);
        }

        function $title() {
          var $title = $("<div class=\"title\">\n                <h2>\uBA54\uBAA8</h2>\n                <button class=\"dews-ui-button ico-add\"></button>\n                <button class=\"title-collapse\"></button>\n            </div>");





          $($title).on("click", function (e) {
            if (self.enable()) {
              if ($element.hasClass("collapse")) {
                if (!$(e.target).hasClass("ico-add")) {
                  $(".content", $element).css("height", 0);
                  $element.removeClass("collapse");
                  $element.removeClass("active");
                }
              } else {
                $element.addClass("collapse");
                $element.addClass("active");
                self.setHeight();
              }
            }
          });

          return $title;
        }

        function $content() {
          return $("<div class='content'></div>");
        }
      } }, { key: "setOptions", value:

      function setOptions(option) {
        var self = this;

        self.options = $.extend({}, self.options, option);
      }

      /**
       * ERP 10 메인에서 Memo 렌더하는 함수
       * @param grid
       * @param key
       * @param data
       */ }, { key: "searchData", value:
      function searchData(grid, key, data) {
        this.render(grid, key, data);
      } }, { key: "render", value:

      function render(grid, key, data) {
        var self = this;
        this.grid = grid;

        if (key) {
          this.gridNoteKey = key.gridNoteKey || "";
          this.gridCode = key.gridCode || "";
          this.menuCode = key.menuCode || "";
        }

        if (this.grid.options.note && this.gridNoteKey) {var _data$noteList;
          var list = (_data$noteList = data.noteList) === null || _data$noteList === void 0 ? void 0 : _data$noteList.filter(function (note) {
            return note.noteText;
          });
          this.enable(true);
          self.setData(list);
        } else {
          this.enable(false);
        }
      }

      // 메모 조회 후 render
    }, { key: "searchMemo", value: function searchMemo(grid, data, force) {
        var $dfd = $.Deferred();
        var self = this;
        this.grid = grid;
        if (this.grid.options.note) {
          this.enable(true);

          if (force || data.gridNoteKey !== this.gridNoteKey) {
            if (data) {
              this.gridNoteKey = data.gridNoteKey || "";
              this.gridCode = data.gridCode || "";
              this.menuCode = data.menuCode || "";
            }

            this.gridNoteService.getNoteList(this.gridNoteKey, this.gridCode, this.menuCode).done(function (list) {
              $dfd.resolve(list);
              self.setData(list);
            });
          }
        } else {
          this.enable(false);
        }

        return $dfd;
      }

      /**
       * 메모에 데이터 바인딩
       * @param data
       */ }, { key: "setData", value:
      function setData(data) {
        var self = this;
        var $memos = $(".memo:not(.active)", self.$content);

        self.enable(true);
        $memos.remove();
        self.setActiveMemo();

        if (data) {
          data.forEach(function (memo) {
            var list = {
              id: memo.insertId || "",
              name: memo.insertName || "",
              dutyName: memo.insertDuty || "",
              content: memo.noteText || "",
              date: memo.updateDts || "",
              fileKey: memo.noteFileDc || "",
              fileName: memo.orglFileDc || "",
              fileExt: memo.orglFextsnDc || "",
              memoKey: memo.noteCode || ""
            };

            var $memo = self.addMemo(list, false);
            self.$content.append($memo);
            $(".memo-text-view", $memo).html(getText(list.content));
            $(".memo-text-view", $memo).data("original-content", list.content);
            dews.ui.file($(".dews-ui-file", $memo));
          });
          self.$content.append(self.$activeMemo);

          if (data.length > 0) {
            self.$activeMemo.css("display", "none");
          } else {
            self.$activeMemo.css("display", "block");
          }
        } else {
          self.$activeMemo.css("display", "block");
        }

        self.setHeight();

        function getText(str) {
          var val = str.replaceAll(/(?:\r\n|\r|\n)/g, "<br/>");
          val = val.replaceAll(/ /g, "&nbsp;");
          val = val.replaceAll("(?i)javascript", "");
          val = val.replaceAll("(?i)script", "");
          val = val.replaceAll("\x3cscript", "");
          val = val.replaceAll("&lt;script", "");
          val = val.replaceAll("(?i)iframe", "");
          val = val.replaceAll("\x3ciframe", "");
          val = val.replaceAll("&lt;iframe", "");

          return val;
        }
      } }, { key: "setActiveMemo", value:

      function setActiveMemo(info) {var _self$textbox3;
        var self = this;
        if (info) {var _self$textbox;
          var value = info.content;
          (_self$textbox = self.textbox) === null || _self$textbox === void 0 ? void 0 : _self$textbox.text(value);
          if (info.file) {var _self$file;
            (_self$file = self.file) === null || _self$file === void 0 ? void 0 : _self$file.setFile(info.file);
            self.$activeMemo.addClass("file");
          } else {var _self$file2;
            (_self$file2 = self.file) === null || _self$file2 === void 0 ? void 0 : _self$file2.deleteFile();
          }
          self.$activeMemo.css("display", "block");
          self.$activeMemo.data("memo-key", info.memoKey);

          $(".delete", self.$activeMemo).css("display", "inline-block");
        } else {var _self$textbox2, _self$file3;
          // Actvie 메모 초기화
          (_self$textbox2 = self.textbox) === null || _self$textbox2 === void 0 ? void 0 : _self$textbox2.text("");
          (_self$file3 = self.file) === null || _self$file3 === void 0 ? void 0 : _self$file3.deleteFile();
          if (self.$activeMemo.hasClass("file")) {
            self.$activeMemo.removeClass("file");
          }
          self.$activeMemo.removeData("memo-key");
          self.$activeMemo.css("display", "none");
          $(".delete", self.$activeMemo).css("display", "none");
          self.$content.append(self.$activeMemo);
        }
        (_self$textbox3 = self.textbox) === null || _self$textbox3 === void 0 ? void 0 : _self$textbox3.raiseEvent("keyup");
      } }, { key: "setHeight", value:

      function setHeight(height) {
        var self = this;
        var $element = self.$element;

        if (height) {
          $(".content", $element).css("height", height);
        } else {
          var _height = 0;
          var $memo = $(".memo", $element);

          $memo.each(function (idx, item) {
            var $item = $(item);
            if ($item.css("display") !== "none") {
              _height += $item.outerHeight(true);
            }
          });

          $(".content", $element).css("height", _height);
        }
      } }, { key: "addMemo", value:

      function addMemo(list, open) {
        var self = this;
        var user = dews.ui.page.user;
        var dutyName = (user === null || user === void 0 ? void 0 : user.dutyName) || (user === null || user === void 0 ? void 0 : user.gradeName) || "";
        var active = !list;
        var data = {
          id: user === null || user === void 0 ? void 0 : user.userid,
          name: user === null || user === void 0 ? void 0 : user.username,
          dutyName: dutyName,
          content: "",
          fileKey: "",
          fileName: "",
          fileExt: "",
          noteCode: ""
        };

        data = $.extend(data, list);
        //ToDo
        // 이름으로 변경 username
        var editable = data.id === user.userid;

        var $memo = $("\n                <div class=\"memo\n                    ".concat(

        active ? "active open" : "", "\n                    ").concat(
        open ? "open" : "", "\n                    ").concat(
        editable ? "editable" : "", "\n                    ").concat(
        data.fileKey ? "file" : "", "\"\n                    ").concat(
        data.memoKey ? "data-memo-key=\"".concat(data.memoKey, "\"") : "", ">\n                ").concat(
        memoInfo(data, editable, active), "\n                ").concat(
        text(data, active), "\n                ").concat(
        file(data, active), "\n            </div>"));


        $memo.on("click", function (e) {
          var $this = $(this);
          var $target = $(e.target);

          if ($target.hasClass("delete") || $target.hasClass("save")) {
          } else if ($this.hasClass("active")) {
          } else {
            $this.siblings(".memo:not(.active)").each(function (idx, item) {
              var $item = $(item);
              if ($item.hasClass("open")) {
                $item.removeClass("open");
              }
              $item.removeClass("editing");
              $item.css("display", "flex");
              self.$content.append(self.$activeMemo);
              self.$activeMemo.css("display", "none");
            });
            $this.addClass("open");
          }
          self.setHeight();
        });

        // 삭제 버튼
        $(".delete", $memo).on("click", function (e) {
          var key = $memo.data("memo-key");
          var gridNoteModelList = [];
          var model = {
            gridNoteKey: self.gridNoteKey,
            gridCode: self.gridCode,
            menuCode: self.menuCode,
            noteCode: key
          };
          gridNoteModelList.push(model);

          dews.confirm("등록된 메모를 삭제하시겠습니까?").
          yes(function () {
            self.gridNoteService.deleteNote(gridNoteModelList).done(function () {
              self.searchMemo(
              self.grid,
              {
                gridNoteKey: self.gridNoteKey,
                gridCode: self.gridCode,
                menuCode: self.menuCode
              },
              true).
              done(function (data) {var _self$saveMemoCallBac;
                var state = "empty";
                state = (data === null || data === void 0 ? void 0 : data.length) > 0 ? "new" : "empty";
                (_self$saveMemoCallBac = self.saveMemoCallBack) === null || _self$saveMemoCallBac === void 0 ? void 0 : _self$saveMemoCallBac.forEach(function (callBack) {
                  callBack.call(self, state);
                });
              });
            });
          }).
          no(function () {

            // 취소 버튼 클릭 시 수행할 코드 작성
          });});

        // 저장 버튼
        $(".save", $memo).on("click", function () {
          var $memo = $(".memo:not(.active)", self.$element);
          var $editMemo = $(".memo.editing", self.$element);
          var content = self.textbox.text();
          var grid = self.grid;
          var memoKey = $editMemo.data("memo-key");

          if ((grid === null || grid === void 0 ? void 0 : grid.getRowState(grid === null || grid === void 0 ? void 0 : grid.select())) !== "added") {
            if ($memo.length < 20) {
              if (content) {
                var fileInfo = self.file.getFile();
                var model = {
                  gridNoteKey: self.gridNoteKey,
                  gridCode: self.gridCode,
                  menuCode: self.menuCode,
                  noteCode: memoKey,
                  noteText: content,
                  fileDc: fileInfo !== null && fileInfo !== void 0 && fileInfo.fileKey ?
                  fileInfo.fileKey :
                  self.$activeMemo.hasClass("file") ?
                  "" :
                  undefined,
                  orglFileDc: (fileInfo === null || fileInfo === void 0 ? void 0 : fileInfo.filename) || "", // 파일 추가
                  fileSize: (fileInfo === null || fileInfo === void 0 ? void 0 : fileInfo.size) || "",
                  orglFextsnDc: (fileInfo === null || fileInfo === void 0 ? void 0 : fileInfo.extension) || ""
                };

                self.gridNoteService.saveNote(model).done(function () {
                  self.searchMemo(
                  self.grid,
                  {
                    gridNoteKey: self.gridNoteKey,
                    gridCode: self.gridCode,
                    menuCode: self.menuCode
                  },
                  true).
                  done(function (data) {var _self$saveMemoCallBac2;
                    var state = data.length > 0 ? "new" : "empty";
                    (_self$saveMemoCallBac2 = self.saveMemoCallBack) === null || _self$saveMemoCallBac2 === void 0 ? void 0 : _self$saveMemoCallBac2.forEach(function (callBack) {
                      callBack.call(self, state);
                    });
                  });
                });
              } else {
                dews.alert("내용을 입력하세요", "error");
              }
            } else {
              dews.ui.snackbar.warning("메모는 20개 까지 저장할 수 있습니다.");
            }
          } else {
            dews.ui.snackbar.warning("저장되지 않은 정보가 있습니다.");
          }
        });

        // 메모 열기
        $(".memo-text-view", $memo).on("dblclick", function (e) {
          var $this = $(this);
          var $memo = $this.closest(".memo");
          if ($memo.hasClass("editable") && $memo.hasClass("open")) {
            e.stopPropagation();

            var _file = $(".dews-ui-file", $memo).data("dews-control");

            var info = {
              content: $this.data("original-content"),
              file: _file === null || _file === void 0 ? void 0 : _file.getFile(),
              memoKey: $memo.data("memo-key")
            };
            self.setActiveMemo(info);
            $memo.before(self.$activeMemo);
            $memo.addClass("editing");
            $memo.css("display", "none");
          }

          self.setHeight();
        });

        function memoInfo(user, edit, active) {
          return "<div class=\"memo-info\">\n                <div class=\"memo-info-text\">\n                    <span class=\"name\">".concat(

          user.name, " ").concat(user.dutyName, "</span>\n                    <span class=\"date\">").concat(

          user.date ? dews.date.format(new Date(user.date)) : dews.date.format(new Date()), "</span>\n                </div>\n                <div class=\"memo-buttons\">\n                ").concat(



          edit ? "<button class=\"delete\" ".concat(active ? "style=\"display:none\"" : "", "></button>") : "", "\n                ").concat(
          active ? "<button class =\"save\"></button>" : "", "\n                </div>\n            </div>");


        }

        function file(data, active) {
          var name = "",
            ext = "";
          if (data.fileKey) {
            var arrFileName = data.fileName.split(".");
            name = arrFileName[0];
            ext = data.fileExt || arrFileName[1] || "";
          }

          var wrapper = "<div class=\"memo-file\">\n                <input type=\"file\" class=\"dews-ui-file\"\n                 ".concat(

          data.fileKey ? "data-dews-file-key=\"".concat(data.fileKey, "\"") : "", "\n                 ").concat(
          data.fileName ? "data-dews-filename=\"".concat(name, ".").concat(ext, "\"") : "", "\n                 data-dews-upload-use=\"").concat(
          active ? "true" : "false", "\">\n                </div>");


          if (active) {
            return wrapper;
          } else if (data.fileKey) {
            return wrapper;
          } else {
            return "";
          }
        }

        function text(data, active) {
          var content = data.content || "";
          var length = content.replaceAll("<br>", " ").length;
          var editable = data.name === dews.ui.page.user.userid;
          var wrapper = "<div class=\"memo-text ".concat(editable ? "editable" : "", "\">\n                ").concat(

          active ? "<textarea class=\"dews-ui-textbox\" placeholder=\"\uBA54\uBAA8\uB97C \uC785\uB825\uD558\uC138\uC694.\">".concat(

          content ? content : "", "</textarea>") : "", "\n                ").concat(



          active ? "" : "<div class=\"memo-text-view\"></div>", "\n                        <div class=\"memo-text-length\">\n                        (<span class=\"length\">").concat(

          length, "</span>/200)\n                        </div>\n                    </div>");



          return wrapper;
        }

        return $memo;
      } }]);return MemoBox;}();


  dews = $.extend(true, dews, {
    ui: {
      memoBox: function memoBox(selector, options) {
        var $control, box;

        if (selector instanceof jQuery) {
          $control = selector;
        } else if ($.type(selector) === "string") {
          $control = $(selector);
        } else {
          throw "대상이 지정되지 않았습니다.";
        }

        $control.each(function () {
          var $this = $(this),
            memo;

          memo = $this.data("dews-control");

          if (!memo) {
            memo = new MemoBox($this, options);
            $this.data("dews-control", memo);

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }
          }

          box = memo;
        });
        return box;
      }
    }
  });
})(jQuery, window.dews || {});


/**
 * 월기간피커
 * Created by yejin on 2017. 6. 22..
 */

(function ($, dews, kendo) {
  var defaultOptions = {
    startDate: null,
    endDate: null,
    max: 9999,
    min: 1000
  };

  function getOptions($el, srcOptions) {
    var inlineOptions,
      preDefinedFormat,
      options = {
        format: dews._environments.formats.monthFormat,
        valueFormat: dews._environments.formats.monthValueFormat
      };

    inlineOptions = getInlineOptions($el);
    if (srcOptions) {
      srcOptions.format ? $el.data("dews-format", srcOptions.format) : "";
      srcOptions.predefined ? $el.data("dews-format-predefined", srcOptions.predefined) : "";
    }
    preDefinedFormat = dews.getPreDefinedFormat($el);

    if (preDefinedFormat) {
      var vf = preDefinedFormat.replace(/[^(a-z)]/gi, "");
      preDefinedFormat = {
        format: preDefinedFormat
      };
      options = $.extend(true, options, defaultOptions, inlineOptions, srcOptions, preDefinedFormat);
    } else if (preDefinedFormat !== false && inlineOptions) {
      options = $.extend(true, options, defaultOptions, inlineOptions, srcOptions);
    } else {
      if (srcOptions !== undefined) {
        srcOptions.format =
        preDefinedFormat === false && srcOptions.format && srcOptions.predefined === true ?
        defaultOptions.format :
        srcOptions.format;
      }
      options = $.extend(true, options, defaultOptions, srcOptions);
    }

    if ($el.val()) {
      options.value = kendo.parseDate($el.val(), dews._environments.formats.monthValueFormat, kendo.getCulture());
    }

    return options;
  }

  /**
   * HTML 태그에 지정된 옵션을 가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   * @returns {object} 옵션
   */
  function getInlineOptions($el) {
    var options = {};

    if ($el.data("dews-format")) {
      //개발자가 기본으로 지정된 포맷(yyyy-MM)말고 다른 포맷을 지정하고 싶을때
      options.format = $el.data("dews-format");
    }
    if ($el.data("dews-start-date")) {
      options.startDate = $el.data("dews-start-date");
    }
    if ($el.data("dews-end-date")) {
      options.endDate = $el.data("dews-end-date");
    }
    return options;
  }

  var MonthPeriodPicker = function MonthPeriodPicker(element, options) {
    var self = this,
      $element = element;
    var thisYear = new Date().getYear() + 1900;

    self.options = getOptions($element, options);

    self._wrapper = null;
    self._startInput = null;
    self._endInput = null;
    self._calenderButton = null;
    self._hiddenArea = null;
    self._buttons = null;
    self._buttons2 = null;
    self.okButton = null;
    self.option = null;
    self.oneQuearterButton = null;
    self.twoQuearterButton = null;
    self.threeQuearterButton = null;
    self.fourQuearterButton = null;
    self.firstHalfButton = null;
    self.secondHalfButton = null;
    self.disableButton = false;
    self._thisYear = thisYear;

    self._element = $element;
  };

  MonthPeriodPicker.prototype._createWrapper = function () {
    var self = this,
      $el = self._element,
      $wrapper,
      width;

    $wrapper = $("<span/>").
    addClass("dews-monthperiodpicker-wrapper").
    addClass("k-picker-wrap").
    addClass("k-state-default");

    if ($el.attr("style")) {
      var matches = $el.attr("style").match(/width:([^;]+);?/i);

      if (matches) {
        width = $.trim(matches[1]);
        $el.css("width", width);
        $wrapper.width("100%");
      }
    }

    if ($el.hasClass("readonly")) {
      $wrapper.addClass("dews-state-readonly");
      self.disableButton = true;
    }
    if ($el.hasClass("disabled")) {
      $wrapper.addClass("dews-state-disabled");
      self.disableButton = true;
    }
    if ($el.hasClass("required")) {
      $wrapper.addClass("dews-state-required");
    }

    // if ($wrapper.width() < 142) {
    //     $wrapper.width(142);
    // }

    self._wrapper = $wrapper;
    $el.append($wrapper);
  };

  // 시작날짜 텍스트박스 생성
  MonthPeriodPicker.prototype._createStartInput = function () {
    var self = this,
      $el = self._element,
      $startInput,
      opt;

    $startInput = $("<input/>").addClass(
    "dews-monthperiodpicker-input dews-monthperiodpicker-startDate k-textbox k-space-right");


    if ($el.hasClass("readonly")) {
      $startInput.addClass("dews-state-readonly");
      $startInput.attr("readonly", "readonly");
    }
    if ($el.hasClass("disabled")) {
      $startInput.addClass("dews-state-disabled");
      $startInput.attr("disabled", "disabled");
    }
    if ($el.hasClass("required")) {
      $startInput.addClass("dews-state-required");
    }

    opt = self.options;

    setMask($startInput, opt.format);
    setEvent($startInput, opt);

    self._wrapper.append($startInput);
    self._startInput = $startInput;
  };

  // 종료날짜 텍스트박스 생성
  MonthPeriodPicker.prototype._createEndInput = function () {
    var self = this,
      $el = self._element,
      $endInput,
      $span,
      opt;

    $endInput = $("<input/>").addClass(
    "dews-monthperiodpicker-input dews-monthperiodpicker-endDate k-textbox k-space-right");

    $span = $("<span>~</span>").addClass("dews-monthperiodpicker-span");

    if ($el.hasClass("readonly")) {
      $endInput.addClass("dews-state-readonly");
      $endInput.attr("readonly", "readonly");
    }
    if ($el.hasClass("disabled")) {
      $endInput.addClass("dews-state-disabled");
      $endInput.attr("disabled", "disabled");
    }
    if ($el.hasClass("required")) {
      $endInput.addClass("dews-state-required");
    }

    opt = self.options;

    setMask($endInput, opt.format);
    setEvent($endInput, opt);

    self._wrapper.append($span);
    self._wrapper.append($endInput);
    self._endInput = $endInput;
  };

  // 달력버튼 생성
  MonthPeriodPicker.prototype._createCalendarButton = function () {
    var self = this,
      $calendarButton,
      $img;

    $calendarButton = $("<span/>").addClass("k-select");
    $img = $("<span/>").addClass("k-icon k-i-calendar");

    self._wrapper.append($calendarButton);
    $calendarButton.append($img);
    self._calenderButton = $calendarButton;
  };

  // 숨겨진 영역 생성
  MonthPeriodPicker.prototype._createHiddenArea = function () {
    var self = this,
      $el = self._element,
      $hiddenArea;

    $hiddenArea = $("<div/>").addClass("dews-monthperiodpicker-calendars");

    $(document.body).append($hiddenArea);
    self._hiddenArea = $hiddenArea;
  };

  // 월 버튼 영역 생성
  MonthPeriodPicker.prototype._createMonthButtonArea = function () {
    var self = this,
      $option;

    $option = $("<div/>").addClass("dews-monthperiodpicker-option");

    self._hiddenArea.empty().append($option);
    self.option = $option;
  };

  // 버튼 생성
  MonthPeriodPicker.prototype._createButtons = function () {
    var self = this,
      $oneQuearterButton,
      $twoQuearterButton,
      $threeQuearterButton,
      $fourQuearterButton,
      $firstHalfButton,
      $secondHalfButton,
      $thisYearButton,
      $januaryButton,
      $februaryButton,
      $marchButton,
      $aprilButton,
      $mayButton,
      $juneButton,
      $julyButton,
      $augustButton,
      $septemberButton,
      $octoberButton,
      $novemberButton,
      $decemberButton;

    $oneQuearterButton = $(
    "<button type='button'>" + dews.localize.get("1/4분기", "dews_1/4분기") + "</button>").
    addClass("dews-monthperiod-button dews-monthperiod-quearter dews-monthperiod-onequearter");
    $twoQuearterButton = $(
    "<button type='button'>" + dews.localize.get("2/4분기", "dews_2/4분기") + "</button>").
    addClass("dews-monthperiod-button dews-monthperiod-quearter dews-monthperiod-twoquearter");
    $threeQuearterButton = $(
    "<button type='button'>" + dews.localize.get("3/4분기", "dews_3/4분기") + "</button>").
    addClass("dews-monthperiod-button dews-monthperiod-quearter dews-monthperiod-threequearter");
    $fourQuearterButton = $(
    "<button type='button'>" + dews.localize.get("4/4분기", "dews_4/4분기") + "</button>").
    addClass("dews-monthperiod-button dews-monthperiod-quearter dews-monthperiod-fourquearter");
    $firstHalfButton = $(
    "<button type='button'>" + dews.localize.get("상반기", "dews_상반기") + "</button>").
    addClass("dews-monthperiod-button dews-monthperiod-half dews-monthperiod-onehalf");
    $secondHalfButton = $(
    "<button type='button'>" + dews.localize.get("하반기", "dews_하반기") + "</button>").
    addClass("dews-monthperiod-button dews-monthperiod-half dews-monthperiod-twohalf");
    $thisYearButton = $("<button type='button'>" + dews.localize.get("올해", "dews_올해") + "</button>").addClass(
    "dews-monthperiod-button dews-monthperiod-year dews-monthperiod-thisyear");


    $januaryButton = $("<button type='button'>" + dews.localize.get("1월", "dews_1월") + "</button>").addClass(
    "dews-monthperiod-button dews-monthperiod-months dews-monthperiod-january");

    $februaryButton = $("<button type='button'>" + dews.localize.get("2월", "dews_2월") + "</button>").addClass(
    "dews-monthperiod-button dews-monthperiod-months dews-monthperiod-february");

    $marchButton = $("<button type='button'>" + dews.localize.get("3월", "dews_3월") + "</button>").addClass(
    "dews-monthperiod-button dews-monthperiod-months dews-monthperiod-march");

    $aprilButton = $("<button type='button'>" + dews.localize.get("4월", "dews_4월") + "</button>").addClass(
    "dews-monthperiod-button dews-monthperiod-months dews-monthperiod-april");

    $mayButton = $("<button type='button'>" + dews.localize.get("5월", "dews_5월") + "</button>").addClass(
    "dews-monthperiod-button dews-monthperiod-months dews-monthperiod-may");

    $juneButton = $("<button type='button'>" + dews.localize.get("6월", "dews_6월") + "</button>").addClass(
    "dews-monthperiod-button dews-monthperiod-months dews-monthperiod-june");

    $julyButton = $("<button type='button'>" + dews.localize.get("7월", "dews_7월") + "</button>").addClass(
    "dews-monthperiod-button dews-monthperiod-months dews-monthperiod-july");

    $augustButton = $("<button type='button'>" + dews.localize.get("8월", "dews_8월") + "</button>").addClass(
    "dews-monthperiod-button dews-monthperiod-months dews-monthperiod-august");

    $septemberButton = $("<button type='button'>" + dews.localize.get("9월", "dews_9월") + "</button>").addClass(
    "dews-monthperiod-button dews-monthperiod-months dews-monthperiod-september");

    $octoberButton = $("<button type='button'>" + dews.localize.get("10월", "dews_10월") + "</button>").addClass(
    "dews-monthperiod-button dews-monthperiod-months dews-monthperiod-october");

    $novemberButton = $("<button type='button'>" + dews.localize.get("11월", "dews_11월") + "</button>").addClass(
    "dews-monthperiod-button dews-monthperiod-months dews-monthperiod-november");

    $decemberButton = $("<button type='button'>" + dews.localize.get("12월", "dews_12월") + "</button>").addClass(
    "dews-monthperiod-button dews-monthperiod-months dews-monthperiod-december");


    if (dews.localize.getLanguage() === "en") {
      $(".dews-monthperiod-button").css({
        "letter-spacing": "-1px",
        "font-weight": "200"
      });
    }
    self.option.
    append($oneQuearterButton).
    append($twoQuearterButton).
    append($threeQuearterButton).
    append($fourQuearterButton);
    self.option.append($firstHalfButton).append($secondHalfButton).append($thisYearButton);
    self.option.append($januaryButton).append($februaryButton).append($marchButton).append($aprilButton);
    self.option.append($mayButton).append($juneButton).append($julyButton).append($augustButton);
    self.option.append($septemberButton).append($octoberButton).append($novemberButton).append($decemberButton);

    self.oneQuearterButton = $oneQuearterButton;
    self.twoQuearterButton = $twoQuearterButton;
    self.threeQuearterButton = $threeQuearterButton;
    self.fourQuearterButton = $fourQuearterButton;
    self.firstHalfButton = $firstHalfButton;
    self.secondHalfButton = $secondHalfButton;
    self.thisYearButton = $thisYearButton;

    self.januaryBtn = $januaryButton;
    self.februaryBtn = $februaryButton;
    self.marchBtn = $marchButton;
    self.aprilBtn = $aprilButton;
    self.mayBtn = $mayButton;
    self.juneBtn = $juneButton;
    self.julyBtn = $julyButton;
    self.augustBtn = $augustButton;
    self.septemberBtn = $septemberButton;
    self.octoberBtn = $octoberButton;
    self.novemberBtn = $novemberButton;
    self.decemberBtn = $decemberButton;
  };

  //선택한 기간, 적용하기 버튼 영역 생성
  MonthPeriodPicker.prototype._createOkButtonArea = function () {
    var self = this,
      $buttons,
      $buttons2;

    $buttons = $("<div/>").addClass("dews-monthperiodpicker-buttons");
    $buttons2 = $("<div/>").addClass("dews-monthperiodpicker-buttons2");

    self._hiddenArea.append($buttons).append($buttons2);
    self._buttons = $buttons;
    self._buttons2 = $buttons2;
  };

  //숫자텍스박스 생성
  MonthPeriodPicker.prototype._createNumericTextBox = function () {
    var self = this,
      $firstYear,
      $secondYear,
      $firstMonth,
      $secondMonth,
      $periodSelect;

    $periodSelect = $("<p>" + dews.localize.get("선택 기간", "dews_선택 기간") + " :<br/></p>").addClass(
    "dews-monthperiodpicker-periodSelect");

    $firstYear = $("<input type='text' data-dews-spinners='true' max='9999' data-dews-format='#'/>").addClass(
    "dews-ui-numerictextbox dews-monthperiodpicker-firstyear");

    $firstMonth = $(
    "<input type='text' data-dews-spinners='true' max='12' min='1' data-dews-format='#'/>").
    addClass("dews-ui-numerictextbox dews-monthperiodpicker-firstmonth");
    $secondYear = $("<input type='text' data-dews-spinners='true' max='9999' data-dews-format='#'/>").addClass(
    "dews-ui-numerictextbox dews-monthperiodpicker-secondyear");

    $secondMonth = $(
    "<input type='text' data-dews-spinners='true' max='12' min='1' data-dews-format='#'/>").
    addClass("dews-ui-numerictextbox dews-monthperiodpicker-secondmonth");

    self._buttons.
    append($periodSelect).
    append($firstYear).
    append("<span class='dews-monthperiodpicker-year'>" + dews.localize.get("년", "dews_년yr") + "</span>").
    append($firstMonth).
    append("<span  class='dews-monthperiodpicker-month'>" + dews.localize.get("월", "dews_월mo") + "</span>").
    append("<span class=dews-monthperiodpicker-period>~</span>").
    append($secondYear).
    append("<span class='dews-monthperiodpicker-year'>" + dews.localize.get("년", "dews_년yr") + "</span>").
    append($secondMonth).
    append("<span  class='dews-monthperiodpicker-month'>" + dews.localize.get("월", "dews_월mo") + "</span>");

    self.firstYear = dews.ui.numerictextbox($firstYear);
    self.firstMonth = dews.ui.numerictextbox($firstMonth);
    self.secondYear = dews.ui.numerictextbox($secondYear);
    self.secondMonth = dews.ui.numerictextbox($secondMonth);
  };

  //적용하기 버튼 생성
  MonthPeriodPicker.prototype._createOkButton = function () {
    var self = this,
      $okButton;

    $okButton = $("<button type='button'>" + dews.localize.get("적용하기", "dews_적용하기") + "</button>").addClass(
    "dews-ui-button small primary dews-monthperiodpicker-ok k-button");


    self._buttons2.append($okButton);
    self.okButton = $okButton;
  };

  MonthPeriodPicker.prototype._setNumericTextBoxValue = function (startY, startM, lastY, lastM) {
    var self = this;

    self.firstYear.value(startY);
    self.firstMonth.value(startM);
    self.secondYear.value(lastY);
    self.secondMonth.value(lastM);
  };

  // 컨트롤 초기화
  MonthPeriodPicker.prototype._initControl = function () {
    var self = this;

    self._createWrapper();
    self._createStartInput();
    self._createEndInput();
    self._createCalendarButton();
    self._createHiddenArea();
    self._createMonthButtonArea();
    self._createButtons();
    self._createOkButtonArea();
    self._createNumericTextBox();
    self._createOkButton();
    self._setNumericTextBoxValue();
    self._bindEvents();

    self.setUserGuideAPI();
  };

  //시작날짜 설정 함수
  MonthPeriodPicker.prototype.setStartDate = function (value) {
    var self = this;

    if (value === "") {
      self._startInput.attr("val", "");
      self._startInput.val("");
    } else if (!isNaN(value)) {
      var newDate, startYear, startMonth;
      if ($.type(value) === "date") {
        newDate = value;
        startYear = newDate.getFullYear();
        startMonth =
        newDate.getMonth() + 1 > 10 ? newDate.getMonth() + 1 : "0" + (newDate.getMonth() + 1).toString();
      } else {
        var dateValue = value.toString();
        newDate = kendo.parseDate(dateValue, dews._environments.formats.monthValueFormat, kendo.getCulture());
        startYear = newDate.getFullYear();
        startMonth = newDate.getMonth() + 1;
      }

      dateValue = kendo.toString(newDate, self.options.format, kendo.getCulture());

      if (self._endInput.val() && self._endInput.val() < dateValue) {
        self._startInput.attr("val", "");
        self._startInput.val("");
      } else {
        self.firstYear.value(startYear);
        self.firstMonth.value(startMonth);

        self._startInput.attr("val", dateValue);
        self._startInput.val(dateValue);
      }
    }
  };

  //종료날짜 설정 함수
  MonthPeriodPicker.prototype.setEndDate = function (value) {
    var self = this;

    if (value === "") {
      self._endInput.attr("val", "");
      self._endInput.val("");
    } else if (!isNaN(value)) {
      var newDate, endYear, endMonth;
      if ($.type(value) === "date") {
        newDate = value;
        endYear = newDate.getFullYear();
        endMonth =
        newDate.getMonth() + 1 > 10 ? newDate.getMonth() + 1 : "0" + (newDate.getMonth() + 1).toString();
      } else {
        var dateValue = value.toString();
        newDate = kendo.parseDate(dateValue, dews._environments.formats.monthValueFormat, kendo.getCulture());
        endYear = newDate.getFullYear();
        endMonth = newDate.getMonth() + 1;
      }
      dateValue = kendo.toString(newDate, self.options.format, kendo.getCulture());

      if (self._startInput.val() && self._startInput.val() > dateValue) {
        self._endInput.attr("val", "");
        self._endInput.val("");
      } else {
        self.secondYear.value(endYear);
        self.secondMonth.value(endMonth);

        self._endInput.attr("val", dateValue);
        self._endInput.val(dateValue);
      }
    }
  };

  //시작날짜 가져오는 함수(포맷 지정된 값)
  MonthPeriodPicker.prototype.getStartText = function () {
    var self = this,
      date;

    if (self._startInput.val()) {
      date = kendo.parseDate(self._startInput.val(), self.options.format, kendo.getCulture());
      return kendo.toString(date, dews._environments.formats.monthFormat, kendo.getCulture()) || "";
    } else {
      return "";
    }
  };

  //종료날짜 가져오는 함수(포맷 지정된 값)
  MonthPeriodPicker.prototype.getEndText = function () {
    var self = this,
      date;

    if (self._endInput.val()) {
      date = kendo.parseDate(self._endInput.val(), self.options.format, kendo.getCulture());
      return kendo.toString(date, dews._environments.formats.monthFormat, kendo.getCulture()) || "";
    } else {
      return "";
    }
  };

  //시작날짜 가져오는 함수(포맷 지정되지 않은 값)
  MonthPeriodPicker.prototype.getStartDate = function () {
    var self = this,
      date;

    if (self._startInput.val()) {
      date = kendo.parseDate(self._startInput.val(), self.options.format, kendo.getCulture());
      return kendo.toString(date, dews._environments.formats.monthValueFormat, kendo.getCulture()) || "";
    } else {
      return "";
    }
  };

  //종료날짜 가져오는 함수(포맷 지정되지 않은 값)
  MonthPeriodPicker.prototype.getEndDate = function () {
    var self = this,
      date;

    if (self._endInput.val()) {
      date = kendo.parseDate(self._endInput.val(), self.options.format, kendo.getCulture());
      return kendo.toString(date, dews._environments.formats.monthValueFormat, kendo.getCulture()) || "";
    } else {
      return "";
    }
  };

  MonthPeriodPicker.prototype.setPeriod = function () {
    var self = this;
    var date = new Date(),
      now = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));
    var startYear = now.getYear() + 1900;
    var endYear = now.getYear() + 1900;
    var startMonth, endMonth, startDate, endDate;
    var length = arguments.length;

    //파라미터 개수에 따라 다른 처리
    if (length === 1) {
      var period = arguments[0];

      if (period.toUpperCase() === "THIS_YEAR") {
        startMonth = 1;
        endMonth = 12;
      } else if (period.toUpperCase() === "THIS_MONTH") {
        startMonth = 1;
        endMonth = now.getMonth() + 1;
      } else if (period.toUpperCase() === "1ST_HALF") {
        startMonth = 1;
        endMonth = 6;
      } else if (period.toUpperCase() === "2ND_HALF") {
        startMonth = 7;
        endMonth = 12;
      } else if (period.toUpperCase() === "1Q") {
        startMonth = 1;
        endMonth = 3;
      } else if (period.toUpperCase() === "2Q") {
        startMonth = 4;
        endMonth = 6;
      } else if (period.toUpperCase() === "3Q") {
        startMonth = 7;
        endMonth = 9;
      } else if (period.toUpperCase() === "4Q") {
        startMonth = 10;
        endMonth = 12;
      }

      var newStartDate = new Date(startYear, startMonth - 1);
      var newEndDate = new Date(endYear, endMonth - 1);

      self._startInput.attr("val", kendo.toString(newStartDate, self.options.format, kendo.getCulture()));
      self._startInput.val(kendo.toString(newStartDate, self.options.format, kendo.getCulture()));
      self._endInput.attr("val", kendo.toString(newEndDate, self.options.format, kendo.getCulture()));
      self._endInput.val(kendo.toString(newEndDate, self.options.format, kendo.getCulture()));

      self._setNumericTextBoxValue(startYear, startMonth, endYear, endMonth);
    } else if (length === 2) {
      startDate = arguments[0];
      endDate = arguments[1];

      if (startDate || endDate) {
        if (typeof startDate === "undefined" || startDate === null) {
        } else {
          var newStartDate = kendo.parseDate(
          startDate,
          dews._environments.formats.monthValueFormat,
          kendo.getCulture());

          startYear = newStartDate ? newStartDate.getFullYear() : "";
          startMonth = newStartDate ? newStartDate.getMonth() + 1 : "";
        }
        if (typeof endDate === "undefined" || endDate === null) {
        } else {
          var newEndDate = kendo.parseDate(
          endDate,
          dews._environments.formats.monthValueFormat,
          kendo.getCulture());

          endYear = newEndDate ? newEndDate.getFullYear() : "";
          endMonth = newEndDate ? newEndDate.getMonth() + 1 : "";
        }

        if (startDate <= endDate && startDate && endDate) {
          self._startInput.attr("val", kendo.toString(newStartDate, self.options.format, kendo.getCulture()));
          self._startInput.val(kendo.toString(newStartDate, self.options.format, kendo.getCulture()));
          self._endInput.attr("val", kendo.toString(newEndDate, self.options.format, kendo.getCulture()));
          self._endInput.val(kendo.toString(newEndDate, self.options.format, kendo.getCulture()));
        } else if (startDate > endDate && startDate && endDate) {
          self._startInput.attr("val", "");
          self._startInput.val("");
          self._endInput.attr("val", "");
          self._endInput.val("");
        } else if (startYear && startMonth) {
          self._startInput.attr("val", kendo.toString(newStartDate, self.options.format, kendo.getCulture()));
          self._startInput.val(kendo.toString(newStartDate, self.options.format, kendo.getCulture()));
          self._endInput.attr("val", "");
          self._endInput.val("");
        } else if (endYear && endMonth) {
          self._startInput.attr("val", "");
          self._startInput.val("");
          self._endInput.attr("val", kendo.toString(newEndDate, self.options.format, kendo.getCulture()));
          self._endInput.val(kendo.toString(newEndDate, self.options.format, kendo.getCulture()));
        } else if (!startDate) {
          self._startInput.attr("val", "");
          self._startInput.val("");
        } else {
          self._endInput.attr("val", "");
          self._endInput.val("");
        }
        self._setNumericTextBoxValue(startYear, startMonth, endYear, endMonth);
      } else if (!startDate && !endDate) {
        self._startInput.attr("val", "");
        self._startInput.val("");
        self._endInput.attr("val", "");
        self._endInput.val("");

        self._setNumericTextBoxValue("", "", "", "");
      }
    }
  };

  /**
   * 월기간피커의 활성화 여부를 설정하거나 가져옵니다.
   * @param {boolean} [value] 설정할 활성화 여부(생략하면 현재 활성화 여부를 반환합니다.)
   * @returns {boolean} 활성화 여부
   */
  MonthPeriodPicker.prototype.enable = function (value) {
    var self = this,
      $el = $(self._element),
      enabled;

    enabled = !$el.hasClass("disabled");

    if (typeof value !== "undefined") {
      if (value === true) {
        $el.removeClass("disabled");
        self._wrapper.removeClass("dews-state-disabled");
        self._startInput.removeAttr("disabled", "disabled");
        self._endInput.removeAttr("disabled", "disabled");
        self._startInput.removeClass("dews-state-disabled");
        self._endInput.removeClass("dews-state-disabled");
      } else if (value === false) {
        $el.addClass("disabled");
        self._wrapper.addClass("dews-state-disabled");
        self._startInput.attr("disabled", "disabled");
        self._endInput.attr("disabled", "disabled");
        self._startInput.addClass("dews-state-disabled");
        self._endInput.addClass("dews-state-disabled");
      }
    } else {
      return enabled;
    }
  };

  /**
   * 월 기간피커의 visible 여부를 가져옵니다.
   * @returns {boolean}
   * @private
   */
  MonthPeriodPicker.prototype._visibleCheckFromPanel = function () {
    var self = this,
      $ctrl = $(self._element);
    isVisible = $ctrl.css("display") !== "none";

    return isVisible;
  };

  MonthPeriodPicker.prototype.required = function (value) {
    var self = this,
      $el = $(self._element);
    var $wrapper = self._wrapper;
    var $startInput = self._startInput;
    var $endInput = self._endInput;

    if ($.type(value) === "undefined") {
      return $el.hasClass("required");
    } else if (value === true) {
      $el.addClass("required");
      $wrapper.addClass("dews-state-required");
      $startInput.addClass("dews-state-required");
      $endInput.addClass("dews-state-required");
    } else if (value === false) {
      $el.removeClass("required");
      $wrapper.removeClass("dews-state-required");
      $startInput.removeClass("dews-state-required");
      $endInput.removeClass("dews-state-required");
    }
  };

  MonthPeriodPicker.prototype.readonly = function (value) {
    var self = this,
      $el = $(self._element),
      readonly;

    readonly = $el.hasClass("readonly");

    if (typeof value !== "undefined") {
      if (value === false) {
        $el.removeClass("readonly");
        self._wrapper.removeClass("dews-state-readonly");
        self._startInput.removeAttr("readonly", "readonly");
        self._endInput.removeAttr("readonly", "readonly");
        self._startInput.removeClass("dews-state-readonly");
        self._endInput.removeClass("dews-state-readonly");
        self.disableButton = false;
        readonly = !value;
      } else if (value === true) {
        $el.addClass("readonly");
        self._wrapper.addClass("dews-state-readonly");
        self._startInput.attr("readonly", "readonly");
        self._endInput.attr("readonly", "readonly");
        self._startInput.addClass("dews-state-readonly");
        self._endInput.addClass("dews-state-readonly");
        self.disableButton = true;
        readonly = !value;
      }
    }

    return readonly;
  };

  MonthPeriodPicker.prototype.focus = function (options) {
    var self = this;

    if (options === "start") {
      self._startInput.focus();
    } else if (options === "end") {
      self._endInput.focus();
    } else if (options === undefined) {
      self._startInput.focus();
    }
  };

  MonthPeriodPicker.prototype._bindEvents = function () {
    var self = this,
      $el = self._element;
    var toggle = true;
    var date = new Date(),
      now = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));
    var $offset = 0;

    self._startInput.on("focus", function (e) {
      self._wrapper.addClass("dews-monthperiodpicker-focus");
      e.stopPropagation();
    });

    self._endInput.on("focus", function (e) {
      self._wrapper.addClass("dews-monthperiodpicker-focus");
      e.stopPropagation();
    });

    self._startInput.on("blur", function (e) {
      self._wrapper.removeClass("dews-monthperiodpicker-focus");
      e.stopPropagation();
    });

    self._endInput.on("blur", function (e) {
      self._wrapper.removeClass("dews-monthperiodpicker-focus");
      e.stopPropagation();
    });

    function clickButtons(fm, lm) {
      clear();
      var firstDate = new Date(date.getFullYear(), fm);
      var lastDate = new Date(date.getFullYear(), lm);

      getYearMonth(firstDate, lastDate);
      addClassToButton(fm, lm);
    }

    var popoverClose = function popoverClose(e) {
      if (
      e.type === "scroll" && !$(e.target).parents(".dews-monthperiodpicker-calendars")[0] ||
      e.type === "keyup" && e.keyCode === 27)
      {
        close();
        clear();
        $(e.target).focus();
        if (self._startInput.val() === "") {
          setNumerictextboxValue("", self._endInput.val());
        } else if (self._endInput.val() === "") {
          setNumerictextboxValue(self._startInput.val(), "");
        }
      }
    };

    function bindCloseEvent() {
      window.addEventListener("scroll", popoverClose, true);
      window.addEventListener("keyup", popoverClose, true);
      // 버튼, 달력창 영역을 제외한 나머지 부분 클릭시 달력창 닫기
      $(window).on("click", function (event) {
        if (!$(event.target).parents(".dews-monthperiodpicker-calendars")[0]) {
          close();
          var startSet = self._startInput.val(),
            endSet = self._endInput.val();

          //값을 변경하고 딴 곳을 클릭해 달력닫고, 다시 열었을 때 값 맞추기.
          if (startSet && endSet) {
            setNumerictextboxValue(startSet, endSet);
            removeClassToButton();
          }
          if (startSet === "") {
            setNumerictextboxValue("", endSet);
            removeClassToButton();
          }
          if (endSet === "") {
            setNumerictextboxValue(startSet, "");
            removeClassToButton();
          }
        }
        event.stopPropagation();
      });
    }

    self.oneQuearterButton.on("click", function (e) {
      clickButtons(0, 2);
      e.stopPropagation();
    });

    self.twoQuearterButton.on("click", function (e) {
      clickButtons(3, 5);
      e.stopPropagation();
    });

    self.threeQuearterButton.on("click", function (e) {
      clickButtons(6, 8);
      e.stopPropagation();
    });

    self.fourQuearterButton.on("click", function (e) {
      clickButtons(9, 11);
      e.stopPropagation();
    });

    self.firstHalfButton.on("click", function (e) {
      clickButtons(0, 5);
      e.stopPropagation();
    });

    self.secondHalfButton.on("click", function (e) {
      clickButtons(6, 11);
      e.stopPropagation();
    });

    self.thisYearButton.on("click", function (e) {
      clickButtons(0, 11);
      e.stopPropagation();
    });

    //1~12월 버튼 클릭시
    $("button.dews-monthperiod-months", self._hiddenArea).on("click", function (e) {
      var months = [
      "dews-monthperiod-january",
      "dews-monthperiod-february",
      "dews-monthperiod-march",
      "dews-monthperiod-april",
      "dews-monthperiod-may",
      "dews-monthperiod-june",
      "dews-monthperiod-july",
      "dews-monthperiod-august",
      "dews-monthperiod-september",
      "dews-monthperiod-october",
      "dews-monthperiod-november",
      "dews-monthperiod-december"];

      var temp, firstDate, lastDate;

      $(".dews-monthperiod-months", self._hiddenArea).removeClass("dews-monthperiod-select");

      //기간1 선택하고 2선택하면 타는 분기문
      if (self.firstClickItem !== null) {
        if (self.secondClickItem !== null) {
          clear();
        }
        self.secondClickItem = self.firstClickItem;
      }
      self.firstClickItem = $(this);

      //아이템 1,2 다 선택
      if (self.firstClickItem !== null && self.secondClickItem !== null) {
        var index1 = self.firstClickItem.index() - 7;
        var index2 = self.secondClickItem.index() - 7;

        if (index1 > index2) {
          temp = index1;
          index1 = index2;
          index2 = temp;
        }

        for (var i = index1; i <= index2; i++) {
          if ($("button.dews-monthperiod-months", self._hiddenArea).hasClass(months[i])) {
            $("button.dews-monthperiod-months" + "." + months[i], self._hiddenArea).addClass(
            "dews-monthperiod-select");

          }
        }
        firstDate = new Date(date.getFullYear(), index1, 1);
        lastDate = new Date(date.getFullYear(), index2 + 1, 0);
        getYearMonth(firstDate, lastDate);
        addClassToButton(index1, index2);
      }

      //아이템 1만 선택.
      if (self.firstClickItem !== null && self.secondClickItem === null) {
        firstDate = new Date(date.getFullYear(), self.firstClickItem.index() - 7, 1);
        lastDate = new Date(date.getFullYear(), self.firstClickItem.index() - 6, 0);
        var fMonth = firstDate.getMonth();
        var lMonth = lastDate.getMonth();

        getYearMonth(firstDate, lastDate);
        addClassToButton(fMonth, lMonth);
      }
      e.stopPropagation();
    });

    //달력버튼 클릭 시
    self._calenderButton.on("click", function (e) {
      var firstDate = kendo.parseDate(self._startInput.val(), self.options.format, kendo.getCulture());
      var secondDate = kendo.parseDate(self._endInput.val(), self.options.format, kendo.getCulture());

      if (firstDate) {
        var substrFirstMonth = firstDate.getMonth() + 1;
      }
      if (secondDate) {
        var substrSecondMonth = secondDate.getMonth() + 1;
      }

      var fy = self.firstYear.value();
      var sy = self.secondYear.value();

      removeClassToButton();
      if (!self.disableButton) {
        if (toggle) {
          bindCloseEvent();
          var element_offset = $el.offset();
          var zIndex = dews.ui.getDialogMaxZIndex();

          if (zIndex > parseInt(self._hiddenArea.css("zIndex"), 10)) {
            self._hiddenArea.css("zIndex", zIndex + 2);
          }

          self._hiddenArea.css({
            left: parseFloat(element_offset.left) + "px"
          });

          if ($(window).height() < $(this).offset().top - $offset + self._hiddenArea.height() + 24) {
            //너무 줄엿을때는 위로도 안붙고, 아래 붙게
            self._hiddenArea.css("top", parseFloat(element_offset.top) - self._hiddenArea.height() - 1);
            if ($(this).offset().top - $offset < self._hiddenArea.height()) {
              self._hiddenArea.css("top", parseFloat(element_offset.top) + 23);
            }
          } else {
            self._hiddenArea.css("top", parseFloat(element_offset.top) + self._wrapper.height() + 1);
          }
          if ($(window).width() - (self._wrapper.offset().left + self._hiddenArea.width()) < 0) {
            var right_width = self._calenderButton.offset().left + 22.7969 - self._hiddenArea.width();
            self._hiddenArea.css("left", right_width);
            if ($(window).width() < self._hiddenArea.width()) {
              self._hiddenArea.css("left", parseFloat(element_offset.left) + 1);
            }
          }
          self._wrapper.addClass("dews-monthperiodpicker-focus");
          self._calenderButton.addClass("dews-monthperiodpicker-focus");
          self._hiddenArea.addClass("opened");
          toggle = false;

          //setStartDate 함수 이용해 값 설정 시, input에 포커스 놓지않고 바로 달력 누르면 값 입력안됨.
          if (self._startInput.val() === "") {
            setNumerictextboxValue("", self._endInput.val());
          } else if (self._endInput.val() === "") {
            setNumerictextboxValue(self._startInput.val(), "");
          } else {
            setNumerictextboxValue(self._startInput.val(), self._endInput.val());

            if (self._thisYear === fy) {
              if (self._thisYear === sy) {
                substrFirstMonth = self.firstMonth.value();
                substrSecondMonth = self.secondMonth.value();
                addClassToButton(substrFirstMonth - 1, substrSecondMonth - 1);
              }
            } else {
              removeClassToButton();
            }
          }
          self.firstClickItem = null;
          self.secondClickItem = null;
        } else {
          close();
          clear();
          if (self._startInput.val() === "") {
            setNumerictextboxValue("", self._endInput.val());
          } else if (self._endInput.val() === "") {
            setNumerictextboxValue(self._startInput.val(), "");
          }
        }
      }
      e.stopPropagation();
    });

    $(window).scroll(function () {
      $offset = $(this).scrollTop();
    });

    //적용하기 버튼 클릭시 input에 set
    self.okButton.on("click", function (e) {
      var startDate, endDate;
      var startYear = self._hiddenArea.find(".dews-ui-numerictextbox.dews-monthperiodpicker-firstyear");
      var startMonth = self._hiddenArea.find(".dews-ui-numerictextbox.dews-monthperiodpicker-firstmonth");
      var lastYear = self._hiddenArea.find(".dews-ui-numerictextbox.dews-monthperiodpicker-secondyear");
      var lastMonth = self._hiddenArea.find(".dews-ui-numerictextbox.dews-monthperiodpicker-secondmonth");

      self.startYear = startYear;
      self.startMonth = startMonth;
      self.lastYear = lastYear;
      self.lastMonth = lastMonth;

      var sd = startMonth.val()[1] ? startMonth.val() : "0" + startMonth.val()[0];
      var ld = lastMonth.val()[1] ? lastMonth.val() : "0" + lastMonth.val()[0];

      var date = self._startInput.val();
      var date2 = self._endInput.val();

      var preFirstDate = kendo.parseDate(date, self.options.format, kendo.getCulture()) ?
      kendo.parseDate(date, self.options.format, kendo.getCulture()) :
      new Date("", "");
      var preSecondDate = kendo.parseDate(date2, self.options.format, kendo.getCulture()) ?
      kendo.parseDate(date2, self.options.format, kendo.getCulture()) :
      new Date("", "");

      var currFirstDate = new Date(startYear.val(), sd - 1);
      var currSecondDate = new Date(lastYear.val(), ld - 1);

      if (self.startYear.val() && self.startMonth.val()) {
        startDate = kendo.toString(currFirstDate, self.options.format, kendo.getCulture());
        self._startInput.attr("val", startDate);
        self._startInput.val(startDate);
      }
      if (self.lastYear.val() && self.lastMonth.val()) {
        endDate = kendo.toString(currSecondDate, self.options.format, kendo.getCulture());
        self._endInput.attr("val", endDate);
        self._endInput.val(endDate);
      }

      //이전 값과 새로 입력한 값이 다를 경우 change 이벤트 실행
      if (
      preFirstDate.getTime() !== currFirstDate.getTime() ||
      preSecondDate.getTime() !== currSecondDate.getTime())
      {
        self._wrapper.trigger("_change");
      }

      addClassToButton(self.startMonth.val() - 1, self.lastMonth.val() - 1);
      close();
      e.stopPropagation();
    });

    if (self.options.startDate !== null) {
      self.setStartDate(self.options.startDate);
    }

    if (self.options.endDate !== null) {
      self.setEndDate(self.options.endDate);
    }

    function addClassToButton(index1, index2) {
      var monthArray = [
      self.januaryBtn,
      self.februaryBtn,
      self.marchBtn,
      self.aprilBtn,
      self.mayBtn,
      self.juneBtn,
      self.julyBtn,
      self.augustBtn,
      self.septemberBtn,
      self.octoberBtn,
      self.novemberBtn,
      self.decemberBtn];


      var fy = self.firstYear.value();
      var sy = self.secondYear.value();
      var fm = self.firstMonth.value();
      var sm = self.secondMonth.value();

      index1 = Number(index1);
      index2 = Number(index2);

      if ($.type(fm) !== "null" && $.type(sm) !== "null") {
        $(".dews-monthperiod-button", self.option).removeClass("dews-monthperiod-select");

        for (index1; index1 <= index2; index1++) {
          monthArray[index1].addClass("dews-monthperiod-select");
        }

        //숫자텍스트 값이 올해면
        if (self._thisYear === fy) {
          if (self._thisYear === sy) {
            if (fm === 1 && sm === 3) {
              //월 비교해서 add클래스
              self.oneQuearterButton.addClass("dews-monthperiod-select");
            } else if (fm === 4 && sm === 6) {
              self.twoQuearterButton.addClass("dews-monthperiod-select");
            } else if (fm === 7 && sm === 9) {
              self.threeQuearterButton.addClass("dews-monthperiod-select");
            } else if (fm === 10 && sm === 12) {
              self.fourQuearterButton.addClass("dews-monthperiod-select");
            } else if (fm === 1 && sm === 6) {
              self.firstHalfButton.addClass("dews-monthperiod-select");
            } else if (fm === 7 && sm === 12) {
              self.secondHalfButton.addClass("dews-monthperiod-select");
            } else if (fm === 1 && sm === 12) {
              self.thisYearButton.addClass("dews-monthperiod-select");
            }
          }
          self.okButton.prop("disabled", false);
          //올해가 아니면 지우기
        } else {
          $(".dews-monthperiod-button", self.option).removeClass("dews-monthperiod-select");
        }
      }
    }

    function removeClassToButton() {
      var monthArray = [
      self.januaryBtn,
      self.februaryBtn,
      self.februaryBtn,
      self.marchBtn,
      self.aprilBtn,
      self.mayBtn,
      self.juneBtn,
      self.julyBtn,
      self.augustBtn,
      self.septemberBtn,
      self.octoberBtn,
      self.novemberBtn,
      self.decemberBtn];


      for (var i = 0; i < monthArray.length; i++) {
        monthArray[i].removeClass("dews-monthperiod-select");
      }
      $(".dews-monthperiod-button", self.option).removeClass("dews-monthperiod-select");
    }

    //숫자텍스트 값이 바뀌면 실행
    function changeHandler(e) {
      removeClassToButton();

      var fy = self.firstYear.value();
      var fm = self.firstMonth.value();
      var sy = self.secondYear.value();
      var sm = self.secondMonth.value();

      //발생한 이벤트 타입이 'keyup' 일때
      if (e.type === "keyup") {
        fy = parseInt(self.firstYear.element.val());
        sy = parseInt(self.secondYear.element.val());
      }

      if (fy && (fy + "").length === 4 && fy < self.options.min) {
        fy = self.options.min;
      }
      if (sy && (sy + "").length === 4 && sy < self.options.min) {
        sy = self.options.min;
      }

      //년도에 아무값도 설정돼있지않으면 올해 년도로 설정
      if (fy === self.options.min) {
        self.firstYear.value(self._thisYear);
        // fy = self.firstYear.value();
      }
      if (sy === self.options.min) {
        self.secondYear.value(self._thisYear);
        // sy = self.secondYear.value();
      }

      if (fy !== sy) {
        removeClassToButton();
      } else if (fy === self._thisYear && sy === self._thisYear) {
        addClassToButton(fm - 1, sm - 1);

        if (fm > sm) {
          removeClassToButton();
        }
      }

      self.okButton.prop("disabled", false);
      self.okButton.removeClass("k-state-disabled");

      if (!fy && !fm) {
        //첫번째 년 월 없을때
        self._startInput.val("");
      } else if (!sy && !sm) {
        //두번쨔 년 월 없을때
        self._endInput.val("");
      } else if (!fy || !fm) {
        //첫번째 년이 없거나 월이 없을때
        self.okButton.prop("disabled", true);
        self.okButton.addClass("k-state-disabled");
      } else if (!sy || !sm) {
        //두번째 년이 없거나 월이 없을때
        self.okButton.prop("disabled", true);
        self.okButton.addClass("k-state-disabled");
      } else {
        // 위에것들이 아닐
        if (sy) {
          //종료날짜가 존재하고,
          if (fy > sy) {
            //시작날짜의 년도가 종료날짜의 년도보다 클때
            self.okButton.prop("disabled", true);
            self.okButton.addClass("k-state-disabled");
          } else if (!(fy.toString().length === 4) || !(sy.toString().length === 4)) {
            self.okButton.prop("disabled", true);
            self.okButton.addClass("k-state-disabled");
          }
        }
        if (fy === sy && fm > sm) {
          //시작날짜와 종료날짜의 년도가 같고, 시작날짜 월이 종료날짜 월보다 클때
          self.okButton.prop("disabled", true);
          self.okButton.addClass("k-state-disabled");
        }
      }
    }

    //4개 숫자텍스트박스 값이 변경됐을 때 이벤트.
    self.firstYear.bind("spin", changeHandler);

    self.firstMonth.bind("spin", changeHandler);

    self.secondYear.bind("spin", changeHandler);

    self.secondMonth.bind("spin", changeHandler);

    self.firstYear.bind("change", changeHandler);

    self.firstMonth.bind("change", changeHandler);

    self.secondYear.bind("change", changeHandler);

    self.secondMonth.bind("change", changeHandler);

    self.firstYear.element.on("keyup", changeHandler);

    self.firstMonth.element.on("keyup", changeHandler);

    self.secondYear.element.on("keyup", changeHandler);

    self.secondMonth.element.on("keyup", changeHandler);

    self._startInput.on("keyup", function (e) {
      var key = e.key,
        regex = /[0-9]/; // 입력된 키 값이 숫자인지 매칭
      var preStartDate, currStartDate;
      var startInput = self._startInput;

      // 숫자 혹은 backspace, delete, ctrl+v 인지 확인
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && startInput.is(":enabled")) {
        e.returnValue = false;
        e.preventDefault();
      } else if (
      !regex.test(key) &&
      e.keyCode !== 8 &&
      e.keyCode !== 46 &&
      e.ctrlKey === false &&
      e.keyCode !== 91 &&
      e.ctrlKey === true &&
      e.keyCode !== 86 &&
      e.ctrlKey === false &&
      e.keyCode !== 17)
      {
        e.returnValue = false;
        e.preventDefault();
      } else {
        preStartDate = $(".dews-monthperiodpicker-startDate", self._wrapper).attr("val");
        currStartDate = self._startInput.val();

        // 모든 값이 입력 되면 값 설정
        if (self._startInput.val() && self._startInput.val().indexOf("_") === -1) {
          format(self._startInput);
          if (!self._endInput.val()) {
            self.secondYear.value("");
            self.secondMonth.value("");
          }

          $(".dews-monthperiodpicker-startDate", self._wrapper).attr(
          "val",
          $(".dews-monthperiodpicker-startDate", self._wrapper).val());


          if (preStartDate !== currStartDate) {
            self._startInput.trigger("_change");
          }

          if (regex.test(key)) {
            self._endInput.focus();
          }
        }

        if (self._startInput.val().indexOf("_") === 0) {
          currStartDate = "";
          if (preStartDate === undefined) {
            preStartDate = "";
          }
          if (preStartDate !== currStartDate) {
            self._startInput.trigger("_change");
          }
        }
      }

      // backspace, delete 키를 눌렀을 경우 input에 값이 없을때
      if (e.keyCode === 8 || e.keyCode === 46) {
        if (self._startInput.val().indexOf("_") === 0) {
          $(".dews-monthperiodpicker-startDate", self._wrapper).attr("val", "");
          self.secondYear.value("");
          self.secondMonth.value("");
        }
      }
      e.stopPropagation();
    });

    self._endInput.on("keyup", function (e) {
      var key = e.key,
        regex = /[0-9]/;
      var preEndDate, currEndDate;
      var endInput = self._endInput;

      // 숫자 혹은 backspace, delete, ctrl+v 인지 확인
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && endInput.is(":enabled")) {
        e.returnValue = false;
        e.preventDefault();
      } else if (
      !regex.test(key) &&
      e.keyCode !== 8 &&
      e.keyCode !== 46 &&
      e.ctrlKey === false &&
      e.keyCode !== 91 &&
      e.ctrlKey === true &&
      e.keyCode !== 86 &&
      e.ctrlKey === false &&
      e.keyCode !== 17)
      {
        e.returnValue = false;
        e.preventDefault();
      } else {
        preEndDate = $(".dews-monthperiodpicker-endDate", self._wrapper).attr("val");
        currEndDate = self._endInput.val();

        // 모든 값이 입력 되면 값 설정
        if (self._endInput.val() && self._endInput.val().indexOf("_") === -1) {
          format(self._endInput);

          if (!self._startInput.val()) {
            self.firstYear.value("");
            self.firstMonth.value("");
          }

          $(".dews-monthperiodpicker-endDate", self._wrapper).attr(
          "val",
          $(".dews-monthperiodpicker-endDate", self._wrapper).val());


          if (preEndDate !== currEndDate) {
            self._endInput.trigger("_change");
          }
        }

        if (self._endInput.val().indexOf("_") === 0) {
          currEndDate = "";
          if (preEndDate === undefined) {
            preEndDate = "";
          }
          if (preEndDate !== currEndDate) {
            self._endInput.trigger("_change");
          }
        }
      }

      // backspace, delete 키를 눌렀을 경우 input에 값이 없을때
      if (e.keyCode === 8 || e.keyCode === 46) {
        if (self._endInput.val().indexOf("_") === 0) {
          $(".dews-monthperiodpicker-endDate", self._wrapper).attr("val", "");
          self.firstYear.value("");
          self.firstMonth.value("");
          self._startInput.focus();
        }
      }
      e.stopPropagation();
    });

    // 시작 월이나 종료 월을 입력 중인 경우 이벤트 버블링을 막음
    $el.on("keydown", function (e) {
      if (e.keyCode === 13) {
        if (self._startInput.is(":focus") || self._endInput.is(":focus")) {
          e.stopPropagation();
        }
        if (
        self._hiddenArea.css("display") === "block" &&
        self.getStartDate() === "" &&
        self.getEndDate() === "")
        {
          self.setStartDate(new Date());
          self.setEndDate(new Date());
          self.okButton.click();
        }
      } else if (e.keyCode === 115 && self._hiddenArea.css("display") === "none") {
        self._calenderButton.click();
        e.stopPropagation();
        e.preventDefault();
      }
    });

    //시작월, 종료월 가져와서 숫자텍스트박스에
    function getYearMonth(firstDate, lastDate) {
      var firstY = firstDate.getYear() + 1900;
      var firstM = firstDate.getMonth() + 1;
      var lastY = lastDate.getYear() + 1900;
      var lastM = lastDate.getMonth() + 1;

      self._setNumericTextBoxValue(firstY, firstM, lastY, lastM);
    }

    //input에서 값 가져와 숫자텍스트박스에 set.
    function setNumerictextboxValue(firstDate, lastDate) {
      var start = kendo.parseDate(firstDate, self.options.format, kendo.getCulture());
      var end = kendo.parseDate(lastDate, self.options.format, kendo.getCulture());

      if (start) {
        var firstY = start.getFullYear();
        var firstM = start.getMonth() + 1;
      }

      if (end) {
        var lastY = end.getFullYear();
        var lastM = end.getMonth() + 1;
      }

      self._setNumericTextBoxValue(firstY, firstM, lastY, lastM);
    }

    function format(option) {
      var dateValue = $(option).val(),
        date = new Date(),
        formatDate = kendo.parseDate(dateValue, self.options.format, kendo.getCulture()),
        yyyy;

      if (formatDate) {
        yyyy = formatDate.getFullYear();

        if (yyyy < 1000) {
          yyyy = date.getFullYear();
        }

        formatDate.setFullYear(yyyy);
        formatDate = kendo.toString(formatDate, self.options.format, kendo.getCulture());
      } else {
        formatDate = "";
      }

      $(option).val(formatDate);

      var startSet = self._startInput.val(),
        endSet = self._endInput.val();

      var startDate = kendo.parseDate(startSet, self.options.format, kendo.getCulture());
      var endDate = kendo.parseDate(endSet, self.options.format, kendo.getCulture());

      if ((startDate && startDate.getTime()) > (endDate && endDate.getTime())) {
        if (endSet === "") {
          startSet = kendo.toString(startDate, self.options.format, kendo.getCulture());
          endSet = "";
        } else {
          startSet = kendo.toString(startDate, self.options.format, kendo.getCulture());
          endSet = kendo.toString(startDate, self.options.format, kendo.getCulture());
        }
      } else {
        if (startSet === "") {
          startSet = kendo.toString(endDate, self.options.format, kendo.getCulture());
          endSet = "";
        } else {
          startSet = kendo.toString(startDate, self.options.format, kendo.getCulture());
          endSet = kendo.toString(endDate, self.options.format, kendo.getCulture());
        }
      }

      if (startSet !== "" && endSet !== "") {
        self._startInput.val(startSet);
        self._endInput.val(endSet);
      }

      if (!endSet) {
        self._endInput.val("").trigger("input");
      }

      //getYearMonth 함수,
      if (option === self._startInput) {
        setNumerictextboxValue(startSet, endSet);
      } else {
        setNumerictextboxValue(startSet, endSet);
      }
    }

    function close() {
      self._wrapper.removeClass("dews-monthperiodpicker-focus");
      self._calenderButton.removeClass("dews-monthperiodpicker-focus");
      self._hiddenArea.removeClass("opened").css("zIndex", "");
      toggle = true;
      window.removeEventListener("scroll", popoverClose, true);
      window.removeEventListener("keyup", popoverClose, true);
      $(window).off("click");
    }

    function clear() {
      self.firstClickItem = null;
      self.secondClickItem = null;
      $(".dews-monthperiod-months", self._hiddenArea).removeClass("dews-monthperiod-select");
    }
  };

  MonthPeriodPicker.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "change") {
          self._wrapper.trigger("_change");
        } else {
          self._wrapper.trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  MonthPeriodPicker.prototype.on = function () {
    var self = this;

    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    }

    self._wrapper.on.apply(self._wrapper, arguments);
  };

  MonthPeriodPicker.prototype.off = function () {
    var self = this;

    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    }
    self._wrapper.off.apply(self._wrapper, arguments);
  };

  MonthPeriodPicker.prototype.validate = function () {
    var self = this;
    if (!self.getStartDate() || !self.getEndDate()) {
      return false;
    } else {
      return true;
    }
  };

  MonthPeriodPicker.prototype.bindFromPanel = function (data) {
    var self = this,
      $element = $(self._element);
    var startDate, endDate;

    if (data) {
      startDate = $element.data("dews-bind-startdate") || "";
      endDate = $element.data("dews-bind-enddate") || "";

      self.setStartDate("");
      self.setEndDate("");

      if (startDate && data.hasOwnProperty(startDate)) {
        self.setStartDate(data[startDate] || "");
      }
      if (endDate && data.hasOwnProperty(endDate)) {
        self.setEndDate(data[endDate] || "");
      }
    }
  };

  MonthPeriodPicker.prototype.serializeForPanel = function () {
    var self = this,
      $element = $(self._element);
    var startDate, endDate;
    var data = [];
    startDate = $element.data("dews-bind-startdate") || "";
    endDate = $element.data("dews-bind-enddate") || "";

    if (startDate) {
      data[startDate] = self.getStartDate();
    }
    if (endDate) {
      data[endDate] = self.getEndDate();
    }
    return data;
  };

  MonthPeriodPicker.prototype.applyPanelFocus = function (requiredCheck) {
    var self = this,
      $element = $(self._element);
    var startInput = self._startInput;
    var endInput = self._endInput;

    startInput.on("keydown", function (e) {
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && startInput.is(":enabled")) {
        e.preventDefault();
      } else if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();

        var evt = new $.Event("beforeFocus");
        evt.control = self;

        startInput.trigger(evt);
      } else if (e.keyCode === 9 || e.keyCode === 13 && startInput.is(":enabled")) {
        if (e.keyCode === 9) {
          //tab키 기본동작 막기
          e.preventDefault();
        }

        if (e.keyCode === 13 && requiredCheck && $element.hasClass("required")) {
          if (self.validate()) {
            var evt = new $.Event("nextFocus");
            evt.control = self;

            startInput.trigger(evt);
          }
        } else if (e.keyCode === 9) {
          // tab키 누를 시 종료년월로 포커스 이동
          endInput.focus();
        } else {
          // 엔터키 누를 시 다음 컨트롤로 포커스 이동
          var evt = new $.Event("nextFocus");
          evt.control = self;

          startInput.trigger(evt);
        }
      }
    });

    endInput.on("keydown", function (e) {
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && endInput.is(":enabled")) {
        e.preventDefault();
      } else if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();

        startInput.focus();
      } else if (e.keyCode === 9 || e.keyCode === 13 && endInput.is(":enabled")) {
        if (e.keyCode === 9) {
          //tab키 기본동작 막기
          e.preventDefault();
        }

        var evt = new $.Event("nextFocus");
        evt.control = self;

        endInput.trigger(evt);
      }
    });
  };

  MonthPeriodPicker.prototype.canFocusable = function () {
    var self = this;
    var $start = self._startInput;
    var $end = self._endInput;

    if (!self._element.hasClass("readonly") && $start && $end) {
      return $start.is(":visible") && $start.is(":enabled");
    } else {
      return false;
    }
  };

  /**
   * 시용자 가이드를 위한 API 를 추가합니다.
   * @param $element 대상 jQuery 요소
   */
  MonthPeriodPicker.prototype.setUserGuideAPI = function () {
    var self = this,
      $element = $(self._element);

    self._startInput.on("focus", function () {
      if (dews.ui.page && dews.ui.page.hasUserGuide) {
        if ($.isFunction(dews.ui.page.focusGuideItem) && $element.attr("id")) {
          dews.ui.page.focusGuideItem("#" + $element.attr("id"));
        }
      }
    });

    self._endInput.on("focus", function () {
      if (dews.ui.page && dews.ui.page.hasUserGuide) {
        if ($.isFunction(dews.ui.page.focusGuideItem) && $element.attr("id")) {
          dews.ui.page.focusGuideItem("#" + $element.attr("id"));
        }
      }
    });
  };

  /**
   * 월기간피커 컨트롤 자동화 인쇄 관련 데이터 추출
   * @return {*} 값이 설정 된 경우 Object 반환, 없는 경우 undefined 반환
   * @private
   */
  MonthPeriodPicker.prototype._getPrintData = function () {
    var self = this,
      $el = $(self._element),
      data;

    if (self.getStartText() && self.getEndText()) {
      data = {
        id: $el.attr("id"),
        text: self.getStartText() + " ~ " + self.getEndText()
      };
    }

    return data;
  };

  /**
   * 기간달력피커 컨트롤 display none 하여 숨기는 API
   */
  MonthPeriodPicker.prototype.hide = function () {
    var self = this;

    if (!(self._wrapper.css("display") === "none")) {
      self._wrapper.css("display", "none");
    }
  };

  /**
   * 기간달력피커 컨트롤 display inline-block 하여 보이도록 하는 API
   */
  MonthPeriodPicker.prototype.show = function () {
    var self = this;

    if (self._wrapper.css("display") === "none") {
      self._wrapper.css("display", "inline-block");
    }
  };

  /**
   * 공통 이벤트를 설정합니다.
   * @param {jQuery} $el 대상 요소의 jQuery객체입니다.
   * @param {object} [options] 피커의 옵션입니다.
   */
  function setEvent($el, options) {
    $el.on("click", function (e) {
      var $this = $(this);
      if ($this.prop("readonly") === false && $this.prop("disabled") === false) {
        // 읽기 전용/비활성화 상태가 아니면 포커스가 오면 텍스트 전체를 선택하도록 한다.
        $this.select();
      }
    }).on("blur", function (e) {
      var $this = $(this),
        val;
      if ($this.prop("readonly") === false && $this.prop("disabled") === false) {
        if (!dews.date.validate($this.val(), options.format)) {

          //TODO: 값이 유효하지 않을 경우 오류 표시 및 툴팁 표시
        } else {
          //TODO: 값이 유효할 때 오류 표시가 있으면 제거
        }}
    });
  }

  /**
   * 기간달력 텍스트박스에 마스크를 적용합니다.
   * @param {jQuery} $el 적용할 대상 요소의 jQuery 객체
   * @param {string} format 적용 포맷
   */
  function setMask($el, format) {
    var maskJsUrl;
    var interval;

    // jquery.maskedinput.js 를 이용하여 마스크를 적용함
    // script 파일을 로드된 적이 없으면 동적으로 로드합니다.
    // 동시에 여러 컴포넌트 초기화 시 여러번 로드되지않도록 환경변수 두어서 1번만 로드하도록 수정
    maskJsUrl = dews.url.join(dews._environments.scriptBase || "/scripts/", "jquery.maskedinput.js");

    var applyMask = function applyMask() {
      $el.mask(format.replace(/[ymdhms]/gi, "9"));
    };

    if (dews._environments.loadJqueryMaskedinput && $.mask) {
      applyMask();
    } else if (dews._environments.loadJqueryMaskedinput && !$.mask) {
      interval = setInterval(function () {
        if ($.mask) {
          applyMask();
          clearInterval(interval);
        }
      }, 100);
    } else {
      $.getScript(maskJsUrl, function () {
        applyMask();
      });
      dews._environments.loadJqueryMaskedinput = true;
    }
  }

  dews = $.extend(true, dews, {
    ui: {
      monthperiodpicker: function monthperiodpicker(selector, options) {
        var $el, monthperiodpicker;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }
        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var picker,
            $this = $(this);

          picker = $this.data("dews-control");

          if (!picker) {
            if (!$this.hasClass("dews-ui-monthperiodpicker")) {
              $this.addClass("dews-ui-monthperiodpicker");
            }

            if (!$this.hasClass("dews-form-control")) {
              $this.addClass("dews-form-control");
            }

            picker = new MonthPeriodPicker($this, options);

            $this.data("dews-control", picker);

            picker._initControl();

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }
          }
          monthperiodpicker = picker;
        });
        return monthperiodpicker;
      }
    }
  });

  dews.ui.addControlInitializer("monthperiodpicker", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }
    dews.ui.monthperiodpicker($("span.dews-ui-monthperiodpicker", $container));
  });
})(jQuery, window.dews, window.kendo);


/*
 * 년월일시분을 받아오는 일시 피커
 */
(function ($, dews, kendo) {
  var DatePickerBase = dews.ui.DatePickerBase;

  function getDefaultMonthOptions() {
    return {
      start: "year",
      depth: "year",
      format: dews._environments.formats.monthFormat,
      valueFormat: dews._environments.formats.monthValueFormat,
      max: kendo.parseDate("999912", dews._environments.formats.monthValueFormat, kendo.getCulture()),
      min: kendo.parseDate("100001", dews._environments.formats.monthValueFormat, kendo.getCulture()),
      dateStyles: []
    };
  }

  var MonthPicker = function MonthPicker($ctrl, options) {
    var monthpicker;
    var opt = this.getOptions($ctrl, getDefaultMonthOptions(), options);

    if (!$ctrl.hasClass("dews-ui-monthpicker")) {
      $ctrl.addClass("dews-ui-monthpicker");
    }

    if (!$ctrl.hasClass("dews-form-control")) {
      $ctrl.addClass("dews-form-control");
    }

    if (!$ctrl.hasClass("dews-control-activate")) {
      $ctrl.addClass("dews-control-activate");
    }

    dews.ui.util.ConvertClassAndProperty($ctrl);
    $ctrl.kendoDatePicker(opt);

    monthpicker = $ctrl.data("kendoDatePicker");
    monthpicker.options.valueFormat = opt.valueFormat;

    this.initControl($ctrl, "monthpicker");
    this.setMask($ctrl, opt.format);
    this.setEvent($ctrl, opt);
    this._setOptions(monthpicker, opt);

    DatePickerBase.call(this, monthpicker);
  };

  MonthPicker.prototype = Object.create(DatePickerBase.prototype);
  MonthPicker.prototype.constructor = MonthPicker;

  MonthPicker.prototype.setDateStyle = function (date, css) {
    var self = this;

    if (date && $.type(css) === "string") {
      self.options.dateStyles.push({ date: date, style: css });
      if (self.dateView.calendar) {
        self.dateView.calendar._dateStyle();
      }
    }
  };

  $.extend(true, dews, {
    ui: {
      /**
       * 년월을 받아오는 월 피커를 생성하거나 가져옵니다.
       * @param {string|jQuery} selector 피커로 변경될 요소를 지정하는 셀렉터 또는 jQuery 객체입니다.
       * @param {object} [options] 피커 설정 값입니다.
       */
      monthpicker: function monthpicker(selector, options) {
        var $el,
          monthpicker = null;

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var picker,
            $ctrl = $(this);

          picker = $ctrl.data("dews-control");

          if (!picker) {
            picker = new MonthPicker($ctrl, options);
            $ctrl.data("dews-control", picker);
          }

          monthpicker = picker;
        });

        return monthpicker;
      }
    }
  });

  dews.ui.addControlInitializer("monthpicker", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.monthpicker($('input[type="text"].dews-ui-monthpicker', $container));
  });
})(jQuery, window.dews, window.kendo);


/*
 * 다이얼로그 창
 */
(function ($, dews, kendo) {
  var defaultOptions = {
    modal: true, // 모달 여부
    width: 360, // 다이얼로그 너비(px)
    height: "auto", // 다이얼로그 높이(px)
    draggable: true, // 다이얼로그 이동 가능 여부
    resizable: false, // 다이얼로그 사이즈 조절 가능 여부
    size: "small" // 다이얼로그 기본 사이즈 설정
  };

  /**
   * 메세지 박스를 생성합니다.
   * @param {string} type alert, confirm, error 종류
   * @param {string, object} msg 메제시 출력 (error에서 자세히가 포함될경우 object가 올수도있다)
   * @param {string} icon align, icon의 종류 설정
   * @param {boolean} cancel confirm메세지 박스일경우 cancel추가 유무 기본값 false
   */
  function MsgBoxWindow(type, msg, icon, cancel, customButton) {
    var self = this,
      callbackResult;

    if ($.type(icon) === "undefined") {
      self.icon = "";
      self.buttonFocus = "yes";
    } else if ($.type(icon) === "object") {
      self.align = icon.align;
      self.icon = icon.icon;
      self.target = icon.target;
      if ($.type(icon.buttonFocus) == "undefined" || icon.buttonFocus === true || icon.buttonFocus === "yes") {
        self.buttonFocus = "yes";
      } else {
        self.buttonFocus = icon.buttonFocus;
      }
    } else {
      self.icon = icon;
      self.buttonFocus = "yes";
    }

    self.cancel = cancel || false;

    // resolve와 reject 상태별로 호출할 함수들
    self.resolves = [];
    self.rejects = [];
    self.always = [];

    self.dfd = $.Deferred();

    self.option = defaultOptions;
    self.dialog = null;
    //self.target = window;
    self.message = "";
    self.detailMessage = "";
    self.msgType = type;
    self.$ok = "";
    self.$yes = "";
    self.$no = "";
    self.$cancel = "";
    //self.$detail = '';
    //self.$report = '';
    self.$container = "";
    self.$kwindow = null;
    self.item = null;
    self.customButton = customButton;
    self.$customButton = [];

    // 메시지박스를 닫은 후 포커싱을 줄 대상을 담을 변수
    self.closed = null;

    if (typeof msg === "string") {
      self.message = msg;
      self.option.width = 360;
    } else if (_typeof(msg) === "object") {
      if (msg.hasOwnProperty("message")) {
        self.message = msg.message;
        self.detailMessage = msg.error;
        self.option.width = 460;
      }
    }

    if ($(".dews-ui-msgbox-dialog").length === 0) {
      // 다이얼로그를 엽니다.
      self._open();
      // 다이얼로그에 컨트롤들을 추가합니다.
      // self._insertFrame(msg);
      // 다이얼로그의 각 컨트롤들에 이벤트를 바인딩합니다.
      self._initEventListener();

      self.dfd.
      promise().
      done(function () {
        callbackResult = "resolves";
      }).
      fail(function () {
        callbackResult = "rejects";
      }).
      always(function () {
        self._close(callbackResult || "");
      });
    }
  }

  MsgBoxWindow.prototype._close = function (callbackType) {
    var idx,
      self = this;

    if (self.dialog._kendoWindow && !self.dialog._kendoWindow._closing) {
      self.dialog._kendoWindow.bind("close", function () {
        if (callbackType && $.isArray(self[callbackType]) && self[callbackType].length > 0) {
          for (idx = 0; idx < self[callbackType].length; idx++) {
            self[callbackType][idx].call(self, self);
          }
        }

        if ($.isArray(self.always) && self.always.length > 0) {
          for (idx = 0; idx < self.always.length; idx++) {
            self.always[idx].call(self, self);
          }
        }
      });

      self.dialog._kendoWindow.close();

      // 다이얼로그에서 메시지박스 띄운 후 닫고, 다이얼로그에서 tooltip 띄울 때
      // 다이얼로그 뒤에 뜸 (kendo의 toFront() 에서 메시지박스의 z-index 값을 찾아서 다이얼로그에 세팅해줘서)
      // 그래서 close 하고 난 뒤 원래의 z-index 값으로 되돌려놓음
      self.dialog._kendoWindow.wrapper.css("zIndex", self.option._zIndex);
      delete self.option._zIndex;
    }
  };

  MsgBoxWindow.prototype.clean = function () {
    var idx,
      self = this;

    if (
    !self.dialog._kendoWindow &&
    self.dialog._kendoWindow.is(":visible") &&
    !self._dialog._kendoWindow.closing)
    {
      self.dialog._kendoWindow.close();
    }

    for (idx = 0; idx < self.always.length; idx++) {
      self.always[idx].call(self);
    }
  };

  MsgBoxWindow.prototype.yes = function (fn) {
    var self = this;
    // 함수 배열에 추가
    self.resolves.push(fn);
    //함수를 계속 순환하여 사용하므로 자기 자신을 계속 반환
    return self;
  };

  MsgBoxWindow.prototype.no = function (fn) {
    var self = this;
    self.rejects.push(fn);
    return self;
  };

  MsgBoxWindow.prototype.done = function (fn) {
    var self = this;
    self.always.push(fn);
    return self;
  };

  // closed 이벤트 발생 시 deactivate 이벤트 호출
  MsgBoxWindow.prototype.on = function () {
    var self = this,
      kWin = self.dialog._kendoWindow;

    if (arguments[0] === "closed") {
      Array.prototype.splice.apply(arguments, [0, 1, "deactivate"]);
      kWin.bind.apply(kWin, arguments);
    }
  };

  MsgBoxWindow.prototype._initEventListener = function () {
    var self = this,
      kWin = self.dialog._kendoWindow;

    if (self.customButton) {
      for (var i = 0; i < self.$customButton.length; i++) {
        self.$customButton[i].on("click", function (e) {
          self.customButton[parseInt($(e.currentTarget).attr("id"))].callback(self);
        });
      }
    } else {
      self.$ok.on("click", function () {
        self.dfd.resolve();
      });
      self.$yes.on("click", function () {
        self.dfd.resolve();
      });
      self.$no.on("click", function () {
        self.dfd.reject();
      });
      self.$cancel.on("click", function () {
        self._close();
      });
    }

    kWin.bind("close", function (e) {
      // esc 키로 종료시에 _close()
      if (e.userTriggered) {
        self._close();
      }
    });

    kWin.bind("activate", function () {
      var msgBox = self.dialog.$content.closest(".k-window.dialog");

      if (
      msgBox.siblings(".k-window.dialog") &&
      parseInt(msgBox.siblings(".k-window.dialog").css("zIndex")) > parseInt(msgBox.css("zIndex"), 10))
      {
        msgBox.siblings(".k-window.dialog").css("zIndex", parseInt(msgBox.css("zIndex")) - 2);
      }
      if (self.msgType === "alert") {
        self.$ok.focus();
      } else if (self.msgType === "confirm") {
        if (self.customButton) {
          self.$customButton[0].focus();
        } else {
          if (self.buttonFocus === "yes") {
            self.$yes.focus();
          } else if (self.buttonFocus === "no") {
            self.$no.focus();
          } else if (self.cancel === true) {
            if (self.buttonFocus === "cancel") {
              self.$cancel.focus();
            }
          }
        }
      } else if (self.msgType === "error") {
        self.$ok.focus();
      }
    });

    self.item.parent().addClass("msgbox");
    self.item.prev().addClass("msgbox");

    self.item.
    parent().
    find(".k-window-action").
    on("click", function (e) {
      self.clean();
      e.preventDefault();
    });
  };

  MsgBoxWindow.prototype._open = function () {
    var self = this,
      dialog,
      title = "",
      zIndex = dews.ui.getDialogMaxZIndex();

    switch (self.msgType) {
      case "alert":
        title = dews.localize.get("dews_확인");
        break;
      case "confirm":
        title = dews.localize.get("dews_선택");
        break;
      case "error":
        title = dews.localize.get("dews_오류");
        break;
      default:
        title = "";
        break;}


    dialog = dews.ui.dialog(
    "dews-msgbox-" + self.msgType,
    $.extend(true, {}, self.option, {
      title: title,
      open: function open() {
        self._insertFrame();
      }
    }));

    self.dialog = dialog;
    dialog.open(true);

    // 다이얼로그에서 메시지박스 띄운 후 닫고, 다이얼로그에서 tooltip 띄울 때 다이얼로그 뒤에 뜸
    // (kendo의 toFront() 에서 메시지박스의 z-index (1000 이상) 값을 찾아서 다이얼로그에 세팅해줘서)
    // 그래서 close 하고 난 뒤 원래의 z-index 값으로 되돌려놓음
    self.option._zIndex = self.dialog._kendoWindow.wrapper.css("zIndex");

    // 타겟 옵션 추가
    if (self.target !== undefined) {
      var setid = "#" + self.target;

      var targetWidth = $(setid).width();
      var targetHeight = $(setid).height();
      var msgBoxWidth = parseInt(self.dialog._kendoWindow.wrapper.css("width"));
      var msgBoxHeight = parseInt(self.dialog._kendoWindow.wrapper.css("height"));

      if ($(setid).size() !== 0) {
        // 1. 폭, 높이가 다이얼로그보다 큰 경우 : 폭, 높이 가운데 맞춤
        if (msgBoxWidth < targetWidth) {
          self.dialog._kendoWindow.wrapper.css({
            left:
            $(setid).offset().left +
            ($(setid).width() - parseInt(self.dialog._kendoWindow.wrapper.css("width"))) / 2
          });

          if (msgBoxHeight < targetHeight) {
            self.dialog._kendoWindow.wrapper.css({
              top:
              $(setid).offset().top +
              ($(setid).height() - parseInt(self.dialog._kendoWindow.wrapper.css("height"))) / 2
            });
          } else {
            self.dialog._kendoWindow.wrapper.css({
              top: $(setid).offset().top
            });
          }
        } else {
          self.dialog._kendoWindow.wrapper.css({
            left: $(setid).offset().left
          });

          if (msgBoxHeight < targetHeight) {
            self.dialog._kendoWindow.wrapper.css({
              top:
              $(setid).offset().top +
              ($(setid).height() - parseInt(self.dialog._kendoWindow.wrapper.css("height"))) / 2
            });
          } else {
            self.dialog._kendoWindow.wrapper.css({
              top: $(setid).offset().top
            });
          }
        }

        $(".k-overlay").css("top", $(setid).offset().top);
        $(".k-overlay").css("left", $(setid).offset().left);
        $(".k-overlay").css("width", targetWidth);
        $(".k-overlay").css("height", targetHeight);
      }
    }

    // 프로그래스바보다 z-index 높이기 위해 10001로 설정
    if (zIndex < 10001) {
      zIndex = 10001;
    }

    if (zIndex > parseInt(self.dialog._kendoWindow.element.closest(".k-window.dialog").css("zIndex"), 10)) {
      self.dialog._kendoWindow.element.closest(".k-window.dialog").css("zIndex", zIndex + 2);

      if (zIndex > parseInt($("body > .k-overlay").css("zIndex"), 10)) {
        $("body > .k-overlay").css("zIndex", zIndex + 1); // // 다이얼로그가 하나라도 띄워져 있을 때는 1000 이상의 값 가져야함
      }
    }
    // else {
    //     self.dialog._kendoWindow.element.closest('.k-window.dialog').css('zIndex', 1000);
    // }
  };

  MsgBoxWindow.prototype._insertFrame = function (msg) {
    var innerHTML = "",
      self = this,
      $buttonGroup;

    self.item = self.dialog.target.$("#dews-msgbox-" + self.msgType);
    self.item.addClass("dews-ui-msgbox-dialog");

    if (self.customButton) {
      for (var i = 0; i < self.customButton.length; i++) {
        self.$customButton.push(
        $(
        '<button type="button" class="dews-ui-button yes dews-control k-button dews-control-activate">').
        text(dews.localize.get(self.customButton[i].title, "dews_" + self.customButton[i].title)));

        self.$customButton[i].attr("id", i);

        if (self.customButton[i].size) {
          self.$customButton[i].addClass(self.customButton[i].size);
        }
      }
    } else {
      self.$ok = $(
      '<button type="button" class="dews-ui-button ok dews-control confirm k-button dews-control-activate">').
      text(dews.localize.get("확인", "dews_확인"));
      self.$yes = $(
      '<button type="button" class="dews-ui-button yes dews-control confirm k-button dews-control-activate">').
      text(dews.localize.get("예", "dews_예"));
      self.$no = $(
      '<button type="button" class="dews-ui-button no dews-control confirm k-button dews-control-activate">').
      text(dews.localize.get("아니요", "dews_아니요"));
      self.$cancel = $(
      '<button type="button" class="dews-ui-button cancel dews-control confirm k-button dews-control-activate">').
      text(dews.localize.get("취소", "dews_취소"));
    }
    self.$container = $('<div class="dews-ui-msgbox ' + self.icon + '"></div>');

    innerHTML += '    <div class="dews-ui-msgbox-content">';
    if (!self.align) {
      innerHTML += "    <pre>" + self.message + "</pre>";
    } else {
      innerHTML += '    <pre style = "text-align: ' + self.align + ';">' + self.message + "</pre>";
    }
    innerHTML += "    </div>";
    innerHTML += '    <div class="dews-msgbox-botton-group bottom"></div>';

    self.$container.html(innerHTML);
    self.item.prepend(self.$container);

    $buttonGroup = self.$container.find(".dews-msgbox-botton-group");

    if (self.msgType === "alert") {
      $buttonGroup.append(self.$ok);
    } else if (self.msgType === "confirm") {
      if (self.customButton) {
        for (var i = 0; i < self.$customButton.length; i++) {
          $buttonGroup.append(self.$customButton[i]);
        }
      } else {
        $buttonGroup.append(self.$yes);
        $buttonGroup.append(self.$no);
        if (self.cancel === true) {
          $buttonGroup.append(self.$cancel);
        }
      }
    } else if (self.msgType === "error") {
      $buttonGroup.append(self.$ok);
    }
  };

  MsgBoxWindow.prototype.promise = function () {
    var self = this;
    return self.dfd.promise();
  };

  $.extend(true, dews, {
    alert: function alert(txt, icon) {
      var alertMsg = new MsgBoxWindow("alert", txt, icon);

      return alertMsg;
    },
    confirm: function confirm(txt, icon, cancel, customButton) {
      var confirmMsg;

      if (typeof icon === "boolean") {
        confirmMsg = new MsgBoxWindow("confirm", txt, "ico1", icon, customButton);
      } else if (Array.isArray(icon)) {
        confirmMsg = new MsgBoxWindow("confirm", txt, "ico1", false, icon);
      } else {
        confirmMsg = new MsgBoxWindow("confirm", txt, icon, cancel, customButton);
      }

      return confirmMsg;
    },
    error: function error(txt) {
      var errorMsg = new MsgBoxWindow("error", txt);

      return errorMsg;
    }
  });
})(jQuery, window.dews, window.kendo);


/**
 * 멀티 코드 피커
 */
(function ($, dews) {
  var defaultOptions = {
    useButton: true, // 찾기 버튼의 사용 여부
    codeField: "code", // 검색 결과에서의 코드 필드명
    textField: "text", // 검색 결과에서의 텍스트 필드명
    useAjax: true, // 도움창 오픈 전 AJAX를 통해서 먼저 확인할 지 여부
    helpCode: null, // 도움창의 아이디 및 코드 도움 요청 코드
    helpParams: null, // 코드 도움 및 도움창 요청에 추가적으로 필요한 파라미터
    helpTitle: "", // 도움창의 타이틀
    helpCustom: false, // 사용자 정의 도움창 사용 여부
    helpViewUrl: "", // 도움창 URL (생략시 도움창 URL을 자동 생성)
    helpWidth: null, // 도움창 기본 너비
    helpHeight: null, // 도움창 기본 높이
    helpSize: "medium",
    moveFocus: true // 코드피커 값 설정 후 패널에서 포커스 넘어갈것인지 여부
  };

  function getOptions($el, srcOptions) {
    var options = {},
      inlineOptions;

    inlineOptions = getInlineOptions($el, defaultOptions);
    $.extend(true, options, defaultOptions, inlineOptions, srcOptions);

    return options;
  }

  function getInlineOptions($el, defaultOptions) {
    var options = {};
    var inlineData = {
      useButton: $el.data("dews-use-button") || defaultOptions.useButton,
      codeField: $el.data("dews-code-field") || defaultOptions.codeField,
      textField: $el.data("dews-text-field") || defaultOptions.textField,
      useAjax: $el.data("dews-ajax"),
      helpCode: $el.data("dews-help-code") || defaultOptions.helpCode,
      helpParams: getHelpParams($el),
      // helpTitle: $el.data('dews-help-title') || defaultOptions.helpTitle,
      helpTitle:
      dews.localize.get(
      $el.data("dews-help-title"),
      $el.data("dews-localize-key"),
      $el.data("dews-localize-lang") || null) ||
      defaultOptions.helpTitle,
      helpCustom: $el.data("dews-help-custom") || defaultOptions.helpCustom,
      helpViewUrl: $el.data("dews-help-view-url") || defaultOptions.helpViewUrl,
      helpWidth: $el.data("dews-help-width") || defaultOptions.helpWidth,
      helpHeight: $el.data("dews-help-height") || defaultOptions.helpHeight,
      helpSize: $el.data("dews-help-size") || defaultOptions.helpSize,
      moveFocus:
      $.type($el.data("dews-move-focus")) === "boolean" ?
      $el.data("dews-move-focus") :
      defaultOptions.moveFocus
    };

    options = $.extend(true, options, defaultOptions, inlineData);

    return options;
  }

  function getHelpParams($element) {
    var str = $element.data("dews-help-params"),
      data = defaultOptions.helpParams;

    if (str) {
      data = $.deparam(str);
    }

    return data;
  }

  //멀티코드피커 클래스
  function MultiCodepicker($el, options) {
    var self = this;

    self.target = $el;
    self.options = options;

    //초기화 실행
    self._init();
  }

  /**
   * 시용자 가이드를 위한 API 를 추가합니다.
   * @param $element 대상 jQuery 요소
   * @param instance DEWS 컴포넌트 인스턴스
   */
  function setUserGuideAPI($element) {
    $element.on("focus", function () {
      var id = $element.
      parents(".dews-multicodepicker-wrapper").
      children("select.dews-ui-multicodepicker").
      attr("id");
      if (dews.ui.page && dews.ui.page.hasUserGuide) {
        if ($.isFunction(dews.ui.page.focusGuideItem) && id) {
          dews.ui.page.focusGuideItem("#" + id);
        }
      }
    });
  }

  //초기화
  MultiCodepicker.prototype._init = function () {
    var self = this,
      $element = self.target;

    self.inputText = null;
    self.listPosition = null;
    self.wrapper = null;
    self.container = null;
    self.item = null;
    self.position = 0;
    self.bindLogic;
    self.serializeLogic;

    // input 태그 생성
    self._setInputElement();
    // list 태그 생성
    self._setListElement();
    // 이벤트 바인딩
    self._initEventListener();
    // 상태별 클래스 설정
    self._initSetStateClass();
    // 초기값 설정
    self._setDefaultData();
    // 리스트 갯수 체크후 Text 설정
    self._setText();

    setUserGuideAPI($(".dews-multicodepicker-text", $element.parent(".dews-multicodepicker-wrapper")));
  };

  /**
   * 컨트롤에 설정된 기본 코드 및 텍스트를 적용합니다.
   * @private
   */
  MultiCodepicker.prototype._setDefaultData = function () {
    var self = this,
      $el = self.target,
      code,
      text,
      data;

    code = $el.data("code") || "";
    text = $el.data("text") || "";

    data = {};
    data[self.options.codeField] = code;
    data[self.options.textField] = text;

    if (code !== "") {
      self.setData(data);
    }
  };

  /**
   * 멀티코드 피커의 코드 도움 파라미터를 설정합니다.
   * @param {object|function} params 설정할 파라미터 객체 또는 함수
   */
  MultiCodepicker.prototype.setHelpParams = function (params) {
    var self = this;

    self.options.helpParams = params;
  };

  /**
   * 멀티코드피커의 코드와 텍스트를 모두 빈 값으로 초기화합니다.
   */
  MultiCodepicker.prototype.clearData = function () {
    var self = this;

    // clearData의 arguments 배열을 clear 파라미터로 보내줍니다. (apply는 파라미터로 배열을 받음)
    self.clear.apply(self, Array.prototype.slice.call(arguments));
  };

  MultiCodepicker.prototype.clear = function () {
    var self = this;
    var setDataEvent;
    var isTrigger = true;

    if ($.type(arguments[0]) === "boolean") {
      if (!arguments[0]) {
        isTrigger = false;
      }
    }

    //setData 이벤트 발생
    setDataEvent = new $.Event("setData");
    // isTrigger 값이 false 인 경우 setData 이벤트 발생하지 않습니다.
    if (isTrigger) {
      setDataEvent.codeData = [];

      self.target.trigger(setDataEvent);

      if (setDataEvent.isDefaultPrevented()) {
        // 이벤트 핸들러에서 preventDefault를 호출했을 때는
        // 값의 변경등을 더 이상 진행하지 않습니다.
        return;
      }
    }

    self._blank();
  };

  /**
   * 멀티코드 피커에 설정된 코드를 가져옵니다.
   * @returns {number} 인덱스
   */
  MultiCodepicker.prototype.code = function (num) {
    var self = this,
      $el = self.target.find("option");

    if (typeof num !== "undefined") {
      return $el.eq(num).attr("value");
    }
  };

  /**
   * 멀티 코드피커에 설정된 모든 코드값을 가져옵니다.
   * @private
   */
  MultiCodepicker.prototype.codes = function () {
    var self = this,
      $options = self.target.find("option"),
      codes = [];

    $.each($options, function () {
      var $this = $(this);
      codes.push($this.val());
    });

    return codes;
  };

  /**
   * 멀티코드 피커에 설정된 텍스트를 가져옵니다.
   * @returns {number} 인덱스
   */
  MultiCodepicker.prototype.text = function (num) {
    var self = this,
      $el = self.target.find("option");

    if (typeof num !== "undefined") {
      return $el.eq(num).text();
    }
  };

  /**
   * 멀티 코드피커에 설정된 모든 텍스트값을 가져옵니다.
   * @private
   */
  MultiCodepicker.prototype.texts = function () {
    var self = this,
      $options = self.target.find("option"),
      texts = [];

    $.each($options, function () {
      var $this = $(this);

      texts.push($this.text());
    });

    return texts;
  };

  /**
   * 멀티코드피커에 코드와 텍스트를 설정합니다.
   * @param {object} data 코드와 텍스트
   */
  MultiCodepicker.prototype.setData = function (data) {
    var self = this,
      selected,
      setDataEvent,
      $option,
      isTrigger = true, // 기본값 true
      duplicationCheck = function duplicationCheck(code) {
        var $options = self.target.find("option"),
          duplicate = false;

        for (var i = 0; i < $options.length; i++) {
          var data = $options.eq(i).data("dews-data");

          if (data) {
            if (code === data[self.options.codeField]) {
              duplicate = true;
              break;
            }
          }
        }
        return duplicate;
      };

    //배열일 때만 항목을 생성
    if ($.type(data) === "array") {
      if ($.type(arguments[1]) === "boolean") {
        if (!arguments[1]) {
          isTrigger = false;
        }
      }

      //setData 이벤트 발생
      setDataEvent = new $.Event("setData");
      // isTrigger 값이 false 인 경우 setData 이벤트 발생하지 않습니다.
      if (isTrigger) {
        setDataEvent.codeData = data;

        self.target.trigger(setDataEvent);

        if (setDataEvent.isDefaultPrevented()) {
          // 이벤트 핸들러에서 preventDefault를 호출했을 때는
          // 값의 변경등을 더 이상 진행하지 않습니다.
          return;
        }
      }

      if (data.length > 0) {
        for (var i = 0; i < data.length; i++) {
          if (!duplicationCheck(data[i][self.options.codeField])) {
            $option = $("<option />").
            val(data[i][self.options.codeField]).
            text(data[i][self.options.textField]).
            attr("selected", "selected").
            data("dews-data", data[i]);
            self.target.append($option);
          }
        }

        // 텍스트를 갱신
        self._setText();
        // 리스트 아이템을 갱신
        self._setListElement();

        self.target.trigger("_change");
      }
    }
  };

  /**
   * 멀티코드피커의 데이터를 가져옵니다.
   */
  MultiCodepicker.prototype.getData = function () {
    var self = this,
      getData = [],
      options = self.target.find("option");

    for (var i = 0; i < options.length; i++) {
      // html 에서 option 값 설정 후 getData API 호출 시 undefined 가 뜨는 문제때문에 추가한 코드
      if (options.eq(i).data("dews-data") === undefined) {
        var data = {};
        data[self.options.codeField] = options.eq(i).attr("value");
        data[self.options.textField] = options.eq(i).text();

        options.eq(i).data("dews-data", data);
      }
      getData.push(options.eq(i).data("dews-data"));
    }
    return getData;
  };

  MultiCodepicker.prototype._triggerCodeDialog = function (list, initData) {
    var self = this,
      helpEvent,
      $el = self.target,
      params;

    initData = initData || null;

    if ($.isFunction(self.options.helpParams)) {
      params = self.options.helpParams.call(self);
    } else {
      params = self.options.helpParams;
    }

    helpEvent = new $.Event("codedialog", {
      code: self.options.helpCode,
      codeField: self.options.codeField,
      params: $.extend(true, {}, params),
      title: self.options.helpTitle,
      mode: "multi",
      width: self.options.helpWidth,
      height: self.options.helpHeight,
      size: self.options.helpSize,
      custom: self.options.helpCustom,
      viewUrl: self.options.helpViewUrl,
      initData: initData,
      callback: function callback(data) {
        self.setData(data);
        self._focusMove = true;
      }
    });

    self._slideUp(self.wrapper);
    $el.trigger(helpEvent);
  };

  /**
   * 멀티코드피커의 상태별 클래스를 설정합니다.
   */
  //상태별 클래스 추가
  MultiCodepicker.prototype._initSetStateClass = function () {
    var self = this,
      $wrapper = self.target,
      $state = self.wrapper.children(".dews-multicodepicker-wrap");

    if ($wrapper.hasClass("required")) {
      $state.addClass("dews-state-required");
      //$wrapper.removeClass('required');
    }
    if ($wrapper.hasClass("readonly")) {
      $state.addClass("dews-state-readonly");
      $wrapper.removeClass("readonly");
      $state.find(".dews-select").hide();
      self.wrapper.off("click");
    }
    if ($wrapper.attr("readonly") && !$wrapper.hasClass("readonly")) {
      $state.addClass("dews-state-readonly");
      $state.find(".dews-select").hide();
      self.wrapper.off("click");
    }
    if ($wrapper.hasClass("disabled")) {
      $state.addClass("dews-state-disabled");
      $wrapper.removeClass("disabled");
      $state.find(".dews-select").hide();
      self.wrapper.off("mouseenter mouseleave mousedown click");
      self.inputText.prop("disabled", true);
    }
    if ($wrapper.attr("disabled") && !$wrapper.hasClass("disabled")) {
      $state.addClass("dews-state-disabled");
      $state.find(".dews-select").hide();
      self.wrapper.off("mouseenter mouseleave mousedown click");
      self.inputText.prop("disabled", true);
    }
    if ($wrapper.hasClass("etc1")) {
      $state.addClass("dews-state-etc1");
      $wrapper.removeClass("etc1");
    }
    if ($wrapper.hasClass("etc2")) {
      $state.addClass("dews-state-etc2");
      $wrapper.removeClass("etc2");
    }
    if ($wrapper.hasClass("etc3")) {
      $state.addClass("dews-state-etc3");
      $wrapper.removeClass("etc3");
    }
  };

  /**
   * 멀티코드피커의 활성화, 비활성화를 체크합니다
   * @param {boolean} true(활성화), false(비활성화)
   * @returns {boolean} 설정된 활성화 여부
   */
  MultiCodepicker.prototype.enable = function (value) {
    var self = this,
      $el = self.target,
      enabled;

    enabled = !$el.prop("disabled");

    if (typeof value !== "undefined") {
      // 설정
      if (value === false) {
        self._setDisabled();
      } else if (value === true) {
        self._removeDisabled();
      }
    } else {
      return enabled;
    }
  };

  /**
   * 멀티코드피커의 visible 여부를 가져옵니다.
   * @returns {boolean}
   * @private
   */
  MultiCodepicker.prototype._visibleCheckFromPanel = function () {
    var self = this,
      $ctrl = self.target,
      isVisible = $ctrl.closest(".dews-multicodepicker-wrapper").css("display") !== "none";

    return isVisible;
  };

  /**
   * 멀티코드피커를 required 상태로 설정하거나 해제합니다.
   * @param {boolean} true(required 상태 설정), false(required 상태 해제)
   */
  MultiCodepicker.prototype.required = function (value) {
    var self = this;
    var $el = self.target,
      $wrapper = self.wrapper;

    if ($.type(value) === "undefined") {
      return $el.hasClass("required");
    } else if (value === true) {
      if (!$el.hasClass("required")) {
        $el.addClass("required");
      }
      if (!$wrapper.hasClass("dews-state-required")) {
        $wrapper.addClass("dews-state-required");
      }
      if (!$wrapper.find(".dews-multicodepicker-wrap").hasClass("dews-state-required")) {
        $wrapper.find(".dews-multicodepicker-wrap").addClass("dews-state-required");
      }
    } else if (value === false) {
      if ($el.hasClass("required")) {
        $el.removeClass("required");
      }
      if ($wrapper.hasClass("dews-state-required")) {
        $wrapper.removeClass("dews-state-required");
      }
      if ($wrapper.find(".dews-multicodepicker-wrap").hasClass("dews-state-required")) {
        $wrapper.find(".dews-multicodepicker-wrap").removeClass("dews-state-required");
      }
    }
  };

  /**
   * 멀티코드피커를 비화성화 합니다.
   * @private
   */
  MultiCodepicker.prototype._setDisabled = function () {
    var self = this,
      $el = self.target,
      $wrapper = self.wrapper,
      $text = self.inputText;

    if (!$wrapper.find(".dews-multicodepicker-wrap").hasClass("dews-state-disabled")) {
      $wrapper.find(".dews-multicodepicker-wrap").addClass("dews-state-disabled");
    }

    $el.prop("disabled", true);

    if (!$el.hasClass("disabled")) {
      $el.addClass("disabled");
    }

    $wrapper.find(".dews-select").hide();
    $wrapper.off("mouseenter mouseleave mousedown click");
    $wrapper.find(".dews-select button").eq(1).off("click");

    $text.prop("disabled", true);
  };

  /**
   * 멀티코드피커를 활성화 합니다.
   * @private
   */
  MultiCodepicker.prototype._removeDisabled = function () {
    var self = this,
      $el = self.target,
      $wrapper = self.wrapper,
      $text = self.inputText;

    if ($wrapper.find(".dews-multicodepicker-wrap").hasClass("dews-state-disabled")) {
      $wrapper.find(".dews-multicodepicker-wrap").removeClass("dews-state-disabled");
      self._initEventListener();
    }

    $el.prop("disabled", false);

    if ($el.hasClass("disabled")) {
      $el.removeClass("disabled");
      // self._initEventListener();
    }

    $wrapper.find(".dews-select").show();
    $text.prop("disabled", false);

    if ($wrapper.find(".dews-multicodepicker-wrap").hasClass("dews-state-readonly")) {
      self.readonly(true);
    }
  };

  /**
   * 멀티코드피커의 읽기전용, 일기전용 해제를 설정합니다.
   * @param {boolean} true(읽기전용 설정), false(읽기전용 해제)
   */
  MultiCodepicker.prototype.readonly = function (value) {
    var self = this,
      $el = self.target,
      readonly;

    readonly = $el.prop("readonly");

    if (typeof value !== "undefined") {
      // 설정
      if (value === true) {
        self._setReadonly();
        readonly = value;
      } else if (value === false) {
        self._removeReadonly();
        readonly = value;
      }
    }

    return readonly;
  };

  /**
   * 멀티코드피커의 읽기전용을 설정합니다.
   * @private
   */
  MultiCodepicker.prototype._setReadonly = function () {
    var self = this,
      $el = self.target,
      $wrapper = self.wrapper;

    if (!$wrapper.find(".dews-multicodepicker-wrap").hasClass("dews-state-readonly")) {
      $wrapper.find(".dews-multicodepicker-wrap").addClass("dews-state-readonly");
    }

    $el.prop("readonly", true); // code 컨트롤에 readonly를 설정

    if (!$el.hasClass("readonly")) {
      $el.addClass("readonly");
    }

    $wrapper.find(".dews-select").hide();
    $wrapper.off("click");
  };

  /**
   * 멀티코드피커의 읽기전용을 해제합니다.
   * @private
   */
  MultiCodepicker.prototype._removeReadonly = function () {
    var self = this,
      $el = self.target,
      $wrapper = self.wrapper;

    if ($wrapper.find(".dews-multicodepicker-wrap").hasClass("dews-state-readonly")) {
      $wrapper.find(".dews-multicodepicker-wrap").removeClass("dews-state-readonly");
      self._initEventListener();
    }

    $el.prop("readonly", false); // code 컨트롤에서 reaodonly를 설정

    if ($el.hasClass("readonly")) {
      $el.removeClass("readonly");
      // self._initEventListener();
    }

    $wrapper.find(".dews-select").show();
  };

  /**
   * 멀티코드피커의 포커스를 설정합니다
   */
  MultiCodepicker.prototype.focus = function () {
    var self = this;
    self.inputText.triggerHandler("focus");
    self.inputText.focus();
  };

  /**
   * 멀티코드피커의 옵션을 가져옵니다.
   */
  MultiCodepicker.prototype.getOptions = function () {
    return this.options;
  };

  /**
   * 멀티코드피커의 옵션을 설정합니다.
   */
  MultiCodepicker.prototype.setOptions = function (options) {
    options = $.extend(true, {}, this.options, options);

    this.options = options;
  };

  /**
   * 멀티코드피커의 이벤트를 설정합니다.
   * @private
   */
  MultiCodepicker.prototype._initEventListener = function () {
    var self = this;
    var count = -1;

    //input에 포커스시 클래스 추가
    self.inputText.on("focusin", function (e) {
      $(this).parent().parent().addClass("dews-state-focused");

      $(this).keypress(function (e) {
        var key = e.keyCode || e.which;
        if ($.type(self.usePanelFocus) === "boolean" && !self.usePanelFocus) {
          if (key === 13) {
            self._setListElementPosition($(window).scrollTop());
            if ($(this).hasClass("dews-state-active") === true) {
              self._slideUp($(this));
              count = -1;
            } else {
              self._slideDown($(this));
            }

            event.stopPropagation();
          }
        }
      });

      e.preventDefault();
    });

    self.inputText.on("focusout", function () {
      $(this).parent().parent().removeClass("dews-state-focused");
      $(this).parent().parent().removeClass("dews-state-active");

      self._slideUp($(this));
      count = -1;
    });

    self.inputText.on("keydown", function (e) {
      var key = e.keyCode || e.which;
      if (key === 115) {
        // F4 - 도움창 단축키
        e.preventDefault();
        var $button = self.wrapper.find(".dews-select button").eq(1);
        if ($button.is(":visible:enabled")) {
          $button.click();
        }
        e.stopPropagation();
      }
    });

    //input에 관한 각종 이벤트
    self.wrapper.on("mouseenter mouseleave mousedown click", function (event) {
      if (event.type === "mouseenter") {
        $(this).addClass("dews-state-hover");
      } else if (event.type === "mouseleave") {
        $(this).removeClass("dews-state-hover");
      } else if (event.type === "mousedown") {
        $(this).addClass("dews-state-focused");
      } else if (event.type === "click") {
        self._setListElementPosition($(window).scrollTop());

        $(window).on("keyup", function (e) {
          if (e.keyCode === 27) {
            popoverClose();
          }
        });

        $(self.wrapper).parentsUntil("body").on("scroll", popoverClose);

        if ($(this).hasClass("dews-state-active") === true) {
          self._slideUp($(this));
          count = -1;
          $(self.wrapper).parentsUntil("body").off("scroll");
          window.removeEventListener("keydown", keyboardEvent, true);
          self.focus();
        } else {
          self._slideDown($(this));
          window.addEventListener("keydown", keyboardEvent, true);
        }

        event.stopPropagation();
      }
    });

    //리스트 아이템 이벤트
    self.container.on("mouseenter mouseleave mousedown mouseup", ".dews-item", function (e) {
      if (e.type === "mouseenter") {
        $(this).addClass("dews-state-hover");
      } else if (e.type === "mouseleave") {
        $(this).removeClass("dews-state-hover");
      } else if (e.type === "mousedown") {
        $(this).
        closest(".dews-list").
        find(".dews-item").
        filter(".dews-state-selected").
        removeClass("dews-state-selected");
        $(this).addClass("dews-state-selected");
        count = $(this).index();
      }

      e.stopPropagation();
    });

    self.target.on("setData", function () {
      self.focus();
    });
    self.target.on("codedialogclosed", function () {
      self.focus();
    });

    //리스트 닫기
    $(document).mouseup(function (e) {
      if (
      !self.wrapper.is(e.target) &&
      self.wrapper.has(e.target).length === 0 &&
      !self.container.is(e.target) &&
      self.container.has(e.target).length === 0)
      {
        self._slideUp(self.wrapper);
        count = -1;
        $(self.wrapper).parentsUntil("body").off("scroll");
        window.removeEventListener("keydown", keyboardEvent, true);
      }
    });

    //화면이 변했을경우 리스트 위치 세팅
    $(window).resize(function () {
      self._setListElementPosition(self.position);
    });
    $(window).scroll(function () {
      self.position = $(this).scrollTop();
    });

    //선택창
    self.wrapper.
    find(".dews-select button").
    eq(1).
    on("click", function (event) {
      self._triggerCodeDialog(self.texts, null);
      $(self.wrapper).parentsUntil("body").off("scroll");
      event.stopPropagation();
    });

    //팝오버창 닫힘 + 스크롤 이벤트 해제 함수
    function popoverClose() {
      self.container.stop().slideUp(50);
      $(self.wrapper).parentsUntil("body").off("scroll");
      $(window).off("keyup");
    }

    function keyboardEvent(e) {
      var $item = self.container.find(".dews-item").not(".none");
      var max = $item.length;
      var $ul = $item.closest(".dews-list");
      var footer = $item.closest(".dews-animation-container").find(".dews-footer");
      var footerTop = footer.length > 0 ? footer.offset().top : 0;
      var ulHeight = $ul.height();
      var wrapperBottomLineX = self.wrapper.offset().top + self.wrapper.height();
      var min = 0;
      var currentItem;

      self.container.on("_click", function (e) {
        count = e.itemIndex;
      });

      if (e.keyCode === 38) {
        // Up arrow
        self.container.find(".dews-all-delete").blur();

        if (min < count) {
          $item.eq(count).removeClass("dews-state-selected");
          count--;
          $item.eq(count).addClass("dews-state-selected");

          // 스크롤
          currentItem = $item.eq(count);
          if (count - 1 !== -1) {
            if (
            wrapperBottomLineX > $item.eq(count - 1).offset().top + currentItem.height() ||
            footerTop < $item.eq(count).offset().top)
            {
              $ul.scrollTop(currentItem.height() * count);
            }
          } else {
            $ul.scrollTop(0);
          }
        }

        e.preventDefault();
      } else if (e.keyCode === 40) {
        // Down arrow
        self.container.find(".dews-all-delete").blur();

        if (max - 1 > count) {
          count++;
          $item.filter(".dews-state-selected").removeClass("dews-state-selected");
          $item.eq(count).addClass("dews-state-selected");

          // 키보드로 스크롤
          currentItem = $item.eq(count);
          if (footerTop < currentItem.offset().top + currentItem.height()) {
            currentItem.closest("ul").scrollTop(currentItem.height() * (count + 1) - ulHeight);
          }
        } else {
          $item.filter(".dews-state-selected").removeClass("dews-state-selected");
          self.container.find(".dews-all-delete").focus();
          count = $item.length;
        }

        e.preventDefault();
      } else if (e.keyCode === 46) {
        // Delete
        if ($item.filter(".dews-state-selected").length > 0) {
          $item.filter(".dews-state-selected").find(".dews-close").click();
          count--;
          max = $item.length;
          $item.eq(count < 0 ? count === 0 : count).addClass("dews-state-selected");
        }
        e.preventDefault();
      } else if (e.keyCode === 36) {
        // Home
        self.container.find(".dews-all-delete").blur();
        $item.filter(".dews-state-selected").removeClass("dews-state-selected");
        $item.eq(0).addClass("dews-state-selected");
        count = min;

        // 스크롤
        $ul.scrollTop(0);

        e.preventDefault();
      } else if (e.keyCode === 35) {
        // End
        $item.filter(".dews-state-selected").removeClass("dews-state-selected");
        self.container.find(".dews-all-delete").focus();
        count = $item.length;
        e.preventDefault();
      }
    }
  };

  /**
   * 리스트가 위로 slideup될때 닫기누를시 위치값을 설정합니다.
   * @private
   */
  MultiCodepicker.prototype._upCloseSetPotion = function () {
    var self = this;
    if (self.listPosition === "up") {
      self.container.css({
        marginTop: -(self.container.height() - 2) //마진값 변경 (리스트전체 높이값 - input창 높이값)
      });
    }
  };

  /**
   * 멀티코드피커의 DOM을 세팅합니다.
   * @private
   */
  MultiCodepicker.prototype._setInputElement = function () {
    var self = this;
    var wrapper = $('<span class="dews-multicodepicker-wrapper" />');
    var innerWrapper = $("<span class=\"dews-multicodepicker-wrap\" />");

    var innerHtml = "";
    innerHtml += '    <input type="text" class="dews-multicodepicker-text" value="" readonly="readonly"/>';
    innerHtml += '    <span class="dews-select">';
    innerHtml +=
    '        <button type="button" class="dews-multicodepicker-button"><span class="dews-icon icon-arrow"></span></button>';
    innerHtml +=
    '        <button type="button" class="dews-multicodepicker-button"><span class="dews-icon icon-search"></span></button>';
    innerHtml += "    </span>";

    self.target.wrap(wrapper);
    self.wrapper = self.target.parent();
    innerWrapper.prependTo(self.wrapper);
    $(innerHtml).prependTo(innerWrapper);

    copyStyle(self.wrapper, self.target);
    copyStyle(innerWrapper, self.target);

    var idName = self.target.prop("id");
    self.inputText = $(".dews-multicodepicker-text", self.wrapper);
    self.target.prop({
      multiple: true,
      name: idName
    });
  };

  /**
   * targetElement에 styledElement의 style을 적용합니다.
   * @param $targetElement
   * @param $styledElement
   */
  function copyStyle($targetElement, $styledElement) {
    $targetElement.attr("style", getStyles($styledElement));
  }

  function getStyles($element) {
    return $element.attr("style");
  }

  /**
   * 멀티코드피커의 리스트에 대한 DOM을 세팅합니다.
   * @private
   */
  MultiCodepicker.prototype._setListElement = function () {
    var self = this,
      container,
      innerHtml = "";

    container = $('<div class="dews-animation-container" />');
    self.container = container;

    innerHtml += '<div class="dews-list-container">';
    innerHtml += '   <ul class="dews-list">';
    innerHtml += "   </ul>";
    innerHtml += '   <div class="dews-footer">';
    innerHtml +=
    '      <button type="button" class="dews-all-delete"><span>' +
    dews.localize.get("전체삭제", "dews_전체삭제") +
    "</span></button>";
    innerHtml += "   </div>";
    innerHtml += "</div>";

    self.container.empty().append($(innerHtml));

    $("body").append(self.container);

    self._setListItemElement();

    //리스트 위치값 세팅
    self._setListElementPosition(self.position);
  };

  /**
   * 멀티코드피커의 리스트 아이템에 대한 DOM 및 값을 세팅합니다.
   * @private
   */
  MultiCodepicker.prototype._setListItemElement = function () {
    var self = this,
      item = self.target.find("option");

    for (var i = 0; i < item.length; i++) {
      if ($.type(item.data("dews-localize-key") !== "undefined")) {
        self.container.
        find(".dews-list").
        append(
        '<li class="dews-item" value="' +
        item.eq(i).attr("value") +
        '">' +
        dews.localize.get(
        item.eq(i).text(),
        item.data("dews-localize-key"),
        item.data("dews-localize-lang") || null) +

        '<button type="button" class="dews-close"><span> </span></button></li>');

      } else {
        self.container.
        find(".dews-list").
        append(
        '<li class="dews-item" value="' +
        item.eq(i).attr("value") +
        '">' +
        item.eq(i).text() +
        '<button type="button" class="dews-close"><span> </span></button></li>');

      }
    }

    self._setListInitEventListener();
  };

  MultiCodepicker.prototype._setTooltip = function (item) {
    var self = this,
      tooltip = dews.ui.tooltip.show(item, {
        type: "normal",
        position: "left",
        text: item.attr("value"),
        fadeOutTime: 0
      });

    self._tooltip = tooltip;
  };

  /**
   * 멀티코드피커의 리스트 아이템에 대한 이벤트를 설정합니다.
   * @private
   */
  MultiCodepicker.prototype._setListInitEventListener = function () {
    var self = this,
      $overItem = null;

    //리스트 아이템
    self.item = self.container.find(".dews-list li");

    //리스트 아이템 오버
    self.item.on("mouseenter", function () {
      if ($overItem !== null) {
        $overItem.removeClass("dews-state-hover");
        if (self._tooltip) {
          self._tooltip._delete();
        }
      }
      $(this).addClass("dews-state-hover");

      $overItem = $(this);

      self._setTooltip($(this));
    });

    //리스트컨테이너 아웃
    self.container.find(".dews-list").on("mouseleave", function () {
      if ($overItem !== null) {
        $overItem.removeClass("dews-state-hover");
        if (self._tooltip) {
          self._tooltip._delete();
        }
      }
    });

    //전체 삭제
    self.container.find(".dews-all-delete").on("click", function () {
      var evt,
        data = {},
        items,
        codeData;

      codeData = self.getData();
      items = self.item;
      evt = $.Event("itemDelete", {
        mode: "all",
        codeData: codeData,
        items: items
      });
      self.target.trigger(evt);

      if (evt.isDefaultPrevented()) {
        return;
      }
      self.clearData();
      self._blank();
      self._upCloseSetPotion();

      self.target.trigger("_change");
    });

    //닫기 버튼 이벤트
    self.item.find(".dews-close").on("click", function () {
      var length = self.container.find(".dews-list li").length,
        targetElement = $(this).parent(),
        options = self.target.find("option");
      var value = targetElement.attr("value");
      var idx = targetElement.index();
      var items = [],
        codeData = [],
        data = {};
      if (options.eq(idx).data("dews-data") === undefined) {
        data[self.options.codeField] = value;
        data[self.options.textField] = targetElement.text();
      } else {
        data = options.eq(idx).data("dews-data");
      }

      codeData.push(data);
      items.push(targetElement);
      var evt = $.Event("itemDelete", {
        mode: "item",
        codeData: codeData,
        items: items
      });

      self.target.trigger(evt);

      if (evt.isDefaultPrevented()) {
        return;
      }

      $(this).parent().remove();
      self.target.find("option").eq(idx).remove();
      //리스트가 1개일때
      if (length === 1) {
        self._blank();
      }

      //리스트가 위로 올라갔을때
      self._upCloseSetPotion();

      if (self._tooltip) {
        self._tooltip._delete();
      }

      self._setText();

      self.target.trigger("_change");
    });
  };

  /**
   * 멀티코드피커의 리스트에 대한 위치 값을 세팅합니다.
   * @param {number} 스크롤값
   */
  MultiCodepicker.prototype._setListElementPosition = function (scrollPos) {
    var self = this;

    var positionX = self.wrapper.offset().left; //X위치값
    var positionY = self.wrapper.offset().top; //Y위치값
    var selectHeight = self.wrapper.height(); //input 높이값
    var selectWidth = self.wrapper.width(); //input 넓이값
    var scrollPosition = $(window).scrollTop();
    var zIndex = dews.ui.getDialogMaxZIndex();

    if (zIndex > parseInt(self.container.css("zIndex"), 10)) {
      self.container.css("zIndex", zIndex + 2);
    }

    $(".dews-list", self.container).css({
      maxHeight: "",
      overflow: "none"
    });

    // MAX-HEIGHT 설정 및 열리는 방향 설정
    var maxHeight = 0;
    var listMargin = 10;
    var winHeight = $(window).height();
    var listHeight = self.container.height();
    var vaTopHeight = positionY - scrollPosition - listMargin;
    var vaBottomHeight = winHeight - (vaTopHeight + selectHeight) - listMargin;
    var useMaxHeight = listHeight > vaTopHeight && listHeight > vaBottomHeight;
    var openToTop = listHeight > vaBottomHeight && vaTopHeight > vaBottomHeight;

    if (useMaxHeight) {
      maxHeight = openToTop ? vaTopHeight : vaBottomHeight;
      $(".dews-list", self.container).css({
        maxHeight: maxHeight - selectHeight * 2 + "px",
        overflow: "auto"
      });
    }

    if (openToTop) {
      //위로 열릴때
      self.container.css({
        left: positionX,
        top: positionY - 1,
        width: selectWidth
      });

      self.listPosition = "up";
      self.container.
      find(".dews-list-container").
      addClass("dews-state-border-down").
      removeClass("dews-state-border-up");
      self.wrapper.
      find(".dews-multicodepicker-wrap").
      addClass("dews-state-border-up").
      removeClass("dews-state-border-down");
    } else {
      //아래로 열릴때
      self.container.css({
        left: positionX,
        top: positionY + selectHeight,
        width: selectWidth
      });

      self.listPosition = "down";
      self.container.
      find(".dews-list-container").
      addClass("dews-state-border-up").
      removeClass("dews-state-border-down");
      self.wrapper.
      find(".dews-multicodepicker-wrap").
      addClass("dews-state-border-down").
      removeClass("dews-state-border-up");
    }
  };

  /**
   * 멀티코드피커의 리스트 갯수의 text를 세팅합니다.
   * @private
   */
  MultiCodepicker.prototype._setText = function () {
    var self = this,
      item;
    item = self.target.find("option");

    if (item.length === 0) {
      self._blank();
    } else if (item.length === 1) {
      self.inputText.empty().attr("value", item.eq(0).text());
    } else {
      self.inputText.
      empty().
      attr(
      "value",
      item.eq(0).text() +
      " " +
      dews.localize.get("외", "dews_외") +
      " " + (
      item.length - 1) +
      dews.localize.get("건", "dews_건"));

    }
  };

  /**
   * 멀티코드피커의 리스트에 대한 애니메이션 입니다.
   * @param {string} 슬라이드 대상
   */
  MultiCodepicker.prototype._slideDown = function (item) {
    var self = this;
    var moveNum = self.container.height();

    item.addClass("dews-state-active");

    if (self.listPosition === "down") {
      //아래로 열릴때
      self.container.css({
        marginTop: 0
      });
      self.container.stop().slideDown(200);
    } else {
      //위로 열릴때
      self.container.css({
        marginTop: -(moveNum - 2)
      });
      self.container.stop().slideDown(200);
    }
  };

  /**
   * 멀티코드피커의 리스트에 대한 애니메이션 입니다.
   * @param {string} 슬라이드 대상
   */
  MultiCodepicker.prototype._slideUp = function (item) {
    var self = this;

    item.removeClass("dews-state-active");
    item.removeClass("dews-state-focused");
    self.container.find(".dews-item").removeClass("dews-state-selected");
    self.container.find(".dews-all-delete").blur();
    self.container.stop().slideUp(200);
    self.container.css("zIndex", "");
  };

  /**
   * 멀티코드피커에 리스트가 없을때 설정합니다.
   * @private
   */
  MultiCodepicker.prototype._blank = function () {
    var self = this;
    self.container.
    find(".dews-list").
    empty().
    append(
    '<li class="dews-item none">' +
    dews.localize.get("데이터가 없습니다.", "dews_데이터가 없습니다.") +
    "</li>");

    self.inputText.attr("value", "");
    self.container.find(".dews-footer").hide();
    self.target.empty();
  };

  MultiCodepicker.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change", "click", "codedialog", "setData"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "change") {
          self.target.trigger("_change");
        } else if (event === "click") {
          self.target.trigger("_click");
        } else {
          self.target.trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  /**
   * DEWS 객체에 직접 이벤트 핸들러를 등록합니다.
   */
  MultiCodepicker.prototype.on = function () {
    var self = this;

    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    } else if (arguments[0] === "click") {
      Array.prototype.splice.apply(arguments, [0, 1, "_click"]);
    }
    self.target.on.apply(self.target, arguments);
  };

  /**
   * DEWS 객체에 직접 등록한 이벤트 핸들러를 해제합나다.
   */
  MultiCodepicker.prototype.off = function () {
    var self = this;

    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    } else if (arguments[0] === "click") {
      Array.prototype.splice.apply(arguments, [0, 1, "_click"]);
    }
    self.target.off.apply(self.target, arguments);
  };

  MultiCodepicker.prototype.validate = function () {
    var self = this;
    return $.isArray(self.codes()) && self.codes().length > 0;
  };

  // 멀티코드피커의 바인딩 로직을 외부에서 주입 받기 위한 함수
  MultiCodepicker.prototype.setBindFormPanelLogic = function (logic) {
    var self = this;

    if ($.isFunction(logic)) {
      self.bindLogic = logic;
    }
  };

  // 멀티코드피커의 직렬화 로직을 외부에서 주입 받기 위한 함수
  MultiCodepicker.prototype.setSerializeForPanelLogic = function (logic) {
    var self = this;

    if ($.isFunction(logic)) {
      self.serializeLogic = logic;
    }
  };

  MultiCodepicker.prototype.bindFromPanel = function (data) {
    var self = this;

    if (data) {
      if ($.isFunction(self.bindLogic)) {
        self.bindLogic.call(self, data);
      }
    }
  };

  MultiCodepicker.prototype.serializeForPanel = function () {
    var self = this;
    var data;

    if ($.isFunction(self.serializeLogic)) {
      data = self.serializeLogic.call(self);
    }

    return data;
  };

  MultiCodepicker.prototype.applyPanelFocus = function (requiredCheck) {
    var self = this,
      $element = self.target;
    var $wrapper = $element.parent(".dews-multicodepicker-wrapper");
    var $text = $(".dews-multicodepicker-text", $wrapper);

    self.usePanelFocus = true;

    $text.on("keydown", function (e) {
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && $element.is(":enabled")) {
        e.preventDefault();
      } else if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();

        var evt = new $.Event("beforeFocus");
        evt.control = self;

        $element.trigger(evt);
      } else if (e.keyCode === 9 || e.keyCode === 13 && $element.is(":enabled")) {
        if (e.keyCode === 9) {
          //tab키 기본동작 막기
          e.preventDefault();
        }

        if (e.keyCode === 13 && requiredCheck && $element.hasClass("required")) {
          if (self.validate()) {
            var evt = new $.Event("nextFocus");
            evt.control = self;

            $element.trigger(evt);
          }
        } else {
          var evt = new $.Event("nextFocus");
          evt.control = self;

          $element.trigger(evt);
        }
      }
    });
  };

  MultiCodepicker.prototype.canFocusable = function () {
    var self = this,
      $element = self.target;
    var $wrapper = $element.parent(".dews-multicodepicker-wrapper");
    var $text = $(".dews-multicodepicker-text", $wrapper);

    return (
      !$text.parent(".dews-multicodepicker-wrap").hasClass("dews-state-readonly") &&
      $text.is(":visible") &&
      $text.is(":enabled"));

  };

  /**
   * 멀티코드피커 컨트롤 자동화 인쇄 관련 데이터 추출
   * @return {*} 값이 설정 된 경우 Object 반환, 없는 경우 undefined 반환
   * @private
   */
  MultiCodepicker.prototype._getPrintData = function () {
    var self = this,
      data;

    if (self.texts().length !== 0) {
      data = {
        id: self.target.attr("id"),
        text: self.inputText.val()
      };
    }

    return data;
  };

  /**
   * 멀티코드피커 컨트롤 display none 하여 숨기는 API
   */
  MultiCodepicker.prototype.hide = function () {
    var self = this,
      $wrapper = self.wrapper;

    if (!($wrapper.css("display") === "none")) {
      $wrapper.css("display", "none");
    }
  };

  /**
   * 멀티코드피커 컨트롤 display inline-block 하여 보이도록 하는 API
   */
  MultiCodepicker.prototype.show = function () {
    var self = this,
      $wrapper = self.wrapper;

    if ($wrapper.css("display") === "none") {
      self.target.prev().show();
      $wrapper.css("display", "inline-block");
    }
  };

  $.extend(true, dews, {
    ui: {
      multicodepicker: function multicodepicker(selector, options) {
        var $control, codepicker;

        if (selector instanceof jQuery) {
          $control = selector;
        } else if ($.type(selector) === "string") {
          $control = $(selector);
        } else {
          throw "대상이 지정되지 않았습니다.";
        }

        $control.each(function () {
          var $this = $(this),
            opt;

          codepicker = $this.data("dews-control");

          if (!codepicker) {
            opt = getOptions($this, options);
            codepicker = new MultiCodepicker($this, opt);

            if (!$this.hasClass("dews-ui-multicodepicker")) {
              $this.addClass("dews-ui-multicodepicker");
            }

            if (!$this.hasClass("dews-form-control")) {
              $this.addClass("dews-form-control");
            }

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            $this.data("dews-control", codepicker);
          }
        });

        return codepicker;
      }
    }
  });

  // DOM Ready 시에 컨트롤들을 초기화
  dews.ui.addControlInitializer("multicodepicker", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.multicodepicker($("select.dews-ui-multicodepicker", $container));
  });
})(jQuery, window.dews || {});


/**
 * 멀티 드롭다운 리스트
 * select.dews-ui-multidropdownlist
 **/

(function ($, dews) {
  var defaultOptions = {
    dataTextField: "text",
    dataValueField: "value",
    autoOpen: false
  };

  // 옵션
  function getOptions($el, codeOptions) {
    var inlineOptions;

    inlineOptions = getInlineOptions($el, defaultOptions);
    codeOptions = codeOptions || {};

    return $.extend(true, {}, inlineOptions, codeOptions);
  }

  // HTML 옵션
  function getInlineOptions($el, defaultOptions) {
    var options = {};
    var dataSource, dataSourceID, dataSourceUrl, dataSourceParams, dataSourceOptions;

    options = $.extend(true, options, defaultOptions);

    if ($el) {
      options.dataTextField = $el.data("dews-text-field") ?
      $el.data("dews-text-field") :
      defaultOptions.dataTextField;
      options.dataValueField = $el.data("dews-value-field") ?
      $el.data("dews-value-field") :
      defaultOptions.dataValueField;
      options.autoOpen = $el.data("dews-auto-open") ? $el.data("dews-auto-open") : defaultOptions.autoOpen;

      if ($el.attr("id")) {
        dataSourceID = $el.attr("id") + "_DataSource";
      } else {
        dataSourceID = new Date().toString() + "_DataSource";
      }

      if ($el.data("dews-data-url")) {
        dataSourceUrl = dews.url.getAbsoluteUrl($el.data("dews-data-url"));

        dataSourceOptions = {
          transport: {
            read: {
              url: dataSourceUrl,
              dataType: "json"
            }
          }
        };

        dataSource = dews.ui.dataSource(dataSourceID, dataSourceOptions);
        // helpCode가 있을 때
      } else if ($el.data("dews-help-code")) {
        dataSourceUrl = dews.url.getCodeDataUrl($el.data("dews-help-code"));

        dataSourceOptions = {
          transport: {
            read: {
              url: dataSourceUrl,
              dataType: "json"
            }
          }
        };

        if ($el.data("dews-help-params")) {
          dataSourceParams = $.deparam($el.data("dews-help-params"));
          dataSourceOptions.transport.read.data = dataSourceParams;
        }

        dataSource = dews.ui.dataSource(dataSourceID, dataSourceOptions);
      } else {
        dataSourceOptions = {
          data: []
        };

        $.each($el.find("option"), function (idx, item) {
          var obj = {}; // 멀티드롭다운리스트 아이템 정보 = 데이터
          var $item = $(item);

          obj[options.dataValueField] = $item.attr("value");
          obj[options.dataTextField] = $item.text();

          dataSourceOptions.data.push(obj);
        });

        dataSource = dews.ui.dataSource(dataSourceID, dataSourceOptions);
      }
      options.dataSource = dataSource;
    }

    return options;
  }

  var MultiDropDownList = function MultiDropDownList($element, opt) {
    var self = this;
    self.$element = $element;
    self.options = opt;
    self._init(); // 시작

    return self;
  };
  // init()
  MultiDropDownList.prototype._init = function () {
    var self = this;

    self._setDOM();
    self._setContainerDOM();
    self._getState();
    self._setItems();
    self._bindEvents();
  };
  // getState()
  MultiDropDownList.prototype._getState = function () {
    var self = this;

    var $state = self.$wrapper.find(".dews-dropdown-wrap");
    self.$state = $state;

    if (self.$element.attr("disabled") || self.$element.hasClass("disabled")) {
      $state.addClass("dews-state-disabled");
      self.$wrapper.addClass("disabled");
    }

    if (self.$element.attr("required") || self.$element.hasClass("required")) {
      $state.addClass("dews-state-required");
      self.$wrapper.addClass("required");
    }

    if (self.$element.attr("readonly") || self.$element.hasClass("readonly")) {
      $state.addClass("dews-state-readonly");
      self.$wrapper.addClass("readonly");
    }
  };
  // setDom()
  MultiDropDownList.prototype._setDOM = function () {
    var self = this;

    //css:background 인라인 속성사용시 미적용문제 예외처리
    var styleGbn = false;
    var backColor;
    if ($(self.$element.context).css("background-color") != "rgb(255, 255, 255)") {
      styleGbn = true;
      backColor = $(self.$element.context).css("background-color");
    }

    var wrapper = $('<span class="dews-multidropdownlist-wrapper dews-dropdown dews-form-control" tabindex="0">');
    var innerHTML = "";

    innerHTML += '<span class="dews-dropdown-wrap">'; // .dews-state-default 생략
    innerHTML +=
    '<span class="dews-input" ' + (
    styleGbn ? 'style="overflow:hidden; background:' + backColor + '"' : 'style="overflow:hidden" ') +
    "></span>";
    innerHTML +=
    '<span class="dews-select" ' + (
    styleGbn ? 'style="overflow:hidden; background:' + backColor + '"' : 'style="overflow:hidden" ') +
    ">";
    innerHTML += '<span class="dews-icon"></span>';
    innerHTML += "</span>";
    innerHTML += "</span>";
    innerHTML += "</span>";

    self.$element.wrap(wrapper); // <select> 태그 wrapping
    $(innerHTML).insertBefore(self.$element);

    self.$wrapper = self.$element.closest(".dews-multidropdownlist-wrapper");
    if (!self.$wrapper.is("span.k-widget")) {
      self.$wrapper[0].style.cssText = self.$element[0].style.cssText;
    }
    self.$wrap = self.$element.siblings(".dews-dropdown-wrap");
    self.$wrapper.css("display", "");
    self.$element.css("display", "none");

    styleGbn = false; //css:background 사용 여부 초기화
  };
  // containerDOM 구조
  MultiDropDownList.prototype._setContainerDOM = function () {
    var self = this;
    var $listContainer = $('<div class="dews-animation-container">');
    var innerHTML = "";

    $listContainer.data("dews-control", self);

    innerHTML += '<div class="dews-list-container">';
    innerHTML += '<ul class="dews-list"></ul>';
    innerHTML += '<div class="dews-multidropdown-footer dews-footer">';
    // innerHTML +=
    // '<span class="dews-checkbox-wrapper dews-select-deselect">' +
    // '<input type="checkbox" class="dews-ui-checkbox dews-control dews-control-activate">' +
    // '<label class="dews-checkbox-label dews-select-deselect-all" onclick="dews.ui.multidropdownlist.click._check(this,event)"></label>' +
    // '</span>';
    innerHTML +=
    '<button type="button" class="dews-multidropdown-ok">' +
    "<span>" +
    dews.localize.get("확인", "dews_확인") +
    "</span>" +
    "</button>";
    innerHTML += "</div>";
    innerHTML += "</div>";

    $listContainer.append($(innerHTML));

    // checkbox 만들기
    var checkboxSpan = $('<span class="dews-checkbox-wrapper dews-select-deselect">');
    var checkboxInput = dews.ui.checkbox('<input type="checkbox">');
    var checkboxLabel = $(
    '<label class="dews-checkbox-label dews-select-deselect-all" onclick="dews.ui.multidropdownlist.click._check(this,event)"></label>');

    checkboxSpan.append(checkboxInput.target);
    checkboxSpan.append(checkboxLabel);

    $listContainer.find(".dews-multidropdown-footer").prepend(checkboxSpan);

    $("body").append($listContainer);

    self.$footer = $listContainer.find(".dews-multidropdown-footer");
    self.$listContainer = $listContainer;
  };
  // 아이템
  MultiDropDownList.prototype._setItems = function () {
    var self = this;
    var $dfd = $.Deferred();

    self.options.dataSource.fetch().done(function () {
      $dfd.resolve();
    });

    $dfd.done(function () {
      if (self.options.dataSource._data.length > 0) {
        self.$listContainer.find(".dews-list").empty();

        for (var i = 0; i < self.options.dataSource.data().length; i++) {
          var $li = $(
          '<li style="display: flex" class="dews-item" data-dews-value="' +
          self.options.dataSource.data()[i][self.options.dataValueField] +
          '" ' +
          '   data-dews-value-type="' +
          $.type(self.options.dataSource.data()[i][self.options.dataValueField]) +
          '" >' +
          '<span class="dews-text">' +
          self.options.dataSource.data()[i][self.options.dataTextField] +
          "</span>" +
          "</li>");


          // checkbox 만들기
          var checkboxSpan = $('<span class="dews-checkbox-wrapper"></span>');
          var checkboxInput = dews.ui.checkbox('<input type="checkbox">');
          var checkboxLabel = $(
          '<label class="dews-checkbox-label" onclick="dews.ui.multidropdownlist.click._check(this,event)"></label>');

          checkboxSpan.append(checkboxInput.target);
          checkboxSpan.append(checkboxLabel);
          $li.prepend(checkboxSpan);

          self.$listContainer.find(".dews-list").append($li);
        }

        if (self.options.dataSource.options.transport) {
          self._triggerDataBound();
        } else {
          dews.ready(function () {
            self._triggerDataBound();
          });
        }
      }
    });
  };
  // 이벤트
  MultiDropDownList.prototype._bindEvents = function () {
    var self = this;
    var $wrapper = self.$wrapper;
    var $element = self.$element;
    var $listContainer = self.$listContainer;
    var $ok = $listContainer.find(".dews-multidropdown-ok");
    var count = -1;

    window.addEventListener("click", removeFocus, true);
    // wrapper 클릭 이벤트
    $wrapper.on("click", function () {
      // del e.stopPropagation
      var $this = $(this);
      var $wrap = $this.find(".dews-dropdown-wrap");

      if (!$wrap.hasClass("dews-state-readonly") && !$wrap.hasClass("dews-state-disabled")) {
        if ($this.hasClass("dews-open")) {
          self._close();
        } else {
          self._open();
        }
      }
    });
    // f4, esc, enter (*)
    $wrapper.on("keydown", function (e) {
      var key = e.keyCode || e.which;
      if (key === 13) {
        // enter
        // if ($(this).hasClass('dews-open')) {
        self._close(true);
        // }
      } else if (key === 115) {
        // f4
        if (!$element.attr("readonly") && !$element.attr("disabled")) {
          e.preventDefault();
          if (self.$wrap.hasClass("dews-state-focused")) {
            self._open();
          }
        }
      } else if (e.keyCode === 27) {
        // esc
        if ($(this).hasClass("dews-open")) {
          e.preventDefault();
          self._close();
          count = -1;
        }
      }
      // e.stopPropagation();
    });
    // open 이벤트
    $wrapper.on("open", function () {
      if (self.options.dataSource.data().length !== 0) {
        window.addEventListener("keydown", keyboardEvent, true);
      }
      // self.$wrapper.focus();
      window.addEventListener("click", documentClick);
      window.addEventListener("scroll", documentWheel, true);
    });
    // close 이벤트 (keyboard off)
    $element.on("close", function () {
      window.removeEventListener("keydown", keyboardEvent, true);
      window.removeEventListener("click", documentClick);
      window.removeEventListener("scroll", documentWheel, true);
      count = -1;
      self.$listContainer.find(".dews-item").removeClass("dews-state-selected");
      self.$listContainer.find(".dews-multidropdown-ok").blur();
      self.$wrapper.focus();
    });
    // 확인 버튼 클릭 이벤트
    $ok.on("click", function (e) {
      self._close();
      e.stopPropagation();
    });
    // 리스트 아이템 이벤트
    $listContainer.on("mouseenter mouseleave mousedown mouseup", ".dews-item", function (e) {
      if (e.type === "mouseenter") {
        $(this).addClass("dews-state-hover");
      } else if (e.type === "mouseleave") {
        $(this).removeClass("dews-state-hover");
      } else if (e.type === "mousedown") {
        $(this).
        closest(".dews-list").
        find(".dews-item").
        filter(".dews-state-selected").
        removeClass("dews-state-selected");
        $(this).addClass("dews-state-selected");
      }
      e.stopPropagation();
    });
    // dews-item 클릭 시 체크박스 체크 이벤트
    $listContainer.on("click ", ".dews-item", function (e) {
      dews.ui.multidropdownlist.click._check.call(self, $(this).find(".dews-checkbox-label"));
      e.stopPropagation();
    });
    // 체크박스 클릭 시 아이템 인덱스 받아오는 이벤트
    $element.on("_click", function (e) {
      count = e.itemIndex;
      e.stopPropagation();
    });
    function documentClick(e) {
      if (
      $(e.target).closest(".dews-animation-container").length === 0 &&
      !$(e.target).hasClass("dews-multidropdownlist-wrapper"))
      {
        if (!self.$wrapper.is($(e.target).closest(".dews-multidropdownlist-wrapper"))) {
          self._close();
        }
      }
      e.stopPropagation();
    }
    function removeFocus(e) {
      if (
      $(e.target).closest(".dews-animation-container").length === 0 &&
      !$(e.target).hasClass("dews-multidropdownlist-wrapper"))
      {
        if (!self.$wrapper.is($(e.target).closest(".dews-multidropdownlist-wrapper"))) {
          if (self.$wrap.hasClass("dews-state-focused")) {
            self.$wrap.removeClass("dews-state-focused");
          }
        }
      }
    }
    function documentWheel(e) {
      if ($(e.target).closest(".dews-animation-container").length === 0) {
        self._close();
      }
      e.stopPropagation();
    }
    function keyboardEvent(e) {
      var $item = self.$listContainer.find(".dews-item");
      var $ul = $item.closest(".dews-list");
      var footerTop = $item.closest(".dews-animation-container").find(".dews-multidropdown-footer").offset().top;
      var ulHeight = $ul.height();
      var wrapperBottomLineX = self.$wrapper.offset().top + self.$wrapper.height();
      var max = $item.length;
      var min = 0;
      var currentItem;

      self.$listContainer.on("_click", function (e) {
        count = e.itemIndex;
      });

      if (e.keyCode === 38) {
        // up arrow
        self.$listContainer.find(".dews-multidropdown-ok").blur();

        if (min < count) {
          $item.eq(count).removeClass("dews-state-selected");
          count--;
          $item.eq(count).addClass("dews-state-selected");

          // 스크롤
          currentItem = $item.eq(count);
          if (count - 1 !== -1) {
            if (
            wrapperBottomLineX > $item.eq(count - 1).offset().top + currentItem.height() ||
            footerTop < $item.eq(count).offset().top)
            {
              $ul.scrollTop(currentItem.height() * count);
            }
          } else {
            $ul.scrollTop(0);
          }
        }

        e.preventDefault();
      } else if (e.keyCode === 40) {
        // down arrow
        self.$listContainer.find(".dews-multidropdown-ok").blur();

        if (max - 1 > count) {
          count++;
          $item.filter(".dews-state-selected").removeClass("dews-state-selected");
          $item.eq(count).addClass("dews-state-selected");

          // 키보드로 스크롤
          currentItem = $item.eq(count);
          if (
          footerTop < currentItem.offset().top + currentItem.height() ||
          wrapperBottomLineX > $item.eq(count - 1).offset().top + currentItem.height())
          {
            currentItem.closest("ul").scrollTop(currentItem.height() * (count + 1) - ulHeight);
          }
        } else {
          $item.filter(".dews-state-selected").removeClass("dews-state-selected");
          self.$listContainer.find(".dews-multidropdown-ok").focus();
          count = $item.length;
        }

        e.preventDefault();
      } else if (e.keyCode === 32) {
        // 스페이스바 사용시 { 체크 || 해제 }
        if ($item.eq(count).find("input.dews-ui-checkbox").prop("checked")) {
          self.deselect(count);
        } else {
          self.select(count);
        }
        e.preventDefault();
      } else if (e.keyCode === 27) {
        // esc
        self._close();
        self.focus();
      } else if (e.keyCode === 13) {
        self._close();
      } else if (e.keyCode === 36) {
        // Home
        self.$listContainer.find(".dews-multidropdown-ok").blur();
        $item.filter(".dews-state-selected").removeClass("dews-state-selected");
        $item.eq(0).addClass("dews-state-selected");
        count = min;

        // 스크롤
        $ul.scrollTop(0);

        e.preventDefault();
      } else if (e.keyCode === 35) {
        // End
        $item.filter(".dews-state-selected").removeClass("dews-state-selected");
        self.$listContainer.find(".dews-multidropdown-ok").focus();
        count = $item.length;
        e.preventDefault();
      }
    }
  };
  // 컨테이너 위치
  MultiDropDownList.prototype._setListPosition = function () {
    var self = this;
    var windowScrollPosition = $(window).scrollTop();
    var z_index = dews.ui.getDialogMaxZIndex();
    var windowHeight = $(window).height();

    // wrapper
    var wrapperX = self.$wrapper.offset().left;
    var wrapperY = self.$wrapper.offset().top;
    var wrapperHeight = self.$wrapper.height();
    var wrapperWidth = self.$wrapper.width();

    // container
    var containerMargin = 10;
    var containerHeight = self.$listContainer.height();
    var vaTopHeight = wrapperY - windowScrollPosition - containerMargin;
    var vaBottomHeight = windowHeight - (vaTopHeight + wrapperHeight) - containerMargin;
    var openToTop = containerHeight > vaBottomHeight && vaTopHeight > vaBottomHeight; // boolean
    var maxHeight = openToTop ? vaTopHeight : vaBottomHeight;

    $(".dews-list", self.$listContainer).css({
      // ul
      "max-height": maxHeight - wrapperHeight * 2 + "px",
      overflow: "auto"
    });

    if (z_index > parseInt(self.$listContainer.css("zIndex"), 10)) {
      self.$listContainer.css("zIndex", z_index + 2);
    }

    self.$wrapper.x = wrapperX;
    self.$wrapper.y = wrapperY;

    if (!openToTop) {
      // 아래로 열릴때
      self.$listContainer.css({
        marginTop: 0,
        position: "absolute",
        left: wrapperX,
        top: wrapperY + wrapperHeight,
        width: wrapperWidth
      });

      self.direction = "down";
    } else {
      // 위로 열릴때
      self.$listContainer.css({
        marginTop: -(self.$listContainer.height() - 2),
        position: "absolute",
        left: wrapperX,
        top: wrapperY - 1,
        width: wrapperWidth
      });

      self.direction = "up";
    }
  };
  // _open()
  MultiDropDownList.prototype._open = function () {
    var self = this;

    self.$wrapper.addClass("dews-open");
    self.$wrap.addClass("dews-state-border-down");
    self.$wrap.addClass("dews-state-active").addClass("dews-state-focused");

    self._setListPosition();

    // 데이터가 없을 때의 처리.
    if (self.$listContainer.find(".dews-item").length === 0 || !self.options.dataSource) {
      self._blank();
    } else {
      self.$listContainer.find(".dews-list").css("display", "");
      self.$listContainer.find(".dews-item-none").remove();
    }

    self.$listContainer.stop().slideDown(100);
    self._triggerOpenEvent();

    self.previousSelectedItems = self.selectedItems();
  };
  // _close()
  MultiDropDownList.prototype._close = function (removeFocus) {
    var self = this;

    self.$wrapper.removeClass("dews-open");
    self.$wrap.removeClass("dews-state-border-down");
    if (removeFocus) {
      self.$wrap.removeClass("dews-state-focused");
    }
    self.$wrap.removeClass("dews-state-active");
    self.$listContainer.slideUp(100, "linear", function () {
      self.$listContainer.css("display", "none");
    });

    self.$listContainer.find(".dews-item").removeClass("dews-state-selected");
    self.$listContainer.find(".dews-multidropdown-ok").blur();
    self._triggerCloseEvent();
  };
  // blank()
  MultiDropDownList.prototype._blank = function () {
    var self = this;
    var $div = $('<div class="dews-item-none"></div>');
    var $text = $(
    '<div class="dews-item-none-text">' +
    dews.localize.get("데이터가 없습니다.", "dews_데이터가 없습니다.") +
    "</div>");

    var $list = self.$listContainer.find(".dews-list");

    if ($list.parent().find(".dews-item-none").length === 0) {
      $list.css("display", "none");
      $div.append($text);
      $list.after($div);

      self.$listContainer.find(".dews-multidropdown-footer").hide();
      self.$listContainer.find(".dews-list").empty();
      self.$element.empty();
    }
  };
  // setText()
  MultiDropDownList.prototype._setText = function () {
    var self = this,
      checked = self.$listContainer.find(".dews-list").find('input[type="checkbox"]').filter(":checked");

    if (checked.length === 0) {
      self.$wrapper.find(".dews-input").empty();
    } else if (checked.length === 1) {
      self.$wrapper.find(".dews-input").empty().text(checked.eq(0).parent().siblings().text());
    } else {
      self.$wrapper.
      find(".dews-input").
      empty().
      text(
      checked.eq(0).parent().siblings().text() +
      " " +
      dews.localize.get("외", "dews_외") +
      " " + (
      checked.length - 1) +
      dews.localize.get("건", "dews_건"));

    }
  };
  // select 이벤트
  MultiDropDownList.prototype._triggerSelectEvent = function (e) {
    var self = this;
    var evt = new $.Event("select", {
      dataItems: self.selectedItems(),
      selectAll: e ?
      $(e.currentTarget).
      closest(".dews-list-container").
      find(".dews-multidropdown-footer").
      hasClass("selectedAll") :
      false,
      multidropdownlist: self
    });

    self.$element.trigger(evt);
  };
  // close 이벤트
  MultiDropDownList.prototype._triggerCloseEvent = function () {
    var self = this;
    var evt = new $.Event("close", {
      multidropdownlist: self
    });

    self.$element.trigger(evt);
  };
  // open 이벤트
  MultiDropDownList.prototype._triggerOpenEvent = function () {
    var self = this;
    var evt = new $.Event("open", {
      multidropdownlist: self
    });

    self.$element.trigger(evt);
  };
  // click 이벤트
  MultiDropDownList.prototype._triggerClickEvent = function (e, count) {
    var self = this;
    var evt = new $.Event("_click", {
      dataItems: self.selectedItems(),
      multidropdownlist: self,
      itemIndex: count
    });

    self.$element.trigger(evt);
  };
  // dataBound 이벤트
  MultiDropDownList.prototype._triggerDataBound = function () {
    var self = this;
    var evt = new $.Event("dataBound", {
      dataItems: self.dataItems(),
      multidropdownlist: self
    });

    self.$element.trigger(evt);
  };
  /**
   * 멀티 드롭다운 리스트를 비활성화 상태로 설정합니다.
   * @private
   */
  MultiDropDownList.prototype._setDisabled = function () {
    var self = this,
      $el = self.$element,
      $wrapper = self.$wrapper;

    if (!$wrapper.find(".dews-dropdown-wrap").hasClass("dews-state-disabled")) {
      $wrapper.find(".dews-dropdown-wrap").addClass("dews-state-disabled");
    }

    $el.prop("disabled", true);

    if (!$el.hasClass("disabled")) {
      $el.addClass("disabled");
    }
  };

  /**
   * 멀티 드롭다운 리스트를 활성화 상태로 설정합니다.
   * @private
   */
  MultiDropDownList.prototype._removeDisabled = function () {
    var self = this,
      $el = self.$element,
      $wrapper = self.$wrapper;

    if ($wrapper.find(".dews-dropdown-wrap").hasClass("dews-state-disabled")) {
      $wrapper.find(".dews-dropdown-wrap").removeClass("dews-state-disabled");
    }

    $el.prop("disabled", false);

    if ($el.hasClass("disabled")) {
      $el.removeClass("disabled");
    }
  };

  /**
   * 멀티드롭다운리스트를 읽기전용 상태로 설정합니다.
   * @private
   */
  MultiDropDownList.prototype._setReadonly = function () {
    var self = this,
      $el = self.$element,
      $wrapper = self.$wrapper;

    if (!$wrapper.find(".dews-dropdown-wrap").hasClass("dews-state-readonly")) {
      $wrapper.find(".dews-dropdown-wrap").addClass("dews-state-readonly");
    }

    $el.attr("readonly", true); // HTML 초기화 코드에 readonly 옵션 추가

    if (!$el.hasClass("readonly")) {
      $el.addClass("readonly");
      $wrapper.addClass("readonly");
    }
  };

  /**
   * 멀티코드피커의 읽기전용을 해제합니다.
   * @private
   */
  MultiDropDownList.prototype._removeReadonly = function () {
    var self = this,
      $el = self.$element,
      $wrapper = self.$wrapper;

    if ($wrapper.find(".dews-dropdown-wrap").hasClass("dews-state-readonly")) {
      $wrapper.find(".dews-dropdown-wrap").removeClass("dews-state-readonly");
    }

    $el.attr("readonly", false); //  code 컨트롤에서 reaodonly를 설정

    if ($el.hasClass("readonly")) {
      $el.removeClass("readonly");
    }
  };
  // select()
  MultiDropDownList.prototype.select = function (index) {
    var self = this,
      $items;

    if ($.isNumeric(index)) {
      $items = self.$listContainer.find(".dews-item").eq(index);
      if (!$items.find('input[type="checkbox"]').prop("checked")) {
        dews.ui.multidropdownlist.click._check.call(self, $items.find(".dews-checkbox-label"));
      }
    }
  };
  // deselect()
  MultiDropDownList.prototype.deselect = function (index) {
    var self = this,
      $items;

    if ($.isNumeric(index)) {
      $items = self.$listContainer.find(".dews-item").eq(index);
      if ($items.find('input[type="checkbox"]').prop("checked")) {
        dews.ui.multidropdownlist.click._check.call(self, $items.find(".dews-checkbox-label"));
      }
    }
  };
  // setDataSource()
  MultiDropDownList.prototype.setDataSource = function (dataSource) {
    var self = this;

    if ($.type(dataSource) === "undefined" || dataSource.length === 0) {
      self._blank();
    } else {
      self.options.dataSource = dataSource;
      self._setItems();
      self.$footer.css("display", "");
    }

    self.deselectAll();
    self._setText();
  };
  // selectAll()
  MultiDropDownList.prototype.selectAll = function () {
    var self = this,
      $selectAll = self.$listContainer.find(".dews-multidropdown-footer").find(".dews-select-deselect"),
      $checkbox = self.$listContainer.
      find(".dews-checkbox-label").
      parent(".dews-checkbox-wrapper").
      find('input[type = "checkbox"]');

    if ($checkbox.filter(":checked").length !== $checkbox.length) {
      $selectAll.find(".dews-select-deselect-all").click();
    }

    self._setText();
  };
  // deselectAll()
  MultiDropDownList.prototype.deselectAll = function () {
    var self = this,
      $label = self.$listContainer.find(".dews-multidropdown-footer").find(".dews-checkbox-label"),
      $checkbox = $label.parent(".dews-checkbox-wrapper").find('input[type="checkbox"]'),
      footer = $checkbox.closest(".dews-multidropdown-footer"),
      $checkbox = self.$listContainer.
      find(".dews-checkbox-label").
      parent(".dews-checkbox-wrapper").
      find('input[type = "checkbox"]'),
      $selectAll = self.$listContainer.find(".dews-multidropdown-footer").find(".dews-select-deselect"),
      listcheckbox = footer.siblings(".dews-list").find('input[type="checkbox"]');

    listcheckbox.prop("checked", false);
    if (footer.hasClass("selectedAll")) {
      footer.removeClass("selectedAll");
    }

    if ($checkbox.filter(":checked").length === 1) {
      $selectAll.find(".dews-select-deselect-all").click();
    }

    self._setText();
  };

  /**
   * 멀티드롭다운리스트의 활성화 여부를 설정하거나 가져옵니다.
   * @param {boolean} [value] 설정할 활성화 여부(생략하면 현재 활성화 여부를 반환합니다.)
   * @returns {boolean} 활성화 여부
   */
  MultiDropDownList.prototype.enable = function (value) {
    var self = this,
      $el = self.$element,
      enabled;

    enabled = !$el.prop("disabled");

    if (typeof value !== "undefined") {
      //  설정
      if (value === false) {
        self._setDisabled();
      } else if (value === true) {
        self._removeDisabled();
      }
    } else {
      return enabled;
    }
  };

  /**
   * 멀티드롭다운리스트의 visible 여부를 가져옵니다.
   * @returns {boolean}
   * @private
   */
  MultiDropDownList.prototype._visibleCheckFromPanel = function () {
    var self = this,
      $ctrl = self.$element,
      isVisible = $ctrl.closest(".dews-multidropdownlist-wrapper").css("display") !== "none";

    return isVisible;
  };

  // required()
  MultiDropDownList.prototype.required = function (value) {
    var self = this;
    var $el = self.$element;
    var $wrapper = self.$wrapper;
    var $wrap = $wrapper.find(".dews-dropdown-wrap");

    if ($.type(value) === "undefined") {
      return $el.hasClass("required");
    }
    if (value === true) {
      if (!$el.hasClass("required")) {
        $el.addClass("required");
      }
      if (!$wrapper.hasClass("required")) {
        $wrapper.addClass("required");
      }
      if (!$wrap.hasClass("dews-state-required")) {
        $wrap.addClass("dews-state-required");
      }
    } else if (value === false) {
      if ($el.hasClass("required")) {
        $el.removeClass("required");
      }
      if ($wrapper.hasClass("required")) {
        $wrapper.removeClass("required");
      }
      if ($wrap.hasClass("dews-state-required")) {
        $wrap.removeClass("dews-state-required");
      }
    }
  };
  // readonly()
  MultiDropDownList.prototype.readonly = function (value) {
    var self = this,
      $el = self.$element,
      readonly;

    readonly = $el.hasClass("readonly");

    if (typeof value !== "undefined") {
      //  설정
      if (value === true) {
        self._setReadonly();
        readonly = value;
      } else if (value === false) {
        self._removeReadonly();
        readonly = value;
      }
    }

    return readonly;
  };
  // open()
  MultiDropDownList.prototype.open = function () {
    var self = this;
    self._open();
  };
  // close()
  MultiDropDownList.prototype.close = function () {
    var self = this;
    self._close();
  };
  // focus()
  MultiDropDownList.prototype.focus = function () {
    var self = this;
    self.$wrapper.focus();
    // self.$wrap.focus();
    self.$wrapper.find(".dews-dropdown-wrap").addClass("dews-state-focused");
  };
  /**
   * 멀티 드롭다운 리스트의 선택된 아이템들을 반환합니다.
   * @returns {Array} 리스트의 선택된 아이템 배열
   */
  MultiDropDownList.prototype.selectedItems = function () {
    var self = this,
      $items = self.$listContainer.find(".dews-item"),
      checkedItems = [];

    $items.each(function () {
      var $item = $(this);
      var checkbox = $item.find(".dews-ui-checkbox");

      if (checkbox.prop("checked")) {
        checkedItems.push($item);
      }
    });

    return checkedItems;
  };

  /**
   * 멀티 드롭다운 리스트의 <li> 요소로 이루어진 아이템 배열을 반환합니다.
   * @return {Array} 아이템 배열
   */
  MultiDropDownList.prototype.items = function () {
    var self = this,
      $items = self.$listContainer.find(".dews-item");

    return $items;
  };

  /**
   * 멀티 드롭다운 리스트의 선택된 아이템의 text를 배열로 반환하거나 설정합니다.
   * @param value 선택할 아이템 text 문자열이나 배열
   * @returns {Array} 드롭다운리스트의 선택된 아이템의 text 배열
   */
  MultiDropDownList.prototype.texts = function (value) {
    var self = this,
      texts = [];

    if ($.type(value) === "undefined") {
      var $items = self.$listContainer.find(".dews-item"),
        $selectedItems = $items.find(".dews-ui-checkbox:checked");

      for (var i = 0; i < $selectedItems.length; i += 1) {
        texts.push($selectedItems.eq(i).closest(".dews-item").find(".dews-text").text());
      }
      return texts;
    } else if ($.isArray(value)) {
      for (var i = 0; i < value.length; i++) {
        for (var j = 0; j < self.items().length; j++) {
          var $item = self.$listContainer.find(".dews-item").eq(j);
          if (value[i] === $item.find(".dews-text").text()) {
            if (!$item.find('input[type="checkbox"]').prop("checked")) {
              dews.ui.multidropdownlist.click._check.call(self, $item.find(".dews-checkbox-label"));
            }
          }
        }
      }
    } else if ($.type(value) === "string" || $.type(value) === "number") {
      for (var i = 0; i < self.items().length; i++) {
        var $item = self.$listContainer.find(".dews-item").eq(i);
        if (value === $item.find(".dews-text").text()) {
          if (!$item.find('input[type="checkbox"]').prop("checked")) {
            dews.ui.multidropdownlist.click._check.call(self, $item.find(".dews-checkbox-label"));
          }
        }
      }
    }
  };

  /**
   *
   * @param value
   * @returns {Array}
   */
  MultiDropDownList.prototype.values = function (value) {
    var self = this,
      $item;

    if ($.type(value) === "undefined") {
      // 선택된 아이템 반환
      var selectedItems = self.selectedItems(),
        selectedItemsValue = [];
      for (var i = 0; i < selectedItems.length; i++) {
        var item = selectedItems[i].data("dews-value");
        if ($.type(item) === "number" && selectedItems[i].data("dews-value-type") === "string") {
          item += "";
        }
        selectedItemsValue.push(item);
      }
      return selectedItemsValue;
    } else if ($.type(value) === "string" || $.type(value) === "number") {
      for (var i = 0; i < self.items().length; i++) {
        $item = self.$listContainer.find(".dews-item").eq(i);

        if ($.type(value) === $item.data("dews-value-type") && value == $item.data("dews-value")) {
          if (!$item.find('input[type="checkbox"]').prop("checked")) {
            dews.ui.multidropdownlist.click._check.call(self, $item.find(".dews-checkbox-label"));
          }
        }
      }
    } else if ($.isArray(value)) {
      for (var i = 0; i < value.length; i++) {
        for (var j = 0; j < self.items().length; j++) {
          $item = self.$listContainer.find(".dews-item").eq(j);

          if ($.type(value[i]) === $item.data("dews-value-type") && value[i] == $item.data("dews-value")) {
            if (!$item.find('input[type="checkbox"]').prop("checked")) {
              dews.ui.multidropdownlist.click._check.call(self, $item.find(".dews-checkbox-label"));
            }
          }
        }
      }
    }
  };

  /**
   * 바인딩 된 데이터중 해당 인덱스의 아이템 객체를 반환합니다.
   * @param index
   */
  MultiDropDownList.prototype.dataItem = function (index) {
    var self = this;
    return self.options.dataSource.data()[index];
  };

  /**
   * 멀티 드롭다운 리스트의 모든 아이템을 반환합니다.
   * @returns {Array}
   */
  MultiDropDownList.prototype.dataItems = function () {
    var self = this,
      items = [];

    for (var i = 0; i < self.options.dataSource.data().length; i++) {
      items.push(self.options.dataSource.data()[i]);
    }

    return items;
  };

  /**
   * 체크된 항목의 데이터 아이템을 반환합니다.
   * @returns {Array} 체크된 항목의 데이터 객체 배열
   */
  MultiDropDownList.prototype.selectedDataItems = function () {
    var self = this,
      $items = self.$listContainer.find(".dews-item"),
      $input = $items.find('input[type="checkbox"]'),
      checkedItemsIndex = [],
      checkedDataItems = [];

    for (var i = 0; i < $input.length; i++) {
      if ($input.eq(i).prop("checked")) {
        checkedItemsIndex.push(i);
      }
    }

    for (var i = 0; i < checkedItemsIndex.length; i++) {
      checkedDataItems.push(self.options.dataSource.data()[checkedItemsIndex[i]]);
    }

    return checkedDataItems;
  };

  /**
   * 필수 입력 상태에서 멀티드롭다운 리스트에 선택된 항목이 존재하는지 여부를 검증합니다.
   * @returns {boolean}
   */
  MultiDropDownList.prototype.validate = function () {
    var self = this;
    return self.selectedItems().length > 0;
  };

  /**
   * 외부에서 바인딩 로직을 주입받기 위한 함수
   * @param logic 외부에서 주입 받는 로직
   */
  MultiDropDownList.prototype.setBindFormPanelLogic = function (logic) {
    var self = this;

    if ($.isFunction(logic)) {
      self.bindLogic = logic;
    }
  };

  /**
   * 패널 컨테이너로 부터 전달 된 JSON 데이터를 멀티드롭다운리스트로 바인딩 합니다.
   * @param data 패널로부터 전달 받은 데이터
   */
  MultiDropDownList.prototype.bindFromPanel = function (data) {
    var self = this;

    if ($.isFunction(self.bindLogic)) {
      self.bindLogic.call(self, data);
    }
  };

  /**
   * 외부에서 직렬화 로직을 주입 받기 위한 함수
   * @param logic 외부에서 주입 받는 로직
   */
  MultiDropDownList.prototype.setSerializeForPanelLogic = function (logic) {
    var self = this;

    if ($.isFunction(logic)) {
      self.serializeLogic = logic;
    }
  };

  /**
   * 패널로 데이터를 보내기 위해 컴포넌트 데이터를 JSON객체로 직렬화 합니다.
   * @return data 패널로 보낼 데이터
   */
  MultiDropDownList.prototype.serializeForPanel = function () {
    var self = this,
      data;

    if ($.isFunction(self.serializeLogic)) {
      data = self.serializeLogic.call(self);
    }

    return data;
  };

  /**
   * 패널 내에서 멀티 드롭다운 리스트가 포커스를 받을 수 있는지 상태값을 반환합니다.
   * @returns {boolean}
   */
  MultiDropDownList.prototype.canFocusable = function () {
    var self = this,
      $element = self.$element;

    return (
      !$element.hasClass("readonly") &&
      $element.is(":enabled") &&
      $element.closest(".dews-dropdown").is(":visible"));

  };

  /**
   * 패널 내에서 멀티드롭다운 리스트에 포커스가 들어았을 때, 다음 컴포넌트에 포커스를 줄 수 있는지 확인하는 함수
   */
  MultiDropDownList.prototype.applyPanelFocus = function (requiredCheck) {
    var self = this,
      $element = self.$element;
    var $wrapper = self.$wrapper;

    self.usePanelFocus = true;

    $wrapper.on("keydown", function (e) {
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && $element.is(":enabled")) {
        e.preventDefault();
      } else if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();

        var evt = new $.Event("beforeFocus");
        evt.control = self;

        $element.trigger(evt);
      } else if (e.keyCode === 9 || e.keyCode === 13 && $element.is(":enabled")) {
        if (e.keyCode === 9) {
          // tab키 기본동작 막기
          e.preventDefault();
        }
        if (e.keyCode === 13 && requiredCheck && $element.hasClass("required")) {
          if (self.validate()) {
            var evt = new $.Event("nextFocus");
            evt.control = self;

            $element.trigger(evt);
          }
        } else {
          var evt = new $.Event("nextFocus");
          evt.control = self;

          $element.trigger(evt);
        }
      }
    });
  };

  MultiDropDownList.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change", "click", "open", "close", "select", "dataBound"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "change") {
          self.$element.trigger("_change");
        } else if (event === "click") {
          self.$element.trigger("_click");
        } else {
          self.$element.trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  /**
   * DEWS 객체에 직접 이벤트 핸들러를 등록합니다.
   **/
  MultiDropDownList.prototype.on = function () {
    var self = this;

    if (arguments[0] === "change") {
      Array.prototype.splice.apply(arguments, [0, 1, "_change"]);
    } else if (arguments[0] === "click") {
      Array.prototype.splice.apply(arguments, [0, 1, "_click"]);
    }

    self.$element.on.apply(self.$element, arguments);
  };

  /**
   * DEWS 객체에 직접 이벤트 핸들러를 해제합니다.
   */
  MultiDropDownList.prototype.off = function () {
    var self = this;

    if (arguments[0] === "change") {
      Array.prototype.splice.apply(arguments, [0, 1, "_change"]);
    } else if (arguments[0] === "click") {
      Array.prototype.splice.apply(arguments, [0, 1, "_click"]);
    }

    self.$element.off.apply(self.$element, arguments);
  };

  /**
   * 멀티드롭다운리스트 컨트롤 자동화 인쇄 관련 데이터 추출
   * @return {*} 값이 설정 된 경우 Object 반환, 없는 경우 undefined 반환
   * @private
   */
  MultiDropDownList.prototype._getPrintData = function () {
    var self = this,
      data;

    if (self.texts().length !== 0) {
      data = {
        id: self.$element.attr("id"),
        text: self.$wrap.text()
      };
    }

    return data;
  };

  /**
   * 멀티드롭다운리스트 컨트롤 display none 하여 숨기는 API
   */
  MultiDropDownList.prototype.hide = function () {
    var self = this;

    if (!(self.$wrapper.css("display") === "none")) {
      self.$wrapper.css("display", "none");
    }
  };

  /**
   * 멀티드롭다운 컨트롤 display inline-block 하여 보이도록 하는 API
   */
  MultiDropDownList.prototype.show = function () {
    var self = this;

    if (self.$wrapper.css("display") === "none") {
      self.$wrapper.css("display", "inline-block");
    }
  };

  $.extend(true, dews, {
    ui: {
      multidropdownlist: function multidropdownlist(selector, options) {
        var $el;
        var mddl;

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector);
        }

        if ($.type(selector) === "undefined") {
          throw "대상이 지정되지 않았습니다.";
        }

        $el.each(function () {
          var multidropdownlist;
          var $this = $(this);
          var opt;

          multidropdownlist = $this.data("dews-control");

          if (!multidropdownlist) {
            opt = getOptions($this, options);

            if (!$this.hasClass("dews-ui-multidropdonwlist")) {
              $this.addClass("dews-ui-multidropdownlist");
            }

            if (!$this.hasClass("dews-form-control")) {
              $this.addClass("dews-form-control");
            }

            multidropdownlist = new MultiDropDownList($this, opt);
            $this.data("dews-control", multidropdownlist);
          }

          mddl = multidropdownlist;
        });

        return mddl;
      }
    }
  });

  dews.ui.addControlInitializer("multidropdownlist", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.multidropdownlist($("select.dews-ui-multidropdownlist", $container));
  });

  dews.ui.multidropdownlist.click = {
    _check: function _check(target, e) {
      var $label = $(target),
        $item = $label.closest(".dews-item"),
        $checkbox = $label.parent(".dews-checkbox-wrapper").find('input[type="checkbox"]'),
        $selectAllcheckbox = $checkbox.
        closest(".dews-list-container").
        find(".dews-multidropdown-footer").
        find('input[type="checkbox"]'),
        $footer = $checkbox.closest(".dews-multidropdown-footer"),
        listcheckbox = $footer.siblings(".dews-list").find('input[type="checkbox"]'),
        self = $item.closest(".dews-animation-container").data("dews-control"),
        count = $checkbox.closest(".dews-item").index();

      if (e) {
        e.stopPropagation();
      }

      if (!$checkbox.prop("checked")) {
        // 체크
        $item.addClass("dews-state-checked");
        $checkbox.prop("checked", true);
        if (
        $checkbox.closest(".dews-list").find('input[type="checkbox"]').filter(":checked").length ===
        $checkbox.closest(".dews-list").find('input[type="checkbox"]').length)
        {
          $checkbox.
          closest(".dews-list-container").
          find(".dews-multidropdown-footer").
          addClass("selectedAll");
          $selectAllcheckbox.prop("checked", true);
        }

        if ($checkbox.closest(".dews-multidropdown-footer").length === 0) {
          // 선택 이벤트
          self._triggerSelectEvent(e);
        }
      } else {
        // 해제
        $item.removeClass("dews-state-checked");
        $checkbox.prop("checked", false);
        if (
        $checkbox.closest(".dews-list").find('input[type="checkbox"]').filter(":checked").length !==
        $checkbox.closest(".dews-list").find('input[type="checkbox"]').length)
        {
          $selectAllcheckbox.prop("checked", false);
          $checkbox.
          closest(".dews-list-container").
          find(".dews-multidropdown-footer").
          removeClass("selectedAll");
        }
      }

      if ($checkbox.closest(".dews-multidropdown-footer").length === 0) {
        // 선택 이벤트
        self._triggerClickEvent(e, count);
      }

      if ($checkbox.closest(".dews-select-deselect").length !== 0) {
        // 전체선택
        self = $label.parents(".dews-animation-container").data("dews-control");

        if ($checkbox.filter(":checked").length !== 0) {
          listcheckbox.prop("checked", true);
          if (!$footer.hasClass("selectedAll")) {
            $footer.addClass("selectedAll");
          }
        } else {
          // 전체해제
          listcheckbox.prop("checked", false);
          if ($footer.hasClass("selectedAll")) {
            $footer.removeClass("selectedAll");
          }
        }
      }

      self.$element.trigger("_change");
      self._setText();
    }
  };
})(jQuery, window.dews, window.kendo);


/**
 * 멀티파일 컴포넌트
 */
(function ($, dews) {
  /**
   * @typedef {Object} MultiFileOptions 멀티 파일 컴포넌트 옵션
   * @property {UploadOptions} [upload] 업로드 설정
   * @property {DownloadOptions} [download] 다운로드 설정
   * @property {TokenOptions} [token] 임시 인증토큰 설정
   * @property {BindingOptions} [binding] 바인딩 정보
   * @property {[string]} [filters] 확장자 기반의 파일 필터
   */

  /**
   * 기본 옵션
   * @type {MultiFileOptions}
   */
  var defaultOptions = {
    upload: {
      use: true,
      url: "/upload/file",
      button: {
        disabled: false,
        visible: true
      }
    },
    download: {
      use: true,
      url: "/download/file",
      tempUrl: "/download/tempfile",
      param: "key",
      button: {
        disabled: false,
        visible: true
      }
    },
    deleted: {
      button: {
        disabled: false,
        visible: true
      },
      confirmation: true
    },
    token: {
      use: true,
      url: "/auth/temporary/token",
      param: "token"
    },
    autoBind: true,
    dragText: true,
    contentsHeight: 4,
    usePreview: false
  };

  /**
   * DOM 요소에 설정된 멀티 파일 컴포넌트 옵션을 수집하여 가져옵니다.
   * @param {Element} el 옵션이 포함된 DOM 요소
   * @return {MultiFileOptions}}
   */
  function getInlineOptions(el) {
    var $el = $(el);

    /**
     * @type {MultiFileOptions}
     */
    var options = {};

    // 업로드 가능 사용 여부
    if ($.type($el.data("dews-upload-use")) === "boolean") {
      options.upload = options.upload || {};
      options.upload.use = $el.data("dews-upload-use");
    }

    // 업로드 API URL
    var uploadUrl = $el.data("dews-upload-url");
    if ($.trim(uploadUrl)) {
      options.upload = options.upload || {};
      options.upload.url = uploadUrl;
    }

    // 다운로드 가능 사용 여부
    if ($.type($el.data("dews-download-use")) === "boolean") {
      options.download = options.download || {};
      options.download.use = $el.data("dews-download-use");
    }

    // 다운로드 API URL
    var downloadUrl = $el.data("dews-download-url");
    if ($.trim(downloadUrl)) {
      options.download = options.download || {};
      options.download.url = downloadUrl;
    }

    // 임시파일 다운로드 API URL
    var downloadTempUrl = $el.data("dews-download-temp-url");
    if ($.trim(downloadTempUrl)) {
      options.download = options.download || {};
      options.download.tempUrl = downloadTempUrl;
    }

    // 다운로드 API URL에 파일 키를 전달할 파라미터 이름
    var downloadParam = $el.data("dews-download-param");
    if ($.trim(downloadParam)) {
      options.download = options.download || {};
      options.download.param = downloadParam;
    }

    var downloadZipname = $el.data("dews-download-zipname");
    if ($.trim(downloadZipname)) {
      options.download = options.download || {};
      options.download.zipname = downloadZipname;
    }

    if ($.type($el.data("dews-deleted-confirmation")) === "boolean") {
      options.deleted = options.deleted || {};
      options.deleted.confirmation = $el.data("dews-deleted-confirmation");
    }

    // 토큰 사용 여부
    if ($.type($el.data("dews-token-use")) === "boolean") {
      options.token = options.token || {};
      options.token.use = $el.data("dews-token-use");
    }

    // 임시 토큰 발급 API URL
    var tokenUrl = $el.data("dews-token-url");
    if ($.trim(tokenUrl)) {
      options.token = options.token || {};
      options.token.url = tokenUrl;
    }

    // 토큰을 전달하는 파라미터 이름
    var tokenParam = $el.data("dews-token-param");
    if ($.trim(tokenParam)) {
      options.token = options.token || {};
      options.token.param = tokenParam;
    }

    // 확장자 기반의 파일 필터
    var strFilters = $el.data("dews-filters");
    if ($.trim(strFilters)) {
      options.filters = $.map(strFilters.split(","), function (item) {
        return $.trim(item);
      });
    }

    // 전체 너비 설정
    var width = $el.data("dews-width");
    if ($.trim(width)) {
      options.multifileWidth = width;
    }

    // 보여지는 파일 개수 설정
    var fileCount = $el.data("dews-file-count");
    if ($.trim(fileCount)) {
      options.contentsHeight = fileCount;
    }

    // 드래그 텍스트 사용 여부
    var dragText = $el.data("dews-drag-text");
    if ($.type(dragText) === "boolean") {
      options.dragText = dragText;
    }

    // 바인딩 정보
    options.binding = options.binding || {};
    var bindFileKey = $el.data("dews-bind-file-key") || "fileKey";
    if ($.trim(bindFileKey)) {
      options.binding.fileKey = $.trim(bindFileKey);
    }
    var bindFilename = $el.data("dews-bind-filename") || "filename";
    if ($.trim(bindFileKey)) {
      options.binding.filename = $.trim(bindFilename);
    }
    var bindExtension = $el.data("dews-bind-extension") || "extension";
    if ($.trim(bindExtension)) {
      options.binding.extension = $.trim(bindExtension);
    }
    var bindSize = $el.data("dews-bind-size") || "size";
    if ($.trim(bindSize)) {
      options.binding.size = $.trim(bindSize);
    }
    var bindIsNew = $el.data("dews-bind-is-new") || "isNewFile";
    if ($.trim(bindIsNew)) {
      options.binding.isNewFile = $.trim(bindIsNew);
    }
    var bindIsDelete = $el.data("dews-bind-is-delete") || "isDeleteFile";
    if ($.trim(bindIsDelete)) {
      options.binding.isDeleteFile = $.trim(bindIsDelete);
    }
    var url = $el.data("dews-bind-url") || "url";
    if ($.trim(url)) {
      options.binding.url = $.trim(url);
    }

    // 미리보기 사용 여부
    if ($el.data("dews-use-preview")) {
      options.usePreview = true;
    }

    return options;
  }

  /**
   * 멀티 파일 컴포넌트의 UI를 초기화합니다.
   * @param {MultiFileComponent} multifile 멀티 파일 컴포넌트의 인스턴스
   */
  function initialize(multifile) {
    // 멀티파일 헤더 생성
    var createHead = function createHead() {
      var $head = $('<div class="dews-multifile-head"></div>');
      multifile.$element.append($head);
      multifile._$head = multifile.$element.children(".dews-multifile-head");
    };

    // 멀티파일 헤더의 체크박스 생성
    var createCheckBox = function createCheckBox() {
      var $checkbox = $('<input type="checkbox" class="select-all">');
      var $checkboxLabel = $("<label>" + dews.localize.get("전체선택", "dews_전체선택") + "</label>");

      multifile._$head.append($checkbox);
      multifile._$head.append($checkboxLabel);
      multifile._selectAll = dews.ui.checkbox(multifile._$head.find('input[type="checkbox"]'));
      multifile._$head.find("label.dews-checkbox-label").on("click", multifile._checkboxClick.bind(multifile));
    };

    // 멀티파일 헤더의 버튼 생성
    var createButtons = function createButtons() {
      var $buttonContainer = $('<div class="dews-button-group"></div>'),
        uploadUse,
        downloadUse,
        deleteUse;
      multifile.$buttons = {
        $upload: $(
        '<button type="button" class="dews-ui-button ico-upload ico-left dews-control k-button dews-control-activate">' +
        dews.localize.get("업로드", "dews_업로드") +
        "</button>"),

        $download: $(
        '<button type="button" class="dews-ui-button ico-download ico-left dews-control k-button dews-control-activate">' +
        dews.localize.get("다운로드", "dews_다운로드") +
        "</button>"),

        $delete: $(
        '<button type="button" class="dews-ui-button primary ico-delete ico-left dews-control k-button dews-control-activate">' +
        dews.localize.get("삭제", "dews_삭제") +
        "</button>"),

        $uploadinput: $('<input type="file" multiple="multiple" style="display: none">')
      };
      if (multifile._options.upload.use) {
        $buttonContainer.append(multifile.$buttons.$upload);
      }
      if (multifile._options.download.use) {
        $buttonContainer.append(multifile.$buttons.$download);
      }
      if (multifile._options.upload.use) {
        $buttonContainer.append(multifile.$buttons.$delete);
      }
      multifile._$head.append($buttonContainer);

      if (!multifile._options.upload.button.visible) {
        multifile.$buttons.$upload.css("display", "none");
      }
      if (!multifile._options.download.button.visible) {
        multifile.$buttons.$download.css("display", "none");
      }
      if (!multifile._options.deleted.button.visible) {
        multifile.$buttons.$delete.css("display", "none");
      }

      uploadUse = !multifile._options.upload.button.disabled && multifile._options.upload.use;
      downloadUse = !multifile._options.download.button.disabled && multifile._options.download.use;
      deleteUse = !multifile._options.deleted.button.disabled;

      updateUploadable(multifile, uploadUse);
      updateDownloadable(multifile, downloadUse);
      deletedButtonable(multifile, deleteUse);
    };

    // 멀티파일 콘텐츠 생성
    var createContents = function createContents() {
      var $contents = $('<div class="dews-multifile-contents"></div>');
      multifile.$element.append($contents);
      multifile._$contents = multifile.$element.children(".dews-multifile-contents");

      // 멀티파일다이얼로그 일 경우에는 높이 설정 x
      if (!multifile.$element.hasClass("dews-ui-multifiledialog")) {
        multifile._$contents.height(multifile._options.contentsHeight * 27 + "px");
      }
      if ($.isNumeric(multifile._options.multifileWidth)) {
        multifile._options.multifileWidth = parseInt(multifile._options.multifileWidth);
      }
      multifile.$element.width(multifile._options.multifileWidth);
    };

    // 멀티파일 이벤트 등록
    var bindEvents = function bindEvents() {
      // 컴포넌트의 레이아웃이 변경되었을 경우
      multifile.$element.on("_layoutChange", function (e) {
        e.preventDefault();
        var exists, existsChecked;
        if (multifile._$contents.find("li").length === 0) {
          exists = false;
          multifile.updateFileExists(exists);
        } else {
          if (multifile._$contents.find(".k-checkbox:checked").length === 0) {
            existsChecked = false;
            if (!multifile._options.download.button.disabled && multifile._options.download.use) {
              updateDownloadable(multifile, existsChecked);
            }
            if (!multifile._options.deleted.button.disabled) {
              deletedButtonable(multifile, existsChecked);
            }
          } else {
            existsChecked = true;
            if (!multifile._options.download.button.disabled && multifile._options.download.use) {
              updateDownloadable(multifile, existsChecked);
            }
            if (!multifile._options.deleted.button.disabled) {
              deletedButtonable(multifile, existsChecked);
            }
          }
        }
      });

      // 업로드 버튼을 클릭하였을 경우
      multifile.$buttons.$upload.on("click", function (e) {
        e.preventDefault();
        if (multifile._options.upload.use) {
          multifile.$buttons.$uploadinput.eq(0).val("");
          multifile.$buttons.$uploadinput.click();
        }
      });

      // 다운로드 버튼을 클릭하였을 경우
      multifile.$buttons.$download.on("click", function (e) {
        e.preventDefault();

        var checkedIndex = getcheckedIndex(multifile);
        var checkedData = getcheckedData(multifile);

        if (multifile._options.download.use) {
          downloadFiles(multifile, checkedIndex, checkedData);
        }
      });

      // 삭제 버튼을 클릭하였을 경우
      multifile.$buttons.$delete.on("click", function (e) {
        e.preventDefault();
        var index = getcheckedIndex(multifile);
        if (multifile._options.deleted.confirmation) {
          dews.confirm(dews.localize.get("파일을 삭제하시겠습니까?", "dews_파일을 삭제하시겠습니까?")).yes(
          function () {
            deleteFile(multifile, index);
          });

        } else {
          deleteFile(multifile, index);
        }
      });

      // 업로드 대상 파일의 선택이 완료되었을 경우
      multifile.$buttons.$uploadinput.on("change", function (e) {
        multifile._options._totalCount = 0;
        multifile._options._currentCount = 0;
        multifile._options._uploadFiles = [];
        multifile._options._successCount = 0;
        multifile._options._failCount = 0;

        if (multifile._options.upload.use && e.target.files.length) {
          var blob = e.target.files,
            i = 0,
            data,
            dataBinding = {},
            binding = multifile._options.binding,
            index,
            preUploadParameter;

          // 업로드 제한 확장자 체크
          if (!isLimitExtension(blob)) {
            while (i < blob.length) {
              multifile._options.blob = blob[i];
              multifile._options._totalCount = blob.length;

              preUploadParameter = {
                file: {
                  filename: blob[i].name,
                  extension: getExtension(blob[i].name, false),
                  size: blob[i].size
                }
              };
              var evt = $.Event("preUpload", preUploadParameter);
              multifile.$element.trigger(evt);
              if (evt.isDefaultPrevented()) {
                i++;
                continue;
              }

              dataBinding[binding.fileKey] = "";
              dataBinding[binding.filename] = blob[i].name;
              dataBinding[binding.extension] = getExtension(blob[i].name, false);
              dataBinding[binding.size] = blob[i].size;
              dataBinding[binding.isNewFile] = false;
              dataBinding[binding.isDeleteFile] = false;
              data = multifile._options.dataSource.add(dataBinding);
              //data[binding.fileKey] = data.uid;
              i++;
            }
          }
        }
      });

      // 헤더 라벨 클릭했을 경우 체크박스 이벤트
      multifile._$head.on("click", "label", function (e) {
        $(e.target).prev().find("label").click();
      });
    };

    var contentsBindEvent = function contentsBindEvent() {
      // 드래그 파일 요소 지정
      multifile._$contents.on("dragover", function (e) {
        e.preventDefault();
      });

      // 업로드 파일 드랍하였을 경우
      multifile._$contents.on("drop", function (e) {
        e.preventDefault();
        var blob = e.originalEvent.dataTransfer.files,
          data,
          i = 0,
          filters = multifile._options.filters,
          dotExtension,
          dataBinding = {},
          binding = multifile._options.binding,
          index,
          preUploadParameter;
        multifile._options._totalCount = 0;
        multifile._options._currentCount = 0;
        multifile._options._uploadFiles = [];
        multifile._options._successCount = 0;
        multifile._options._failCount = 0;

        if (multifile._options.upload.use && blob.length) {
          // 업로드 제한 확장자 체크
          if (!isLimitExtension(blob)) {
            while (i < blob.length) {
              multifile._options.blob = blob[i];
              multifile._options._totalCount = blob.length;
              preUploadParameter = {
                file: {
                  filename: blob[i].name,
                  extension: getExtension(blob[i].name, false)
                }
              };
              var evt = $.Event("preUpload", preUploadParameter);
              multifile.$element.trigger(evt);
              if (evt.isDefaultPrevented()) {
                i++;
                continue;
              }

              dataBinding[binding.fileKey] = "";
              dataBinding[binding.filename] = blob[i].name;
              dataBinding[binding.extension] = getExtension(blob[i].name, false);
              dataBinding[binding.size] = blob[i].size;
              dataBinding[binding.isNewFile] = false;
              dataBinding[binding.isDeleteFile] = false;
              // data[binding.fileKey] = data.uid;

              dotExtension = "." + dataBinding[binding.extension];

              if (filters) {
                for (var j = 0; j < filters.length; j++) {
                  if (filters[j] === dotExtension || compareExtension(blob, filters[j])) {
                    data = multifile._options.dataSource.add(dataBinding);
                  }
                }
              } else {
                data = multifile._options.dataSource.add(dataBinding);
              }
              i++;
            }
          }
        } else {
        }
      });

      multifile._$contents.
      on("mouseenter", function (e) {
        var $text = $(
        '<p class="dragtxt">' +
        dews.localize.get(
        "파일을 직접 끌어다 놓으면 추가됩니다.",
        "dews_파일을 직접 끌어다 놓으면 추가됩니다.") +

        "</p>");

        if (
        multifile._options.upload.use &&
        multifile.options.dragText &&
        multifile.$element.hasClass("empty"))
        {
          multifile._$contents.append($text);
        }
      }).
      on("mouseleave", function () {
        if (multifile._$contents.find(".dragtxt")) {
          multifile._$contents.find(".dragtxt").remove();
        }
      });

      // 콘텐츠 다운로드 이벤트
      multifile._$contents.on("click", ".download", function (e) {
        e.preventDefault();
        var index = $(e.target).closest("li").index();
        var data = getItemData(multifile, index);
        if (
        !multifile._$contents.find("li").eq(index).hasClass("uploading") &&
        multifile._options.download.use)
        {
          if (!multifile._options.download.button.disabled) {
            downloadFiles(multifile, index, data);
          } else {
            dews.alert("다운로드 비활성화 상태입니다.", "error");
          }
        }
      });

      // 콘텐츠 삭제 이벤트
      multifile._$contents.on("click", ".delete", function (e) {
        e.preventDefault();
        var index = $(e.target).closest("li").index();
        if (
        !multifile._$contents.find("li").eq(index).hasClass("uploading") &&
        !multifile._options.deleted.button.disabled)
        {
          if (multifile._options.deleted.confirmation) {
            dews.confirm(
            dews.localize.get("파일을 삭제하시겠습니까?", "dews_파일을 삭제하시겠습니까?")).
            yes(function () {
              deleteFile(multifile, index);
            });
          } else {
            deleteFile(multifile, index);
          }
        } else {
          dews.alert("삭제 비활성화 상태입니다.", "error");
        }
      });

      // 콘텐츠 라벨 클릭했을 경우 체크박스 이벤트
      multifile._$contents.on("click", ".span-wrapper", function (e) {
        $(e.target).parent().prev().find("label").click();
      });

      // 콘텐츠 미리보기 이벤트
      multifile._$contents.on("click", ".preview", function (e) {
        e.preventDefault();
        var index = $(e.target).closest("li").index();
        // if (!multifile._$contents.find('li').eq(index).hasClass('uploading') && !multifile._options.deleted.button.disabled) {
        filePreview(multifile, index);
        // }
      });
    };

    if (!multifile.initialized) {
      // 멀티파일 헤더 부분 생성합니다.
      createHead();
      // 멀티파일 헤더 체크박스 생성합니다.
      createCheckBox();
      // 멀티파일 헤더 버튼들을 생성합니다.
      createButtons();
      // 멀티파일 생성합니다.
      createContents();
      // 멀티파일 확장자 필터를 설정합니다.
      attachExtensionFilters(multifile);
      // 기본 이벤트를 바인딩합니다.
      bindEvents();
      // 데이터소스 이벤트 바인딩합니다.
      multifile.dataSourceBindEvent();
      // dews-multifile-contents 영역 이벤트 바인딩합니다.
      contentsBindEvent();

      if (multifile.options.dataSource && multifile.options.autoBind) {
        multifile._options.dataSource.read();
      } else {
        updateDownloadable(multifile, false);
        deletedButtonable(multifile, false);
      }

      multifile.initialized = true;
    }
  }

  // 멀티파일 콘텐츠의 내부 생성
  MultiFileComponent.prototype._createContentsData = function (data) {
    if (this._$contents.find("ul").length === 0) {
      this._$contents.append("<ul></ul>");
    }

    var $item = data[this._options.binding.extension] === "hyperlink" ?
    this._createHyperLinkFile(data) :
    this._createFile(data);

    $item.data("data-uid", data.uid);
    this._$contents.find("ul").append($item);
    dews.ui.checkbox($item.find('input[type="checkbox"]'));
    $item.find("label.dews-checkbox-label").on("click", this._checkboxClick.bind(this));
    triggerLayoutChange(this, "multifilename");
    return $item.index();
  };

  MultiFileComponent.prototype._createHyperLinkFile = function (data) {
    var url = data[this._options.binding.url] || "";

    var result =
    "<li>" +
    '<input type="checkbox" class="hyperlink" disabled>' +
    '<span class="span-wrapper">' +
    '<span class="icon-sprite hyperlink"></span>' +
    '<span class ="span-filename">' +
    '<a href="' +
    url +
    '" target="_blank">' +
    "</a>" +
    "</span>" +
    '</span><div class="btn-icon">';

    if (
    this._options.deleted.button.visible &&
    this._options.upload.use &&
    !this._options.deleted.button.disabled)
    {
      result += '<button class="delete"></button>';
    }
    result += "</li>";

    result = $(result);
    result.find(".span-filename > a").text(data[this._options.binding.filename]);

    return result;
  };

  MultiFileComponent.prototype._createFile = function (data) {
    var dataSize = getSize(data[this._options.binding.size]);
    setDelimiter(dataSize);
    var result =
    "<li>" +
    '<input type="checkbox">' +
    '<span class="span-wrapper">' +
    '<span class="icon-sprite ' +
    data[this._options.binding.extension] +
    '"></span>' +
    '<span class="span-filename"></span>' +
    '<span class="span-data-Size">' + " (".concat(
    dataSize, ") ") +
    "</span>" +
    "</span>" +
    '<div class="btn-icon">';
    if (
    this._options.download.use &&
    this._options.download.button.visible &&
    !this._options.download.button.disabled)
    {
      result += '<button class="download"></button>';
    }
    if (this._options.usePreview) {
      var extension = data[this._options.binding.extension];
      if (extension !== null && extension !== void 0 && extension.match(/(gif|png|jpg|jpeg|pdf|html)$/i)) {
        result += '<button class="preview"></button>';
      }
    }
    if (
    this._options.deleted.button.visible &&
    this._options.upload.use &&
    !this._options.deleted.button.disabled)
    {
      result += '<button class="delete"></button>';
    }
    result += "</div>" + "</li>";

    result = $(result);
    result.find(".span-filename").text(data[this._options.binding.filename]);


    return result;
  };

  MultiFileComponent.prototype.dataSourceBindEvent = function () {
    var self = this;
    if (!self._options.dataSource) {
      return;
    }
    // 데이터소스 추가 또는 삭제 발생할 경우 이벤트
    self._options.dataSource.bind("change", function (e) {
      var data = e.items;

      switch (e.action) {
        case "add":
          data[0][self._options.binding.fileKey] = data[0].uid;
          var blob = self._options.blob;
          self._options.blob = "";
          if (blob) {
            var index = self._createContentsData(data[0]);
            updateUploading(self, index, true);
            self.uploading = true;

            startUploading(self, data[0], blob, index);
          } else {
            self._createContentsData(data[0]);
          }
          break;
        case "remove":
          var element = _getItemElement(self, data[0]);
          var elementIndex = element.index();
          self._$contents.find("li").eq(elementIndex).remove();
          break;
        case undefined:
          if (self._$contents.find("> ul").length > 0) {
            self._$contents.find("> ul").remove();
          }

          if (data.length > 0) {
            self.updateFileExists(true);
            for (var i = 0; i < data.length; i++) {
              if (data[i].isDeleteFile === true) {
                continue;
              }
              self._createContentsData(data[i]);
            }
          } else {
            self.updateFileExists(false);
          }
          break;}

      self._updateSelectAll();
    });
  };

  /**
   * 체크박스 클릭 함수
   * @param {Event} e 이벤트
   */
  MultiFileComponent.prototype._checkboxClick = function (e) {
    var $label = $(e.target);
    var $checkbox = $label.siblings("input[type='checkbox']");

    if ($checkbox.prop('disabled')) {
      return;
    }

    if ($checkbox.hasClass("select-all")) {
      this._clickSelectAll();
    }

    this._selectAll.check(this._isAllSelected());

    triggerLayoutChange(this.$element, "multifilename");
  };

  MultiFileComponent.prototype._clickSelectAll = function () {
    this._selectAll.check() ?
    this._$contents.find(".k-checkbox:not(.hyperlink)").prop("checked", true) :
    this._$contents.find(".k-checkbox").prop("checked", false);
  };

  MultiFileComponent.prototype._isAllSelected = function () {
    return this._$contents.find(".k-checkbox").filter(":checked").length ===
    this._$contents.find(".k-checkbox:not(.hyperlink)").length;
  };

  /**
   * 파일타입에서 타입 비교
   * @param {object} dragfile 업로드 파일
   * @param {Array} filter 필터 옵션의 제한 된 확장자
   * @returns {boolean} 타입 비교 여부
   */
  function compareExtension(dragfile, filter) {
    var typeParam = typeof filter === "string" ? filter.replace(/\s/g, "") : "image/*",
      file,
      regex;

    typeParam = typeParam.
    replace(/[\-\[\]\/\{\}\(\)\+\?\.\\\^\$\|]/g, "\\$&").
    replace(/,/g, "|").
    replace(/\/\*/g, "/.*");

    if (dragfile) {
      regex = new RegExp(".?(" + typeParam + ")$", "i");
      file = dragfile[0];

      if (!file.type.match(regex)) {
        return false;
      }
    }
    return true;
  }

  /**
   * 멀티 파일 컴포넌트 콘텐츠에 파일 존재 유무 확인
   * @param {boolean} exists 존재 유무
   */
  MultiFileComponent.prototype.updateFileExists = function (exists) {
    if (exists) {
      this.$element.removeClass("empty");
      this._selectAll.disable(false);
    } else {
      this.$element.addClass("empty");
      this._selectAll.disable(true);
      this._selectAll.check(false);
    }

    if (!this._options.download.button.disabled && this._options.download.use) {
      updateDownloadable(this, exists);
    }
    if (!this._options.deleted.button.disabled) {
      deletedButtonable(this, exists);
    }
  };

  MultiFileComponent.prototype._updateSelectAll = function () {
    if (this._isSelectAllUncheckable()) {
      this._selectAll.check(false);
      this._selectAll.disable(true);
      this._$head.find(">label").addClass("disabled");
    } else {
      this._selectAll.disable(false);
      this._$head.find(">label").removeClass("disabled");
    }
  };

  MultiFileComponent.prototype._isSelectAllUncheckable = function () {var _this16 = this;
    return this._$contents.find('li').
    toArray().
    every(function (item, i) {
      var data = getItemData(_this16, i)[0];
      return data[_this16._options.binding.extension] === "hyperlink";
    });
  };

  /**
   * 파일크기 단위를 지정
   * @param {number} size 파일에 bytes단위의 크기
   * @return {string} 파일크기 지정값
   */
  function getSize(size) {
    var sizeUnit = ["bytes", "KB", "MB", "GB", "TB", "PB"];
    var e = Math.floor(Math.log(size) / Math.log(1024));
    return (size / Math.pow(1024, e)).toFixed(2) + " " + sizeUnit[e];
  }

  /**
   * 세자리마다 쉼표 생성
   * @param {string} size 파일크기
   * @return {string} 쉼표 생성된 파일크기
   */
  function setDelimiter(size) {
    return String(size).replace(/\B(?=(?:\d{3})+(?!\d))/g, ",");
  }

  /**
   * 파일명에서 확장자명 추출
   * @param {string} filename 파일명
   * @param {boolean} addDot .추가/삭제
   * @returns {string} 확장자명
   */
  function getExtension(filename, addDot) {
    var fileLen = filename.length;
    var lastDot = filename.lastIndexOf(".");
    if (!addDot) {
      lastDot += 1;
    }
    var fileExt = filename.substring(lastDot, fileLen).toLowerCase();
    return fileExt;
  }

  /**
   * 멀티파일 확장자 필터를 설정합니다.
   * @param {MultiFileComponent} multifile 멀티파일 컴포넌트 인스턴
   */
  function attachExtensionFilters(multifile) {
    var filter = "";
    if ($.isArray(multifile._options.filters) && multifile._options.filters.length > 0) {
      filter = multifile._options.filters.join(",");
    }
    if (filter) {
      multifile.$buttons.$uploadinput.attr("accept", filter);
    }
  }

  /**
   * 멀티 파일 컴포넌트의 업로드가 진행 중인지 여부에 대한 UI 처리를 수행합니다.
   * @param {MultiFileComponent} multifile 멀치 파일 컴포넌트의 인스턴스
   * @param {boolean} uploading 업로드 진행중인지 여부
   */
  function updateUploading(multifile, index, uploading) {
    var $uploadingElement = multifile._$contents.find("li").eq(index);
    var className = "uploading";

    if (uploading) {
      if (!$uploadingElement.hasClass(className)) {
        $uploadingElement.addClass(className);
      }
    } else {
      $uploadingElement.removeClass(className);
    }
    triggerLayoutChange(multifile, "multifilename");
  }

  /**
   * 멀티파일 컴포넌트의 업로드를 시작합니다.
   * @param {MultiFileComponent} multifile 멀티파일 컴포넌트의 인스턴스
   * @param {object} data 업로드 할 데이터
   * @param {Blob} blob 첨부파일
   */
  function startUploading(multifile, data, blob, index) {
    var uploaded;
    var uploadedParameter = {};
    var binding = multifile.options.binding;
    // 파일 업로드 시작
    uploadFile(data, multifile, blob).
    done(function () {
      updateUploading(multifile, index, false);
      multifile.updateFileExists(true);

      uploadedParameter = {
        total: multifile._options._totalCount,
        current: multifile._options._currentCount,
        mode: "progress",
        file: {
          state: "success",
          filename: data[binding.filename],
          extension: data[binding.extension],
          size: data[binding.size],
          fileKey: data[binding.fileKey]
        }
      };

      multifile._options._uploadFiles.push(uploadedParameter.file);

      multifile._options._successCount++;
    }).
    fail(function (type) {
      updateUploading(multifile, index, false);

      uploadedParameter = {
        total: multifile._options._totalCount,
        current: multifile._options._currentCount,
        mode: "progress",
        file: {
          state: "fail",
          filename: data[binding.filename],
          extension: data[binding.extension],
          size: data[binding.size],
          fileKey: data[binding.fileKey]
        }
      };

      multifile._options._uploadFiles.push(uploadedParameter.file);

      multifile._options._failCount++;

      switch (type) {
        case "cancel":
          break;
        case "error":
          break;}

    }).
    always(function () {
      updateUploading(multifile, index, false);
      multifile.uploading = false;

      //업로드 완료 이벤트
      uploaded = new $.Event("uploaded", uploadedParameter);
      multifile.$element.trigger(uploaded);

      multifile._options._currentCount++;

      if (multifile._options._totalCount === multifile._options._currentCount) {
        uploadedParameter = {
          total: multifile._options._totalCount,
          success: multifile._options._successCount,
          fail: multifile._options._failCount,
          mode: "complete",
          files: multifile._options._uploadFiles
        };
        //업로드 완료 이벤트
        uploaded = new $.Event("uploaded", uploadedParameter);
        multifile.$element.trigger(uploaded);

        multifile._selectAll.check(multifile._isAllSelected());
      }
    });
  }

  /**
   * 서버로 파일을 업로드합니다.
   * @param {object} data 업로드 할 데이터
   * @param {MultiFileComponent} multifile 멀티파일 컴포넌트의 인스턴스
   * @param {Blob} blob 첨부파일
   */
  function uploadFile(data, multifile, blob) {
    var $dfd = $.Deferred();
    var $item = _getItemElement(multifile, data);

    // 업로드 프로그래스 요소 생성
    var createProgress = function createProgress() {
      var $progressBox = $(
      '<div class="progress_box">' +
      '<div class="progress">' +
      '<span class="progress-bar"></span>' +
      "</div>" +
      '<button type="button" class="dews-multifile-button icon-close"></button>' +
      "</div>");

      $item.append($progressBox);
      multifile.$buttons.$progressDeleteButton = $item.find(".icon-close");
      multifile.$buttons.$progressDeleteButton.on("click", function (e) {
        var $evt = new $.Event("_uploadCancel");
        $item.trigger($evt);
        multifile._options.dataSource.remove(data);
        $item.remove();
      });
      if (!$item.hasClass("uploading")) {
        $item.addClass("uploading");
      }
    };

    // 업로드 프로그래스 요소 제거
    var removeProgress = function removeProgress() {
      $item.find(".progress_box").remove();
      $item.removeClass("uploading");
    };

    // 업로드 프로그래스 값 변경
    var updateProgress = function updateProgress(percent) {
      var $progress = $item.find(".progress-bar");
      $progress.css("width", percent + "%");
    };

    // 업로드 진행률 변경에 대한 핸들러
    var progressHandler = function progressHandler(e) {
      var percentCompleted = Math.round(e.loaded / e.total * 100);
      console.log("## 첨부파일 업로드 ##", e.loaded, e.total, percentCompleted);
      updateProgress(percentCompleted);
    };

    // 업로드 완료에 대한 핸들러
    var completeHandler = function completeHandler(e) {
      removeProgress();
      clearCancelEvent();
      if (this.status === 200) {
        var resdata = JSON.parse(this.responseText);
        var binding = multifile._options.binding;
        if (resdata.success === "true") {
          resdata = resdata.data;
          data[binding.fileKey] = resdata.newFilename;
          data[binding.filename] = resdata.originalFilename;
          data[binding.extension] = resdata.originalExtension;
          data[binding.size] = parseInt(resdata.fileSize, 10);
          data[binding.isNewFile] = true;
          data[binding.isDeleteFile] = false;
        }
      }
      $dfd.resolve(data);
    };

    // 업로드 중 에러에 대한 핸들러
    var errorHandler = function errorHandler(e) {
      removeProgress();
      clearCancelEvent();
      $dfd.reject("error");
    };

    // 업로드 중 취소에 대한 핸들러
    var cancelHandler = function cancelHandler(e) {
      removeProgress();
      clearCancelEvent();
      $dfd.reject("cancel");
    };

    // 업로드 취소에 이벤트에 등록된 핸들러를 제거
    var clearCancelEvent = function clearCancelEvent() {
      $item.off("_uploadCancel");
    };

    if (!data) return;

    var token = dews.ui.page ? JSON.parse(dews.ui.page.token).access_token : "";

    var formData = new FormData();
    formData.append("file", blob);
    formData.append("isText", "false");
    formData.append(multifile._options.token.param, token);

    var xhr = new XMLHttpRequest();
    xhr.open("POST", multifile._options.upload.url, true);

    xhr.upload.addEventListener("progress", progressHandler);
    xhr.addEventListener("load", completeHandler);
    xhr.addEventListener("error", errorHandler);
    xhr.addEventListener("abort", cancelHandler);

    createProgress();

    $item.on("_uploadCancel", function () {
      if (xhr && xhr.readyState === 1 && $item.hasClass("uploading")) {
        xhr.abort();
        xhr = null;
      }
    });

    xhr.send(formData);

    return $dfd.promise();
  }

  /**
   * 서버에서 파일을 다운로드합니다.
   * @param {MultiFileComponent} multifile 멀티파일 컴포넌트 인스턴스입니다.
   * @param {array|number} checkedIndex 체크 된 인덱스
   * @param {array} checkedData 체크 된 데이터
   */
  function downloadFiles(multifile, checkedIndex, checkedData) {
    var $frame;

    if ($.type(checkedIndex) === "array") {
      for (var i = 0; i < checkedIndex.length; i++) {
        $frame = multifile._$contents.find("li").eq(checkedIndex[i]).find(".download-frame");
        if ($frame.length === 0) {
          $frame = $('<iframe style="display: none; width: 0; height: 0;"></iframe>');
          multifile._$contents.find("li").eq(checkedIndex[i]).append($frame);
        }
      }
    } else {
      $frame = multifile._$contents.find("li").eq(checkedIndex).find(".download-frame");
      if ($frame.length === 0) {
        $frame = $('<iframe style="display: none; width: 0; height: 0;"></iframe>');
        multifile._$contents.find("li").eq(checkedIndex).append($frame);
      }
    }

    var startDownload = function startDownload(url) {
      var binding = multifile.options.binding;
      $frame.prop("src", url);
      var downloadStartedParameter = {
        files: []
      };
      for (var i = 0; i < checkedData.length; i++) {
        downloadStartedParameter.files.push({
          filename: checkedData[i][binding.filename],
          extension: checkedData[i][binding.extension],
          size: checkedData[i][binding.size],
          fileKey: checkedData[i][binding.fileKey]
        });
      }

      // 다운로드 시작 이벤트
      var downloadStarted = new $.Event("downloadStarted", downloadStartedParameter);
      multifile.$element.trigger(downloadStarted);
    };

    getDownloadUrl(multifile, checkedData).then(startDownload);
  }

  /**
   * 첨부파일 다운로드를 위한 임시 인증 토큰을 획득합니다.
   * @param {MultiFileComponent} multifile 멀티파일 컴포넌트의 인스턴스
   * @return {$.Deferred} Promise 객체
   */
  function getTemporaryToken(multifile) {
    var $dfd = $.Deferred();
    var token = "";

    if (multifile._options.token && multifile._options.token.use) {
      dews.api.
      get(multifile._options.token.url, {}).
      done(function (tokenData) {
        token = tokenData;
      }).
      always(function () {
        $dfd.resolve(token);
      });
    } else {
      $dfd.resolve(token);
    }

    return $dfd;
  }

  /**
   * 멀티파일 컴포넌트에 설정된 파일의 다운로드가 가능한 URL을 가져옵니다.
   * @param {MultiFileComponent} multifile 멀티파일 컴포넌트의 인스턴스
   * @param {array} checkedData 체크 된 데이터
   * @return {$.Deferred} Promise 객체
   */
  function getDownloadUrl(multifile, checkedData) {
    var $dfd = $.Deferred();

    var makeUrl = function makeUrl(token) {
      var url;
      var binding = multifile._options.binding;
      var preDownloadParameter, evt;
      if (checkedData.length > 1) {
        url = "/download/files" + "?" + "keys=";
        for (var i = 0; i < checkedData.length; i++) {
          preDownloadParameter = {
            file: {
              filename: checkedData[i][binding.filename],
              extension: checkedData[i][binding.extension],
              fileKey: checkedData[i][binding.fileKey]
            }
          };
          evt = $.Event("preDownload", preDownloadParameter);
          multifile.$element.trigger(evt);
          if (evt.isDefaultPrevented()) {
            continue;
          }

          if (checkedData[i][binding.isNewFile]) {
            url +=
            encodeURIComponent(checkedData[i][binding.fileKey]) +
            ":" +
            encodeURIComponent(checkedData[i][binding.filename]);
          } else {
            url += encodeURIComponent(checkedData[i][binding.fileKey]);
          }
          if (i !== checkedData.length - 1) {
            url += ",";
          }
        }
        url += "&zipname=";
        url += multifile._options.download.zipname;
        if (token) {
          url += "&" + multifile._options.token.param + "=" + encodeURIComponent(token);
        }
      } else {
        if (checkedData[0][binding.isNewFile]) {
          preDownloadParameter = {
            file: {
              filename: checkedData[0][binding.filename],
              extension: checkedData[0][binding.extension],
              fileKey: checkedData[0][binding.fileKey]
            }
          };
          evt = $.Event("preDownload", preDownloadParameter);
          multifile.$element.trigger(evt);
          if (evt.isDefaultPrevented()) {
            return;
          }

          url =
          multifile._options.download.tempUrl +
          "?" +
          multifile._options.download.param +
          "=" +
          encodeURIComponent(checkedData[0][binding.fileKey]) +
          "&filename=" +
          encodeURIComponent(checkedData[0][binding.filename]);
          if (token) {
            url += "&" + multifile._options.token.param + "=" + encodeURIComponent(token);
          }
        } else {
          preDownloadParameter = {
            file: {
              filename: checkedData[0][binding.filename],
              extension: checkedData[0][binding.extension],
              fileKey: checkedData[0][binding.fileKey]
            }
          };
          evt = $.Event("preDownload", preDownloadParameter);
          multifile.$element.trigger(evt);
          if (evt.isDefaultPrevented()) {
            return;
          }

          url =
          multifile._options.download.url +
          "?" +
          multifile._options.download.param +
          "=" +
          encodeURIComponent(checkedData[0][binding.fileKey]);
          if (token) {
            url += "&" + multifile._options.token.param + "=" + encodeURIComponent(token);
          }
        }
      }
      return url;
    };

    getTemporaryToken(multifile).done(function (token) {
      $dfd.resolve(makeUrl(token));
    });

    return $dfd;
  }

  /**
   * 멀티 파일 컴포넌트의 업로드 가능 여부 UI 처리를 수행합니다.
   * @param {MultiFileComponent} multifile 멀티 파일 컴포넌트 인스턴스
   * @param {boolean} use 업로드 가능 여부
   */
  function updateUploadable(multifile, use) {
    var $head = multifile._$head;
    var $buttonUpload = multifile.$buttons.$upload;
    var className = "uploadable";

    if (use) {
      if (!$head.hasClass(className)) {
        $head.addClass(className);
      }
      if ($buttonUpload.hasClass("disabled")) {
        $buttonUpload.removeClass("disabled");
        $buttonUpload.removeClass("k-state-disabled");
      }
      if ($buttonUpload.prop("disabled")) {
        $buttonUpload.prop("disabled", false);
      }
    } else {
      $head.removeClass(className);
      if (!$buttonUpload.hasClass("disabled")) {
        $buttonUpload.addClass("disabled");
        $buttonUpload.addClass("k-state-disabled");
      }
      if (!$buttonUpload.prop("disabled")) {
        $buttonUpload.prop("disabled", true);
      }
    }
  }

  /**
   * 멀티 파일 컴포넌트의 다운로드 가능 여부 UI 처리를 수행합니다.
   * @param {MultiFileComponent} multifile 멀티 파일 컴포넌트의 인스턴스
   * @param {boolean} use 다운로드 사용 여부
   */
  function updateDownloadable(multifile, use) {
    var $head = multifile._$head;
    var $buttonDownload = multifile.$buttons.$download;
    var className = "downloadable";

    if (use) {
      if (!$head.hasClass(className)) {
        $head.addClass(className);
      }
      if ($buttonDownload.hasClass("disabled")) {
        $buttonDownload.removeClass("disabled");
        $buttonDownload.removeClass("k-state-disabled");
      }
      if ($buttonDownload.prop("disabled")) {
        $buttonDownload.prop("disabled", false);
      }
    } else {
      $head.removeClass(className);
      if (!$buttonDownload.hasClass("disabled")) {
        $buttonDownload.addClass("disabled");
        $buttonDownload.addClass("k-state-disabled");
      }
      if (!$buttonDownload.prop("disabled")) {
        $buttonDownload.prop("disabled", true);
      }
    }
  }

  function deletedButtonable(multifile, use) {
    var $head = multifile._$head;
    var $buttonDelete = multifile.$buttons.$delete;
    var className = "deletedButtonable";

    if (use) {
      if (!$head.hasClass(className)) {
        $head.addClass(className);
      }
      if ($buttonDelete.hasClass("disabled")) {
        $buttonDelete.removeClass("disabled");
        $buttonDelete.removeClass("k-state-disabled");
      }
      if ($buttonDelete.prop("disabled")) {
        $buttonDelete.prop("disabled", false);
      }
    } else {
      $head.removeClass(className);
      if (!$buttonDelete.hasClass("disabled")) {
        $buttonDelete.addClass("disabled");
        $buttonDelete.addClass("k-state-disabled");
      }
      if (!$buttonDelete.prop("disabled")) {
        $buttonDelete.prop("disabled", true);
      }
    }
  }

  /**
   * 레이아웃 변경이 일어났다는 이벤트를 발생시킴
   * @param {MultiFileComponent} multifile 멀티 파일 컴포넌트의 인스턴스
   * @param {string} mode 변경된 레이아웃의 형식
   */
  function triggerLayoutChange(multifile, mode) {
    var $evt = new $.Event("_layoutChange");
    $evt.changeType = mode;
    if (multifile.$element) {
      multifile.$element.trigger($evt);
    } else {
      $(multifile).trigger($evt);
    }
  }

  /**
   * 멀티파일의 Data에 대한 li요소 가져오기
   * @param {MultiFileComponent} multifile 멀티 파일 컴포넌트의 인스턴스
   * @param {object} data 선택한 Data
   * @return {object}
   * @private
   */
  function _getItemElement(multifile, data) {
    var $li = multifile._$contents.find("li");
    var length = $li.length;
    var $item;
    for (var index = 0; index < length; index++) {
      if ($li.eq(index).data("data-uid") === data.uid) {
        $item = $li.eq(index);
        return $item;
        break;
      }
    }
  }

  /**
   * 멀티파일의 index값으로 data 정보 가져오기
   * @param {MultiFileComponent} multifile 멀티 파일 컴포넌트의 인스턴스
   * @param {array || number} indef 원하는 정보의 li 인덱스
   * @return {array}
   */
  function getItemData(multifile, index) {
    var $li = multifile._$contents.find("li");
    var data = multifile._options.dataSource.data();
    var dataArray = [];
    var length = data.length;
    if ($.type(index) === "array") {
      for (var q = 0; q < index.length; q++) {
        for (var j = 0; j < length; j++) {
          if ($li.eq(index[q]).data("data-uid") === data[j].uid) {
            dataArray.push(data[j]);
            break;
          }
        }
      }
      return dataArray;
    } else {
      for (var i = 0; i < length; i++) {
        if ($li.eq(index).data("data-uid") === data[i].uid) {
          dataArray.push(data[i]);
          return dataArray;
        }
      }
    }
  }

  /**
   * 멀티파일의 체크 된 항목의 파일 Data 가져오기
   * @param {MultiFileComponent} multifile 멀티 파일 컴포넌트의 인스턴스
   * @return {Array}
   */
  function getcheckedData(multifile) {
    var data = [];

    multifile._$contents.find(".k-checkbox:checked").each(function (idx, value) {
      data.push(multifile._dataItem($(value).closest("li").index()));
    });

    return data;
  }

  /**
   * 멀티파일의 체크 된 항목의 파일 Index 가져오기
   * @param {MultiFileComponent} multifile 멀티 파일 컴포넌트의 인스턴스
   * @return {Array}
   */
  function getcheckedIndex(multifile) {
    var index = [];

    multifile._$contents.find(".k-checkbox:checked").each(function (idx, value) {
      index.push($(value).closest("li").index());
    });

    return index;
  }

  /**
   * 멀티파일의 파일 삭제
   * @param {MultiFileComponent} multifile 멀티 파일 컴포넌트의 인스턴스
   * @param {array || number} index li태그의 인덱스
   */
  function deleteFile(multifile, index) {
    var data;
    var binding = multifile._options.binding;
    var deleteIndex = [];
    var deleteParameter;

    data = getItemData(multifile, index);

    if (data) {
      if ($.type(index) === "array") {
        deleteIndex = index;
      } else {
        deleteIndex.push(index);
      }
      for (var i = data.length - 1; i > -1; i--) {
        deleteParameter = {
          file: {
            filename: data[i][binding.filename],
            extension: data[i][binding.extension],
            fileKey: data[i][binding.fileKey]
          }
        };
        var evt = $.Event("preDelete", deleteParameter);
        multifile.$element.trigger(evt);
        if (evt.isDefaultPrevented()) {
          continue;
        }

        if (!multifile._$contents.find("li").eq(deleteIndex[i]).hasClass("uploading")) {
          if (data[i][binding.isNewFile]) {
            multifile._options.dataSource.remove(data[i]);
          } else {
            data[i][binding.isDeleteFile] = true;
            multifile._$contents.find("li").eq(deleteIndex[i]).remove();
            multifile._options.dataSource._destroyed.push(data[i]);
          }
        }
      }
    }

    multifile._selectAll.check(multifile._isAllSelected());
    triggerLayoutChange(multifile, "multifilename");
  }

  /**
   * 파일 확장자 필터를 비웁니다.
   * @param {MultiFileComponent} multifile 멀티파일 컴포넌트의 인스턴스
   */
  function clearExtensionFilters(multifile) {
    multifile.$buttons.$uploadinput.removeAttr("accept");
  }

  /**
   * 업로드 제한할 확장자 파일이 있는지 확인 합니다.
   * @param {array} 파일배열
   * @returns {boolean} 업로드 제한할 확장자 파일이 있는지 여부
   */
  function isLimitExtension(arrFile) {
    var isLimit = false;

    if (
    dews._environments.files &&
    dews._environments.files.ignored &&
    dews._environments.files.ignored.extensions)
    {
      var arrExt = dews._environments.files.ignored.extensions;

      if (arrFile.length > 0) {
        for (var i = 0; i < arrFile.length; i++) {
          var ext = getExtension(arrFile[i].name, true);

          if (arrExt.indexOf(ext) > -1) {
            isLimit = true;
            dews.alert(
            "[" +
            arrFile[i].name +
            "]\n" +
            dews.localize.get("업로드 제한된 확장자입니다.", "dews_업로드 제한된 확장자입니다."),
            "error");

            break;
          }
        }
      }
    }

    return isLimit;
  }

  /**
   * @typedef {Object} Checkbox dews.ui.checkbox 객체
   */

  /**
   * 멀티 파일 컴포넌트의 생성자
   *
   * @class MultiFileComponent
   *
   * @property {boolean|undefined} initialized 컴포넌트가 초기화 되어 있는 상태인지 여부입니다.
   * @property {{$upload: jQuery, $download: jQuery, $delete: jQuery, $uploadinput: jQuery}} $buttons 멀티 파일 컴포넌트 버튼
   * @property {jQuery} _$head 헤더 요소의 jQuery 객체입니다.
   * @property {Checkbox} _selectAll 헤더의 체크박스 dews 객체입니다.
   * @property {jQuery} _$contents 콘텐츠 요소의 jQuery 객체입니다.
   * @property {jQuery} _$spanwrapper 콘텐츠 요소의 jQuery 객체입니다.
   * @property {boolean} uploading 현재 업로드 중인지 여부를 가져옵니다.
   *
   * @param {Element} el 변환 대상 요소
   * @param {MultiFileOptions} opt 옵션
   * @constructor
   */
  function MultiFileComponent(el, opt) {
    var self = this;
    var options = $.extend(true, {}, defaultOptions, getInlineOptions(el), opt);

    self.element = el;
    self.$element = $(el);
    self._options = options; // 실제 사용되는 옵션
    self.options = options; // 초기화 시 할당된 옵션 정보

    initialize(self);
  }

  /**
   * 멀티파일 컴포넌트에 데이터소스를 새로 설정 합니다.
   * @param {object} dataSource 설정할 데이터소스
   */
  MultiFileComponent.prototype.setDataSource = function (dataSource) {
    var self = this;
    self._options.dataSource.unbind("change");
    self._$contents.find("> ul").remove();
    self._options.dataSource = dataSource;
    self.dataSourceBindEvent();
    var data = self._options.dataSource.data();
    if (data.length > 0) {
      self.updateFileExists(true);
      for (var i = 0; i < data.length; i++) {
        if (data[i].isDeleteFile === true) {
          continue;
        }
        self._createContentsData(data[i]);
      }
      self._updateSelectAll();
    }
  };

  /**
   * 멀티파일 컴포넌트에 지정한 파일 정보를 삭제합니다.
   * @param {array||number} index 삭제할 인덱스
   */
  MultiFileComponent.prototype.deleteMultiFile = function (index) {
    var self = this;
    deleteFile(self, index);
  };

  /**
   * 멀티파일 컴포넌트에 지정한 파일 정보를 가져옵니다.
   * @param {array||number} index 가져올 인덱스
   * @return {*}
   */
  MultiFileComponent.prototype.getMultiFile = function (index) {
    var self = this;
    return getItemData(self, index);
  };

  MultiFileComponent.prototype.addHyperLink = function (name, url) {
    var self = this;
    var dataBinding = {};
    var binding = self._options.binding;

    dataBinding[binding.fileKey] = "";
    dataBinding[binding.filename] = name;
    dataBinding[binding.extension] = "hyperlink";
    dataBinding[binding.size] = 0;
    dataBinding[binding.url] = url;
    dataBinding[binding.isNewFile] = true;
    dataBinding[binding.isDeleteFile] = false;
    self._options.dataSource.add(dataBinding);
  };

  MultiFileComponent.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change", "preUpload", "preDownload", "preDelete", "uploaded", "downloadStarted"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "change") {
          self.$element.trigger("_change");
        } else {
          self.$element.trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  /**
   * 이벤트 핸들러를 등록합니다.
   */
  MultiFileComponent.prototype.on = function () {
    var self = this;

    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    }

    self.$element.on.apply(self.$element, arguments);
  };

  /**
   * 이벤트 핸들러를 제거합니다.
   */
  MultiFileComponent.prototype.off = function () {
    var self = this;

    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    }

    self.$element.off.apply(arguments);
  };

  /**
   * 원하는 행에대한 Data 값을 가져옵니다.
   * @param {number} row 원하는 row
   */
  MultiFileComponent.prototype._dataItem = function (row) {
    var self = this;
    var data = self._options.dataSource.data();

    if (self._options.dataSource && row > -1) {
      var $uid = self._$contents.find("li").eq(row).data("data-uid");
      for (var i = 0; i < data.length; i++) {
        if (data[i].uid === $uid) {
          return data[i];
          break;
        }
      }
    }
  };

  /**
   * 멀티파일 컴포넌트에 체크된 파일의 다운로드 주소를 가져옵니다.
   * @return {$.Deferred}
   */
  MultiFileComponent.prototype.getDownloadUrl = function () {
    var self = this;
    var checkedData = getcheckedData(self);
    return getDownloadUrl(self, checkedData);
  };

  /**
   * 업로드 파일 선택 파일 필터를 추가합니다.
   * @param (...string} extensions 필터로 설정할 확장자 입니다.
   */
  MultiFileComponent.prototype.addMultiFileFilters = function (extensions) {
    var self = this;
    var newFilters = Array.prototype.slice.call(arguments);
    if (!$.isArray(self._options.filters)) {
      self._options.filters = [];
    }

    if (newFilters.length > 0) {
      self._options.filters = self._options.filters.concat(newFilters);

      attachExtensionFilters(self);
    }
  };

  /**
   * 업로드 파일 선택 파일 필터에서 지정한 항목들을 제거합니다.
   * @param {...string} extensions 필터에서 제거할 확장자 입니다.
   */
  MultiFileComponent.prototype.removeMultiFileFilters = function (extensions) {
    var self = this;

    if (!$.isArray(self._options.filters)) {
      self._options.filters = [];
    }

    var removes = Array.prototype.slice.call(arguments);
    self._options.filters = self._options.filters.filter(function (item) {
      return removes.indexOf(item) < 0;
    });

    attachExtensionFilters(self);
  };

  /**
   * 설정된 업로드 파일 선택 파일 필터를 가져옵니다.
   * @return {string[]} 파일 필터 배열 객체
   */
  MultiFileComponent.prototype.getMultiFileFilters = function () {
    var self = this;
    return self._options.filters || [];
  };

  /**
   * 업로드 파일 선택 파일 필터를 초기화합니다.
   */
  MultiFileComponent.prototype.clearMultiFileFilters = function () {
    var self = this;
    self._options.filters = [];
    clearExtensionFilters(self);
  };

  /**
   * 업로드 기능 활성화 여부를 설정합니다.
   * @param value {boolean} 업로드 버튼 활성화 여부
   */
  MultiFileComponent.prototype.uploadEnable = function (value) {
    var self = this;

    if ($.type(value) === "boolean") {
      updateUploadable(self, value);
      self._options.upload.use = value;
    } else {
      return self._options.upload.use;
    }
  };

  /**
   * 다운로드 기능 활성화 여부를 설정합니다.
   * @param value {boolean} 다운로드 버튼 활성화 여부
   */
  MultiFileComponent.prototype.downloadEnable = function (value) {
    var self = this;

    if ($.type(value) === "boolean") {
      if (getcheckedIndex(self).length > 0 && value) {
        updateDownloadable(self, true);
      } else {
        updateDownloadable(self, false);
      }
      self._options.download.use = value;
      if (value) {
        self._$contents.find("button.download").css("display", "");
      } else {
        self._$contents.find("button.download").css("display", "none");
      }
    } else {
      return self._options.download.use;
    }
  };

  /**
   * 삭제 기능 활성화 여부를 설정합니다.
   * @param value {boolean} 삭제 버튼 활성화 여부
   */
  MultiFileComponent.prototype.deleteEnable = function (value) {
    var self = this;

    if ($.type(value) === "boolean") {
      if (getcheckedIndex(self).length > 0 && value) {
        deletedButtonable(self, true);
      } else {
        deletedButtonable(self, false);
      }
      self._options.deleted.button.disabled = !value;
      if (value) {
        self._$contents.find("button.delete").css("display", "");
      } else {
        self._$contents.find("button.delete").css("display", "none");
      }
    } else {
      return !self._options.deleted.button.disabled;
    }
  };

  /**
   * 파일 컨트롤에 설정되어 있는 파일의 미리보기를 제공하는 API
   * => image, pdf, html 에 한해서
   */
  function filePreview(multifile, index) {
    var self = multifile;
    var binding = self._options.binding;
    var fileInfo = self.getMultiFile(index)[0];

    if (self.options.usePreview && fileInfo) {
      var extension = fileInfo[binding.extension];

      if (extension.match(/(gif|png|jpg|jpeg|pdf|html)$/i)) {
        if (extension.match(/(gif|png|jpg|jpeg)$/i)) {
          // 이미지 파일은 기존대로 download/image/ 경로
          extension = "image";
        }

        var previewUrl = "/download/" + extension + "/" + fileInfo[binding.fileKey];

        if (fileInfo[binding.isNewFile]) {
          // temp일 경우 :파일명 붙여줌
          var fileName = fileInfo[binding.filename];

          if (fileInfo[binding.extension].match(/(html)$/i)) {
            // temp html파일에 한하여 확장자 떼고 호출(서버쪽에서 html을 붙이면 호출이 잘못 된다고 함)
            fileName = fileInfo[binding.filename].replace(/.?(html)$/i, "");
          }

          previewUrl += ":" + fileName;
        }

        window.open(previewUrl);
      }
    }
  }

  $.extend(true, dews, {
    /**
     * @namespace
     */
    ui: {
      multifile: function multifile(selector, options) {
        var $el, obj;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var multifile,
            element = this;

          if ($(element).data("dews-control")) {
            multifile = $(element).data("dews-control");
          } else {
            if (!$(element).hasClass("dews-ui-multifile")) {
              $(element).addClass("dews-ui-multifile");
            }
            if (!$(element).hasClass("dews-form-control")) {
              $(element).addClass("dews-form-control");
            }

            if (!$(element).hasClass("dews-control-activate")) {
              $(element).addClass("dews-control-activate");
            }

            multifile = new MultiFileComponent(element, options);
            $(element).data("dews-control", multifile);
          }

          obj = multifile;
        });

        return obj;
      }
    }
  });

  dews.ui.multifile.click = {
    checkbox: function checkbox(target) {
      var $label = $(target),
        $checkbox = $label.parent(".dews-checkbox-wrapper").find('input[type="checkbox"]'),
        multifile = $checkbox.closest(".dews-ui-multifile"),
        header = multifile.find(".dews-multifile-head"),
        contents = multifile.find(".dews-multifile-contents");

      $checkbox.click();
      if ($checkbox.closest(".dews-multifile-head").length !== 0) {
        if ($checkbox.filter(":checked").length !== 0) {
          contents.find(".k-checkbox").prop("checked", true);
        } else {
          contents.find(".k-checkbox").prop("checked", false);
        }
      }
      if (header.find(".k-checkbox").length !== 0 && contents.find(".k-checkbox").length !== 0) {
        if (contents.find(".k-checkbox").filter(":checked").length === contents.find(".k-checkbox").length) {
          header.find(".k-checkbox").prop("checked", true);
        } else {
          header.find(".k-checkbox").prop("checked", false);
        }
      }
      triggerLayoutChange(multifile, "multifilename");
    }
  };
})(jQuery, window.dews);


/**
 * 멀티파일 다이얼로그
 */
(function ($, dews, kendo) {
  var defaultOptions = {
    visible: false,
    upload: {
      use: true,
      url: "/upload/file",
      button: {
        disabled: false,
        visible: true
      }
    },
    download: {
      use: true,
      url: "/download/file",
      tempUrl: "/download/tempfile",
      param: "key",
      zipname: "test",
      button: {
        disabled: false,
        visible: true
      }
    },
    deleted: {
      button: {
        disabled: false,
        visible: true
      }
    },
    token: {
      use: true,
      url: "/auth/temporary/token",
      param: "token"
    },
    binding: {
      fileKey: "fileKey",
      filename: "filename",
      extension: "extension",
      size: "size"
    },
    content: '<div class="dews-ui-multifiledialog"></div>',
    usePreview: false
  };

  /**
   * 멀티파일 다이얼로그 창
   * @param {string} id 다이얼로그 아이디
   * @param {object} [options] 다이얼로그 생성 옵션 값
   * @param {boolean} [useMain] 다이얼로그를 메인 프레임에 생성할지 여부
   * @constructor
   */
  function multifileDialogWindow(id, options, useMain) {
    var self = this,
      modal = options.modal,
      data;
    //initDataSource = dews.ui.dataSource('BackUpDataSource', {});

    self.id = id;
    self.options = $.extend(true, {}, defaultOptions, options);
    self.initData = null; // 확인필요
    self.buttons = {
      ok: $('<button class="dews-ui-button confirm"></button>'),
      cancel: $('<button class="dews-ui-button confirm"></button>')
    };

    // for (var i = 0; i < self.options.dataSource.data().length; i++) {
    //     data.push(self.options.dataSource.at(i));
    // }

    if (!self.options.upload.use) {
      self.options.buttons = "close";
    }

    if (self.options.size) {
      if (self.options.size.toLowerCase() === "small") {
        self.options.width = 660;
        self.options.height = 230;
      }
    } else {
      self.options.width = 660;
      self.options.height = 600;
    }

    if (self.options.width < 660) {
      console.log("멀티파일 width 에러");
      self.options.width = 660;
    }

    if (self.options.height < 230) {
      console.log("멀티파일 height 에러");
      self.options.height = 230;
    }

    data = self.options.dataSource.data().toJSON();

    self.options.initDataItem = data;

    self.dialog = dews.ui.dialog(id, self.options);

    self.options = $.extend(true, {}, self.options, self.dialog.options);

    self.multifileOptions = {
      dataSource: self.options.dataSource,
      download: self.options.download,
      upload: self.options.upload,
      deleted: self.options.deleted,
      token: self.options.token,
      binding: self.options.binding,
      filters: self.options.filters,
      usePreview: self.options.usePreview
    };
  }

  /**
   * 다이얼로그 창을 엽니다.
   */
  multifileDialogWindow.prototype.open = function () {
    var self = this;

    self.dialog.open(true);

    self._initEventListener();
  };

  /**
   * 다이얼로그 윈도우의 처리가 정상적으로 끝나 다이얼로그를 닫습니다.
   */
  multifileDialogWindow.prototype.ok = function () {
    var self = this;

    self.dialog.ok();
  };

  /**
   * 다이얼로그 창을 닫습니다.
   */
  multifileDialogWindow.prototype.close = function () {
    var self = this;

    self.dialog.close();
  };

  /**
   * 다이얼로그 윈도우의 처리를 취소하고 다이얼로그를 닫습니다.
   */
  multifileDialogWindow.prototype.cancel = function () {
    var self = this;

    self.dialog.cancel();
  };

  /**
   * 다이얼로그 윈도우의 사이즈를 조정합니다.
   * @param {number} width 너비
   * @param {number} height 높이
   * @param {boolean} center 가운데 여부(기본값: 중앙)
   */
  multifileDialogWindow.prototype.resize = function (width, height, center) {
    var self = this;

    self.dialog.resize(width, height, center);
  };

  /**
   * 다이얼로그의 제목을 설정하거나 가져옵니다.
   * @param {string} [title] 다이얼로그 제목
   * @returns {string} 다이얼로그 제목
   */
  multifileDialogWindow.prototype.title = function (title) {
    var self = this;

    title = self.dialog.title(title);

    return title;
  };

  /**
   * 멀티파일 다이얼로그에 데이터소스를 설정을 변경합니다.
   * @param {object} dataSource 설정할 데이터소스
   */
  multifileDialogWindow.prototype.setDataSource = function (dataSource) {
    var self = this;

    if (self.multifile) {
      self.multifile.setDataSource(dataSource);
    }
  };

  /**
   * 멀티파일 다이얼로그에 지정한 파일 정보를 삭제합니다.
   * @param {array||number} index 삭제할 위치 정보
   */
  multifileDialogWindow.prototype.deleteMultiFile = function (index) {
    var self = this;

    if (self.multifile) {
      self.multifile.deleteMultiFile(index);
    }
  };

  /**
   * 멀티파일 다이얼로그에 지정한 파일 정보를 가져옵니다.
   * @param {array||number} index 가져올 위치 정보
   * @return {*}
   */
  multifileDialogWindow.prototype.getMultiFile = function (index) {
    var self = this;

    if (self.multifile) {
      return self.multifile.getMultiFile(index);
    }
  };

  /**
   * 이벤트 핸들러를 등록합니다.
   */
  multifileDialogWindow.prototype.on = function () {
    var self = this;

    if (self.multifile) {
      self.multifile.on();
    }
  };

  /**
   * 이벤트 핸들러를 제거합니다.
   */
  multifileDialogWindow.prototype.off = function () {
    var self = this;

    if (self.multifile) {
      self.multifile.off();
    }
  };

  /**
   * 업로드 파일 선택 파일 필터를 추가합니다.
   * @param {...string} extensions 필터로 설정할 확장자 입니다.
   */
  multifileDialogWindow.prototype.addMultiFileFilters = function (extensions) {
    var self = this;

    if (self.multifile) {
      self.multifile.addMultiFileFilters(extensions);
    }
  };

  /**
   * 업로드 파일 선택 파일 필터를 제거합니다.
   * @param {...string} extensions 필터로 제거할 확장자 입니다.
   */
  multifileDialogWindow.prototype.removeMultiFileFilters = function (extensions) {
    var self = this;

    if (self.multifile) {
      self.multifile.removeMultiFileFilters(extensions);
    }
  };

  /**
   * 설정된 업로드 파일 선택 파일 필터를 가져옵니다.
   * @return {string[]} 파일 필터 배열 객체
   */
  multifileDialogWindow.prototype.getMultiFileFilters = function () {
    var self = this;

    if (self.multifile) {
      return self.multifile.getMultiFileFilters();
    }
  };

  /**
   * 업로드 파일 선택 파일 필터를 초기화합니다.
   */
  multifileDialogWindow.prototype.clearMultiFileFilters = function () {
    var self = this;

    if (self.multifile) {
      self.multifile.clearMultiFileFilters();
    }
  };

  /**
   * 다이얼로그 이벤트 바인딩
   * @private
   */
  multifileDialogWindow.prototype._initEventListener = function () {
    var self = this,
      kWin = self.dialog._kendoWindow,
      multifile;

    kWin.bind("activate", function () {
      var $mfile = self.dialog.$content.find(".dews-ui-multifiledialog");
      multifile = dews.ui.multifile($mfile, self.multifileOptions);
      self.multifile = multifile;

      $mfile.
      closest(".k-window").
      find(".k-button-icon").
      on("click", function () {
        self.options.dataSource.data(self.options.initDataItem);
      });
    });

    kWin.bind("close", function () {
      self.options.dataSource.unbind("change");
    });

    self.dialog.buttons.cancel.on("click", function () {
      self.options.dataSource.data(self.options.initDataItem);
    });

    self.dialog.buttons.ok.on("click", function () {
      console.log("ok click");
    });
  };

  /**
   * 다이얼로그가 출력된 메인 프레임 윈도우 객체를 찾아서 반환합니다.
   * @param {object} win 대상 윈도우 객체
   */
  function getMainFrameWindowObject(win) {
    if (win.dews && win.dews.isMainFrame()) {
      return win;
    } else if (win !== window.top) {
      return getMainFrameWindowObject(win.parent); // 메인 프레임이 아니고 부모 프레임이 존재하면 부모 프레임 검사
    } else {
      return win; // 어떤 프레임도 메인 프레임이 아닐 경우에는 현재 프레임 객체를 메인 프레임으로 반환
    }
  }

  function findMultiDialog(multifiledialogID, win) {
    var multifileDialog, $multifileDialog, rootWin;

    if (!win) {
      win = window;
    }

    $multifileDialog = win.$("#" + multifiledialogID + ".dews-ui-dialog");

    if ($multifileDialog.length > 0) {
      multifileDialog = $multifileDialog.eq(0).data("dews-control");
    } else {
      rootWin = getMainFrameWindowObject(win);

      if (rootWin !== win) {
        multifileDialog = findMultiDialog(multifiledialogID, rootWin);
      }
    }

    return multifileDialog;
  }

  $.extend(true, dews, {
    /**
     * @namespace
     */
    ui: {
      /**
       * 멀티파일 다이얼로그를 생성합니다.
       * @param {string} id 다이얼로그 아이디
       * @param {object} [options] 다이얼로그 생성 옵션 값
       * @param {boolean} [useMain] 다이얼로그를 메인 프레임에 생성할지 여부
       */
      multifiledialog: function multifiledialog(id, options, useMain) {
        var multifiledialog, // 멀티파일다이얼로그 객체
          multifiledialogID, // 멀티파일다이얼로그 아이디
          multifiledialogOptions = {}, // 멀팉파일다이얼로그 옵션 값
          find = false; // 기존에 만들어진 다이얼로그를 찾아야 하는지 여부

        if (arguments[0] && $.type(arguments[0]) === "string") {
          multifiledialogID = arguments[0];
        } else {
          throw "다이얼로그의 아이디가 지정되지 않았습니다.";
        }

        if (arguments.length === 1) {
          find = true;
        }

        if (!find) {
          // 멀티파일다이얼로그를 신규로 생성합니다.
          if ($.isPlainObject(arguments[1])) {
            multifiledialogOptions = options;
          }

          if ($.type(useMain) !== "boolean") {
            useMain = true;
          }

          multifiledialog = new multifileDialogWindow(multifiledialogID, multifiledialogOptions, useMain);
        }

        if (!multifiledialog) {
          // 기존에 생성된 멀티파일 다이얼로그의 인스턴스를 찾아서 반환합니다.
          multifiledialog = findMultiDialog(multifiledialogID);

          if (!multifiledialog) {
            throw "지정한 아이디의 다이얼로그를 찾을 수 없습니다.";
          }
        }

        return multifiledialog;
      }
    }
  });
})(jQuery, window.dews, window.kendo);


/*
 * 숫자 텍스트박스
 */
(function ($, dews, kendo) {
  var defaultOption = {
    spinners: false,
    format: "#,##0.##",
    increaseValue: 1000,
    increaseType: "multiple",
    round: "round"
  };

  /**
   * 옵션을 가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   * @param {object} codeOptions 스크립트 코드에서 전송된 옵션
   */
  function getOptions($el, codeOptions) {
    var inlineOptions,
      preDefinedFormat,
      currencyFormat,
      options,
      decimalLength,
      intLength,
      maxLength = 15,
      maxLengthRegex = /^(\d+)(?:,(\d+))?$/; // maxLength 찾는 정규식

    inlineOptions = getInlineOptions($el);

    codeOptions = codeOptions || {};
    if (codeOptions) {
      codeOptions.format ? $el.data("dews-format", codeOptions.format) : "";
      codeOptions.predefined ? $el.data("dews-format-predefined", codeOptions.predefined) : "";
      codeOptions.currency ? $el.data("dews-currency", codeOptions.currency) : "";
    }
    preDefinedFormat = dews.getPreDefinedFormat($el);
    currencyFormat = dews.getCurrencyFormat($el);

    if (currencyFormat) {
      currencyFormat.restrictDecimals = true;
      options = $.extend(true, {}, defaultOption, currencyFormat, inlineOptions, codeOptions);
      options.format = currencyFormat.format;
      if (typeof $el.data("dews-restrict-decimals") !== "undefined") {
        options.restrictDecimals = $el.data("dews-restrict-decimals");
      }
    } else if (preDefinedFormat) {
      preDefinedFormat.restrictDecimals = true;
      options = $.extend(true, {}, defaultOption, preDefinedFormat, inlineOptions, codeOptions);
      options.format = preDefinedFormat.format;
      if (typeof $el.data("dews-restrict-decimals") !== "undefined") {
        options.restrictDecimals = $el.data("dews-restrict-decimals");
      }
    } else if (currencyFormat !== false && preDefinedFormat !== false && inlineOptions) {
      options = $.extend(true, {}, defaultOption, inlineOptions, codeOptions);
    } else {
      if (codeOptions !== undefined) {
        codeOptions.format =
        preDefinedFormat === false && codeOptions.format && codeOptions.predefined === true ?
        defaultOption.format :
        codeOptions.format;
      }
      options = $.extend(true, {}, defaultOption, codeOptions);
    }

    // format 문자열에 따라서 decimals 옵션 설정
    if (options.hasOwnProperty("format") && options.format && !options.hasOwnProperty("decimals")) {
      // format 은 지정했는데 decimals 옵션은 설정하지 않은 경우 자동으로 decimals 설정
      var decimals = 0;
      var abbrPattern = /[nN][0]?([1-9])$/; // N2, N02, n3, n03 등의 약어 포맷에 매칭

      var abbrMatches = abbrPattern.exec(options.format);
      if (!abbrMatches) {
        var fullPattern = /[.]([0#]+)$/; // #,##0.## 과 같은 포맷에 매칭
        var fullMatches = fullPattern.exec(options.format);
        decimals = fullMatches ? fullMatches[1].length : decimals;
      } else {
        decimals = parseInt(abbrMatches[1], 10);
      }
      options.decimals = decimals;
    }

    if (options.maxLength) {
      try {
        var matchArray = maxLengthRegex.exec(options.maxLength);
        if (matchArray && matchArray.length > 0) {
          intLength = parseInt(matchArray[1], 10);

          if (intLength > 15) {
            throw "숫자텍스트박스 maxLength 속성의 설정 가능한 최대값은 15입니다.";
          }

          if (matchArray[2]) {
            // 소수점 입력 자리수 제한이 있을 때
            decimalLength = parseInt(matchArray[2], 10); // 소수점 입력 자리수 제한 값
            intLength = parseInt(matchArray[1], 10) - decimalLength; // 정수 입력 자리수 제한 값 = 전체 입력 가능 값 - 소수점 입력 자리수 값

            if (intLength <= 0) {
              throw "숫자텍스트박스 maxLength 속성의 설정값은 정수부의 숫자가 소수부의 숫자보다 커야합니다.";
            }
          } else {
            // 소수점 입력 자리수 제한이 없을 때
            decimalLength = 0; // 소수점 입력 자리수 제한이 없음!!
            intLength = parseInt(matchArray[1], 10); // 정수 입력 자리수 제한 값
          }
        }
      } catch (e) {
        decimalLength = options.decimals || 0;
        intLength = options.decimals === undefined ? maxLength : maxLength - parseInt(options.decimals, 10);
        console.log(e);
      }
    } else {
      decimalLength = options.decimals || 0;
      intLength = options.decimals === undefined ? maxLength : maxLength - parseInt(options.decimals, 10);
    }

    options.lengthTestRegex = new RegExp("^[-]?(\\d{0," + intLength + "})(?:\\.(\\d{0," + decimalLength + "}))?$");
    options.decimals = decimalLength;
    options.restrictDecimals = true;
    options.decimalLength = decimalLength;

    return options;
  }

  /**
   * HTML 코드 상에 선언되어 있는 옵션을 가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   */
  function getInlineOptions($el) {
    var options = {},
      format,
      step;

    if ($el) {
      if ($el.data("dews-spinners")) {
        options.spinners = /true/i.test($el.data("dews-spinners"));
      }

      // 스피너가 표시되지 않을 때는 방향키를 이용한 증감 기능이 동작되지 않도록 step을 0으로 설정
      if (!options.spinners) {
        options.step = 0;
      }

      if ($el.data("dews-placeholder")) {
        options.placeholder = $el.data("dews-placeholder");
      }

      if (typeof $el.data("dews-min") !== "undefined") {
        options.min = $el.data("dews-min");
      }

      if (typeof $el.data("dews-max") !== "undefined") {
        options.max = $el.data("dews-max");
      }

      if ($el.data("dews-format")) {
        // 포맷 알리아스에서 검색
        format = dews.getFormatFromAlias($el.data("dews-format"));

        if (format) {
          options.format = format;
        }
      }

      if (typeof $el.data("dews-step") !== "undefined") {
        step = parseFloat($el.data("dews-step"));

        if (step >= 0) {
          options.step = step;
        }
      }

      if (typeof $el.data("dews-select-on-focus") !== "undefined") {
        options.selectOnFocus = /true/i.test($el.data("dews-select-on-focus"));
      }

      if (typeof $el.data("dews-decimals") !== "undefined" && options.decimals === undefined) {
        options.decimals = parseInt($el.data("dews-decimals"), 10);

        if (typeof $el.data("dews-restrict-decimals") !== "undefined") {
          options.restrictDecimals = $el.data("dews-restrict-decimals");
        }
      }

      // max-length 추가
      if (typeof $el.data("dews-max-length") !== "undefined") {
        options.maxLength = $el.data("dews-max-length");
      }

      if (typeof $el.data("dews-increase-value") !== "undefined") {
        var increaseValue = parseFloat($el.data("dews-increase-value"));

        if (increaseValue >= 0) {
          options.increaseValue = increaseValue;
        }
      }

      if (typeof $el.data("dews-increase-type") !== "undefined") {
        options.increaseType = $el.data("dews-increase-type");
      }

      if (typeof $el.data("dews-round") !== "undefined") {
        options.round = $el.data("dews-round");
      }
    }

    return options;
  }

  /**
   * 컨트롤을 초기화 합니다.
   * @param {jQuery} $el 대상 DOM 요소의 jQuery 객체
   * @param {object} [options] 설정 값
   */
  function initControl($el, options) {
    var $wrapper, $state, $formatted;

    $wrapper = $el.closest(".k-numerictextbox");
    $state = $wrapper.find(".k-numeric-wrap");
    $formatted = $wrapper.find(".k-formatted-value");

    if ($el.attr("style")) {
      var matches;

      matches = $el.attr("style").match(/width:([^;]+);?/i);
      if (matches && matches.length > 0) {
        $wrapper.width($.trim(matches[1]));
      }
    }

    // 클래스 제거
    if ($wrapper.hasClass("dews-ui-numerictextbox")) {
      $wrapper.removeClass("dews-ui-numerictextbox");
    }
    if ($formatted.hasClass("dews-ui-numerictextbox")) {
      $formatted.removeClass("dews-ui-numerictextbox");
    }
    if ($wrapper.hasClass("dews-control-activate")) {
      $wrapper.removeClass("dews-control-activate");
    }
    if (!$wrapper.hasClass("dews-numerictextbox-wrapper")) {
      $wrapper.addClass("dews-numerictextbox-wrapper");
    }

    // 추가 옵션처리
    if (options && typeof options.selectOnFocus !== "undefined" && options.selectOnFocus) {
      // 포커스 시 전체 선택되도록 설정
      $el.on("focus", function () {
        var $ctl = $(this);
        setTimeout(function () {
          $ctl.select();
        }, 50);
      });
    }

    if (options.placeholder && $el.data("dews-placeholder-localize-key")) {
      $formatted.attr(
      "placeholder",
      dews.localize.get(
      options.placeholder,
      $el.data("dews-placeholder-localize-key"),
      $el.data("dews-placeholder-localize-lang") || null));


    }

    // 상태정보 추가
    if ($wrapper.hasClass("disabled")) {
      $state.addClass("dews-state-disabled");
    }
    if ($wrapper.hasClass("readonly")) {
      $state.addClass("dews-state-readonly");
    }
    if ($wrapper.hasClass("required")) {
      $state.addClass("dews-state-required");
    }
    if ($wrapper.hasClass("etc1")) {
      $state.addClass("dews-state-etc1");
    }
    if ($wrapper.hasClass("etc2")) {
      $state.addClass("dews-state-etc2");
    }
    if ($wrapper.hasClass("etc3")) {
      $state.addClass("dews-state-etc3");
    }

    setUserGuideAPI($el);
  }

  function bindEvent(self) {
    var $el = self.element;
    var options = self.options;

    $el.on("change", function (e) {
      self._change(e.target.value);
    });

    $el.on("keydown", function (e) {
      if (e.keyCode === 187 || e.keyCode === 107) {
        // +키를 이용한 숫자 증가 기능
        var step = options.increaseValue,
          value,
          result;

        value = $el.val() ? parseFloat($el.val()) : 0;

        // maxLength 사용 시 + 버튼으로 값 증가하면 정수 자리수 제한에 걸리도록 수정
        if (options.lengthTestRegex) {
          if (options.increaseType === "plus") {
            result = value + step;
          } else {
            result = value * step;
          }
          result = !options.lengthTestRegex.test(result.toString()) ?
          result.toFixed(options.decimalLength) :
          result;

          if (!options.lengthTestRegex.test(result.toString())) {
            $el.val(value);
          } else {
            $el.val(result);
          }
        } else {
          if (options.increaseType === "plus") {
            $el.val(value + step);
          } else {
            $el.val(value * step);
          }
        }
      } else {
        // maxLength 처리
        var oldText = $el.val();
        if (options.lengthTestRegex) {
          setTimeout(function () {
            var newText = $el.val();
            if (!options.lengthTestRegex.test(newText)) {
              $el.val(oldText);
            }
            // PD1C-1454 1,000 붙여넣기(ctrl + v) 시에 지워지는 현상 수정 (윈도우)
            // kendo paste 이벤트와 setTimeout 중복
          }, 100);
        }
      }
    });

    $el.on("focus", function (e) {
      var self = this,
        $el = $(e.target);

      if ($(self).hasClass("readonly")) {
        $el.val($el.prev().attr("title"));
      }

      if ($el.prop("readonly") === false && $el.prop("disabled") === false) {
        setTimeout(function () {
          $el.select();
        }, 50);
      }
    });
  }

  /**
   * 시용자 가이드를 위한 API 를 추가합니다.
   * @param $element 대상 jQuery 요소
   */
  function setUserGuideAPI($element) {
    $element.on("focus", function () {
      if (dews.ui.page && dews.ui.page.hasUserGuide) {
        if ($.isFunction(dews.ui.page.focusGuideItem) && $element.attr("id")) {
          dews.ui.page.focusGuideItem("#" + $element.attr("id"));
        }
      }
    });
  }

  /**
   * 값을 설정하거나 가져옵니다.
   * @param {function} value Kendo UI 의 value 함수
   */
  function getSetValue(value) {
    return function (val) {
      var self = this;

      if (self.element.data("dewsControl")) {
        if (val && $.type(arguments[1]) === "undefined" && arguments[1] !== false) {
          // self.element.val() -> val로 변경 후
          // value API로도 change event 발생하게되어 문의와서 원복함..
          self._change(self.element.val());
        }

        return value.call(self, val);
      } else {
        return value.call(self, val);
      }
    };
  }

  $.extend(true, dews, {
    ui: {
      /**
       * 숫자 텍스트 박스를 생성하거나 가져옵니다.
       * @param {String|jQuery} selector 셀렉터 또는 jQuery 객체
       * @param {Object} [options] 설정 값, 생략하면 생성된 숫자 텍스트 박스의 객체를 획득할 수 있습니다.
       */
      numerictextbox: function numerictextbox(selector, options) {
        var $el, textbox;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var $this = $(this),
            control,
            opt;

          control = $this.data("dews-control");

          if (!control) {
            if (!$this.hasClass("dews-ui-numerictextbox")) {
              $this.addClass("dews-ui-numerictextbox");
            }

            if (!$this.hasClass("dews-form-control")) {
              $this.addClass("dews-form-control");
            }

            opt = getOptions($this, options);

            dews.ui.util.ConvertClassAndProperty($this);

            $this.kendoNumericTextBox(opt);

            control = $this.data("kendoNumericTextBox");

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            initControl($this, opt);
            bindEvent(control);

            $this.data("dews-control", control);
          }

          textbox = control;
        });

        return textbox;
      }
    }
  });

  // setOptions 함수 재정의
  kendo.ui.NumericTextBox.fn.setOptions = function (setOptions) {
    return function (options) {
      var self = this;
      var newOpt = getOptions(self.element, options);

      if (options.format || options.decimals) {
        // kendo 숫자텍스트박스 정규식 초기화를 위해서 _separator 초기화
        self._separator = "";
      }

      setOptions.call(self, newOpt);
    };
  }(kendo.ui.NumericTextBox.fn.setOptions);

  // readonly 함수 재정의
  kendo.ui.NumericTextBox.fn.readonly = function (readonly) {
    return function (value) {
      var self = this,
        state;

      if (typeof value === "undefined") {
        return self.element.prop("readonly");
      } else {
        state = self.wrapper.find(".k-numeric-wrap");

        if (value) {
          if (!self.wrapper.hasClass("readonly")) {
            self.wrapper.addClass("readonly");
          }
          if (!self.element.hasClass("readonly")) {
            self.element.addClass("readonly");
          }
          if (!state.hasClass("dews-state-readonly")) {
            state.addClass("dews-state-readonly");
          }
        } else {
          if (self.wrapper.hasClass("readonly")) {
            self.wrapper.removeClass("readonly");
          }
          if (self.element.hasClass("readonly")) {
            self.element.removeClass("readonly");
          }
          if (state.hasClass("dews-state-readonly")) {
            state.removeClass("dews-state-readonly");
          }
        }
      }

      readonly.call(self, value);
    };
  }(kendo.ui.NumericTextBox.fn.readonly);

  // enable 함수재정의
  kendo.ui.NumericTextBox.fn.enable = function (enable) {
    return function (value) {
      var self = this,
        state;

      if (typeof value === "undefined") {
        return !self.element.prop("disabled");
      } else {
        state = self.wrapper.find(".k-numeric-wrap");

        if (value) {
          if (self.wrapper.hasClass("disabled")) {
            self.wrapper.removeClass("disabled");
          }
          if (self.element.hasClass("disabled")) {
            self.element.removeClass("disabled");
          }
          if (state.hasClass("dews-state-disabled")) {
            state.removeClass("dews-state-disabled");
          }
        } else {
          if (!self.wrapper.hasClass("disabled")) {
            self.wrapper.addClass("disabled");
          }
          if (!self.element.hasClass("disabled")) {
            self.element.addClass("disabled");
          }
          if (!state.hasClass("dews-state-disabled")) {
            state.addClass("dews-state-disabled");
          }
        }
      }

      enable.call(self, value);

      if (value) {
        if (self.element.hasClass("readonly")) {
          self.readonly(true);
        }
      }
    };
  }(kendo.ui.NumericTextBox.fn.enable);

  /**
   * 숫자텍스트박스의 visible 여부를 가져온다.
   * @returns {boolean} visible 여부
   * @private
   */
  kendo.ui.NumericTextBox.fn._visibleCheckFromPanel = function () {
    var self = this,
      $ctrl = self.element;
    isVisible = $ctrl.closest(".dews-numerictextbox-wrapper").css("display") !== "none";

    return isVisible;
  };

  /**
   * 숫자 텍스트박스의 텍스트를 가져옵니다.
   * @returns {string} 숫자 텍스트박스의 설정된 텍스트
   */
  kendo.ui.NumericTextBox.fn.text = function () {
    var self = this;

    return self.wrapper.find(".k-formatted-value").val();
  };

  /**
   * 숫자 텍스트박스의 required 상태를 설정 및 해제 합니다.
   * @params {boolean} required 상태
   */
  kendo.ui.NumericTextBox.fn.required = function (value) {
    var self = this;
    var $element = self.element;
    var $wrapper = self.wrapper;
    var state = self.wrapper.find(".k-numeric-wrap");

    if ($.type(value) === "undefined") {
      return $element.hasClass("required");
    }
    if (value === true) {
      $element.addClass("required");
      $wrapper.addClass("required");
      state.addClass("dews-state-required");
    } else if (value === false) {
      $element.removeClass("required");
      $wrapper.removeClass("required");
      state.removeClass("dews-state-required");
    }
  };

  kendo.ui.NumericTextBox.fn.value = getSetValue(kendo.ui.NumericTextBox.fn.value);

  kendo.ui.NumericTextBox.fn.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change", "focus", "blur", "keyup", "keydown"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "change") {
          self.trigger(event);
        } else {
          self.element.trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  kendo.ui.NumericTextBox.fn.on = function () {
    var self = this,
      $element = self.element;
    var evtName = arguments[0];

    // kendo 이벤트가 아닌 경우 $element에 이벤트를 걸어줘야 하기 때문에 조건에 추가해줘야한다.
    if (
    evtName === "nextFocus" ||
    evtName === "beforeFocus" ||
    evtName === "keydown" ||
    evtName === "blur" ||
    evtName === "keyup" ||
    evtName === "focus")
    {
      $element.on.apply($element, arguments);
    } else {
      // kendo 이벤트
      self.bind.apply(self, arguments);
    }
  };

  kendo.ui.NumericTextBox.fn.off = function () {
    var self = this,
      $element = self.element;

    if (arguments[0] === "nextFocus" || arguments[0] === "beforeFocus") {
      $element.off.apply($element, arguments);
    } else {
      self.unbind.apply(self, arguments);
    }
  };

  kendo.ui.NumericTextBox.fn.validate = function () {
    var self = this;
    return !!self.text();
  };

  kendo.ui.NumericTextBox.fn.bindFromPanel = function (data) {
    var self = this,
      $element = self.element;
    var column;

    if (data) {
      column = $element.data("dews-bind-column") || $element.attr("id");

      if (column && data.hasOwnProperty(column)) {
        if ($.type(data[column]) !== ("undefined" || "null")) {
          self.value(data[column]);
        } else {
          self.value("");
        }
      }
    }
  };

  kendo.ui.NumericTextBox.fn.serializeForPanel = function () {
    var self = this,
      $element = self.element;
    var column, data;

    column = $element.data("dews-bind-column") || $element.attr("id");

    if (column) {
      data = {};
      data[column] = self.value();
    }

    return data;
  };

  kendo.ui.NumericTextBox.fn.applyPanelFocus = function (requiredCheck) {
    var self = this,
      $element = self.element;

    $element.on("keydown", function (e) {
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && $element.is(":enabled")) {
        e.preventDefault();
      } else if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();

        var evt = new $.Event("beforeFocus");
        evt.control = self;

        $element.trigger(evt);
      } else if (e.keyCode === 9 || e.keyCode === 13 && $element.is(":enabled")) {
        //tab키, enter키
        if (e.keyCode === 9) {
          //tab키 기본동작 막기
          e.preventDefault();
        }

        if (e.keyCode === 13 && requiredCheck && $element.hasClass("required")) {
          if (self.validate()) {
            var evt = new $.Event("nextFocus");
            evt.control = self;

            $element.trigger(evt);
          }
        } else {
          var evt = new $.Event("nextFocus");
          evt.control = self;

          $element.trigger(evt);
        }
      }
    });
  };

  // instance.focus = function () { } // 자체적으로 focus 를 가지고 있음

  kendo.ui.NumericTextBox.fn.canFocusable = function () {
    var self = this,
      $element = self.element;

    return (
      !$element.hasClass("readonly") &&
      $element.is(":enabled") &&
      $element.closest(".k-numerictextbox").is(":visible"));

  };

  /**
   * 환종별 포맷 적용
   * @param {string} 포맷 적용할 환종
   */
  kendo.ui.NumericTextBox.fn.setCurrency = function (currency) {
    var self = this,
      $el = $(self.element),
      currencyFormat;

    $el.data("dews-currency", currency);

    currencyFormat = dews.getCurrencyFormat($el);

    if (currencyFormat !== undefined && currencyFormat !== false) {
      self.options.format = currencyFormat.format;

      var decimals = currencyFormat.decimals;
      /*var abbrPattern = /[nN][0]?([1-9])$/; // N2, N02, n3, n03 등의 약어 포맷에 매칭
       var abbrMatches = abbrPattern.exec(self.options.format);
      if (!abbrMatches) {
          var fullPattern = /[.]([0#]+)$/; // #,##0.## 과 같은 포맷에 매칭
          var fullMatches = fullPattern.exec(self.options.format);
          decimals = fullMatches ? fullMatches[1].length : decimals;
      } else {
          decimals = parseInt(abbrMatches[1], 10);
      }*/


      self.options.restrictDecimals = true;
      self.options.round = currencyFormat.round;
      self.options.decimals = decimals;
      self._change(self.element.val());
    }
  };

  /**
   * 숫자텍스트박스 컨트롤 자동화 인쇄 관련 데이터 추출
   * @return {*} 값이 설정 된 경우 Object 반환, 없는 경우 undefined 반환
   * @private
   */
  kendo.ui.NumericTextBox.fn._getPrintData = function () {
    var self = this,
      $el = self.element,
      data;

    if (self.text()) {
      data = {
        id: $el.attr("id"),
        text: self.value()
      };
    }

    return data;
  };

  kendo.ui.NumericTextBox.fn._round = function (value, precision) {
    var self = this;
    if ($.type(self.options.round) === "boolean") {
      var rounder = self.options.round ? kendo._round : _truncate;
      return rounder(value, precision);
    } else {
      if (self.options.round === "round") {
        return dews.number.round(value, precision);
      } else if (self.options.round === "ceil") {
        return _ceil(value, precision);
      } else if (self.options.round === "floor") {
        return _truncate(value, precision);
      }
    }
  };

  /**
   * 숫자텍스트박스 컨트롤 display none 하여 숨기는 API
   */
  kendo.ui.NumericTextBox.fn.hide = function () {
    var self = this;

    if (!(self.wrapper.css("display") === "none")) {
      self.wrapper.css("display", "none");
    }
  };

  /**
   * 숫자텍스트박스 컨트롤 display inline-block 하여 보이도록 하는 API
   */
  kendo.ui.NumericTextBox.fn.show = function () {
    var self = this;

    if (self.wrapper.css("display") === "none") {
      self.wrapper.css("display", "inline-block");
    }
  };

  function _ceil(value, precision) {
    var digits = Math.pow(10, precision);
    var num = Math.ceil((value * digits).toFixed(precision)) / digits;

    return num;
  }

  function _truncate(value, precision) {
    var POINT = ".";
    var parts = parseFloat(value, 10).toString().split(POINT);
    if (parts[1]) {
      parts[1] = parts[1].substring(0, precision);
    }
    return parts.join(POINT);
  }

  dews.ui.addControlInitializer("numerictextbox", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.numerictextbox($("input[type='text'].dews-ui-numerictextbox", $container));
  });

  /**
   * kendo의 _step 함수를 재정의합니다.
   * max-length 옵션 사용 시 값 변경할 때 정수 최대 자리수에 제한이 걸리는 코드
   */
  function step(_step) {
    return function (step) {
      var self = this,
        element = self.element,
        oldValue = self._parse(element.val()) || 0,
        value;
      if (self.element.data("dewsControl")) {
        var activeElement = kendo._activeElement;

        if (activeElement() != element[0]) {
          self._focusin();
        }
        if (self.options.factor && oldValue) {
          oldValue = oldValue / self.options.factor;
        }
        value = oldValue + self.options.step * step;
        if (self.options.lengthTestRegex) {
          value = !self.options.lengthTestRegex.test(value.toString()) ?
          value.toFixed(self.options.decimalLength) :
          value;
          if (!self.options.lengthTestRegex.test(value.toString())) {
            value = oldValue;
          }
        }
        self._update(self._adjust(value));
        self._typing = false;
        self.trigger("spin");
      } else {
        _step.call(self, step);
      }
    };
  }

  kendo.ui.NumericTextBox.fn._step = step(kendo.ui.NumericTextBox.fn._step);
})(jQuery, window.dews || {}, window.kendo);


/**
 * 원그리드
 **/
(function ($, dews) {
  var OneGrid = function OneGrid(target) {
    var self = this;

    self._panel = target;

    self._init();

    return self;
  };

  // 원그리드를 사용 시, 편집 버튼 생성
  OneGrid.prototype._init = function () {var _panelItem$, _panelItem$$content;
    var self = this;
    var sourcePanel = self._panel.$element.clone();
    var oneGridData = dews.ui.page.onegridData;

    sourcePanel.data("dews-control", self);
    self._$sourcePanel = sourcePanel;
    if (oneGridData !== null && oneGridData !== void 0 && oneGridData.editable) {
      self._createEditButton(self._panel.$element);
    }

    var panelId;
    // 아무 수정도 일어나지않은 html 초기 구조
    if (self._$sourcePanel.hasClass("dews-ui-condition-panel")) {
      panelId = sourcePanel.attr("id") || "CONDITION";
      self._htmlData = setContentGroupData(self._$sourcePanel, []);
    } else {
      panelId = sourcePanel.attr("id");
      self._htmlData = setContentGroupData(self._$sourcePanel, []);
    }

    var oneGridItems = oneGridData.items;
    var panelItem = [];
    if (dews.ui.dialogPage) {
      if (!$.isEmptyObject(oneGridData) && panelId && oneGridData.items) {
        if (panelId.indexOf(dews.ui.dialogPage.id) !== -1) {
          panelItem.push(oneGridItems.find(function (i) {return i.id === panelId;}));
        } else {
          var findId = dews.ui.dialogPage.id + '-' + panelId;
          panelItem.push(oneGridItems.find(function (i) {return i.id === findId;}));
        }
      }
    } else {
      if (oneGridData.items && oneGridData.items.length > 0) {
        var _oneGridItems = oneGridData.items;
        panelItem = _oneGridItems.filter(function (oneGridItems) {
          return oneGridItems.type === 'FORM' && oneGridItems.id === self._$sourcePanel.attr('id') ||
          oneGridItems.type === 'CONDITION' && (oneGridItems.id === self._$sourcePanel.attr('id') || !self._$sourcePanel.attr('id')); // 컨디션패널 id는 지정안했을수도 있음
        });
      }
    }

    if (panelItem && (_panelItem$ = panelItem[0]) !== null && _panelItem$ !== void 0 && (_panelItem$$content = _panelItem$.content) !== null && _panelItem$$content !== void 0 && _panelItem$$content.items) {// 예전 데이터 맞쳐주기 위함
      if (dews.ui.page.onegridData.authority === 3) {
        self._saveData = panelItem[0].content.useItems;
        self.load(self._panel, panelItem[0].content.useItems);
      } else {
        self._saveData = panelItem[0].content.items;
        self._authData = panelItem[0].content.useItems;
        self.load(self._panel, panelItem[0].content.items);
      }
    }
  };

  // 편집 모드로 진입 시, 패널을 클론
  OneGrid.prototype._clonePanel = function (panel) {
    var self = this;
    var clonePanel;

    clonePanel = panel.clone();

    clonePanel.data("dews-control", self);

    self._$clone = clonePanel;

    panel.before(clonePanel);
    panel.css("display", "none");

    return clonePanel;
  };

  // 패널에 편집 버튼 생성
  OneGrid.prototype._createEditButton = function ($panel) {
    var self = this;
    var $editButton = $('<button class="dews-condition-edit-button" type="button">Edit</button>');
    var $formPanelEditButton = $('<button class="dews-form-panel-edit-button" type="button">Edit</button>');

    if (self._panel.$element.hasClass("dews-ui-condition-panel")) {
      self._$editButton = $editButton;
      $panel.find("form.dews-condition-panel-form").prepend($editButton);
    } else if (self._panel.$element.hasClass("dews-ui-form-panel")) {
      self._$editButton = $formPanelEditButton;
      $panel.find("form.dews-form-panel-form").append($formPanelEditButton);
    }

    self._$editButton.on("click", self, this.enterEditMode);
  };

  // 아이템에 삭제 버튼 생성
  OneGrid.prototype._createItemDelButton = function ($item) {
    var self = this;
    var $delButton = $('<button type = "button" class="drag-del">닫기</button>');
    self._$delButton = $delButton;

    $item.append($delButton);

    self._$delButton.on("click", function (e) {
      var $self = $(e.target).closest("li.drag");
      var $panel = self._$clone;

      $panel.find(".hide-area").append($self);
      $self.find(".drag-del").remove();

      if ($panel.find(".transparency")) {
        $panel.find(".transparency").remove();
      }
      appendTransparencyLi($panel);

      $panel.find(".drag-txt").css("display", "none");

      e.stopPropagation();
    });
  };

  // 편집 모드로 진입 시, 추가되는 영역 생성
  function createHiddenItemContainer(panel) {
    var self = panel;
    var $clonePanel = self._$clone;
    var $hideAreaUL = $('<ul class="hide-area optional-area"></ul>');
    var $editArea = $("<div/>").addClass("item-edit-area");
    var $dragTxt = $(
    '<p class="drag-txt empty"><span>' +
    dews.localize.get(
    "위의 항목을 드래그해서 여기로 끌어놓으면 화면에서 보여지지 않습니다.",
    "dews_위의 항목을 드래그해서 여기로 끌어놓으면 화면에서 보여지지 않습니다.") +

    "</span></p>");

    var $buttonArea = $('<div class="button-area">');
    var $resetButton = $(
    '<button type="button" class="dews-ui-button reset dews-control k-button dews-control-activate">' +
    dews.localize.get("초기화", "dews_초기화") +
    "</button>");

    var $saveButton = $(
    '<button type="button" class="dews-ui-button save dews-control k-button dews-control-activate">' +
    dews.localize.get("저장", "dews_저장") +
    "</button>");

    var $cancelButton = $(
    '<button  type="button" class="dews-ui-button cancel dews-control k-button dews-control-activate">' +
    dews.localize.get("취소", "dews_취소") +
    "</button>");

    var $bottomFlex = $("<div/>").addClass("bottom-flex");

    self._$hideAreaUL = $hideAreaUL;
    self._$resetButton = $resetButton;
    self._$saveButton = $saveButton;
    self._$cancelButton = $cancelButton;

    self._$saveButton.on("click", function () {
      self.save(dews.ui.page);
    });

    self._$cancelButton.on("click", function () {
      self.endEditMode();
    });

    self._$resetButton.on("click", function () {
      if ($clonePanel.hasClass("dews-ui-form-panel")) {
        var panelId = self._panel.$element.attr("id");

        if (!panelId) {
          dews.alert(dews.localize.get("폼패널의 ID를 설정해주세요.", "dews_폼패널의 ID를 설정해주세요."));
          return;
        }
      }

      dews.confirm(dews.localize.get("초기화하시겠습니까?", "dews_초기화하시겠습니까?")).
      yes(function () {
        self.reset(self);
      }).
      no(function () {});
    });

    if ($clonePanel.hasClass("dews-ui-condition-panel")) {
      $clonePanel.find("ul:last").after($editArea);
    } else {
      $clonePanel.find("ul:last").after($bottomFlex);
    }

    $editArea.append($hideAreaUL);
    $hideAreaUL.after($dragTxt);
    $buttonArea.append($resetButton);
    $buttonArea.append($saveButton);
    $buttonArea.append($cancelButton);

    if ($clonePanel.hasClass("dews-ui-condition-panel")) {
      $editArea.after($buttonArea);
    } else {
      $bottomFlex.append($editArea);
      $bottomFlex.append($buttonArea);
    }
  }

  // 드롭 가능한 영역을 나타내는 li 생성
  function appendDropAreaLi(before, col) {
    var cols = "col-" + col.toString();
    var dropAreaLi = '<li class="drop-area drag"></li>';
    var $dropAreaLi;

    $dropAreaLi = $(dropAreaLi);
    $dropAreaLi.addClass(cols);
    $(before).before($dropAreaLi);

    return $(dropAreaLi).index();
  }

  // li의 컬럼 갯수 가져옴
  function getColNum($item) {
    var cols,
      colsRegex = /col-(\d+)\s?/;
    var matches = colsRegex.exec($item.attr("class"));

    if ($.isArray(matches) && matches[1]) {
      cols = parseInt(matches[1], 10);

      return cols;
    } else {
      return 1;
    }
  }

  //transparency li 만들어서 붙여줌
  function appendTransparencyLi($panel) {
    var panelCols =
    $panel.data("dews-control") && $panel.data("dews-control")._panel ?
    $panel.data("dews-control")._panel.options.columns :
    $panel.data("dews-control").options.columns;

    $panel.find("ul").each(function (index, ul) {
      var sum = 0;

      $(ul).
      find("li").
      not(".drag-move").
      not(".transparency").
      each(function (idx, item) {
        var colsRegex = /col-(\d+)\s?/;
        var emptyLITemplate;
        var $item = $(item);
        var matches = colsRegex.exec(item.className);

        if ($panel.hasClass("dews-ui-condition-panel")) {
          emptyLITemplate = '<li class="dews-condition-panel-item-transparency transparency"></li>';
        } else if ($panel.hasClass("dews-ui-form-panel")) {
          emptyLITemplate = '<li class="dews-form-panel-item-transparency transparency"></li>';
        }

        if ($.isArray(matches) && matches[1]) {
          var cols = parseInt(matches[1], 10);

          for (var i = 0; i < cols - 1; i++) {
            var $empty = $(emptyLITemplate);
            $(item).after($empty);
          }
        } else {
          cols = 1;
        }

        var beforeSum = sum;
        sum = sum + cols;

        if (sum === panelCols) {
          sum = 0;
        } else if (sum > panelCols) {
          for (var j = 0; j < panelCols - beforeSum; j++) {
            $empty = $(emptyLITemplate);
            $item.before($empty);
          }

          sum = cols;
        }
      });
    });
  }

  // 드래그가 끝나고 css를 처음 상태로 설정
  function initCss(self) {
    self.css("top", "");
    self.css("left", "");
    self.css("zIndex", "");
  }

  // 컨디션패널의 우측 옵션영역 버튼을 숨기거나 보여줌
  function showHideExpandButton($panel) {
    var flag = false;

    $panel.
    find(".optional-area").
    not(".hide-area").
    each(function (index, item) {
      if ($(item).children().length === 0) {
        $(item).css("display", "none");
      } else {
        flag = true;
      }
    });

    if (flag) {
      $panel.find(".dews-condition-panel-expand-button").css("display", "");
    } else {
      $panel.find(".dews-condition-panel-expand-button").css("display", "none");
    }
  }

  // 컨디션패널 드래그 중
  function doDrag(e) {
    var self = e.data[0];

    if (e.which === 1 && (e.clientX !== self.startX || e.clientY !== self.startY)) {
      var $self = e.data[1];
      var panel, panelTop, panelLeft;
      var findTarget = [],
        $findTarget,
        beforeNode;
      var hideAreaFlag = false,
        requiredAreaFlag = false,
        optionalAreaFlag = false;
      var requiredUlTop,
        optionalUlTop,
        ulTop = 0,
        hideAreaTop;
      var beforeNodeLeft, beforeNodeTop, beforeNodeWidth, beforeNodeHeight;
      var beforeAfter, dropAreaLi;

      panel = $self.closest("*[class^=dews-ui-]").data("dews-control")._$clone;
      panelTop = $(panel).offset().top;
      panelLeft = $(panel).offset().left;

      if ($self.parent().hasClass("hide-area")) {
        hideAreaTop = $(panel).find(".hide-area").offset().top;
        ulTop = hideAreaTop + $self.height() / 2;
        panelTop = ulTop;
      } else if ($self.parent().hasClass("optional-area")) {
        optionalUlTop = $(panel).find(".optional-area").offset().top;
        ulTop = optionalUlTop + $self.height() / 2;
        panelTop = ulTop;
      }

      $self.css("position", "absolute");
      $self.css("top", e.clientY - self.startY - panelTop + "px");
      $self.css("left", e.clientX - self.startX - panelLeft + "px");
      $self.css("z-index", 50);
      $self.addClass("drag-move");
      $self.removeClass("drag");

      $self.parent("ul").append($self);

      if ($(panel).find(".drop-area").length < 1) {
        appendDropAreaLi($self, getColNum($self), e);
      }

      if (
      navigator.appName === "Netscape" && navigator.userAgent.toLowerCase().indexOf("trident") !== -1 ||
      navigator.userAgent.toLowerCase().indexOf("msie") !== -1 ||
      navigator.userAgent.toLowerCase().indexOf("edge") !== -1)
      {
        var nodeList = document.msElementsFromPoint(e.clientX, e.clientY);
        findTarget = Array.prototype.slice.call(nodeList);
      } else {
        findTarget = document.elementsFromPoint(e.clientX, e.clientY);
      }

      for (var i = 0; i < findTarget.length; i++) {
        $findTarget = $(findTarget[i]);

        if ($(panel).has($findTarget).length > 0) {
          if ($findTarget.not(".transparency") && $findTarget.prop("tagName") === "LI") {
            beforeNode = findTarget[i];
          } else if ($findTarget.closest(".hide-area").length > 0) {
            hideAreaFlag = true;
            beforeNode = findTarget[i];
            $(beforeNode).next("p.drag-txt").css("display", "none");
          } else if (
          $(panel).find(".required-area").not(".hide-area").children().length < 1 &&
          $findTarget.prop("tagName") === "UL")
          {
            requiredAreaFlag = true;
          } else if (
          $(panel).find(".optional-area").not(".hide-area").children().length < 1 &&
          $findTarget.prop("tagName") === "UL")
          {
            optionalAreaFlag = true;
          }

          if ($(beforeNode).length > 0) {
            beforeNodeLeft = $(beforeNode).offset().left;
            beforeNodeTop = $(beforeNode).offset().top;
            beforeNodeWidth = $(beforeNode).width();
            beforeNodeHeight = $(beforeNode).height();
          }
        }
      }

      if ($(beforeNode).hasClass("drag")) {
        if (
        $self.find(".required").length > 0 && (
        $(beforeNode).parent().hasClass("optional-area") || $(beforeNode).parent().hasClass("hide-area")))
        {

          // 필수입력 컨트롤은 옵션영역이나, 숨김영역으로 이동 불가
        } else {if (
          $self.get(0) !== beforeNode && (
          beforeNodeLeft + beforeNodeWidth / 2 > e.clientX ||
          beforeNodeTop + beforeNodeHeight / 2 > e.clientY))
          {
            beforeAfter = "before";
          } else if (
          $self.get(0) !== beforeNode && (
          beforeNodeLeft + beforeNodeWidth / 2 < e.clientX ||
          beforeNodeTop + beforeNodeHeight / 2 < e.clientY))
          {
            beforeAfter = "after";
          }

          if ($self.parent().hasClass("hide-area") || !$(beforeNode).parent().hasClass("hide-area")) {
            $(panel).find(".drag-txt").css("display", "none");
          }

          if ($(panel).find(".drop-area").length > 0) {
            dropAreaLi = $(panel).find(".drop-area");

            if (beforeAfter === "before") {
              $(beforeNode).before(dropAreaLi);
            } else if (beforeAfter === "after") {
              $(beforeNode).after(dropAreaLi);
            }
          } else if ($(panel).find(".drop-area").length < 1) {
            appendDropAreaLi(beforeNode, getColNum($self), e);
          }
        }
      } else if (requiredAreaFlag) {
        // 빈 옵션영역으로 옮길때
        if ($self.find(".required").length > 0) {
        } else if ($(panel).find(".drop-area").length > 0) {
          dropAreaLi = $(panel).find(".drop-area");
          $(panel).find(".required-area").not(".hide-area").append(dropAreaLi);
        } else {
          appendDropAreaLi(beforeNode, getColNum($self), e);
        }

        requiredAreaFlag = false;
      } else if (optionalAreaFlag) {
        // 빈 옵션영역으로 옮길때
        if ($self.find(".required").length > 0) {
        } else if ($(panel).find(".drop-area").length > 0) {
          dropAreaLi = $(panel).find(".drop-area");
          $(panel).find(".optional-area").not(".hide-area").append(dropAreaLi);
        } else {
          appendDropAreaLi(beforeNode, getColNum($self), e);
        }

        optionalAreaFlag = false;
      } else if (hideAreaFlag && $self.find(".required").length < 1) {
        // 숨긴 아이템 영역으로 옮길때
        panel.find(".hide-area").append(panel.find(".drop-area"));

        $(beforeNode).next("p.drag-txt").removeClass("empty");
        $(beforeNode).next("p.drag-txt").css("display", "inline-block");
      }

      if ($(panel).find(".transparency")) {
        $(panel).find(".transparency").remove();
      }

      appendTransparencyLi(panel);
    }

    e.stopPropagation();
  }

  // 폼패널 드래그 중
  function doFormDrag(e) {
    var self = e.data[0];

    if (e.which === 1 && (e.clientX !== self.startX || e.clientY !== self.startY)) {
      var $self = e.data[1];
      var panel, panelTop, panelLeft;
      var findTarget = [],
        $findTarget,
        beforeNode;
      var hideAreaFlag = false,
        ulAreaFlag = false;
      var ulTop = 0;
      var beforeNodeLeft, beforeNodeTop, beforeNodeWidth, beforeNodeHeight;
      var beforeAfter, dropAreaLi;
      var $emptyUlTarget;
      var hideAreaTop;

      panel = $self.closest(".dews-ui-form-panel").data("dews-control")._$clone;
      panelTop = $(panel).offset().top;
      panelLeft = $(panel).offset().left;

      if ($self.parent().hasClass("hide-area")) {
        hideAreaTop = $(panel).find(".dews-form-panel-form").find(".hide-area").offset().top;
        ulTop = hideAreaTop + $self.height() / 2;
        panelTop = ulTop;
      }

      $self.css("position", "absolute");
      $self.css("top", e.clientY - self.startY - panelTop + "px");
      $self.css("left", e.clientX - self.startX - panelLeft + "px");
      $self.css("z-index", 50);
      $self.addClass("drag-move");
      $self.removeClass("drag");

      $self.parent("ul").append($self);

      if ($(panel).find(".drop-area").length < 1) {
        appendDropAreaLi($self, getColNum($self), e);
      }

      // 크롬 IE 실행 문제 ( 사파리 안됨)
      if (
      navigator.appName === "Netscape" && navigator.userAgent.toLowerCase().indexOf("trident") !== -1 ||
      navigator.userAgent.toLowerCase().indexOf("msie") !== -1 ||
      navigator.userAgent.toLowerCase().indexOf("edge") !== -1)
      {
        var nodeList = document.msElementsFromPoint(e.clientX, e.clientY);
        findTarget = Array.prototype.slice.call(nodeList);
      } else {
        findTarget = document.elementsFromPoint(e.clientX, e.clientY);
      }

      for (var i = 0; i < findTarget.length; i++) {
        $findTarget = $(findTarget[i]);

        if ($(panel).has($findTarget).length > 0) {
          if ($findTarget.not(".transparency") && $findTarget.prop("tagName") === "LI") {
            beforeNode = findTarget[i];
          } else if ($findTarget.closest(".hide-area").length > 0) {
            hideAreaFlag = true;
            beforeNode = findTarget[i];
            $(beforeNode).next("p.drag-txt").css("display", "none");
            // } else if ($(panel).find('.dews-form-panel-form>ul').not('.hide-area').children().length < 1 && $findTarget.prop('tagName') === 'UL') {
          } else if (
          $findTarget.not(".hide-area").children().length < 1 &&
          $findTarget.prop("tagName") === "UL")
          {
            ulAreaFlag = true;
            $emptyUlTarget = $findTarget;
          }

          if ($(beforeNode).length > 0) {
            beforeNodeLeft = $(beforeNode).offset().left;
            beforeNodeTop = $(beforeNode).offset().top;
            beforeNodeWidth = $(beforeNode).width();
            beforeNodeHeight = $(beforeNode).height();
          }
        }
      }

      if ($(beforeNode).hasClass("drag")) {
        if (
        $self.get(0) !== beforeNode && (
        beforeNodeLeft + beforeNodeWidth / 2 > e.clientX ||
        beforeNodeTop + beforeNodeHeight / 2 > e.clientY))
        {
          beforeAfter = "before";
        } else if (
        $self.get(0) !== beforeNode && (
        beforeNodeLeft + beforeNodeWidth / 2 < e.clientX ||
        beforeNodeTop + beforeNodeHeight / 2 < e.clientY))
        {
          beforeAfter = "after";
        }

        if ($self.parent().hasClass("hide-area") || !$(beforeNode).parent().hasClass("hide-area")) {
          $(panel).find(".drag-txt").css("display", "none");
        }

        if ($(panel).find(".drop-area").length > 0) {
          dropAreaLi = $(panel).find(".drop-area");

          if (beforeAfter === "before") {
            $(beforeNode).before(dropAreaLi);
          } else if (beforeAfter === "after") {
            $(beforeNode).after(dropAreaLi);
          }
        } else if ($(panel).find(".drop-area").length < 1) {
          appendDropAreaLi(beforeNode, getColNum($self), e);
        }
      } else if (ulAreaFlag) {
        // 빈 ul태그영역으로 옮길때
        if ($self.find(".required").length > 0) {
        } else if ($(panel).find(".drop-area").length > 0) {
          dropAreaLi = $(panel).find(".drop-area");
          $emptyUlTarget.not(".hide-area").append(dropAreaLi);
        } else {
          appendDropAreaLi(beforeNode, getColNum($self), e);
        }

        ulAreaFlag = false;
      } else if (hideAreaFlag && $self.find(".required").length < 1) {
        // 숨긴 아이템 영역으로 옮길때
        panel.find(".hide-area").append(panel.find(".drop-area"));

        $(beforeNode).next("p.drag-txt").removeClass("empty");
        $(beforeNode).next("p.drag-txt").css("display", "inline-block");
      }

      if ($(panel).find(".transparency")) {
        $(panel).find(".transparency").remove();
      }

      appendTransparencyLi(panel);
    }

    e.stopPropagation();
  }

  // 드래그 종료
  function stopDrag(e) {
    var self = e.data[0];
    var $self = e.data[1];
    var $clonePanel = self._$clone;
    var $draggableLi;

    $self.css("position", "");
    $self.removeClass("drag-move");
    $self.addClass("drag");

    if ($clonePanel.find(".drop-area") && $clonePanel.find(".drop-area").length > 0) {
      $clonePanel.find(".drop-area").before($self);
      $clonePanel.find(".drop-area").remove();
    }

    if ($clonePanel.hasClass("dews-ui-condition-panel")) {
      $draggableLi = $clonePanel.find(".required-area, .optional-area").find(".drag").not(".transparency");
    } else if ($clonePanel.hasClass("dews-ui-form-panel")) {
      $draggableLi = $clonePanel.find(".dews-form-panel-form>ul").find(".drag").not(".transparency");
    }

    $draggableLi.each(function (index, li) {
      var $li = $(li);

      if (!($li.find(".required").length > 0) && $li.find(".drag-del").length < 1) {
        // 필수입력 아이템이 아닐 경우만..
        self._createItemDelButton($li);
      }
    });

    if ($clonePanel.find(".hide-area").children().length > 0) {
      $clonePanel.find(".drag-txt").css("display", "none");
      $clonePanel.find(".hide-area").find(".drag-del").remove();
    } else {
      $clonePanel.find(".drag-txt").addClass("empty");
      $clonePanel.find(".drag-txt").css("display", "inline-block");
    }

    if ($clonePanel.find(".transparency")) {
      $clonePanel.find(".transparency").remove();
    }

    appendTransparencyLi($clonePanel);

    initCss($self);

    // mousemove, mouseup 이벤트 제거
    if ($clonePanel.hasClass("dews-ui-condition-panel")) {
      $(document.body).off("mousemove", doDrag);
    } else if ($clonePanel.hasClass("dews-ui-form-panel")) {
      $(document.body).off("mousemove", doFormDrag);
    }

    $(document.body).off("mouseup", stopDrag);

    e.stopPropagation();
  }

  function getPanelType($panel) {
    var panelType;

    if ($panel.hasClass("dews-ui-condition-panel")) {
      panelType = "CONDITION";
    } else if ($panel.hasClass("dews-ui-form-panel")) {
      panelType = "FORM";
    }

    if (dews.ui.dialogPage) {
      panelType = panelType.replace(/(.{0})/, "D_");
    }

    return panelType;
  }

  // 편집 모드 진입
  OneGrid.prototype.enterEditMode = function (e) {
    var self = e.data;
    var panel = self._clonePanel(self._panel.$element);
    var data = self._saveData;
    var $ul;

    createHiddenItemContainer(self);

    if (panel.hasClass("dews-ui-form-panel")) {
      $ul = panel.find(".dews-form-panel-form, .item-edit-area").find("> ul");
      panel.addClass("dews-form-panel-edit-mode");
    } else {
      $ul = panel.find(".required-area, .optional-area");
      panel.addClass("dews-condition-edit-mode");
    }

    if (panel.find(".hidden").length > 0) {
      panel.
      find(".hidden").
      children().
      each(function (idx, item) {
        panel.find(".drag-txt").css("display", "none");
      });
    }

    if (data) {
      for (var i = 0; i < data.length; i++) {
        var conId = data[i].itemId;

        if (conId) {
          var $li = panel.find("#" + conId).closest("li");

          if ($li.length > 0) {
            if (panel.hasClass("dews-ui-form-panel")) {
              panel.find(".dews-form-panel-form").find("ul").eq(data[i].groupIndex).append($li);
            } else {
              if (data[i].groupType && data[i].groupType.toUpperCase() !== "HIDDEN") {
                panel.
                find("." + data[i].groupType.toLowerCase() + "-area").
                eq(data[i].groupIndex).
                append($li);
              }
            }

            if (data[i].groupType && data[i].groupType.toUpperCase() === "HIDDEN") {
              panel.find("ul.hide-area").append($li);
            }
          }
        }
      }
    } else {
      for (var i = 0; i < self._htmlData.length; i++) {
        var conId = self._htmlData[i].itemId;

        if (conId) {
          var $li = panel.find("#" + conId).closest("li");

          if ($li.length > 0) {
            if (panel.hasClass("dews-ui-form-panel")) {
              panel.find(".dews-form-panel-form").find("ul").eq(self._htmlData[i].groupIndex).append($li);
            } else {
              if (self._htmlData[i].groupType.toUpperCase() !== "HIDDEN") {
                panel.
                find("." + self._htmlData[i].groupType.toLowerCase() + "-area").
                eq(self._htmlData[i].groupIndex).
                append($li);
              }
            }

            if (self._htmlData[i].groupType && self._htmlData[i].groupType.toUpperCase() === "HIDDEN") {
              panel.find("ul.hide-area").append($li);
            }
          }
        }
      }
    }

    $ul.each(function (idx, ul) {
      $ul = $(ul);
      $ul.find("> li").not(".transparency").addClass("drag");

      $ul.find("> li").
      not(".transparency").
      each(function (index, li) {
        if (!($(li).find(".required").length > 0) && !$ul.hasClass("hide-area")) {
          // 필수입력 아이템이 아니고, 숨겨진 아이템이 아닐 경우만 삭제 버튼 생성
          self._createItemDelButton($(li));
        }
      });
    });

    if (panel.find(".transparency")) {
      panel.find(".transparency").remove();
    }

    appendTransparencyLi(panel);

    // 드래그 시작
    $(".drag").on("mousedown", function (e) {
      var $target = $(e.target);
      // 삭제버튼 클릭 시 드래그 이벤트 방지
      if (!$target.hasClass("drag-del")) {
        var $self = $(e.target).closest("li");
        var liTop = $self.offset().top;
        var liLeft = $self.offset().left;

        self.startY = e.clientY - liTop;
        self.startX = e.clientX - liLeft;

        if ($target.closest(".dews-ui-form-panel").length > 0) {
          $(document.body).on("mousemove", [self, $self], doFormDrag);
          $(document.body).on("mouseup", [self, $self], stopDrag);
        } else {
          $(document.body).on("mousemove", [self, $self], doDrag);
          $(document.body).on("mouseup", [self, $self], stopDrag);
        }

        e.preventDefault();
        e.stopPropagation();
      }
    });
  };

  // 편집 모드 종료
  OneGrid.prototype.endEditMode = function () {
    var self = this;
    var $clonePanel = self._$clone;
    var $orgPanel = self._panel.$element;
    var data = self._saveData || self._htmlData; // self._htmlData 는 저장 후 초기화 했을 때 필요

    self.load(self._panel, data);

    if ($orgPanel.find(".transparency")) {
      $orgPanel.find(".transparency").remove();
    }

    appendTransparencyLi($orgPanel);

    $clonePanel.find(".drag").off("mousedown");
    $clonePanel.remove();
    $orgPanel.css("display", "");

    showHideExpandButton($orgPanel);
  };

  // 사용자 데이터 세팅
  function setContentGroupData($panel, contentObj) {
    var panelType = getPanelType($panel);

    $panel.find(".required-area, .optional-area, .dews-form-panel-form>ul").each(function (idx, ul) {
      var $ul = $(ul);

      $ul.find("> li").
      not(".transparency").
      each(function (index, li) {
        var controlsData = {};

        if ($(li).find("*[class^=dews-ui-].dews-form-control").length > 0) {
          controlsData.itemId = $(li).find("*[class^=dews-ui-][id].dews-form-control").eq(0).attr("id");
        } else {
          controlsData.itemId = $(li).find("*[class^=dews-ui-][id]").eq(0).attr("id");
        }

        if ($ul.hasClass("required-area")) {
          controlsData.groupType = "REQUIRED";
          controlsData.groupIndex = 0;
        } else if ($ul.hasClass("hide-area")) {
          controlsData.groupType = "HIDDEN";
          controlsData.groupIndex = 0;

          if (dews.ui.page.onegridData) {
            if (dews.ui.page.onegridData.authority === 3) {
              // 권한 사용자
              return true;
            } else {
              // 사용자일 때
              controlsData.isVisble = false;
            }
          }
        } else if ($ul.hasClass("optional-area")) {
          controlsData.groupType = "OPTIONAL";
          controlsData.groupIndex = idx - 1;
        } else if (panelType === "FORM" || panelType === "D_FORM") {
          controlsData.groupType = "FORM";
          controlsData.groupIndex = idx;
        }

        if (!$ul.hasClass("hide-area")) {
          controlsData.isVisble = true;
        }

        controlsData.index = index;
        contentObj.push(controlsData);
      });
    });

    return contentObj;
  }

  // 권한 데이터 세팅
  function setUseContentGroupData(panel, contentObj) {
    var self = panel;
    var panelType = getPanelType(self._$clone);

    self._$clone.find(".required-area, .optional-area, .dews-form-panel-form>ul").each(function (idx, ul) {
      var $ul = $(ul);

      $ul.find("> li").
      not(".transparency").
      each(function (index, li) {
        var controlsData = {};

        if ($(li).find("*[class^=dews-ui-].dews-form-control").length > 0) {
          controlsData.itemId = $(li).find("*[class^=dews-ui-][id].dews-form-control").eq(0).attr("id");
        } else {
          controlsData.itemId = $(li).find("*[class^=dews-ui-][id]").eq(0).attr("id");
        }

        if ($ul.hasClass("required-area")) {
          controlsData.groupType = "REQUIRED";
          controlsData.groupIndex = 0;
        } else if ($ul.hasClass("hide-area")) {
          controlsData.groupType = "HIDDEN";
          controlsData.groupIndex = 0;

          if (dews.ui.page.onegridData) {
            controlsData.isVisble = false;
          }
        } else if ($ul.hasClass("optional-area")) {
          controlsData.groupType = "OPTIONAL";
          controlsData.groupIndex = idx - 1;
        } else if (panelType === "FORM" || panelType === "D_FORM") {
          controlsData.groupType = "FORM";
          controlsData.groupIndex = idx;
        }

        if (!$ul.hasClass("hide-area")) {
          controlsData.isVisble = true;
        }

        controlsData.index = index;
        contentObj.push(controlsData);
      });
    });

    return contentObj;
  }

  // 저장된 내용을 불러옴
  OneGrid.prototype.load = function (panel, panelItems) {
    var self = this;
    var $panel = panel.$element;

    $panel.find('.dews-form-panel-form').find('> ul').each(function (idx, ul) {
      var $ul = $(ul);
      var listItem = $ul.find('> li');
      for (var i = 0; i < listItem.length; i++) {
        if (listItem[i].children.length === 0 && listItem[i].classList.length === 0) {
          listItem.eq(i).remove();
        }
      }
    });

    var $hiddenItems = $('<div class="hidden"></div>');
    if ($panel.find('div.hidden').length === 0) {
      $panel.find('form').after($hiddenItems);
    }

    var $NoneItems = $('<div class="auth-hidden" style="display:none;"></div>');
    if ($panel.find('div.auth-hidden').length === 0) {
      $panel.find('form').after($NoneItems);
    }

    if (panelItems) {
      $panel.find('li').not('.transparency').each(function (index, li) {
        var $li = $(li);

        $panel.find("div.auth-hidden").append($li);
      });

      // 해당 되는 애들만 자기 위치로 옮긴다.
      for (var i = 0; i < panelItems.length; i++) {
        placeItem($panel, panelItems[i]);
      }
    }

    if (self._$clone) {
      self._$clone.remove();
      self._panel.$element.css("display", "");
    }

    $hiddenItems.css("display", "none");

    if ($panel.find(".transparency")) {
      $panel.find(".transparency").remove();
    }

    appendTransparencyLi($panel);
    showHideExpandButton($panel);
  };

  function placeItem($place, item) {var _item$groupType, _item$groupType2;
    var $li = $place.find('#' + item.itemId).closest('li');

    if ($place.hasClass('dews-ui-condition-panel') && ((_item$groupType = item.groupType) === null || _item$groupType === void 0 ? void 0 : _item$groupType.toUpperCase()) !== 'HIDDEN') {
      $place.find('.' + item.groupType.toLowerCase() + '-area').eq(item.groupIndex).append($li);
    } else if ($place.hasClass('dews-ui-form-panel')) {
      $place.find('.dews-form-panel-form').find('ul').eq(item.groupIndex).append($li);
    }

    if (((_item$groupType2 = item.groupType) === null || _item$groupType2 === void 0 ? void 0 : _item$groupType2.toUpperCase()) === 'HIDDEN') {
      $li.addClass('drag');
      $place.find('div.hidden').append($li);
    }
  }

  //저장하기 전 상태로 되돌림
  OneGrid.prototype.reset = function (panel) {
    var self = this;
    var $panel = panel._$clone;
    var panelId,
      panelType = getPanelType(self._panel.$element);

    if (self._panel.$element.hasClass("dews-ui-condition-panel")) {
      panelId = self._panel.$element.attr("id") || "CONDITION";
    } else if (self._panel.$element.hasClass("dews-ui-form-panel")) {
      panelId = self._panel.$element.attr("id");
    }

    if (dews.ui.dialogPage) {
      if (!(panelId.indexOf(dews.ui.dialogPage.id) !== -1)) {
        panelId = dews.ui.dialogPage.id + "-" + panelId;
      }
    }

    var parameter = {
      moduleID: dews.ui.page && dews.ui.page.menu ? dews.ui.page.menu.module : null,
      menuID: dews.ui.page && dews.ui.page.menu ? dews.ui.page.menu.id : null,
      type: panelType,
      id: panelId
    };

    dews.ui.page._onegridReset(parameter).done(function (data) {
      if (data.items && data.items.length > 0) {
        var oneGridItems = data.items;
        var item = oneGridItems.filter(function (oneGridItems) {
          return oneGridItems.type === panelType && oneGridItems.id === panelId;
        });

        if (item.length > 0 && item[0].content) {
          // 초기화 해도 데이터가 있는 경우
          self._saveData = item[0].content.items;
        } else {
          self._saveData = null;
        }
      } else {
        // 없는 경우
        self._saveData = null;
      }

      self.endEditMode();
    });

    $panel.
    find(".required-area, .optional-area, .dews-form-panel-form>ul").
    not(".hide-area").
    find(".drag").
    not(".transparency").
    each(function (index, li) {
      var $li = $(li);

      if (!($li.find(".required").length > 0) && $li.find(".drag-del").length < 1) {
        // 필수입력 아이템이 아닐 경우만..
        self._createItemDelButton($li);
      }
    });

    if ($panel.find(".transparency")) {
      $panel.find(".transparency").remove();
    }

    appendTransparencyLi($panel);
  };

  //변경된 내용을 저장
  OneGrid.prototype.save = function (page) {
    var self = this,
      $clonePanel = self._$clone,
      obj = {},
      panelType,
      panelID;

    panelType = getPanelType($clonePanel);

    if (self._panel.$element.hasClass("dews-ui-condition-panel")) {
      panelID = self._panel.$element.attr("id") || "CONDITION";
    } else if (self._panel.$element.hasClass("dews-ui-form-panel")) {
      panelID = self._panel.$element.attr("id");

      if (!panelID) {
        dews.alert(dews.localize.get("폼패널의 ID를 설정해주세요.", "dews_폼패널의 ID를 설정해주세요."));
        return;
      }
    }

    if (dews.ui.dialogPage) {
      if (!(panelID.indexOf(dews.ui.dialogPage.id) !== -1)) {
        panelID = dews.ui.dialogPage.id + "-" + panelID;
      }
    }

    obj = {
      moduleID: page.menu.module,
      menuID: page.menu.id,
      type: panelType,
      id: panelID,
      content: {
        items: [],
        useItems: []
      }
    };

    obj.content.items = setContentGroupData($clonePanel, obj.content.items);
    obj.content.useItems = setUseContentGroupData(self, obj.content.useItems);

    dews.confirm(dews.localize.get("저장하시겠습니까?", "dews_저장하시겠습니까?")).
    yes(function () {
      var param = {
        moduleID: page.menu.module,
        menuID: page.menu.id,
        items: [
        {
          content: {
            items: obj.content.items, // 사용자
            useItems: obj.content.useItems // 전체
          },
          id: obj.id,
          type: obj.type
        }]

      };
      dews.ui.page._onegridSave(obj);

      self._saveData = obj.content.items;

      if (param.items[0].content.items) {
        if (dews.ui.page.onegridData.authority === 3) {
          self._saveData = param.items[0].content.useItems;
        } else {
          self._saveData = param.items[0].content.items;
        }
      }

      self.load(self._panel, self._saveData);
    }).no(function () {
    });
  };

  $.extend(true, dews, {
    ui: {
      Onegrid: function Onegrid(element, panel) {
        return new OneGrid(panel);
      }
    }
  });
})(jQuery, window.dews);


/*
 * 패널바
 */
(function ($, dews, kendo) {
  var defaultOption = {
    expandMode: "single"
  };

  $.extend(true, dews, {
    ui: {
      panelbar: function panelbar(selector, options) {
        var $el, panelbar;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var $this = $(this),
            control,
            opt;

          control = $this.data("dews-control");

          if (!control) {
            opt = $.extend(true, {}, defaultOption, options);

            if (!$this.hasClass("dews-ui-panelbar")) {
              $this.addClass("dews-ui-panelbar");
            }

            $this.kendoPanelBar(opt);
            control = $this.data("kendoPanelBar");

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            $this.data("dews-control", control);
          }

          panelbar = control;
        });

        return panelbar;
      }
    }
  });

  dews.ui.addControlInitializer("panelbar", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.panelbar($("ul.dews-ui-panelbar", $container));
  });
})(jQuery, window.dews, window.kendo);


/*
 * 기간피커
 */
(function ($, dews, kendo) {
  var defaultOptions = {
    buttons: true,
    startDate: null,
    endDate: null
  };

  var PeriodPicker = function PeriodPicker(element, options) {
    var self = this,
      $element = $(element),
      buttons;
    var opt;

    if ($.type($element.data("dews-buttons")) !== "boolean" || $element.data("dews-buttons") === true) {
      buttons = true;
    } else if ($element.data("dews-buttons") === false) {
      buttons = $element.data("dews-buttons");
    }

    opt = $.extend({}, defaultOptions, {
      buttons: buttons && defaultOptions.buttons,
      startDate: $element.data("dews-start-date") || defaultOptions.startDate,
      endDate: $element.data("dews-end-date") || defaultOptions.endDate,
      format: dews._environments.formats.dateFormat,
      valueFormat: dews._environments.formats.dateValueFormat
    });

    self.options = getOptions($element, opt, options);

    self.container = null;
    self.wrapper = null;
    self.startInput = null;
    self.endInput = null;
    self.button = null;
    self.calendars = null;
    self.periodcalendars = null;
    self.startCalendar = null;
    self.endCalendar = null;
    self.buttons = null;
    self.periodDate = null;
    self.okButton = null;
    self.option = null;
    self.todayButton = null;
    self.yesterdayButton = null;
    self.weekButton = null;
    self.lastWeekButton = null;
    self.monthButton = null;
    self.lastMonthButton = null;
    self.upToNowButton = null;
    self.firstQuarterButton = null;
    self.secondQuarterButton = null;
    self.thirdQuarterButton = null;
    self.fourthQuarterButton = null;
    self.firstHalfButton = null;
    self.secondHalfButton = null;
    self.disableButton = false;

    self._element = element;
  };

  PeriodPicker.prototype._createContainer = function () {
    var self = this,
      $el = $(self._element),
      $container,
      width;

    $container = $("<span/>").addClass("dews-periodpicker-container");

    if ($el.attr("style")) {
      var matches = $el.attr("style").match(/width:([^;]+);?/i);

      if (matches) {
        width = $.trim(matches[1]);
        $container.width(width);
      }
    }

    if ($el.attr("id") !== undefined) {
      $container.attr("id", $el.attr("id") + "_container");
    }

    $el.css("display", "inline-block");

    $el.wrap($container);

    if (!$el.hasClass("dews-ui-periodpicker")) {
      $el.addClass("dews-ui-periodpicker");
    }

    if ($container.width() < 188) {
      $container.width(188);
    }

    self.container = $container;
  };

  PeriodPicker.prototype._createWrapper = function () {
    var self = this,
      $el = $(self._element),
      $wrapper;

    $wrapper = $("<span/>").
    addClass("dews-periodpicker-wrapper").
    addClass("k-picker-wrap").
    addClass("k-state-default");

    if ($el.hasClass("readonly")) {
      $wrapper.addClass("dews-state-readonly");
      self.disableButton = true;
    }
    if ($el.hasClass("disabled")) {
      $wrapper.addClass("dews-state-disabled");
      self.disableButton = true;
    }
    if ($el.hasClass("required")) {
      $wrapper.addClass("dews-state-required");
    }
    if ($el.hasClass("etc1")) {
      $wrapper.addClass("dews-state-etc1");
    }
    if ($el.hasClass("etc2")) {
      $wrapper.addClass("dews-state-etc2");
    }
    if ($el.hasClass("etc3")) {
      $wrapper.addClass("dews-state-etc3");
    }

    self.wrapper = $wrapper;
    $el.append($wrapper);
  };

  PeriodPicker.prototype._createStartInput = function () {
    var self = this,
      $el = $(self._element),
      $startInput;

    $startInput = $("<input/>").addClass(
    "dews-periodpicker-input dews-periodpicker-startDate k-textbox k-space-right");


    if ($el.attr("id") !== undefined) {
      $startInput.attr("id", $el.attr("id") + "_startinput");
    }

    if ($el.hasClass("readonly")) {
      $startInput.addClass("dews-state-readonly");
      $startInput.attr("readonly", "readonly");
    }
    if ($el.hasClass("disabled")) {
      $startInput.addClass("dews-state-disabled");
      $startInput.attr("disabled", "disabled");
    }
    if ($el.hasClass("required")) {
      $startInput.addClass("dews-state-required");
    }
    if ($el.hasClass("etc1")) {
      $startInput.addClass("dews-state-etc1");
    }
    if ($el.hasClass("etc2")) {
      $startInput.addClass("dews-state-etc2");
    }
    if ($el.hasClass("etc3")) {
      $startInput.addClass("dews-state-etc3");
    }

    setMask($startInput, self.options.format);
    setEvent($startInput, self.options);

    self.startInput = $startInput;
    self.wrapper.append($startInput);
  };

  PeriodPicker.prototype._createEndInput = function () {
    var self = this,
      $el = $(self._element),
      $endInput,
      $span,
      opt;

    $endInput = $("<input/>").addClass("dews-periodpicker-input dews-periodpicker-endDate k-textbox k-space-right");
    $span = $("<span>~</span>").addClass("dews-periodpicker-span");

    if ($el.attr("id") !== undefined) {
      $endInput.attr("id", $el.attr("id") + "_endinput");
    }

    if ($el.hasClass("readonly")) {
      $endInput.addClass("dews-state-readonly");
      $endInput.attr("readonly", "readonly");
    }
    if ($el.hasClass("disabled")) {
      $endInput.addClass("dews-state-disabled");
      $endInput.attr("disabled", "disabled");
    }
    if ($el.hasClass("required")) {
      $endInput.addClass("dews-state-required");
    }
    if ($el.hasClass("etc1")) {
      $endInput.addClass("dews-state-etc1");
    }
    if ($el.hasClass("etc2")) {
      $endInput.addClass("dews-state-etc2");
    }
    if ($el.hasClass("etc3")) {
      $endInput.addClass("dews-state-etc3");
    }

    setMask($endInput, self.options.format);
    setEvent($endInput, self.options);

    self.endInput = $endInput;
    self.wrapper.append($span);
    self.wrapper.append($endInput);
  };

  PeriodPicker.prototype.setPeriod = function (first, last) {
    var self = this;
    var calendar = self.startCalendar;
    var calendar2 = self.endCalendar;

    var firstday = first;
    var lastday = last;

    var startDate = kendo.parseDate(firstday, dews._environments.formats.dateValueFormat, kendo.getCulture());
    var endDate = kendo.parseDate(lastday, dews._environments.formats.dateValueFormat, kendo.getCulture());

    var textStartDate = kendo.toString(startDate, self.options.format, kendo.getCulture());
    var textEndDate = kendo.toString(endDate, self.options.format, kendo.getCulture());

    if (textStartDate > textEndDate) {
      self.startInput.attr("val", "");
      self.startInput.val("");
      self.endInput.attr("val", "");
      self.endInput.val("");
    } else {
      calendar.value(startDate);
      calendar2.value(endDate);

      self.startInput.attr("val", textStartDate);
      self.startInput.val(textStartDate);
      self.endInput.attr("val", textEndDate);
      self.endInput.val(textEndDate);

      self.periodDate.text(textStartDate + "~" + textEndDate);
    }
  };

  PeriodPicker.prototype.setWeek = function () {
    var self = this;

    var weeks = new Date();
    var firstday = new Date(weeks.setDate(weeks.getDate() - weeks.getDay()));
    var lastday = new Date(weeks.setDate(weeks.getDate() - weeks.getDay() + 6));

    self.setPeriod(firstday, lastday);
  };

  PeriodPicker.prototype.setMonth = function () {
    var self = this;

    var today = new Date();
    var firstday = new Date(today.getFullYear(), today.getMonth(), 1);
    var lastday = new Date(today.getFullYear(), today.getMonth() + 1, 0);

    self.setPeriod(firstday, lastday);
  };

  PeriodPicker.prototype.setupToday = function () {
    var self = this;

    var today = new Date();
    var firstday = new Date(today.getFullYear(), today.getMonth(), 1);
    var lastday = new Date(Date.UTC(today.getFullYear(), today.getMonth(), today.getDate()));

    self.setPeriod(firstday, lastday);
  };

  PeriodPicker.prototype.setEarlyYears = function () {
    var self = this;

    var today = new Date();
    var firstday = new Date(today.getFullYear(), 0, 1);
    var lastday = new Date(Date.UTC(today.getFullYear(), today.getMonth(), today.getDate()));

    self.setPeriod(firstday, lastday);
  };

  PeriodPicker.prototype.setStartDate = function (value) {
    var self = this;
    if (!isNaN(value)) {
      var calendar = self.startCalendar,
        calendar2 = self.endCalendar,
        date,
        textDate;

      if ($.type(value) === "date") {
        date = value;
      } else if (value) {
        date = kendo.parseDate(
        value.toString(),
        dews._environments.formats.dateValueFormat,
        kendo.getCulture());

      }
      textDate = kendo.toString(date, self.options.format, kendo.getCulture());

      if (self.endInput.val() && date > calendar2.value() || !date) {
        self.endInput.attr("val", "");
        self.endInput.val("");
      }

      calendar.value(date);
      self.startInput.attr("val", textDate);
      self.startInput.val(textDate);

      if (self.endInput.val()) {
        self.periodDate.text(textDate + "~" + self.endInput.val());
      }

      self.okButton.prop("disabled", false);
      self.okButton.removeClass("k-state-disabled");
    } else {
      self.startInput.attr("val", "");
      self.startInput.val("");
    }
  };

  PeriodPicker.prototype.setEndDate = function (value) {
    var self = this;
    if (!isNaN(value)) {
      var calendar = self.startCalendar,
        calendar2 = self.endCalendar,
        date,
        textDate;

      if ($.type(value) === "date") {
        date = value;
      } else if (value) {
        date = kendo.parseDate(
        value.toString(),
        dews._environments.formats.dateValueFormat,
        kendo.getCulture());

      }
      textDate = kendo.toString(date, self.options.format, kendo.getCulture());

      if (self.startInput.val() && calendar.value() > date || !date) {
        self.endInput.attr("val", "");
        self.endInput.val("");
      } else {
        calendar2.value(date);
        self.endInput.attr("val", textDate);
        self.endInput.val(textDate);

        if (self.startInput.val()) {
          self.periodDate.text(self.startInput.val() + "~" + textDate);
        }

        self.okButton.prop("disabled", false);
        self.okButton.removeClass("k-state-disabled");
      }
    } else {
      self.endInput.attr("val", "");
      self.endInput.val("");
    }
  };

  PeriodPicker.prototype.getStartDate = function () {
    var self = this;

    if (self.startInput.val()) {
      var date = kendo.parseDate(self.startInput.val(), self.options.format, kendo.getCulture());
      return kendo.toString(date, dews._environments.formats.dateValueFormat) || "";
    } else {
      return "";
    }
  };

  PeriodPicker.prototype.getStartText = function () {
    var self = this;

    if (self.startInput.val()) {
      var date = kendo.parseDate(self.startInput.val(), self.options.format, kendo.getCulture());
      return kendo.toString(date, dews._environments.formats.dateFormat) || "";
    } else {
      return "";
    }
  };

  PeriodPicker.prototype.getEndDate = function () {
    var self = this;

    if (self.endInput.val()) {
      var date = kendo.parseDate(self.endInput.val(), self.options.format, kendo.getCulture());
      return kendo.toString(date, dews._environments.formats.dateValueFormat) || "";
    } else {
      return "";
    }
  };

  PeriodPicker.prototype.getEndText = function () {
    var self = this;

    if (self.endInput.val()) {
      var date = kendo.parseDate(self.endInput.val(), self.options.format, kendo.getCulture());
      return kendo.toString(date, dews._environments.formats.dateFormat) || "";
    } else {
      return "";
    }
  };

  PeriodPicker.prototype._createButton = function () {
    var self = this,
      $button,
      $img;

    $button = $("<span/>").addClass("k-select");
    $img = $("<span/>").addClass("k-icon k-i-calendar");

    self.wrapper.append($button);
    $button.append($img);
    self.button = $button;
  };

  PeriodPicker.prototype._createCalendars = function () {
    var self = this,
      $el = $(self._element),
      $calendars;

    $calendars = $("<div/>").addClass("dews-periodpicker-calendars");

    $calendars.attr("aria-hidden", true).css("display", "none").css("overflow", "hidden");

    if ($el.attr("id") !== undefined) {
      $calendars.attr("id", $el.attr("id") + "_calendars");
    }

    $(document.body).append($calendars);
    self.calendars = $calendars;
  };

  PeriodPicker.prototype._createOptions = function () {
    var self = this,
      $el = $(self._element),
      $option;

    $option = $("<div/>").addClass("dews-periodpicker-option");

    if (self.options.buttons === false) {
      $option.css({ display: "none" });
    } else {
      $option.css({ display: "inline-block" });
    }

    self.calendars.empty().append($option);
    self.option = $option;
  };

  PeriodPicker.prototype._createOptionButtons = function () {
    var self = this,
      $todayButton,
      $yesterdayButton,
      $weekButton,
      $lastWeekButton,
      $monthButton,
      $lastMonthButton,
      $upToNowButton,
      $thisYearButton,
      $lastYearButton,
      $yearBeforeLastButton,
      $firstQuarterButton,
      $secondQuarterButton,
      $thirdQuarterButton,
      $fourthQuarterButton,
      $firstHalfButton,
      $secondHalfButton,
      $januaryButton,
      $februaryButton,
      $marchButton,
      $aprilButton,
      $mayButton,
      $juneButton,
      $julyButton,
      $augustButton,
      $septemberButton,
      $octoberButton,
      $novemberButton,
      $decemberButton;

    $todayButton = $("<button type='button'>" + dews.localize.get("오늘", "dews_오늘") + "</button>").addClass(
    "dews-period-button dews-period-day dews-period-today");

    $yesterdayButton = $("<button type='button'>" + dews.localize.get("어제", "dews_어제") + "</button>").addClass(
    "dews-period-button dews-period-day dews-period-yesterday");

    $weekButton = $("<button type='button'>" + dews.localize.get("주간", "dews_주간") + "</button>").addClass(
    "dews-period-button dews-period-weeks dews-period-week");

    $lastWeekButton = $("<button type='button'>" + dews.localize.get("전주", "dews_전주") + "</button>").addClass(
    "dews-period-button dews-period-weeks dews-period-lastweek");

    $monthButton = $("<button type='button'>" + dews.localize.get("당월", "dews_당월") + "</button>").addClass(
    "dews-period-button dews-period-month dews-period-thismonth");

    $lastMonthButton = $("<button type='button'>" + dews.localize.get("전월", "dews_전월") + "</button>").addClass(
    "dews-period-button dews-period-month dews-period-lastmonth");

    $upToNowButton = $(
    "<button type='button'>" + dews.localize.get("오늘까지", "dews_오늘까지") + "</button>").
    addClass("dews-period-button dews-period-uptonow");
    $thisYearButton = $("<button type='button'>" + dews.localize.get("올해", "dews_올해") + "</button>").addClass(
    "dews-period-button dews-period-this-year");

    $lastYearButton = $(
    "<button type='button'>" + dews.localize.get("전년도", "dews_전년도") + "</button>").
    addClass("dews-period-button dews-period-last-year");
    $yearBeforeLastButton = $(
    "<button type='button'>" + dews.localize.get("전전년도", "dews_전전년도") + "</button>").
    addClass("dews-period-button dews-period-year-before-last");
    $firstQuarterButton = $(
    "<button type='button'>" + dews.localize.get("1분기", "dews_1/4분기") + "</button>").
    addClass("dews-period-button dews-period-quarter dews-period-first-quarter");
    $secondQuarterButton = $(
    "<button type='button'>" + dews.localize.get("2분기", "dews_2/4분기") + "</button>").
    addClass("dews-period-button dews-period-quarter dews-period-second-quarter");
    $thirdQuarterButton = $(
    "<button type='button'>" + dews.localize.get("3분기", "dews_3/4분기") + "</button>").
    addClass("dews-period-button dews-period-quarter dews-period-third-quarter");
    $fourthQuarterButton = $(
    "<button type='button'>" + dews.localize.get("4분기", "dews_4/4분기") + "</button>").
    addClass("dews-period-button dews-period-quarter dews-period-fourth-quarter");
    $firstHalfButton = $(
    "<button type='button'>" + dews.localize.get("상반기", "dews_상반기") + "</button>").
    addClass("dews-period-button dews-period-half dews-period-onehalf");
    $secondHalfButton = $(
    "<button type='button'>" + dews.localize.get("하반기", "dews_하반기") + "</button>").
    addClass("dews-period-button dews-period-half dews-period-twohalf");
    $januaryButton = $("<button type='button'>" + dews.localize.get("1월", "dews_1월") + "</button>").addClass(
    "dews-period-button dews-period-months dews-period-january");

    $februaryButton = $("<button type='button'>" + dews.localize.get("2월", "dews_2월") + "</button>").addClass(
    "dews-period-button dews-period-months dews-period-february");

    $marchButton = $("<button type='button'>" + dews.localize.get("3월", "dews_3월") + "</button>").addClass(
    "dews-period-button dews-period-months dews-period-march");

    $aprilButton = $("<button type='button'>" + dews.localize.get("4월", "dews_4월") + "</button>").addClass(
    "dews-period-button dews-period-months dews-period-april");

    $mayButton = $("<button type='button'>" + dews.localize.get("5월", "dews_5월") + "</button>").addClass(
    "dews-period-button dews-period-months dews-period-may");

    $juneButton = $("<button type='button'>" + dews.localize.get("6월", "dews_6월") + "</button>").addClass(
    "dews-period-button dews-period-months dews-period-june");

    $julyButton = $("<button type='button'>" + dews.localize.get("7월", "dews_7월") + "</button>").addClass(
    "dews-period-button dews-period-months dews-period-july");

    $augustButton = $("<button type='button'>" + dews.localize.get("8월", "dews_8월") + "</button>").addClass(
    "dews-period-button dews-period-months dews-period-august");

    $septemberButton = $("<button type='button'>" + dews.localize.get("9월", "dews_9월") + "</button>").addClass(
    "dews-period-button dews-period-months dews-period-september");

    $octoberButton = $("<button type='button'>" + dews.localize.get("10월", "dews_10월") + "</button>").addClass(
    "dews-period-button dews-period-months dews-period-october");

    $novemberButton = $("<button type='button'>" + dews.localize.get("11월", "dews_11월") + "</button>").addClass(
    "dews-period-button dews-period-months dews-period-november");

    $decemberButton = $("<button type='button'>" + dews.localize.get("12월", "dews_12월") + "</button>").addClass(
    "dews-period-button dews-period-months dews-period-december");


    if (dews.localize.getLanguage() === "en") {
      $(".dews-period-button").css({
        "letter-spacing": "-1px",
        "font-weight": "200"
      });
    }

    self.option.append($todayButton);
    self.option.append($upToNowButton);
    self.option.append($yesterdayButton);
    self.option.append($weekButton);
    self.option.append($lastWeekButton);
    self.option.append($monthButton);
    self.option.append($lastMonthButton);
    self.option.append($thisYearButton);
    self.option.append($lastYearButton);
    self.option.append($yearBeforeLastButton);
    self.option.append($firstQuarterButton);
    self.option.append($secondQuarterButton);
    self.option.append($thirdQuarterButton);
    self.option.append($fourthQuarterButton);
    self.option.append($firstHalfButton);
    self.option.append($secondHalfButton);
    self.option.append($januaryButton);
    self.option.append($februaryButton);
    self.option.append($marchButton);
    self.option.append($aprilButton);
    self.option.append($mayButton);
    self.option.append($juneButton);
    self.option.append($julyButton);
    self.option.append($augustButton);
    self.option.append($septemberButton);
    self.option.append($octoberButton);
    self.option.append($novemberButton);
    self.option.append($decemberButton);

    self.todayButton = $todayButton;
    self.yesterdayButton = $yesterdayButton;
    self.weekButton = $weekButton;
    self.lastWeekButton = $lastWeekButton;
    self.monthButton = $monthButton;
    self.lastMonthButton = $lastMonthButton;
    self.upToNowButton = $upToNowButton;
    self.thisYearButton = $thisYearButton;
    self.lastYearButton = $lastYearButton;
    self.yearBeforeLastButton = $yearBeforeLastButton;
    self.firstQuarterButton = $firstQuarterButton;
    self.secondQuarterButton = $secondQuarterButton;
    self.thirdQuarterButton = $thirdQuarterButton;
    self.fourthQuarterButton = $fourthQuarterButton;
    self.firstHalfButton = $firstHalfButton;
    self.secondHalfButton = $secondHalfButton;
  };

  PeriodPicker.prototype._createPeriodCalendar = function () {
    var self = this,
      $periodcalendars;

    $periodcalendars = $("<span/>").addClass("dews-periodpicker-periodcalendars");

    self.calendars.append($periodcalendars);
    self.periodcalendars = $periodcalendars;
  };

  PeriodPicker.prototype._createStartCalendar = function () {
    var self = this,
      $startCalendar;

    $startCalendar = $("<div/>").addClass("dews-periodpicker-calendar");

    $startCalendar.kendoCalendar({
      animation: false,
      footer: false,
      max: new Date("9999-12-31"),
      min: new Date("1000-01-01"),
      format: dews._environments.formats.dateValueFormat
    });

    self.periodcalendars.append($startCalendar);
    self.startCalendar = $startCalendar.data("kendoCalendar");
  };

  PeriodPicker.prototype._createEndCalendar = function () {
    var self = this,
      $endCalendar;

    $endCalendar = $("<div/>").addClass("dews-periodpicker-calendar");

    $endCalendar.kendoCalendar({
      animation: false,
      footer: false,
      max: new Date("9999-12-31"),
      min: new Date("1000-01-01"),
      format: dews._environments.formats.dateValueFormat
    });

    self.periodcalendars.append($endCalendar);
    self.endCalendar = $endCalendar.data("kendoCalendar");
  };

  PeriodPicker.prototype._createButtons = function () {
    var self = this,
      $buttons;

    $buttons = $("<div/>").addClass("dews-periodpicker-buttons");

    self.calendars.append($buttons);
    self.buttons = $buttons;
  };

  PeriodPicker.prototype._createPeriodDate = function () {
    var self = this,
      $periodDate,
      $periodSelect;

    $periodSelect = $("<p>" + dews.localize.get("선택한 기간", "dews_선택한 기간") + ":</p>").addClass(
    "dews-periodpicker-periodSelect");

    $periodDate = $("<strong/>").addClass("dews-periodpicker-periodDate");

    self.buttons.append($periodSelect);
    $periodSelect.append($periodDate);

    self.periodDate = $periodDate;
  };

  PeriodPicker.prototype._createOkButton = function () {
    var self = this,
      $okButton;

    $okButton = $("<button type='button'>" + dews.localize.get("적용하기", "dews_적용하기") + "</button>").addClass(
    "dews-ui-button primary dews-periodpicker-ok k-button small");


    self.buttons.append($okButton);
    self.okButton = $okButton;
  };

  /**
   * 기간피커의 활성화 여부를 설정하거나 가져옵니다.
   * @param {boolean} [value] 설정할 활성화 여부(생략하면 현재 활성화 여부를 반환합니다.)
   * @returns {boolean} 활성화 여부
   */
  PeriodPicker.prototype.enable = function (value) {
    var self = this,
      $el = $(self._element),
      enabled;

    enabled = !$el.hasClass("disabled");

    if (typeof value !== "undefined") {
      if (value === true) {
        $el.removeClass("disabled");
        self.wrapper.removeClass("dews-state-disabled");
        self.startInput.removeAttr("disabled", "disabled");
        self.endInput.removeAttr("disabled", "disabled");
        self.startInput.removeClass("dews-state-disabled");
        self.endInput.removeClass("dews-state-disabled");
      } else if (value === false) {
        $el.addClass("disabled");
        self.wrapper.addClass("dews-state-disabled");
        self.startInput.attr("disabled", "disabled");
        self.endInput.attr("disabled", "disabled");
        self.startInput.addClass("dews-state-disabled");
        self.endInput.addClass("dews-state-disabled");
      }
    } else {
      return enabled;
    }
  };

  /**
   * 기간피커의 visible 여부를 가져옵니다.
   * @returns {boolean}
   * @private
   */
  PeriodPicker.prototype._visibleCheckFromPanel = function () {
    var self = this,
      $ctrl = $(self._element),
      isVisible = $ctrl.closest(".dews-periodpicker-container").css("display") !== "none";

    return isVisible;
  };

  PeriodPicker.prototype.required = function (value) {
    var self = this;
    var $el = $(self._element);
    var $wrapper = self.wrapper;
    var $startInput = self.startInput;
    var $endInput = self.endInput;

    if ($.type(value) === "undefined") {
      return $el.hasClass("required");
    } else if (value === true) {
      $el.addClass("required");
      $wrapper.addClass("dews-state-required");
      $startInput.addClass("dews-state-required");
      $endInput.addClass("dews-state-required");
    } else if (value === false) {
      $el.removeClass("required");
      $wrapper.removeClass("dews-state-required");
      $startInput.removeClass("dews-state-required");
      $endInput.removeClass("dews-state-required");
    }
  };

  PeriodPicker.prototype.readonly = function (value) {
    var self = this,
      $el = $(self._element),
      readonly;

    readonly = $el.hasClass("readonly");

    if (typeof value !== "undefined") {
      if (value === false) {
        $el.removeClass("readonly");
        self.wrapper.removeClass("dews-state-readonly");
        self.startInput.removeAttr("readonly", "readonly");
        self.endInput.removeAttr("readonly", "readonly");
        self.startInput.removeClass("dews-state-readonly");
        self.endInput.removeClass("dews-state-readonly");
        self.disableButton = false;
        readonly = !value;
      } else if (value === true) {
        $el.addClass("readonly");
        self.wrapper.addClass("dews-state-readonly");
        self.startInput.attr("readonly", "readonly");
        self.endInput.attr("readonly", "readonly");
        self.startInput.addClass("dews-state-readonly");
        self.endInput.addClass("dews-state-readonly");
        self.disableButton = true;
        readonly = !value;
      }
    }

    return readonly;
  };

  PeriodPicker.prototype.focus = function (options) {
    var self = this;

    if (options === "start") {
      self.startInput.focus();
    } else if (options === "end") {
      self.endInput.focus();
    } else if (options === undefined) {
      self.startInput.focus();
    }
  };

  PeriodPicker.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "change") {
          $(self._element).trigger("_change");
        } else {
          $(self._element).trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  PeriodPicker.prototype.on = function () {
    var self = this;

    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    }
    $(self._element).on.apply($(self._element), arguments);
  };

  PeriodPicker.prototype.off = function () {
    var self = this;

    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    }
    self.container.off.apply(self.container, arguments);
  };

  PeriodPicker.prototype._bindEvents = function () {
    var self = this,
      $el = $(self._element);

    var toggle = true;

    var today = new Date(),
      now = new Date(Date.UTC(today.getFullYear(), today.getMonth(), today.getDate()));
    var $position = 0;

    if ($el.hasClass("readonly")) {
      self.disableButton = true;
    }

    self.startInput.on("focus", function (e) {
      self.wrapper.addClass("dews-periodpicker-focus");
      self.button.addClass("dews-periodpicker-focus");
      e.stopPropagation();
    });

    self.endInput.on("focus", function (e) {
      self.wrapper.addClass("dews-periodpicker-focus");
      self.button.addClass("dews-periodpicker-focus");
      e.stopPropagation();
    });

    self.startInput.on("blur", function (e) {
      self.wrapper.removeClass("dews-periodpicker-focus");
      self.button.removeClass("dews-periodpicker-focus");
      e.stopPropagation();
    });

    self.endInput.on("blur", function (e) {
      self.wrapper.removeClass("dews-periodpicker-focus");
      self.button.removeClass("dews-periodpicker-focus");
      e.stopPropagation();
    });

    function selectedPeriod() {
      if (startCalendar.value() && endCalendar.value() && startCalendar.value() <= endCalendar.value()) {
        var startDays = kendo.toString(startCalendar.value(), self.options.format, kendo.getCulture());
        var endDays = kendo.toString(endCalendar.value(), self.options.format, kendo.getCulture());

        self.periodDate.text(startDays + "~" + endDays);
        self.okButton.prop("disabled", false);
        self.okButton.removeClass("k-state-disabled");
      } else if (startCalendar.value() && endCalendar.value() && startCalendar.value() >= endCalendar.value()) {
        self.periodDate.text("");
        self.okButton.prop("disabled", true);
        self.okButton.addClass("k-state-disabled");
      } else if (startCalendar.value() || endCalendar.value()) {
        self.periodDate.text("");
        self.okButton.prop("disabled", false);
        self.okButton.removeClass("k-state-disabled");
      } else {
        self.periodDate.text("");
        self.okButton.prop("disabled", true);
        self.okButton.addClass("k-state-disabled");
      }
    }

    var popoverClose = function popoverClose(e) {
      if (
      e.type === "scroll" && !$(e.target).parents(".dews-periodpicker-calendars")[0] ||
      e.type === "keyup" && e.keyCode === 27)
      {
        close();
        clear();
        $(e.target).focus();
        if (self.startInput.val() === "") {
          startCalendar.value("");
          self.periodDate.text("");
        } else if (self.endInput.val() === "") {
          endCalendar.value("");
          self.periodDate.text("");
        }
      }
    };

    self.okButton.on("click", function (e) {
      var startDay, endDay, preStartDay, preEndDay;

      self.okButton.prop("disabled", false);
      self.okButton.removeClass("k-state-disabled");

      if (startCalendar.value() && endCalendar.value() && startCalendar.value() > endCalendar.value()) {
        self.okButton.prop("disabled", true);
        self.okButton.addClass("k-state-disabled");
      }

      close();

      if (startCalendar.value()) {
        preStartDay = self.startInput.val();
        startDay = kendo.toString(startCalendar.value(), self.options.format, kendo.getCulture());
        self.startInput.attr("val", startDay);
        self.startInput.val(startDay);
      }
      if (endCalendar.value()) {
        preEndDay = self.endInput.val();
        endDay = kendo.toString(endCalendar.value(), self.options.format, kendo.getCulture());
        self.endInput.attr("val", endDay);
        self.endInput.val(endDay);
      }

      if (self.firstClickItem !== null && self.secondClickItem === null) {
        self.secondClickItem = self.firstClickItem;
      }

      if (startDay !== preStartDay || endDay !== preEndDay) {
        $(self._element).trigger("_change");
      }

      e.stopPropagation();
    });

    self.button.on("click", function (e) {
      if (!self.disableButton) {
        self.startCalendar.navigate(startCalendar.value(), "month");
        self.endCalendar.navigate(endCalendar.value(), "month");

        self.okButton.prop("disabled", false);
        self.okButton.removeClass("k-state-disabled");

        if (toggle) {
          bindCloseEvent();

          var c_position = $el.offset();
          var zIndex = dews.ui.getDialogMaxZIndex();

          if (zIndex > parseInt(self.calendars.css("zIndex"), 10)) {
            self.calendars.css("zIndex", zIndex + 2);
          }

          self.calendars.css({
            left: parseFloat(c_position.left) + "px"
          });

          self.calendars.removeClass("up down");
          if ($(window).height() < $(this).offset().top - $position + self.calendars.height() + 24) {
            self.calendars.addClass("up");
            self.calendars.css("top", parseFloat(c_position.top) - self.calendars.height() - 1);
            if ($(this).offset().top - $position < self.calendars.height()) {
              self.calendars.css("top", parseFloat(c_position.top) + 23);
            }
          } else {
            self.calendars.addClass("down");
            self.calendars.css("top", parseFloat(c_position.top) + self.wrapper.height() + 1);
          }
          if ($(window).width() - (self.wrapper.offset().left + self.calendars.width()) < 0) {
            var right_width = self.button.offset().left + 22.7969 - self.calendars.width();
            self.calendars.css("left", right_width);
            if ($(window).width() < self.calendars.width()) {
              self.calendars.css("left", parseFloat(c_position.left) + 1);
            }
          }
          self.container.addClass("dews-state-active");
          self.wrapper.addClass("dews-periodpicker-focus");
          self.button.addClass("dews-periodpicker-focus");
          self.calendars.attr("aria-hidden", false).css("display", "block").css("overflow", "visible");
          toggle = false;

          if (self.startInput.val() === "") {
            startCalendar.value("");
            self.periodDate.text("");
          } else if (self.endInput.val() === "") {
            endCalendar.value("");
            self.periodDate.text("");
          }

          clear();
        } else {
          close();
          clear();
          if (self.startInput.val() === "") {
            startCalendar.value("");
            self.periodDate.text("");
          } else if (self.endInput.val() === "") {
            endCalendar.value("");
            self.periodDate.text("");
          }
        }
      }
      e.stopPropagation();
    });

    $(window).scroll(function () {
      $position = $(this).scrollTop();
    });

    $(window).resize(function () {
      var c_position = $el.offset();
      self.calendars.css({
        left: parseFloat(c_position.left) + "px",
        top: parseFloat(c_position.top) + 23 + "px"
      });

      if ($(window).height() < $("span.k-select", $el).offset().top - $position + self.calendars.height() + 24) {
        self.calendars.css("top", parseFloat(c_position.top) - self.calendars.height() - 2);
        if ($("span.k-select", $el).offset().top - $position < self.calendars.height()) {
          self.calendars.css("top", parseFloat(c_position.top) + 23);
        }
      } else {
        self.calendars.css("top", parseFloat(c_position.top) + 24);
      }
      if ($(window).width() - (self.wrapper.offset().left + self.calendars.width()) < 0) {
        var right_width = self.button.offset().left + 22.7969 - self.calendars.width();
        self.calendars.css("left", right_width);
        if ($(window).width() < self.calendars.width()) {
          self.calendars.css("left", parseFloat(c_position.left) + 1);
        }
      }
    });

    function bindCloseEvent() {
      window.addEventListener("scroll", popoverClose, true);
      window.addEventListener("keyup", popoverClose, true);

      // 버튼, 달력창 영역을 제외한 나머지 부분 클릭시 달력창 닫기
      $(window).on("click", function (e) {
        if (
        !$(e.target).parents(".dews-periodpicker-calendars")[0] &&
        !$(e.target).parents("table.k-content")[0] &&
        $(e.target).closest(".dews-ui-msgbox").length === 0)
        {
          close();
          var startSet = self.startInput.val(),
            endSet = self.endInput.val();

          if (startSet && endSet) {
            formats(startSet, endSet);
          }
          if (startSet === "") {
            startCalendar.value("");
            self.periodDate.text("");
          }
          if (endSet === "") {
            endCalendar.value("");
            self.periodDate.text("");
          }
        }
        e.stopPropagation();
      });
    }

    // 달력에 시작날짜와 종료날짜를 셋팅해준다
    function formats(startSet, endSet) {
      var firstday, lastday;

      if ($.type(startSet) === "date" || $.type(endSet) === "date") {
        firstday = startSet;
        lastday = endSet;
      } else {
        firstday = kendo.parseDate(startSet, dews._environments.formats.dateFormat, kendo.getCulture());
        lastday = kendo.parseDate(endSet, dews._environments.formats.dateFormat, kendo.getCulture());
      }

      self.startCalendar.navigate(firstday, "month");
      self.endCalendar.navigate(lastday, "month");
      startCalendar.value(firstday);
      endCalendar.value(lastday);
      selectedPeriod();
    }

    function close() {
      self.container.removeClass("dews-state-active");
      self.wrapper.removeClass("dews-periodpicker-focus");
      self.button.removeClass("dews-periodpicker-focus");
      self.calendars.attr("aria-hidden", true).css({ display: "none", overflow: "hidden", zIndex: "" });
      toggle = true;
      window.removeEventListener("scroll", popoverClose, true);
      window.removeEventListener("keyup", popoverClose, true);
      $(window).off("click");
    }

    var startCalendar = self.startCalendar;
    startCalendar.bind("change", selectedPeriod);

    var endCalendar = self.endCalendar;
    endCalendar.bind("change", selectedPeriod);

    if (self.options.startDate !== null) {
      self.setStartDate(self.options.startDate);
    }

    if (self.options.endDate !== null) {
      self.setEndDate(self.options.endDate);
    }

    // periodpicker 길이가 길어질 경우 endInput 이후 영역 클릭스 포커스 설정
    self.wrapper.on("click", function (e) {
      var top = parseInt(self.endInput.offset().top - 5);
      var left = parseInt(self.endInput.offset().left) + self.endInput.width();
      var right = parseInt($(".k-select", $el).offset().left);
      var bottom = top + 24;
      if (left <= e.pageX && e.pageX <= right && top <= e.pageY && e.pageY <= bottom) {
        self.focus();
      }
      e.stopPropagation();
    });

    self.startInput.on("keyup", function (e) {
      var key = e.key,
        regex = /[0-9]/; // 입력된 키 값이 숫자인지 매칭
      var preStartDate, currStartDate;
      var startInput = self.startInput;

      // 숫자 혹은 backspace, delete, ctrl+v 인지 확인
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && startInput.is(":enabled")) {
        e.returnValue = false;
        e.preventDefault();
      } else if (
      !regex.test(key) &&
      e.keyCode !== 8 &&
      e.keyCode !== 46 &&
      e.ctrlKey === false &&
      e.keyCode !== 91 &&
      e.ctrlKey === true &&
      e.keyCode !== 86 &&
      e.ctrlKey === false &&
      e.keyCode !== 17)
      {
        e.returnValue = false;
        e.preventDefault();
      } else {
        preStartDate = $(".dews-periodpicker-startDate", self.wrapper).attr("val");
        currStartDate = self.startInput.val();

        // 모든 값이 입력 되면 값 설정
        if (self.startInput.val() && self.startInput.val().indexOf("_") === -1) {
          format(self.startInput);
          if (!self.endInput.val()) {
            endCalendar.value("");
            self.periodDate.text("");
          }

          $(".dews-periodpicker-startDate", self.wrapper).attr(
          "val",
          $(".dews-periodpicker-startDate", self.wrapper).val());


          if (preStartDate !== currStartDate) {
            self.startInput.trigger("_change");
          }
          if (regex.test(key)) {
            self.endInput.focus();
          }
        }

        if (self.startInput.val().indexOf("_") === 0) {
          currStartDate = "";
          if (preStartDate === undefined) {
            preStartDate = "";
          }
          if (preStartDate !== currStartDate) {
            self.startInput.trigger("_change");
          }
        }
      }

      // backspace, delete 키를 눌렀을 경우 input에 값이 없을때
      if (e.keyCode === 8 || e.keyCode === 46) {
        if (self.startInput.val().indexOf("_") === 0) {
          $(".dews-periodpicker-startDate", self.wrapper).attr("val", "");
          startCalendar.value("");
          self.periodDate.text("");
          endCalendar.min(new Date("1000-01-01"));
        }
      }
      e.stopPropagation();
    });

    self.endInput.on("keyup", function (e) {
      var key = e.key,
        regex = /[0-9]/; // 입력된 키 값이 숫자인지 매칭
      var preEndDate, currEndDate;
      var endInput = self.endInput;

      // 숫자 혹은 backspace, delete, ctrl+v 인지 확인
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && endInput.is(":enabled")) {
        e.returnValue = false;
        e.preventDefault();
      } else if (
      !regex.test(key) &&
      e.keyCode !== 8 &&
      e.keyCode !== 46 &&
      e.ctrlKey === false &&
      e.keyCode !== 91 &&
      e.ctrlKey === true &&
      e.keyCode !== 86 &&
      e.ctrlKey === false &&
      e.keyCode !== 17)
      {
        e.returnValue = false;
        e.preventDefault();
      } else {
        preEndDate = $(".dews-periodpicker-endDate", self.wrapper).attr("val");
        currEndDate = self.endInput.val();

        // 모든 값이 입력 되면 값 설정
        if (self.endInput.val() && self.endInput.val().indexOf("_") === -1) {
          format(self.endInput);
          if (!self.startInput.val()) {
            startCalendar.value("");
            self.periodDate.text("");
          }
          $(".dews-periodpicker-endDate", self.wrapper).attr(
          "val",
          $(".dews-periodpicker-endDate", self.wrapper).val());


          if (preEndDate !== currEndDate) {
            self.endInput.trigger("_change");
          }
        }

        if (self.endInput.val().indexOf("_") === 0) {
          currEndDate = "";
          if (preEndDate === undefined) {
            preEndDate = "";
          }
          if (preEndDate !== currEndDate) {
            self.endInput.trigger("_change");
          }
        }
      }

      // backspace, delete 키를 눌렀을 경우 input에 값이 없을때
      if (e.keyCode === 8 || e.keyCode === 46) {
        if (self.endInput.val().indexOf("_") === 0) {
          $(".dews-periodpicker-endDate", self.wrapper).attr("val", "");
          endCalendar.value("");
          self.periodDate.text("");
          startCalendar.max(new Date("9999-12-31"));
          self.startInput.focus();
        }
      }
      e.stopPropagation();
    });

    // 시작일이나 종료일을 입력 중인 경우 이벤트 버블링을 막음
    $el.on("keydown", function (e) {
      if (e.keyCode === 13) {
        if (self.startInput.is(":focus") || self.endInput.is(":focus")) {
          e.stopPropagation();
        }
        if (
        self.calendars.css("display") === "block" &&
        self.getStartDate() === "" &&
        self.getEndDate() === "")
        {
          self.setStartDate(new Date());
          self.setEndDate(new Date());
          self.okButton.click();
        }
      } else if (e.keyCode === 115 && self.calendars.css("display") === "none") {
        self.button.click();
        e.stopPropagation();
        e.preventDefault();
      }
    });

    function format(option) {
      var dateValue = $(option).val(),
        date,
        day,
        newDate = kendo.parseDate(dateValue, self.options.format, kendo.getCulture()),
        yyyy,
        MM,
        dd;

      if (newDate) {
        yyyy = newDate.getFullYear();
        MM = newDate.getMonth() + 1;
        dd = newDate.getDate();
      }

      if (parseInt(yyyy) > 9999 || parseInt(yyyy) <= 999) {
        yyyy = now.toISOString().substring(0, 4);
      }

      if (parseInt(MM) >= 13 || parseInt(MM) <= 0) {
        MM = now.toISOString().substring(5, 7);
      }

      switch (MM) {
        case "01":
        case "03":
        case "05":
        case "07":
        case "08":
        case "10":
        case "12":
          if (dd > 31 || dd <= 0) {
            dd = now.toISOString().substring(8, 10);
          }
          break;
        case "02":
          if (yyyy % 4 === 0) {
            if (dd > 29 || dd <= 0) {
              dd = now.toISOString().substring(8, 10);
            }
          } else {
            if (dd > 28 || dd <= 0) {
              dd = now.toISOString().substring(8, 10);
            }
          }
          break;
        case "04":
        case "06":
        case "09":
        case "11":
          if (dd > 30 || dd <= 0) {
            dd = now.toISOString().substring(8, 10);
          }
          break;
        default:
          break;}


      if (yyyy && MM && dd) {
        date = new Date(yyyy, MM - 1, dd);
        day = kendo.toString(date, self.options.format, kendo.getCulture());
      }

      $(option).val(day);

      var startSet = self.startInput.val(),
        endSet = self.endInput.val();

      if (startSet) {
        var startDate = kendo.parseDate(startSet, self.options.format, kendo.getCulture());
        var getStartTime = startDate.getTime();
      }

      if (endSet) {
        var endDate = kendo.parseDate(endSet, self.options.format, kendo.getCulture());
        var getEndTime = endDate.getTime();
      }

      if (getStartTime > getEndTime) {
        if (!getEndTime) {
          startSet = kendo.toString(startDate, self.options.format, kendo.getCulture());
          endSet = "";
        } else {
          startSet = kendo.toString(startDate, self.options.format, kendo.getCulture());
          endSet = kendo.toString(startDate, self.options.format, kendo.getCulture());
        }
      } else {
        if (!getStartTime) {
          startSet = kendo.toString(endDate, self.options.format, kendo.getCulture());
          endSet = "";
        } else {
          startSet = kendo.toString(startDate, self.options.format, kendo.getCulture());
          endSet = kendo.toString(endDate, self.options.format, kendo.getCulture());
        }
      }

      if (startSet !== "" && endSet !== "") {
        self.startInput.val(startSet);
        self.endInput.val(endSet);
      }

      if (!startSet) {
        self.startInput.val("");
      }

      if (!endSet) {
        self.endInput.val("").trigger("input");
      }

      if (option === self.startInput) {
        formats(startSet, endSet);
      } else {
        formats(startSet, endSet);
      }
    }

    // 달력창 내부의 기간 버튼을 클릭했을때 이벤트들
    self.todayButton.on("click", function (e) {
      clear();
      formats(now, now);
      e.stopPropagation();
    });

    self.yesterdayButton.on("click", function (e) {
      clear();
      var yester = new Date(Date.UTC(today.getFullYear(), today.getMonth(), today.getDate() - 1));
      formats(yester, yester);
      e.stopPropagation();
    });

    self.weekButton.on("click", function (e) {
      clear();
      var weeks = new Date();
      var firstday = new Date(weeks.setDate(weeks.getDate() - weeks.getDay()));
      var lastday = new Date(weeks.setDate(weeks.getDate() - weeks.getDay() + 6));
      formats(firstday, lastday);
      e.stopPropagation();
    });

    self.lastWeekButton.on("click", function (e) {
      clear();
      var lastweeks = new Date();
      var previousweek = new Date(lastweeks.getTime() - 7 * 24 * 60 * 60 * 1000);
      var firstday = new Date(previousweek.setDate(previousweek.getDate() - previousweek.getDay()));
      var lastday = new Date(previousweek.setDate(previousweek.getDate() - previousweek.getDay() + 6));
      formats(firstday, lastday);
      e.stopPropagation();
    });

    self.monthButton.on("click", function (e) {
      clear();
      var firstday = new Date(today.getFullYear(), today.getMonth(), 1);
      var lastday = new Date(today.getFullYear(), today.getMonth() + 1, 0);
      formats(firstday, lastday);
      e.stopPropagation();
    });

    self.lastMonthButton.on("click", function (e) {
      clear();
      var firstday = new Date(today.getFullYear(), today.getMonth() - 1, 1);
      var lastday = new Date(today.getFullYear(), today.getMonth(), 0);
      formats(firstday, lastday);
      e.stopPropagation();
    });

    self.upToNowButton.on("click", function (e) {
      clear();
      var firstday = new Date(today.getFullYear(), 0, 1);
      formats(firstday, now);
      e.stopPropagation();
    });

    self.thisYearButton.on("click", function (e) {
      clear();
      var JanFirst = new Date(today.getFullYear(), 0, 1);
      var Dec31th = new Date(today.getFullYear(), 11, 31);
      formats(JanFirst, Dec31th);
      e.stopPropagation();
    });

    self.lastYearButton.on("click", function (e) {
      clear();
      var JanFirst = new Date(today.getFullYear() - 1, 0, 1);
      var Dec31th = new Date(today.getFullYear() - 1, 11, 31);
      formats(JanFirst, Dec31th);
      e.stopPropagation();
    });

    self.yearBeforeLastButton.on("click", function (e) {
      clear();
      var JanFirst = new Date(today.getFullYear() - 2, 0, 1);
      var Dec31th = new Date(today.getFullYear() - 2, 11, 31);
      formats(JanFirst, Dec31th);
      e.stopPropagation();
    });

    self.firstQuarterButton.on("click", function (e) {
      clear();
      var firstday = new Date(today.getFullYear(), 0, 1);
      var lastday = new Date(today.getFullYear(), 3, 0);
      formats(firstday, lastday);
      e.stopPropagation();
    });

    self.secondQuarterButton.on("click", function (e) {
      clear();
      var firstday = new Date(today.getFullYear(), 3, 1);
      var lastday = new Date(today.getFullYear(), 6, 0);
      formats(firstday, lastday);
      e.stopPropagation();
    });

    self.thirdQuarterButton.on("click", function (e) {
      clear();
      var firstday = new Date(today.getFullYear(), 6, 1);
      var lastday = new Date(today.getFullYear(), 9, 0);
      formats(firstday, lastday);
      e.stopPropagation();
    });

    self.fourthQuarterButton.on("click", function (e) {
      clear();
      var firstday = new Date(today.getFullYear(), 9, 1);
      var lastday = new Date(today.getFullYear(), 12, 0);
      formats(firstday, lastday);
      e.stopPropagation();
    });

    self.firstHalfButton.on("click", function (e) {
      clear();
      var firstday = new Date(today.getFullYear(), 0, 1);
      var lastday = new Date(today.getFullYear(), 6, 0);
      formats(firstday, lastday);
      e.stopPropagation();
    });

    self.secondHalfButton.on("click", function (e) {
      clear();
      var firstday = new Date(today.getFullYear(), 6, 1);
      var lastday = new Date(today.getFullYear(), 12, 0);
      formats(firstday, lastday);
      e.stopPropagation();
    });

    $("." + self.option.attr("class") + " " + ".dews-period-months", self.calendars).on("click", function (e) {
      var months = [
      "dews-period-january",
      "dews-period-february",
      "dews-period-march",
      "dews-period-april",
      "dews-period-may",
      "dews-period-june",
      "dews-period-july",
      "dews-period-august",
      "dews-period-september",
      "dews-period-october",
      "dews-period-november",
      "dews-period-december"];

      var temp, firstday, lastday;
      if (self.firstClickItem !== null) {
        if (self.secondClickItem !== null) {
          clear();
        }
        self.secondClickItem = self.firstClickItem;
      }

      self.firstClickItem = $(this);

      if (self.firstClickItem !== null && self.secondClickItem !== null) {
        var idx1 = self.firstClickItem.index() - 16;
        var idx2 = self.secondClickItem.index() - 16;

        if (idx1 > idx2) {
          temp = idx1;
          idx1 = idx2;
          idx2 = temp;
        }

        for (var i = idx1; i <= idx2; i++) {
          if (
          $("." + self.option.attr("class") + " " + ".dews-period-months", self.calendars).hasClass(
          months[i]))

          {
            $(
            "." + self.option.attr("class") + " " + ".dews-period-months" + "." + months[i],
            self.calendars).
            addClass("dews-period-select");
          }
        }

        firstday = new Date(today.getFullYear(), idx1, 1);
        lastday = new Date(today.getFullYear(), idx2 + 1, 0);
        formats(firstday, lastday);
      }

      if (self.firstClickItem !== null && self.secondClickItem === null) {
        firstday = new Date(today.getFullYear(), self.firstClickItem.index() - 16, 1);
        lastday = new Date(today.getFullYear(), self.firstClickItem.index() - 15, 0);
        $(
        "." +
        self.option.attr("class") +
        " " +
        ".dews-period-months" +
        "." +
        months[self.firstClickItem.index() - 16],
        self.calendars).
        addClass("dews-period-select");
        formats(firstday, lastday);
      }
      e.stopPropagation();
    });

    function clear() {
      self.firstClickItem = null;
      self.secondClickItem = null;
      $(".dews-period-months", self.calendars).removeClass("dews-period-select");
    }
  };

  // tag 생성
  PeriodPicker.prototype._initControl = function () {
    var self = this;

    self._createContainer();
    self._createWrapper();
    self._createStartInput();
    self._createEndInput();
    self._createButton();
    self._createCalendars();
    self._createOptions();
    self._createOptionButtons();
    self._createPeriodCalendar();
    self._createStartCalendar();
    self._createEndCalendar();
    self._createButtons();
    self._createOkButton();
    self._createPeriodDate();
    self._bindEvents();

    self.setUserGuideAPI();
  };

  function getOptions($el, defaultOptions, srcOptions) {
    var inlineOptions = {},
      preDefinedFormat,
      options;

    inlineOptions = getInlineOptions($el, defaultOptions);
    if (srcOptions) {
      srcOptions.format ? $el.data("dews-format", srcOptions.format) : "";
      srcOptions.predefined ? $el.data("dews-format-predefined", srcOptions.predefined) : "";
    }
    preDefinedFormat = dews.getPreDefinedFormat($el);

    if (preDefinedFormat) {
      // 공통 포맷이 있을 때
      var vf = preDefinedFormat.replace(/[^(a-z)]/gi, "");
      preDefinedFormat = {
        format: preDefinedFormat
      };
      options = $.extend(true, {}, defaultOptions, inlineOptions, srcOptions, preDefinedFormat);
    } else if (preDefinedFormat !== false && inlineOptions) {
      // 공통 포맷은 없고, 지정한 inlineOptions가 있을 때
      options = $.extend(true, {}, defaultOptions, inlineOptions, srcOptions);
    } else {
      // 공통 포맷이 없지만, 혹여나 잘못된 inlineOptions가 지정되어 있을까봐
      if (srcOptions !== undefined) {
        srcOptions.format =
        preDefinedFormat === false && srcOptions.format && srcOptions.predefined === true ?
        defaultOptions.format :
        srcOptions;
      }
      options = $.extend(true, {}, defaultOptions, srcOptions);
    }

    if ($el.val()) {
      options.value = kendo.parseDate($el.val(), dews._environments.formats.dateValueFormat, kendo.getCulture());
    }

    return options;
  }

  /**
   * HTML 태그에 지정된 옵션을 가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   * @param {object} defaultOptions 기본 옵션
   * @returns {object} 옵션
   */
  function getInlineOptions($el, defaultOptions) {
    var options = {};

    if ($el.data("dews-max")) {
      options.max = kendo.parseDate(
      $el.data("dews-max").toString(),
      dews._environments.formats.dateValueFormat,
      kendo.getCulture());

    }

    if ($el.data("dews-min")) {
      options.min = kendo.parseDate(
      $el.data("dews-min").toString(),
      dews._environments.formats.dateValueFormat,
      kendo.getCulture());

    }

    if ($el.data("dews-format")) {
      options.format = $el.data("dews-format");
    }

    return options;
  }
  /**
   * 텍스트박스에 마스크를 적용합니다.
   * @param {jQuery} $el 적용할 대상 요소의 jQuery 객체
   * @param {string} format 적용 포맷
   */
  function setMask($el, format) {
    var maskJsUrl;
    var interval;

    // jquery.maskedinput.js 를 이용하여 마스크를 적용함
    // script 파일을 로드된 적이 없으면 동적으로 로드합니다.
    // 동시에 여러 컴포넌트 초기화 시 여러번 로드되지않도록 환경변수 두어서 1번만 로드하도록 수정
    maskJsUrl = dews.url.join(dews._environments.scriptBase || "/scripts/", "jquery.maskedinput.js");

    var applyMask = function applyMask() {
      $el.mask(format.replace(/[ymdhms]/gi, "9"));
    };

    if (dews._environments.loadJqueryMaskedinput && $.mask) {
      applyMask();
    } else if (dews._environments.loadJqueryMaskedinput && !$.mask) {
      interval = setInterval(function () {
        if ($.mask) {
          applyMask();
          clearInterval(interval);
        }
      }, 100);
    } else {
      $.getScript(maskJsUrl, function () {
        applyMask();
      });
      dews._environments.loadJqueryMaskedinput = true;
    }
  }

  /**
   * 공통 이벤트를 설정합니다.
   * @param {jQuery} $el 대상 요소의 jQuery객체입니다.
   * @param {object} [options] 피커의 옵션입니다.
   */
  function setEvent($el, options) {
    $el.on("click", function () {
      var $this = $(this);
      if ($this.prop("readonly") === false && $this.prop("disabled") === false) {
        // 읽기 전용/비활성화 상태가 아니면 포커스가 오면 텍스트 전체를 선택하도록 한다.
        $this.select();
      }
    }).on("blur", function (e) {
      var $this = $(this),
        val;
      if ($this.prop("readonly") === false && $this.prop("disabled") === false) {
        if (!dews.date.validate($this.val(), options.format)) {

          //TODO: 값이 유효하지 않을 경우 오류 표시 및 툴팁 표시
        } else {
          //TODO: 값이 유효할 때 오류 표시가 있으면 제거
        }}
    });
  }

  /**
   * 시용자 가이드를 위한 API 를 추가합니다.
   * @param $element 대상 jQuery 요소
   */
  PeriodPicker.prototype.setUserGuideAPI = function () {
    var self = this,
      $element = $(self._element);

    self.startInput.on("focus", function () {
      if (dews.ui.page && dews.ui.page.hasUserGuide) {
        if ($.isFunction(dews.ui.page.focusGuideItem) && $element.attr("id")) {
          dews.ui.page.focusGuideItem("#" + $element.attr("id"));
        }
      }
    });

    self.endInput.on("focus", function () {
      if (dews.ui.page && dews.ui.page.hasUserGuide) {
        if ($.isFunction(dews.ui.page.focusGuideItem) && $element.attr("id")) {
          dews.ui.page.focusGuideItem("#" + $element.attr("id"));
        }
      }
    });
  };

  PeriodPicker.prototype.validate = function () {
    var self = this;
    if (self.getStartText() && self.getEndText()) {
      return true;
    } else {
      return false;
    }
  };

  PeriodPicker.prototype.bindFromPanel = function (data) {
    var self = this,
      $element = $(self._element);
    var startDate, endDate;

    if (data) {
      startDate = $element.data("dews-bind-startdate") || "";
      endDate = $element.data("dews-bind-enddate") || "";

      self.setStartDate("");
      self.setEndDate("");

      if (startDate && data.hasOwnProperty(startDate)) {
        self.setStartDate(data[startDate] || "");
      }

      if (endDate && data.hasOwnProperty(endDate)) {
        self.setEndDate(data[endDate] || "");
      }
    }
  };

  PeriodPicker.prototype.serializeForPanel = function () {
    var self = this,
      $element = $(self._element);
    var startDate,
      endDate,
      data = {};

    startDate = $element.data("dews-bind-startdate") || "";
    endDate = $element.data("dews-bind-enddate") || "";

    if (startDate) {
      data[startDate] = self.getStartDate();
    }

    if (endDate) {
      data[endDate] = self.getEndDate();
    }

    return data;
  };

  PeriodPicker.prototype.applyPanelFocus = function (requiredCheck) {
    var self = this,
      $element = $(self._element);
    var startInput = $(self.startInput),
      endInput = $(self.endInput);

    startInput.on("keydown", function (e) {
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && startInput.is(":enabled")) {
        e.preventDefault();
      } else if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();

        var evt = new $.Event("beforeFocus");
        evt.control = self;

        $element.trigger(evt);
      } else if (e.keyCode === 9 || e.keyCode === 13 && startInput.is(":enabled")) {
        if (e.keyCode === 9) {
          //tab키 기본동작 막기
          e.preventDefault();
        }

        if (e.keyCode === 13 && requiredCheck && $element.hasClass("required")) {
          if (self.validate()) {
            var evt = new $.Event("nextFocus");
            evt.control = self;

            $element.trigger(evt);
          }
        } else if (e.keyCode === 9) {
          // tab키 누를 시 종료년월로 포커스 이동
          endInput.focus();
        } else {
          // 엔터키 누를 시 다음 컨트롤로 포커스 이동
          var evt = new $.Event("nextFocus");
          evt.control = self;

          $element.trigger(evt);
        }
      }
    });

    endInput.on("keydown", function (e) {
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && endInput.is(":enabled")) {
        e.returnValue = false;
        e.preventDefault();
      } else if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();
        startInput.focus();
      } else if (e.keyCode === 9 || e.keyCode === 13 && endInput.is(":enabled")) {
        if (e.keyCode === 9) {
          //tab키 기본동작 막기
          e.preventDefault();
        }

        var evt = new $.Event("nextFocus");
        evt.control = self;

        $element.trigger(evt);
      }
    });
  };

  PeriodPicker.prototype.canFocusable = function () {
    var self = this;
    var _boolean16 = false;
    if (
    $(self.startInput).is(":enabled") &&
    $(self.endInput).is(":enabled") &&
    $(self.startInput).is(":visible") &&
    $(self.endInput).is(":visible") &&
    !$(self._element).hasClass("readonly"))
    {
      _boolean16 = true;
    }
    return _boolean16;
  };

  /**
   * 기간피커 컨트롤 자동화 인쇄 관련 데이터 추출
   * @return {*} 값이 설정 된 경우 Object 반환, 없는 경우 undefined 반환
   * @private
   */
  PeriodPicker.prototype._getPrintData = function () {
    var self = this,
      $el = $(self._element),
      data;

    if (self.getStartText() && self.getEndText()) {
      data = {
        id: $el.attr("id"),
        text: self.getStartText() + " ~ " + self.getEndText()
      };
    }

    return data;
  };

  /**
   * 기간피커 컨트롤 display none 하여 숨기는 API
   */
  PeriodPicker.prototype.hide = function () {
    var self = this;

    if (!(self.wrapper.css("display") === "none")) {
      self.wrapper.css("display", "none");
    }
  };

  /**
   * 기간피커 컨트롤 display inline-block 하여 보이도록 하는 API
   */
  PeriodPicker.prototype.show = function () {
    var self = this;

    if (self.wrapper.css("display") === "none") {
      self.wrapper.css("display", "inline-block");
    }
  };

  dews = $.extend(true, dews, {
    ui: {
      periodpicker: function periodpicker(selector, options) {
        var $el, periodpicker;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var picker,
            $this = $(this);

          picker = $this.data("dews-control");

          if (!picker) {
            if (!$this.hasClass("dews-ui-periodpicker")) {
              $this.addClass("dews-ui-periodpicker");
            }

            if (!$this.hasClass("dews-form-control")) {
              $this.addClass("dews-form-control");
            }

            picker = new PeriodPicker(this, options);
            picker._initControl();

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            $this.data("dews-control", picker);
          }

          periodpicker = picker;
        });

        return periodpicker;
      }
    }
  });

  dews.ui.addControlInitializer("periodpicker", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.periodpicker($("span.dews-ui-periodpicker", $container));
  });
})(jQuery, window.dews, window.kendo);


(function ($, dews) {
  function getOptions(self, opt) {
    var pivotGridID,
      id = self.element.attr("ID");
    DevExpress.localization.loadMessages({
      en: {
        "dxList-selectAll": dews.localize.get("전체선택", "dews_전체선택")
      }
    });
    if (dews.ui.dialogPage && self.element.closest(dews.ui.dialogPage.$content).length) {
      opt.$content = dews.ui.dialogPage.$content;
      pivotGridID = dews.ui.dialogPage.id + "_" + id;
    } else if (dews.ui.page && self.element.closest(dews.ui.page.$content).length) {
      opt.$content = dews.ui.page.$content;
      pivotGridID = dews.ui.page.id + "_" + id;
    } else {
      opt.$content = $(document);
      pivotGridID = "child_" + id;
    }
    var option = {
      autoBind: true,
      state: "none",
      fieldChooser: {
        texts: {
          allFields: dews.localize.get("전체 영역", "dews_전체 영역"),
          columnFields: dews.localize.get("열 영역", "dews_열 영역"),
          dataFields: dews.localize.get("값 영역", "dews_값 영역"),
          filterFields: dews.localize.get("필터 영역", "dews_필터 영역"),
          rowFields: dews.localize.get("행 영역", "dews_행 영역")
        },
        title: dews.localize.get("필드 선택창", "dews_필드 선택창")
      },
      fieldPanel: {
        texts: {
          rowFieldArea: dews.localize.get("행 영역입니다.", "dews_행 영역입니다."),
          dataFieldArea: dews.localize.get("값 영역입니다.", "dews_값 영역입니다."),
          columnFieldArea: dews.localize.get("열 영역입니다.", "dews_열 영역입니다."),
          filterFieldArea: dews.localize.get("필터 영역입니다.", "dews_필터 영역입니다.")
        }
      },
      headerFilter: {
        texts: {
          ok: dews.localize.get("적용", "dews_적용"),
          cancel: dews.localize.get("닫기", "dews_닫기")
        }
      },
      loadPanel: {
        enabled: false
      },
      texts: {
        collapseAll: dews.localize.get("전체 접기", "dews_전체 접기"),
        dataNotAvailable: "N/A",
        expandAll: dews.localize.get("전체 펼치기", "dews_전체 펼치기"),
        exportToExcel: dews.localize.get("엑셀 내보내기", "dews_엑셀 내보내기"),
        grandTotal: dews.localize.get("전체 합계", "dews_전체 합계"),
        noData: dews.localize.get("데이터가 없습니다.", "dews_데이터가 없습니다."),
        removeAllSorting: dews.localize.get("정렬 초기화", "dews_정렬 초기화"),
        showFieldChooser: dews.localize.get("필드 선택창 보이기", "dews_필드 선택창 보이기"),
        sortColumnBySummary: dews.localize.get('"{0}" 열 정렬', "dews_열 정렬"),
        sortRowBySummary: dews.localize.get('"{0}" 행 정렬', "dews_행 정렬"),
        total: dews.localize.get('"{0}" 합계', "dews_합계")
      }
    };
    var preDefinedFormat,
      formats = {};

    // 피벗그리드 스타일 저장
    if (opt.state === "local") {
      opt.stateStoring = {
        enabled: true,
        type: "localStorage",
        storageKey: pivotGridID
      };
    }

    if (opt.sources) {
      for (var i = 0; i < opt.sources.length; i++) {
        if (!opt.sources[i].caption && opt.sources[i].dataField) {
          opt.sources[i].caption = opt.sources[i].dataField;
        }

        if (opt.sources[i].dataType === "date" && !opt.sources[i].format && !opt.sources[i].groupInterval) {
          opt.sources[i].format = dews._environments.formats.dateFormat;
        } else if (
        opt.sources[i].format && (
        opt.sources[i].dataType === "date" || opt.sources[i].dataType === "number"))
        {
          if (opt.sources) {
            for (var i = 0; i < opt.sources.length; i++) {
              if (
              opt.sources[i].dataType === "date" &&
              !opt.sources[i].format &&
              !opt.sources[i].groupInterval)
              {
                opt.sources[i].format = dews._environments.formats.dateFormat;
              } else if (
              opt.sources[i].format && (
              opt.sources[i].dataType === "date" || opt.sources[i].dataType === "number"))
              {
                if ($.type(opt.sources[i].format) === "object") {
                  if (opt.sources[i].format.predefined) {
                    opt.sources[i].format.preFormat = opt.sources[i].format.format;
                    preDefinedFormat = dews.getPreDefinedFormat(opt.sources[i].format);
                    opt.sources[i].format = preDefinedFormat;
                  } else {
                    opt.sources[i].format = opt.sources[i].format.format;
                  }
                }
              }
            }
          }
        }
      }
    }

    if (opt.onExporting) {
      var exceljsUrl = "".concat(dews._environments.scriptBase, "devexpress/exceljs.min.js");
      var fileSaverUrl = "".concat(dews._environments.scriptBase, "devexpress/FileSaver.min.js");
      $.getScript(exceljsUrl);
      $.getScript(fileSaverUrl);
    }

    $.extend(true, option, opt);

    return option;
  }

  var PivotGrid = function PivotGrid(selector, options) {
    var self = this,
      option;
    var containerPanel, pivotHeight;
    self.element = selector;
    self.id = selector.attr("id");
    self.itemList = [];

    dews.ready(function () {
      // pivotHeight = containerPanel.css('height').replace(/[^-\d\.]/g, '');
      if (selector.closest(".dews-container-item").length > 0) {
        containerPanel = self.element.parent().parent();
        pivotHeight = containerPanel.css("height");
        if (pivotHeight.replace(/[^-\d\.]/g, "") > 0 || containerPanel.data("dews-fit-bottom")) {
          // self.setOptions({height: pivotHeight + 'px'});
          self.setOptions({ height: pivotHeight });
        }
      }
    });

    if (typeof options.useStateStore === "boolean" && options.useStateStore) {
      var stateData = [],
        pivotGridData = dews.ui.page.pivotGridData;
      if (pivotGridData && pivotGridData[self.id]) {
        stateData = pivotGridData[self.id].items;
      }
      self._stateStore = new dews.ui.pivotgrid.StateStore(self, stateData);
      self._stateStore.styleService = new PivotStyleService();
    }

    option = getOptions(self, options);
    self.options = option;
    option.dataSource.devDataSource._fields = option.sources;
    self._pivot = selector.dxPivotGrid(option).dxPivotGrid("instance");
    // var $fieldPanelVisibleBtn = $('<div class="dx-pivotgrid-field-setting-button dx-button dx-button-normal dx-widget dx-button-has-icon" role="button" aria-label="field" title="필드 설정" tabindex="0"><div class="dx-button-content"><i class="dx-icon"></i></div></div>');
    var $fieldPanelVisibleBtn = $('<div class="dx-pivotgrid-field-setting-button"></div>');
    $fieldPanelVisibleBtn.dxButton({ icon: "fieldsetting" }).dxButton("instance");
    selector.find(".dx-pivotgrid-toolbar").prepend($fieldPanelVisibleBtn);

    if (typeof options.useStateStore === "boolean" && options.useStateStore) {
      var $stateBtn = $('<div class="dx-pivotgrid-style-management-button"></div>');
      $stateBtn.dxButton({ icon: "stylemanagement" }).dxButton("instance");
      selector.find(".dx-pivotgrid-toolbar").append($stateBtn);
    }

    // self._pivot = $('#' + pivotGridID).dxPivotGrid(option).dxPivotGrid('instance');
    // self._pivot.name = pivotGridID;

    self._pivot.option("dataSource", self.options.dataSource.devDataSource);
    // self.options.dataSource.devDataSource.fields(option.sources);
    // self.options.dataSource.devDataSource.load();

    if (self.options.dataSource && self.options.autoBind) {
      self.options.dataSource.read();
    }

    selector.on("click", ".dx-pivotgrid-field-setting-button", function () {
      if (self._pivot.option("fieldPanel.visible")) {
        self._pivot.option("fieldPanel.visible", false);
      } else {
        self._pivot.option("fieldPanel.visible", true);
      }
      $fieldPanelVisibleBtn = $('<div class="dx-pivotgrid-field-setting-button"></div>');
      $fieldPanelVisibleBtn.dxButton({ icon: "fieldsetting" }).dxButton("instance");
      selector.find(".dx-pivotgrid-toolbar").prepend($fieldPanelVisibleBtn);
      if (typeof options.useStateStore === "boolean" && options.useStateStore) {
        $stateBtn = $('<div class="dx-pivotgrid-style-management-button"></div>');
        $stateBtn.dxButton({ icon: "stylemanagement" }).dxButton("instance");
        selector.find(".dx-pivotgrid-toolbar").append($stateBtn);
      }
    });

    selector.on("click", ".dx-pivotgrid-style-management-button", function () {
      var dlgOptions = dews.ui.pivotgrid.moreItemDialog(self._stateStore),
        dialog;
      dlgOptions.ok = function (data) {
        var key = self._stateStore.key;
        dews.api.
        get(
        dews.url.getApiUrl(
        "CM",
        "PivotStyleService", "load/".concat(
        key.moduleCD, "/").concat(key.menuCD, "/").concat(key.gridID)),

        {
          async: false,
          data: {
            keyword: data
          }
        }).

        done(function (result) {
          styleState = JSON.parse(result[0].pgrdAllfText);
          self._stateStore._pivot.options.dataSource.devDataSource.state(styleState);
        }).
        fail();
      };
      dialog = dews.ui.dialog("styleListDialog", dlgOptions);
      dialog.open();
    });

    selector.on("click", ".dx-pivotgrid-field-chooser-button", function () {
      var popup = document.querySelector(".dx-overlay-wrapper.dx-fieldchooser-popup");
      popup.classList.add("k-window", "dialog");
      popup.style.background = "none";
    });

    self._bindEvent();

    return self;
  };

  PivotGrid.prototype._bindEvent = function () {
    var self = this;
    var containerPanel, pivotHeight;

    $(window).on("resize", function (e) {
      containerPanel = self.element.parent().parent();
      pivotHeight = containerPanel.css("height");
      if (self.element.closest(".dews-container-item").length > 0) {
        containerPanel = self.element.parent().parent();
        pivotHeight = containerPanel.css("height");
        if (pivotHeight.replace(/[^-\d\.]/g, "") > 0 || containerPanel.data("dews-fit-bottom")) {
          self.setOptions({ height: pivotHeight });
        }
      }
    });

    // 영역에서 필드들이 inline-block 으로 인해 줄 바꿈 발생 시 하단 영역이 fit-bottom 상황에서 잘리는 현상 수정
    self._pivot.on("contentReady", function (e) {
      var rowsArea = e.component._rowsArea;
      if (rowsArea.hasScroll()) {
        var devPivot = e.component,
          dataArea = e.component._dataArea,
          columnsArea = e.component._columnsArea,
          tableElement = devPivot._tableElement(),
          containerElement = devPivot._pivotGridContainer,
          missHeight,
          tableElementHeight = tableElement.height(),
          containerElementHeight = containerElement.height();
        var each = function each(values, callback) {
          if (!values) {
            return;
          }
          if ("length" in values) {
            for (var i = 0; i < values.length; i++) {
              if (false === callback.call(values[i], i, values[i])) {
                break;
              }
            }
          } else {
            for (var key in values) {
              if (false === callback.call(values[key], key, values[key])) {
                break;
              }
            }
          }
          return values;
        };

        if (tableElementHeight > containerElementHeight) {
          missHeight = tableElementHeight - containerElementHeight;

          rowsArea.groupHeight(devPivot._hasHeight ? rowsArea._groupHeight - missHeight : "auto");
          dataArea.groupHeight(devPivot._hasHeight ? dataArea._groupHeight - missHeight : "auto");

          var updateScrollableResults = [];
          each([columnsArea, rowsArea, dataArea], function (_, area) {
            updateScrollableResults.push(area && area.updateScrollable());
          });
        }
      }
    });

    // contextMenu 준비 이벤트
    self._pivot.on("contextMenuPreparing", function (e) {
      if (self.options.useStateStore) {
        var items = e.items;
        items.push(self._stateStore.create(e));
      }
    });

    // drm 엑셀 다운로드 이슈에 의한 문제로 추가
    self._pivot.on("fileSaving", function (e) {
      if (e.format === "EXCEL" && dews._environments && dews._environments.drmCreateDownload === true) {
        var data = e.data;
        saveServer(data, e.fileName);
        e.cancel = true;
      }

      function saveServer(excelData, fileName) {
        var formElement = '<form name="tempForm" action="' + "/drmService/excel/create" + '" method="post">';
        formElement += '<input type="hidden" name="fileName" value = "' + fileName + ".xlsx" + '"/>';
        formElement += '<input type="hidden" name="data" value = "' + excelData + '"/>';
        formElement += '<input id="submitBtn" type="submit"/>';
        formElement += "</form>";
        var div = document.createElement("div");
        div.innerHTML = formElement;
        document.body.appendChild(div);
        document.getElementById("submitBtn").click();
        document.body.removeChild(div);
      }
    });
  };

  PivotGrid.prototype.setDataSource = function (dataSource) {
    var self = this;

    dataSource.devDataSource.fields(self.options.sources);
    self.options.dataSource = dataSource;
    self._pivot.option("dataSource", self.options.dataSource.devDataSource);
  };

  PivotGrid.prototype.setSources = function (sources) {
    var self = this;

    self.options.sources = sources;
    self.options.dataSource.devDataSource.fields(sources);
  };

  PivotGrid.prototype.setOptions = function (options) {
    var self = this,
      opt;

    opt = $.extend(true, {}, self.options, options);
    opt = getOptions(self, opt);
    self.options = opt;
    self._pivot.option(options);
  };

  PivotGrid.prototype.saveAsExcel = function () {
    var self = this;

    self._pivot.exportToExcel();
  };

  PivotGrid.prototype.initState = function () {
    var self = this;

    self.options.dataSource.devDataSource.state({});
  };

  PivotGrid.prototype.refresh = function () {
    var self = this;

    self._pivot.repaint();
  };

  PivotGrid.prototype.resetField = function () {
    var pgridStorageKey = this.options.stateStoring.storageKey;

    window.localStorage.removeItem(pgridStorageKey);
  };

  function convertGetData(fn) {
    return function (data, options) {
      if (dews._environments && dews._environments.drmCreateDownload === true) {
        return getData(data, options);
      } else {
        return fn.call(null, data, options);
      }
    };
  }

  function getData(data, options) {
    var excelCreator = new DevExpress.clientExporter.excel.creator(data, options);
    excelCreator._checkZipState();
    return excelCreator.ready().then(function () {
      return excelCreator.getData(false);
    });
  }

  // DevExpress excel getData 함수
  DevExpress.clientExporter.excel.getData = convertGetData(DevExpress.clientExporter.excel.getData);

  dews = $.extend(true, dews, {
    ui: {
      /**
       * 트리 그리드 컨트롤을 생성합니다.
       *
       * @param {jQuery|String} selector 트리 그리드 생성 대상
       * @param {Object} [options] 트리 그리드 옵션
       */
      pivotgrid: function pivotgrid(selector, options) {
        var $el, pivotGrid, $content;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          if (dews.ui.dialogPage) {
            $content = dews.ui.dialogPage.$content;
          } else if (dews.ui.page) {
            $content = dews.ui.page.$content;
          } else {
            $content = $(document);
          }

          $el = $(selector, $content);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var pivot,
            $this = $(this);

          pivot = $this.data("dews-control");

          if (!pivot) {
            if ($.type(options) === "undefined") {
              options = {};
            }

            // pivot = new PivotGrid($el, options); //pivotGrid wrapping
            pivot = new PivotGrid($this, options);
            $this.data("dews-control", pivot);
          }

          pivotGrid = pivot;
        });

        return pivotGrid;
      }
    }
  });
})(jQuery, window.dews);


/**
 * 피벗그리드 스타일 저장 기능
 */
/**
 * @typedef {StateItemType[]} StateItemsType
 */
/**
 * @typedef {object} StateItemType
 * @property {string} key 유니크 키
 * @property {string} title 상태 아이템 이름
 * @property {object} state 피벗그리드의 상태 객체
 * @property {boolean | undefined} selected 선택 여부
 */
(function ($, dews) {
  /**
   * @class
   * @param {dews.ui.pivotgrid} pivot 피벗그리드 객체
   * @param {StateItemsType} stateItems
   * @constructor
   */
  function StateStore(pivot, stateItems) {
    var self = this;
    self._pivot = pivot;
    self.data = stateItems;
    self.selectItem = null;
    self.key = {
      moduleCD: dews.ui.page.menu.module,
      menuCD: dews.ui.page.menu.id,
      gridID: self._pivot.id
    };
  }

  /**
   * 컨텍스트 메뉴에서 '스타일 관리' 아이템을 생성
   * @return {{beginGroup: boolean, text: *, items: []}} 컨텍스트 메뉴에 추가할 아이템
   */
  StateStore.prototype.create = function (e) {
    var self = this;
    var cellData = e.cell;

    var moreItem = {
      // 저장된 스타일이 기본 스타일 포함한 10개 초과일 때, '더보기' 행 출력
      title: "더 많은 스타일 보기...",
      selected: false,
      state: "moreItem"
    };

    // 컨텍스트 메뉴 '스타일 관리' 아이템
    var styleManagement = {
      text: dews.localize.get("스타일 관리", "dews_스타일 관리"),
      icon: "stylemanagement",
      beginGroup: true,
      items: []
    };
    // 컨텍스트 메뉴 '스타일 관리' - '스타일 추가' 아이템
    var styleAdd = {
      text: dews.localize.get("스타일 추가", "dews_스타일 추가"),
      beginGroup: false,
      onItemClick: function onItemClick(e) {
        addHandler();
      }
    };
    // 컨텍스트 메뉴 '스타일 삭제' - '스타일 삭제' 아이템
    var styleDelete = {
      text: dews.localize.get("스타일 삭제", "dews_스타일 삭제"),
      beginGroup: false,
      onItemClick: function onItemClick(e) {
        deleteHandler(e);
      }
    };
    // 컨텍스트 메뉴 '스타일 가져오기' - '스타일 가져오기' 아이템
    var styleImport = {
      text: dews.localize.get("스타일 가져오기", "dews_스타일 가져오기"),
      beginGroup: false,
      onItemClick: function onItemClick(e) {
        importHandler(e);
      }
    };
    // 컨텍스트 메뉴 '스타일 관리' - '기본 스타일' 아이템
    var styleReset = {
      text: dews.localize.get("기본 스타일", "dews_기본 스타일"),
      beginGroup: true,
      onItemClick: resetHandler
    };

    // 스타일 추가 아이템 클릭 핸들러
    function addHandler() {
      var dlgOptions = addStyleDialogOptions(),
        dialog;
      dlgOptions.ok = function (data) {
        var state = self._pivot.options.dataSource.devDataSource.state(), // 피벗그리드 스타일 상태
          item = {
            title: data.title,
            state: state,
            selected: true
          };

        // 스타일 저장시 저장 API
        self.styleService.saveStyle(self.key, data.title, JSON.stringify(item.state));

        self.data.filter(function (item) {
          if (self.selectItem.title === item.title) {
            item.selected = false;
          }
        });
        self.selectItem = item;
      };

      dialog = dews.ui.dialog("pivotStateSaveDialog", dlgOptions);
      dialog.open();
    }

    // 스타일 삭제 아이템 클릭 핸들러
    function deleteHandler(e) {
      var pivot = self;
      var dlgOptions = delStyleDialog(pivot),
        dialog;
      dlgOptions.ok = function (data) {
        // 다이얼로그 적용 버튼 클릭시
        var contextItems = []; // 현재 컨텍스트 메뉴에 있는 아이템명
        self.data.forEach(function (v) {
          contextItems.push(v.title);
        });

        var removeList = data;
        var removeIDList = [],
          removeIdList = [],
          removeNmList = [];
        removeList.forEach(function (i) {
          if (self.selectItem && self.selectItem.state !== "moreItem") {
            if (i.PGRD_ALLF_TXT === JSON.stringify(self.selectItem.state)) {
              // 현재 적용되어있는 상태를 삭제시 기본 스타일로 변경
              self._pivot.options.dataSource.devDataSource.state({});
            }
          }
          removeIdList.push(i["PGRD_STY_ID"]);
          removeNmList.push(i["PGRD_STY_NM"]);
        });

        // 삭제할 스타일 ID를 api 파라미터 형식에 맞게 변환
        removeIDList = removeIdList.toString().replace(/,/g, "|");
        // 피벗그리드 스타일 삭제
        pivot.styleService.delStyle(self.key, removeIDList);

        contextMenuDel(pivot, removeList, removeNmList);
      };

      dialog = dews.ui.dialog("pivotStateDelDialog", dlgOptions);
      dialog.open();
    }

    // 스타일 가져오기 아이템 클릭 핸들러
    function importHandler(e) {
      var pivot = self;
      var dlgOptions = importStyleDialog(pivot),
        dialog;
      dlgOptions.ok = function (data) {
        var saveList = [];

        data.forEach(function (item) {
          saveList.push({
            // 여러 스타일 저장
            pgrd_sty_nm: item.PGRD_STY_NM,
            pgrd_allf_txt: item.PGRD_ALLF_TXT
          });
        });

        dews.api.post(
        dews.url.getApiUrl(
        "CM",
        "PivotStyleService", "saveAll/".concat(
        self.key.moduleCD, "/").concat(self.key.menuCD, "/").concat(self.key.gridID)),

        {
          data: {
            saveList: JSON.stringify(saveList)
          }
        });

      };

      dialog = dews.ui.dialog("pivotStateImportDialog", dlgOptions);
      dialog.open();
    }

    // 기본 스타일 클릭 아이템 핸들러
    function resetHandler() {
      dews.confirm(dews.localize.get("초기화하시겠습니까?", "dews_초기화하시겠습니까?")).yes(function () {
        if (self.selectItem === null) {
        } else {
          self.selectItem.selected = false;
          self.selectItem = null;
        }
        self._pivot.options.dataSource.devDataSource.state({});
      });
    }

    // 컨텍스트 메뉴에 아이템 삭제
    function contextMenuDel(self, removeList, removeNmList) {
      var itemList = self._pivot.itemList;
      var basic = false;

      removeNmList.forEach(function (removeNm) {
        itemList = itemList.filter(function (value) {
          if (value.title === removeNm) {
            basic = true;
          }
          return value.title !== removeNm;
        });
      });

      if (basic) {
        // 현재 적용되어 있는 스타일 상태를 삭제시 초기화
        self.selectItem.selected = false;
        self.selectItem = null;
        self._pivot.options.dataSource.devDataSource.state({});
      }
      self._pivot.itemList = itemList;

      if (itemList.length > 10) {
        itemList = itemList.slice(0, 10);
        itemList.push(moreItem);
      }
      self.data = itemList;
    }

    styleManagement.items.push(styleAdd, styleDelete, styleImport, styleReset);

    // 컨텍스트 메뉴에 아이템 업데이트
    self.styleService.loadStyle(self.key).done(function (result) {
      result.forEach(function (style) {
        var item = {
          title: style.PGRD_STY_NM,
          state: JSON.parse(style.PGRD_ALLF_TXT)
        };

        var selectItem = self.selectItem;
        if (selectItem) {
          if (selectItem.title === item.title) {
            item.selected = true;
          }
        }
        styleManagement.items.push(self._createState(item));
      });

      // 저장된 스타일이 기본 스타일 포함한 10개 초과일 때, '더보기' 행 출력
      if (styleManagement.items.length > 13) {
        styleManagement.items = styleManagement.items.slice(0, 13);
        styleManagement.items.push(self._createState(moreItem));
      }
    });

    if (Array.isArray(self.data)) {
      // 아이템 추가, 삭제시 컨텍스트메뉴에 리스트 업데이트
      for (var i = 0; i < self.data.length; i++) {
        styleManagement.items.push(self._createState(self.data[i], i === 0));
      }
    }
    return styleManagement;
  };

  /**
   * 저장 되어 있는 스타일 관리 아이템 생성
   * @param {StateItemType} data 스타일 관리 데이터
   * @param {boolean} beginGroup 스타일 관리 데이터의 시작 여부
   * @param {object} key
   * @return {{beginGroup: boolean, __stateItem: *, onItemClick: stateItemHandler, text: *, items: [], selected: *}} 컨텍스트 메뉴 스타일 관리 아이템
   * @private
   */
  StateStore.prototype._createState = function (data, beginGroup, key) {
    var self = this,
      // 컨텍스트 메뉴 '스타일 관리' 아이템
      state = {
        text: data.title,
        beginGroup: !!beginGroup,
        items: [],
        onItemClick: stateItemHandler,
        selected: data.selected,
        __stateItem: data
      };

    // '스타일 관리' - 추가된 스타일 영역 아이템 클릭 핸들러
    function stateItemHandler(e) {
      var pivot = self;
      var stateItem = e.itemData.__stateItem;
      var styleState = stateItem.state;
      self._changeSelect(stateItem);
      e.component.selectItem(e.itemElement[0]);
      e.component.hide();

      if (styleState === "moreItem") {
        // '더 많은 스타일 보기' 다이얼로그 오픈해서 스타일 적용시
        var dlgOptions = moreItemDialog(pivot),
          dialog;
        dlgOptions.ok = function (data) {
          self.styleService.loadStyle(self.key, data, null).done(function (result) {
            styleState = JSON.parse(result[0].PGRD_ALLF_TXT);
            self._pivot.options.dataSource.devDataSource.state(styleState);
          });
        };
        dialog = dews.ui.dialog("styleListDialog", dlgOptions);
        dialog.open();
      } else {
        // 컨텍스트메뉴 리스트에 있는 스타일 적용시
        if (_typeof(styleState) !== "object") {
          styleState = JSON.parse(styleState);
        }
        self._pivot.options.dataSource.devDataSource.state(stateItem.state);
      }
    }

    return state;
  };

  /**
   * 현재 선택 아이템 변경
   * @param {StateItemType} stateItem 필드 선택 데이터
   * @private
   */
  StateStore.prototype._changeSelect = function (stateItem) {
    var self = this;

    if (self.selectItem) {
      self.selectItem.selected = false;
    }
    stateItem.selected = true;
    self.selectItem = stateItem;
    if (stateItem.state !== "moreItem") {
      dews.ui.snackbar.ok("스타일이 반영 되었습니다.");
    }
  };

  // '스타일 추가' 다이얼로그 옵션 설정 함수
  function addStyleDialogOptions() {
    var content =
    '<div class="dews-dialog-contents-area">\n' +
    '  <div class="dews-ui-form-panel" data-dews-columns="1">\n' +
    "    <ul>\n" +
    "      <li>\n" +
    "        <label>" +
    dews.localize.get("스타일명", "dews_스타일명") +
    '</label><span><input type="text" id="styleTxt" class="dews-ui-textbox required" placeholder="*글자 제한(15자 이내)" maxlength="15"/></span>\n' +
    "      </li>\n" +
    "    </ul>\n" +
    "  </div>\n" +
    "</div>\n" +
    '<div class="dews-dialog-button-group bottom">\n' +
    '  <button id="btnSave" class="dews-ui-button confirm dews-pivot-dialog-save">' +
    dews.localize.get("저장", "dews_저장") +
    "</button>\n" +
    '  <button id="btnCancel" class="dews-ui-button confirm dews-pivot-dialog-cancel">' +
    dews.localize.get("취소", "dews_취소") +
    "</button>\n" +
    "</div>";

    return {
      title: dews.localize.get("스타일 추가", "dews_스타일 추가"),
      content: content,
      saveBtn: false,
      width: 360,
      height: 150,
      open: function open() {
        dews.ready(function () {
          var dlgSelf = this,
            input = dlgSelf.$content.find(".dews-ui-textbox"),
            saveBtn = dlgSelf.$content.find("#btnSave"),
            cancelBtn = dlgSelf.$content.find("#btnCancel"),
            inputControl = input.data("dewsControl");

          saveBtn.on("click", function () {
            dews.ui.snackbar.ok("스타일이 추가 되었습니다.");
            var data = {
              title: inputControl.text()
            };
            dlgSelf.ok(data);
          });

          cancelBtn.on("click", function () {
            dlgSelf.cancel();
          });

          inputControl.on("keyup", function (e) {
            if (e.currentTarget.value === "") {
              // 스타일명이 입력되지 않았을 때 적용 버튼 비활성화
              saveBtn.data("dewsControl").enable(false);
            } else {
              // 스타일명 입력시 적용 버튼 활성화
              saveBtn.data("dewsControl").enable(true);
            }

            if (e.currentTarget.value.length >= 15) {
              // '스타일명' 글자 수 제한
              dews.ui.tooltip.show(input, {
                type: "required",
                text: "글자 수를 초과하였습니다."
              });
            }
          });
        });
      }
    };
  }

  // '더보기' 클릭시 '스타일 관리' 다이얼로그 오픈
  function moreItemDialog(pivot) {
    var pivot = pivot;
    var content =
    '<div class="dews-dialog-contents-area">\n' +
    '  <div class="dews-ui-condition-panel" data-dews-columns="2">\n' +
    "    <ul>\n" +
    "      <li>\n" +
    "        <label>" +
    dews.localize.get("검색어", "dews_검색어") +
    '</label><span><input type="text" width="300px" id="searchStyle" class="dews-ui-textbox"/></span>\n' +
    "      </li>\n" +
    "    </ul>\n" +
    "  </div>\n" +
    "<div>\n" +
    '    <div id="grid" class="dews-ui-grid"></div>\n' +
    "</div>\n" +
    "</div>\n" +
    '<div class="dews-dialog-button-group bottom">\n' +
    '  <button id="btnSave" class="dews-ui-button confirm dews-pivot-dialog-save">' +
    dews.localize.get("적용", "dews_적용") +
    "</button>\n" +
    '  <button id="btnCancel" class="dews-ui-button confirm dews-pivot-dialog-cancel">' +
    dews.localize.get("닫기", "dews_닫기") +
    "</button>\n" +
    "</div>";

    return {
      title: dews.localize.get("스타일 관리", "dews_스타일 관리"),
      content: content,
      size: "medium",
      open: function open() {
        dews.ready(function () {
          var dlgSelf = this,
            input = dlgSelf.$content.find(".dews-ui-textbox"),
            saveBtn = dlgSelf.$content.find("#btnSave"),
            cancelBtn = dlgSelf.$content.find("#btnCancel"),
            inputControl = input.data("dewsControl");
          var grid, gridDataSource;

          saveBtn.on("click", function () {
            // 적용 버튼 클릭
            var styleID = grid.getCellValue(grid.select(), "PGRD_STY_ID");
            dews.ui.snackbar.ok("스타일이 반영 되었습니다.");
            dlgSelf.ok(styleID);
          });

          cancelBtn.on("click", function () {
            // 닫기 버튼 클릭
            dlgSelf.cancel();
          });

          inputControl.on("keyup", function (e) {
            // '검색어' 검색
            if (e.keyCode == "13") {
              // 엔터
              var inputText = this.value;
              var userID = dews.ui.page.user.userid;
              pivot.styleService.loadStyle(pivot.key, inputText, userID).done(function (result) {
                gridDataSource.data(result);
              });
            }
          });

          gridDataSource = dews.ui.dataSource("dataSource", {
            grid: true,
            transport: {
              read: {
                url: dews.url.getApiUrl(
                "CM",
                "PivotStyleService", "load/".concat(
                pivot.key.moduleCD, "/").concat(pivot.key.menuCD, "/").concat(pivot.key.gridID))

              }
            },
            schema: {
              model: {
                fields: [{ field: "PGRD_STY_ID" }, { field: "PGRD_STY_NM" }]
              }
            }
          });

          grid = dews.ui.grid("#grid", {
            dataSource: gridDataSource,
            selectable: true,
            noData: true,
            checkable: false,
            filter: false,
            height: 450,
            columns: [
            { field: "PGRD_STY_ID", title: dews.localize.get("스타일 ID", "dews_스타일 ID") },
            { field: "PGRD_STY_NM", title: dews.localize.get("스타일명", "dews_스타일명") }]

          });
        });
      }
    };
  }

  // '스타일 삭제' 다이얼로그 오픈
  function delStyleDialog(pivot) {
    var pivot = pivot;
    var content =
    '<div class="dews-dialog-contents-area">\n' +
    '  <div class="dews-ui-condition-panel" data-dews-columns="2">\n' +
    "    <ul>\n" +
    "      <li>\n" +
    "        <label>" +
    dews.localize.get("검색어", "dews_검색어") +
    '</label><span><input type="text" width="300px" id="searchStyle" class="dews-ui-textbox"/></span>\n' +
    "      </li>\n" +
    "    </ul>\n" +
    "  </div>\n" +
    "<div>\n" +
    '    <div id="grid" class="dews-ui-grid"></div>\n' +
    "</div>\n" +
    "</div>\n" +
    '<div class="dews-dialog-button-group bottom">\n' +
    '  <button id="btnSave" class="dews-ui-button confirm dews-pivot-dialog-save">' +
    dews.localize.get("적용", "dews_적용") +
    "</button>\n" +
    '  <button id="btnCancel" class="dews-ui-button confirm dews-pivot-dialog-cancel">' +
    dews.localize.get("닫기", "dews_닫기") +
    "</button>\n" +
    "</div>";

    return {
      title: dews.localize.get("스타일 삭제", "dews_스타일 삭제"),
      content: content,
      size: "medium",
      open: function open() {
        dews.ready(function () {
          var dlgSelf = this,
            input = dlgSelf.$content.find(".dews-ui-textbox"),
            saveBtn = dlgSelf.$content.find("#btnSave"),
            cancelBtn = dlgSelf.$content.find("#btnCancel"),
            inputControl = input.data("dewsControl");
          var grid, gridDataSource;

          saveBtn.on("click", function () {
            // 적용 버튼 클릭
            var removeList = grid.getCheckedRows();
            if (grid.getCheckedIndex().length !== 0) {
              dews.confirm(dews.localize.get("삭제하시겠습니까?", "dews_삭제하시겠습니까?")).yes(
              function () {
                dews.ui.snackbar.ok("스타일이 삭제 되었습니다.");
                dlgSelf.ok(removeList);
              });

            }
          });

          cancelBtn.on("click", function () {
            // 닫기 버튼 클릭
            dlgSelf.close();
          });

          inputControl.on("keyup", function (e) {
            // '검색어' 검색
            if (e.keyCode == "13") {
              // 엔터
              var inputText = this.value;
              var userID = dews.ui.page.user.userid;
              pivot.styleService.loadStyle(pivot.key, inputText, userID).done(function (result) {
                gridDataSource.data(result);
              });
            }
          });

          gridDataSource = dews.ui.dataSource("dataSource", {
            grid: true,
            transport: {
              read: {
                url: dews.url.getApiUrl(
                "CM",
                "PivotStyleService", "load/".concat(
                pivot.key.moduleCD, "/").concat(pivot.key.menuCD, "/").concat(pivot.key.gridID))

              }
            },
            schema: {
              model: {
                fields: [
                { field: "PGRD_STY_ID" },
                { field: "PGRD_STY_NM" },
                { field: "PGRD_ALLF_TXT" }]

              }
            }
          });

          grid = dews.ui.grid("#grid", {
            dataSource: gridDataSource,
            selectable: true,
            noData: true,
            checkable: true,
            filter: false,
            height: 450,
            columns: [
            { field: "PGRD_STY_ID", title: dews.localize.get("스타일 ID", "dews_스타일 ID") },
            { field: "PGRD_STY_NM", title: dews.localize.get("스타일명", "dews_스타일명") },
            { field: "PGRD_ALLF_TXT", visible: false }]

          });
        });
      }
    };
  }

  // '스타일 가져오기' 다이얼로그 오픈
  function importStyleDialog(pivot) {
    var pivot = pivot;
    var content =
    '<div class="dews-dialog-contents-area">\n' +
    '  <div class="dews-ui-condition-panel" data-dews-columns="3">\n' +
    '    <form class="dews-condition-panel-form">\n' +
    "      <ul>\n" +
    "        <li>\n" +
    "          <label>" +
    dews.localize.get("사원명", "dews_사원명") +
    "</label>" +
    "          <span>\n" +
    '            <select id="multiSelect" type="text" class="dews-ui-multicodepicker" data-dews-help-code="EMP" data-dews-help-size="medium" data-dews-code-field="USER_ID" data-dews-text-field="USER_NM"></select>' +
    "          </span>\n" +
    "        </li>\n" +
    "        <li>\n" +
    '          <input type="text" id="searchStyle" class="dews-ui-textbox"/>\n' +
    "        </li>\n" +
    "      </ul>\n" +
    "    </form>\n" +
    "  </div>\n" +
    "<div>\n" +
    '    <div id="grid" class="dews-ui-grid"></div>\n' +
    "</div>\n" +
    "</div>\n" +
    '<div class="dews-dialog-button-group bottom">\n' +
    '  <button id="btnSave" class="dews-ui-button confirm dews-pivot-dialog-save">' +
    dews.localize.get("적용", "dews_적용") +
    "</button>\n" +
    '  <button id="btnCancel" class="dews-ui-button confirm dews-pivot-dialog-cancel">' +
    dews.localize.get("닫기", "dews_닫기") +
    "</button>\n" +
    "</div>";

    return {
      title: dews.localize.get("스타일 가져오기", "dews_스타일 가져오기"),
      content: content,
      size: "medium",
      open: function open() {
        dews.ready(function () {
          var dlgSelf = this,
            input = dlgSelf.$content.find(".dews-ui-textbox"),
            saveBtn = dlgSelf.$content.find("#btnSave"),
            cancelBtn = dlgSelf.$content.find("#btnCancel"),
            inputControl = input.data("dewsControl"),
            multiSelect = dlgSelf.$content.find("#multiSelect"),
            multiCode = dlgSelf.$content.find(".dews-multicodepicker-wrapper"),
            multiCodepicker = dews.ui.dialogPage.$content.find("#multiSelect").data("dews-control");
          var grid, gridDataSource, dataList, userID;

          multiSelect.on("codedialog", function (e) {
            e.preventDefault(); // 도움창을 띄우지 않음
            var dlgOptions = empDialog(pivot),
              dialog;
            dlgOptions.ok = function (result) {
              dataList = result;
              multiCodepicker.setData(dataList);

              searchData();
            };
            dialog = dews.ui.dialog("pivotEMPSearchDialog", dlgOptions);
            dialog.open();
          });

          saveBtn.on("click", function () {
            // 적용 버튼 클릭
            var importList = grid.getCheckedRows();
            if (grid.getCheckedIndex().length !== 0) {
              dews.ui.snackbar.ok("스타일이 추가 되었습니다.");
              dlgSelf.ok(importList);
            } else {
              dews.ui.snackbar.warning("선택한 스타일이 없습니다.");
            }
          });

          cancelBtn.on("click", function () {
            // 닫기 버튼 클릭
            dlgSelf.close();
          });

          inputControl.on("keyup", function (e) {
            // '검색어' 검색
            if (e.keyCode == "13") {
              // 엔터
              var inputText = this.value;
              dews.api.
              get(
              dews.url.getApiUrl(
              "CM",
              "PivotStyleService", "load/".concat(
              pivot.key.moduleCD, "/").concat(pivot.key.menuCD, "/").concat(pivot.key.gridID)),

              {
                data: {
                  keyword: inputText,
                  users: userID
                }
              }).

              done(function (result) {
                gridDataSource.data(result);
              });
            }
          });

          multiCodepicker.on("change", function (e) {
            searchData();
          });

          drawGrid([]);

          function drawGrid(data) {
            gridDataSource = dews.ui.dataSource("dataSource", {
              grid: true,
              data: data,
              schema: {
                model: {
                  fields: [
                  { field: "USER_NM" },
                  { field: "PGRD_STY_ID" },
                  { field: "PGRD_STY_NM" },
                  { field: "PGRD_ALLF_TXT" }]

                }
              }
            });
            grid = dews.ui.grid("#grid", {
              dataSource: gridDataSource,
              selectable: true,
              noData: true,
              checkable: true,
              filter: false,
              height: 450,
              columns: [
              { field: "USER_NM", title: dews.localize.get("사원명", "dews_사원명") },
              { field: "PGRD_STY_ID", title: dews.localize.get("스타일 ID", "dews_스타일 ID") },
              { field: "PGRD_STY_NM", title: dews.localize.get("스타일명", "dews_스타일명") },
              { field: "PGRD_ALLF_TXT", visible: false }]

            });
          }

          // 멀티코드피커 값에 따른 그리드 데이터소스 데이터 변경
          function searchData() {
            userID = multiCodepicker.codes();

            if (userID.length != 0) {
              userID = userID.toString().replace(/,/g, "|");

              pivot.styleService.loadStyle(pivot.key, null, userID).done(function (result) {
                gridDataSource.data(result);
              });
            } else {
              // 멀티코드피커에 값이 없을 때
              gridDataSource.data([]);
            }
          }
        });
      }
    };
  }

  // '사원 도움창' 다이얼로그 오픈
  function empDialog(pivot) {
    var pivot = pivot;
    var content =
    '<div class="dews-dialog-contents-area">\n' +
    '  <div class="dews-ui-condition-panel" data-dews-columns="2">\n' +
    "      <ul>\n" +
    "        <li>\n" +
    "          <label>" +
    "검색" +
    "</label>" +
    '          <span><input type="text" id="searchStyle" class="dews-ui-textbox"/>\n' +
    "        </li>\n" +
    "      </ul>\n" +
    "  </div>\n" +
    "<div>\n" +
    '    <div id="empSearchGrid" class="dews-ui-grid"></div>\n' +
    "</div>\n" +
    "</div>\n" +
    '<div class="dews-dialog-button-group bottom">\n' +
    '  <button id="btnSave" class="dews-ui-button confirm dews-pivot-dialog-save">' +
    dews.localize.get("적용", "dews_적용") +
    "</button>\n" +
    '  <button id="btnCancel" class="dews-ui-button confirm dews-pivot-dialog-cancel">' +
    dews.localize.get("닫기", "dews_닫기") +
    "</button>\n" +
    "</div>";

    return {
      title: dews.localize.get("사원 도움창", "dews_사원 도움창"),
      content: content,
      size: "medium",
      open: function open() {
        dews.ready(function () {
          var dlgSelf = this,
            input = dlgSelf.$content.find(".dews-ui-textbox"),
            saveBtn = dlgSelf.$content.find("#btnSave"),
            cancelBtn = dlgSelf.$content.find("#btnCancel"),
            inputControl = input.data("dewsControl");
          var grid, gridDataSource;

          saveBtn.on("click", function () {
            // 적용 버튼 클릭
            var importList = grid.getCheckedRows();
            dews.ui.snackbar.ok("스타일이 추가 되었습니다.");
            if (grid.getCheckedIndex().length !== 0) {
              dlgSelf.ok(importList);
            } else {
              // 사원도움창에서 데이터 체크 안해도 포커스 되어있는 값을 적용
              var list = [];
              list.push(grid.dataItem(grid.select()));
              dlgSelf.ok(list);
            }
          });

          cancelBtn.on("click", function () {
            // 닫기 버튼 클릭
            dlgSelf.close();
          });

          inputControl.on("keyup", function (e) {
            // '검색어' 검색
            if (e.keyCode == "13") {
              // 엔터
              var inputText = this.value;
              dews.api.
              get(
              dews.url.getApiUrl("CM", "PivotStyleService", "selectUserList/".concat(pivot.key.menuCD)),
              {
                data: {
                  search: inputText
                }
              }).

              done(function (result) {
                gridDataSource.data(result);
              });
            }
          });

          gridDataSource = dews.ui.dataSource("dataSource", {
            grid: true,
            transport: {
              read: {
                url: dews.url.getApiUrl(
                "CM",
                "PivotStyleService", "selectUserList/".concat(
                pivot.key.menuCD))

              }
            },
            schema: {
              model: {
                fields: [
                { field: "DEPT_NM" },
                { field: "GEMP_NO" },
                { field: "USER_NM" },
                { field: "USER_ID" }]

              }
            }
          });

          grid = dews.ui.grid("#empSearchGrid", {
            dataSource: gridDataSource,
            selectable: true,
            noData: true,
            filter: false,
            height: 450,
            columns: [
            { field: "DEPT_NM", title: "부서명" },
            { field: "GEMP_NO", title: "사원번호" },
            { field: "USER_NM", title: "사원명" },
            {
              field: "USER_ID",
              title: "사원 ID",
              visible: false
            }]

          });
        });
      }
    };
  }

  dews.ui.pivotgrid.StateStore = StateStore;
  dews.ui.pivotgrid.moreItemDialog = moreItemDialog;
})(jQuery, window.dews || {});


/*
 * 패널바
 */
(function ($, dews, kendo) {
  var PopupItem = function PopupItem(element, parent) {
    var self = this;

    self.element = $(element);
    self.parent = parent;

    return self;
  };

  PopupItem.prototype.select = function () {
    var self = this;

    self.parent.panel.find(">.dews-popup-item").css("display", "none");
    for (var i = 0; i < self.parent.items.length; i += 1) {
      if (self.element === self.parent.items[0].element) {
        self.parent.panel.find(".previous-arrow").addClass("disabled");
        self.parent.panel.find(".previous-arrow").attr("disabled", "disabled");
      } else {
        self.parent.panel.find(".previous-arrow").removeClass("disabled");
        self.parent.panel.find(".previous-arrow").attr("disabled", false);
      }

      if (self.element === self.parent.items[self.parent.items.length - 1].element) {
        self.parent.panel.find(".next-arrow").addClass("disabled");
        self.parent.panel.find(".next-arrow").attr("disabled", "disabled");
      } else {
        self.parent.panel.find(".next-arrow").removeClass("disabled");
        self.parent.panel.find(".next-arrow").attr("disabled", false);
      }
    }
    self.element.css("display", "block");

    // 패널 아이템 내부에 그리드가 있을 경우 사이즈 재조정, 그리드 생성 이전에는 로직 타지 않음
    if (self.element.find("> .dews-ui-grid canvas")[0]) {
      var grid = dews.ui.grid(self.element.find("> .dews-ui-grid"));
      grid._grid.resetSize();
    }
  };

  /*PopupItem.prototype.display = function (display) {
      var self = this;
       if (display === 'none') {
          self.element.css('display', 'none');
          self.element.addClass('display');
      } else {
          self.element.css('display', 'block');
          self.element.removeClass('display');
      }
       // 패널 아이템 내부에 그리드가 있을 경우 사이즈 재조정, 그리드 생성 이전에는 로직 타지 않음
      if (self.element.find('> .dews-ui-grid canvas')[0]) {
          var grid = dews.ui.grid(self.element.find('> .dews-ui-grid'));
          grid._grid.resetSize();
      }
  };*/



  function getOptions(opt, element) {
    var options,
      $element = $(element),
      defaultOptions = {
        visible: false,
        select: 0
      };

    options = $.extend(true, defaultOptions, opt);

    if ($element.data("dews-height")) {
      options.height = $element.data("dews-height");
      $element.css("height", $element.data("dews-height") + "px");
    }

    return options;
  }

  function setStyle(panel) {
    var popup = panel,
      options = panel.options;

    if ($.type(options.height) !== "undefined") {
      popup.panel.css("height", options.height + "px");

      // 타이틀이 있을 때 컨텐츠 영역의 높이를 타이틀 영역 크기인 40px만큼 빼주는 작업
      if (popup.popupTitle) {
        popup.items.forEach(function (item) {
          item.element.css("height", item.element.outerHeight() - 40 + "px");
        });
      }
    }

    if ($.type(options.select) === "number") {
      popup.items[options.select].select();
    } else if ($.type(options.select) === "string") {
      popup.items.getById(options.select).select();
    }

    if ($.type(options.visible) !== "undefined") {
      if (options.visible) {
        popup.panel.css("display", "block");
      } else {
        popup.panel.css("display", "none");
      }
    }
  }

  var PopupPanel = function PopupPanel(el, opt) {
    var self = this,
      panel = el,
      option;

    self.panel = panel;
    option = getOptions(opt, panel);
    self.options = option;
    self.items = [];
    self.popupTitle = false;

    for (var j = 0; j < self.panel.find(">.dews-popup-item").not(".disabled").length; j += 1) {
      self.items.push(new PopupItem(self.panel.find(">.dews-popup-item").not(".disabled")[j], self));
    }

    self.items.getById = function (id) {
      var self = this;

      for (var i = 0; i < self.length; i += 1) {
        if (self[i].element.attr("ID") === id) {
          return self[i];
        }
      }

      return null;
    };

    // 팝업 패널 내 타이틀 옵션
    var $panel = $(panel);
    if ($panel.children() !== undefined) {
      $panel.children().each(function (index, child) {
        if ($(child).hasClass("dews-popup-title")) {
          $(child).append(
          '<div class="k-popup-title"><a class="k-button"><span class="k-icon k-popup-close-button"></span></a></div>');


          // 타이틀 내 닫기 버튼 클릭 이벤트
          $(".k-popup-close-button").on("click", function () {
            self.hide();
          });

          $(child).
          children().
          each(function (index, control) {
            if ($(control).hasClass("dews-ui-button")) {
              // 타이틀 내 버튼 세로 가운데 정렬 및 다른 컨트롤과의 간격 생성
              $(control).css("margin-top", (40 - $(control).outerHeight()) / 2 + "px");
              $(control).css("margin-right", "5px");
              $(control).css("margin-left", "5px");
              $(control).wrap('<span class="button-wrapper"></span>');
            } else if (
            $(control).hasClass("dews-checkbox-wrapper") &&
            $(control).children().hasClass("toggle"))
            {
              // toggle button의 width 지정
              $(control).css("width", "55px");
            }
          });

          // 타이틀 내에서 사용하는 컨트롤 div 태그로 감싸기
          $(child).
          children("span, label, input, select").
          wrapAll('<div class="k-popup-title-component"></div>');
          self.popupTitle = true;
        }
      });
    }

    self._createArrowButton();
    !self.popupTitle ? self._createCloseButton() : ""; // 타이틀이 없을 때에만 기존의 닫기 버튼 생성
    //self._bindEvent();

    if (self.items.length !== 0) {
      setStyle(self);
    }
  };

  PopupPanel.prototype._createCloseButton = function () {
    var self = this,
      button = $('<button class="dews-popup-close-button"></button>');

    self.panel.prepend(button);

    button.on("click", function () {
      self.hide();
    });
  };

  PopupPanel.prototype._createArrowButton = function () {
    var self = this,
      nextArrow = $('<button class="next-arrow dews-popup-arrow-button"></button>'),
      preArrow = $('<button class="previous-arrow dews-popup-arrow-button"></button>');

    self.panel.append(preArrow);
    self.panel.append(nextArrow);

    preArrow.on("click", function (e) {
      for (var i = 0; i < self.items.length; i += 1) {
        if (self.items[i].element.css("display") === "block") {
          self.items[i].element.css("display", "none");
          self.items[i - 1].select();
          break;
        }
        self.items[i].element.css("display", "none");
      }
    });

    nextArrow.on("click", function (e) {
      for (var i = 0; i < self.items.length; i += 1) {
        if (self.items[i].element.css("display") === "block") {
          self.items[i].element.css("display", "none");
          self.items[i + 1].select();
          break;
        }
        self.items[i].element.css("display", "none");
      }
    });
  };

  /*PopupPanel.prototype._bindEvent = function () {
      var self = this;
      $(window).on('scroll', function () {
          self.panel.css('bottom', -$(this).scrollTop() + 'px');
      });
  };*/

  PopupPanel.prototype.show = function () {
    var self = this;
    self.panel.slideDown(300, "linear", function () {
      self.panel.css("display", "block");
    });
  };

  PopupPanel.prototype.hide = function () {
    var self = this;
    var e = $.Event();
    if ($.type(self.options.hide) === "function") {
      self.options.hide(e);
    }
    if (!e.isDefaultPrevented()) {
      self.panel.slideUp(300, "linear", function () {
        self.panel.css("display", "none");
      });
    }
  };

  PopupPanel.prototype.setOptions = function (opt) {
    var self = this,
      option;
    option = getOptions(opt, self.panel);
    self.options = option;
    setStyle(self);
  };

  $.extend(true, dews, {
    ui: {
      popuppanel: function popuppanel(selector, options) {
        var $el, popuppanel;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var $this = $(this),
            panel;

          panel = $this.data("dews-control");

          if (!panel) {
            if (!$this.hasClass("dews-ui-popup-panel")) {
              $this.addClass("dews-ui-popup-panel");
            }

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            panel = new PopupPanel($el, options);
            $this.data("dews-control", panel);
          }

          popuppanel = panel;
        });

        return popuppanel;
      }
    }
  });

  dews.ui.addControlInitializer("popuppanel", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.popuppanel($("div.dews-ui-popup-panel", $container));
  });
})(jQuery, window.dews, window.kendo);


/*
 * 프로세스 맵 디자이너 & 뷰어
 */
(function ($, dews) {
  var defaultOptions = {
    useMinimap: false
  };

  function getOptions($el, srcOptions) {
    var inlineOptions,
      options = {};

    inlineOptions = getInlineOptions($el);
    options = $.extend(true, options, defaultOptions, inlineOptions, srcOptions);

    return options;
  }

  function getInlineOptions($el) {
    var options = {};

    options.useMinimap = $el.data("dews-use-minimap") || defaultOptions.useMinimap; //미니맵 사용

    return options;
  }

  function getThemes() {
    var themes;
    var themeUrl =
    $.type(dews.theme) === "undefined" ?
    $('head link[data-role="dews-theme"]').attr("href") :
    dews.theme.getCurrentThemeUrl();
    var theme = $.isFunction(window.getThemes) ? window.getThemes() : "";

    if (theme && theme[0] && theme[0].colors) {
      $.each(theme[0].colors, function (idx, item) {
        if (themeUrl.match(item.name)) {
          themes = item.name;
        }
      });
    }

    return themes;
  }

  var ProcessModeler = function ProcessModeler(element, options) {
    var self = this,
      $element = $(element);
    var menuTreeId = $element.data("dews-menu-tree");
    var processTreeId = $element.data("dews-process-tree");
    var $menuTree = dews.ui.page.$content.find("#" + menuTreeId);
    var $processTree = dews.ui.page.$content.find("#" + processTreeId);

    self.options = getOptions($element, options);

    var interval = setInterval(function () {
      if ($menuTree.data("dews-control") && $processTree.data("dews-control")) {
        self.menuTree = $menuTree.data("dews-control");
        self.processTree = $processTree.data("dews-control");

        clearInterval(interval);
      }
    }, 100);

    self.$element = $element;

    self._initControl();
  };

  ProcessModeler.prototype._initControl = function () {
    var self = this,
      wrapperId,
      options,
      themes;

    if (self.$element.attr("id") && dews.ui.page && dews.ui.page.id) {
      wrapperId = self.$element.attr("id") + dews.ui.page.id;
    }

    var $wrapper = $('<div class="dews-processmodeler-wrapper"></div>');

    self.$element.wrap($wrapper);

    $wrapper.attr("id", wrapperId);

    var $el = self.$element.closest(".dews-processmodeler-wrapper").find(".dews-ui-processmodeler");

    options = {
      container: $el
    };

    themes = getThemes();

    options = $.extend(true, options, { themes: themes });

    if (self.options.useMinimap) {
      options = $.extend(true, options, {
        useMinimap: self.options.useMinimap
      });
    }

    var pm = new dprocess.ProcessModeler(options);

    self.modeler = pm;

    self.setLabelState();
  };

  ProcessModeler.prototype.getXml = function () {
    var self = this;
    return self.modeler.exportXml();
  };

  ProcessModeler.prototype.reset = function () {
    var self = this;

    self.modeler.newXml();
    self.modeler.resetCanvas();
  };

  ProcessModeler.prototype.load = function (xml) {
    var self = this;

    self.modeler.setXml(xml);
    self.modeler.resetCanvas();
  };

  ProcessModeler.prototype.addMenuTreeEvent = function (option) {
    var self = this;
    var modeler = self.modeler.modeler;
    var moddle = modeler.get("moddle");
    var modeling = modeler.get("modeling");
    var palette = modeler.injector._instances.palette;
    var selection = modeler.injector._instances.selection;

    // 트리의 노드 배열을 받아 거기에 draggable 추가
    option.nodes.each(function (idx, value) {
      $(value).attr("draggable", "true");

      $(value).on("dragstart", function (e) {
        // 메뉴 정보를 담는 함수
        var data = self.menuTree.dataItem(e.target);
        var c = palette._entries["create.task"].className;
        var startEvent = e;
        var targetName = startEvent.currentTarget.innerText;

        selection.select(modeler._definitions.rootElements[0]); // 선택되어 있어도 드래그 가능하도록
        e.delegateTarget = $("." + c)[0];
        palette.trigger("dragstart", e);

        palette._eventBus.on("commandStack.shape.create.postExecute", 1500, function (e) {
          if (e.context.shape.type === "bpmn:Task") {
            var extensionElements = moddle.create("bpmn:ExtensionElements", {
              name: targetName,
              menu: JSON.stringify(data)
            });

            e.context.shape.businessObject.extensionElements = extensionElements;
            e.context.shape.businessObject.name = targetName;
            e.context.shape.businessObject.menu = data;

            modeling.updateProperties(e.context.shape, {
              extensionElements: extensionElements
            });

            targetName = "";
            data = {};
          }
        });
      });
    });
  };

  ProcessModeler.prototype.addProcessTreeEvent = function (option) {
    var self = this;
    var modeler = self.modeler.modeler;
    var moddle = modeler.get("moddle");
    var modeling = modeler.get("modeling");
    var selection = modeler.injector._instances.selection;
    var palette = modeler.injector._instances.palette;

    // 트리의 노드 배열을 받아 거기에 draggable 추가
    option.nodes.each(function (idx, value) {
      $(value).attr("draggable", "true");

      $(value).on("dragstart", function (e) {
        // 프로세스 정보를 담는 함수
        var data = self.processTree.dataItem(e.target);
        var c = palette._entries["create.BusinessRuleTask"].className;
        var startEvent = e;
        var targetName = startEvent.currentTarget.innerText;

        selection.select(modeler._definitions.rootElements[0]); // 선택되어 있어도 드래그 가능하도록
        e.delegateTarget = $("." + c)[0];
        palette.trigger("dragstart", e);

        palette._eventBus.on("commandStack.shape.create.postExecute", 1500, function (e) {
          if (e.context.shape.type === "bpmn:BusinessRuleTask") {
            var extensionElements = moddle.create("bpmn:ExtensionElements", {
              name: true,
              process: JSON.stringify(data)
            });

            e.context.shape.businessObject.extensionElements = extensionElements;
            e.context.shape.businessObject.name = targetName;
            e.context.shape.businessObject.process = data;

            modeling.updateProperties(e.context.shape, {
              extensionElements: extensionElements
            });

            targetName = "";
            data = {};
          }
        });
      });
    });
  };

  ProcessModeler.prototype.setLabelState = function () {
    var self = this;
    var modeler = self.modeler.modeler;
    var eventBus = modeler.get("eventBus");
    var moddle = modeler.get("moddle");
    var modeling = modeler.get("modeling");
    var orgName, changedName, extensionElements;
    var changedObj, extendsionObj;

    eventBus.on("commandStack.element.updateLabel.postExecute", function (e) {
      orgName = e.context.oldLabel;
      changedName = e.context.newLabel;

      if (orgName !== changedName) {
        changedObj = { changed: true };
      }

      if (changedObj) {
        if (e.context.element.businessObject && e.context.element.businessObject.extensionElements) {
          extendsionObj = $.extend(
          true,
          e.context.element.businessObject.extensionElements.$attrs,
          changedObj);

        } else {
          extendsionObj = changedObj;
        }

        extensionElements = moddle.create("bpmn:ExtensionElements", extendsionObj);

        modeling.updateProperties(e.context.element, {
          extensionElements: extensionElements
        });
      }
    });
  };

  ProcessModeler.prototype.setLangKey = function (key) {
    var self = this;
    var modeler = self.modeler.modeler;
    var selection = modeler.get("selection");
    var moddle = modeler.get("moddle");
    var modeling = modeler.get("modeling");
    var extensionElements;
    var extendsionObj, changedObj;

    if (selection._selectedElements && selection._selectedElements.length > 0) {
      var element = selection._selectedElements[0];

      changedObj = {
        changed: true,
        key: key
      };

      if (element.businessObject && element.businessObject.extensionElements) {
        extendsionObj = $.extend(true, element.businessObject.extensionElements.$attrs, changedObj);
      } else {
        extendsionObj = changedObj;
      }

      extensionElements = moddle.create("bpmn:ExtensionElements", extendsionObj);
      modeling.updateProperties(selection._selectedElements[0], {
        extensionElements: extensionElements
      });
    }
  };

  ProcessModeler.prototype.checkLangKey = function (element) {
    if (
    element &&
    element.businessObject.extensionElements &&
    element.businessObject.extensionElements.get("key"))
    {
      return element.businessObject.extensionElements.get("key");
    }
  };

  ProcessModeler.prototype.useMinimap = function () {
    var self = this;
    return self.modeler.openMinimap();
  };

  ProcessModeler.prototype.on = function () {
    var self = this;

    self.$element.on.apply(self.$element, arguments);
  };

  ProcessModeler.prototype.zoom = function (type, zoom) {
    var self = this;

    return zoomInOut(self, type, zoom);
  };

  var ProcessViewer = function ProcessViewer(element, options) {
    var self = this,
      $element = $(element);

    self.$element = $element;
  };

  ProcessViewer.prototype._initControl = function () {
    var self = this,
      wrapperId,
      options,
      themes;

    // 통합 검색에서 띄울 때 page 없으면 오류
    if (self.$element.attr("id") && dews.ui.page && dews.ui.page.id) {
      wrapperId = self.$element.attr("id") + dews.ui.page.id;
    }

    var $wrapper = $('<div class="dews-processviewer-wrapper"></div>');

    $wrapper.attr("id", wrapperId);

    self.$element.wrap($wrapper);

    var $el = self.$element.closest(".dews-processviewer-wrapper").find(".dews-ui-processviewer");

    options = {
      container: $el,
      loading: true
    };

    themes = getThemes();

    if ($.type(self.$element.data("dews-use-loading")) === "boolean") {
      // 로딩바 사용 여부
      options.loading = $el.data("ddews-use-loading");
    }

    options = $.extend(true, options, { themes: themes });

    var viewer = new dprocess.ProcessViewer(options);

    self.viewer = viewer;

    if (options.loading) {
      self.$element.attr("style", "visibility : hidden !important"); // display:none은 그리는 시점에 높이값이 제대로 안잡혀서인지 그룹의 텍스트가 맨밑으로 떨어짐

      self.on("viewerLoadStart", function () {
        var loadingOption = {
          target: self.$element.closest(".dews-processviewer-wrapper")
        };

        if (self.$element.closest(".dews-processviewer-wrapper").width() < 580) {
          // 로딩 너비의 2배보다 프로세스맵의 너비가 작으면 tiny 타입 사용
          loadingOption.type = "tiny";
        }

        dews.ui.loading.show(loadingOption);
      });

      self.on("viewerLoaded", function () {
        self.$element.attr("style", "");

        setTimeout(function () {
          dews.ui.loading.hide({
            target: self.$element.closest(".dews-processviewer-wrapper")
          });
        }, 200);
      });
    }
  };

  ProcessViewer.prototype.setEnable = function (el, _boolean17) {
    var self = this;

    self.viewer.enable(el, _boolean17);
  };

  ProcessViewer.prototype.load = function (xml) {
    var self = this;

    self.viewer.setXml(xml);
    self.viewer.resetCanvas();
  };

  ProcessViewer.prototype.on = function () {
    var self = this;

    self.viewer.$element.on.apply(self.viewer.$element, arguments);
  };

  ProcessViewer.prototype.reset = function () {
    var self = this;

    self.viewer.clear();
    self.viewer.resetCanvas();
  };

  ProcessViewer.prototype.zoom = function (type, zoom, fitFlag) {
    var self = this;

    return zoomInOut(self, type, zoom, fitFlag);
  };

  function zoomInOut(self, type, zoom, fitFlag) {
    var zoomSize;

    if (type === "in") {
      switch (zoom) {
        case 25:
          zoom = 0.5;
          zoomSize = 50;
          break;
        case 50:
          zoom = 0.75;
          zoomSize = 75;
          break;
        case 75:
          zoom = 1;
          zoomSize = 100;
          break;
        case 100:
          zoom = 1.25;
          zoomSize = 125;
          break;
        case 125:
          zoom = 1.5;
          zoomSize = 150;
          break;
        case 150:
          zoom = 1.75;
          zoomSize = 175;
          break;
        case 175:
          zoom = 2;
          zoomSize = 200;
          break;
        case 200:
          zoom = 2.5;
          zoomSize = 250;
          break;
        case 250:
          zoom = 3;
          zoomSize = 300;
          break;
        case 300:
          zoom = 4;
          zoomSize = 400;
          break;}

    } else if (type === "out") {
      switch (zoom) {
        case 50:
          zoom = 0.25;
          zoomSize = 25;
          break;
        case 75:
          zoom = 0.5;
          zoomSize = 50;
          break;
        case 100:
          zoom = 0.75;
          zoomSize = 75;
          break;
        case 125:
          zoom = 1;
          zoomSize = 100;
          break;
        case 150:
          zoom = 1.25;
          zoomSize = 125;
          break;
        case 175:
          zoom = 1.5;
          zoomSize = 150;
          break;
        case 200:
          zoom = 1.75;
          zoomSize = 175;
          break;
        case 250:
          zoom = 2;
          zoomSize = 200;
          break;
        case 300:
          zoom = 2.5;
          zoomSize = 250;
          break;
        case 400:
          zoom = 3;
          zoomSize = 300;
          break;}

    }

    if (self.modeler) {
      self.modeler.zoomInOut(zoom);
    } else {
      self.viewer.zoomInOut(zoom, fitFlag);
    }

    return zoomSize;
  }

  function moveViewport(self, $el) {
    var viewerTop = self.viewer.$element.offset().top;
    var viewerLeft = self.viewer.$element.offset().left;

    if (self.viewer.$element.height() >= $el.get(0).getBoundingClientRect().height) {
      if (viewerTop + self.viewer.$element.height() <= $el.offset().top + $el.get(0).getBBox().height) {
        self.viewer.moveCanvas(
        0,
        $(window).height() - ($el.offset().top + $el.get(0).getBoundingClientRect().height + 24));

      } else if (viewerTop > $el.offset().top) {
        self.viewer.moveCanvas(0, viewerTop - $el.offset().top);
      }
    } else if (viewerTop > $el.offset().top) {
      self.viewer.moveCanvas(0, 0);
    }

    if (self.viewer.$element.width() >= $el.get(0).getBoundingClientRect().width) {
      if (viewerLeft + self.viewer.$element.width() <= $el.offset().left + $el.get(0).getBBox().width) {
        self.viewer.moveCanvas(
        $(window).width() - ($el.offset().left + $el.get(0).getBoundingClientRect().width + 24),
        0);

      } else if (viewerLeft > $el.offset().left) {
        self.viewer.moveCanvas(viewerLeft - $el.offset().left, 0);
      }
    } else if (viewerLeft > $el.offset().left) {
      self.viewer.moveCanvas(0, 0);
    }
  }

  // 검색어를 받아 해당 엘리먼트 찾고, 화면에 안보일 시 뷰 이동까지
  ProcessViewer.prototype.findElement = function (searchTxt, direction) {
    var self = this,
      flag = false,
      $el;
    var find = self.viewer.$element.
    find(".viewport").
    find(".djs-element").
    filter(':contains("' + searchTxt + '")');
    var findNode = self.viewer.$element.find(".viewport").find(".djs-element.target");
    var findText = {};

    if (searchTxt) {
      self.viewer.$element.find(".viewport").find(".djs-element").find(".djs-outline").attr("rx", "3");
      self.viewer.$element.find(".viewport").find(".djs-element").find(".djs-outline").attr("ry", "3");
      self.viewer.$element.find(".viewport").find(".djs-element").removeClass("find");
      find.addClass("find");
      self.viewer.$element.find(".viewport").find(".djs-element").removeClass("target");

      if (find.length === 1) {
        $el = find;

        find.addClass("target");
        moveViewport(self, $el);

        findText.all = 1;
        findText.current = 1;
      } else if (find.length > 1) {
        var array = find;
        var reverseArray = find;
        var currentIdx;

        if (direction === "reverse") {
          reverseArray.sort(function (a, b) {
            var aTop = $(a).offset().top;
            var bTop = $(b).offset().top;

            if (aTop === bTop) {
              var aLeft = $(a).offset().left;
              var bLeft = $(b).offset().left;

              return aLeft > bLeft ? -1 : aLeft < bLeft ? 1 : 0;
            }
            return bTop - aTop;
          });

          $.each(reverseArray, function (idx, item) {
            if (flag) {
              $el = $(array[idx]);
              currentIdx = reverseArray.length - idx;
              $(array[idx]).addClass("target");

              moveViewport(self, $el);

              return false;
            }

            if (findNode[0] === item) {
              flag = true;
            }

            if (idx === reverseArray.length - 1) {
              $el = $(array[0]);
              currentIdx = reverseArray.length;

              $(array[0]).addClass("target");

              moveViewport(self, $el);

              return false;
            }
          });
        } else {
          array.sort(function (a, b) {
            var aTop = $(a).offset().top;
            var bTop = $(b).offset().top;

            if (aTop === bTop) {
              var aLeft = $(a).offset().left;
              var bLeft = $(b).offset().left;

              return aLeft < bLeft ? -1 : aLeft > bLeft ? 1 : 0;
            }
            return aTop - bTop;
          });

          $.each(array, function (idx, item) {
            if (flag) {
              $el = $(array[idx]);
              currentIdx = idx + 1;
              $(array[idx]).addClass("target");

              moveViewport(self, $el);

              return false;
            }

            if (findNode[0] === item) {
              flag = true;
            }

            if (idx === array.length - 1) {
              $el = $(array[0]);
              currentIdx = 1;

              $(array[0]).addClass("target");

              moveViewport(self, $el);

              return false;
            }
          });
        }

        findText.all = array.length;
        findText.current = currentIdx;
      } else if (find.length < 1) {
        findText.all = 0;
        findText.current = 0;
      }
    }

    return findText;
  };

  // 검색창을 닫으면 뷰어에서 모든 포커스 빼기
  ProcessViewer.prototype.focusoutElement = function () {
    var self = this;

    self.viewer.$element.find(".viewport").find(".djs-element").removeClass("find");
    self.viewer.$element.find(".viewport").find(".djs-element").removeClass("target");
  };

  dews = $.extend(true, dews, {
    ui: {
      processmodeler: function processmodeler(selector, options) {
        var $el, processmodeler;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var pm,
            $this = $(this);

          pm = $this.data("dews-control");

          if (!pm) {
            if (!$this.hasClass("dews-ui-processmodeler")) {
              $this.addClass("dews-ui-processmodeler");
            }

            pm = new ProcessModeler(this, options);

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            $this.data("dews-control", pm);
          }

          processmodeler = pm;
        });

        return processmodeler;
      },

      processviewer: function processviewer(selector, options) {
        var $el, processviewer;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var pv,
            $this = $(this);

          pv = $this.data("dews-control");

          if (!pv) {
            if (!$this.hasClass("dews-ui-processviewer")) {
              $this.addClass("dews-ui-processviewer");
            }

            pv = new ProcessViewer(this, options);
            pv._initControl();

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            $this.data("dews-control", pv);
          }

          processviewer = pv;
        });

        return processviewer;
      }
    }
  });

  dews.ui.addControlInitializer("processmodeler", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.processmodeler($("div.dews-ui-processmodeler", $container));
  });

  dews.ui.addControlInitializer("processviewer", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.processviewer($("div.dews-ui-processviewer", $container));
  });
})(jQuery, window.dews);


/*
프로그래스바
 */
(function ($, dews, kendo) {
  var defaultOptions = {
    titlebar: false,
    textTemplate: "",
    textAlign: "left",
    alterTextTemplate: "",
    alterTextAlign: "left",
    type: "bar",
    "byte": false,
    cancelButton: false,
    modal: false,
    current: 0,
    autoClose: true,
    change: "",
    target: window.document.body,
    position: {
      align: "",
      margin: [0, 0, 0, 0]
    }
  };

  function getOptions(options) {
    defaultOptions.textAlign = (options === null || options === void 0 ? void 0 : options.type) === "circular" ? "center" : "left";
    defaultOptions.alterTextAlign = (options === null || options === void 0 ? void 0 : options.type) === "circular" ? "center" : "left";

    return $.extend({}, defaultOptions, options);
  }

  var Progress = function Progress(id, opt) {
    var self = this;

    self.id = id;
    self.opt = getOptions(opt);
    if (self.opt.target === "page") {
      if (dews.ui.page && dews.ui.page.$content) {
        self.target = dews.ui.page.$content;
      }
    } else {
      self.target = $(self.opt.target);
    }
    self.element = null;
    self.container = null;
    self.modal = null;

    self._create();

    self._initEventListener();
  };

  Progress.prototype._create = function () {
    var self = this,
      $target;

    self._createProgressBar();

    self._createContainer();

    self._createWrapper();

    self._createTextTemplate();

    self._createText();

    self._createAlterTextTemplate();

    self._createTitleBar();

    self._createCancelButton();

    if (self.opt.modal) {
      self.modal = $("<div/>").addClass("dews-progress-modal");
      $(window.document.body).after(self.modal);
    }

    if (self.target) {
      if (self.opt.target === "page" && self.target.height() > self.target.closest("#contents").height()) {
        $target = self.target.closest("#contents");
        $("#" + self.container.attr("id") + ".dews-progress-container").css({
          position: "fixed"
        });
      } else {
        $target = self.target;
        $("#" + self.container.attr("id") + ".dews-progress-container").css({
          position: "absolute"
        });
      }

      if (!self.opt._paging) {
        $("#" + self.container.attr("id") + ".dews-progress-container").offset({
          top: $target.offset().top + $target.outerHeight() / 2 - this.container.height() / 2,
          left: $target.offset().left + $target.outerWidth() / 2 - this.container.width() / 2
        });
      }

      switch (self.opt.position.align) {
        case "center":
          {
            $("#" + self.container.attr("id") + ".dews-progress-container").
            css({
              bottom: "auto"
            }).
            offset({
              top:
              $target.offset().top +
              $target.outerHeight() / 2 -
              this.container.height() / 2 +
              self.opt.position.margin[0] -
              self.opt.position.margin[2],
              left:
              $target.offset().left +
              $target.outerWidth() / 2 -
              this.container.width() / 2 +
              self.opt.position.margin[3] -
              self.opt.position.margin[1]
            });
          }
          break;
        case "bottom":
          {
            $("#" + self.container.attr("id") + ".dews-progress-container").
            css({
              bottom: "auto"
            }).
            offset({
              top:
              $target.offset().top +
              $target.outerHeight() -
              this.container.height() +
              self.opt.position.margin[0] -
              self.opt.position.margin[2] -
              50,
              left:
              $target.offset().left +
              $target.outerWidth() / 2 -
              this.container.width() / 2 +
              self.opt.position.margin[3] -
              self.opt.position.margin[1]
            });
          }
          break;
        case "left":
          {
            $("#" + self.container.attr("id") + ".dews-progress-container").
            css({
              bottom: "auto"
            }).
            offset({
              top:
              $target.offset().top +
              $target.outerHeight() / 2 -
              this.container.height() / 2 +
              self.opt.position.margin[0] -
              self.opt.position.margin[2],
              left:
              $target.offset().left +
              self.opt.position.margin[3] -
              self.opt.position.margin[1] +
              50
            });
          }
          break;
        case "right":
          {
            $("#" + self.container.attr("id") + ".dews-progress-container").
            css({
              bottom: "auto"
            }).
            offset({
              top:
              $target.offset().top +
              $target.outerHeight() / 2 -
              this.container.height() / 2 +
              self.opt.position.margin[0] -
              self.opt.position.margin[2],
              left:
              $target.offset().left +
              $target.outerWidth() -
              this.container.width() +
              self.opt.position.margin[3] -
              self.opt.position.margin[1] -
              50
            });
          }
          break;
        case "top":
          {
            $("#" + self.container.attr("id") + ".dews-progress-container").
            css({
              bottom: "auto"
            }).
            offset({
              top:
              $target.offset().top +
              self.opt.position.margin[0] -
              self.opt.position.margin[2] +
              50,
              left:
              $target.offset().left +
              $target.outerWidth() / 2 -
              this.container.width() / 2 +
              self.opt.position.margin[3] -
              self.opt.position.margin[1]
            });
          }
          break;
        case "left|top":
        case "top|left":
          {
            $("#" + self.container.attr("id") + ".dews-progress-container").
            css({
              bottom: "auto"
            }).
            offset({
              top:
              $target.offset().top +
              self.opt.position.margin[0] -
              self.opt.position.margin[2] +
              50,
              left:
              $target.offset().left +
              self.opt.position.margin[3] -
              self.opt.position.margin[1] +
              50
            });
          }
          break;
        case "right|top":
        case "top|right":
          {
            $("#" + self.container.attr("id") + ".dews-progress-container").
            css({
              bottom: "auto"
            }).
            offset({
              top:
              $target.offset().top +
              self.opt.position.margin[0] -
              self.opt.position.margin[2] +
              50,
              left:
              $target.offset().left +
              $target.outerWidth() -
              this.container.width() +
              self.opt.position.margin[3] -
              self.opt.position.margin[1] -
              50
            });
          }
          break;
        case "left|bottom":
        case "bottom|left":
          {
            $("#" + self.container.attr("id") + ".dews-progress-container").
            css({
              bottom: "auto"
            }).
            offset({
              top:
              $target.offset().top +
              $target.outerHeight() -
              this.container.height() +
              self.opt.position.margin[0] -
              self.opt.position.margin[2] -
              50,
              left:
              $target.offset().left +
              self.opt.position.margin[3] -
              self.opt.position.margin[1] +
              50
            });
          }
          break;
        case "right|bottom":
        case "bottom|right":
          {
            $("#" + self.container.attr("id") + ".dews-progress-container").
            css({
              bottom: "auto"
            }).
            offset({
              top:
              $target.offset().top +
              $target.outerHeight() -
              this.container.height() +
              self.opt.position.margin[0] -
              self.opt.position.margin[2] -
              50,
              left:
              $target.offset().left +
              $target.outerWidth() -
              this.container.width() +
              self.opt.position.margin[3] -
              self.opt.position.margin[1] -
              50
            });
          }
          break;}

    }
  };

  Progress.prototype._createProgressBar = function () {
    var self = this;
    var progressElement = {
      bar: barProgress,
      step: stepProgress,
      circular: circularProgress
    };
    var progressbar = progressElement[self.opt.type]();
    var progress = $("<div id=".concat(self.id, " class=\"dews-ui-progress\">").concat(progressbar, "</div>"));

    progress.insertAfter(self.target);
    self.element = progress;

    function barProgress() {
      return "<div class=\"dews-progress-bar\">";
    }
    function circularProgress() {
      return "<div class=\"dews-progress-circular\">\n            <span class=\"progress-circular-left\">\n              <span class=\"progress-bar\"></span>\n            </span>\n            <span class=\"progress-circular-right\">\n              <span class=\"progress-bar\"></span>\n            </span>\n          </div>";







    }
    function stepProgress() {
      var list = "";
      for (var i = 0; i < 39; i++) {
        list += "<li class=\"dews-progress-steps default\"></li>";
      }
      return "<ul class=\"dews-progress-step\">".concat(list, "</ul>");
    }
  };

  Progress.prototype._createContainer = function () {
    var self = this,
      container;

    container = $("<div/>").
    addClass("dews-progress-container").
    attr("id", self.id + "_container");

    self.element.wrap(container);

    self.container = $("#" + container.attr("id"));

    if (self.opt.type === "step") {
      self.container.addClass("dews-step");
    } else if (self.opt.type === "circular") {
      self.container.addClass("dews-circular");
    }
  };

  Progress.prototype._createWrapper = function () {
    var self = this,
      wrapper;

    wrapper = $("<div/>").
    addClass("dews-progress-wrapper").
    attr("id", self.id + "_wrapper");
    self.element.wrap(wrapper);
  };

  Progress.prototype._createTextTemplate = function () {
    var self = this,
      textTemplate;

    if (self.opt.textTemplate.length !== 0) {
      self.container.addClass("dews-text-template");
      textTemplate = $("<span/>").addClass("dews-progress-text-template");

      self._replaceText("textTemplate");

      textTemplate.html(self.opt.textTemplate);
      textTemplate.addClass(self.opt.textAlign);
      self.element.before(textTemplate);
      self.container.find(".dews-progress-text").remove();
    }
  };

  Progress.prototype._createAlterTextTemplate = function () {
    var self = this,
      alterTextTemplate;

    if (self.opt.alterTextTemplate.length !== 0 && self.opt.textTemplate.length !== 0) {
      alterTextTemplate = $("<span/>").addClass("dews-progress-alter-textTemplate");

      self._replaceText("alterTextTemplate");

      self.container.addClass("dews-text-template");
      alterTextTemplate.addClass(self.opt.alterTextAlign);
      alterTextTemplate.html(self.opt.alterTextTemplate);
      self.element.after(alterTextTemplate);
    }
  };

  Progress.prototype._createTitleBar = function () {
    var self = this,
      title,
      titleBar,
      closeButton,
      close;

    if (self.opt.titlebar) {
      titleBar = $("<div/>").addClass("dews-progress-titlebar");
      title = $("<span/>").addClass("dews-progress-titlebar-text").html(self.opt.titlebar.text);

      self.container.prepend(titleBar);
      titleBar.append(title);

      self.container.addClass("dews-titlebar");
      self.container.addClass("dews-text-template");

      if (self.opt.cancelButton) {
        close = $('<a type="button"/>').addClass("dews-progress-close");
        closeButton = $("<span/>").addClass("dews-progress-close-button");
        titleBar.append(close);
        close.append(closeButton);

        closeButton.on("click", self, _cancelEventHandler);
      }
    }
  };

  Progress.prototype._createCancelButton = function () {
    var self = this,
      buttonGroup,
      button;

    if (self.opt.cancelButton) {
      buttonGroup = $("<div/>").addClass("dews-progress-button-group");
      button = $('<button type="button">취소</button>').addClass("confirm");

      self.container.append(buttonGroup);
      buttonGroup.append(button);

      button = dews.ui.button(button);

      self.container.addClass("dews-cancel-button");

      button.on("click", self, _cancelEventHandler);
    }
  };

  function _cancelEventHandler(e) {
    var self = e.data;
    var evt = new $.Event("cancel", {
      progress: self
    });

    self.element.trigger(evt);
  }

  Progress.prototype._createText = function () {
    var self = this,
      text,
      percent;

    if (self.opt.textTemplate.length === 0) {
      text = $("<span/>").addClass("dews-progress-text");
      percent = $("<span/>").addClass("dews-progress-percent");

      self.element.after(text);
      text.append(percent);
      percent.html(self.opt.current + "%");
    }
  };

  Progress.prototype._replaceText = function (text) {
    var self = this,
      status = null;

    if (/#=\s*progress\s*/i.test(self.opt[text])) {
      if (self.opt["byte"]) {
        status = byteCalculation(self.opt.current) + "/" + byteCalculation(self.opt.total);
      } else {
        status = dews.number.format(self.opt.current, "N") + "/" + dews.number.format(self.opt.total, "N");
      }

      self.opt[text] = self.opt[text].replace(
      /#=\s*progress\s*#/i,
      '<span class="dews-progress-status">' + status + "</span>");

    }

    if (/#=\s*percent\s*/i.test(self.opt[text])) {
      self.opt[text] = self.opt[text].replace(
      /#=\s*percent\s*#/i,
      '<span class="dews-progress-percent">' +
      Math.round(self.opt.current / self.opt.total * 100) +
      "%</span>");

    }
  };

  Progress.prototype.close = function () {
    var self = this;

    if (self.opt.modal) {
      self.modal.remove();
    }

    self.container.remove();
    self.element.removeData("dews-ui-control");
  };

  Progress.prototype.setTextTemplate = function (textTemplate) {
    var self = this;

    self.opt.textTemplate = textTemplate;

    if (self.container.find(".dews-progress-text-template").length === 0) {
      self._createTextTemplate();
    } else {
      self._replaceText("textTemplate");
      self.container.find(".dews-progress-text-template").html(self.opt.textTemplate);
    }
  };

  Progress.prototype.setAlterTextTemplate = function (alterTextTemplate) {
    var self = this;

    self.opt.alterTextTemplate = alterTextTemplate;

    if (self.container.find(".dews-progress-alter-textTemplate").length === 0) {
      self._createAlterTextTemplate();
    } else {
      self._replaceText("alterTextTemplate");
      self.container.find(".dews-progress-alter-textTemplate").html(self.opt.alterTextTemplate);
    }
  };

  Progress.prototype.setTitlebarText = function (title) {
    var self = this;

    self.opt.titlebar = {
      text: title
    };

    if (self.container.find(".dews-progress-titlebar").length === 0) {
      self._createTitleBar();
    } else {
      self.container.find(".dews-progress-titlebar-text").html(self.opt.titlebar.text);
    }
  };

  Progress.prototype.getTotal = function () {
    return this.opt.total;
  };

  Progress.prototype.getCurrent = function () {
    return this.opt.current;
  };

  Progress.prototype.setTotal = function (value) {
    this.opt.total = value;
  };

  Progress.prototype.setCurrent = function (value) {
    var self = this;

    self.opt.current = value;

    if (!isFinite(self.opt.total)) {
      self.close();
      throw "total 값을 설정하지 않습니다.";
    }

    if (self.opt.total <= 0) {
      self.close();
      throw "total 값이 0 또는 음수가 될수는 없습니다.";
    }

    if (self.opt.current > self.opt.total) {
      self.opt.current = self.opt.total;
    }

    var percent = self.opt.current * 100 / self.opt.total;

    self._update(percent);

    if (self.opt.change.length !== 0) {
      self._triggerTextChange(percent);
    }

    $(".dews-progress-percent", self.container).html("".concat(Math.round(percent), "<span>%</span>"));

    if (self.opt["byte"]) {
      $(".dews-progress-status", self.container).html(
      byteCalculation(self.opt.current) + "/" + byteCalculation(self.opt.total));

    } else {
      $(".dews-progress-status", self.container).html(
      dews.number.format(self.opt.current, "N") + "/" + dews.number.format(self.opt.total, "N"));

    }

    if (percent === 100 && self.opt.autoClose) {
      setTimeout(function () {
        self.close();
      }, 300);
    }
  };

  Progress.prototype._initEventListener = function () {
    var self = this;

    $(".dews-progress-close", self.container).on("click", function () {
      self.close();
    });

    $(".dews-progress-button-group .dews-ui-button.confirm", self.container).on("click", function () {
      self.close();
    });

    self.container.on("change", function (e) {
      if (e.current <= self.opt.current) {
        self.opt.mainText = e.text;
        self._replaceText("textTemplate");
        self.container.find(".dews-progress-text-template").html(self.opt.textTemplate);
      }
    });

    $(".dews-progress-titlebar", self.container).on("mousedown", function (ex) {
      document.onmousemove = function (e) {
        self.container.css({
          top: e.pageY + self.container.height() / 2 - ex.offsetY,
          left: e.pageX + self.container.width() / 2 - ex.offsetX
        });
      };

      $(".dews-progress-titlebar", self.container).bind("mouseup", function () {
        document.onmousemove = null;
      });
    });
  };

  Progress.prototype._triggerTextChange = function () {
    var self = this,
      event;

    event = new $.Event("change");

    self.opt.change.call(self, event);
    self.container.trigger(event);
  };

  function byteCalculation(value) {
    var _byte = ["bytes", "KB", "MB", "GB", "TB", "PB"],
      cal;

    if (value >= 0) {
      cal = Math.floor(Math.log(value) / Math.log(1024));

      if (cal.toString() === "-Infinity") {
        return "0 " + _byte[0];
      } else {
        if (_byte[cal] === _byte[0]) {
          return dews.number.format(value / Math.pow(1024, Math.floor(cal)), "N") + " " + _byte[cal];
        } else {
          return dews.number.format(value / Math.pow(1024, Math.floor(cal)), "N2") + " " + _byte[cal];
        }
      }
    }
  }

  Progress.prototype._update = function (percent) {
    var self = this;
    var _update = {
      bar: self._updateBar.bind(self),
      step: self._updateStep.bind(self),
      circular: self._updateCircular.bind(self)
    };
    _update[self.opt.type](percent);
  };

  Progress.prototype._updateStep = function (percent) {
    var self = this,
      percentStep = parseInt(100 / 39 * 100, 10) / 100,
      completeStepCount = Math.floor(percent / percentStep),
      completeStep = self.element.find("li.dews-progress-steps:lt(" + completeStepCount + ")");

    completeStep.removeClass("default").addClass("select");
  };

  Progress.prototype._updateCircular = function (percent) {
    var self = this;
    var rightDegree = percent > 50 ? 180 : percent / 5 * 18;
    $(".dews-progress-circular .progress-circular-right .progress-bar", self.container).css({
      transform: "rotate(" + Math.round(rightDegree) + "deg)"
    });
    if (percent > 50) {
      var leftDegree = (percent - 50) / 5 * 18;
      $(".dews-progress-circular .progress-circular-left .progress-bar", self.container).css({
        transform: "rotate(" + Math.round(leftDegree) + "deg)"
      });
    }
  };

  Progress.prototype._updateBar = function (percent) {
    var self = this;
    $(".dews-progress-bar", self.container).css({
      width: Math.round(percent) + "%"
    });
  };

  Progress.prototype.on = function () {
    var self = this,
      $element = self.element;

    if (arguments[0] === "cancel") {
      $element.on.apply($element, arguments);
    }
  };

  Progress.prototype.off = function () {
    var self = this,
      $element = self.element;

    if (arguments[0] === "cancel") {
      $element.off.apply($element, arguments);
    }
  };

  $.extend(true, dews, {
    ui: {
      progress: function progress(id, options) {
        var progress, $element;

        if (!id) {
          throw "프로그래스바의 ID가 지정되지 않았습니다.";
        }

        $element = $("#" + id);

        if ($element.length === 0) {
          progress = new Progress(id, options);

          progress.element.data("dews-control", progress);
        } else {
          progress = $element.data("dews-control");

          if (!progress) {
            throw "'" + id + "' 는 프로그래스바의 ID가 아닙니다.";
          }
        }
        return progress;
      }
    }
  });
})(jQuery, window.dews, window.kendo);


/*
 * QR코드
 */
(function ($, dews, kendo) {
  var defaultOptions = {
    encoding: "utf-8"
  };

  /**
   * QR코드 생성을 위한 옵션을 가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   * @param {object} srcOptions 소스코드에서 전달된 옵션
   * @returns {object} 옵션
   */
  function getOptions($el, srcOptions) {
    var inlineOptions,
      options = {};

    inlineOptions = getInlineOptions($el);

    $.extend(true, options, defaultOptions, inlineOptions, srcOptions);

    return options;
  }

  // 사이즈 변경(min : 25)
  kendo.dataviz.ui.QRCode.fn.resize = function (size) {
    var self = this,
      $element = self.element;

    if ($.type(size) !== "undefined") {
      self.options.size = size;
      self.redraw();
    }
  };

  /**
   * HTML 코드 상에 설정된 옵션 정보를 가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   * @returns {object} 옵션
   */
  function getInlineOptions($el) {
    var options = {},
      size,
      color,
      value,
      borderColor,
      borderWidth,
      padding;

    size = $el.data("dews-size");
    color = $el.data("dews-color");
    value = $el.data("dews-value");
    borderColor = $el.data("dews-border-color");
    borderWidth = $el.data("dews-border-width");
    padding = $el.data("dews-padding");

    if (size) {
      options.size = parseInt(size, 10);
    }
    if (color) {
      options.color = color;
    }
    if (value) {
      options.value = encodeURI(value);
    }
    if (borderColor || borderWidth) {
      options.border = {};
      if (borderColor) {
        options.border.color = borderColor;
      }
      if (borderWidth) {
        options.border.width = parseInt(borderWidth, 10);
      }
    }
    if (padding) {
      options.padding = parseInt(padding, 10);
    }

    return options;
  }

  /**
   * QR코드의 value 함수를 재정의합니다.
   * @params {string} value
   */
  kendo.dataviz.ui.QRCode.fn.value = function (value) {
    var that = this;
    if (value === undefined) {
      return that._value;
    }
    if (that.element.data("dews-control")) {
      that._value = encodeURI(value) + "";
    } else {
      that._value = value + "";
    }

    that.redraw();
  };

  $.extend(true, dews, {
    ui: {
      qrcode: function qrcode(selector, options) {
        var $ctl, qrcode;

        if (selector instanceof jQuery) {
          $ctl = selector;
        } else if ($.type(selector) === "string") {
          $ctl = $(selector);
        } else {
          throw "QR코드를 생성할 대상이 제공되지 않았습니다.";
        }

        $ctl.each(function () {
          var $this = $(this),
            opt;

          qrcode = $this.data("dews-control");

          if (!qrcode) {
            opt = getOptions($this, options);

            $this.kendoQRCode(opt);

            if (!$this.hasClass("dews-ui-qrcode")) {
              $this.addClass("dews-ui-qrcode");
            }
            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            qrcode = $this.data("kendoQRCode");

            $this.data("dews-control", qrcode);
          }
        });

        return qrcode;
      }
    }
  });

  dews.ui.addControlInitializer("qrcode", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.qrcode($("span.dews-ui-qrcode", $container));
  });
})(jQuery, window.dews, window.kendo);


/**
 * 라디오 버튼
 */
(function ($, dews, kendo) {
  function RadioButton(selector) {
    var self = this;
    self.target = selector;

    self._createLabel();

    self._setClass();
  }

  RadioButton.prototype._setClass = function () {
    var self = this,
      $this = self.target;

    if (!$this.hasClass("dews-control")) {
      $this.addClass("dews-control");
    }

    if (!$this.hasClass("dews-ui-radio")) {
      $this.addClass("dews-ui-radio");
    }

    if (!$this.hasClass("k-radio")) {
      $this.addClass("k-radio");
    }

    if (!$this.hasClass("dews-control-activate")) {
      $this.addClass("dews-control-activate");
    }
  };

  RadioButton.prototype._createLabel = function () {
    var self = this,
      $label = $('<label class="dews-radio-label k-radio-label"></label>');
    var $textLabel,
      context = undefined,
      clickedLabel = undefined;

    self.target.wrap('<span class="dews-radio-wrapper"/>');
    self.target.after($label);

    $textLabel = self.target.parent().siblings("label[for=" + self.target.attr("id") + "]");
    if ($textLabel[0] && $textLabel.data("dews-localize-key")) {
      $textLabel.text(
      dews.localize.get(
      $textLabel.text(),
      $textLabel.data("dews-localize-key"),
      $textLabel.data("dews-localize-lang") || null));


    }

    $label.on("click", function () {
      self.target.click();
    });

    $textLabel.on("click", function (e) {
      e.preventDefault();
    });

    if (dews.ui.dialogPage) {
      context = $(dews.ui.dialogPage.$content[0]);
    } else if (dews.ui.page) {
      context = $(dews.ui.page.$content[0]);
    } else {
      context = self.target.parents("div.container");
    }

    if (context !== undefined && context.find("label[for=" + self.target.attr("id") + "]")[0] !== undefined) {
      // for 로 연결되어 있는 label
      clickedLabel = context.find("label[for=" + self.target.attr("id") + "]");
    } else if (context !== undefined && self.target.parent().next("label")[0] !== undefined) {
      // for 없이 체크박스 뒤에 오는 label
      clickedLabel = self.target.parent().next("label");
    } else if (context !== undefined && self.target.parent().prev("label")[0] !== undefined) {
      // for 없이 체크박스 앞에 오는 label
      clickedLabel = self.target.parent().prev("label");
    }

    if (clickedLabel !== undefined) {
      clickedLabel.on("click", function () {
        context.find("#" + self.target.attr("id")).click();
      });
    }
  };

  RadioButton.prototype.focus = function () {
    var self = this;

    self.target.focus();
  };

  RadioButton.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change", "click"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        $(self.target).trigger(event);
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  RadioButton.prototype.on = function () {
    var self = this;

    self.target.on.apply(self.target, arguments);
  };

  RadioButton.prototype.off = function () {
    var self = this;

    self.target.off.apply(self.target, arguments);
  };

  RadioButton.prototype.applyPanelFocus = function () {
    var self = this,
      $element = $(self.target);

    $element.on("keydown", function (e) {
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && $element.is(":enabled")) {
        var evt = new $.Event("nextFocus");
        evt.control = self;

        $element.trigger(evt);
      } else if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();

        var evt = new $.Event("beforeFocus");
        evt.control = self;

        $element.trigger(evt);
      } else if (e.keyCode === 9 || e.keyCode === 13 && $element.is(":enabled")) {
        if (e.keyCode === 9) {
          //tab키 기본동작 막기
          e.preventDefault();
        }
        var evt = new $.Event("nextFocus");
        evt.control = self;

        $element.trigger(evt);
      }
    });
  };

  RadioButton.prototype.focus = function () {
    var self = this,
      $element = $(self.target);

    $element.focus();
  };

  RadioButton.prototype.canFocusable = function () {
    var self = this,
      $element = $(self.target);

    return $element.is(":enabled") && $element.is(":visible");
  };

  /**
   * 라디오버튼 컨트롤 자동화 인쇄 관련 데이터 추출
   * @return {*} 값이 설정 된 경우 Object 반환, 없는 경우 undefined 반환
   * @private
   */
  RadioButton.prototype._getPrintData = function () {
    var self = this,
      $el = $(self.target),
      radioLabel =
      $el.closest(".dews-radio-wrapper").next()[0] === undefined ?
      "" :
      $el.closest(".dews-radio-wrapper").next()[0].tagName,
      data;

    if ($el.is(":checked")) {
      data = {
        id: $el.attr("id"),
        text: radioLabel.toLowerCase() === "label" ? $el.closest(".dews-radio-wrapper").next().text() : ""
      };
    }

    return data;
  };

  RadioButton.prototype.check = function (value) {
    var self = this,
      $el = $(self.target),
      checked;

    checked = $el.is(":checked");

    if (typeof value !== "undefined") {
      if (value === true) {
        $el.prop("checked", true);
        if (checked === false) {
          $el.trigger("change");
        }
      } else if (value === false) {
        $el.prop("checked", false);
        if (checked !== false) {
          $el.trigger("change");
        }
      }
    } else {
      return checked;
    }
  };

  RadioButton.prototype.disable = function (value) {
    var self = this,
      $el = $(self.target),
      disable;

    disable = $el.prop("disabled");

    if (typeof value !== "undefined") {
      if (value === true) {
        $el.prop("disabled", true);
      } else if (value === false) {
        $el.prop("disabled", false);
      }
    } else {
      return disable;
    }
  };

  $.extend(true, dews, {
    ui: {
      /**
       * 라디오버튼을 생성하거나 가져옵니다.
       * @param {string|jQuery} selector 요소를 지정하는 셀렉터 또는 jQuery 객체입니다.
       */
      radio: function radio(selector) {
        var $el, rdo;

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector);
        }

        $el.each(function () {
          var $this = $(this),
            rdoBtn;

          rdoBtn = $this.data("dews-control");

          if (!rdoBtn) {
            rdoBtn = new RadioButton($this);
            if (!$this.hasClass("dews-form-control")) {
              $this.addClass("dews-form-control");
            }
            $this.data("dews-control", rdoBtn);
          }

          rdo = rdoBtn;
        });

        return rdo;
      }
    }
  });

  dews.ui.addControlInitializer("radio", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.radio($("input[type='radio'].dews-ui-radio", $container));
  });
})(jQuery, window.dews, window.kendo);


/**
 * 라디오 버튼 그룹
 */
(function ($, dews, kendo) {
  var defaultOptions = {
    align: "horizontal"
  };

  /**
   * 설정 값을  가져옵니다.
   * @param $el 대상 jQuery 요소
   * @param opt 라디오그룹 옵션
   * @returns {{object}} 옵션
   */
  function getOptions($el, opt) {
    var $element = $el,
      options = {},
      inlineOptions = {};

    if ($element.data("dews-align") && $element.data("dews-align") === "vertical") {
      inlineOptions.align = "vertical";
    }

    options = $.extend(true, options, defaultOptions, inlineOptions, opt);

    return options;
  }

  /**
   * 라디오그룹 객체
   * @param $el 라디오그룹 생성 대상 요소
   * @param opt 라디오그룹 옵션
   * @constructor
   */
  function RadioGroup($el, opt) {
    var self = this,
      options;

    options = getOptions($el, opt);

    self._element = $el;
    self.items = [];
    self.options = options;

    self._initRadioGroup();
  }

  /**
   * 라디오그룹을 초기화합니다.
   * @private
   */
  RadioGroup.prototype._initRadioGroup = function () {
    var self = this;
    var $el = self._element;

    if (!$el.hasClass("dews-control")) {
      $el.addClass("dews-control");
    }
    if (!$el.hasClass("dews-ui-radio-group")) {
      $el.addClass("dews-ui-radio-group");
    }
    if (!$el.hasClass("dews-control-activate")) {
      $el.addClass("dews-control-activate");
    }

    // wrapper 생성
    var $wrapper = $("<span/>").addClass("dews-radio-group-wrapper");

    // 라디오 그룹 말줄임 표시 처리
    if (dews._environments.useLabelOverflow === "2") {
      $wrapper.addClass("ellipsis");
    }

    $el.wrap($wrapper);
    self._wrapper = $el.parent();

    if (self.options.align === "vertical") {
      self._wrapper.addClass("vertical");
    }

    // 라디오버튼 생성
    var radioName = self._element.attr("id");
    $el.find("option").each(function (index, item) {
      var radioButtonItem;
      radioButtonItem = new RadioGroupItem(item, radioName, self);

      self.items.push(radioButtonItem);
      self._wrapper.append(radioButtonItem._inputItem);
    });

    if (self._element.attr("disabled")) {
      self.disable(true);
    }

    self.setUserGuideAPI();
  };

  /**
   * 라디오그룹아이템 객체
   * @param item 라디오그룹 아이템 객체 생성 대상 요소
   * @param buttonName 라디오그룹 아이템 공통 name
   * @param radioGroup 라디오그룹 객체
   * @returns {RadioGroupItem} 라디오그룹 아이템 객체
   * @constructor
   */
  function RadioGroupItem(item, buttonName, radioGroup) {
    var self = this;
    var radioButton;
    self.radiogroup = radioGroup;
    self.buttonName = buttonName;

    radioButton = self._initRadioItem(item);
    self._optionItem = $(item);
    self._inputItem = radioButton;

    self._bindEvent();

    return self;
  }

  /**
   * 라디오그룹 아이템을 초기화합니다
   * @param item 라디오그룹 아이템 객체 대상 요소
   * @returns {*}
   * @private
   */
  RadioGroupItem.prototype._initRadioItem = function (item) {
    var self = this;
    var $radioButtonInput, $radioButton, $label;

    var disabledOption = false;
    var selectedOption = false;
    var labelText = item.innerText;

    if ($(item).attr("disabled") || $(item).attr("disabled") === true) {
      disabledOption = true;
    }

    if ($(item).attr("selected") || $(item).attr("selected") === true) {
      selectedOption = true;
      $(item).attr("selected", true);
      self.radiogroup.checkedButton = item;
    }

    if ($(item).data("dews-localize-key")) {
      labelText = dews.localize.get(
      item.innerText,
      $(item).data("dews-localize-key"),
      $(item).data("dews-localize-lang") || null);

    }

    $radioButtonInput = $('<input type="radio"/>').attr({
      name: self.buttonName,
      value: $(item).attr("value"),
      disabled: disabledOption,
      checked: selectedOption
    });
    $label = $("<span>" + labelText + "</span>");
    $radioButton = $("<label>").addClass("dews-radio-group-item").append($radioButtonInput, "<span/>", $label);

    // 말줄임 표시에 tooltip 표시
    $label.on("mouseenter", function (e) {
      var targetLabel = e.currentTarget;
      if (targetLabel.scrollWidth > targetLabel.offsetWidth) {
        if (!$(targetLabel).attr("title")) {
          $(targetLabel).attr("title", targetLabel.innerText);
        }
      }
    });

    return $radioButton;
  };

  /**
   * 라디오그룹 아이템의 event를 등록합니다.
   * @private
   */
  RadioGroupItem.prototype._bindEvent = function () {
    var self = this;
    var itemValue;
    var $radioGroup = self.radiogroup._element;
    var $wrapper = self.radiogroup._wrapper;
    var $select;

    self._inputItem.children("input").on("click", function (e, changeFlag) {
      changeFlag = changeFlag === undefined ? true : changeFlag; // change Event 발생 여부

      if (self._inputItem.children().attr("disabled")) {
        return;
      }
      itemValue = self._inputItem.children().attr("value");

      $.each($radioGroup.find("option"), function (idx, item) {
        if ($(item).attr("value") === itemValue) {
          $select = $(item);
          $select.attr("selected", true);
          return false;
        }
      });

      if (self.radiogroup.checkedButton && itemValue !== $(self.radiogroup.checkedButton).attr("value")) {
        $(self.radiogroup.checkedButton).attr("selected", false);

        if ($(self.radiogroup.checkedButton).attr("value") === "") {
          $wrapper.find('input[value=""]').attr("checked", false);
        } else {
          $wrapper.
          find("input[value=" + $(self.radiogroup.checkedButton).attr("value") + "]").
          attr("checked", false);
        }
      }
      self.radiogroup.checkedButton = $select.get(0);
      changeFlag ? self._inputItem.trigger("_change") : "";
    });
  };

  /**
   * 라디오버튼 그룹 버튼 아이템 추가합니다.
   * @param value 생성할 버튼 아이템의 value 설정 값
   * @param text 생성할 버튼 아이템의 text 설정 값
   */
  RadioGroup.prototype.add = function (value, text) {
    var self = this;
    var $el = self._element;
    var $wrapper = self._wrapper;
    var addButton, addValue, addText;

    if ($.type(value) === "string" && text) {
      addValue = value;
      addText = text;
    } else if ($.type(value) === "object" && !text) {
      addValue = value.value;
      addText = value.text;
    }

    var addObject = $("<option value=" + addValue + ">" + addText + "</option>");
    var buttonName = $wrapper.find(".dews-ui-radio-group").attr("id");

    addButton = new RadioGroupItem(addObject[0], buttonName, self);

    self.items.push(addButton);

    $el.append(addButton._optionItem);
    $wrapper.append(addButton._inputItem);
  };

  /**
   * 라디오버튼 그룹 버튼 아이템을 중간에 추가합니다.
   * @param index 생성할 버튼 아이템이 입력될 위치
   * @param value 생성할 버튼 아이템의 value 설정 값
   * @param text 생성할 버튼 아이템의 text 설정 값
   */
  RadioGroup.prototype.insert = function (index, value, text) {
    var self = this;
    var $el = self._element;
    var $wrapper = self._wrapper;
    var insertButton, insertValue, insertText;

    if (!index) {
      return;
    }

    if ($.type(value) === "string" && text) {
      insertValue = value;
      insertText = text;
    } else if ($.type(value) === "object" && !text) {
      insertValue = value.value;
      insertText = value.text;
    }

    var insertObject = $("<option value=" + insertValue + ">" + insertText + "</option>");
    var buttonName = $wrapper.find(".dews-ui-radio-group").attr("id");

    insertButton = new RadioGroupItem(insertObject[0], buttonName, self);

    self.items.splice(index, 0, insertButton);

    $el.find("option").eq(index).before($(insertButton._optionItem));
    $wrapper.find(".dews-radio-group-item").eq(index).before($(insertButton._inputItem));
  };

  /**
   * 라디오그룹 아이템 삭제합니다.
   * @param value 삭제할 버튼 아이템의 위치
   */
  RadioGroup.prototype.remove = function (value) {
    var self = this;

    if ($.type(value) === "number") {
      self.items[value].remove();
    }

    if ($.type(value) === "object") {
      var $items = $(self.items);
      $items.each(function (index, item) {
        if (item === value) {
          item.remove();
        }
      });
    }
  };

  /**
   * 라디오그룹 내 value에 해당하는 item 객체를 가져옵니다.
   * @param value 조회할 item 객체의 value 값
   * @returns {object} 라디오그룹 아이템 객체
   */
  RadioGroup.prototype.getByValue = function (value) {
    var self = this;
    var $el = self._element;
    var $resultItem;

    $el.find("option").each(function (index, item) {
      var $item = $(item);
      if ($item.attr("value") === value) {
        $resultItem = $item;
      }
    });

    return $resultItem;
  };

  /**
   * 라디오그룹 내 선택된 아이템의 value 값을 조회하거나 설정합니다.
   * @param value 선택된 버튼 아이템에 설정할 value 값
   * @returns {string} 선택된 버튼 아이템의 value 값
   */
  RadioGroup.prototype.value = function (value) {
    var self = this;
    var $el = self._element;
    var $wrapper = self._wrapper;
    var resultItem;

    if ($.type(value) === "undefined") {
      $el.find("option").each(function (index, item) {
        if ($(item).attr("selected") === "selected") {
          resultItem = $(item).attr("value");
        }
      });
      return resultItem;
    } else {
      $el.find("option:selected").attr("value", value);
      $wrapper.find("input:checked").attr("value", value);
    }
  };

  /**
   * 라디오그룹 내 아이템을 선택합니다.
   * @param index 선택할 아이템의 index 값
   */
  RadioGroup.prototype.select = function (value, changeFlag) {
    var self = this;

    if ($.type(value) === "string") {
      for (var i = 0; i < self.items.length; i++) {
        if (self.items[i].value() === value) {
          self.items[i].select(changeFlag);
        }
      }
    } else if ($.type(value) === "number") {
      if (self.items.length > value) {
        self.items[value].select(changeFlag);
      }
    }
  };

  /**
   * 라디오그룹의 disabled 여부를 조회하거나 설정합니다.
   * @param boolean disabled를 설정할 boolean 값
   * @returns {boolean} 라디오그룹의 disabled 여부
   */
  RadioGroup.prototype.disable = function (_boolean18) {
    var self = this;
    var $items = $(self.items);

    if ($.type(_boolean18) === "undefined") {
      return self._element.attr("disabled");
    }

    if ($.type(_boolean18) === "boolean") {
      self._element.attr("disabled", _boolean18);
      $items.each(function (index, item) {
        item.disable(_boolean18);
      });
    }
  };

  RadioGroup.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change", "click"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "change") {
          self._wrapper.trigger("_change");
        } else {
          self._wrapper.trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  /**
   * 라디오그룹 on 이벤트 등록합니다.
   */
  RadioGroup.prototype.on = function () {
    var self = this;
    var $wrapper = self._wrapper;

    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    }
    $wrapper.on.apply($wrapper, arguments);
  };

  RadioGroup.prototype.off = function () {
    var self = this;
    var $wrapper = self._wrapper;

    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    }
    $wrapper.off.apply($wrapper, arguments);
  };

  RadioGroup.prototype.bindFromPanel = function (data) {
    var self = this,
      $element = self._element;
    var column;

    if (data) {
      column = $element.data("dews-bind-column") || $element.attr("id");

      if (column && data.hasOwnProperty(column)) {
        var $items = $(self.items);

        $items.each(function (index, item) {
          if (item._optionItem.attr("value") === data[column]) {
            self.checkedButton = item._optionItem[0];
            item._optionItem.attr("selected", true);
          } else {
            item._optionItem.attr("selected", false);
          }
          if (item._inputItem.children().attr("value") === data[column]) {
            item._inputItem.children().prop("checked", true);
          } else {
            item._inputItem.children().prop("checked", false);
          }
        });
      }
    }
  };

  RadioGroup.prototype.serializeForPanel = function () {
    var self = this,
      $element = self._element;
    var column;
    var data;

    column = $element.data("dews-bind-column") || $element.attr("id");

    if (column) {
      data = {};
      data[column] = "";

      $element.find("option").each(function (index, item) {
        if ($(item).attr("selected")) {
          data[column] = $(item).attr("value");
        }
      });
    }
    return data;
  };

  RadioGroup.prototype.applyPanelFocus = function () {
    var self = this,
      $element = self._element;

    $element.parent().on("keydown", function (e) {
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && $element.is(":enabled")) {
        e.preventDefault();
      } else if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();

        var evt = new $.Event("beforeFocus");
        evt.control = self;

        $element.trigger(evt);
      } else if (e.keyCode === 9 || e.keyCode === 13 && $element.is(":enabled")) {
        if (e.keyCode === 9) {
          //tab키 기본동작 막기
          e.preventDefault();
        }

        var evt = new $.Event("nextFocus");
        evt.control = self;

        $element.trigger(evt);
      }
    });
  };

  RadioGroup.prototype.focus = function () {
    var self = this,
      $element = self._element;

    if ($element.parent().find("input:checked").length > 0) {
      $element.parent().find("input:checked").focus();
    } else {
      $element.parent().find("input").eq(0).focus();
    }
  };

  RadioGroup.prototype.canFocusable = function () {
    var self = this,
      $element = self._element;
    return $element.is(":enabled") && $element.closest(".dews-radio-group-wrapper").is(":visible");
  };

  RadioGroup.prototype.setUserGuideAPI = function () {
    var self = this,
      $element = self._element;
    $element.on("focus", function () {
      if (dews.ui.page && dews.ui.page.hasUserGuide) {
        if ($.isFunction(dews.ui.page.focusGuideItem) && $element.attr("id")) {
          dews.ui.page.focusGuideItem("#" + $element.attr("id"));
        }
      }
    });
  };

  /**
   * 라디오그룹 아이템 객체를 삭제합니다.
   */
  RadioGroupItem.prototype.remove = function () {
    var self = this;

    self._optionItem.remove();
    self._inputItem.remove();

    var items = self.radiogroup.items;

    $(items).each(function (index, item) {
      if (item === self) {
        items.splice(index, 1);
      }
    });
  };

  /**
   * 라디오그룹 아이템 객체를 선택합니다.
   */
  RadioGroupItem.prototype.select = function (changeFlag) {
    var self = this;

    self._inputItem.children("input").trigger("click", changeFlag);
  };

  /**
   * 라디오그룹 아이템 객체를 비활성화시킵니다.
   * @param boolean 비활성화 유무 값
   */
  RadioGroupItem.prototype.disable = function (_boolean19) {
    var self = this;

    if ($.type(_boolean19) === "undefined") {
      return self._optionItem.attr("disabled");
    }
    if ($.type(_boolean19) === "boolean") {
      if (_boolean19) {
        self._inputItem.addClass("disabled");
      } else {
        self._inputItem.removeClass("disabled");
      }
      self._optionItem.attr("disabled", _boolean19);
      self._inputItem.children().attr("disabled", _boolean19);
    }
  };

  /**
   * 라디오그룹 아이템의 value 값을 조회하거나 설정합니다.
   * @param value 아이템에 설정할 value 값
   */
  RadioGroupItem.prototype.value = function (value) {
    var self = this;

    if ($.type(value) === "undefined") {
      return self._optionItem.context.value;
    } else {
      self._optionItem.attr("value", value);
      self._inputItem.children().attr("value", value);
    }
  };

  /**
   * 라디오그룹 아이템의 text 값을 조회하거나 설정합니다.
   * @param value 아이템에 설정할 text 값
   */
  RadioGroupItem.prototype.text = function (text) {
    var self = this;

    if ($.type(text) === "undefined") {
      return self._optionItem.text();
    } else {
      self._optionItem.text(text);
      self._inputItem.find("span:last-child").text(text);
    }
  };

  /**
   * 기간피커 컨트롤 자동화 인쇄 관련 데이터 추출
   * @return {*} 값이 설정 된 경우 Object 반환, 없는 경우 undefined 반환
   * @private
   */
  RadioGroup.prototype._getPrintData = function () {
    var self = this,
      $el = self._element,
      data;

    if (self.getByValue(self.value()).text()) {
      data = {
        id: $el.attr("id"),
        text: self.getByValue(self.value()).text()
      };
    }

    return data;
  };

  $.extend(true, dews, {
    ui: {
      /**
       * 라디오그룹을 생성하거나 가져옵니다
       * @param {string|jQuery} selector 요소를 지정하는 셀렉터 또는 jQuery 객체입니다.
       * @returns {*}
       */
      radiogroup: function radiogroup(selector, options) {
        var $el, radiogroup;

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector);
        }

        $el.each(function () {
          var $this = $(this),
            radiobuttongroup;

          radiobuttongroup = $this.data("dews-control");

          if (!radiobuttongroup) {
            if (!$this.hasClass("dews-form-control")) {
              $this.addClass("dews-form-control");
            }

            radiobuttongroup = new RadioGroup($this, options);
            $this.data("dews-control", radiobuttongroup);
          }
          radiogroup = radiobuttongroup;
        });
        return radiogroup;
      }
    }
  });

  dews.ui.addControlInitializer("radiogroup", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.radiogroup($("select.dews-ui-radio-group", $container));
  });
})(jQuery, window.dews, window.kendo);


/*
 * 참고 박스
 */
(function ($, dews) {
  var defaultOptions = {
    title: "",
    subTitle: "",
    iconTitle: true,
    titleType: "default",
    button: false,
    closed: false
  };

  function getOptions($el) {
    var $element = $el;
    return {
      title: $element.data("dews-title") || $element.data("dews-main-title") || defaultOptions.title,
      subTitle: $element.data("dews-sub-title") || defaultOptions.subTitle,
      iconTitle:
      typeof $element.data("dews-icon-title") === "undefined" ?
      defaultOptions.iconTitle :
      $element.data("dews-icon-title"),
      titleType: $element.data("dews-title-type") || defaultOptions.titleType,
      button: $element.data("dews-button") || defaultOptions.button,
      closed: $element.data("dews-closed") || defaultOptions.closed
    };
  }

  /**
   * 참고박스를 생성합니다.
   * @constructor
   */
  var ReferBox = function ReferBox($element) {
    var self = this;
    var options = getOptions($element);

    self.target = $element;
    self.options = options;

    self.initialize();
    self.setStyle();
  };

  ReferBox.prototype.initialize = function () {
    var self = this;

    if (self.options.title || self.options.subTitle) {
      self._createTitle();
      self._createSubTitle();
      self._createBtn();
      self._initEventListener();
      return;
    }

    if (self.target.find(">dl").is(":only-child")) {
      // 지원 중단 시 제거 조건
      self._createDtBtn();
      self._initEventListener();
      return;
    }

    self.target.addClass("no-title");
  };

  ReferBox.prototype.setStyle = function () {
    var self = this;

    if (dews._environments.referBoxStyleTp === "1") {
      self.target.addClass("oldstyle");
    }

    if (!self.options.iconTitle) {
      self.target.addClass("no-icon");
    }

    if (self.options.titleType === "separate") {
      self.target.addClass("separate-title");
    }
  };

  // dt 선언 중단시 삭제 함수
  ReferBox.prototype._createDtBtn = function () {
    var self = this,
      $titleElement = self.target.find("dt");

    if ($titleElement.length) {
      if (!self.target.hasClass("no-button")) {
        $titleElement.append('<button type="button"></button>');
      }
    }
  };

  /**
   * 타이틀을 생성합니다.
   * @private
   */
  ReferBox.prototype._createTitle = function () {
    var self = this;
    var $titleElement = $("<div></div>").addClass("dews-referbox-title");
    var titleText = self.options.title;

    self.target.wrapInner('<div class="dews-referbox-content">');
    self.target.prepend($titleElement);

    if (!titleText) {
      return;
    }

    if (self.target.data("dews-localize-key")) {
      titleText = dews.localize.get(
      titleText,
      self.target.data("dews-localize-key"),
      self.target.data("dews-localize-lang") || null);

    }
    $titleElement.append("<span>".concat(titleText, "</span>"));
  };

  ReferBox.prototype._createSubTitle = function () {
    var self = this;
    var $titleElement = $(".dews-referbox-title", self.target);
    var subTitleText = self.options.subTitle;

    if (!subTitleText) {
      return;
    }

    if (self.target.data("dews-sub-localize-key")) {
      subTitleText = dews.localize.get(
      subTitleText,
      self.target.data("dews-sub-localize-key"),
      self.target.data("dews-sub-localize-lang") || null);

    }
    var subTitle = "<span class=\"dews-referbox-subtitle\">".concat(subTitleText, "</span>");
    $titleElement.append(subTitle);
  };

  /**
   * 타이틀에 버튼을 생성합니다.
   * @private
   */
  ReferBox.prototype._createBtn = function () {
    var self = this,
      $titleElement = self.target.find(".dews-referbox-title");

    if ($titleElement.length) {
      if (self.options.button) {
        $titleElement.append('<button type="button"></button>');
        self.target.find(".dews-referbox-content").addClass("folding");
        if (self.options.closed) {
          self.target.addClass("closed");
        }
      }
    }
  };

  /**
   * 버튼에 열림닫힘 이벤트를 설정합니다.
   * @private
   */
  ReferBox.prototype._initEventListener = function () {
    var self = this,
      evt;

    self.target.
    find("button").
    first().
    on("click", function () {
      self.target.toggleClass("closed");
      evt = self.target.hasClass("closed") ? new $.Event("close") : new $.Event("open");
      self.target.trigger(evt);
    });
  };

  ReferBox.prototype.on = function () {
    var self = this,
      target = self.target;

    target.on.apply(target, arguments);
  };

  ReferBox.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["open", "close", "click"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        self.target.trigger(event);
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  dews = $.extend(true, dews, {
    ui: {
      referbox: function referbox(selector) {
        var $control, box;

        if (selector instanceof jQuery) {
          $control = selector;
        } else if ($.type(selector) === "string") {
          $control = $(selector);
        } else {
          throw "대상이 지정되지 않았습니다.";
        }

        $control.each(function () {
          var $this = $(this),
            referbox;

          referbox = $this.data("dews-control");

          if (!referbox) {
            referbox = new ReferBox($this);
            $this.data("dews-control", referbox);

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }
          }

          box = referbox;
        });
        return box;
      }
    }
  });

  dews.ui.addControlInitializer("referbox", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.referbox($(".dews-ui-referbox", $container));
  });
})(jQuery, window.dews || {});


/*
 * 필수툴팁
 */
(function ($, dews) {
  function RequiredTooltip($el, options) {
    var self = this;

    self.target = $el;
    self.options = options;
    self.tooltip = null;
  }

  RequiredTooltip.prototype._create = function () {
    var self = this,
      tooltip;

    // 필수 툴팁 텍스트 옵션 전달
    tooltip = dews.ui.tooltip.show(self.target, {
      type: "required",
      text: self.options
    });

    // requiredTooltip이 있는 위치로 스크롤해준다.
    /*$('html,body').animate({scrollTop: self.target.offset().top-100}, 100);*/

    self.tooltip = tooltip;
  };

  //requiredTooltip이 존재하는 경우 삭제해준다.
  RequiredTooltip.prototype._delete = function () {
    var self = this;

    self.tooltip._delete();
  };

  dews = $.extend(true, dews, {
    ui: {
      requiredTooltip: {
        show: function show(selector, options) {
          var $el, tooltip;

          if (selector instanceof jQuery) {
            $el = selector;
          } else if ($.type(selector) === "string") {
            $el = $(selector);
          } else {
            throw "대상이 지정되지 않았습니다.";
          }

          $el.each(function () {
            var $this = $(this);

            tooltip = $this.data("dews-ui-requiredTooltip");
            if (tooltip) {
              tooltip._delete();
            }

            tooltip = new RequiredTooltip($this, options);
            tooltip._create();

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            $this.data("dews-ui-requiredTooltip", tooltip);
          });

          return tooltip;
        }
      }
    }
  });
})(jQuery, window.dews || {});


/**
 * 스케줄러 컴포넌트
 */
(function ($, dews, kendo) {
  /**
   * 기본 옵션
   * @type {SchedulerOptions}
   */
  var defaultOptions = {
    initHolidayCheck: false,
    autoBind: true,
    views: [
    {
      type: "month",
      title: "월",
      selectedDateFormat: "{0:" + dews._environments.formats.monthFormat + "}"
    }],

    mapping: {
      title: "title",
      taskId: "taskId",
      start: "start",
      end: "end",
      isAllDay: "isAllDay",
      description: "description",
      recurrenceId: "recurrenceId",
      recurrenceRule: "recurrenceRule",
      recurrenceException: "recurrenceException"
    },
    eventTemplate: "<div>" + '<div class="k-event-template">#:title#</div>' + "</div>",
    holidays: true,
    calendar: "1"
  };

  /**
   * 옵션을 가져옵니다.
   *
   * @param {$element} $el jquery 요소
   * @param {SchedulerOptions} options 옵션
   * @return {{}}
   */
  function getOptions($el, options) {
    var opt = {},
      dsOpt;

    opt = $.extend(true, opt, defaultOptions, options);
    var containerPanel;

    // height 설정
    if ($el.parent().parent().hasClass("dews-ui-container-panel")) {
      containerPanel = $el.parent().parent();

      if (containerPanel.data("dews-fit-bottom")) {
        dews.ready(function () {
          $el.css("height", "");
        });
      }
    }

    opt.messages = {
      allDay: dews.localize.get("하루 종일", "dews_하루 종일"),
      today: dews.localize.get("오늘", "dews_오늘"),
      destroy: dews.localize.get("삭제", "dews_삭제"), //삭제 버튼 메시지
      next: dews.localize.get("다음", "dews_다음"), //다음 버튼 메시지
      previous: dews.localize.get("이전", "dews_이전"), //이전 버튼 메시지
      editor: {
        editorTitle: dews.localize.get("일정", "dews_일정"),
        allDayEvent: dews.localize.get("하루 종일", "dews_하루 종일"),
        description: dews.localize.get("설명", "dews_설명"),
        end: dews.localize.get("종료", "dews_종료"),
        start: dews.localize.get("시작", "dews_시작"),
        repeat: dews.localize.get("반복", "dews_반복"),
        title: dews.localize.get("제목", "dews_제목")
      },
      recurrenceEditor: {
        frequencies: {
          never: dews.localize.get("없음", "dews_없음"),
          daily: dews.localize.get("매일", "dews_매일"),
          monthly: dews.localize.get("매달", "dews_매달"),
          weekly: dews.localize.get("매주", "dews_매주"),
          yearly: dews.localize.get("매년", "dews_매년")
        },
        daily: {
          interval: dews.localize.get("일", "dews_일"),
          repeatEvery: dews.localize.get("반복간격", "dews_반복간격")
        },
        weekly: {
          interval: dews.localize.get("주", "dews_주"),
          repeatEvery: dews.localize.get("반복간격", "dews_반복간격"),
          repeatOn: dews.localize.get("반복주기", "dews_반복주기")
        },
        monthly: {
          day: dews.localize.get("선택일", "dews_선택일"),
          interval: dews.localize.get("주", "dews_주"),
          repeatEvery: dews.localize.get("반복간격", "dews_반복간격"),
          repeatOn: dews.localize.get("반복주기", "dews_반복주기")
        },
        yearly: {
          interval: dews.localize.get("주", "dews_주"),
          repeatEvery: dews.localize.get("반복간격", "dews_반복간격"),
          repeatOn: dews.localize.get("반복주기", "dews_반복주기")
        },
        end: {
          label: dews.localize.get("반복종료", "dews_반복종료"),
          occurrence: dews.localize.get("회", "dews_회"),
          after: dews.localize.get("반복", "dews_반복"),
          never: dews.localize.get("없음", "dews_없음"),
          on: dews.localize.get("날짜", "dews_날짜")
        }
      },
      showFullDay: dews.localize.get("전체 시간", "dews_전체시간"),
      showWorkDay: dews.localize.get("업무 시간", "dews_업무시간")
    };

    // date {string | date} 날짜 설정
    if (opt.date) {
      if ($.type(opt.date) === "string") {
        opt.date = kendo.parseDate(opt.date, dews._environments.formats.dateValueFormat, kendo.getCulture());
      }
    }

    if (opt.startTime) {
      if ($.type(opt.startTime) === "string") {
        opt.startTime = kendo.parseDate(
        opt.startTime,
        dews._environments.formats.dateTimeValueFormat,
        kendo.getCulture());

      }
    }
    if (opt.endTime) {
      if ($.type(opt.endTime) === "string") {
        opt.endTime = kendo.parseDate(
        opt.endTime,
        dews._environments.formats.dateTimeValueFormat,
        kendo.getCulture());

      }
    }
    if (opt.workDayStart) {
      if ($.type(opt.workDayStart) === "string") {
        opt.workDayStart = kendo.parseDate(
        opt.workDayStart,
        dews._environments.formats.dateTimeValueFormat,
        kendo.getCulture());

      }
    }
    if (opt.workDayEnd) {
      if ($.type(opt.workDayEnd) === "string") {
        opt.workDayEnd = kendo.parseDate(
        opt.workDayEnd,
        dews._environments.formats.dateTimeValueFormat,
        kendo.getCulture());

      }
    }
    if (opt.max) {
      if ($.type(opt.max) === "string") {
        opt.max = kendo.parseDate(opt.max, dews._environments.formats.dateValueFormat, kendo.getCulture());
      }
    }
    if (opt.min) {
      if ($.type(opt.min) === "string") {
        opt.min = kendo.parseDate(opt.min, dews._environments.formats.dateValueFormat, kendo.getCulture());
      }
    }

    // view {object} 뷰 설정
    if (opt.views) {
      for (var i = 0; i < opt.views.length; i++) {
        if ($.type(opt.views[i]) !== "object") {
          opt.views[i] = { type: opt.views[i] };
        }

        if (opt.views[i].type === "day") {
          opt.views[i].title = dews.localize.get("일", "dews_일");
          if (!opt.views[i].selectedDateFormat) {
            opt.views[i].selectedDateFormat = "{0:" + dews._environments.formats.dateFormat + "}";
          }
        } else if (opt.views[i].type === "workWeek") {
          opt.views[i].title = dews.localize.get("평일", "dews_평일");
          if (!opt.views[i].selectedDateFormat) {
            opt.views[i].selectedDateFormat =
            "{0:" +
            dews._environments.formats.dateFormat +
            "} - {1:" +
            dews._environments.formats.dateFormat +
            "}";
          }
        } else if (opt.views[i].type === "week") {
          opt.views[i].title = dews.localize.get("주", "dews_주");
          if (!opt.views[i].selectedDateFormat) {
            opt.views[i].selectedDateFormat =
            "{0:" +
            dews._environments.formats.dateFormat +
            "} - {1:" +
            dews._environments.formats.dateFormat +
            "}";
          }
        } else if (opt.views[i].type === "month") {
          opt.views[i].title = dews.localize.get("월", "dews_월");
          if (!opt.views[i].selectedDateFormat) {
            opt.views[i].selectedDateFormat = "{0:" + dews._environments.formats.monthFormat + "}";
          }
        } else if (opt.views[i].type === "agenda") {
          opt.views[i].title = dews.localize.get("아젠다", "dews_아젠다");
          if (!opt.views[i].selectedDateFormat) {
            opt.views[i].selectedDateFormat =
            "{0:" +
            dews._environments.formats.dateFormat +
            "} - {1:" +
            dews._environments.formats.dateFormat +
            "}";
          }
        } else if (opt.views[i].type === "timeline") {
          opt.views[i].title = dews.localize.get("타임라인", "dews_타임라인");
          if (!opt.views[i].selectedDateFormat) {
            opt.views[i].selectedDateFormat = "{0:" + dews._environments.formats.dateFormat + "}";
          }
        } else if (opt.views[i].type === "timelineWeek") {
          opt.views[i].title = dews.localize.get("주 타임라인", "dews_주 타임라인");
          if (!opt.views[i].selectedDateFormat) {
            opt.views[i].selectedDateFormat =
            "{0:" +
            dews._environments.formats.dateFormat +
            "} - {1:" +
            dews._environments.formats.dateFormat +
            "}";
          }
        } else if (opt.views[i].type === "timelineWorkWeek") {
          opt.views[i].title = dews.localize.get("평일 타임라인", "dews_평일 타임라인");
          if (!opt.views[i].selectedDateFormat) {
            opt.views[i].selectedDateFormat =
            "{0:" +
            dews._environments.formats.dateFormat +
            "} - {1:" +
            dews._environments.formats.dateFormat +
            "}";
          }
        } else if (opt.views[i].type === "timelineMonth") {
          opt.views[i].title = dews.localize.get("월 타임라인", "dews_월 타임라인");
          if (!opt.views[i].selectedDateFormat) {
            opt.views[i].selectedDateFormat =
            "{0:" +
            dews._environments.formats.dateFormat +
            "} - {1:" +
            dews._environments.formats.dateFormat +
            "}";
          }
        }
      }
    }

    opt._fieldName = {};

    if (opt.dataSource) {
      dsOpt = opt.dataSource.options;
      var newDsOpt = {
        schema: {
          model: {
            id: "taskId",
            fields: {}
          }
        }
      };

      newDsOpt.schema.model.fields = {
        taskId: { from: opt.mapping.taskId, type: "string" },
        title: { from: opt.mapping.title },
        start: { from: opt.mapping.start, type: "date" },
        end: { from: opt.mapping.end, type: "date" },
        // startTimezone: {from: opt.mapping.startTimezone},
        // endTimezone: {from: opt.mapping.endTimezone},
        description: { from: opt.mapping.description },
        recurrenceId: { from: opt.mapping.recurrenceId },
        recurrenceRule: { from: opt.mapping.recurrenceRule },
        recurrenceException: { from: opt.mapping.recurrenceException },
        isAllDay: { from: opt.mapping.isAllDay }
      };

      if (opt.resources) {
        for (var rInx = 0; rInx < opt.resources.length; rInx++) {
          newDsOpt.schema.model.fields[opt.resources[rInx].field] = {
            from: opt.resources[rInx].field
          };
          opt._fieldName[opt.resources[rInx].field] = opt.resources[rInx].field;
        }
      }

      for (var i = 0; i < dsOpt.schema.model.fields.length; i++) {
        if (dsOpt.schema.model.fields[i].field === "taskId") {
          if (dsOpt.schema.model.fields[i].type) {
            newDsOpt.schema.model.fields.taskId.type = dsOpt.schema.model.fields[i].type;
          }
        }
      }

      opt.dataSource = new kendo.data.SchedulerDataSource(newDsOpt);
    }

    opt._fieldName[opt.mapping.taskId] = "taskId";
    opt._fieldName[opt.mapping.title] = "title";
    opt._fieldName[opt.mapping.start] = "start";
    opt._fieldName[opt.mapping.end] = "end";
    // opt._fieldName[opt.mapping.startTimezone] = 'startTimezone';
    // opt._fieldName[opt.mapping.endTimezone] = 'endTimezone';
    opt._fieldName[opt.mapping.description] = "description";
    opt._fieldName[opt.mapping.recurrenceId] = "recurrenceId";
    opt._fieldName[opt.mapping.recurrenceRule] = "recurrenceRule";
    opt._fieldName[opt.mapping.recurrenceException] = "recurrenceException";
    opt._fieldName[opt.mapping.isAllDay] = "isAllDay";

    return opt;
  }

  /**
   * Scheduler 컴포넌트의 생성자를 생성합니다.
   *
   * @class Scheduler
   *
   * @param {$element} $el jquery 요소
   * @param {SchedulerOptions} options 옵션
   * @return {Scheduler}
   * @constructor
   */
  function Scheduler($el, options) {
    var self = this,
      opt,
      sc,
      autoBind;

    // 개발자가 사용하는 데이터 소스
    self.dataSource = options.dataSource;

    // 설정 옵션을 가져옵니다.
    opt = getOptions($el, options);

    if (opt.dataSource && opt.autoBind !== false) {
      self.dataSource.read();
    }

    $el.kendoScheduler(opt);

    sc = $el.data("kendoScheduler");

    self.$element = $el;
    self.options = opt;
    // 스케줄러 데이터소스
    self._schedulerDataSource = opt.dataSource;
    self._scheduler = sc;

    self._bindEvent();

    return self;
  }

  Scheduler.prototype._createSchedulerDataSource = function (dataSource) {
    var self = this;
    var dsOpt = dataSource.options;
    var opt = self.options;
    var newDataSource;
    var newDsOpt = {
      schema: {
        model: {
          // id: dsOpt.id,
          id: "taskId",
          fields: {}
        }
      }
    };

    newDsOpt.schema.model.fields = {
      taskId: { from: opt.mapping.taskId, type: "string" },
      title: { from: opt.mapping.title },
      start: { from: opt.mapping.start, type: "date" },
      end: { from: opt.mapping.end, type: "date" },
      // startTimezone: {from: opt.mapping.startTimezone},
      // endTimezone: {from: opt.mapping.endTimezone},
      description: { from: opt.mapping.description },
      recurrenceId: { from: opt.mapping.recurrenceId },
      recurrenceRule: { from: opt.mapping.recurrenceRule },
      recurrenceException: { from: opt.mapping.recurrenceException },
      isAllDay: { from: opt.mapping.isAllDay }
    };

    if (opt.resources) {
      for (var rInx = 0; rInx < opt.resources.length; rInx++) {
        newDsOpt.schema.model.fields[opt.resources[rInx].field] = {
          from: opt.resources[rInx].field
        };
        opt._fieldName[opt.resources[rInx].field] = opt.resources[rInx].field;
      }
    }

    for (var i = 0; i < dsOpt.schema.model.fields.length; i++) {
      if (dsOpt.schema.model.fields[i].field === "taskId") {
        if (dsOpt.schema.model.fields[i].type) {
          newDsOpt.schema.model.fields.taskId.type = dsOpt.schema.model.fields[i].type;
        }
      }
    }

    newDataSource = new kendo.data.SchedulerDataSource(newDsOpt);

    newDataSource.bind("chagne", self.options.schedulerDataSourceChange);

    return newDataSource;
  };

  function getHoliday(currentYear) {
    var $dfd = $.Deferred();
    dews.api.
    post(dews.url.getApiUrl("CM", "HolidayInfoService", "Year/" + currentYear), {
      data: {
        type: "all",
        calendar: "1"
      }
    }).
    done(function (data) {
      $dfd.resolve(data);
    }).
    fail(function (xhr, status, error) {
      console.log("error ", xhr, status, error);
      $dfd.resolve();
    });

    return $dfd.promise();
  }

  function _isHoliday(date, holidaysData) {
    var currentYear = date.getFullYear(),
      currentMonth = date.getMonth() + 1,
      currentDate = date.getDate().toString(),
      data;

    if (holidaysData) {
      data = holidaysData[currentYear];
    }

    currentMonth = currentMonth >= 10 ? currentMonth.toString() : "0" + currentMonth;
    currentDate = currentDate >= 10 ? currentDate.toString() : "0" + currentDate;

    if (data) {
      for (var idx = 0; idx < data.length; idx++) {
        if (data[idx].date.substr(0, 2) === currentMonth && data[idx].date.substr(2, 2) === currentDate) {
          return data[idx];
        }
      }
    }
    return false;
  }

  /**
   * 이벤트를 바인딩합니다.
   * @private
   */
  Scheduler.prototype._bindEvent = function () {
    var self = this;
    var ds, scds;
    var currentYear = self._scheduler.view().options.date.getFullYear();

    self.options.dataSourceChange = function (e) {
      var mapping = self.options.mapping;
      var item = {};
      var items, resources;
      ds = self.dataSource;
      scds = self._schedulerDataSource;

      if (!e.action) {
        var convertData = [];
        items = e.items.toJSON();
        for (var idx = 0; idx < items.length; idx++) {
          if ($.type(items[idx][mapping.start]) === "string") {
            items[idx][mapping.start] = kendo.parseDate(
            items[idx][mapping.start],
            "yyyyMMddHHmmss",
            kendo.getCulture());

          }
          if ($.type(items[idx][mapping.end]) === "string") {
            items[idx][mapping.end] = kendo.parseDate(
            items[idx][mapping.end],
            "yyyyMMddHHmmss",
            kendo.getCulture());

          }

          convertData.push(self._convertSchedulerData(items[idx]));
        }

        self._schedulerDataSource.data(convertData);
      } else if (e.action && e.action === "add") {
        if (e.items[0]._newItem) {
          e.items[0]._newItem = false;
        } else {
          item = e.items[0].toJSON();

          if ($.type(item[mapping.start]) === "string") {
            item[mapping.start] = kendo.parseDate(
            item[mapping.start],
            dews._environments.formats.dateTimeValueFormat,
            kendo.getCulture());

          }
          if ($.type(item[mapping.end]) === "string") {
            item[mapping.end] = kendo.parseDate(
            item[mapping.end],
            dews._environments.formats.dateTimeValueFormat,
            kendo.getCulture());

          }

          item._newItem = true;

          var cvData = self._convertSchedulerData(item);
          self._schedulerDataSource.add(cvData);
        }
      } else if (e.action === "itemchange") {
        var fieldName;
        item = e.items[0].toJSON();

        fieldName = self.options._fieldName[e.field];
        self._schedulerDataSource.get(item[mapping.taskId])[fieldName] = item[e.field];
        self._schedulerDataSource.get(item[mapping.taskId])[e.field] = item[e.field];
        self._scheduler.refresh();
      } else if (e.action === "dataChange") {
        item = self.dataSource._getByTaskId(e.items.taskId);
        var startTime = kendo.toString(
        e.items.start,
        dews._environments.formats.dateTimeValueFormat,
        kendo.getCulture());

        var endTime = kendo.toString(
        e.items.end,
        dews._environments.formats.dateTimeValueFormat,
        kendo.getCulture());


        if (item) {
          if (item[mapping.title] !== e.items.title) {
            item[mapping.title] = e.items.title;
            item.dirtyFields[mapping.title] = true;
          }
          if ($.type(item[mapping.start]) === "string") {
            if (item[mapping.start] !== startTime) {
              item[mapping.start] = startTime;
              item.dirtyFields[mapping.start] = true;
            }
          }
          if ($.type(item[mapping.end]) === "string") {
            if (item[mapping.end] !== endTime) {
              item[mapping.end] = endTime;
              item.dirtyFields[mapping.end] = true;
            }
          }
          // if (item[mapping.startTimezone] !== e.items.startTimezone) {
          //     item[mapping.startTimezone] = e.items.startTimezone;
          //     item.dirtyFields[mapping.startTimezone] = true;
          // }
          // if (item[mapping.endTimezone] !== e.items.endTimezone) {
          //     item[mapping.endTimezone] = e.items.endTimezone;
          //     item.dirtyFields[mapping.endTimezone] = true;
          // }
          if (item[mapping.description] !== e.items.description) {
            item[mapping.description] = e.items.description;
            item.dirtyFields[mapping.description] = true;
          }
          if (item[mapping.recurrenceId] !== e.items.recurrenceId) {
            item[mapping.recurrenceId] = e.items.recurrenceId;
            item.dirtyFields[mapping.recurrenceId] = true;
          }
          if (item[mapping.recurrenceRule] !== e.items.recurrenceRule) {
            item[mapping.recurrenceRule] = e.items.recurrenceRule;
            item.dirtyFields[mapping.recurrenceRule] = true;
          }
          if (item[mapping.recurrenceException] !== e.items.recurrenceException) {
            item[mapping.recurrenceException] = e.items.recurrenceException;
            item.dirtyFields[mapping.recurrenceException] = true;
          }
          if (item[mapping.isAllDay] !== e.items.isAllDay) {
            item[mapping.isAllDay] = e.items.isAllDay;
            item.dirtyFields[mapping.isAllDay] = true;
          }

          item.dirty = true;

          if (self.options.resources) {
            resources = self.options.resources;
            for (var rInx = 0; rInx < resources.length; rInx++) {
              if (item[resources[rInx].field] !== e.items[resources[rInx].field]) {
                item[resources[rInx].field] = e.items[resources[rInx].field];
                item.dirtyFields[resources[rInx].field] = true;
              }
            }
          }
        }
      } else if (e.action === "remove") {
        if (ds.data().length !== scds.data().length) {
          scds.remove(scds.data().at(e.index));
        }
      }
    };
    self.options.schedulerDataSourceChange = function (e) {
      var mapping = self.options.mapping,
        item = {},
        resources;
      ds = self.dataSource;
      scds = self._schedulerDataSource;

      if (!e.action) {
      } else if (e.action && e.action === "add") {
        if (e.items[0]._newItem) {
          e.items[0]._newItem = false;
        } else {
          item = self._convertData(e.items[0]);

          item._newItem = true;
          self.dataSource.add(item);
        }
      } else if (e.action === "itemchange") {
        var eventParameter = {
          action: "dataChange",
          items: e.items[0]
        };

        self.dataSource.trigger("change", eventParameter);
      } else if (e.action === "remove") {
        if (ds.data().length !== scds.data().length) {
          ds.remove(ds.data().at(e.index));
        }
      }
    };
    if (self.dataSource) {
      self.dataSource._getByTaskId = function (taskId) {
        var idx,
          length,
          data = this._flatData(this._data, this.options.useRanges);
        for (idx = 0, length = data.length; idx < length; idx++) {
          if (data[idx][self.options.mapping.taskId] === taskId) {
            return data[idx];
          }
        }
      };
      self.dataSource.bind("change", self.options.dataSourceChange);
      self._schedulerDataSource.bind("change", self.options.schedulerDataSourceChange);
    }
    self.options.dataBound = function (e) {
      var dataArray,
        items = [],
        mapping;
      currentYear = self._scheduler.view().options.date.getFullYear();
      e.scheduler = self;

      if (!self._holiday) {
        self._holiday = {};
      }

      if (self.viewName() === "month") {
        if (self.options.holidays && !self._holiday[currentYear]) {
          getHoliday(currentYear).done(function (data) {
            self._holiday[currentYear] = data;
            self._scheduler.view()._content();
          });
        }
      }

      // 툴팁 적용
      self.$element.find(".k-event").on("mouseover", function (e) {
        var data,
          index,
          template,
          mapping = self.options.mapping;
        for (var i = 0; i < self._scheduler._data.length; i++) {
          if (self._scheduler._data[i].uid === $(e.target).closest(".k-event").data("uid")) {
            index = i;
            break;
          }
        }

        if (self.options.tooltipText) {
          var startTime, endTime;
          if (self._data[i].toJSON) {
            data = self._data[i].toJSON();
          } else {
            data = self._data[i];
          }
          startTime = data[mapping.start] = kendo.parseDate(
          data[mapping.start],
          dews._environments.formats.dateTimeValueFormat,
          kendo.getCulture());

          endTime = data[mapping.end] = kendo.parseDate(
          data[mapping.end],
          dews._environments.formats.dateTimeValueFormat,
          kendo.getCulture());

          data[mapping.start] = kendo.toString(
          startTime,
          dews._environments.formats.dateTimeFormat,
          kendo.getCulture());

          data[mapping.end] = kendo.toString(
          endTime,
          dews._environments.formats.dateTimeFormat,
          kendo.getCulture());


          template = kendo.template(self.options.tooltipText);
        } else {
          data = self._scheduler._data[i];
          template = kendo.template("#=title#");
        }

        dews.ui.tooltip.show($(this), {
          type: "normal",
          text: template(data),
          fadeOutTime: 0,
          position: "bottom"
        });
      });

      // tooltip Text
      self.$element.find(".k-event").on("mouseleave", function (e) {
        dews.ui.tooltip.hide($(this));
      });

      dataArray = self._scheduler.data();
      mapping = self.options.mapping;

      for (var i = 0; i < dataArray.length; i++) {
        var item = {};
        if (self.dataSource._getByTaskId(dataArray[i].taskId)) {
          item = self.dataSource._getByTaskId(dataArray[i].taskId);
        } else {
          item[mapping.taskId] = dataArray[i].taskId;
          item[mapping.title] = dataArray[i].title;
          item[mapping.start] = kendo.toString(
          dataArray[i].start,
          dews._environments.formats.dateTimeValueFormat,
          kendo.getCulture());

          item[mapping.end] = kendo.toString(
          dataArray[i].end,
          dews._environments.formats.dateTimeValueFormat,
          kendo.getCulture());

          // item[mapping.startTimezone] = dataArray[i].startTimezone;
          // item[mapping.endTimezone] = dataArray[i].endTimezone;
          item[mapping.description] = dataArray[i].description;
          item[mapping.recurrenceId] = dataArray[i].recurrenceId;
          item[mapping.recurrenceRule] = dataArray[i].recurrenceRule;
          item[mapping.recurrenceException] = dataArray[i].recurrenceException;
          item[mapping.isAllDay] = dataArray[i].isAllDay;
          if (self.options.resources) {
            var resources = self.options.resources;
            for (var rInx = 0; rInx < resources.length; rInx++) {
              item[resources[rInx].field] = dataArray[0][resources[rInx].field];
            }
          }
          item = self.dataSource._createNewModel(item);
        }
        items.push(item);
      }

      delete e.sender;

      self._data = items;
      e.items = items;
    };
    self.options.change = function (e) {
      var items = [],
        item;
      var events = e.events,
        slots = e.slots;
      e.scheduler = self;

      for (var idx = 0; idx < events.length; idx++) {
        if (events[idx].taskId) {
          item = self.dataSource._getByTaskId(events[idx].taskId);
        } else {
          for (var dataIdx = 0; dataIdx < self._scheduler._data.length; dataIdx++) {
            if (events[idx].uid === self._scheduler._data[dataIdx].uid) {
              item = self._data[dataIdx];
              break;
            }
          }
        }
        items.push(item);
      }

      if (e.slots.length > 0) {
        for (var slotsIdx = 0; slotsIdx < slots.length; slotsIdx++) {
          slots[slotsIdx].start = kendo.toString(
          slots[slotsIdx].start,
          dews._environments.formats.dateTimeValueFormat,
          kendo.getCulture());

          slots[slotsIdx].end = kendo.toString(
          slots[slotsIdx].end,
          dews._environments.formats.dateTimeValueFormat,
          kendo.getCulture());

        }
      }

      e.events = items;
      e.end = kendo.toString(e.end, dews._environments.formats.dateTimeValueFormat, kendo.getCulture());
      e.start = kendo.toString(e.start, dews._environments.formats.dateTimeValueFormat, kendo.getCulture());
      delete e.sender;
    };
    self._scheduler.bind("dataBinding", self.options.dataBounding);
    self._scheduler.bind("change", self.options.change);
    self._scheduler.bind("dataBound", self.options.dataBound);

    // autoBind false 일 경우 처음 dataBound 를 타지 않음, 두번째 부터는 kendo에서 rebind 함수에서 fetch가 발생
    if (!self.options.autoBind) {
      if (!self._holiday) {
        self._holiday = {};
      }

      if (self.viewName() === "month") {
        if (self.options.holiday && !self._holiday[currentYear]) {
          getHoliday(currentYear).done(function (data) {
            self._holiday[currentYear] = data;
            self._scheduler.view()._content();
          });
        }
      }
    }
  };

  Scheduler.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change", "dataBound", "openDialog", "add", "edit", "remove"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "openDialog") {
          self.$element.trigger(event);
        } else {
          self._scheduler.trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  /**
   * 이벤트 헨들러를 등록합니다.
   */
  Scheduler.prototype.on = function () {
    var self = this;

    if (arguments[0] === "openDialog") {
      self.$element.on.apply(self.$element, arguments);
    } else {
      self._scheduler.bind.apply(self._scheduler, arguments);
    }
  };

  /**
   * 이벤트 핸들러를 해제합니다.
   */
  Scheduler.prototype.off = function () {
    var self = this;

    self._scheduler.unbind.apply(self._scheduler, arguments);
  };

  /**
   * 스케줄을 추가
   * @param {object} data 추가 할 스케줄에 선언된 필드들 데이터
   */
  Scheduler.prototype.addEvent = function (data) {
    var self = this;
    var prevented = self._scheduler.trigger("add", {
      event: data,
      scheduler: self
    });

    if (!prevented) {
      self.dataSource.add(data);
    }
  };

  /**
   * 스케줄을 수정
   * @param {object} event 수정 할 스케줄 값
   * @param {object} data 수정 할 스케줄 변경 된 값
   */
  Scheduler.prototype.editEvent = function (event, data) {
    var self = this,
      mapping = self.options.mapping;
    var eventParameter;
    var model = typeof event === "string" ? self.occurrenceByUid(event) : event;

    var editEvent = $.extend({}, model);

    var prevented = self._scheduler.trigger("edit", {
      event: editEvent,
      scheduler: self
    });

    if (!prevented) {
      model = self._schedulerDataSource.get(model[mapping.taskId]);

      if (data[mapping.title]) {
        data.title = data[mapping.title];
      }
      if (data[mapping.start]) {
        data.start = kendo.parseDate(
        data[mapping.start],
        dews._environments.formats.dateTimeValueFormat,
        kendo.getCulture());

      }
      if (data[mapping.end]) {
        data.end = kendo.parseDate(
        data[mapping.end],
        dews._environments.formats.dateTimeValueFormat,
        kendo.getCulture());

      }
      if (data[mapping.description]) {
        data.description = data[mapping.description];
      }
      if (data[mapping.recurrenceId]) {
        data.recurrenceId = data[mapping.recurrenceId];
      }
      if (data[mapping.recurrenceRule]) {
        data.recurrenceRule = data[mapping.recurrenceRule];
      }
      if (data[mapping.recurrenceException]) {
        data.recurrenceException = data[mapping.recurrenceException];
      }
      data.isAllDay = data[mapping.isAllDay];

      model = $.extend(model, data);

      eventParameter = { action: "dataChange", items: model };
      if (self.dataSource) {
        self.dataSource.trigger("change", eventParameter);
      }

      self._scheduler.refresh();
    }
  };

  /**
   * 스케줄을 삭제
   * @param {scheduleEvent | string} event | uid 스케줄 데이터 또는 uid
   */
  Scheduler.prototype.removeEvent = function (event) {
    var self = this;
    var model = typeof event === "string" ? self.occurrenceByUid(event) : event;

    if (!model) {
      return;
    }

    if (model[self.options.mapping.taskId]) {
      // model = self._schedulerDataSource.get(model[self.options.mapping.taskId]);
      // var event = $.extend({}, model);
      // event = sc._convertData(event);
      var prevented = self._scheduler.trigger("remove", {
        event: event,
        scheduler: self
      });
      if (!prevented) {
        self.dataSource.remove(model);
      }
    } else {
      var modelObj = getOccurrenceByUid(self._data, model.uid);
      model = self._scheduler._data[modelObj.index];
      self._scheduler.removeEvent(model);
    }
  };

  Scheduler.prototype.occurrenceByUid = function (uid) {
    var self = this;
    var occurrence = self.dataSource.getByUid(uid);
    if (!occurrence) {
      occurrence = getOccurrenceByUid(self._data, uid);
    }
    return occurrence;
  };

  function getOccurrenceByUid(data, uid) {
    var length = data.length,
      idx = 0,
      event = {};
    for (; idx < length; idx++) {
      event.data = data[idx];
      if (event.data.uid === uid) {
        event.index = idx;
        return event;
      }
    }
  }

  /**
   * 현재 보여지는 스케줄의 데이터
   * @return {array} data 데이터 배열
   */
  Scheduler.prototype.data = function () {
    var self = this;

    return self._data;
  };

  /**
   * 스케줄러의 현재 날짜를 가져오거나 설정
   * @param {Date | string} value 설정 할 날짜 반환값 없음
   * @return {Date} 매개변수가 없을 경우 현재 설정 된 날짜를 반환
   */
  Scheduler.prototype.date = function (value) {
    var self = this,
      date;

    if (value) {
      if ($.type(value) === "date") {
        self._scheduler.date(value);
      } else {
        date = kendo.parseDate(value, dews._environments.formats.dateValueFormat, kendo.getCulture());
        self._scheduler.date(date);
      }
    } else {
      date = self._scheduler.date();

      return kendo.toString(date, dews._environments.formats.dateValueFormat, kendo.getCulture());
    }
  };

  /**
   * 현재 보여지는 스케줄에 해당하는 DOM 요소의 배열을 가져옴
   * @return {array} 현재 랜더링 된 스케줄 요소
   */
  Scheduler.prototype.items = function () {
    var self = this;

    return self._scheduler.items();
  };

  /**
   * 현재 보여지는 뷰의 특정 시간 범위의 스케줄을 가져옴
   * @param {Date | string} start 범위의 시작
   * @param {Date | string} end 범위의 마지
   * @return {array} 기간안의 스케줄 데이터
   */
  Scheduler.prototype.occurrencesInRange = function (start, end) {
    var self = this;
    var startDT, endDT;
    var mapping = self.options.mapping;

    return new kendo.data.Query(self._data).
    filter({
      logic: "or",
      filters: [
      {
        logic: "and",
        filters: [
        {
          field: mapping.start,
          operator: "gte",
          value: start
        },
        {
          field: mapping.end,
          operator: "gte",
          value: start
        },
        {
          field: mapping.start,
          operator: "lt",
          value: end
        }]

      },
      {
        logic: "and",
        filters: [
        {
          field: mapping.start,
          operator: "lte",
          value: start
        },
        {
          field: mapping.end,
          operator: "gt",
          value: start
        }]

      }]

    }).
    toArray();
  };

  /**
   * 데이터 소스를 바인딩
   * @param {SchedulerDataSource} dataSource 바인딩 할 데이터 소스
   */
  Scheduler.prototype.setDataSource = function (dataSource) {
    var self = this;
    var mapping = self.options.mapping;
    if (self._schedulerDataSource) {
      self._schedulerDataSource.data([]);
    }

    dataSource.bind("change", self.options.dataSourceChange);

    self.dataSource = dataSource;

    self.dataSource._getByTaskId = function (taskId) {
      var idx,
        length,
        data = this._flatData(this._data, this.options.useRanges);
      for (idx = 0, length = data.length; idx < length; idx++) {
        if (data[idx][mapping.taskId] === taskId) {
          return data[idx];
        }
      }
    };

    if (!self._schedulerDataSource) {
      var newDataSource = self._createSchedulerDataSource(dataSource);
      self._schedulerDataSource = newDataSource;
      self._schedulerDataSource.bind("change", self.options.schedulerDataSourceChange);
      self._scheduler.setDataSource(newDataSource);
    }
  };

  /**
   * 현재 스케줄러 뷰를 가져오거나 설정
   * @param {string} type 뷰의 타입
   * @return {schedulerView} 매개변수가 없을 경우 현재 스케줄러 뷰를 반환
   */
  Scheduler.prototype.view = function (type) {
    var self = this;

    if (type) {
      self._scheduler.view(type);
    }
    // } else {
    //     return self._scheduler.view();
    // }
  };

  /**
   * 현재 뷰의 이름
   * @return {string} 현재 뷰의 이름
   */
  Scheduler.prototype.viewName = function () {
    var self = this;

    return self._scheduler.viewName();
  };

  function guid() {
    return "xxxxxxxx-xxxx-4xxx-9xxx-xxxxxxxxxxxx".replace(/[xy]/g, function (c) {
      var r = Math.random() * 16 | 0,
        v = c === "x" ? r : r & 0x3 | 0x8;
      return v.toString(16);
    });
  }

  // scheduler data -> data 추가, add 가 true 일 경우 scheduler data 에 data 필드와 값을 추가
  Scheduler.prototype._convertData = function (scData, add) {
    var self = this,
      data = {};
    var mapping = self.options.mapping;
    // add 일 경우 데이터 모델 상태로 변 경 하여야 하기 때문에 json 형태로 변환 하지 않습니다.
    if (!add && scData && scData.toJSON) {
      scData = scData.toJSON();
    }

    data[mapping.taskId] = scData.taskId;
    data[mapping.title] = scData.title === undefined ? "" : scData.title;
    if (add) {
      data[mapping.start] = kendo.toString(
      scData.start,
      dews._environments.formats.dateTimeFormat,
      kendo.getCulture());

      data[mapping.end] = kendo.toString(
      scData.end,
      dews._environments.formats.dateTimeFormat,
      kendo.getCulture());

    } else {
      data[mapping.start] = kendo.toString(
      scData.start,
      dews._environments.formats.dateTimeValueFormat,
      kendo.getCulture());

      data[mapping.end] = kendo.toString(
      scData.end,
      dews._environments.formats.dateTimeValueFormat,
      kendo.getCulture());

    }
    data[mapping.description] = scData.description === undefined ? "" : scData.description;
    data[mapping.recurrenceId] = scData.recurrenceId;
    data[mapping.recurrenceRule] = scData.recurrenceRule;
    data[mapping.recurrenceException] = scData.recurrenceException;
    data[mapping.isAllDay] = scData.isAllDay;
    if (add) {
      data = $.extend(true, scData, data);
    }

    return data;
  };

  // data -> scheduler data 로 변환
  Scheduler.prototype._convertSchedulerData = function (data) {
    var self = this,
      scData = {};
    var mapping = self.options.mapping;
    if (data && data.toJSON) {
      data = data.toJSON();
    }

    scData = $.extend(true, scData, data);

    scData.taskId = data[mapping.taskId];
    scData.title = data[mapping.title];
    if ($.type(data[mapping.start]) === "date") {
      scData.start = data[mapping.start];
      scData[mapping.start] = kendo.toString(
      data[mapping.start],
      dews._environments.formats.dateTimeValueFormat,
      kendo.getCulture());

    } else {
      scData.start = kendo.parseDate(
      data[mapping.start],
      dews._environments.formats.dateTimeValueFormat,
      kendo.getCulture());

    }
    if ($.type(data[mapping.end]) === "date") {
      scData.end = data[mapping.end];
      scData[mapping.end] = kendo.toString(
      data[mapping.end],
      dews._environments.formats.dateTimeValueFormat,
      kendo.getCulture());

    } else {
      scData.end = kendo.parseDate(
      data[mapping.end],
      dews._environments.formats.dateTimeValueFormat,
      kendo.getCulture());

    }
    scData.description = data[mapping.description];
    scData.recurrenceId = data[mapping.recurrenceId];
    scData.recurrenceRule = data[mapping.recurrenceRule];
    scData.recurrenceException = data[mapping.recurrenceException];
    scData.isAllDay = data[mapping.isAllDay];

    // isAllDay 기본 값 설정
    if (scData.isAllDay === undefined || scData.isAllDay === null) {
      scData.isAllDay = false;
    }

    scData[mapping.start] = kendo.toString(
    scData.start,
    dews._environments.formats.dateTimeFormat,
    kendo.getCulture());

    scData[mapping.end] = kendo.toString(scData.end, dews._environments.formats.dateTimeFormat, kendo.getCulture());

    return scData;
  };

  kendo.ui.Scheduler.fn.addEvent = function (eventInfo) {
    var self = this,
      event,
      prevented,
      eventParameter,
      openDialog;
    var sc = self.element.data("dewsControl");

    // add Event
    event = $.extend({}, eventInfo);
    event = sc._convertData(event);
    prevented = self.trigger("add", { event: event, scheduler: sc });

    // openDialog Event
    eventParameter = { event: event, mode: "add" };
    openDialog = $.Event("openDialog", eventParameter);
    sc.$element.trigger(openDialog);

    if (!prevented && !openDialog.isDefaultPrevented()) {
      self.cancelEvent();
      if (eventInfo && eventInfo.toJSON) {
        eventInfo = eventInfo.toJSON();
      }

      eventInfo._isNew = true;

      if (eventInfo._isNew) {
        eventInfo.taskId = guid();
      }

      self.cancelEvent();
      eventInfo = sc._convertData(eventInfo, true);
      eventInfo = self.dataSource.add(eventInfo);
      self._editEvent(eventInfo);
    }
  };

  kendo.ui.Scheduler.fn.editEvent = function (uid) {
    var self = this;
    var sc = self.element.data("dewsControl");
    var model = typeof uid == "string" ? self.occurrenceByUid(uid) : uid;
    if (!model) {
      return;
    }
    self.cancelEvent();

    var eventInfo = $.extend(model, {});

    if (eventInfo && eventInfo.toJSON) {
      eventInfo = eventInfo.toJSON();
    }

    var eventParameter = { event: eventInfo, mode: "edit" };

    var openDialog = $.Event("openDialog", eventParameter);

    sc.$element.trigger(openDialog);

    if (!openDialog.isDefaultPrevented()) {
      if (model.isRecurring()) {
        if (model.recurrenceRule) {
          self._editEvent(model);
        } else {
          var editMsg = dews.
          confirm("전체 스케줄을 편집 하시겠습니까?\n(예: 전체 스케줄, 아니오: 현재 스케줄)", true).
          yes(function () {
            if (!model.recurrenceRule) {
              model = self.dataSource.get(model.recurrenceId);
            }
            self._editEvent(model);
          }).
          no(function () {
            model._currentEdit = true;
            if (model.isException()) {
              self._editEvent(model);
            } else {
              self.addEvent(model);
            }
          });
        }
      } else {
        self._editEvent(model);
      }
    }
  };

  kendo.ui.Scheduler.fn.removeEvent = function (uid) {
    var self = this,
      model = typeof uid == "string" ? self.occurrenceByUid(uid) : uid;
    if (!model) {
      return;
    }

    if (model.isRecurring()) {
      var removeMsg = dews.
      confirm("전체 스케줄을 삭제하시겠습니까?\n(예: 전체 스케줄, 아니오: 현재 스케줄)", true).
      yes(function () {
        if (!model.recurrenceRule) {
          model = self.dataSource.get(model.recurrenceId);
        }
        self._removeEvent(model);
      }).
      no(function () {
        self._removeEvent(model);
      });
    } else {
      dews.confirm("스케줄을 삭제하시겠습니까?").yes(function () {
        self._removeEvent(model);
      });
    }
  };

  kendo.ui.Scheduler.fn._editEvent = function (model) {
    var self = this,
      editEvent;
    var messages = self.options.messages,
      editDlg;
    var sc = self.element.data("dewsControl");
    if (model.toJSON) {
      var originDataJSON = model.toJSON();
    } else {
      originDataJSON = model;
    }

    self._unbindResize();

    if (!model._isNew) {
      if (model.taskId) {
        editEvent = sc.dataSource._getByTaskId(model.taskId);
      } else {
        var index = dataIndex(self._data, model.uid);
        editEvent = sc._data[index];
      }

      var prevented = self.trigger("edit", {
        event: editEvent,
        scheduler: sc
      });
    }

    var inputData = {
      eventInfo: model,
      scheduler: self.element.data("dewsControl")
    };

    // region '다이얼로그 html'
    var innerHtml =
    '<div class="dews-dialog-contents-area">\n' +
    '  <div class="dews-scheduler-dialog-fp">\n' +
    "    <form>\n" +
    "    <ul>\n" +
    '      <li class="dews-scheduler-dialog-title-li">\n' +
    "        <label>" +
    messages.editor.title +
    "</label>\n" +
    "        <span>\n" +
    '          <input type="text" class="dews-ui-textbox" style="width: 350px">\n' +
    "        </span>\n" +
    "      </li>\n" +
    '      <li class="dews-scheduler-dialog-startDT-li">\n' +
    "        <label>" +
    messages.editor.start +
    "</label>\n" +
    "        <span>\n" +
    '          <input type="text" class="dews-ui-datetimepicker" style="width: 350px">\n' +
    "        </span>\n" +
    "      </li>\n" +
    '      <li class="dews-scheduler-dialog-startD-li">\n' +
    "        <label>" +
    messages.editor.start +
    "</label>\n" +
    "        <span>\n" +
    '          <input type="text" class="dews-ui-datepicker" style="width: 350px">\n' +
    "        </span>\n" +
    "      </li>\n" +
    '      <li class="dews-scheduler-dialog-endDT-li">\n' +
    "        <label>" +
    messages.editor.end +
    "</label>\n" +
    "        <span>\n" +
    '          <input type="text" class="dews-ui-datetimepicker" style="width: 350px">\n' +
    "        </span>\n" +
    "      </li>\n" +
    '      <li class="dews-scheduler-dialog-endD-li">\n' +
    "        <label>" +
    messages.editor.end +
    "</label>\n" +
    "        <span>\n" +
    '          <input type="text" class="dews-ui-datepicker" style="width: 350px">\n' +
    "        </span>\n" +
    "      </li>\n" +
    '      <li class="dews-scheduler-dialog-allDay-li">\n' +
    "        <label>" +
    messages.editor.allDayEvent +
    "</label>\n" +
    "        <span>\n" +
    '          <input type="checkbox" class="dews-ui-checkbox" checked="true">\n' +
    "        </span>\n" +
    "      </li>\n" +
    '      <li class="dews-scheduler-dialog-repeat-li">\n' +
    "        <label>" +
    messages.editor.repeat +
    "</label>\n" +
    "        <span>\n" +
    '          <select class="dews-ui-dropdownlist" data-dews-value-field="CD_REPEAT"\n' +
    '                  data-dews-text-field="NM_REPEAT" style="width: 140px"></select>\n' +
    "        </span>\n" +
    "      </li>\n" +
    '      <li class="addRepeatLi daily weekly monthly yearly dews-scheduler-dialog-repeatEvery-li" style="display: none">\n' +
    "        <label>" +
    messages.recurrenceEditor.daily.repeatEvery +
    "</label>\n" +
    "        <span>\n" +
    '          <input type="text" class="dews-ui-numerictextbox" data-dews-spinners="true" style="width: 140px"><label\n' +
    '          class="repeat-every-label"></label>\n' +
    "        </span>\n" +
    "      </li>\n" +
    '      <li class="addRepeatLi weekly dews-scheduler-dialog-repeatOnDays-li" style="display: none">\n' +
    "        <label>" +
    messages.recurrenceEditor.weekly.repeatOn +
    "</label>\n" +
    '        <span style="width: 350px">\n' +
    '          <input type="checkbox" class="dews-ui-checkbox repeat-on">\n' +
    "          <label>" +
    dews.localize.get("일", "dews_일요일") +
    "</label>\n" +
    '          <input type="checkbox" class="dews-ui-checkbox repeat-on">\n' +
    "          <label>" +
    dews.localize.get("월", "dews_월요일") +
    "</label>\n" +
    '          <input type="checkbox" class="dews-ui-checkbox repeat-on">\n' +
    "          <label>" +
    dews.localize.get("화", "dews_화요일") +
    "</label>\n" +
    '          <input type="checkbox" class="dews-ui-checkbox repeat-on">\n' +
    "          <label>" +
    dews.localize.get("수", "dews_수요일") +
    "</label>\n" +
    '          <input type="checkbox" class="dews-ui-checkbox repeat-on">\n' +
    "          <label>" +
    dews.localize.get("목", "dews_목요일") +
    "</label>\n" +
    '          <input type="checkbox" class="dews-ui-checkbox repeat-on">\n' +
    "          <label>" +
    dews.localize.get("금", "dews_금요일") +
    "</label>\n" +
    '          <input type="checkbox" class="dews-ui-checkbox repeat-on">\n' +
    "          <label>" +
    dews.localize.get("토", "dews_토요일") +
    "</label>\n" +
    "        </span>\n" +
    "      </li>\n" +
    '      <li class="addRepeatLi monthly dews-scheduler-dialog-repeatOnDate-li" style="display: none">\n' +
    "        <label>" +
    messages.recurrenceEditor.monthly.repeatOn +
    "</label>\n" +
    "        <span>\n" +
    '          <label class="repeat-on-date-label">' +
    messages.recurrenceEditor.monthly.day +
    "</label>\n" +
    '          <input type="text" class="dews-ui-numerictextbox" min="1" max="31" data-dews-spinners="true"\n' +
    '                 style="width: 140px">\n' +
    "        </span>\n" +
    "      </li>\n" +
    '      <li class="addRepeatLi yearly dews-scheduler-dialog-repeatOnMonth-li" style="display: none">\n' +
    "        <label>" +
    messages.recurrenceEditor.yearly.repeatOn +
    "</label>\n" +
    "        <span>\n" +
    '          <select class="dews-ui-dropdownlist" data-dews-value-field="CD_MONTH"\n' +
    '                  data-dews-text-field="NM_MONTH" style="width: 140px"></select>\n' +
    '          <input type="text" class="dews-ui-numerictextbox" data-dews-spinners="true" style="width: 140px">\n' +
    "        </span>\n" +
    "      </li>\n" +
    '      <li class="addRepeatLi daily weekly monthly yearly dews-scheduler-dialog-repeatEndNever-li" style="display: none">\n' +
    "        <label>" +
    messages.recurrenceEditor.end.label +
    "</label>\n" +
    "        <span>\n" +
    '          <input id="repeatEndNeverRDO" type="radio" class="dews-ui-radio repeat-end" checked="checked">\n' +
    '          <label for="repeatEndNeverRDO">' +
    messages.recurrenceEditor.end.never +
    "</label>\n" +
    "        </span>\n" +
    "      </li>\n" +
    '      <li class="addRepeatLi daily weekly monthly yearly dews-scheduler-dialog-repeatEndAfter-li" style="display: none">\n' +
    "        <label></label>\n" +
    "        <span>\n" +
    '          <input id="repeatEndAfterRDO" type="radio" class="dews-ui-radio repeat-end">\n' +
    '          <label for="repeatEndAfterRDO">' +
    messages.recurrenceEditor.end.after +
    "</label>\n" +
    '          <input id="repeatEndAfterNTB" type="text" class="dews-ui-numerictextbox repeat-end disabled"\n' +
    '                 data-dews-spinners="true" style="width: 140px"><label class="repeat-end-after-label"> ' +
    messages.recurrenceEditor.end.occurrence +
    "</label>\n" +
    "        </span>\n" +
    "      </li>\n" +
    '      <li class="addRepeatLi daily weekly monthly yearly dews-scheduler-dialog-repeatEndOn-li" style="display: none">\n' +
    "        <label></label>\n" +
    "        <span>\n" +
    '          <input id="repeatEndOnRDO" type="radio" class="dews-ui-radio repeat-end">\n' +
    '          <label for="repeatEndOnRDO">' +
    messages.recurrenceEditor.end.on +
    "</label>\n" +
    '          <input id="repeatOnDT" type="text" class="dews-ui-datepicker repeat-end disabled" style="width: 140px">\n' +
    "        </span>\n" +
    "      </li>\n" +
    '      <li class="dews-scheduler-dialog-description-li">\n' +
    "        <label>" +
    messages.editor.description +
    "</label>\n" +
    "        <span>\n" +
    '          <input id="descriptionTB" type="text" class="dews-ui-textbox" style="width: 350px">\n' +
    "        </span>\n" +
    "      </li>\n" +
    "    </ul>\n" +
    "    </form>\n" +
    "  </div>\n" +
    "</div>\n" +
    '<div class="dews-dialog-button-group bottom">\n' +
    '  <button id="btnSave" class="dews-ui-button confirm dews-scheduler-dialog-saveBtn">' +
    dews.localize.get("저장", "dews_저장") +
    "</button>\n" +
    '  <button id="btnCancel" class="dews-ui-button confirm dews-scheduler-dialog-cancelBtn">' +
    dews.localize.get("닫기", "dews_닫기") +
    "</button>\n" +
    "</div>";
    // endregion

    if (!prevented) {
      editDlg = dews.ui.dialog("editDlg", {
        content: innerHtml,
        title: messages.editor.editorTitle,
        width: 560,
        height: 286,
        saveBtn: false,
        initData: inputData,
        open: function open(e) {
          dews.ready(function () {
            var self = this,
              dewsControl = {};
            var thisDlg = dews.ui.dialog(self.$content.prop("id"));
            var initData = thisDlg.initData;
            var eventInfo = initData.eventInfo;
            var resources = initData.scheduler._scheduler.resources;
            var zone = initData.scheduler._scheduler.options.timezone;
            var outData = {},
              rule = {},
              changeData = {};
            outData = eventInfo;

            if (!eventInfo._isNew) {
              changeData = eventInfo.toJSON();
            }

            var WEEK_DAYS = {
                0: "SU",
                1: "MO",
                2: "TU",
                3: "WE",
                4: "TH",
                5: "FR",
                6: "SA"
              },
              WEEK_DAYS_IDX = {
                SU: 0,
                MO: 1,
                TU: 2,
                WE: 3,
                TH: 4,
                FR: 5,
                SA: 6
              };

            // html 변수 지정
            // content
            self.$content.find(".dews-dialog-contents").css("overflow", "hidden");
            var fp = self.$content.find(".dews-scheduler-dialog-fp");
            var liList = fp.find("li").not(".dews-form-panel-item-transparency");
            var titleTB = fp.find("li.dews-scheduler-dialog-title-li").find(".dews-ui-textbox");
            var startDT = fp.find("li.dews-scheduler-dialog-startDT-li").find(".dews-ui-datetimepicker");
            var startD = fp.find("li.dews-scheduler-dialog-startD-li").find(".dews-ui-datepicker");
            var endDT = fp.find("li.dews-scheduler-dialog-endDT-li").find(".dews-ui-datetimepicker");
            var endD = fp.find("li.dews-scheduler-dialog-endD-li").find(".dews-ui-datepicker");
            var allDayChk = fp.find("li.dews-scheduler-dialog-allDay-li").find(".dews-ui-checkbox");
            var repeatDDL = fp.find("li.dews-scheduler-dialog-repeat-li").find(".dews-ui-dropdownlist");
            var repeatEveryNTB = fp.
            find("li.dews-scheduler-dialog-repeatEvery-li").
            find(".dews-ui-numerictextbox");
            var repeatOnDays = fp.
            find("li.dews-scheduler-dialog-repeatOnDays-li").
            find(".dews-ui-checkbox.repeat-on");
            // 월 기간에서 매달 선택일
            var repeatOnDateNTB = fp.
            find("li.dews-scheduler-dialog-repeatOnDate-li").
            find(".dews-ui-numerictextbox");
            // 년 기간에서 매년 몇월 선택일
            var repeatOnMonthDDL = fp.
            find("li.dews-scheduler-dialog-repeatOnMonth-li").
            find(".dews-ui-dropdownlist");
            var repeatOnMonthDateNTB = fp.
            find("li.dews-scheduler-dialog-repeatOnMonth-li").
            find(".dews-ui-numerictextbox");
            // 반복 종료일
            // 반복 종료일 라디오 그룹
            var repeatEndRadios = fp.find(".dews-ui-radio.repeat-end");
            var repeatEndNeverRadio = fp.
            find("li.dews-scheduler-dialog-repeatEndNever-li").
            find(".dews-ui-radio");
            var repeatEndAfterRadio = fp.
            find("li.dews-scheduler-dialog-repeatEndAfter-li").
            find(".dews-ui-radio");
            var repeatEndOnRadio = fp.
            find("li.dews-scheduler-dialog-repeatEndOn-li").
            find(".dews-ui-radio");
            var repeatEndAfterNTB = fp.find(".dews-ui-numerictextbox.repeat-end");
            var repeatEndOnDT = fp.find(".dews-ui-datepicker.repeat-end");
            var descriptionTB = fp.find("li.dews-scheduler-dialog-description-li").find(".dews-ui-textbox");
            //buttonGroup
            var saveBtn = self.$content.find(
            ".dews-dialog-button-group .dews-ui-button.dews-scheduler-dialog-saveBtn");

            var cancelBtn = self.$content.find(
            ".dews-dialog-button-group .dews-ui-button.dews-scheduler-dialog-cancelBtn");


            // dewsControl
            dewsControl.fp = fp.data("dewsControl");
            dewsControl.titleTB = titleTB.data("dewsControl");
            dewsControl.startDT = startDT.data("dewsControl");
            dewsControl.startD = startD.data("dewsControl");
            dewsControl.endDT = endDT.data("dewsControl");
            dewsControl.endD = endD.data("dewsControl");
            dewsControl.allDayChk = allDayChk.data("dewsControl");
            dewsControl.repeatDDL = repeatDDL.data("dewsControl");
            dewsControl.repeatEveryNTB = repeatEveryNTB.data("dewsControl");
            dewsControl.repeatOnDays = repeatOnDays.data("dewsControl");
            dewsControl.repeatOnDateNTB = repeatOnDateNTB.data("dewsControl");
            dewsControl.repeatOnMonthDDL = repeatOnMonthDDL.data("dewsControl");
            dewsControl.repeatOnMonthDateNTB = repeatOnMonthDateNTB.data("dewsControl");
            dewsControl.repeatEndNeverRadio = repeatEndNeverRadio.data("dewsControl");
            dewsControl.repeatEndAfterRadio = repeatEndAfterRadio.data("dewsControl");
            dewsControl.repeatEndOnRadio = repeatEndOnRadio.data("dewsControl");
            dewsControl.repeatEndAfterNTB = repeatEndAfterNTB.data("dewsControl");
            dewsControl.repeatEndOnDT = repeatEndOnDT.data("dewsControl");
            dewsControl.descriptionTB = descriptionTB.data("dewsControl");
            dewsControl.saveBtn = saveBtn.data("dewsControl");
            dewsControl.cancelBtn = cancelBtn.data("dewsControl");

            // 반복 드롭다운리스트 데이터소스
            var repeat_ddl_dataSource = [
            {
              CD_REPEAT: "never",
              NM_REPEAT: dews.localize.get("없음", "dews_없음")
            },
            {
              CD_REPEAT: "daily",
              NM_REPEAT: dews.localize.get("매일", "dews_매일")
            },
            {
              CD_REPEAT: "weekly",
              NM_REPEAT: dews.localize.get("매주", "dews_매주")
            },
            {
              CD_REPEAT: "monthly",
              NM_REPEAT: dews.localize.get("매월", "dews_매월")
            },
            {
              CD_REPEAT: "yearly",
              NM_REPEAT: dews.localize.get("매년", "dews_매년")
            }];

            // 매년 반복 주기 달 드롭다운리스트 데이터소스
            var repeatOnMonth_ddl_dataSource = [
            {
              CD_MONTH: "0",
              NM_MONTH: dews.localize.get("1월", "dews_1월")
            },
            {
              CD_MONTH: "1",
              NM_MONTH: dews.localize.get("2월", "dews_2월")
            },
            {
              CD_MONTH: "2",
              NM_MONTH: dews.localize.get("3월", "dews_3월")
            },
            {
              CD_MONTH: "3",
              NM_MONTH: dews.localize.get("4월", "dews_4월")
            },
            {
              CD_MONTH: "4",
              NM_MONTH: dews.localize.get("5월", "dews_5월")
            },
            {
              CD_MONTH: "5",
              NM_MONTH: dews.localize.get("6월", "dews_6월")
            },
            {
              CD_MONTH: "6",
              NM_MONTH: dews.localize.get("7월", "dews_7월")
            },
            {
              CD_MONTH: "7",
              NM_MONTH: dews.localize.get("8월", "dews_8월")
            },
            {
              CD_MONTH: "8",
              NM_MONTH: dews.localize.get("9월", "dews_9월")
            },
            {
              CD_MONTH: "9",
              NM_MONTH: dews.localize.get("10월", "dews_10월")
            },
            {
              CD_MONTH: "10",
              NM_MONTH: dews.localize.get("11월", "dews_11월")
            },
            {
              CD_MONTH: "11",
              NM_MONTH: dews.localize.get("12월", "dews_12월")
            }];


            dewsControl.repeatDDL.setDataSource(repeat_ddl_dataSource);
            dewsControl.repeatOnMonthDDL.setDataSource(repeatOnMonth_ddl_dataSource);

            dewsControl.titleTB.text(initData.eventInfo.title);
            dewsControl.startD.value(initData.eventInfo.start);
            dewsControl.endD.value(initData.eventInfo.end);
            dewsControl.startDT.value(initData.eventInfo.start);
            dewsControl.descriptionTB.text(initData.eventInfo.description);
            if (eventInfo.isAllDay) {
              var endTime = new Date(eventInfo.end);
              endTime.setHours(23, 59, 59);
              dewsControl.endDT.value(new Date(endTime));
            } else {
              dewsControl.endDT.value(eventInfo.end);
            }

            if (!zone) {
              zone = "Etc/UTC";
            }

            thisDlg._dlgWidth = thisDlg.options.width;
            thisDlg._dlgHeight = thisDlg.options.height;

            if (eventInfo.isAllDay) {
              allDayChk.prop("checked", true);
              startDT.closest("li").css("display", "none");
              endDT.closest("li").css("display", "none");
            } else {
              allDayChk.prop("checked", false);
              startD.closest("li").css("display", "none");
              endD.closest("li").css("display", "none");
            }

            if (eventInfo._currentEdit) {
              repeatDDL.closest("li").css("display", "none");
            } else if (eventInfo.recurrenceRule) {
              rule = parseRule(eventInfo.recurrenceRule);

              if (rule.freq === "daily") {
                fp.find("li.addRepeatLi.daily").each(function (idx, li) {
                  $(li).css("display", "block");
                });
                dewsControl.repeatDDL.value("daily");
              } else if (rule.freq === "weekly") {
                fp.find("li.addRepeatLi.weekly").each(function (idx, li) {
                  $(li).css("display", "block");
                });
                dewsControl.repeatDDL.value("weekly");
              } else if (rule.freq === "monthly") {
                fp.find("li.addRepeatLi.monthly").each(function (idx, li) {
                  $(li).css("display", "block");
                });
                dewsControl.repeatDDL.value("monthly");
              } else if (rule.freq === "yearly") {
                fp.find("li.addRepeatLi.yearly").each(function (idx, li) {
                  $(li).css("display", "block");
                });
                dewsControl.repeatDDL.value("yearly");
              }
            }

            repeatEveryInit(self);
            repeatDayInit(self);
            repeatOnInit(self);
            repeatEndAfterInit(self);
            repeatOnDTInit(self);
            repeatEndRadioInit(self);

            // 반복 최기화
            // 반복간격
            function repeatEveryInit() {
              if (!eventInfo._currentEdit && rule.interval) {
                dewsControl.repeatEveryNTB.value(rule.interval);
              } else {
                dewsControl.repeatEveryNTB.value("1");
              }
            }

            // 반복요일
            function repeatDayInit() {
              var checkedDays = [];

              if (!eventInfo._currentEdit && rule.weekDays && rule.weekDays.length > 0) {
                for (var i = 0; i < rule.weekDays.length; i++) {
                  checkedDays[rule.weekDays[i].day] = true;
                }
              }
              repeatOnDays.each(function (idx, input) {
                if (checkedDays.length > 0 && checkedDays[idx]) {
                  $(input).prop("checked", true);
                } else {
                  $(input).prop("checked", false);
                }
              });

              if (!eventInfo._currentEdit && !rule.weekDays) {
                repeatOnDays.eq(eventInfo.start.getDay()).prop("checked", true);
              }
            }

            // 반복 주기
            function repeatOnInit() {
              dewsControl.repeatOnMonthDDL.value(eventInfo.start.getMonth());
              dewsControl.repeatOnDateNTB.value(eventInfo.start.getDate());
              dewsControl.repeatOnMonthDateNTB.value(eventInfo.start.getDate());
            }

            // 반복 종료 - 반복
            function repeatEndAfterInit() {
              if (!eventInfo._currentEdit && rule.count) {
                dewsControl.repeatEndAfterNTB.value(rule.count);
              } else {
                dewsControl.repeatEndAfterNTB.value("1");
              }
            }

            // 반복 종료 - 날짜
            function repeatOnDTInit() {
              var date;

              if (!eventInfo._currentEdit && rule.until) {
                if ($.type(rule.until) === "string") {
                  date = kendo.parseDate(
                  rule.until,
                  dews._environments.formats.dateValueFormat,
                  kendo.getCulture());

                } else {
                  date = rule.until;
                }
              } else {
                date = eventInfo.end;
              }

              dewsControl.repeatEndOnDT.value(date);
            }

            // 반복 종료 - 라디오 버튼 초기화
            function repeatEndRadioInit() {
              var index = 0;

              if (!eventInfo._currentEdit && rule.count) {
                index = 1;
                dewsControl.repeatEndAfterNTB.enable(true);
                dewsControl.repeatEndOnDT.enable(false);
              } else if (!eventInfo._currentEdit && rule.until) {
                index = 2;
                dewsControl.repeatEndAfterNTB.enable(false);
                dewsControl.repeatEndOnDT.enable(true);
              } else {
                dewsControl.repeatEndAfterNTB.enable(false);
                dewsControl.repeatEndOnDT.enable(false);
              }

              repeatEndRadios.each(function (idx, radio) {
                if (idx === index) {
                  $(radio).prop("checked", true);
                } else {
                  $(radio).prop("checked", false);
                }
              });
            }

            // 자원 초기화
            if (resources.length > 0) {
              var innerHtml;

              for (var inx = 0; inx < resources.length; inx++) {
                var resourceValue, resourceText;

                if (resources[inx].dataValueField) {
                  resourceValue = resources[inx].dataValueField;
                } else {
                  resourceValue = "value";
                }

                if (resources[inx].dataTextField) {
                  resourceText = resources[inx].dataTextField;
                } else {
                  resourceText = "text";
                }

                if (resources[inx].multiple) {
                  innerHtml =
                  "<li>\n" +
                  '        <label style="width: 116px">' +
                  resources[inx].title +
                  "</label>\n" +
                  "        <span>\n" +
                  '          <select class="' +
                  resources[inx].field +
                  '" style="width: 350px"></select>\n' +
                  "        </span>\n" +
                  "      </li>";

                  fp.find("ul").append($(innerHtml));

                  var multiDDL = dews.ui.multidropdownlist(fp.find("." + resources[inx].field + ""), {
                    dataValueField: resourceValue,
                    dataTextField: resourceText
                  });

                  multiDDL.options._resourceId = resources[inx].field;
                  multiDDL.setDataSource(resources[inx].dataSource);

                  multiDDL.$wrapper.css("width", 350);

                  if (eventInfo[multiDDL.options._resourceId]) {
                    for (var i = 0; i < eventInfo[multiDDL.options._resourceId].length; i++) {
                      multiDDL.values(
                      eventInfo[multiDDL.options._resourceId][i][
                      multiDDL.options.dataValueField]);


                    }
                  }

                  multiDDL.on("close", function (e) {
                    outData[e.multidropdownlist.options._resourceId] =
                    e.multidropdownlist.selectedDataItems();
                  });
                } else {
                  innerHtml =
                  "<li>\n" +
                  '        <label style="width: 116px">' +
                  resources[inx].title +
                  "</label>\n" +
                  "        <span>\n" +
                  '          <select class="' +
                  resources[inx].field +
                  '" style="width: 350px"></select>\n' +
                  "        </span>\n" +
                  "      </li>";

                  fp.find("ul").append($(innerHtml));

                  var ddl = dews.ui.dropdownlist(fp.find("." + resources[inx].field + ""), {
                    dataValueField: resourceValue,
                    dataTextField: resourceText,
                    dataSource: resources[inx].dataSource,
                    optionLabel: " "
                  });

                  ddl.options._resourceId = resources[inx].field;
                  ddl.setDataSource(resources[inx].dataSource);

                  if (eventInfo[ddl.options._resourceId]) {
                    ddl.value(eventInfo[ddl.options._resourceId]);
                  }

                  ddl.on("close", function (e) {
                    outData[e.sender.options._resourceId] = e.sender.value();
                  });
                }
              }
            }

            thisDlg._dlgHeight = fp.height() + 84;

            self.resize(thisDlg._dlgWidth, thisDlg._dlgHeight);

            // 이벤트
            dewsControl.startDT.on("change", function (e) {
              var date = new Date(dewsControl.startDT.text());

              dewsControl.startD.value(date);

              dewsControl.endDT.min(dewsControl.startDT.value());
            });

            dewsControl.endDT.on("change", function (e) {
              var date = new Date(dewsControl.endDT.text());

              dewsControl.endD.value(date);

              dewsControl.startDT.max(dewsControl.endDT.value());
            });

            dewsControl.startD.on("change", function (e) {
              var date = new Date(dewsControl.startD.text());
              date.setHours(0);

              dewsControl.startDT.value(date);

              dewsControl.endD.min(dewsControl.startD.value());
            });

            dewsControl.endD.on("change", function (e) {
              var date = new Date(dewsControl.endD.text());
              date.setHours(23, 59, 59);

              dewsControl.endDT.value(date);

              dewsControl.startD.max(dewsControl.endD.value());
            });

            dewsControl.allDayChk.on("change", function (e) {
              if (allDayChk.get()[0].checked) {
                startD.closest("li").css("display", "block");
                endD.closest("li").css("display", "block");
                startDT.closest("li").css("display", "none");
                endDT.closest("li").css("display", "none");

                dewsControl.startD.kendoInstance.trigger("change");
                dewsControl.endD.kendoInstance.trigger("change");

                outData.isAllDay = true;
              } else {
                startD.closest("li").css("display", "none");
                endD.closest("li").css("display", "none");
                startDT.closest("li").css("display", "block");
                endDT.closest("li").css("display", "block");

                dewsControl.startDT.kendoInstance.trigger("change");
                dewsControl.endDT.kendoInstance.trigger("change");

                outData.isAllDay = false;
              }
            });

            dewsControl.repeatDDL.on("select", function (e) {
              var repeatMode,
                repeatEveryLabel = "";

              var fpHeight = fp.height();
              var addHeight;

              rule = {};
              // 반복 초기화
              repeatEveryInit(self);
              repeatDayInit(self);
              repeatOnInit(self);
              repeatEndAfterInit(self);
              repeatOnDTInit(self);
              repeatEndRadioInit(self);

              if (e.dataItem.CD_REPEAT === "daily") {
                repeatEveryLabel = dews.localize.get("일", "dews_일");

                repeatMode = "daily";
              } else if (e.dataItem.CD_REPEAT === "weekly") {
                repeatEveryLabel = dews.localize.get("주", "dews_주");

                repeatMode = "weekly";
                rule.weekDays = [
                {
                  offset: 0,
                  day: eventInfo.start.getDay()
                }];

              } else if (e.dataItem.CD_REPEAT === "monthly") {
                repeatEveryLabel = dews.localize.get("월", "dews_월");

                repeatMode = "monthly";
                rule.monthDays = [dewsControl.repeatOnDateNTB.value()];
              } else if (e.dataItem.CD_REPEAT === "yearly") {
                repeatEveryLabel = dews.localize.get("년", "dews_년");

                repeatMode = "yearly";
                rule.count = null;
                rule.positions = null;
                rule.until = null;
                rule.weekDays = null;
                rule.months = [(parseInt(dewsControl.repeatOnMonthDDL.value()) + 1).toString()];
                rule.monthDays = [dewsControl.repeatOnMonthDateNTB.value()];
              }

              rule.freq = repeatMode;

              liList.each(function (idx, li) {
                if ($(li).hasClass("addRepeatLi")) {
                  if ($(li).hasClass(repeatMode)) {
                    $(li).css("display", "block");
                  } else {
                    $(li).css("display", "none");
                  }
                }
              });

              fp.find(".repeat-every-label").text(repeatEveryLabel);

              addHeight = fp.height() - fpHeight;
              thisDlg._dlgHeight = thisDlg._dlgHeight + addHeight;

              thisDlg.resize(thisDlg.options.width, thisDlg._dlgHeight);
            });

            dewsControl.repeatEveryNTB.on("change", function (e) {
              rule.interval = e.sender.text();
            });

            dewsControl.repeatEndAfterNTB.on("change", function (e) {
              rule.count = e.sender.text();
            });

            repeatOnDays.on("change", function (e) {
              rule.weekDays = [];
              repeatOnDays.each(function (idx, checkbox) {
                var obj = { offset: 0 };
                if (checkbox.checked) {
                  obj.day = idx;
                  rule.weekDays.push(obj);
                }
              });
            });

            dewsControl.repeatOnDateNTB.on("change", function (e) {
              rule.monthDays = [dewsControl.repeatOnDateNTB.value()];
            });

            dewsControl.repeatOnMonthDDL.on("close", function (e) {
              rule.months = [(parseInt(dewsControl.repeatOnMonthDDL.value()) + 1).toString()];
            });

            dewsControl.repeatOnMonthDateNTB.on("change", function (e) {
              rule.monthDays = [dewsControl.repeatOnMonthDateNTB.value()];
            });

            // 반복 종료 라디오 버튼 클릭 이벤트
            repeatEndRadios.on("click", function (e) {
              repeatEndRadios.each(function (idx, radio) {
                if (e.target !== repeatEndRadios[idx]) {
                  $(radio).prop("checked", false);
                }
                if (e.target === repeatEndRadios[1]) {
                  dewsControl.repeatEndAfterNTB.enable(true);
                  dewsControl.repeatEndOnDT.enable(false);
                  rule.count = dewsControl.repeatEndAfterNTB.value();
                  rule.until = null;
                } else if (e.target === repeatEndRadios[2]) {
                  dewsControl.repeatEndAfterNTB.enable(false);
                  dewsControl.repeatEndOnDT.enable(true);
                  rule.count = null;
                  rule.until = new Date(dewsControl.repeatEndOnDT.text());
                } else {
                  dewsControl.repeatEndAfterNTB.enable(false);
                  dewsControl.repeatEndOnDT.enable(false);
                  rule.count = null;
                  rule.until = null;
                }
              });
            });

            dewsControl.repeatEndOnDT.on("change", function (e) {
              rule.until = new Date(dewsControl.repeatEndOnDT.text());
            });

            saveBtn.on("click", function (e) {
              if (outData.isAllDay) {
                outData.start = dewsControl.startD.text();
                outData.end = dewsControl.endD.text();
              } else {
                outData.start = dewsControl.startDT.text();
                outData.end = dewsControl.endDT.text();
              }

              outData.title = dewsControl.titleTB.text();

              if (dewsControl.repeatDDL.value() === "never") {
                outData.recurrenceRule = "";
              } else {
                outData.recurrenceRule = serialize(rule, zone);
              }

              outData.description = dewsControl.descriptionTB.text();

              thisDlg.options.saveBtn = true;
              thisDlg.ok(outData);
            });

            cancelBtn.on("click", function (e) {
              thisDlg.cancel(eventInfo);
            });

            function serialize(rule, zone) {
              var weekStart = rule.weekStart;
              var ruleString = "FREQ=" + rule.freq.toUpperCase();
              var exdates = rule.exdates || "";
              var start = rule.start || "";
              var end = rule.end || "";
              var until = rule.until;

              if (rule.interval > 1) {
                ruleString += ";INTERVAL=" + rule.interval;
              }
              if (rule.count) {
                ruleString += ";COUNT=" + rule.count;
              }
              if (until) {
                until = kendo.timezone.convert(until, zone || until.getTimezoneOffset(), "Etc/UTC");
                ruleString += ";UNTIL=" + kendo.toString(until, "yyyyMMddTHHmmssZ");
              }
              if (rule.months) {
                ruleString += ";BYMONTH=" + rule.months;
              }
              if (rule.weeks) {
                ruleString += ";BYWEEKNO=" + rule.weeks;
              }
              if (rule.yearDays) {
                ruleString += ";BYYEARDAY=" + rule.yearDays;
              }
              if (rule.monthDays) {
                ruleString += ";BYMONTHDAY=" + rule.monthDays;
              }
              if (rule.weekDays) {
                ruleString += ";BYDAY=" + serializeWeekDayList(rule.weekDays);
              }
              if (rule.hours) {
                ruleString += ";BYHOUR=" + rule.hours;
              }
              if (rule.minutes) {
                ruleString += ";BYMINUTE=" + rule.minutes;
              }
              if (rule.seconds) {
                ruleString += ";BYSECOND=" + rule.seconds;
              }
              if (rule.positions) {
                ruleString += ";BYSETPOS=" + rule.positions;
              }
              if (weekStart !== undefined) {
                ruleString += ";WKST=" + WEEK_DAYS[weekStart];
              }
              if (start) {
                start = "DTSTART" + serializeDateRule(start, zone);
              }
              if (end) {
                end = "DTEND" + serializeDateRule(end, zone);
              }
              if (exdates) {
                exdates = "EXDATE" + serializeDateRule(exdates, zone);
              }
              if (start || end || exdates) {
                ruleString = start + end + exdates + "RRULE:" + ruleString;
              }
              return ruleString;
            }

            function serializeWeekDayList(list) {
              var idx = 0,
                length = list.length,
                value,
                valueString,
                result = [];
              for (; idx < length; idx++) {
                value = list[idx];
                if (typeof value === "string") {
                  valueString = value;
                } else {
                  valueString = "" + WEEK_DAYS[value.day];
                  if (value.offset) {
                    valueString = value.offset + valueString;
                  }
                }
                result.push(valueString);
              }
              return result.toString();
            }

            function serializeDateRule(dateRule, zone) {
              var value = dateRule.value;
              var tzid = dateRule.tzid || "";
              var length = value.length;
              var idx = 0;
              var val;
              for (; idx < length; idx++) {
                val = value[idx];
                val = kendo.timezone.convert(val, tzid || zone || val.getTimezoneOffset(), "Etc/UTC");
                value[idx] = kendo.toString(val, "yyyyMMddTHHmmssZ");
              }
              if (tzid) {
                tzid = ";TZID=" + tzid;
              }
              return tzid + ":" + value.join(",") + " ";
            }

            function parseWeekDayList(list) {
              var idx = 0,
                length = list.length,
                value,
                valueLength,
                day;
              for (; idx < length; idx++) {
                value = list[idx];
                valueLength = value.length;
                day = value.substring(valueLength - 2).toUpperCase();
                day = WEEK_DAYS_IDX[day];
                if (day === undefined) {
                  return null;
                }
                list[idx] = {
                  offset: parseInt(value.substring(0, valueLength - 2), 10) || 0,
                  day: day
                };
              }
              return list;
            }

            function parseArray(list, range) {
              var idx = 0,
                length = list.length,
                value;
              for (; idx < length; idx++) {
                value = parseInt(list[idx], 10);
                if (
                isNaN(value) ||
                value < range.start ||
                value > range.end ||
                value === 0 && range.start < 0)
                {
                  return null;
                }
                list[idx] = value;
              }
              return list.sort(numberSortPredicate);
            }

            function numberSortPredicate(a, b) {
              return a - b;
            }

            function parseRule(recur, zone) {
              var instance = {};
              var splits, value;
              var idx = 0,
                length;
              var ruleValue = false;
              var rRule;
              var property, weekStart, weekDays;
              var predicate = function predicate(a, b) {
                var day1 = a.day,
                  day2 = b.day;
                if (day1 < weekStart) {
                  day1 += 7;
                }
                if (day2 < weekStart) {
                  day2 += 7;
                }
                return day1 - day2;
              };
              if (!recur) {
                return null;
              }
              rRule = recur.split(";");
              for (idx = 0, length = rRule.length; idx < length; idx++) {
                property = rRule[idx];
                splits = property.split("=");
                value = $.trim(splits[1]).split(",");
                switch ($.trim(splits[0]).toUpperCase()) {
                  case "FREQ":
                    instance.freq = value[0].toLowerCase();
                    break;
                  case "UNTIL":
                    // instance.until = parseUTCDate(value[0], zone);
                    instance.until = value[0];
                    break;
                  case "COUNT":
                    instance.count = parseInt(value[0], 10);
                    break;
                  case "INTERVAL":
                    instance.interval = parseInt(value[0], 10);
                    break;
                  case "BYSECOND":
                    instance.seconds = parseArray(value, {
                      start: 0,
                      end: 60
                    });
                    ruleValue = true;
                    break;
                  case "BYMINUTE":
                    instance.minutes = parseArray(value, {
                      start: 0,
                      end: 59
                    });
                    ruleValue = true;
                    break;
                  case "BYHOUR":
                    instance.hours = parseArray(value, {
                      start: 0,
                      end: 23
                    });
                    ruleValue = true;
                    break;
                  case "BYMONTHDAY":
                    instance.monthDays = parseArray(value, {
                      start: -31,
                      end: 31
                    });
                    ruleValue = true;
                    break;
                  case "BYYEARDAY":
                    instance.yearDays = parseArray(value, {
                      start: -366,
                      end: 366
                    });
                    ruleValue = true;
                    break;
                  case "BYMONTH":
                    instance.months = parseArray(value, {
                      start: 1,
                      end: 12
                    });
                    ruleValue = true;
                    break;
                  case "BYDAY":
                    instance.weekDays = weekDays = parseWeekDayList(value);
                    ruleValue = true;
                    break;
                  case "BYWEEKNO":
                    instance.weeks = parseArray(value, {
                      start: -53,
                      end: 53
                    });
                    ruleValue = true;
                    break;
                  case "BYSETPOS":
                    instance.positions = parseArray(value, {
                      start: -366,
                      end: 366
                    });
                    break;
                  case "WKST":
                    instance.weekStart = weekStart = WEEK_DAYS_IDX[value[0]];
                    break;}

              }
              if (instance.freq === undefined || instance.count !== undefined && instance.until) {
                return null;
              }
              if (!instance.interval) {
                instance.interval = 1;
              }
              if (weekStart === undefined) {
                instance.weekStart = weekStart = kendo.culture().calendar.firstDay;
              }
              if (weekDays) {
                instance.weekDays = weekDays.sort(predicate);
              }
              if (instance.positions && !ruleValue) {
                instance.positions = null;
              }
              instance._hasRuleValue = ruleValue;
              return instance;
            }
          });
        },
        ok: function ok(data) {
          data.start = new Date(data.start);
          data.end = new Date(data.end);
          data = sc._convertData(data, true);

          if (data.toJSON) {
            data.toJSON();
          }
          if (!equals(originDataJSON, data)) {
            var eventParameter = {
              action: "dataChange",
              items: data
            };

            if (self.element.data("dewsControl").dataSource) {
              self.element.data("dewsControl").dataSource.trigger("change", eventParameter);
            }
          }

          if (data._isNew) {
            data._isNew = false;
          }

          self.refresh();
        },
        cancel: function cancel(data) {
          if (model._isNew || model._currentEdit) {
            self.dataSource.remove(model);
            self.dataSource._removeExceptionDate(model);
          }

          if (model._isNew) {
            model._isNew = false;
          }
        },
        close: function close() {
          if (!editDlg.options.saveBtn) {
            if (model._isNew || model._currentEdit) {
              self.dataSource.remove(model);
              self.dataSource._removeExceptionDate(model);
            }

            if (model._isNew) {
              model._isNew = false;
            }
          }
        }
      });

      editDlg.open();
    }
    self._bindResize();
  };

  kendo.ui.Scheduler.fn._removeEvent = function (model) {
    var self = this;
    var sc = self.element.data("dewsControl"),
      event;

    if (model.taskId) {
      event = sc.dataSource._getByTaskId(model.taskId);
    } else {
      var index = dataIndex(self._data, model.uid);
      event = sc._data[index];
    }

    if (!self.trigger("remove", { event: event, scheduler: sc })) {
      self.dataSource.remove(model);
    }
  };

  kendo.ui.Scheduler.fn._updateEvent = function (dir, event, eventInfo, groupIndex) {
    var that = this;
    var updateEvent = function updateEvent(event, callback) {
      try {
        eventInfo.isAllDay = event.isAllDay;
        that._preventRefresh = true;
        event.update(eventInfo);
        that._convertDates(event);
      } finally {
        that._preventRefresh = false;
      }
      if (!that.trigger("save", { event: event })) {
        if (callback) {
          callback();
        }
        that._updateSelection(event, [event.uid], groupIndex);
        that.refresh();
      }
    };
    var recurrenceHead = function recurrenceHead(event) {
      if (event.recurrenceRule) {
        return that.dataSource.getByUid(event.uid);
      } else {
        return that.dataSource.get(event.recurrenceId);
      }
    };
    var updateSeries = function updateSeries() {
      var head = recurrenceHead(event);
      if (dir == "south" || dir == "north") {
        if (eventInfo.start) {
          var start = kendo.date.getDate(head.start);
          kendo.date.setTime(start, kendo.date.getMilliseconds(eventInfo.start));
          eventInfo.start = start;
        }
        if (eventInfo.end) {
          var end = kendo.date.getDate(head.end);
          kendo.date.setTime(end, kendo.date.getMilliseconds(eventInfo.end));
          eventInfo.end = end;
        }
      }
      that.dataSource._removeExceptions(head);
      updateEvent(head);
    };
    var updateOccurrence = function updateOccurrence() {
      var head = recurrenceHead(event);
      var callback = function callback() {
        that._convertDates(head);
      };
      var exception = head.toOccurrence({
        start: event.start,
        end: event.end
      });
      exception._currentEdit = true;
      exception._isNew = true;
      exception.taskId = guid();
      exception.id = exception.taskId;
      updateEvent(that.dataSource.add(exception), callback);
    };
    if (event.recurrenceRule || event.isOccurrence()) {
      var recurrenceMessages = dews.
      confirm("전체 스케줄을 수정 하시겠습니까?\n(예: 전체 스케줄, 아니오: 현재 스케줄)", true).
      yes(function () {
        updateSeries();
      }).
      no(function () {
        updateOccurrence();
      });
    } else {
      updateEvent(that.dataSource.getByUid(event.uid));
    }
  };

  kendo.data.SchedulerDataSource.fn.insert = function (index, model) {
    if (!model) {
      return;
    }
    if (!(model instanceof kendo.data.SchedulerEvent)) {
      var eventInfo = model;
      model = this._createNewModel();
      model.accept(eventInfo);
    }
    if (
    !this._pushCreated && (
    model.isRecurrenceHead() || model.recurrenceId) && (
    !model._isNew || model._currentEdit))
    {
      model = model.recurrenceId ? model : model.toOccurrence();
      this._addExceptionDate(model);
    }

    return kendo.data.DataSource.fn.insert.call(this, index, model);
  };

  kendo.ui.MonthView.fn._createRow = function (startDate, startIdx, cellsPerRow, groupIndex) {
    var that = this;
    var min = that._firstDayOfMonth;
    var max = that._lastDayOfMonth;
    var content = that.dayTemplate;
    var classes = "";
    var html = "";
    var groupedView = this._groupedView;
    var resources = function resources() {
      return that._resourceBySlot({ groupIndex: groupIndex });
    };
    var holidaysData,
      holidayData,
      currentYear = that.options.date.getFullYear();
    if (that.element.data("dewsControl")) {
      holidaysData = that.element.data("dewsControl")._holiday;
    }

    for (var cellIdx = 0; cellIdx < cellsPerRow; cellIdx++) {
      if (holidaysData && holidaysData[currentYear]) {
        holidayData = _isHoliday(startDate, holidaysData);
      }
      classes = "";
      if (kendo.date.isToday(startDate)) {
        classes += "k-today";
      }
      if (!kendo.date.isInDateRange(startDate, min, max)) {
        classes += " k-other-month";
      } else if (holidayData) {
        classes += " dews-holiday";
      }
      if (startDate.getDay() === 0) {
        classes += " content-sun";
      }
      if (startDate.getDay() === 6) {
        classes += " content-sat";
      }
      html += "<td ";
      if (classes !== "") {
        html += 'class="' + classes + '"';
      }
      html += ">";
      html += groupedView._getContent(content, startDate, resources, cellIdx);
      // group date true 사용 시 공백 추가
      if (groupedView._view.options.group && groupedView._view.options.group.date) {
        if (cellIdx === 0) {
          if (holidayData && kendo.date.isInDateRange(startDate, min, max)) {
            html += '<span class="dews-scheduler-holidayName">  ' + holidayData.name + "</span>";
          }
        } else {
          html += "<span>&nbsp;</span>";
        }
      }
      html += "</td>";
      that._slotIndices[kendo.date.getDate(startDate).getTime()] = startIdx + cellIdx;
      startDate = groupedView._nextSlotStartDate(startDate);
    }
    return html;
  };

  kendo.ui.MultiDayView.fn._addCellsToContent = function (content, dates, date, idx, groupIdx, rowIdx) {
    var that = this;
    var classes = "";
    var tmplDate;
    var slotTemplate = this.slotTemplate;
    var isVerticalGroupped = this._groupOrientation() === "vertical";
    var resources = function resources(groupIndex) {
      return function () {
        return that._resourceBySlot({ groupIndex: groupIndex });
      };
    };
    if (kendo.date.isToday(dates[idx])) {
      classes += "k-today";
    }
    if (
    kendo.date.getMilliseconds(date) < kendo.date.getMilliseconds(this.options.workDayStart) ||
    kendo.date.getMilliseconds(date) >= kendo.date.getMilliseconds(this.options.workDayEnd) ||
    !this._isWorkDay(dates[idx]))
    {
      classes += " k-nonwork-hour";
    }
    if (dates[idx].getDay() === 0) {
      classes += " content-sun";
    }
    if (dates[idx].getDay() === 6) {
      classes += " content-sat";
    }
    content += "<td" + (classes !== "" ? ' class="' + classes + '"' : "") + ">";
    tmplDate = kendo.date.getDate(dates[idx]);
    kendo.date.setTime(tmplDate, kendo.date.getMilliseconds(date));
    content += slotTemplate({
      date: tmplDate,
      resources: resources(isVerticalGroupped && !that._isGroupedByDate() ? rowIdx : groupIdx)
    });
    content += "</td>";
    return content;
  };

  // view data index 검색
  function dataIndex(data, uid) {
    var index;
    for (var i = 0; i < data.length; i++) {
      if (data[i].uid === uid) {
        index = i;
        break;
      }
    }
    return index;
  }

  // object 비교 함수
  function equals(x, y) {
    if (x === y) return true;
    if (!(x instanceof Object) || !(y instanceof Object)) return false;
    if (x.constructor !== y.constructor) return false;
    for (var p in x) {
      if (!x.hasOwnProperty(p)) continue;
      if (!y.hasOwnProperty(p)) return false;
      if (x[p] === y[p]) continue;
      if (_typeof(x[p]) !== "object") return false;
      if (!equals(x[p], y[p])) return false;
    }

    for (p in y) {
      if (y.hasOwnProperty(p) && !x.hasOwnProperty(p)) return false;
    }

    return true;
  }

  $.extend(true, dews, {
    /**
     * @namespace
     */
    ui: {
      scheduler: function scheduler(selector, options) {
        var $el, scheduler, $content;

        if (dews.ui.dialogPage) {
          $content = dews.ui.dialogPage.$content;
        } else if (dews.ui.page) {
          $content = dews.ui.page.$content;
        } else {
          $content = $(document);
        }

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector, $content);
        }

        if ($.type(selector) === "undefined") {
          return;
        }

        $el.each(function () {
          var $this = $(this),
            sc;

          sc = $this.data("dews-control");

          if (!sc) {
            if ($.type(options) === "undefined") {
              options = {};
            }
            options.$content = $content;

            sc = new Scheduler($this, options);
            $this.data("dews-control", sc);

            if (!$this.hasClass("dews-ui-scheduler")) {
              $this.addClass("dews-ui-scheduler");
            }

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }
          }
          scheduler = sc;
        });

        return scheduler;
      }
    }
  });
})(jQuery, window.dews || {}, window.kendo);


/*
 * 심플 페이저
 * 페이징 기능을 이용하는 그리드 및 리스트를 위한 페이저 컨트롤
 * 데이터 소스와 연동으로 페이징하는 것이 아닌 UI 요소를 그려주는 역할만 수행
 */
(function ($, dews) {
  var defaultOptions = {
    total: 1,
    current: 1,
    buttonCount: 10
  };

  /**
   * 기본 옵션과 HTML 코드에 지정된 옵션, 자바스크립트 코드에서 지정된 옵션을 합쳐서 완전한 옵션을 만듭니다.
   * @param {jQuery} $element 대상 요소
   * @param {object} options 자바스크립트 코드
   * @returns {object} 병합된 옵션
   */
  function makeOptions($element, options) {
    var inlineOptions, combinedOptions;

    options = options || {};
    inlineOptions = getInlineOptions($element);
    combinedOptions = $.extend(true, {}, defaultOptions, inlineOptions, options);

    return combinedOptions;
  }

  /**
   * HTML 코드에 data 로 지정된 옵션을 가져온다.
   * @param {jQuery} $element 대상 요소
   * @returns {object} 옵션
   */
  function getInlineOptions($element) {
    var options = {},
      total,
      current,
      buttonCount;

    if ($element) {
      total = $element.data("dews-total");
      current = $element.data("dews-current");
      buttonCount = $element.data("dews-button-count");

      if (/^[0-9]+$/.test(total)) {
        // 숫자로만 구성되어 있다면 HTML 코드에 전체 페이지수를 직접 입력한 것이므로 Number 형식으로 변환
        total = parseInt(total, 10);
      }

      if (typeof total !== "undefined") {
        options.total = total;
      }

      if (/^[0-9]+$/.test(current)) {
        // 현재 페이지가 설정되어 있다면 항상 숫자
        current = parseInt(current, 10);
        options.current = current;
      }

      if (/^[0-9]+$/.test(current)) {
        // 버튼 갯수가 설정되어 있다면 항상 숫자
        current = parseInt(buttonCount, 10);
        options.buttonCount = current;
      }
    }

    return options;
  }

  /**
   * 심플 페이저의 클래스
   * @param {jQuery} element 대상 요소
   * @param {object} [options] 옵션
   * @constructor
   */
  function SimplePager(element, options) {
    var self = this;

    self.options = makeOptions(element, options);
    self.element = element;
    self._total = self._getTotalPageCount();
    self._current = self.options.current;

    // 생성자에서 초기 설정할 이후에는 설정 페이지에는
    delete self.options.current;

    // 컨트롤 생성
    self._render();

    self.element.on("change", function (e) {
      // 페이지 변경 이벤트 발생 시 버튼 등의 UI 변경 처리
      var page = e.page,
        $selected;

      if (self.element.find(".dews-simplepager-" + page.toString()).length === 0) {
        self._render();
      } else {
        $selected = self.element.find(".dews-simplepager-selected");

        if ($selected.length > 0) {
          $selected.removeClass("dews-simplepager-selected");
        }

        $selected = self.element.find(".dews-simplepager-" + page.toString());
        $selected.addClass("dews-simplepager-selected");
      }
    });
  }

  /**
   * 전체 페이지 갯수를 가져옵니다.
   * @private
   */
  SimplePager.prototype._getTotalPageCount = function () {
    var self = this,
      value = 1;

    switch ($.type(self.options.total)) {
      case "number":
        value = self.options.total;
        break;
      case "string":
        dews.ajax.
        data(self.options.total, {
          async: false
        }).
        done(function (data) {
          // AJAX 에서 받아온 데이터를 설정
          value = data;
        }).
        fail(function () {
          console.log("## dews.ui.simplepage : 전체 페이지를 가져올 수 없습니다. ##");
        });
        break;
      case "function":
        value = self.options.total.call(self);
        break;}


    return value;
  };

  /**
   * 페이지 번호를 받아서 페이징을 시작 번호를 가져옵니다.
   * @param {number} [page] 현재 페이지 번호
   * @returns {number} 페이징의 시작 번호
   * @private
   */
  SimplePager.prototype._getStartNumber = function (page) {
    var self = this,
      displayCount = self.options.buttonCount,
      start;

    if (typeof page === "undefined") {
      page = self._current;
    }

    start = Math.floor((page - 1) / displayCount) * displayCount + 1;

    return start;
  };

  /**
   * 페이지 번호를 받아와 페이징의 끝 번호를 가져옵니다.
   * @param {number} [page] 현재 페이지 번호
   * @returns {number} 페이징의 끝 번호
   * @private
   */
  SimplePager.prototype._getEndNumber = function (page) {
    var self = this,
      displayCount = self.options.buttonCount,
      end;

    if (typeof page === "undefined") {
      page = self._current;
    }

    end = Math.floor((page - 1) / displayCount) * displayCount + displayCount;

    if (end > self._total) {
      end = self._total;
    }

    return end;
  };

  /**
   * 처음으로 버튼의 페이지 번호를 가져옵니다.
   * @returns {number} 첫 페이지의 번호
   * @private
   */
  SimplePager.prototype._getFirstNumber = function () {
    return 1;
  };

  /**
   * 이전 버튼의 페이지 번호를 가져옵니다.
   * @param {number} [page] 현재 페이지 번호
   * @returns {number} 이전 버튼의 페이지 번호
   * @private
   */
  SimplePager.prototype._getPreviousNumber = function (page) {
    var self = this,
      displayCount = self.options.buttonCount,
      prev;

    if (typeof page === "undefined") {
      page = self._current;
    }

    prev = (Math.floor((page - 1) / displayCount) - 1) * displayCount + 1;

    if (prev <= 0) {
      prev = self._current;
    }

    return prev;
  };

  /**
   * 다음 버튼의 페이지 번호를 가져옵니다.
   * @param {number} [page] 현재 페이지 번호
   * @returns {number} 다음 버튼의 페이지 번호
   * @private
   */
  SimplePager.prototype._getNextNumber = function (page) {
    var self = this,
      displayCount = self.options.buttonCount,
      next;

    if (typeof page === "undefined") {
      page = self._current;
    }

    next = (Math.floor((page - 1) / displayCount) + 1) * displayCount + 1;

    if (next > self._total) {
      next = self._current;
    }

    return next;
  };

  /**
   * 마지막으로 버튼의 페이지 번호를 가져옵니다.
   * @returns {number} 마지막 페이지의 번호
   * @private
   */
  SimplePager.prototype._getLastNumber = function () {
    var self = this;

    return self._total;
  };

  /**
   * 현재 페이지의 번호를 설정합니다.
   * @param {number} page 페이지 번호
   */
  SimplePager.prototype.setPage = function (page) {
    var self = this;

    if ($.type(page) === "number") {
      page = Math.floor(page);
    } else {
      page = parseInt(page, 10);
    }

    if (page <= 0) {
      page = 1;
    } else if (page > self._total) {
      page = self._total;
    }

    if (page !== self._current) {
      self._current = page;

      // 페이지 변경 이벤트 발생
      self._triggerPageChanged(self._current);
    }
  };

  /**
   * 현재 페이지 번호를 가져옵니다.
   * @returns {number} 현재 페이지 번호
   */
  SimplePager.prototype.getPage = function () {
    return this._current;
  };

  /**
   * 페이지가 변경되었다는 이벤트를 발생시킵니다.
   * @param page 변경된 페이지 번호
   * @private
   */
  SimplePager.prototype._triggerPageChanged = function (page) {
    var self = this,
      evt;

    evt = new $.Event("change", {
      page: page
    });

    dews.log("## dews-ui-simplepager : change 이벤트 발생 ##\n" + "e.page: " + evt.page.toString());

    self.element.trigger(evt);
  };

  /**
   * 심플 페이저 컨트롤을 그립니다.
   * @private
   */
  SimplePager.prototype._render = function () {
    var self = this,
      pageItemTemplate = '<a href="{1}" class="dews-simplepager-button" title="{0}">{0}</a>',
      $first,
      $prev,
      $next,
      $last;

    self.element.empty();

    $first = $(dews.string.format(pageItemTemplate, dews.localize.get("dews_처음"), "#" + self._getFirstNumber()));
    $first.data("page", self._getFirstNumber());
    $first.addClass("dews-simplepager-image");
    $first.addClass("dews-simplepager-first");

    self.element.append($first);

    $prev = $(
    dews.string.format(pageItemTemplate, dews.localize.get("dews_이전"), "#" + self._getPreviousNumber()));

    $prev.data("page", self._getPreviousNumber());
    $prev.addClass("dews-simplepager-image");
    $prev.addClass("dews-simplepager-prev");

    self.element.append($prev);

    for (var i = self._getStartNumber(); i <= self._getEndNumber(); i++) {
      var $btn = $(dews.string.format(pageItemTemplate, i.toString(), "#" + i.toString()));
      $btn.data("page", i);
      $btn.addClass("dews-simplepager-" + i.toString());

      if (i === self._current) {
        $btn.addClass("dews-simplepager-selected");
      }

      self.element.append($btn);
    }

    $next = $(dews.string.format(pageItemTemplate, dews.localize.get("dews_다음"), "#" + self._getNextNumber()));
    $next.data("page", self._getNextNumber());
    $next.addClass("dews-simplepager-image");
    $next.addClass("dews-simplepager-next");

    self.element.append($next);

    $last = $(dews.string.format(pageItemTemplate, dews.localize.get("dews_마지막"), "#" + self._getLastNumber()));
    $last.data("page", self._getLastNumber());
    $last.addClass("dews-simplepager-image");
    $last.addClass("dews-simplepager-last");

    self.element.append($last);

    $(".dews-simplepager-button", self.element).on("click", self._onButtonClick.bind(self));

    self._controlArrowButtons();
  };

  /**
   * 버튼을 클릭했을 때 동작하는 핸들러입니다.
   * @param  {Event} event
   * @private
   */
  SimplePager.prototype._onButtonClick = function (event) {
    var $button = $(event.target),
      page = $button.data("page");
    if (!$button.hasClass('disabled')) {
      this.setPage(page);
      this._controlArrowButtons();
      event.preventDefault();
    } else if ($button.hasClass('dews-simplepager-first') || $button.hasClass('dews-simplepager-prev')) {
      var noPreviousPageList = dews.localize.get("이전 페이지 목록이 없습니다.", "dews_이전 페이지 목록이 없습니다.");
      dews.alert(noPreviousPageList, "warning");
    } else if ($button.hasClass('dews-simplepager-last') || $button.hasClass('dews-simplepager-next')) {
      var noNextPageList = dews.localize.get("다음 페이지 목록이 없습니다.", "dews_다음 페이지 목록이 없습니다.");
      dews.alert(noNextPageList, "warning");
    }
  };

  /**
   * 양 옆의 화살표 버튼을 활성화/비활성화 시킵니다.
   * @private
   */
  SimplePager.prototype._controlArrowButtons = function () {
    var $firstButton = $('.dews-simplepager-button.dews-simplepager-first', this.element);
    this._isFirstPage() ? disable($firstButton) : enable($firstButton);

    var $lastButton = $('.dews-simplepager-button.dews-simplepager-last', this.element);
    this._isLastPage() ? disable($lastButton) : enable($lastButton);

    var $prevButton = $('.dews-simplepager-button.dews-simplepager-image.dews-simplepager-prev', this.element);
    if (this._isInFirstPageList()) {
      disable($prevButton);
    }

    var $nextButton = $('.dews-simplepager-button.dews-simplepager-image.dews-simplepager-next', this.element);
    if (this._isInLastPageList()) {
      disable($nextButton);
    }
  };

  function disable($button) {
    $button.addClass('disabled');
  }

  function enable($button) {
    $button.removeClass('disabled');
  }

  SimplePager.prototype._isFirstPage = function () {
    return Number(this._current) === 1;
  };

  SimplePager.prototype._isLastPage = function () {
    return Number(this._current) === Number(this._total);
  };

  SimplePager.prototype._isInLastPageList = function () {
    return Math.ceil(this._total / this.options.buttonCount) === Math.ceil(this._current / this.options.buttonCount);
  };

  SimplePager.prototype._isInFirstPageList = function () {
    return this._current <= this.options.buttonCount;
  };

  /**
   * 옵션을 설정합니다.
   * @param {object} options 설정할 옵션
   */
  SimplePager.prototype.setOptions = function (options) {
    var self = this,
      current;

    if (options.hasOwnProperty("current")) {
      // 초기화 되고 난 이후에는 옵션에 현재 페이지를 관리하면 더욱 헤깔릴 수 있으므로 current 옵션을 제거한다.
      current = options.current;
      delete options.current;
    }

    self.options = $.extend(true, self.options, options);

    if (options.hasOwnProperty("total")) {
      // 전체 페이지 갯수를 변경해준다.
      self._total = self._getTotalPageCount();
    }

    if (typeof current !== "undefined") {
      self._current = current;
    }

    self._render();
  };

  SimplePager.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        self.element.trigger(event);
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  SimplePager.prototype.on = function (e) {
    var self = this,
      $element = self.element;

    $element.on.apply($element, arguments);
  };

  /**
   * 옵션을 가져옵니다.
   */
  SimplePager.prototype.getOptions = function () {
    return this.options;
  };

  $.extend(true, dews, {
    ui: {
      /**
       * 지정한 요소를 페이저 컨트롤로 만들거나 가져옵니다.
       * @param {string|jQuery} selector 페이저로 만들 요소의 셀렉터 또는 jQuery 객체
       * @param {object} [options] 페이저 옵션
       */
      simplepager: function simplepager(selector, options) {
        var pager, obj;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var $this = $(this);

          pager = $this.data("dews-control");

          if (!pager) {
            if (!$this.hasClass("dews-ui-simplepager")) {
              $this.addClass("dews-ui-simplepager");
            }

            pager = new SimplePager($this, options);
            $this.data("dews-control", pager);

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }
          }
        });

        return pager;
      }
    }
  });

  dews.ui.addControlInitializer("simplepager", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.simplepager($("div.dews-ui-simplepager", $container));
  });
})(jQuery, dews || {});


/*
 * 슬라이더
 */
(function ($, dews, kendo) {
  var defaultOption = {
    showButtons: false,
    tickPlacement: "none"
    // tooltip: {
    //     enabled: false
    // }
  };

  /**
   * 이벤트 핸들러를 on, off 를 사용하여 등록하고 해제할 수 있도록 설정합니다.
   * @param instance kendo 컴포넌트 인스턴스
   */
  function attachEventProxy(instance) {
    instance.on = function () {
      instance.bind.apply(instance, arguments);
    };
    instance.off = function () {
      instance.unbind.apply(instance, arguments);
    };
  }

  /**
   * 추가적인 작업을 위한 API 를 추가합니다.
   * @param $element 대상 jQuery 요소
   * @param instance DEWS 컴포넌트 인스턴스
   */
  function setAdditionalAPI($element, instance) {
    instance.validate = function () {
      return $.isNumeric(instance.value());
    };

    instance.bindFromPanel = function (data) {
      var column;

      if (data) {
        column = $element.data("dews-bind-column") || $element.attr("id");

        if (column && data.hasOwnProperty(column)) {
          instance.value(data[column]);
        }
      }
    };

    instance.serializeForPanel = function () {
      var column, data;

      column = $element.data("dews-bind-column") || $element.attr("id");

      if (column) {
        data = {};
        data[column] = instance.value();
      }

      return data;
    };
  }

  $.extend(true, dews, {
    ui: {
      slider: function slider(selector, options) {
        var $el, slider;

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var $this = $(this),
            control,
            opt;

          control = $this.data("dews-control");

          if (!control) {
            opt = $.extend(true, {}, defaultOption, options);

            if (!$this.hasClass("dews-ui-slider")) {
              $this.addClass("dews-ui-slider");
            }

            if (!$this.hasClass("dews-form-control")) {
              $this.addClass("dews-form-control");
            }

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            $this.kendoSlider(opt);
            control = $this.data("kendoSlider");

            attachEventProxy(control);
            setAdditionalAPI($this, control);

            $this.data("dews-control", control);
          }

          slider = control;
        });

        return slider;
      }
    }
  });

  dews.ui.addControlInitializer("slider", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.slider($(".dews-ui-slider", $container));
  });

  /**
   * kendo 의 enable 함수를 확장합니다.
   * @param {boolean} [value] 설정할 활성화 여부(생략하면 현재 활성화 여부를 반환합니다.)
   * @returns {boolean} 활성화 여부
   * */
  function getEnable(enable) {
    return function (val) {
      var self = this;

      if (self.element.data("dews-control")) {
        if ($.type(val) !== "undefined") {
          enable.call(self, val);
        } else {
          return !self.wrapper.hasClass("k-state-disabled");
        }
      } else {
        enable.call(self, val);
      }
    };
  }

  kendo.ui.Slider.fn.enable = getEnable(kendo.ui.Slider.fn.enable);
})(jQuery, window.dews, window.kendo);


/**
 * 토스트 메세지
 */

(function ($, dews) {
  var SnackBar = function SnackBar(type, text, ico) {
    var self = this;

    self.type = type;
    self.always = [];

    // UI 환경설정에 스낵바 노출시간 설정 추가. 기본 값 null
    if (dews.app.env.main.snackbarViewTime) {
      self.exposureTime = dews.app.env.main.snackbarViewTime * 1000;
    }

    if ($.type(text) === "undefined") {
      self.text = "";
    } else {
      self.text = text;
    }

    if ($.type(ico) === "object") {
      if ($.type(ico.ico) === "undefined") {
        self.ico = "";
      } else {
        self.ico = ico.ico;
      }

      if ($.type(ico.width) === "undefined") {
        self.width = -1;
      } else {
        self.width = ico.width;
      }

      if ($.type(ico.height) === "undefined") {
        self.height = -1;
      } else {
        self.height = ico.height;
      }

      if ($.type(ico.fontSize) === "undefined") {
        self.fontSize = -1;
      } else {
        self.fontSize = ico.fontSize;
      }

      if ($.type(ico.exposureTime) !== "undefined") {
        self.exposureTime = parseFloat(ico.exposureTime);
      }
    } else {
      self.ico = $.type(ico) === "undefined" ? "" : ico;
    }

    self._createElement();
  };

  SnackBar.prototype._createElement = function () {
    var self = this,
      div = $('<div class="dews-ui-snackbar"></div>'),
      text = $('<div class="dews-snackbar-text" style="white-space:normal">' + self.text + "</div>");

    // text.css("word-break", "keep-all");

    if (self.width !== -1) {
      div.css("width", self.width + "px");
      text.css("width", "100%");
    } else {
      div.css("min-width", "238px");
      div.css("max-width", "500px");
    }

    if (self.height > -1) {
      div.css("height", self.height + "px");
      text.css("height", "100%");
    }

    if (self.fontSize > -1) {
      text.css("font-size", self.fontSize + "px");
    }

    div.addClass(self.type.toLowerCase());

    if ($.type(self.ico) === "boolean" && !self.ico) {
      div.addClass("no-icon");
    } else if ($.type(self.ico) === "string") {
      var icon = "";
      switch (self.ico.toLowerCase()) {
        case "ico1":
        case "success":
          icon = "success-icon";
          break;
        case "ico2":
        case "warning":
          icon = "warning-icon";
          break;
        case "ico3":
        case "info":
          icon = "info-icon";
          break;
        case "ico4":
        case "error":
          icon = "error-icon";
          break;
        case "ico5":
        case "loading":
          icon = "loading-icon";
          break;}

      div.addClass(icon);
    }

    if (!$(document.body).find(".dews-ui-snackbar")[0]) {
      if (self.type === "loading") {
        var loading = $('<div class="dews-loading-img"></div>');
        div.append(loading);
      } else {
        var img = $('<div class="dews-snackbar-img"></div>');
        div.append(img);
      }

      div.append(text);
      $(document.body).append(div);
      self.element = div;
      self.element.css("margin-left", -self.element.width() / 2 + "px");
      self._show();
    }
  };

  SnackBar.prototype._show = function () {
    var self = this,
      exposureTime;

    if (self.type === "ok" || self.type === "info" || self.type === "loading") {
      exposureTime = self.exposureTime ? parseFloat(self.exposureTime) : 1000;
    } else {
      exposureTime = self.exposureTime ? parseFloat(self.exposureTime) : 3000;
    }

    self.element.css("display", "none");

    self.element.slideDown(300, "linear", function () {
      self.element.css("display", "block");
      setTimeout(function () {
        self._hide();
      }, exposureTime);
    });
  };

  SnackBar.prototype._hide = function () {
    var self = this;

    self.element.slideUp(300, "linear", function () {
      self.element.remove();

      if (self.always && $.isArray(self.always) && self.always.length > 0) {
        for (var idx = 0; idx < self.always.length; idx++) {
          self.always[idx].call(self);
        }
      }
    });
  };

  SnackBar.prototype.done = function (fn) {
    var self = this;
    self.always.push(fn);
    return self;
  };

  dews = $.extend(true, dews, {
    ui: {
      snackbar: {
        ok: function ok(text, ico) {
          var snackbar = new SnackBar("ok", text, ico);

          return snackbar;
        },
        warning: function warning(text, ico) {
          var snackbar = new SnackBar("warning", text, ico);

          return snackbar;
        },
        error: function error(text, ico) {
          var snackbar = new SnackBar("error", text, ico);

          return snackbar;
        },
        info: function info(text, ico) {
          var snackbar = new SnackBar("info", text, ico);

          return snackbar;
        },
        loading: function loading(text, ico) {
          var snackbar = new SnackBar("loading", text, ico);

          return snackbar;
        }
      }
    }
  });
})(jQuery, window.dews || {});


/*
 * 스플리트 드롭다운 버튼
 */

(function ($, dews) {
  function ChildButton(element) {
    var self = this;

    self.element = $(element);
    self.id = element.id;

    return self;
  }

  ChildButton.prototype.text = function (text) {
    var self = this;

    if (typeof text !== "undefined") {
      self.element[0].innerText = text;
    } else {
      return self.element[0].innerText;
    }
  };

  ChildButton.prototype.enable = function (value) {
    var self = this,
      state;

    state = !self.element.attr("disabled");

    if (typeof value !== "undefined") {
      if (value === true) {
        self.element.removeClass("dews-state-disabled");
        self.element.attr("disabled", false);
      } else if (value === false) {
        self.element.addClass("dews-state-disabled");
        self.element.attr("disabled", "disabled");
      }
      state = value;
    }

    return state;
  };

  ChildButton.prototype.on = function () {
    var self = this;

    self.element.on.apply(self.element, arguments);
  };

  ChildButton.prototype.off = function () {
    var self = this;

    self.element.off.apply(self.element, arguments);
  };

  function setElement($this, options) {
    var element = $this,
      opt = options;

    if (opt) {
      if (opt.button && opt.button.length !== 0) {
        for (var i = 0; i < opt.button.length; i++) {
          var button = $('<button type="button" id="' + opt.button[i].id + '">').text(opt.button[i].text);

          if (typeof opt.button[i].enable === "function") {
            button.attr("disabled", !opt.button[i].enable());
          }

          $(element).append(button);
        }
      }
    }

    return $(element);
  }

  var SplitButton = function SplitButton(element, options) {
    var self = this;

    self.element = setElement(element, options);
    self.buttonDiv = $('<div class="dews-splitbutton-button"/>');
    self.listDiv = $('<div class="dews-splitbutton-list"/>');
    self.arrowWrapper = $('<span class="dews-splitbutton-arrow"/>');
    self.arrow = $('<span class="dews-splitbutton-arrow-icon"/>');
    self.button = [];
    self.buttons = [];
    self.position = 0;

    self._bindButton();
    self._initControl();
    self._bindEvent();

    self.buttons.getById = function (id) {
      var self = this;

      for (var i = 0; i < self.length; i += 1) {
        if (self[i].id === id) {
          return self[i];
        }
      }
      return null;
    };
  };

  SplitButton.prototype._initControl = function () {
    var self = this;

    if (self.element.attr("disabled") === "disabled" || self.element.attr("disabled") === true) {
      self.element.addClass("dews-state-disabled");
      self.listDiv.find("button").attr("disabled", "disabled");
    }

    self.element.find("button[disabled]").addClass("dews-state-disabled");
  };

  // 스플리트드롭다운버튼 구조 재조정
  SplitButton.prototype._bindButton = function () {
    var self = this;

    self.element.find("button").each(function () {
      self.button.push(this);
      self.buttons.push(new ChildButton(this));
    });

    self.element.empty();

    for (var i = 0; i < self.button.length; i++) {
      if (i === 0) {
        self.buttonDiv.append(self.button[i]);
        self.arrowWrapper.append(self.arrow);
        self.buttonDiv.append(self.arrowWrapper);
        self.element.append(self.buttonDiv);
      } else {
        self.listDiv.append(self.button[i]);
      }
    }

    $("body").append(self.listDiv);
  };

  /**
   * 스플리트버튼의 폰트 사이즈를 가져옵니다.(*생략시 default사이즈)
   * @private
   */
  SplitButton.prototype._getFontSize = function () {
    var self = this;

    if (self.element.hasClass("confirm")) {
      self.listDiv.addClass("confirm");
    } else if (self.element.hasClass("small")) {
      self.listDiv.addClass("small");
    }
  };

  SplitButton.prototype._setListPosition = function () {
    var self = this;
    //스플리트버튼의 위치
    var buttonX = self.element.offset().left;
    var buttonY = self.element.offset().top;
    var buttonHeight = self.element.height();
    var buttonWidth = self.element.width();
    var margin = self.listDiv.width() - buttonWidth;
    var zIndex = dews.ui.getDialogMaxZIndex();

    if (zIndex > parseInt(self.listDiv.css("zIndex"), 10)) {
      self.listDiv.css("zIndex", zIndex + 2);
    }

    //오른쪽 아래로 열릴 떄
    function openDefault() {
      self.listDiv.css({
        "min-width": buttonWidth,
        top: buttonY + buttonHeight,
        left: buttonX
      });
    }

    //왼쪽 아래로 열릴 때
    function openLeftDown() {
      self.listDiv.css({
        "min-width": buttonWidth,
        top: buttonY + buttonHeight,
        left: buttonX - margin + "px"
      });
    }

    //왼쪽 위로 열릴 때
    function openLeftUp() {
      self.listDiv.css({
        "min-width": buttonWidth,
        top: buttonY,
        left: buttonX - margin + "px"
      });
    }

    //오른쪽 위로 열릴 떄
    function openRightUp() {
      self.listDiv.css({
        "min-width": buttonWidth,
        top: buttonY,
        left: buttonX
      });
    }

    //리스트 잘림 현상 수정
    if (self.element.offset().top - self.position + self.listDiv.height() >= $(window).height()) {
      //위로 열릴 때
      if (self.element.offset().left + self.listDiv.width() >= $(window).width()) {
        //오른쪽을 기준으로 열릴 때
        openLeftUp();
      } else {
        //왼쪽을 기준으로 열릴 때
        openRightUp();
      }

      self.listPosition = "up";
    } else {
      //아래로 열릴 때
      if (self.element.offset().left + self.listDiv.width() >= $(window).width()) {
        //오른쪽을 기준으로 열릴 때
        openLeftDown();
      } else {
        //왼쪽을 기준으로 열릴 때
        openDefault();
      }

      self.listPosition = "down";
    }
  };

  /**
   * 스프리트버튼의 리스트를 닫습니다.
   * @private
   */
  SplitButton.prototype._listUp = function () {
    var self = this;

    self.arrowWrapper.removeClass("selected");
    self.listDiv.removeClass("selected");
  };

  /**
   * 스플리트버튼의 리스트를 내립니다.
   * @private
   */
  SplitButton.prototype._listDown = function () {
    var self = this;
    var dynamicListHeight = self.listDiv.height();

    //기존에 열려 있던 드로바운버튼 닫기
    $(".dews-splitbutton-arrow").removeClass("selected");
    $(".dews-splitbutton-list").removeClass("selected");

    self.arrowWrapper.addClass("selected");
    self.listDiv.addClass("selected");

    if (self.listPosition === "up") {
      self.listDiv.css({
        marginTop: -dynamicListHeight
      });
    }

    if (self.listPosition === "down") {
      self.listDiv.css({
        marginTop: 0
      });
    }

    window.addEventListener("click", documentClick, true);
    window.addEventListener("scroll", documentWheel, true);

    // 다른 부분을 클릭및 스크롤시 버튼 리스트 닫기
    function documentClick(e) {
      if (!self.element.is($(e.target).closest(".dews-ui-splitbutton"))) {
        self._listUp();

        window.removeEventListener("click", documentClick, true);
        window.removeEventListener("scroll", documentWheel, true);
      }
    }

    // 스크롤시 리스트 닫기
    function documentWheel(e) {
      self._listUp();
      window.removeEventListener("click", documentClick, true);
      window.removeEventListener("scroll", documentWheel, true);
    }
  };

  SplitButton.prototype._bindEvent = function () {
    var self = this;

    // 화살표 이미지 클릭시 이벤트 실행
    self.arrowWrapper.on("click", function (e) {
      e.stopPropagation();

      self._getFontSize();
      self._setListPosition();

      if (!self.element.hasClass("dews-state-disabled")) {
        if (self.arrowWrapper.hasClass("selected")) {
          self._listUp();
        } else {
          self._listDown();
        }
      }
    });

    $(window).bind("resize mousewheel DOMMouseScroll", function () {
      self.position = $(this).scrollTop();
      self._initControl();
    });
  };

  SplitButton.prototype.on = function () {
    var self = this,
      $element = self.element;
    $element.on.apply($element, arguments);
  };

  SplitButton.prototype.enable = function (value) {
    var self = this,
      state;

    state = !self.buttonDiv.find("button").attr("disabled");

    if (typeof value !== "undefined") {
      if (value === true) {
        self.element.removeClass("dews-state-disabled");
        self.buttonDiv.find("button").attr("disabled", false);
      } else if (value === false) {
        self.element.addClass("dews-state-disabled");
        self.buttonDiv.find("button").attr("disabled", true);
      }

      state = value;
    }

    return state;
  };

  SplitButton.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["click"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        self.element.trigger(event);
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  ChildButton.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["click"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        self.element.trigger(event);
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  $.extend(true, dews, {
    ui: {
      splitbutton: function splitbutton(selector, options) {
        var $el, splitbutton;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var button,
            $this = $(this);

          button = $this.data("dews-control");

          if (!button) {
            if (!$this.hasClass("dews-ui-splitbutton")) {
              $this.addClass("dews-ui-splitbutton");
            }

            if ($this.data("dews-localize-key")) {
              $this.find(">button[data-dews-localize-key]").each(function (idx, value) {
                var $list = $(value);
                $list.text(
                dews.localize.get(
                $list.text(),
                $list.data("dews-localize-key"),
                $list.data("dews-localize-lang") || null));


              });
            }

            button = new SplitButton(this, options);

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            $this.data("dews-control", button);
          }

          splitbutton = button;
        });

        return splitbutton;
      }
    }
  });

  dews.ui.addControlInitializer("dews-ui-splitbutton", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.splitbutton($("div.dews-ui-splitbutton", $container));
  });
})(jQuery, window.dews || {});


/*
 * 스플리터
 */
(function ($, dews, kendo) {
  var defaultOption = {};

  $.extend(true, dews, {
    ui: {
      /**
       * 스플리터 컨트롤을 생성하거나 가져옵니다.
       *
       * @param {string} selector 셀렉터 문자열 또는 jQuery객체
       * @param {object} [options] 설정 값, 생략하면 이미 생성된 스플리터 컨트롤의 객체를 획득할 수 있습니다.
       */
      splitter: function splitter(selector, options) {
        var $el, splitter;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if (kendo) {
          $el.each(function () {
            var $this = $(this),
              control,
              opt;

            control = $this.data("dews-control");

            if (!control) {
              opt = $.extend(true, {}, defaultOption, options);

              if (!$this.hasClass("dews-ui-splitter")) {
                $this.addClass("dews-ui-splitter");
              }

              $this.addClass("dews-control-activate");

              $this.kendoSplitter(opt);
              control = $this.data("kendoSplitter");

              $this.data("dews-control", control);
            }

            splitter = control;
          });
        }

        return splitter;
      }
    }
  });

  dews.ui.addControlInitializer("splitter", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.splitter("div.dews-ui-splitter", $container);
  });
})(jQuery, window.dews, window.kendo);


/*
 * 탭 패널
 */

(function ($, dews) {
  function TabItem(element, tabPanel) {
    var self = this;

    self._item = $(element);
    self._tabPanel = tabPanel;
    self.options = $.extend(true, {}, getTabItemOptions(self._item));

    self._initItem();
    self._bindEvent();

    return self;
  }

  /**
   * 탭 아이템의 옵션을 얻어오는 함수
   *
   * @param $tabItem JQuery 탭 아이템 객체
   * @returns {{disabled: number, hide: number}}
   */
  function getTabItemOptions($tabItem) {
    return {
      disabled: $tabItem.data("dews-disabled") | false,
      hide: $tabItem.data("dews-hide") | false
    };
  }

  /**
   * 탭 패널 내 아이템의 Title을 설정합니다.
   * @param text
   */
  TabItem.prototype.title = function (text) {
    var self = this;

    if ($.type(text) === "undefined") {
      return self._title.text();
    } else {
      self._title.text(text);
    }
  };

  /**
   * 탭 패널에서 선택된 탭 아이템 객체
   * @returns {*} 탭 아이템 객체
   */
  TabPanel.prototype.selectedItem = function () {
    var self = this;

    return self.openItem;
  };

  /**
   * 턉 패널 내 Item의 활성화 유무 설정
   * @param value
   */
  TabItem.prototype.enable = function (value) {
    var self = this;

    if ($.type(value) === "undefined") {
      return !self._item.hasClass("dews-state-disabled");
    } else if ($.type(value) === "boolean") {
      self._item.attr("disabled", !value);
      if (value) {
        self._item.removeClass("dews-state-disabled");
        self._title.removeClass("dews-state-disabled");
        self._tabPanel._element.removeClass("dews-state-disabled");
      } else {
        self._item.addClass("dews-state-disabled");
        self._title.addClass("dews-state-disabled");
        var flag = true;
        $.each(self._tabPanel.items, function (idx, tabItem) {
          if (!tabItem._item.hasClass("dews-state-disabled")) {
            flag = false;
          }
        });
        if (flag) {
          self._tabPanel._element.addClass("dews-state-disabled");
        }
      }
    }
  };

  /**
   * 탭 패널 내 아이템 선택
   */
  TabItem.prototype.select = function () {
    var self = this;
    var tabPanel = self._tabPanel;
    var titleLength,
      nonDisplayTitleLength = 0;
    var buttonGroup = tabPanel._element.find(".dews-tab-button-group");

    if (buttonGroup.css("display") === "none") {
      self._title.click();
    } else {
      if (self._title.hasClass("hide-tab")) {
        // 초기화 시점에 대한 체크
        titleLength = tabPanel._titles.find("> .dews-tab-item-title").length;
        tabPanel._titles.find("> .dews-tab-item-title").each(function (idx, title) {
          if ($(title).css("display") === "none") {
            nonDisplayTitleLength += 1;
          }
        });

        buttonGroup.find("> .ico-moveRight").click();

        if (
        self._title.css("display") === "inline-block" ||
        titleLength === nonDisplayTitleLength && tabPanel._titles.height() === 0)
        {
          self._title.click();
        } else if (self._title.css("display") === "none") {
          // PD1C-991 특정창에서 select()가 무한히 호출되는 현상 수정
          // 기존코드 : self.select();
          self._title.click();
        }
      } else {
        self._title.click();
      }
    }
  };
  /**
   * 해당 탭 아이템을 보여주거나 감추는 메소드
   * @param value 탭 아이템 display 여부
   */
  TabItem.prototype.hide = function (value) {
    var self = this;

    if (typeof value === "undefined") {
      // 현재 상태 반환
      return self._item.css("display") === "none";
    }

    if (value) {
      // 아이템 감추기
      var state = self._item.hasClass("on");

      self._item.hide();
      self._title.css("display", "none");
      self._title.addClass("hide");
      self._item.data("dews-hide", true);

      if (state) {
        self._title.siblings(".dews-tab-item-title:visible").eq(0).trigger("click", [true]);
      }
    } else {
      // 아이템 보이기
      self._item.css("display", "");
      self._title.css("display", "");
      self._title.removeClass("hide");
      self._item.data("dews-hide", false);
    }

    setStyle(self._title.parent());
    return value;
  };

  /**
   * 탭 패널 내 아이템 구조 설정
   * @private
   */
  TabItem.prototype._initItem = function () {
    var self = this,
      option = self.options,
      title = self._item.find("> span.dews-tab-item-title"),
      content = self._item.find("> div.dews-tab-content"),
      contents = self._item.children();

    if (title.length === 0) {
      if ($.type(self._item.data("dews-localize-key") !== "undefined")) {
        title = $(
        '<span class="dews-tab-item-title">' +
        dews.localize.get(
        self._item.data("dews-title"),
        self._item.data("dews-localize-key"),
        self._item.data("dews-localize-lang") || null) +

        "</span>");

      } else {
        title = $('<span class="dews-tab-item-title">' + self._item.data("dews-title") + "</span>");
      }
    }

    self._tabPanel._titles.append(title);
    self._title = title;

    if (content.length === 0) {
      content = $('<div class="dews-tab-content"/>');
      content.append(contents);
    }

    self._item.append(content);

    if (self._item.data("dews-content-id") && self._item.data("dews-content-id") !== self._item.attr("ID")) {
      content.attr("ID", self._item.data("dews-content-id"));
    }

    // 탭 아이템 비활성화 설정
    if (option.disabled) {
      self.enable(false);
    }

    // 탭 아이템 감추기 설정
    if (option.hide) {
      self.hide(true);
    }

    // 자신의 객체를 데이터로 추가
    self._item.data("dews-control-tab-item", self);
  };

  /**
   * 탭 패널 내 아이템 이벤트 설정
   * @private
   */
  TabItem.prototype._bindEvent = function () {
    var self = this;

    self._title.on("click", function (e, preventEvent) {
      if (self !== self._tabPanel.openItem) {
        self._triggerTabChangingEvent(preventEvent);
      }
    });
  };

  /**
   * changing 이벤트를 발생시킵니다.
   * @param preventEvent
   * @private
   */
  TabItem.prototype._triggerTabChangingEvent = function (preventEvent) {
    var parameter = {
      tab: this._tabPanel,
      openItem: this,
      closeItem: this._tabPanel.openItem
    };
    var changingEvent = new $.Event("tabChanging", parameter);

    if (!preventEvent) {
      this._tabPanel._element.trigger(changingEvent);
      if (!changingEvent.isDefaultPrevented()) {
        this._triggerTabChangeEvent(parameter, preventEvent);
      }
    }
  };

  /**
   * tabChange 이벤트를 발생시킵니다.
   * @param {Object} parameter
   * @param preventEvent
   * @private
   */
  TabItem.prototype._triggerTabChangeEvent = function (parameter, preventEvent) {
    this._tabPanel.openItem._item.removeClass("on");
    this._tabPanel.openItem._title.removeClass("on");
    this._item.addClass("on");
    this._title.addClass("on");
    this._tabPanel.openItem = this;
    if (this._tabPanel.options.firstSelect) {
      this._tabPanel.options.firstSelect = false;
    } else {
      this._tabPanel.closeItem = parameter.closeItem;
    }
    if (!preventEvent) {
      var _event4 = new $.Event("tabChange", parameter);
      this._tabPanel._element.trigger(_event4);
    }
  };

  /**
   * 탭 삭제 API
   */
  TabItem.prototype.deleteTab = function () {
    var self = this;
    var tabLength = self._tabPanel.items.length;
    var closeItem = false;

    for (var j = 0; j < tabLength; j++) {
      if (self._tabPanel.items[j] === self._tabPanel.closeItem) {
        closeItem = true;
      }
    }

    for (var i = 0; i < tabLength; i++) {
      if (!closeItem) {
        self._tabPanel.closeItem = undefined;
      }

      // 탭패널 배열에서 삭제 할 탭을 검색
      if (self._tabPanel.items[i] === self) {
        // 열려 있는 탭과 삭제 할 탭이 같은경우
        if (self._tabPanel.openItem === self) {
          // 처음 탭패널을 열었을 경우 처음 탭 다음 탭을 열어준다.
          if (self._tabPanel.closeItem === undefined) {
            // 선택 된 탭이 마지막일 경우 처음 탭을 열어준다.
            if (tabLength === i + 1) {
              self._tabPanel.items[0].select();
            } else {
              self._tabPanel.items[i + 1].select();
            }
          } else {
            // 전에 선택한 탭을 열어준다.
            self._tabPanel.closeItem.select();
          }
        }
        self._tabPanel.items.splice(i, 1);
        self._title.remove();
        self._item.remove();
      }

      if (self._tabPanel.items.length === 0) {
        self._tabPanel.openItem = null;
      }
    }

    _calcTabButton(self._tabPanel, "resize");
  };

  /**
   * 탭 패널을 작성합니다.
   * @private
   */
  function TabPanel(element, options) {
    var self = this;
    var $buttonGroup = $('<div class="dews-tab-button-group"></div>');

    self._element = $(element);
    self._titles = $('<div class="dews-tab-titles"/>');
    self.options = $.extend(true, {}, options, getTabPanelOptions(self._element));
    self.items = [];

    if (self._element.find("> div.dews-tab-titles").length === 0) {
      self._element.prepend(self._titles);
    }

    if (self.options.selectedTab) {
      self.options.firstSelect = true;
    }

    if (!self.options.navigatorButtons) {
      self._element.find("> dews-tab-button-group").css("display", "none");
    }

    // 좌우 이동 버튼 그룹 생성
    self._buttons = {
      $leftButton: $(
      '<button type="button" class="dews-ui-button ico-moveLeft dews-control k-button dews-control-activate"></button>'),

      $rightButton: $(
      '<button type="button" class="dews-ui-button ico-moveRight dews-control k-button dews-control-activate"></button>')

    };

    // 좌우 버튼 추가
    $buttonGroup.append(self._buttons.$leftButton);
    $buttonGroup.append(self._buttons.$rightButton);

    // 버튼 그룹을 추가
    if (self._element.find("> div.dews-tab-button-group").length === 0) {
      self._element.append($buttonGroup);
    }

    _tabPanelBindEvent(self);

    nthCreate(self);

    if (parseInt(self._titles.css("width")) > 0) {
      _calcTabButton(self);
    }

    if (self.items.length > 0) {
      self.items[0]._item.addClass("on");
      self.items[0]._title.addClass("on");
      self.openItem = self.items[0];
    }

    self.items.getById = function (id) {
      for (var i = 0; i < self.items.length; i += 1) {
        if (self.items[i]._item.attr("ID") === id) {
          return self.items[i];
        }
      }
    };

    // 선택하도록 설정된 탭 아이템 혹은 선택할 수 있는 탭을 선택
    if (self.items.length > 0) {
      self._selectTabItemByOption();
    }

    setStyle(self._titles);
    return self;
  }

  /**
   * 탭 패널의 옵션값을 얻어오는 함수
   *
   * @param $tabPanel 탭 패널 엘리먼트의 JQuery 객체
   * @returns {{selectedTab}}
   */
  function getTabPanelOptions($tabPanel) {
    return {
      selectedTab: $tabPanel.data("dews-selected-tab"),
      navigatorButtons: $tabPanel.data("dews-navigator-buttons") | true
    };
  }

  /**
   * 탭 패널 이벤트
   */
  function _tabPanelBindEvent(tabPanel) {
    var self = tabPanel;

    $(document).on("pageTabSelected", function (e) {
      console.log("pageTabSelected", e.tab.$content.css("display"));
      if (self._titles.is(":visible")) {
        _calcTabButton(self, "resize");
      }
    });

    self._buttons.$leftButton.on("click", function (e) {
      var buttonGroup = self._element.find(".dews-tab-button-group");
      var titlesWidth = parseInt(self._titles.css("width"));
      var buttonGroupWidth = parseInt(buttonGroup.css("width"));
      var hideTabWidth = 0,
        currentTabWidth = 0;
      var rightTab,
        index,
        startPoint = false,
        leftHideTab = false;

      $(self._titles.find("> .dews-tab-item-title").get().reverse()).each(function (idx, title) {
        if (rightTab && !$(rightTab).hasClass("hide-tab") && !$(title).hasClass("hide")) {
          index = idx;
          leftHideTab = true;
        }

        if (leftHideTab && $(title).hasClass("hide-tab") && !$(title).hasClass("hide")) {
          hideTabWidth += parseInt($(title).css("width"));
        }

        rightTab = title;
      });

      $(self._titles.find("> .dews-tab-item-title").get().reverse()).each(function (idx, title) {
        if (index === idx) {
          startPoint = true;
        }
        if (startPoint) {
          currentTabWidth += parseInt($(title).css("width"));
          if (hideTabWidth < titlesWidth - buttonGroupWidth) {
            if ($(title).hasClass("hide-tab") && !$(title).hasClass("hide")) {
              $(title).removeClass("hide-tab");
              $(title).css("display", "inline-block");
            } else {
              $(title).addClass("hide-tab");
              $(title).css("display", "none");
              if (currentTabWidth > hideTabWidth) {
                startPoint = false;
              }
            }
          } else {
            if (currentTabWidth > titlesWidth - buttonGroupWidth) {
              startPoint = false;
            } else {
              if ($(title).hasClass("hide-tab") && !$(title).hasClass("hide")) {
                $(title).removeClass("hide-tab");
                $(title).css("display", "inline-block");
              }
            }
          }
        } else {
          if ($(title).hasClass("hide-tab")) {
          } else {
            $(title).addClass("hide-tab");
            $(title).css("display", "none");
          }
        }
      });

      if (hideTabWidth < titlesWidth - buttonGroupWidth) {
        _calcTabButton(self, "resize");
      } else {
        buttonDisabled(self);
      }

      setStyle(self._titles);
    });

    self._buttons.$rightButton.on("click", function (e) {
      var buttonGroup = self._element.find(".dews-tab-button-group");
      var titlesWidth = parseInt(self._titles.css("width"));
      var buttonGroupWidth = parseInt(buttonGroup.css("width"));
      var hideTabWidth = 0,
        currentTabWidth = 0;
      var leftTitle,
        index,
        startPoint = false,
        rightHideTab = false;

      self._titles.find("> .dews-tab-item-title").each(function (idx, title) {
        if (leftTitle && !$(leftTitle).hasClass("hide-tab") && !$(title).hasClass("hide")) {
          index = idx;
          rightHideTab = true;
        }

        if (rightHideTab && $(title).hasClass("hide-tab") && !$(title).hasClass("hide")) {
          hideTabWidth += parseInt($(title).css("width"));
        }

        leftTitle = title;
      });

      self._titles.find("> .dews-tab-item-title").each(function (idx, title) {
        if (index === idx) {
          startPoint = true;
        }
        if (startPoint) {
          currentTabWidth += parseInt($(title).css("width"));
          if (hideTabWidth < titlesWidth - buttonGroupWidth) {
            if ($(title).hasClass("hide-tab") && !$(title).hasClass("hide")) {
              $(title).removeClass("hide-tab");
              $(title).css("display", "inline-block");
            } else {
              $(title).addClass("hide-tab");
              $(title).css("display", "none");
              if (currentTabWidth > hideTabWidth) {
                startPoint = false;
              }
            }
          } else {
            if (currentTabWidth > titlesWidth - buttonGroupWidth) {
              startPoint = false;
            } else {
              if ($(title).hasClass("hide-tab") && !$(title).hasClass("hide")) {
                $(title).removeClass("hide-tab");
                $(title).css("display", "inline-block");
              }
            }
          }
        } else {
          if ($(title).hasClass("hide-tab")) {
          } else {
            $(title).addClass("hide-tab");
            $(title).css("display", "none");
          }
        }
      });

      if (hideTabWidth < titlesWidth - buttonGroupWidth) {
        _calcTabButton(self, "resize");
      } else {
        buttonDisabled(self);
      }
      setStyle(self._titles);
    });

    $(window).on("resize", function (e) {
      if (self._titles.is(":visible")) {
        _calcTabButton(self, "resize");
        setStyle(self._titles);
      }
    });
  }

  function setStyle(title) {
    $(".dews-tab-item-title", title).removeClass("dews-last");
    $(".dews-tab-item-title", title).removeClass("dews-first");

    $(".dews-tab-item-title:visible:last", title).addClass("dews-last");
    $(".dews-tab-item-title:visible:first", title).addClass("dews-first");
  }

  /**
   * 탭 이동 버튼 계산 함수
   */
  function _calcTabButton(tabPanel, type) {
    var self = tabPanel;
    var buttonGroup = self._element.find(".dews-tab-button-group");
    var titlesWidth = parseInt(self._titles.css("width"));
    var buttonGroupWidth = parseInt(buttonGroup.css("width"));
    var totalTabItemWidth = 0;
    var currentTabItemWidth = 0;
    var index = [],
      startPoint = false;
    var titles = self._titles.find("> .dews-tab-item-title");

    self._titles.find("> .dews-tab-item-title").each(function (idx, title) {
      if (!$(title).hasClass("hide")) {
        totalTabItemWidth += parseInt($(title).css("width"));
      }

      if (!$(title).hasClass("hide-tab") && !$(title).hasClass("hide")) {
        index.push(idx);
      }
    });

    if (self.options.navigatorButtons) {
      if (totalTabItemWidth > titlesWidth) {
        if (buttonGroup.css("display") === "none") {
          buttonGroup.css("display", "inline-block");
        }
      } else {
        if (buttonGroup.css("display") !== "none") {
          buttonGroup.css("display", "none");
        }
      }
    } else {
      buttonGroup.css("display", "none");
    }

    if (type === "resize") {
      if (titles.eq(titles.length - 1).hasClass("hide-tab") || index.length === 0) {
        self._titles.find("> .dews-tab-item-title").each(function (idx, title) {
          if (idx === index[0] || index.length === 0) {
            startPoint = true;
          }

          if (startPoint && !$(title).hasClass("hide")) {
            currentTabItemWidth += parseInt($(title).css("width"));
          }

          if (buttonGroup.css("display") === "none") {
            if ($(title).css("display") === "none" && !$(title).hasClass("hide")) {
              $(title).css("display", "inline-block");
              $(title).removeClass("hide-tab");
            }
          } else {
            if (startPoint) {
              if (currentTabItemWidth > titlesWidth - buttonGroupWidth) {
                startPoint = false;
                if ($(title).css("display") !== "none") {
                  $(title).css("display", "none");
                  $(title).addClass("hide-tab");
                }
              } else {
                if ($(title).css("display") === "none" && !$(title).hasClass("hide")) {
                  $(title).css("display", "inline-block");
                  $(title).removeClass("hide-tab");
                }
              }
            } else {
              if ($(title).css("display") !== "none") {
                $(title).css("display", "none");
                $(title).addClass("hide-tab");
              }
            }
          }
        });
      } else {
        $(self._titles.find("> .dews-tab-item-title").get().reverse()).each(function (idx, title) {
          var tabIndex = self._titles.find("> .dews-tab-item-title").length - 1 - index[index.length - 1];
          if (idx === tabIndex) {
            startPoint = true;
          }

          if (startPoint && !$(title).hasClass("hide")) {
            currentTabItemWidth += parseInt($(title).css("width"));
          }

          if (buttonGroup.css("display") === "none") {
            if ($(title).css("display") === "none" && !$(title).hasClass("hide")) {
              $(title).css("display", "inline-block");
              $(title).removeClass("hide-tab");
            }
          } else {
            if (startPoint) {
              if (currentTabItemWidth > titlesWidth - buttonGroupWidth) {
                startPoint = false;
                if ($(title).css("display") !== "none") {
                  $(title).css("display", "none");
                  $(title).addClass("hide-tab");
                }
              } else {
                if ($(title).css("display") === "none" && !$(title).hasClass("hide")) {
                  $(title).css("display", "inline-block");
                  $(title).removeClass("hide-tab");
                }
              }
            } else {
              if ($(title).css("display") !== "none") {
                $(title).css("display", "none");
                $(title).addClass("hide-tab");
              }
            }
          }
        });
      }
    } else {
      self._titles.find("> .dews-tab-item-title").each(function (idx, title) {
        if (!$(title).hasClass("hide")) {
          currentTabItemWidth += parseInt($(title).css("width"));
        }

        if (buttonGroup.css("display") === "none") {
          if ($(title).css("display") === "none" && !$(title).hasClass("hide")) {
            $(title).css("display", "inline-block");
            $(title).removeClass("hide-tab");
          }
        } else {
          if (currentTabItemWidth > titlesWidth - buttonGroupWidth) {
            if ($(title).css("display") !== "none") {
              $(title).css("display", "none");
              $(title).addClass("hide-tab");
            }
          } else {
            if ($(title).css("display") === "none" && !$(title).hasClass("hide")) {
              $(title).css("display", "inline-block");
              $(title).removeClass("hide-tab");
            }
          }
        }
      });
    }

    buttonDisabled(self);
  }

  /**
   * 탭 이동 버튼 사용 여부
   */

  function buttonDisabled(tabPanel) {
    var self = tabPanel;
    var titlesLength = self._titles.find("> .dews-tab-item-title").length;
    var moveRigthButton = self._element.find(".dews-tab-button-group > .ico-moveRight");
    var moveLeftButton = self._element.find(".dews-tab-button-group > .ico-moveLeft");

    if (
    self._titles.
    find("> .dews-tab-item-title").
    eq(titlesLength - 1).
    hasClass("hide-tab"))
    {
      if (moveRigthButton.hasClass("k-state-disabled")) {
        moveRigthButton.removeClass("k-state-disabled");
        moveRigthButton.attr("disabled", false);
      }
    } else {
      if (!moveRigthButton.hasClass("k-state-disabled")) {
        moveRigthButton.addClass("k-state-disabled");
        moveRigthButton.attr("disabled", true);
      }
    }

    if (self._titles.find("> .dews-tab-item-title").eq(0).hasClass("hide-tab")) {
      if (moveLeftButton.hasClass("k-state-disabled")) {
        moveLeftButton.removeClass("k-state-disabled");
        moveLeftButton.attr("disabled", false);
      }
    } else {
      if (!moveLeftButton.hasClass("k-state-disabled")) {
        moveLeftButton.addClass("k-state-disabled");
        moveLeftButton.attr("disabled", true);
      }
    }
  }

  /**
   * 탭 패널 이벤트 설정
   */
  TabPanel.prototype.on = function () {
    var self = this;

    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "tabChange");
      self._element.on.apply(self._element, arguments);
    } else if (arguments[0] === "changing") {
      Array.prototype.splice.call(arguments, 0, 1, "tabChanging");
      self._element.on.apply(self._element, arguments);
    } else {
      self._element.on.apply(self._element, arguments);
    }
  };
  /**
   * 팹 패널 이벤트 해제
   */
  TabPanel.prototype.off = function () {
    var self = this;

    self._element.off.apply(self._element, arguments);
  };
  /**
   * 탭 패널 탭 추가
   * @param {Object} tabItem 탭에 설정 할 정보
   * @param {number} index 탭을 추가 할 위치
   */
  TabPanel.prototype.addTab = function (tabItem, index) {
    var self = this;
    var addTabItem, tabItemLength, addTitle, titleLength;
    var content = '<li class="dews-tab-item" id="' + tabItem.id + '" data-dews-title="' + tabItem.title + '"></li>';
    var firstTab = false;

    // 중복된 ID 값 입력 시 탭이 추가되지 않고 return
    for (var i = 0; i < self.items.length; i++) {
      if (tabItem.id === self.items[i]._item.attr("ID")) return;
    }

    if (!index) {
      index = 0;
    }

    tabItemLength = self._element.find("> .dews-tab-items > .dews-tab-item").length;
    if (self.items.length === 0) {
      firstTab = true;
      index = 0;
      self._element.find("> .dews-tab-items").append(content);
    } else {
      if (index > tabItemLength - 1) {
        index = tabItemLength;
        self._element.
        find("> .dews-tab-items > .dews-tab-item").
        eq(index - 1).
        after(content);
      } else {
        self._element.find("> .dews-tab-items > .dews-tab-item").eq(index).before(content);
      }
    }

    self._element.find("> .dews-tab-items > .dews-tab-item").eq(index).append(tabItem.content);

    addTabItem = new TabItem(self._element.find("> ul > .dews-tab-item")[index], self);

    self.items.splice(index, 0, addTabItem);

    titleLength = self._titles.find("> .dews-tab-item-title").length;
    addTitle = self._titles.find("> .dews-tab-item-title").eq(titleLength - 1);

    if (titleLength - 1 > index) {
      self._titles.find("> .dews-tab-item-title").eq(index).before(addTitle);
    }

    if (firstTab) {
      self.items[0]._item.addClass("on");
      self.items[0]._title.addClass("on");
      self.openItem = self.items[0];
    }

    $(document).trigger("inituicontrols", self);

    if (firstTab) {
      self._selectTabItemByOption();
    } else {
      _calcTabButton(self, "resize");
    }

    // 추가한 탭 선택
    self.items.getById(tabItem.id).select();
  };
  /**
   * 탭 패널 활성화 유무 설정
   * @param value
   */
  TabPanel.prototype.enable = function (value) {
    var self = this;

    if ($.type(value) === "undefined") {
      return !self._element.hasClass("dews-state-disabled");
    } else if ($.type(value) === "boolean") {
      if (value) {
        self._element.removeClass("dews-state-disabled");
      } else {
        self._element.addClass("dews-state-disabled");
      }
      $.each(self.items, function (idx, tabItem) {
        tabItem.enable(value);
      });
    }
  };

  /**
   * 탭 패널 자식 요소 객체 생성
   * @param tab
   */
  function nthCreate(tab) {
    var self = tab;

    self._element.find("> ul > .dews-tab-item").each(function (idx) {
      self.items.push(new TabItem(self._element.find("> ul > .dews-tab-item")[idx], self));
    });
  }

  /**
   * 옵션으로 전달받은 선택해야 하는 탭 혹은
   * 선택할 수 있는 탭을 선택하는 메소드
   *
   * @returns {*} 선택된 탭 아이템 객체
   */
  TabPanel.prototype._selectTabItemByOption = function () {
    var self = this,
      selectedTabItem,
      selectedTab = self.options.selectedTab;

    /*
      옵션 값으로 처리
     */
    if (isNaN(selectedTab)) {
      selectedTabItem = self._element.find("#" + selectedTab).data("dews-control-tab-item");
      if (!selectedTabItem) {
        selectedTabItem = self.items[0];
      }
    } else {
      selectedTabItem = self.items[selectedTab];
    }

    /*
      탭이 선택 가능한 경우는 선택,
      불가능한 경우 선택할 수 있는 가장 첫번째 탭을 선택
     */
    if (selectedTabItem && isSelectable(selectedTabItem._item)) {
      selectedTabItem.select();
    } else {
      selectedTabItem = self._element.
      find(".dews-tab-item").
      filter(function (idx, item) {
        return isSelectable($(item));
      }).
      first().
      data("dews-control-tab-item");
      if (selectedTabItem) {
        selectedTabItem.select();
      }
    }

    return selectedTabItem;
  };

  /**
   * 탭 패널 네비게이션 버튼 사용 유무
   */
  TabPanel.prototype.navigatorButtonsVisible = function (value) {
    var self = this;

    if (value === true) {
      self.options.navigatorButtons = true;
    } else if (value === false) {
      self.options.navigatorButtons = false;
    }

    _calcTabButton(self, "resize");
  };

  TabPanel.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "change") {
          self._element.trigger("tabChange");
        } else if (event === "changing") {
          self._element.trigger("tabChanging");
        } else {
          self._element.trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  /**
   * 파라미터로 입력받은 탭 아이템이 선택 가능한지 여부를 반환하는 함수
   *
   * @param $item JQuery 탭 아이템 엘리먼트
   * @returns {boolean} 선택 가능 여부
   */
  function isSelectable($item) {
    return !$item.attr("disabled");
  }

  $.extend(true, dews, {
    /**
     * @namespace
     */
    ui: {
      /**
       * 지정한 요소를 탭 패널로 만들거나 가져옵니다.
       * @param {string|jQuery} selector 탭 패널로 만들 셀렉터 또는 jQuery 객체
       * @param {object} options 탭 패널 옵션
       * @returns {object|Array} 탭 패널 인스턴스
       */
      tabpanel: function tabpanel(selector, options) {
        var $el, obj;

        obj = [];

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var tabpanel,
            element = this;

          if ($(element).data("dews-control")) {
            tabpanel = $(element).data("dews-control");
          } else {
            tabpanel = new TabPanel(element, options);
            $(element).data("dews-control", tabpanel);
          }

          if (!$(element).hasClass("dews-control-activate")) {
            $(element).addClass("dews-control-activate");
          }

          obj.push(tabpanel);
        });

        return obj.length == 1 ? obj[0] : obj;
      }
    }
  });

  dews.ui.addControlInitializer("tabpanel", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.tabpanel($(".dews-ui-tab-panel", $container));
  });
})(jQuery, window.dews || {});


/*
 * 탭 스트립
 */
(function ($, dews, kendo) {
  var defaultOption = {};

  $.extend(true, dews, {
    ui: {
      tabstrip: function tabstrip(selector, options) {
        var $el, tabstrip;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if (kendo) {
          $el.each(function () {
            var $this = $(this),
              control,
              opt;

            control = $this.data("dews-control");

            if (!control) {
              opt = $.extend(true, {}, defaultOption, options);

              if (!$this.hasClass("dews-ui-tabstrip")) {
                $this.addClass("dews-ui-tabstrip");
              }

              $this.addClass("dews-control-activate");

              $this.kendoTabStrip(opt);
              control = $this.data("kendoTabStrip");

              $this.data("dews-control", control);
            }

            tabstrip = control;
          });

          tabstrip = $el.data("kendoTabStrip");
        }

        return tabstrip;
      }
    }
  });

  dews.ui.addControlInitializer("tabstrip", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.tabstrip("div.dews-ui-tabstrip", $container);
  });
})(jQuery, window.dews, window.kendo);


/*
 * 텍스트 박스
 */

(function ($, dews) {
  /**
   * 텍스트 박스
   * @param {jQuery} element 텍스트박스로 생성할 대상 요소의 jQuery 객체
   * @constructor
   */
  var TextBox = function TextBox(element) {
    var self = this;

    self.element = element;
    self.controlType = "input";

    self._init();
  };

  /**
   * 텍스트박스를 초기화합니다.
   * @private
   */
  TextBox.prototype._init = function () {
    var self = this,
      $ctrl = self.element;

    if (!$ctrl.hasClass("dews-ui-textbox")) {
      $ctrl.addClass("dews-ui-textbox");
    }

    if ($ctrl.get(0).tagName === "SPAN") {
      // span 태그에 적용된 경우
      self.controlType = "span";

      $(".dews-icon", $ctrl).each(function () {
        var $icon = $(this),
          iconClass;

        if (!$icon.data("icon") && $icon.is(":visible")) {
          $icon.css("display", "none");
        } else {
          iconClass = "k-i-" + $icon.data("icon");

          if (!$icon.hasClass(iconClass)) {
            $icon.addClass("k-icon");
            $icon.addClass(iconClass);
          }

          if ($icon.data("icon-location") === "left") {
            if (!$ctrl.hasClass("k-space-left")) {
              $ctrl.addClass("k-space-left");
            }
          } else {
            if (!$ctrl.hasClass("k-space-right")) {
              $ctrl.addClass("k-space-right");
            }
          }
        }
      });
    } else if ($ctrl.get(0).tagName === "TEXTAREA") {
      self.controlType = "textarea";
    }

    if ($ctrl.attr("placeholder") && $ctrl.data("dews-placeholder-localize-key")) {
      $ctrl.attr(
      "placeholder",
      dews.localize.get(
      $ctrl.attr("placeholder"),
      $ctrl.data("dews-placeholder-localize-key"),
      $ctrl.data("dews-placeholder-localize-lang") || null));


    }

    if (!$ctrl.hasClass("k-textbox")) {
      $ctrl.addClass("k-textbox");
    }

    // readonly, disabled 처리
    dews.ui.util.ConvertClassAndProperty($ctrl);

    // input에 id만 있고 name이 없을 경우 name을 id와 동일하게 설정한다.
    if ($ctrl.get(0).tagName !== "SPAN" && $ctrl.attr("id") && !$ctrl.attr("name")) {
      $ctrl.attr("name", $ctrl.attr("id"));
    }

    if (!$ctrl.hasClass("dews-control-activate")) {
      $ctrl.addClass("dews-control-activate");
    }

    // 마스크 사용 시
    if ($ctrl.data("dews-use-secure-mask")) {
      setUseMask($ctrl);
    }

    self._bindEvents();
    setUserGuideAPI($ctrl);
  };

  /**
   * 이벤트를 설정합니다.
   * @private
   */
  TextBox.prototype._bindEvents = function () {
    var self = this,
      $ctrl = self.element;

    $ctrl.on("focus", function () {
      if ($ctrl.prop("readonly") === false && $ctrl.prop("disabled") === false) {
        // 마스크 사용할 경우
        if ($ctrl.data("dews-use-secure-mask")) {
          $ctrl.val($ctrl.data("dews-secure-mask-org-value"));
        }
        $ctrl.select();
      }
    });

    $ctrl.on("focusout", function () {
      // 마스크 사용할 경우
      if ($ctrl.data("dews-use-secure-mask") && $ctrl.prop("readonly") === false) {
        setUseMask($ctrl);
      }
    });
  };

  /**
   * 텍스트박스의 읽기 전용 여부를 설정하거나 가져옵니다.
   * @param {boolean} [value] 읽기 전용 여부 (생략할 경우 현재 읽기 전용 여부를 가져옵니다.)
   * @returns {boolean} 읽기 전용 상태
   */
  TextBox.prototype.readonly = function (value) {
    var self = this,
      $ctrl = self.element;

    if (typeof value === "undefined") {
      // 값 가져가기
      value = $ctrl.hasClass("readonly");
    } else {
      // 읽기 전용 설정
      if (value) {
        if (!$ctrl.hasClass("readonly")) {
          $ctrl.addClass("readonly");
        }
        if (!$ctrl.prop("readonly")) {
          $ctrl.prop("readonly", true);
        }
      } else {
        if ($ctrl.hasClass("readonly")) {
          $ctrl.removeClass("readonly");
        }
        if ($ctrl.prop("readonly")) {
          $ctrl.prop("readonly", false);
        }
      }
    }

    return value;
  };

  /**
   * 텍스트박스의 활성화 여부를 설정하거나 가져옵니다.
   * @param {boolean} [value] 활성화 상태 (생략할 경우 현재 활성화 여부를 가져옵니다.)
   * @returns {boolean} 활성화 여부
   */
  TextBox.prototype.enable = function (value) {
    var self = this,
      $ctrl = self.element;

    if (typeof value === "undefined") {
      // 값 가져가기
      value = !$ctrl.hasClass("disabled");
      return value;
    } else {
      // 활성화 설정
      if (value) {
        if ($ctrl.hasClass("disabled")) {
          $ctrl.removeClass("disabled");
        }
        if ($ctrl.prop("disabled")) {
          $ctrl.prop("disabled", false);
        }

        if ($ctrl.hasClass("readonly")) {
          self.readonly("readonly", true);
        }
      } else {
        if (!$ctrl.hasClass("disabled")) {
          $ctrl.addClass("disabled");
        }
        if (!$ctrl.prop("disabled")) {
          $ctrl.prop("disabled", true);
        }
      }
    }
  };

  /**
   * 텍스트박스의 visible 여부를 가져옵니다.
   * @returns {boolean}
   * @private
   */
  TextBox.prototype._visibleCheckFromPanel = function () {
    var self = this,
      $ctrl = self.element;
    isVisible = $ctrl.css("display") !== "none";

    return isVisible;
  };

  /**
   * 텍스트박스의 텍스트를 설정하거나 가져옵니다.
   * @param {string} [value] 설정할 텍스트 (생략할 경우 현재 설정된 텍스트를 가져옵니다.)
   * @returns {string} 설정된 텍스트
   */
  TextBox.prototype.text = function (value) {
    var self = this;

    if (typeof value === "undefined") {
      if (self.controlType === "span") {
        value = self.element.text();
      } else {
        if (self.element.data("dews-secure-mask-org-value")) {
          value = self.element.data("dews-secure-mask-org-value");
        } else {
          value = self.element.val();
        }
      }
    } else {
      if (value === null) value = "";

      if (self.controlType === "span") {
        self.element.text(value);
      } else {
        self.element.val(value);

        // 마스크 사용 시
        if (self.element.data("dews-use-secure-mask")) {
          setUseMask(self.element);
        }
      }
    }

    return value;
  };

  /**
   * 텍스트박스의 마스크된 텍스트를 가져옵니다.
   * @returns {string} 마스크된 텍스트
   */

  TextBox.prototype.maskedText = function () {
    var self = this,
      $el = $(self.element),
      data;

    data = $el.val();

    return data;
  };

  /**
   * 텍스트박스의 상태값에 따른 스타일 및 툴팁을 설정합니다.
   * @param {string} [type] 설정할 상태 (필수값)
   * @param {string || object} [options] 툴팁에 띄울 메세지 외 기타옵션 (생략할 경우 툴팁 메세지를 띄우지 않습니다.)
   */
  TextBox.prototype.setState = function (type, options) {
    var self = this;

    if (typeof type === "string") {
      self.state = type; // success, error, warning

      // 이전에 등록한 상태값 클래스가 존재하면 제거
      if (self.element.hasClass("text-state-success")) {
        self.element.removeClass("text-state-success");
      } else if (self.element.hasClass("text-state-warning")) {
        self.element.removeClass("text-state-warning");
      } else if (self.element.hasClass("text-state-error")) {
        self.element.removeClass("text-state-error");
      }

      // 이전 툴팁 이벤트 제거
      self.element.off("mouseover");
      self.element.off("mouseleave");

      self.element.addClass("text-state-" + type);
    }

    // 마우스오버 시 툴팁 띄우기
    self.on("mouseover", function () {
      if ($.type(options) !== "undefined") {
        if ($.type(options) === "string") {
          dews.ui.tooltip.show($(self.element), {
            type: "state",
            text: options,
            fadeOutTime: 0
          });
        } else if ($.type(options) === "object") {
          dews.ui.tooltip.show($(self.element), {
            type: "state",
            text: options.msg,
            fadeOutTime: 0
          });
        }
      }
    });

    // 마우스리브 시 툴팁 제거하기
    self.on("mouseleave", function () {
      dews.ui.tooltip.hide($(self.element));
    });
  };

  /**
   * 텍스트박스의 설정된 상태값을 가져옵니다.
   * @returns {string} 설정된 상태값
   */
  TextBox.prototype.getState = function () {
    var self = this;

    return self.state;
  };

  /**
   * 텍스트박스의 설정된 상태값을 제거합니다.
   */
  TextBox.prototype.removeState = function () {
    var self = this;

    self.element.removeClass("text-state-" + self.getState());
  };

  /**
   * 텍스트박스의 최대 입력 가능 길이를 설정합니다.
   * @param {number} length 최대 입력 가능 길이
   */
  TextBox.prototype.setMaxLength = function (length) {
    var self = this;

    if ($.isNumeric(length) && length >= 0) {
      self.element.prop("maxLength", length);
    } else {
      console.error("'" + length + "' 는 최대 입력 가능 길이로 설정할 수 없는 값입니다.");
    }
  };

  TextBox.prototype.success = function (value) {
    var self = this,
      $ctrl = self.element;

    // success 상태 설정
    if (value) {
      if (!$ctrl.hasClass("success")) {
        $ctrl.addClass("success");
      }
    } else {
      if ($ctrl.hasClass("success")) {
        $ctrl.removeClass("success");
      }
    }
    return value;
  };

  TextBox.prototype.error = function (value) {
    var self = this,
      $ctrl = self.element;

    // error 상태 설정
    if (value) {
      if (!$ctrl.hasClass("error")) {
        $ctrl.addClass("error");
      }
    } else {
      if ($ctrl.hasClass("error")) {
        $ctrl.removeClass("error");
      }
    }
    return value;
  };

  TextBox.prototype.warning = function (value) {
    var self = this,
      $ctrl = self.element;

    // warning 상태 설정
    if (value) {
      if (!$ctrl.hasClass("warning")) {
        $ctrl.addClass("warning");
      }
    } else {
      if ($ctrl.hasClass("warning")) {
        $ctrl.removeClass("warning");
      }
    }
    return value;
  };

  TextBox.prototype.reset = function () {
    var self = this;

    self.text("");
  };

  TextBox.prototype.focus = function () {
    var self = this;

    self.element.focus();
  };

  TextBox.prototype.on = function () {
    var self = this;

    self.element.on.apply(self.element, arguments);
  };

  TextBox.prototype.off = function () {
    var self = this;

    self.element.off.apply(self.element, arguments);
  };

  TextBox.prototype.validate = function () {
    var self = this;
    var result = true;

    if (self.hasValidationHandler()) {
      var event = new $.Event("validate", {
        target: self,
        state: self.state
      });

      $(self.element).trigger(event);
      result = !event.isDefaultPrevented();
    }
    if (result && $(self.element).hasClass("required")) {
      result = !!self.text();
    }

    return result;
  };

  TextBox.prototype.hasValidationHandler = function () {
    var self = this;

    var events = $._data(self.element.get(0), "events");

    if (events && $.isArray(events.validate) && events.validate.length > 0) {
      return true;
    }

    return false;
  };

  TextBox.prototype.required = function (value) {
    var self = this;
    var $element = $(self.element);

    if ($.type(value) === "undefined") {
      return $element.hasClass("required");
    }

    if (value === true) {
      $element.addClass("required");
    } else if (value === false) {
      $element.removeClass("required");
    }
  };

  TextBox.prototype.bindFromPanel = function (data) {
    var self = this,
      $element = $(self.element);
    var column;

    if (data) {
      column = $element.data("dews-bind-column") || $element.attr("id");

      if (column && data.hasOwnProperty(column)) {
        if (typeof data[column] === "undefined" || data[column] === null) {
          data[column] = "";
        }
        self.text(data[column]);
      }
    }
  };

  TextBox.prototype.serializeForPanel = function () {
    var self = this,
      $element = $(self.element);
    var column, data;

    column = $element.data("dews-bind-column") || $element.attr("id");

    if (column) {
      data = {};
      data[column] = self.text();
    }

    return data;
  };

  TextBox.prototype.applyPanelFocus = function (requiredCheck) {
    var self = this,
      $element = $(self.element);

    $element.on("keydown", function (e) {
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && $element.is(":enabled")) {
        e.preventDefault();
      } else if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();

        var evt = new $.Event("beforeFocus");
        evt.control = self;

        $element.trigger(evt);
      } else if (e.keyCode === 9 || e.keyCode === 13 && $element.is(":enabled")) {
        if (e.keyCode === 9) {
          //tab키 기본동작 막기
          e.preventDefault();
        }

        if (!(self.controlType === "textarea" && e.keyCode === 13)) {
          if (e.keyCode === 13 && requiredCheck && $element.hasClass("required")) {
            if (self.validate()) {
              var evt = new $.Event("nextFocus");
              evt.control = self;

              $element.trigger(evt);
            }
          } else {
            var evt = new $.Event("nextFocus");
            evt.control = self;

            $element.trigger(evt);
          }
        }
      }

      $element.off("keypress", preventNewLine);
    });

    // 폼패널 내에서 엔터키로 포커스 이동시 개행 되는 문제 수정
    $element.on("_canFocusable", function (e) {
      $element.on("keypress", preventNewLine);
    });

    function preventNewLine(e) {
      if (self.controlType === "textarea") {
        if (e.keyCode === 13) {
          e.preventDefault();
        }
      }
    }
  };

  TextBox.prototype.canFocusable = function () {
    var self = this,
      $element = $(self.element);

    var evt = new $.Event("_canFocusable");
    evt.control = self;

    $element.trigger(evt);

    return !$element.hasClass("readonly") && $element.is(":visible") && $element.is(":enabled");
  };

  /**
   * 텍스트박스 컨트롤 자동화 인쇄 관련 데이터 추출
   * @return {*} 값이 설정 된 경우 Object 반환, 없는 경우 undefined 반환
   * @private
   */
  TextBox.prototype._getPrintData = function () {
    var self = this,
      $el = $(self.element),
      data;

    if (self.text()) {
      data = {
        id: $el.attr("id"),
        text: self.text()
      };
    }

    return data;
  };

  /**
   * 텍스트박스 컨트롤 display none 하여 숨기는 API
   */
  TextBox.prototype.hide = function () {
    var self = this;

    if (!(self.element.css("display") === "none")) {
      self.element.css("display", "none");
    }
  };

  /**
   * 텍스트박스 컨트롤 display inline-block 하여 보이도록 하는 API
   */
  TextBox.prototype.show = function () {
    var self = this;

    if (self.element.css("display") === "none") {
      self.element.css("display", "inline-block");
    }
  };

  TextBox.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["validate", "change", "focus", "blur", "keyup", "keydown"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        self.element.trigger(event);
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  /**
   * 마스크를 사용하는 textbox일 경우 마스크 처리한 값으로 보여줍니다.
   * @param $element 대상 jQuery 요소
   */
  function setUseMask($element) {
    var val = $element.val();
    var mask = $element.data("dews-secure-mask") + "";
    var isPredefined = false;
    if ($element.data("dews-predefined")) isPredefined = true;

    // 마스크 전 원본 데이터
    $element.data("dews-secure-mask-org-value", val);

    if (val !== "") {
      var maskText = val;
      if (isPredefined) {
        if (mask && mask !== "") {
          var secureMask = dews.getSecureMaskFormat(mask);
          if (secureMask) {
            maskText = dews.string.secureMask(val, mask, true);
          }
        }
      } else {
        if (mask && mask !== "") {
          maskText = dews.string.secureMask(val, mask, false);
        }
      }
      $element.val(maskText);
    }
  }

  /**
   * 시용자 가이드를 위한 API 를 추가합니다.
   * @param $element 대상 jQuery 요소
   */
  function setUserGuideAPI($element) {
    $element.on("focus", function () {
      if (dews.ui.page && dews.ui.page.hasUserGuide) {
        if ($.isFunction(dews.ui.page.focusGuideItem) && $element.attr("id")) {
          dews.ui.page.focusGuideItem("#" + $element.attr("id"));
        }
      }
    });
  }

  dews = $.extend(true, dews, {
    ui: {
      textbox: function textbox(selector) {
        var $control, textbox;

        if (selector instanceof jQuery) {
          $control = selector;
        } else if ($.type(selector) === "string") {
          $control = $(selector);
        } else {
          throw "대상이 지정되지 않았습니다.";
        }

        $control.each(function () {
          var $ctrl = $(this);

          textbox = $ctrl.data("dews-control");

          if (!textbox) {
            textbox = new TextBox($ctrl);
            if (!$ctrl.hasClass("dews-form-control")) {
              $ctrl.addClass("dews-form-control");
            }

            $ctrl.data("dews-control", textbox);
          }
        });

        return textbox;
      }
    }
  });

  dews.ui.addControlInitializer("textbox", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.textbox($("input[type='text'].dews-ui-textbox", $container));
    dews.ui.textbox($("input[type='password'].dews-ui-textbox", $container));
    dews.ui.textbox($("textarea.dews-ui-textbox", $container));
    dews.ui.textbox($("span.dews-ui-textbox", $container));
  });
})(jQuery, window.dews || {});


/*
 * 년월일시분을 받아오는 일시 피커
 */
(function ($, dews, kendo) {
  var DatePickerBase = dews.ui.DatePickerBase;

  function getDefaultTimeOptions() {
    return {
      format: dews._environments.formats.timeFormat,
      valueFormat: dews._environments.formats.timeValueFormat,
      interval: 30
    };
  }

  var TimePicker = function TimePicker($ctrl, options) {
    var timepicker;
    var opt;

    if (options && typeof options.secondValue === "boolean" && options.secondValue === true) {
      options.valueFormat = "HHmmss";
    }

    opt = this.getOptions($ctrl, getDefaultTimeOptions(), options);

    if (!$ctrl.hasClass("dews-ui-timepicker")) {
      $ctrl.addClass("dews-ui-timepicker");
    }

    if (!$ctrl.hasClass("dews-form-control")) {
      $ctrl.addClass("dews-form-control");
    }

    if (!$ctrl.hasClass("dews-control-activate")) {
      $ctrl.addClass("dews-control-activate");
    }

    dews.ui.util.ConvertClassAndProperty($ctrl);
    $ctrl.kendoTimePicker(opt);

    timepicker = $ctrl.data("kendoTimePicker");
    timepicker.options.valueFormat = opt.valueFormat;

    this.initControl($ctrl, "timepicker");
    this.setMask($ctrl, opt.format);
    this.setEvent($ctrl, opt);

    DatePickerBase.call(this, timepicker);
  };

  TimePicker.prototype = Object.create(DatePickerBase.prototype);
  TimePicker.prototype.constructor = TimePicker;

  kendo.ui.TimePicker.fn._keydown = function (e) {
    var that = this,
      key = e.keyCode,
      timeView = that.timeView,
      value = that.element.val();
    if (value.indexOf("_") === 0) {
      value = "";
    }
    if (timeView.popup.visible() || e.altKey) {
      timeView.move(e);
      if (that._dateInput && e.stopImmediatePropagation) {
        e.stopImmediatePropagation();
      }
    } else if (key === 13 && value !== that._oldText) {
      that._change(value);
    } else {
      that._typing = true;
    }
  };

  kendo.ui.TimePicker.fn._blur = function () {
    var that = this,
      value = that.element.val();
    if (value.indexOf("_") === 0) {
      value = "";
    }
    that.close();
    if (value !== that._oldText) {
      that._change(value);
    }
    that._inputWrapper.removeClass("k-state-focused");
  };

  $.extend(true, dews, {
    ui: {
      /**
       * 시간을 받아오는 시간 피커를 생성하거나 가져옵니다.
       * @param {string|jQuery} selector 피커로 변경될 요소를 지정하는 셀렉터 또는 jQuery 객체입니다.
       * @param {object} [options] 피커 설정 값입니다.
       */
      timepicker: function timepicker(selector, options) {
        var $el = null,
          timepicker = null;

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var picker,
            $ctrl = $(this);

          picker = $ctrl.data("dews-control");

          if (!picker) {
            picker = new TimePicker($ctrl, options);

            $ctrl.data("dews-control", picker);
          }

          timepicker = picker;
        });

        return timepicker;
      }
    }
  });

  dews.ui.addControlInitializer("timepicker", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.timepicker($('input[type="text"].dews-ui-timepicker', $container));
  });
})(jQuery, window.dews, window.kendo);


/*
 * 툴바
 */
(function ($, dews, kendo) {
  var defaultOption = {};

  $.extend(true, dews, {
    ui: {
      toolbar: function toolbar(selector, options) {
        var $el, toolbar;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if (kendo) {
          $el.each(function () {
            var $this = $(this),
              control,
              opt;

            control = $this.data("dews-control");

            if (!control) {
              opt = $.extend(true, {}, defaultOption, options);

              if (!$this.hasClass("dews-ui-toolbar")) {
                $this.addClass("dews-ui-toolbar");
              }

              $this.addClass("dews-control-activate");

              $this.kendoToolBar(opt);
              control = $this.data("kendoToolBar");

              $this.data("dews-control", control);
            }

            toolbar = control;
          });
        }

        return toolbar;
      }
    }
  });

  dews.ui.addControlInitializer("toolbar", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.toolbar($("div.dews-ui-toolbar", $container));
  });
})(jQuery, window.dews, window.kendo);


(function ($, dews) {
  var defaultOptions = {
    type: "normal",
    position: "top",
    durationTime: 0,
    fadeOutTime: 3000,
    text: "&nbsp"
  };

  function Tooltip($el, options) {
    var selfOptions;
    var self = this;

    self.target = $el;
    self.options = options;
    self.tooltip = null;
    self.flag = false;

    selfOptions = self.getOptions(options);

    self._create(selfOptions);
  }

  Tooltip.prototype.getOptions = function (options) {
    var opt;
    var requiredOptions = {};

    // 필수 툴팁일 경우 기본 옵션 설정 변경
    if (options && options.type === "required") {
      requiredOptions = {
        type: "required",
        fadeOutTime: 3000,
        text: dews.localize.get("필수 입력 항목입니다.", "dews_필수 입력 항목입니다.")
      };
    }

    opt = $.extend(true, {}, defaultOptions, requiredOptions, options);

    return opt;
  };

  Tooltip.prototype._create = function (options) {
    var self = this;
    var tooltip;
    var temp;

    tooltip = $("<span></span>").addClass("tooltip").html(options.text);

    $(document.body).append(tooltip);

    // 필수 툴팁 스타일 적용
    if (options.type === "required") {
      tooltip.addClass("required");
    }

    // 상태 ( success, warning, error ) 스타일 적용
    if (options.type === "state") {
      tooltip.addClass("status-value");
    }

    // wrapper로 감싸서 표현되는 컨트롤은 감싸고 있는 태그로 선택자를 변경한다.
    if (parseFloat(self.target.offset().left) === 0 || self.target.width() === 0) {
      temp = self.target;
      self.target = self.target.parent();
    }

    // 위치 계산
    if (
    self.target.closest(".dews-ui-grid").length !== 0 ||
    self.target.closest(".dews-ui-treegrid").length !== 0)
    {
      // 대상 컴포넌트가 그리드인 경우
      if ($.type(options.grid) !== "undefined" && options.grid) {
        if (options.position === "top") {
          tooltip.css({
            left: options.cellX + options.cellWidth / 2 - tooltip.width() / 2 - 10
          });
          tooltip.css({
            top: options.cellY - (tooltip.height() * 2 + 8)
          });

          tooltip.addClass("top"); // 툴팁 꼬리
        } else if (options.position === "left") {
          tooltip.css({
            left: options.cellX - (tooltip.width() + 30)
          });
          tooltip.css({ top: options.cellY });

          tooltip.addClass("left");
        } else if (options.position === "right") {
          tooltip.css({
            left: options.cellX + options.cellWidth + 10
          });
          tooltip.css({ top: options.cellY });

          tooltip.addClass("right");
        } else {
          // bottom
          tooltip.css({
            left: options.cellX + options.cellWidth / 2 - tooltip.width() / 2 - 10
          });
          tooltip.css({
            top: options.cellY + options.cellHeight + tooltip.height() / 2
          });

          tooltip.addClass("bottom");
        }
      }
    } else {
      // 대상 컴포넌트가 일반 폼컨트롤인 경우
      var top;
      if (options.position === "top") {
        if (
        self.target.hasClass("dews-ui-textbox") && self.target.prop("tagName") === "TEXTAREA" ||
        self.target.hasClass("dews-ui-button") && (
        self.target.hasClass("small") || self.target.hasClass("confirm")))
        {
          top = self.target.offset().top - 36;
        }

        tooltip.css({
          top: top ? top : self.target.offset().top - (self.target.height() + 10)
        });
        tooltip.css({
          left: self.target.offset().left + (self.target.outerWidth() - $(tooltip).outerWidth()) / 2
        });

        tooltip.addClass("top");
      } else if (options.position === "left") {
        tooltip.css({
          left: self.target.offset().left - (tooltip.width() + 30)
        });
        tooltip.css({
          top: self.target.offset().top + (self.target.height() - $(tooltip).outerHeight()) / 2
        });

        tooltip.addClass("left");
      } else if (options.position === "right") {
        tooltip.css({
          left: self.target.offset().left + self.target.outerWidth() + 10
        });
        tooltip.css({
          top: self.target.offset().top + (self.target.height() - $(tooltip).outerHeight()) / 2
        });

        tooltip.addClass("right");
      } else {
        if (self.target.hasClass("dews-ui-textbox") && self.target.prop("tagName") === "TEXTAREA") {
          top = self.target.offset().top + self.target.outerHeight() + 10;
        }

        tooltip.css({
          left: self.target.offset().left + (self.target.outerWidth() - $(tooltip).outerWidth()) / 2
        });
        tooltip.css({
          top: top ? top : self.target.offset().top + self.target.height() + 10
        });

        tooltip.addClass("bottom");
      }
    }

    tooltip.css("display", "inline-block");

    if (temp) {
      self.target = temp;
    }
    self.tooltip = tooltip;

    // 툴팁의 fadeout만 설정 시
    if (!options.durationTime && options.fadeOutTime) {
      self.flag = true;
      tooltip.
      fadeOut(options.fadeOutTime).
      promise().
      done(function () {
        self._delete();
      });
    }

    // 유지시간과 fadeout 설정
    if (options.durationTime && options.fadeOutTime) {
      self.flag = true;
      tooltip.
      fadeTo(options.durationTime, tooltip.css("opacity")).
      fadeOut(options.fadeOutTime).
      promise().
      done(function () {
        self._delete();
      });
    }

    // 다이얼로그 내의 코드피커/멀티코드피커에서 값 세팅된 채로 마우스오버하면 툴팁이 나오는데
    // 마우스오버된 채로 esc키로 닫을 시, 툴팁이 그대로 남아있는 현상 수정 => 다이얼로그 id로 찾아서 그에 속하는 툴팁만 삭제
    if (dews.ui.dialogPage) {
      tooltip.addClass(dews.ui.dialogPage.id);
    }
  };

  Tooltip.prototype._delete = function () {
    var self = this;
    self.tooltip.remove();
    self.target.removeData("dews-ui-tooltip");
  };

  dews = $.extend(true, dews, {
    ui: {
      tooltip: {
        show: function show(target, options) {
          var $el, tooltip;

          if (target instanceof jQuery) {
            $el = target;
          } else if ($.type(target) === "string") {
            $el = $(target);
          } else {
            throw "대상이 지정되지 않았습니다.";
          }

          $el.each(function () {
            var $this = $(this);

            tooltip = $this.data("dews-ui-tooltip");

            // 툴팁이 존재하면 새로 생성하지 않습니다.
            if (tooltip) {
              return;
            }

            tooltip = new Tooltip($this, options);

            if (!$this.hasClass("dews-control-activate")) {
              $this.addClass("dews-control-activate");
            }

            $this.data("dews-ui-tooltip", tooltip);
          });

          return tooltip;
        },
        hide: function hide(target) {
          var $el, tooltip;

          if (target instanceof jQuery) {
            $el = target;
          } else if ($.type(target) === "string") {
            $el = $(target);
          } else {
            throw "대상이 지정되지 않았습니다.";
          }

          tooltip = $el.data("dews-ui-tooltip");

          // 툴팁이 존재하는 시점에는 삭제하지 않습니다.
          if (tooltip && !tooltip.flag) {
            tooltip._delete();
          }
        }
      }
    }
  });
})(jQuery, window.dews || {});


/*
 * 트리뷰
 */
(function ($, dews, kendo) {
  var defaultOption = {
    treePadding: 10,
    loadOnDemand: false
  };

  function getOptions($el, options) {
    var opt = {};
    var inlineOptions = {};
    var paddingOption;

    if (options && options.checkboxes && !options.checkboxes.template) {
      options.checkboxes.template =
      "<span class='dews-checkbox-wrapper'><input type='checkbox' class='dews-ui-checkbox dews-control k-checkbox dews-control-activate'><label class='dews-checkbox-label k-checkbox-label' onclick='dews.ui.treeview.checkbox._click(this)'></label></span>";
    }

    paddingOption = $el.data("dews-tree-padding") || $el.data("dews-treeview-padding");

    if (paddingOption) {
      inlineOptions.treePadding = paddingOption;
    }

    opt = $.extend(true, {}, defaultOption, inlineOptions, options);
    return opt;
  }

  /**
   * expandTo 함수를 확장합니다.
   * @param {function} originExpandTo Kendo UI의 expandTo 함수
   */
  function expandTo(originExpandTo) {
    return function (childNode) {
      var self = this;
      var parentList = [];
      var _getExpandNodeList = function _getExpandNodeList(node) {
        var parent;

        if (!self.parent(node).get(0)) {
          return;
        }

        parent = self.parent(node);
        parentList.push(parent);

        _getExpandNodeList(parent);
      };

      if (!childNode) {
        return;
      }

      if (childNode.id && $.type(childNode.id) === ("string" || "number")) {
        originExpandTo.call(self, childNode);
      } else {
        _getExpandNodeList(self.findByUid(childNode.uid));

        while (parentList.length) {
          self.expand(parentList.pop());
        }
      }
    };
  }

  /**
   * expandAll 트리뷰 모든 노드 확장
   * @param {Function} originExpand  Kendo UI의 expand 함수
   */
  function expandAll(originExpand) {
    return function () {
      var self = this;

      originExpand.call(self, ".k-item");
    };
  }

  /**
   * collapseAll 트리뷰 모든 노드 접힘
   * @param {Function} originCollapse  Kendo UI의 collapse 함수
   */
  function collapseAll(originCollapse) {
    return function () {
      var self = this;

      originCollapse.call(self, ".k-item");
    };
  }

  $.extend(true, dews, {
    ui: {
      treeview: function treeview(selector, options) {
        var $el, treeview;

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector);
        }

        if ($.type(selector) === "undefined") {
          return;
        }

        $el.each(function () {
          var $this = $(this),
            control,
            opt;

          control = $this.data("dews-control");

          if (!control) {
            opt = getOptions($this, options);
            $this.css("padding", opt.treePadding);

            if (!$this.hasClass("dews-ui-treeview")) {
              $this.addClass("dews-ui-treeview");
            }

            if (!$this.hasClass("dews-data-control")) {
              $this.addClass("dews-data-control");
            }

            $this.addClass("dews-control-activate");

            $this.kendoTreeView(opt);

            control = $this.data("kendoTreeView");

            $this.data("dews-control", control);

            $this.data("dews-control")._bindEvent();
          }

          treeview = control;
        });

        return treeview;
      }
    }
  });

  dews.ui.treeview.checkbox = {
    _click: function _click(sender) {
      var $label = $(sender),
        $checkbox;

      $checkbox = $label.parent(".dews-checkbox-wrapper").find('input[type="checkbox"]');
      $checkbox.click();
    }
  };

  kendo.ui.TreeView.fn._bindEvent = function () {
    var self = this;

    self.element.on("keydown", function (e) {
      var currentNode = self.current();
      var currentTreeScrollTop, currentNodeTop, treeviewTop, treeviewHeight;

      currentTreeScrollTop = self.element.scrollTop();
      currentNodeTop = currentNode.offset().top;
      treeviewTop = self.element.offset().top;
      treeviewHeight = self.element.height();

      if (e.keyCode === 38) {
        if (currentNodeTop - treeviewTop < 0) {
          self.element.scrollTop(currentTreeScrollTop + currentNodeTop - treeviewTop);
        }
      } else if (e.keyCode === 40) {
        if (currentNodeTop - treeviewTop - self.element.height() > 0) {
          self.element.scrollTop(currentTreeScrollTop + currentNodeTop - treeviewTop - treeviewHeight);
        }
      }
    });

    self.element.on("transitionend", function (e) {
      e.stopPropagation();
    });
  };

  kendo.ui.TreeView.fn._insert = function (data, model, index) {
    if (!(model instanceof kendo.data.ObservableArray)) {
      if (!$.isArray(model)) {
        model = [model];
      }
    } else {
      model = model.toJSON();
    }

    var parentNode = data.parent();
    if (parentNode && parentNode._initChildren) {
      parentNode.hasChildren = true;
      parentNode._initChildren();
    }

    data.splice.apply(data, [index, 0].concat(model));

    data[index].id = "";

    return this.findByUid(data[index].uid);
  };

  /**
   * expandAll 함수 정의(Kendo UI expand 함수 이용)
   */
  kendo.ui.TreeView.fn.expandAll = expandAll(kendo.ui.TreeView.fn.expand);

  /**
   * collapseAll 함수 정의(Kendo UI collapse 함수 이용)
   */
  kendo.ui.TreeView.fn.collapseAll = collapseAll(kendo.ui.TreeView.fn.collapse);

  // kendo treeview 2017.3.913 버전 expandTo 오류로 인한 재정의
  /**
   * expandTo 함수를 재정의 합니다.
   */
  kendo.ui.TreeView.fn.expandTo = expandTo(kendo.ui.TreeView.fn.expandTo);

  kendo.ui.TreeView.fn.scrollTo = function (targetNode) {
    var self = this;

    var treeOffset = self.element.offset();
    var currentTreeScrollTop = self.element.scrollTop();

    if (!targetNode) {
      if (self.select().length > 0) {
        targetNode = self.select();
      } else {
        return;
      }
    }

    self.element.scrollTop(currentTreeScrollTop + targetNode.offset().top - treeOffset.top);
  };

  // getCheckedNodes 함수 추가
  kendo.ui.TreeView.fn.getCheckedNodes = function () {
    var self = this;

    return self.element.find('input[type="checkbox"]:checked').closest("li.k-item");
  };

  // 트리뷰 패널 바인딩
  kendo.ui.TreeView.fn.bindPanel = function (panel) {
    var self = this,
      current;
    current = self.dataItem(self.select());
    if ($.type(panel) === "object" && panel.length) {
      panel = dews.ui.formpanel(panel);
    }

    panel.bindData(current);
  };

  // 트리뷰 패널 바인딩
  kendo.ui.TreeView.fn.updateRowFromPanel = function (data) {
    var self = this,
      dataItem;
    if (self.select().length > 0) {
      dataItem = self.dataItem(self.select());
      for (var i = 0; i < Object.keys(data).length; i++) {
        if (
        $.type(dataItem.get(Object.keys(data)[i])) !== "undefined" &&
        dataItem.get(Object.keys(data)[i]) !== data[Object.keys(data)[i]])
        {
          dataItem.set(Object.keys(data)[i], data[Object.keys(data)[i]]);
        }
      }
      // $.each(Object.keys(data), function (idx, value) { dataItem[value] = data[value] });
    }
  };

  // 마스터 디테일 설정
  kendo.ui.TreeView.fn.setDetail = function (target) {
    var self = this,
      master = self,
      detail = target,
      masterDataSource = master.options.dataSource,
      detailDataSource = detail.options.dataSource;

    detailDataSource.options.detail = true;
    detailDataSource.options.lineDataSources = {};
    detailDataSource.options.masterDataSource = masterDataSource;
    masterDataSource.options.master = {};
    masterDataSource.options.detailDataSource = detailDataSource;

    self.bind("change", function (e) {
      var currentHDataItem = master.dataItem(master.select()),
        uid;

      if ($.type(currentHDataItem) === "object") {
        uid = currentHDataItem._uid;
      }

      if (masterDataSource.options._dataChange) {
        detailDataSource._detailDataChange();
      }
      if ($.type(uid) !== "undefined" && $.type(detailDataSource.options.lineDataSources[uid]) === "undefined") {
        detailDataSource.options.lineDataSources[uid] = dews.ui.dataSource(
        "__ds_" + uid,
        detailDataSource.options);

        detailDataSource.options.lineDataSources[uid].options.master = {};
        detailDataSource.options.id = detailDataSource.id;
        detail.setDataSource(detailDataSource.options.lineDataSources[uid]);
        detailDataSource.options.lineDataSources[uid].read();

        if (masterDataSource.options._dataChange) {
          detailDataSource.options.lineDataSources[uid].options.parentDataSource = detailDataSource;
          detailDataSource.options.lineDataSources[uid]._detailDataChange();
        }
      } else {
        if (self.dataItems().length === 0) {
          detail.setDataSource(detailDataSource);
          detailDataSource.read();
        } else if ($.type(detailDataSource.options.lineDataSources[uid]) !== "undefined") {
          detail.setDataSource(detailDataSource.options.lineDataSources[uid]);
        }
      }
      masterDataSource.options.master[detailDataSource.options.id] = detailDataSource;
    });

    self.on("rowAdd", function (e) {
      var data = master.dataItem(e.row.index);
      data.set("_uid", guid());
    });

    function guid() {
      return "xxxxxxxx-xxxx-4xxx-9xxx-xxxxxxxxxxxx".replace(/[xy]/g, function (c) {
        var r = Math.random() * 16 | 0,
          v = c === "x" ? r : r & 0x3 | 0x8;
        return v.toString(16);
      });
    }
  };

  kendo.ui.TreeView.fn.raiseEvent = function (event) {
    var self = this,
      eventArray = [
      "collapse",
      "expand",
      "drag",
      "dragstart",
      "dragend",
      "click",
      "select",
      "change",
      "navigate",
      "check",
      "dataBound"];


    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "click") {
          self.element.trigger(event);
        } else {
          self.trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  // 트리뷰 이벤트 설정
  kendo.ui.TreeView.fn.on = function () {
    var self = this;

    if (arguments[0] === "click") {
      self.element.on.apply(self.element, arguments);
    } else {
      self.bind.apply(self, arguments);
    }
  };

  dews.ui.addControlInitializer("treeview", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.treeview($("ul.dews-ui-treeview", $container));
  });

  function refreshChildren(_refreshChildren) {
    return function (parentNode, items, index) {
      var i, children, child;
      var options = this.options;
      var loadOnDemand = options.loadOnDemand;
      var checkChildren = options.checkboxes && options.checkboxes.checkChildren;
      subGroup(parentNode).empty();
      if (!items.length) {
        updateNodeHtml(parentNode);
      } else {
        this._appendItems(index, items, parentNode);
        children = subGroup(parentNode).children();
        if (loadOnDemand && checkChildren) {
          var parentCheck = parentNode.find("> div:first-child .dews-ui-checkbox");
          if (parentCheck && parentCheck.prop("checked")) {
            children.find(".dews-ui-checkbox").prop("checked", "checked");
          }
          this._bubbleIndeterminate(children.last());
        }
        for (i = 0; i < children.length; i++) {
          child = children.eq(i);
          this.trigger("itemChange", {
            item: child.children("div"),
            data: this.dataItem(child),
            ns: kendo.ui
          });
        }
      }
    };
  }

  function subGroup(node) {
    var result = node.children(".k-animation-container");
    if (!result.length) {
      result = node;
    }
    return result.children(".k-group");
  }

  function updateNodeHtml(node) {
    var wrapper = node.children("div"),
      group = node.children("ul"),
      toggleButton = wrapper.children(".k-icon"),
      checkbox = node.children(":checkbox"),
      innerWrapper = wrapper.children(".k-in");
    if (node.hasClass("k-treeview")) {
      return;
    }
    if (!wrapper.length) {
      wrapper = $("<div />").prependTo(node);
    }
    if (!toggleButton.length && group.length) {
      toggleButton = $("<span class='k-icon' />").prependTo(wrapper);
    } else if (!group.length || !group.children().length) {
      toggleButton.remove();
      group.remove();
    }
    if (checkbox.length) {
      $("<span class='k-checkbox-wrapper' />").appendTo(wrapper).append(checkbox);
    }
    if (!innerWrapper.length) {
      innerWrapper = node.children("a").eq(0).addClass("k-in k-link");
      if (!innerWrapper.length) {
        innerWrapper = $("<span class='k-in' />");
      }
      innerWrapper.appendTo(wrapper);
      if (wrapper.length) {
        moveContents(wrapper[0].nextSibling, innerWrapper[0]);
      }
    }
  }

  function moveContents(node, container) {
    var tmp;
    while (node && node.nodeName.toLowerCase() != "ul") {
      tmp = node;
      node = node.nextSibling;
      if (tmp.nodeType == 3) {
        tmp.nodeValue = $.trim(tmp.nodeValue);
      }
      if (/k-sprite/.test(tmp.className)) {
        container.insertBefore(tmp, container.firstChild);
      } else {
        container.appendChild(tmp);
      }
    }
  }

  kendo.ui.TreeView.fn._refreshChildren = refreshChildren(kendo.ui.TreeView.fn._refreshChildren);
})(jQuery, window.dews, window.kendo);


/*
 * 업로드 컨트롤
 */
(function ($, dews, kendo) {
  var defaultOptions, attachFunctions;

  defaultOptions = {
    localization: {
      select: "첨부파일",
      dropFilesHere: "여기로 드래그"
    },
    showFileList: false,
    multiple: false,
    success: function success(e) {
      var self = this,
        response = e.response,
        $el = self.element,
        data;

      if (response.state === "error") {
        console.log(response);
        //alert(response.message);
      } else {
        data = response.data;

        if (data) {
          attachFunctions.add.call(self, data);
        }
      }
    },
    remove: function remove(e) {
      e.preventDefault();
    }
  };

  attachFunctions = {
    /**
     * 첨부파일 추가
     */
    add: function add(data, isNew) {
      var self = this,
        temp_attaches = [],
        new_attaches = [],
        attach_item,
        attach_keys = [],
        attach_names = [],
        $added;

      $added = $("#" + getControlNamePrefix(this.element) + "_added");

      if ($.type(isNew) === "undefined") {
        isNew = true;
      }

      if (data) {
        if (self.options.multiple === true) {
          if ($added.val()) {
            temp_attaches = $added.val().split("|");
          }
          if (temp_attaches.length > 0) {
            $.each(temp_attaches, function (idx) {
              attach_item = temp_attaches[idx].split(":");
              attach_keys.push(attach_item[0]);
              attach_names.push(attach_item[1]);
            });
          }

          if ($added.data("new")) {
            $.each($added.data("new").split("|"), function (idx, item) {
              new_attaches.push(item);
            });
          }
        } else {
          if ($added.data("new")) {
            $.each($added.data("new").split("|"), function (idx, item) {
              dews.ajax.post(self.options.async.removeUrl, {
                data: { fileKey: item }
              });
            });
          }
        }

        attach_keys.push(data.fileKey);
        attach_names.push(data.filename);
        if (isNew) {
          new_attaches.push(data.fileKey);
        }

        temp_attaches = [];

        for (var i = 0; i < attach_keys.length; i++) {
          temp_attaches.push(attach_keys[i] + ":" + attach_names[i]);
        }

        $added.val(temp_attaches.join("|"));
        $added.data("new", new_attaches.join("|"));

        $added.parent().find(".dews-ui-upload").trigger("added", [data]);
      }
    },
    /**
     * 첨부파일 제거
     */
    remove: function remove(fileKey) {
      var self = this,
        temp_attaches = [],
        new_attaches = [],
        attach_item,
        deleted = [],
        attach_keys = [],
        attach_names = [],
        $added,
        $deleted;

      $added = $("#" + getControlNamePrefix(self.element) + "_added");
      $deleted = $("#" + getControlNamePrefix(self.element) + "_deleted");

      if (fileKey) {
        if ($added.val()) {
          temp_attaches = $added.val().split("|");
        }
        if (temp_attaches.length > 0) {
          $.each(temp_attaches, function (idx) {
            attach_item = temp_attaches[idx].split(":");

            if (attach_item[0] === fileKey) {
              deleted.push(fileKey);
            } else {
              attach_keys.push(attach_item[0]);
              attach_names.push(attach_item[1]);
            }
          });
        }

        if ($added.data("new")) {
          $.each($added.data("new").split("|"), function (idx, item) {
            if (item === fileKey) {
              dews.ajax.post(self.options.async.removeUrl, {
                data: { fileKey: item }
              });
            } else {
              new_attaches.push(item);
            }
          });
        }

        temp_attaches = [];

        for (var i = 0; i < attach_keys.length; i++) {
          temp_attaches.push(attach_keys[i] + ":" + attach_names[i]);
        }

        $added.val(temp_attaches.join("|"));
        $added.data("new", new_attaches.join("|"));
        $deleted.val(deleted.join("|"));

        $added.parent().find(".dews-ui-upload").trigger("removed", [fileKey]);
      }
    }
  };

  // 옵션을 구성합니다.
  function configureOptions($el, userOptions) {
    var options,
      tagOptions = {};

    if ($el.data("dews-controller-url")) {
      // 컨트롤러 경로로 첨부파일 업로드 / 삭제 경로를 자동 생성
      $.extend(true, tagOptions, {
        async: {
          saveUrl: dews.url.getAbsoluteUrl(
          dews.url.join("~/", $el.data("dews-controller-url"), "/UploadFile")),

          removeUrl: dews.url.getAbsoluteUrl(
          dews.url.join("~/", $el.data("dews-controller-url"), "/DeleteFile"))

        }
      });
    }

    if ($el.data("dews-text")) {
      $.extend(true, tagOptions, {
        localization: {
          select: $el.data("dews-text")
        }
      });
    }

    options = $.extend(true, options, defaultOptions, tagOptions, userOptions || {});

    return options;
  }

  // 추가적으로 필요한 컨트롤들을 추가합니다.
  function appendAdditionalControls($el) {
    var namePrefix, $container, $added, addedName, $deleted, deletedName, hiddenTemplate, uploadManager;

    $container = $el.closest(".k-upload").addClass("dews-ui-upload-wrapper");
    hiddenTemplate = '<input type="hidden" name="{0}" id="{0}" />';

    namePrefix = getControlNamePrefix($el);

    addedName = namePrefix + "_added";
    deletedName = namePrefix + "_deleted";

    $added = $(dews.string.format(hiddenTemplate, addedName));
    $deleted = $(dews.string.format(hiddenTemplate, deletedName));

    $added.appendTo($container);
    $deleted.appendTo($container);
  }

  function getControlNamePrefix($el) {
    var namePrefix;

    if ($el.attr("name")) {
      namePrefix = $el.attr("name");
    } else if ($el.attr("id")) {
      namePrefix = $el.attr("id");
    } else {
      namePrefix = "file_" + $("input[type=file]").index($el).toString();
    }

    return namePrefix;
  }

  // dews 확장
  $.extend(true, dews, {
    ui: {
      /**
       * BBS 업로드 컨트롤
       *
       * @param {jQuery|String} selector 업로드 컨트롤로 만들 대상 컨트롤의 jQuery객체 또는 셀렉터
       * @param {Object} [options] 업로드 설정
       */
      upload: function upload(selector, options) {
        var $el, upload;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if (kendo) {
          $el.each(function () {
            var $this = $(this),
              opt,
              ctrl;

            ctrl = $this.data("dews-control");

            if (!ctrl) {
              opt = configureOptions($this, options);

              if (!$this.hasClass("dews-ui-upload")) {
                $this.addClass("dews-ui-upload");
              }

              if (!$this.hasClass("dews-form-control")) {
                $this.addClass("dews-form-control");
              }

              if ($this.attr("tabindex") !== "-1") {
                $this.attr("tabindex", "-1");
              }

              $this.addClass("dews-control-activate");
              $this.kendoUpload(opt);
              $this.closest(".k-upload").addClass("dews-upload-wrapper");

              appendAdditionalControls($this);

              ctrl = $this.data("kendoUpload");

              $this.data("dews-control", ctrl);
            }

            upload = ctrl;
          });
        }

        return upload;
      }
    }
  });

  /**
   * 이전에 등록된 파일을 추가합니다.
   */
  kendo.ui.Upload.prototype.addFile = function (fileKey, filename) {
    attachFunctions.add.call(this, { fileKey: fileKey, filename: filename }, false);
  };

  /**
   * 파일을 제거합니다.
   */
  kendo.ui.Upload.prototype.removeFile = function (fileKey) {
    attachFunctions.remove.call(this, fileKey);
  };

  dews.ui.addControlInitializer("upload", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.upload($("input[type=file].dews-ui-upload", $container));
  });
})(jQuery, window.dews, window.kendo);


/**
 * 주기간피커
 * Created by yejin on 2018. 1. 16..
 */
(function ($, dews, kendo) {
  var defaultOptions = {
    startWeek: null,
    endWeek: null,
    max: 9999,
    min: 1000
  };

  function getOptions($el, srcOptions) {
    var inlineOptions,
      preDefinedFormat,
      options = {
        format: dews._environments.formats.weekFormat,
        valueFormat: dews._environments.formats.weekValueFormat
      };

    inlineOptions = getInlineOptions($el);
    if (srcOptions) {
      srcOptions.format ? $el.data("dews-format", srcOptions.format) : "";
      srcOptions.predefined ? $el.data("dews-format-predefined", srcOptions.predefined) : "";
    }
    preDefinedFormat = dews.getPreDefinedFormat($el);

    if (preDefinedFormat) {
      var vf = preDefinedFormat.replace(/[^(a-z)]/gi, "");
      preDefinedFormat = {
        format: preDefinedFormat,
        valueFormat: vf
      };
      options = $.extend(true, options, defaultOptions, inlineOptions, srcOptions, preDefinedFormat);
    } else if (preDefinedFormat !== false && inlineOptions) {
      options = $.extend(true, options, defaultOptions, inlineOptions, srcOptions);
    } else {
      if (srcOptions !== undefined) {
        srcOptions.format =
        preDefinedFormat === false && srcOptions.format && srcOptions.predefined === true ?
        defaultOptions.format :
        srcOptions.format;
      }
      options = $.extend(true, options, defaultOptions, srcOptions);
    }

    if ($el.val()) {
      options.value = kendo.parseDate($el.val(), options.valueFormat, kendo.getCulture());
    }
    return options;
  }

  /**
   * HTML 태그에 지정된 옵션을 가져옵니다.
   * @param {jQuery} $el 대상 요소의 jQuery 객체
   * @returns {object} 옵션
   */
  function getInlineOptions($el) {
    var options = {};

    if ($el.data("dews-format")) {
      options.format = $el.data("dews-format");
    }
    if ($el.data("dews-start-week")) {
      options.startWeek = $el.data("dews-start-week");
    }
    if ($el.data("dews-end-week")) {
      options.endWeek = $el.data("dews-end-week");
    }
    return options;
  }

  var WeekPeriodPicker = function WeekPeriodPicker(element, options) {
    var self = this,
      $element = element;
    var thisYear = new Date().getFullYear();

    self.options = getOptions($element, options);

    self._$wrapper = null;
    self._$startInput = null;
    self._$endInput = null;
    self._$calenderButton = null;
    self._$hiddenArea = null;
    self._$buttons = null;
    self._$buttons2 = null;
    self._$okButton = null;
    self.option = null;
    self.disableButton = false;
    self._thisYear = thisYear;
    self._$element = $element;
  };

  //wrapper 생성
  WeekPeriodPicker.prototype._createWrapper = function () {
    var self = this,
      $el = self._$element,
      $wrapper,
      width;

    $wrapper = $("<span/>").addClass("dews-weekperiodpicker-wrapper dews-control");

    if ($el.attr("style")) {
      var matches = $el.attr("style").match(/width:([^;]+);?/i);

      if (matches) {
        width = $.trim(matches[1]);
        $wrapper.width(width);
        $el.css("width", "");
      }
    }

    if ($el.hasClass("readonly")) {
      $wrapper.addClass("dews-state-readonly");
      $el.addClass("dews-state-readonly");
      self.disableButton = true;
    }
    if ($el.hasClass("disabled")) {
      $wrapper.addClass("dews-state-disabled");
      $el.addClass("dews-state-disabled");
      self.disableButton = true;
    }
    if ($el.hasClass("required")) {
      $wrapper.addClass("dews-state-required");
      $el.addClass("dews-state-required");
    }
    $el.wrap($wrapper);
    self._$wrapper = $el.parent(".dews-weekperiodpicker-wrapper");
  };

  // 시작날짜 텍스트박스 생성
  WeekPeriodPicker.prototype._createStartInput = function () {
    var self = this,
      $el = self._$element,
      $startInput,
      opt;

    $startInput = $("<input/>").addClass(
    "dews-weekperiodpicker-input dews-weekperiodpicker-startDate k-textbox k-space-right");


    if ($el.hasClass("readonly")) {
      $startInput.addClass("dews-state-readonly");
      $startInput.attr("readonly", "readonly");
    }
    if ($el.hasClass("disabled")) {
      $startInput.addClass("dews-state-disabled");
      $startInput.attr("disabled", "disabled");
    }
    if ($el.hasClass("required")) {
      $startInput.addClass("dews-state-required");
    }

    opt = self.options;

    setMask($startInput, opt.format);
    setEvent($startInput, opt);

    $el.append($startInput);
    self._$startInput = $startInput;
  };

  // 종료날짜 텍스트박스 생성
  WeekPeriodPicker.prototype._createEndInput = function () {
    var self = this,
      $el = self._$element,
      $endInput,
      $span,
      opt;

    $endInput = $("<input/>").addClass(
    "dews-weekperiodpicker-input dews-weekperiodpicker-endDate k-textbox k-space-right");

    $span = $("<span>~</span>").addClass("dews-weekperiodpicker-span");

    if ($el.hasClass("readonly")) {
      $endInput.addClass("dews-state-readonly");
      $endInput.attr("readonly", "readonly");
    }
    if ($el.hasClass("disabled")) {
      $endInput.addClass("dews-state-disabled");
      $endInput.attr("disabled", "disabled");
    }
    if ($el.hasClass("required")) {
      $endInput.addClass("dews-state-required");
    }

    opt = self.options;

    setMask($endInput, opt.format);
    setEvent($endInput, opt);

    $el.append($span);
    $el.append($endInput);
    self._$endInput = $endInput;
  };

  // 달력버튼 생성
  WeekPeriodPicker.prototype._createCalendarButton = function () {
    var self = this,
      $el = self._$element,
      $calendarButton,
      $img;

    $calendarButton = $("<span/>").addClass("k-select");
    $img = $("<span/>").addClass("k-icon k-i-calendar");

    $el.append($calendarButton);
    $calendarButton.append($img);
    self._$calenderButton = $calendarButton;
  };

  // 숨겨진 영역 생성
  WeekPeriodPicker.prototype._createHiddenArea = function () {
    var self = this,
      $hiddenArea;

    $hiddenArea = $("<div/>").addClass("dews-weekperiodpicker-calendars");

    $(document.body).append($hiddenArea);
    self._$hiddenArea = $hiddenArea;
  };

  //선택한 기간, 적용하기 버튼 영역 생성
  WeekPeriodPicker.prototype._createOkButtonArea = function () {
    var self = this,
      $buttons,
      $buttons2;

    $buttons = $("<div/>").addClass("dews-weekperiodpicker-buttons");
    $buttons2 = $("<div/>").addClass("dews-weekperiodpicker-buttons2");

    self._$hiddenArea.append($buttons).append($buttons2);
    self._$buttons = $buttons;
    self._$buttons2 = $buttons2;
  };

  //숫자텍스박스 생성
  WeekPeriodPicker.prototype._createNumericTextBox = function () {
    var self = this,
      $startYear,
      $starWeek,
      $endYear,
      $endWeek,
      $periodSelect;

    $periodSelect = $("<p>" + dews.localize.get("선택 기간", "dews_선택 기간") + " :<br/></p>").addClass(
    "dews-weekperiodpicker-periodSelect");

    $startYear = $("<input type='text' data-dews-spinners='true' max='9999' data-dews-format='#'/>").addClass(
    "dews-ui-numerictextbox dews-weekperiodpicker-firstyear");

    $starWeek = $("<input type='text' data-dews-spinners='true' max='53' min='1' data-dews-format='#'/>").addClass(
    "dews-ui-numerictextbox dews-weekperiodpicker-firstweek");

    $endYear = $("<input type='text' data-dews-spinners='true' max='9999' data-dews-format='#'/>").addClass(
    "dews-ui-numerictextbox dews-weekperiodpicker-secondyear");

    $endWeek = $("<input type='text' data-dews-spinners='true' max='53' min='1' data-dews-format='#'/>").addClass(
    "dews-ui-numerictextbox dews-weekperiodpicker-secondweek");


    self._$buttons.
    append($periodSelect).
    append($startYear).
    append("<span class='dews-weekperiodpicker-year'>" + dews.localize.get("년", "dews_년yr") + "</span>").
    append($starWeek).
    append("<span  class='dews-weekperiodpicker-week'>" + dews.localize.get("주", "dews_주wk") + "</span>").
    append("<span class=dews-weekperiodpicker-period>~</span>").
    append($endYear).
    append("<span class='dews-weekperiodpicker-year'>" + dews.localize.get("년", "dews_년yr") + "</span>").
    append($endWeek).
    append("<span  class='dews-weekperiodpicker-week'>" + dews.localize.get("주", "dews_주wk") + "</span>");

    self._$startYear = dews.ui.numerictextbox($startYear);
    self._$startWeek = dews.ui.numerictextbox($starWeek);
    self._$endYear = dews.ui.numerictextbox($endYear);
    self._$endWeek = dews.ui.numerictextbox($endWeek);
  };

  //선택한 기간 생성
  WeekPeriodPicker.prototype._createPeriodDate = function () {
    var self = this,
      $periodDate,
      $periodSelect;

    $periodSelect = $("<p>" + dews.localize.get("선택한 기간", "dews_선택한 기간") + ":</p>").addClass(
    "dews-weekperiodpicker-periodselect");

    $periodDate = $("<strong/>").addClass("dews-weekperiodpicker-perioddate");

    self._$buttons2.append($periodSelect);
    $periodSelect.append($periodDate);

    self._$periodDate = $periodDate;
  };

  //적용하기 버튼 생성
  WeekPeriodPicker.prototype._createOkButton = function () {
    var self = this,
      $okButton;

    $okButton = $("<button type='button'>" + dews.localize.get("적용하기", "dews_적용하기") + "</button>").addClass(
    "dews-ui-button endWeekall small primary dews-weekperiodpicker-ok k-button");


    self._$buttons2.append($okButton);
    self._$okButton = $okButton;
  };

  WeekPeriodPicker.prototype._setNumericTextBoxValue = function (startY, startW, endY, endW) {
    var self = this;

    self._$startYear.value(startY);
    self._$startWeek.value(startW);
    self._$endYear.value(endY);
    self._$endWeek.value(endW);
  };

  // 컨트롤 초기화
  WeekPeriodPicker.prototype._initControl = function () {
    var self = this;

    self._createWrapper();
    self._createStartInput();
    self._createEndInput();
    self._createCalendarButton();
    self._createHiddenArea();
    self._createOkButtonArea();
    self._createNumericTextBox();
    self._createPeriodDate();
    self._createOkButton();
    self._setNumericTextBoxValue();
    self._bindEvents();

    self.setUserGuideAPI();
  };

  /**
   * 주기간피커의 활성화 여부를 설정하거나 가져옵니다.
   * @param {boolean} [value] 설정할 활성화 여부(생략하면 현재 활성화 여부를 반환합니다.)
   * @returns {boolean} 활성화 여부
   */
  WeekPeriodPicker.prototype.enable = function (value) {
    var self = this,
      $el = $(self._$element),
      enabled;

    enabled = !$el.hasClass("disabled");

    if (typeof value !== "undefined") {
      if (value === true) {
        $el.removeClass("disabled");
        $el.removeClass("dews-state-disabled");
        self._$wrapper.removeClass("dews-state-disabled");
        self._$startInput.removeAttr("disabled", "disabled");
        self._$endInput.removeAttr("disabled", "disabled");
        self._$startInput.removeClass("dews-state-disabled");
        self._$endInput.removeClass("dews-state-disabled");
      } else if (value === false) {
        $el.addClass("disabled");
        $el.addClass("dews-state-disabled");
        self._$wrapper.addClass("dews-state-disabled");
        self._$startInput.attr("disabled", "disabled");
        self._$endInput.attr("disabled", "disabled");
        self._$startInput.addClass("dews-state-disabled");
        self._$endInput.addClass("dews-state-disabled");
      }
    } else {
      return enabled;
    }
  };

  /**
   * 주 기간피커의 visible 여부를 가져옵니다.
   * @returns {boolean}
   * @private
   */
  WeekPeriodPicker.prototype._visibleCheckFromPanel = function () {
    var self = this,
      $ctrl = self._$element;
    isVisible = $ctrl.css("display") !== "none";

    return isVisible;
  };

  WeekPeriodPicker.prototype.required = function (value) {
    var self = this;
    var $el = self._$element;
    var $wrapper = self._$wrapper;
    var $startInput = self._$startInput;
    var $endInput = self._$endInput;

    if (typeof value === "undefined") {
      return $el.hasClass("required");
    } else if (value === true) {
      $el.addClass("required");
      $el.addClass("dews-state-required");
      $wrapper.addClass("dews-state-required");
      $startInput.addClass("dews-state-required");
      $endInput.addClass("dews-state-required");
    } else if (value === false) {
      $el.removeClass("required");
      $el.removeClass("dews-state-required");
      $wrapper.removeClass("dews-state-required");
      $startInput.removeClass("dews-state-required");
      $endInput.removeClass("dews-state-required");
    }
  };

  //readonly 설정 함수
  WeekPeriodPicker.prototype.readonly = function (value) {
    var self = this,
      $el = $(self._$element),
      readonly;

    readonly = $el.hasClass("dews-state-readonly");

    if (typeof value !== "undefined") {
      if (value === false) {
        $el.removeClass("dews-state-readonly");
        self._$wrapper.removeClass("dews-state-readonly");
        self._$startInput.removeAttr("readonly", "readonly");
        self._$endInput.removeAttr("readonly", "readonly");
        self._$startInput.removeClass("dews-state-readonly");
        self._$endInput.removeClass("dews-state-readonly");
        self.disableButton = false;
        readonly = !value;
      } else if (value === true) {
        $el.addClass("dews-state-readonly");
        self._$wrapper.addClass("dews-state-readonly");
        self._$startInput.attr("readonly", "readonly");
        self._$endInput.attr("readonly", "readonly");
        self._$startInput.addClass("dews-state-readonly");
        self._$endInput.addClass("dews-state-readonly");
        self.disableButton = true;
        readonly = !value;
      }
    }
    return readonly;
  };

  //focus 설정 함수
  WeekPeriodPicker.prototype.focus = function (options) {
    var self = this;

    if (options === "start") {
      self._$startInput.focus();
    } else if (options === "end") {
      self._$endInput.focus();
    } else if (options === undefined) {
      self._$startInput.focus();
    }
  };

  //'201801' 을 '2018-01' 로. 포맷이 지정된 날짜로 설정
  WeekPeriodPicker.prototype.dateStringToFormatedString = function (year, week) {
    var self = this;

    if (parseInt(year) > 9999 || parseInt(year) <= 999) {
      return null;
    }

    if (parseInt(week) >= 53 || parseInt(week) < 1) {
      return null;
    }

    return self.options.format.replace(/w{1,2}/gi, week).replace(/y{2,4}/gi, year);
  };

  //'2018-01' 을 '201801'로. 포맷이 지정되지 않은 날짜로 설정.
  //flag 값의 유무에 따라 year, week 값 리턴
  WeekPeriodPicker.prototype.getWeek = function (input, flag) {
    var self = this,
      inputValue;
    var endWithWeek;
    if ($.type(input) === "object") {
      inputValue = input.val();
    } else {
      inputValue = input;
    }
    var format = self.options.format,
      initValue = inputValue;
    var year, week, arrYears, arrWeeks;

    initValue = $.trim(initValue);

    if (/-|\/|~/.test(initValue)) {
      endWithWeek = /w$/gi.test(format);
    } else {
      endWithWeek = /w$/gi.test(format);
      var noFormat = true;
    }

    if (!noFormat) {
      if (endWithWeek) {
        arrYears = /^\d+/.exec(initValue);
        arrWeeks = /\d+$/.exec(initValue);
      } else {
        arrYears = /\d+$/.exec(initValue);
        arrWeeks = /^\d+/.exec(initValue);
      }
    } else {
      year = initValue.substring(0, 4);
      week = initValue.substring(4, 6);
    }

    if ($.isArray(arrWeeks) && $.isArray(arrYears)) {
      year = parseInt(arrYears[0], 10);
      week = parseInt(arrWeeks[0], 10);

      week = week < 10 ? "0" + week.toString() : week;
    }

    if (flag === "week") {
      return week ? week : "";
    } else if (flag === "year") {
      return year ? year : "";
    } else if (year && week) {
      return year + "" + week;
    } else {
      return "";
    }
  };

  //포맷이 지정되지 않은 시작 주차 리턴
  WeekPeriodPicker.prototype.getStartWeek = function () {
    var self = this;

    return this.getWeek(self._$startInput) || "";
  };

  //포맷이 지정되지 않은 종료 주차 리턴
  WeekPeriodPicker.prototype.getEndWeek = function () {
    var self = this;

    return this.getWeek(self._$endInput) || "";
  };

  //포맷이 지정된 시작 주차 리턴
  WeekPeriodPicker.prototype.getStartWeekText = function () {
    var self = this,
      year = this.getWeek(self._$startInput, "year") ? this.getWeek(self._$startInput, "year").toString() : "",
      week = this.getWeek(self._$startInput, "week") ? this.getWeek(self._$startInput, "week").toString() : "";

    if (year && week) {
      return "yyyy-WW".replace(/w{1,2}/gi, week).replace(/y{2,4}/gi, year) || "";
    } else {
      return "";
    }
  };

  //포맷이 지정된 종료 주차 리턴
  WeekPeriodPicker.prototype.getEndWeekText = function () {
    var self = this,
      year = this.getWeek(self._$endInput, "year") ? this.getWeek(self._$endInput, "year").toString() : "",
      week = this.getWeek(self._$endInput, "week") ? this.getWeek(self._$endInput, "week").toString() : "";

    if (year && week) {
      return "yyyy-WW".replace(/w{1,2}/gi, week).replace(/y{2,4}/gi, year) || "";
    } else {
      return "";
    }
  };

  //date 형태를 포맷이 지정된 날짜 스트링으로 리턴
  WeekPeriodPicker.prototype._dateToString = function (date) {
    return kendo.toString(date, "yyyyMMdd", kendo.getCulture());
  };

  //시작 주차의 시작하는 날의 년, 월, 일을 가져옴
  WeekPeriodPicker.prototype.getStartFirstDate = function () {
    var self = this;
    var value = this.getWeek(self._$startInput);
    var startFirstDate = this._getStartDate(value);

    return this._dateToString(startFirstDate);
  };

  //시작 주차의 종료하는 날의 년, 월, 일을 가져옴
  WeekPeriodPicker.prototype.getStartLastDate = function () {
    var self = this;
    var value = this.getWeek(self._$startInput);
    var startLastDate = this._getEndDate(value);

    return this._dateToString(startLastDate);
  };

  //종료 주차의 시작하는 날의 년, 월, 일을 가져옴
  WeekPeriodPicker.prototype.getEndFirstDate = function () {
    var self = this;
    var value = this.getWeek(self._$endInput);
    var endFirstDate = this._getStartDate(value);

    return this._dateToString(endFirstDate);
  };

  //종료 주차의 종료하는 날의 년, 월, 일을 가져옴
  WeekPeriodPicker.prototype.getEndLastDate = function () {
    var self = this;
    var value = this.getWeek(self._$endInput);
    var endLastDate = this._getEndDate(value);

    return this._dateToString(endLastDate);
  };

  //설정한 날짜의 시작 날짜 리턴
  WeekPeriodPicker.prototype._getStartDate = function (value) {
    var self = this;
    var year = parseInt(value.substring(0, 4)),
      week = parseInt(value.substring(4, 6));
    var toDate = new Date(year, 0, 1 + (week - 1) * 7);
    var getDay = toDate.getDay(); // getDay : 요일에 해당하는 인덱스. 일요일(0), 월요일(1)...
    var startDate = toDate;

    if (getDay <= 4) {
      // 1일이 목요일이 넘지 않았다면 당해년도의 첫째 주
      startDate.setDate(toDate.getDate() - toDate.getDay() + 1);
    } else {
      // 금, 토, 일이라면 작년의 마지막 주
      startDate.setDate(toDate.getDate() + 8 - toDate.getDay());
    }
    return startDate;
  };

  //설정한 날짜의 종료 날짜 리턴
  WeekPeriodPicker.prototype._getEndDate = function (value) {
    var self = this;
    var year = parseInt(value.substring(0, 4)),
      week = parseInt(value.substring(4, 6));
    var toEndDate = new Date(year, 0, 1 + (week - 1) * 7);
    var getDay = toEndDate.getDay();
    var endDate = toEndDate;
    var startDate = this._getStartDate(value);
    var calEndDate = 7 - getDay;
    if (startDate) {
      if (getDay <= 4) {
        endDate.setDate(toEndDate.getDate() + calEndDate);
      } else {
        // 2019-01 의 시작 날짜가 20181231 일 때
        endDate.setDate(startDate.getDate() + 6);
      }
      return endDate;
    }
  };

  //date를 받아서 그에 해당하는 주차를 가져옴
  WeekPeriodPicker.prototype._checkWeekNum = function (date) {
    return kendo.date.weekInYear(date);
  };

  //시작 날짜를 설정함
  WeekPeriodPicker.prototype.setStartWeek = function (value) {
    var self = this;
    var newDate, startYear, startWeek, dateValue;

    if (!isNaN(value)) {
      if ($.type(value) === "date") {
        var checkNum = self._checkWeekNum(value).toString();
        newDate = value;
        startYear = newDate.getFullYear();
        startWeek = checkNum < 10 ? "0" + checkNum : checkNum;
      } else if (value) {
        dateValue = value.toString();
        startYear = self.getWeek(dateValue, "year").toString();
        startWeek = self.getWeek(dateValue, "week").toString();
      } else {
        startYear = "";
        startWeek = "";
      }

      if (startWeek && startYear) {
        dateValue = self.options.format.replace(/w{1,2}/gi, startWeek).replace(/y{2,4}/gi, startYear);
      } else if (!startWeek && !startYear) {
        dateValue = "";
      }

      if (
      self._$endInput.val() &&
      self.getWeek(self._$endInput, "year").toString() + self.getWeek(self._$endInput, "week").toString() <
      startYear + startWeek)
      {
        self._$startYear.value("");
        self._$startWeek.value("");

        self._$startInput.attr("val", "");
        self._$startInput.val("");
      } else {
        self._$startYear.value(startYear);
        self._$startWeek.value(startWeek);

        self._$startInput.attr("val", dateValue);
        self._$startInput.val(dateValue);
      }
    }
  };

  //종료 날짜를 설정함
  WeekPeriodPicker.prototype.setEndWeek = function (value) {
    var self = this;
    var newDate, endYear, endWeek, dateValue;

    if (!isNaN(value)) {
      if ($.type(value) === "date") {
        var checkNum = self._checkWeekNum(value).toString();
        newDate = value;
        endYear = newDate.getFullYear();
        endWeek = checkNum < 10 ? "0" + checkNum : checkNum;
      } else if (value) {
        dateValue = value.toString();
        endYear = self.getWeek(dateValue, "year").toString();
        endWeek = self.getWeek(dateValue, "week").toString();
      } else {
        endYear = "";
        endWeek = "";
      }

      if (endWeek && endYear) {
        dateValue = self.options.format.replace(/w{1,2}/gi, endWeek).replace(/y{2,4}/gi, endYear);
      } else if (!endWeek && !endYear) {
        dateValue = "";
      }

      if (
      self._$startInput.val() &&
      self.getWeek(self._$startInput, "year").toString() +
      self.getWeek(self._$startInput, "week").toString() >
      endYear + endWeek)
      {
        self._$endYear.value("");
        self._$endWeek.value("");

        self._$endInput.attr("val", "");
        self._$endInput.val("");
      } else {
        self._$endYear.value(endYear);
        self._$endWeek.value(endWeek);

        self._$endInput.attr("val", dateValue);
        self._$endInput.val(dateValue);
      }
    }
  };

  //기간을 from, to 형태로 설정함
  WeekPeriodPicker.prototype.setPeriod = function (start, end) {
    var self = this,
      getStartDate,
      getEndDate;

    if (start) {
      getStartDate = self._getStartDate(self.getWeek(start, "year") + "" + self.getWeek(start, "week"));
      getStartDate = kendo.toString(getStartDate, dews._environments.formats.dateFormat, kendo.getCulture());
    }

    if (end) {
      getEndDate = self._getStartDate(self.getWeek(end, "year") + "" + self.getWeek(end, "week"));
      getEndDate = kendo.toString(getEndDate, dews._environments.formats.dateFormat, kendo.getCulture());
    }

    if (start && end && start <= end) {
      this.setStartWeek(start);
      this.setEndWeek(end);
      self._$periodDate.text(getStartDate + "~" + getEndDate);
    } else if (start && end && start > end) {
      this.setStartWeek("");
      this.setEndWeek("");
    } else if (start && !end) {
      this.setStartWeek(start);
      this.setEndWeek("");
    } else if (!start && end) {
      this.setStartWeek("");
      this.setEndWeek(end);
    } else if (!start && !end) {
      this.setStartWeek("");
      this.setEndWeek("");
    }

    if (!(start && end && start <= end)) {
      self._$periodDate.text("");
    }
  };

  //이벤트 처리
  WeekPeriodPicker.prototype._bindEvents = function () {
    var self = this,
      $el = self._$element;
    var toggle = true;
    var offset = 0;

    if ($el.hasClass("readonly")) {
      self.disableButton = true;
    }

    self._$startInput.on("focus", function (e) {
      $el.addClass("dews-weekperiodpicker-focus");
      e.stopPropagation();
    });

    self._$endInput.on("focus", function (e) {
      $el.addClass("dews-weekperiodpicker-focus");
      e.stopPropagation();
    });

    self._$startInput.on("blur", function (e) {
      $el.removeClass("dews-weekperiodpicker-focus");
      e.stopPropagation();
    });

    self._$endInput.on("blur", function (e) {
      $el.removeClass("dews-weekperiodpicker-focus");
      e.stopPropagation();
    });

    var popoverClose = function popoverClose(e) {
      if (
      e.type === "scroll" && !$(e.target).parents(".dews-weekperiodpicker-calendars")[0] ||
      e.type === "keyup" && e.keyCode === 27)
      {
        close();
        $(e.target).focus();
        if (self._$startInput.val() === "") {
          _setNumerictextboxValue("", self._$endInput.val());
        } else if (self._$endInput.val() === "") {
          _setNumerictextboxValue(self._$startInput.val(), "");
        }
      }
    };

    function bindCloseEvent() {
      window.addEventListener("scroll", popoverClose, true);
      window.addEventListener("keyup", popoverClose, true);
      // 버튼, 달력창 영역을 제외한 나머지 부분 클릭시 달력창 닫기
      $(window).on("click", function (e) {
        if (!$(e.target).parents(".dews-weekperiodpicker-calendars")[0]) {
          close();

          var startSet = self._$startInput.val(),
            endSet = self._$endInput.val();

          //값을 변경하고 딴 곳을 클릭해 달력닫고, 다시 열었을 때 값 맞추기.
          if (startSet && endSet) {
            _setNumerictextboxValue(startSet, endSet);
          }
          if (startSet === "") {
            _setNumerictextboxValue("", endSet);
          }
          if (endSet === "") {
            _setNumerictextboxValue(startSet, "");
          }
        }
        e.stopPropagation();
      });
    }

    //달력버튼 클릭 시
    self._$calenderButton.on("click", function (e) {
      if (!self.disableButton) {
        if (toggle) {
          bindCloseEvent();
          var el_offset = $el.offset();
          var zIndex = dews.ui.getDialogMaxZIndex();

          if (zIndex > parseInt(self._$hiddenArea.css("zIndex"), 10)) {
            self._$hiddenArea.css("zIndex", zIndex + 2);
          }

          self._$okButton.prop("disabled", false);
          self._$okButton.removeClass("k-state-disabled");

          self._$hiddenArea.css({
            left: parseFloat(el_offset.left) + "px"
          });

          if ($(window).height() < $(this).offset().top - offset + self._$hiddenArea.height() + 24) {
            self._$hiddenArea.css("top", parseFloat(el_offset.top) - self._$hiddenArea.height() - 1);
            if ($(this).offset().top - offset < self._$hiddenArea.height()) {
              self._$hiddenArea.css("top", parseFloat(el_offset.top) + 23);
            }
          } else {
            self._$hiddenArea.css("top", parseFloat(el_offset.top) + self._$wrapper.height() - 1);
          }

          if ($(window).width() - (self._$wrapper.offset().left + self._$hiddenArea.width()) < 0) {
            var right_width = self._$calenderButton.offset().left + 22.7969 - self._$hiddenArea.width();
            self._$hiddenArea.css("left", right_width);
            if ($(window).width() < self._$hiddenArea.width()) {
              self._$hiddenArea.css("left", parseFloat(el_offset.left) + 1);
            }
          }

          selectedPeriod();

          if (self._$startInput.val() === "") {
            _setNumerictextboxValue("", self._$endInput.val());
          } else if (self._$endInput.val() === "") {
            _setNumerictextboxValue(self._$startInput.val(), "");
          } else {
            _setNumerictextboxValue(self._$startInput.val(), self._$endInput.val());
          }

          self._$element.addClass("dews-weekperiodpicker-focus");
          self._$calenderButton.addClass("dews-weekperiodpicker-focus");
          self._$hiddenArea.addClass("opened");
          toggle = false;
        } else {
          close();
        }
      }
      e.stopPropagation();
    });

    //적용하기 버튼 클릭 시
    self._$okButton.on("click", function (e) {
      var startYear, endYear, startWeek, endWeek;
      var preStartDate, preEndDate, currStartDate, currEndDate;

      if (self._$startYear.value() && self._$startWeek.value()) {
        startYear = self._$startYear.value().toString();
        startWeek =
        self._$startWeek.value().toString() < 10 ?
        "0" + self._$startWeek.value().toString() :
        self._$startWeek.value().toString();
      }

      if (self._$endYear.value() && self._$endWeek.value()) {
        endYear = self._$endYear.value().toString();
        endWeek =
        self._$endWeek.value().toString() < 10 ?
        "0" + self._$endWeek.value().toString() :
        self._$endWeek.value().toString();
      }

      preStartDate = self._getStartDate(self._$startInput.val());
      preEndDate = self._getStartDate(self._$endInput.val());

      currStartDate = self._getStartDate(self._$startYear.value() + "" + startWeek);
      currEndDate = self._getStartDate(self._$endYear.value() + "" + endWeek);

      if (self._$startYear.value() && self._$startWeek.value()) {
        var formatedStartDate = self.options.format.
        replace(/w{1,2}/gi, startWeek).
        replace(/y{2,4}/gi, startYear);
        self._$startInput.attr("val", formatedStartDate);
        self._$startInput.val(formatedStartDate);
      }

      if (self._$endYear.value() && self._$endWeek.value()) {
        var formatedEndDate = self.options.format.replace(/w{1,2}/gi, endWeek).replace(/y{2,4}/gi, endYear);
        self._$endInput.attr("val", formatedEndDate);
        self._$endInput.val(formatedEndDate);
      }

      //이전 값과 새로 입력한 값이 다를 경우 change 이벤트 실행
      if (preStartDate && currStartDate) {
        if (preStartDate.getTime() !== currStartDate.getTime()) {
          self._$wrapper.trigger("change");
          self._$wrapper.trigger("_change");
        }
      } else if (preEndDate && currEndDate) {
        if (preEndDate.getTime() !== currEndDate.getTime()) {
          self._$wrapper.trigger("change");
          self._$wrapper.trigger("_change");
        }
      }
      close();
      e.stopPropagation();
    });

    //숨겨진 영역 닫는 함수
    function close() {
      self._$element.removeClass("dews-weekperiodpicker-focus");
      self._$calenderButton.removeClass("dews-weekperiodpicker-focus");
      self._$hiddenArea.removeClass("opened").css("zIndex", "");
      toggle = true;
      window.removeEventListener("scroll", popoverClose, true);
      window.removeEventListener("keyup", popoverClose, true);
      $(window).off("click");
    }

    //선택한 기간에 대한 출력
    function selectedPeriod() {
      var startYear, startWeek, endYear, endWeek;
      if (self._$startYear.value() && self._$startWeek.value()) {
        startYear = self._$startYear.value();
        startWeek =
        self._$startWeek.value() < 10 ?
        "0" + self._$startWeek.value().toString() :
        self._$startWeek.value();

        var getStartDate = self._getStartDate(startYear + "" + startWeek);

        // 날짜포맷일 경우에만 입력
        if (getStartDate instanceof Date && !isNaN(getStartDate)) {
          getStartDate = kendo.toString(
          getStartDate,
          dews._environments.formats.dateFormat,
          kendo.getCulture());

        } else {
          getStartDate = "";
        }
      }

      if (self._$endYear.value() && self._$endWeek.value()) {
        endYear = self._$endYear.value();
        endWeek =
        self._$endWeek.value() < 10 ? "0" + self._$endWeek.value().toString() : self._$endWeek.value();
        var getEndDate = self._getEndDate(endYear + "" + endWeek);

        if (getEndDate instanceof Date && !isNaN(getEndDate)) {
          getEndDate = kendo.toString(getEndDate, dews._environments.formats.dateFormat, kendo.getCulture());
        } else {
          getEndDate = "";
        }
      }

      if (startYear && startWeek && endYear && endWeek) {
        if (startYear.toString() + startWeek.toString() <= endYear.toString() + endWeek.toString()) {
          self._$periodDate.text(getStartDate + "~" + getEndDate);
        } else {
          self._$periodDate.text("");
        }
      }

      if (!getStartDate || !getEndDate) {
        self._$periodDate.text("");
      }
    }

    //숫자텍스트박스 값이 변할 때마다 처리하는 함수
    function changeHandler(e) {
      var startYear = self._$startYear.value();
      var startWeek = self._$startWeek.value();
      var endYear = self._$endYear.value();
      var endWeek = self._$endWeek.value();
      var getDate, maxWeekNum;

      if (e.type === "keyup") {
        startYear = parseInt(self._$startYear.element.val());
        endYear = parseInt(self._$endYear.element.val());
      }

      if (startYear && (startYear + "").length === 4 && startYear < self.options.min) {
        startYear = self.options.min;
      }
      if (endYear && (endYear + "").length === 4 && endYear < self.options.min) {
        endYear = self.options.min;
      }

      if (startYear === self.options.min) {
        self._$startYear.value(self._thisYear);
      }
      if (endYear === self.options.min) {
        self._$endYear.value(self._thisYear);
      }

      if (startYear && startWeek) {
        var startWeek2 =
        self._$startWeek.value() < 10 ?
        "0" + self._$startWeek.value().toString() :
        self._$startWeek.value();

        getDate = self._getStartDate(startYear + "" + startWeek2);
        maxWeekNum = self._checkWeekNum(getDate);

        if (startWeek >= 53) {
          if (maxWeekNum !== startWeek) {
            self._$startWeek.value(52);
          }
        }
      }

      if (endYear && endWeek) {
        var endWeek2 =
        self._$endWeek.value() < 10 ? "0" + self._$endWeek.value().toString() : self._$endWeek.value();

        getDate = self._getStartDate(endYear + "" + endWeek2);
        maxWeekNum = self._checkWeekNum(getDate);

        if (endWeek >= 53) {
          if (maxWeekNum !== endWeek) {
            self._$endWeek.value(52);
          }
        }
      }
      selectedPeriod();

      self._$okButton.prop("disabled", false);
      self._$okButton.removeClass("k-state-disabled");

      if (!startYear && !startWeek) {
        //첫번째 년 주 없을때
        self._$startInput.val("");
      } else if (!endYear && !endWeek) {
        //두번쨔 년 주 없을때
        self._$endInput.val("");
      } else if (!startYear || !startWeek) {
        //첫번째 년이 없거나 주 없을때
        self._$okButton.prop("disabled", true);
        self._$okButton.addClass("k-state-disabled");
      } else if (!endYear || !endWeek) {
        //두번째 년이 없거나 주 없을때
        self._$okButton.prop("disabled", true);
        self._$okButton.addClass("k-state-disabled");
      } else {
        // 위에것들이 아닐
        if (endYear) {
          //종료날짜가 존재하고,
          if (startYear > endYear) {
            //시작날짜의 년도가 종료날짜의 년도보다 클때
            self._$okButton.prop("disabled", true);
            self._$okButton.addClass("k-state-disabled");
          } else if (!(startYear.toString().length === 4) || !(endYear.toString().length === 4)) {
            self._$okButton.prop("disabled", true);
            self._$okButton.addClass("k-state-disabled");
          }
        }
        if (startYear === endYear && startWeek > endWeek) {
          //시작날짜와 종료날짜의 년도가 같고, 시작날짜 주가 종료날짜 주보다 클때
          self._$okButton.prop("disabled", true);
          self._$okButton.addClass("k-state-disabled");
        }
      }
    }

    self._$startInput.on("keyup", function (e) {
      var key = e.key,
        regex = /[0-9]/; // 입력된 키 값이 숫자인지 매칭
      var preStartDate, currStartDate;
      var startInput = self._$startInput;

      // 숫자 혹은 backspace, delete, ctrl+v 인지 확인
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && startInput.is(":enabled")) {
        e.returnValue = false;
        e.preventDefault();
      } else if (
      !regex.test(key) &&
      e.keyCode !== 8 &&
      e.keyCode !== 46 &&
      e.ctrlKey === false &&
      e.keyCode !== 91 &&
      e.ctrlKey === true &&
      e.keyCode !== 86 &&
      e.ctrlKey === false &&
      e.keyCode !== 17)
      {
        e.returnValue = false;
        e.preventDefault();
      } else {
        preStartDate = $(".dews-weekperiodpicker-startDate", self._$wrapper).attr("val");
        currStartDate = self._$startInput.val();

        // 모든 값이 입력 되면 값 설정
        if (self._$startInput.val() && self._$startInput.val().indexOf("_") === -1) {
          format(self._$startInput);
          if (!self._$endInput.val()) {
            self._$endYear.value("");
            self._$endWeek.value("");
          }

          $(".dews-weekperiodpicker-startDate", self._$wrapper).attr(
          "val",
          $(".dews-weekperiodpicker-startDate", self._$wrapper).val());


          if (preStartDate !== currStartDate) {
            self._$startInput.trigger("_change");
          }

          if (regex.test(key)) {
            self._$endInput.focus();
          }
        }

        if (self._$startInput.val().indexOf("_") === 0) {
          currStartDate = "";
          if (preStartDate === undefined) {
            preStartDate = "";
          }
          if (preStartDate !== currStartDate) {
            self._$startInput.trigger("_change");
          }
        }
      }

      // backspace, delete 키를 눌렀을 경우 input에 값이 없을때
      if (e.keyCode === 8 || e.keyCode === 46) {
        $(".dews-weekperiodpicker-startDate", self._$wrapper).attr("val", "");
        if (self._$startInput.val().indexOf("_") === 0) {
          self._$endYear.value("");
          self._$endWeek.value("");
        }
      }
      e.stopPropagation();
    });

    self._$endInput.on("keyup", function (e) {
      var key = e.key,
        regex = /[0-9]/;
      var preEndDate, currEndDate;
      var endInput = self._$endInput;

      // 숫자 혹은 backspace, delete, ctrl+v 인지 확인
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && endInput.is(":enabled")) {
        e.returnValue = false;
        e.preventDefault();
      } else if (
      !regex.test(key) &&
      e.keyCode !== 8 &&
      e.keyCode !== 46 &&
      e.ctrlKey === false &&
      e.keyCode !== 91 &&
      e.ctrlKey === true &&
      e.keyCode !== 86 &&
      e.ctrlKey === false &&
      e.keyCode !== 17)
      {
        e.returnValue = false;
        e.preventDefault();
      } else {
        preEndDate = $(".dews-weekperiodpicker-endDate", self._$wrapper).attr("val");
        currEndDate = self._$endInput.val();

        // 모든 값이 입력 되면 값 설정
        if (self._$endInput.val() && self._$endInput.val().indexOf("_") === -1) {
          format(self._$endInput);
          if (!self._$startInput.val()) {
            self._$startYear.value("");
            self._$startWeek.value("");
          }

          $(".dews-weekperiodpicker-endDate", self._$wrapper).attr(
          "val",
          $(".dews-weekperiodpicker-endDate", self._$wrapper).val());


          if (preEndDate !== currEndDate) {
            self._$endInput.trigger("_change");
          }
        }

        if (self._$endInput.val().indexOf("_") === 0) {
          currEndDate = "";
          if (preEndDate === undefined) {
            preEndDate = "";
          }
          if (preEndDate !== currEndDate) {
            self._$endInput.trigger("_change");
          }
        }
      }

      // backspace, delete 키를 눌렀을 경우 input에 값이 없을때
      if (e.keyCode === 8 || e.keyCode === 46) {
        if (self._$endInput.val().indexOf("_") === 0) {
          $(".dews-weekperiodpicker-endDate", self._$wrapper).attr("val", "");
          self._$startYear.value("");
          self._$startWeek.value("");
          self._$startInput.focus();
        }
      }
      e.stopPropagation();
    });

    // 시작 주나 종료 주 입력 중인 경우 이벤트 버블링을 막음
    $el.on("keydown", function (e) {
      if (e.keyCode === 13) {
        if (self._$startInput.is(":focus") || self._$endInput.is(":focus")) {
          e.stopPropagation();
        }
        if (
        self._$hiddenArea.css("display") === "block" &&
        self.getStartWeek() === "" &&
        self.getEndWeek() === "")
        {
          self.setStartWeek(new Date());
          self.setEndWeek(new Date());
          self._$okButton.click();
        }
      } else if (e.keyCode === 115 && self._$hiddenArea.css("display") === "none") {
        self._$calenderButton.click();
        e.stopPropagation();
        e.preventDefault();
      }
    });

    self._$startYear.bind("spin", changeHandler);
    self._$startWeek.bind("spin", changeHandler);
    self._$endYear.bind("spin", changeHandler);
    self._$endWeek.bind("spin", changeHandler);

    self._$startYear.bind("change", changeHandler);
    self._$startWeek.bind("change", changeHandler);
    self._$endYear.bind("change", changeHandler);
    self._$endWeek.bind("change", changeHandler);

    self._$startYear.element.on("keyup", changeHandler);
    self._$startWeek.element.on("keyup", changeHandler);
    self._$endYear.element.on("keyup", changeHandler);
    self._$endWeek.element.on("keyup", changeHandler);

    //input 박스의 값을 가져와서 숫자텍스트박스에 set하는 함수
    function _setNumerictextboxValue(startDate, endDate) {
      var startY = self.getWeek(startDate, "year") ? self.getWeek(startDate, "year").toString() : "";
      var startW =
      self.getWeek(startDate, "week").toString()[0] === "0" ?
      self.getWeek(startDate, "week").toString()[1] :
      self.getWeek(startDate, "week").toString();
      var endY = self.getWeek(endDate, "year") ? self.getWeek(endDate, "year").toString() : "";
      var endW =
      self.getWeek(endDate, "week").toString()[0] === "0" ?
      self.getWeek(endDate, "week").toString()[1] :
      self.getWeek(endDate, "week").toString();

      self._$startYear.value(startY);
      self._$startWeek.value(startW);
      self._$endYear.value(endY);
      self._$endWeek.value(endW);
    }

    //input 박스의 format 처리 관련 함수
    function format(input) {
      var dateValue = $(input).val(),
        formatedDate,
        yyyy = self.getWeek(dateValue, "year").toString(),
        WW = self.getWeek(dateValue, "week");

      // 잘못된 값 입력 시에 잘못된 값 초기화
      // var date = new Date();
      // var now = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));

      // if (parseInt(yyyy) > 9999 || parseInt(yyyy) <= 999) {
      //     yyyy = now.toISOString().substring(0, 4);
      // }

      // if (parseInt(WW) >= 53 || parseInt(WW) < 1) {
      //     WW = now.toISOString().substring(5, 7);
      // }

      formatedDate = self.dateStringToFormatedString(yyyy, WW);
      $(input).val(formatedDate);

      var startSet = self._$startInput.val(),
        endSet = self._$endInput.val();

      var startText = startSet ?
        self.getWeek(startSet, "year").toString() + self.getWeek(startSet, "week").toString() :
        "",
        endText = endSet ?
        self.getWeek(endSet, "year").toString() + self.getWeek(endSet, "week").toString() :
        "";

      if (startText > endText) {
        if (endText === "") {
          startSet = self.options.format.
          replace(/w{1,2}/gi, self.getWeek(self._$startInput, "week")).
          replace(/y{2,4}/gi, self.getWeek(self._$startInput, "year"));
          endSet = "";
        } else {
          startSet = self.options.format.
          replace(/w{1,2}/gi, self.getWeek(self._$startInput, "week")).
          replace(/y{2,4}/gi, self.getWeek(self._$startInput, "year"));
          endSet = self.options.format.
          replace(/w{1,2}/gi, self.getWeek(self._$startInput, "week")).
          replace(/y{2,4}/gi, self.getWeek(self._$startInput, "year"));
        }
      } else {
        if (startText === "") {
          startSet = "";
          endSet = self.options.format.
          replace(/w{1,2}/gi, self.getWeek(self._$endInput, "week")).
          replace(/y{2,4}/gi, self.getWeek(self._$endInput, "year"));
        } else {
          startSet = self.options.format.
          replace(/w{1,2}/gi, self.getWeek(self._$startInput, "week")).
          replace(/y{2,4}/gi, self.getWeek(self._$startInput, "year"));
          endSet = self.options.format.
          replace(/w{1,2}/gi, self.getWeek(self._$endInput, "week")).
          replace(/y{2,4}/gi, self.getWeek(self._$endInput, "year"));
        }
      }

      if (startText !== "" && endText !== "") {
        self._$startInput.val(startSet);
        self._$endInput.val(endSet);
      }

      if (!startText) {
        self._$startInput.val("");
      }

      if (!endText) {
        self._$endInput.val("").trigger("input");
      }

      if (input === self._$startInput) {
        _setNumerictextboxValue(startSet, endSet);
      } else {
        _setNumerictextboxValue(startSet, endSet);
      }
    }
  };

  WeekPeriodPicker.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["change"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "change") {
          self._$wrapper.trigger("_change");
        } else {
          self._$wrapper.trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  WeekPeriodPicker.prototype.on = function () {
    var self = this;

    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    }

    self._$wrapper.on.apply(self._$wrapper, arguments);
  };

  WeekPeriodPicker.prototype.off = function () {
    var self = this;

    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    }
    self._$wrapper.off.apply(self._$wrapper, arguments);
  };

  WeekPeriodPicker.prototype.validate = function () {
    var self = this;
    if (!self.getStartWeek() || !self.getEndWeek()) {
      return false;
    } else {
      return true;
    }
  };

  WeekPeriodPicker.prototype.bindFromPanel = function (data) {
    var self = this,
      $element = $(self._$element);
    var startDate, endDate;

    if (data) {
      startDate = $element.data("dews-bind-startdate") || "";
      endDate = $element.data("dews-bind-enddate") || "";

      self.setStartWeek("");
      self.setEndWeek("");

      if (startDate && data.hasOwnProperty(startDate)) {
        self.setStartWeek(data[startDate] || "");
      }
      if (endDate && data.hasOwnProperty(endDate)) {
        self.setEndWeek(data[endDate] || "");
      }
    }
  };

  WeekPeriodPicker.prototype.serializeForPanel = function () {
    var self = this,
      $element = $(this._$element);
    var startDate, endDate;
    var data = [];

    startDate = $element.data("dews-bind-startdate") || "";
    endDate = $element.data("dews-bind-enddate") || "";

    if (startDate) {
      data[startDate] = self.getStartWeek();
    }
    if (endDate) {
      data[endDate] = self.getEndWeek();
    }
    return data;
  };

  WeekPeriodPicker.prototype.applyPanelFocus = function (requiredCheck) {
    var self = this,
      $element = $(this._$element);
    var startInput = self._$startInput;
    var endInput = self._$endInput;

    startInput.on("keydown", function (e) {
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && startInput.is(":enabled")) {
        e.preventDefault();
      } else if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();

        var evt = new $.Event("beforeFocus");
        evt.control = self;

        $element.trigger(evt);
      } else if (e.keyCode === 9 || e.keyCode === 13 && startInput.is(":enabled")) {
        if (e.keyCode === 9) {
          //tab키 기본동작 막기
          e.preventDefault();
        }

        if (e.keyCode === 13 && requiredCheck && $element.hasClass("required")) {
          if (self.validate()) {
            var evt = new $.Event("nextFocus");
            evt.control = self;

            $element.trigger(evt);
          }
        } else if (e.keyCode === 9) {
          // tab키 누를 시 종료년월로 포커스 이동
          endInput.focus();
        } else {
          // 엔터키 누를 시 다음 컨트롤로 포커스 이동
          var evt = new $.Event("nextFocus");
          evt.control = self;

          $element.trigger(evt);
        }
      }
    });

    endInput.on("keydown", function (e) {
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && endInput.is(":enabled")) {
        e.preventDefault();
      } else if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();

        startInput.focus();
      } else if (e.keyCode === 9 || e.keyCode === 13 && endInput.is(":enabled")) {
        if (e.keyCode === 9) {
          //tab키 기본동작 막기
          e.preventDefault();
        }

        var evt = new $.Event("nextFocus");
        evt.control = self;

        $element.trigger(evt);
      }
    });
  };

  WeekPeriodPicker.prototype.canFocusable = function () {
    var self = this,
      $element = $(this._$element);
    var $start = self._$startInput;
    var $end = self._$endInput;

    if (!$element.hasClass("dews-state-readonly") && $start && $end) {
      return $start.is(":visible") && $start.is(":enabled");
    } else {
      return false;
    }
  };

  /**
   * 주기간피커 컨트롤 자동화 인쇄 관련 데이터 추출
   * @return {*} 값이 설정 된 경우 Object 반환, 없는 경우 undefined 반환
   * @private
   */
  WeekPeriodPicker.prototype._getPrintData = function () {
    var self = this,
      $el = $(self._$element),
      data;

    if (self.getStartWeekText() && self.getEndWeekText()) {
      data = {
        id: $el.attr("id"),
        text: self.getStartWeekText() + " ~ " + self.getEndWeekText()
      };
    }

    return data;
  };

  /**
   * 시용자 가이드를 위한 API 를 추가합니다.
   * @param $element 대상 jQuery 요소
   */
  WeekPeriodPicker.prototype.setUserGuideAPI = function () {
    var self = this,
      $element = $(this._$element);

    self._$startInput.on("focus", function () {
      if (dews.ui.page && dews.ui.page.hasUserGuide) {
        if ($.isFunction(dews.ui.page.focusGuideItem) && $element.attr("id")) {
          dews.ui.page.focusGuideItem("#" + $element.attr("id"));
        }
      }
    });

    self._$endInput.on("focus", function () {
      if (dews.ui.page && dews.ui.page.hasUserGuide) {
        if ($.isFunction(dews.ui.page.focusGuideItem) && $element.attr("id")) {
          dews.ui.page.focusGuideItem("#" + $element.attr("id"));
        }
      }
    });
  };

  /**
   * 주기간피커 컨트롤 display none 하여 숨기는 API
   */
  WeekPeriodPicker.prototype.hide = function () {
    var self = this;

    if (!(self._$wrapper.css("display") === "none")) {
      self._$wrapper.css("display", "none");
    }
  };

  /**
   * 주기간피커 컨트롤 display inline-block 하여 보이도록 하는 API
   */
  WeekPeriodPicker.prototype.show = function () {
    var self = this;

    if (self._$wrapper.css("display") === "none") {
      self._$wrapper.css("display", "inline-block");
    }
  };

  /**
   * 공통 이벤트를 설정합니다.
   * @param {jQuery} $el 대상 요소의 jQuery객체입니다.
   * @param {object} [options] 피커의 옵션입니다.
   */
  function setEvent($el, options) {
    $el.on("click", function () {
      var $this = $(this);
      if ($this.prop("readonly") === false && $this.prop("disabled") === false) {
        // 읽기 전용/비활성화 상태가 아니면 포커스가 오면 텍스트 전체를 선택하도록 한다.
        $this.select();
      }
    }).on("blur", function () {
      var $this = $(this);
      if ($this.prop("readonly") === false && $this.prop("disabled") === false) {
        if (!dews.date.validate($this.val(), options.format)) {

          //TODO: 값이 유효하지 않을 경우 오류 표시 및 툴팁 표시
        } else {
          //TODO: 값이 유효할 때 오류 표시가 있으면 제거
        }}
    });
  }

  /**
   * 주기간피커 숫자텍스트박스에 마스크를 적용합니다.
   * @param {jQuery} $el 적용할 대상 요소의 jQuery 객체
   * @param {string} format 적용 포맷
   */
  function setMask($el, format) {
    var maskJsUrl;
    var interval;

    // jquery.maskedinput.js 를 이용하여 마스크를 적용함
    // script 파일을 로드된 적이 없으면 동적으로 로드합니다.
    // 동시에 여러 컴포넌트 초기화 시 여러번 로드되지않도록 환경변수 두어서 1번만 로드하도록 수정
    maskJsUrl = dews.url.join(dews._environments.scriptBase || "/scripts/", "jquery.maskedinput.js");

    var applyMask = function applyMask() {
      $el.mask(format.replace(/[yw]/gi, "9"));
    };

    if (dews._environments.loadJqueryMaskedinput && $.mask) {
      applyMask();
    } else if (dews._environments.loadJqueryMaskedinput && !$.mask) {
      interval = setInterval(function () {
        if ($.mask) {
          applyMask();
          clearInterval(interval);
        }
      }, 100);
    } else {
      $.getScript(maskJsUrl, function () {
        applyMask();
      });
      dews._environments.loadJqueryMaskedinput = true;
    }
  }

  dews = $.extend(true, dews, {
    ui: {
      weekperiodpicker: function weekperiodpicker(selector, options) {
        var $el, weekperiodpicker;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var picker,
            $this = $(this);

          picker = $this.data("dews-control");

          if (!picker) {
            if (!$this.hasClass("dews-ui-weekperiodpicker")) {
              $this.addClass("dews-ui-weekperiodpicker");
            }

            if (!$this.hasClass("dews-form-control")) {
              $this.addClass("dews-form-control");
            }

            picker = new WeekPeriodPicker($this, options);

            $this.data("dews-control", picker);

            picker._initControl();

            if (!$this.parent(".dews-weekperiodpicker-wrapper").hasClass("dews-control-activate")) {
              $this.parent(".dews-weekperiodpicker-wrapper").addClass("dews-control-activate");
            }
          }

          weekperiodpicker = picker;
        });

        return weekperiodpicker;
      }
    }
  });

  dews.ui.addControlInitializer("weekperiodpicker", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }
    dews.ui.weekperiodpicker($("span.dews-ui-weekperiodpicker", $container));
  });
})(jQuery, window.dews, window.kendo);


/*
 * 년월일시분을 받아오는 일시 피커
 */
(function ($, dews, kendo) {
  var DatePickerBase = dews.ui.DatePickerBase;

  function getDefaultYearOptions() {
    return {
      start: "decade",
      depth: "decade",
      format: dews._environments.formats.yearFormat,
      valueFormat: dews._environments.formats.yearValueFormat
    };
  }

  var YearPicker = function YearPicker($ctrl, options) {
    var yearpicker;
    var opt = this.getOptions($ctrl, getDefaultYearOptions(), options);

    dews.ui.util.ConvertClassAndProperty($ctrl);
    $ctrl.kendoDatePicker(opt);

    yearpicker = $ctrl.data("kendoDatePicker");
    yearpicker.options.valueFormat = opt.valueFormat;

    this.initControl($ctrl, "yearpicker");
    this.setMask($ctrl, opt.format);
    this.setEvent($ctrl, opt);

    if (!$ctrl.hasClass("dews-ui-yearpicker")) {
      $ctrl.addClass("dews-ui-yearpicker");
    }

    if (!$ctrl.hasClass("dews-form-control")) {
      $ctrl.addClass("dews-form-control");
    }

    if (!$ctrl.hasClass("dews-control-activate")) {
      $ctrl.addClass("dews-control-activate");
    }

    DatePickerBase.call(this, yearpicker);
  };

  YearPicker.prototype = Object.create(DatePickerBase.prototype);
  YearPicker.prototype.constructor = YearPicker;

  $.extend(true, dews, {
    ui: {
      /**
       * 연도를 받아오는 연도 피커를 생성하거나 가져옵니다.
       * @param {string|jQuery} selector 연도 피커로 만들 요소를 지정하는 셀렉터 또는 jQuery객체입니다.
       * @param  {object} options 연도 피커의 피커 옵샨값입니다.
       * @returns {*}
       */
      yearpicker: function yearpicker(selector, options) {
        var $el,
          yearpicker = null;

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var picker,
            $ctrl = $(this);

          picker = $ctrl.data("dews-control");

          if (!picker) {
            picker = new YearPicker($ctrl, options);

            $ctrl.data("dews-control", picker);
          }

          yearpicker = picker;
        });

        return yearpicker;
      }
    }
  });

  dews.ui.addControlInitializer("yearpicker", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.yearpicker($('input[type="text"].dews-ui-yearpicker', $container));
  });
})(jQuery, window.dews, window.kendo);


/**
 * 우편번호 다이얼로그
 * 버전 별 우편번호 다이얼로그 관리
 *
 * **BaseZipCodeDialog : 우편번호다이얼로그 베이스 클래스**
 *   - KakaoZipCodeDialog : 카카오 버전 클래스
 *   - NHCZipCodeDialog : NHC 버전 클래스
 */
(function ($, dews) {
  $.extend(true, dews, {
    ui: {
      zipcodedialog: function zipcodedialog() {
        var dialog;
        var envZipcodepicker = dews._environments.zipcodePicker;

        if (envZipcodepicker && envZipcodepicker.type === "nhc") {
          dialog = new NHCZipCodeDialog();
        } else if (envZipcodepicker && envZipcodepicker.type === "local") {
          dialog = new LocalCodeDialog();
        } else {
          dialog = new KakaoZipCodeDialog();
        }

        return dialog;
      }
    }
  });

  var BaseZipCodeDialog = function BaseZipCodeDialog() {
    var self = this;

    self._render();
  };

  BaseZipCodeDialog.prototype._render = function () {
    // 다이얼로그 생성 및 위치 선정
    var self = this,
      $postCodeWrapper,
      $postCodeTitle,
      $postCodeContent,
      $closeButton;

    // 우편번호 다이얼로그 생성
    $postCodeWrapper = $("<div />").attr("id", "zipcodepicker-dialog").addClass("postcode-wrapper");
    $postCodeTitle = $(
    "<div><span>" +
    dews.localize.get("우편번호 서비스", "dews_우편번호 검색") +
    '</span><span class="close-btn"></span></div>').
    addClass("postcode-title");
    $postCodeContent = $("<div />").addClass("postcode-content");
    $closeButton = $postCodeTitle.find(".close-btn");

    $postCodeWrapper.append($postCodeTitle);
    $postCodeWrapper.append($postCodeContent);

    self._$postCodeWrapper = $postCodeWrapper;
    self._$postCodeContent = $postCodeContent;
    self._$closeButton = $closeButton;
  };

  BaseZipCodeDialog.prototype._setPosition = function () {
    var self = this,
      $wrapper = self._$postCodeWrapper,
      windowWidth,
      windowHeight,
      dialogWidth,
      dialogHeight;

    windowWidth = window.innerWidth || document.documentElement.clientWidth;
    windowHeight = window.innerHeight || document.documentElement.clientHeight;
    dialogWidth = parseInt($wrapper.css("width"));
    dialogHeight = parseInt($wrapper.css("height"));

    $wrapper.css({
      left: Math.ceil((windowWidth - dialogWidth) / 2),
      top: Math.ceil((windowHeight - dialogHeight) / 2)
    });
  };

  BaseZipCodeDialog.prototype.open = function () {
    var self = this;

    // 이미 우편번호 설정 다이얼로그가 열려있으면 처리하지 않음
    if ($("#zipcodepicker-dialog").length > 0) {
      return;
    }

    $("body").append(self._$postCodeWrapper);

    var zIndex = dews.ui.getDialogMaxZIndex();

    if (zIndex > parseInt(self._$postCodeWrapper.css("zIndex"), 10)) {
      self._$postCodeWrapper.css("zIndex", zIndex + 2);
    }

    // 닫기 버튼 핸들링
    if (self._$closeButton) {var








      keyEvent = function keyEvent(e) {
        if (e.keyCode === 27) {
          self._$closeButton.click();
        }
        e.stopPropagation();
      };self._$closeButton.on("click", function () {self.close();self._$postCodeWrapper.css("zIndex", "");$(window).off("keydown", keyEvent);});$(window).on("keydown", keyEvent);
    }

    self._setPosition();
  };

  BaseZipCodeDialog.prototype.close = function () {
    var self = this;

    self._$postCodeWrapper.detach();
  };

  var KakaoZipCodeDialog = function KakaoZipCodeDialog() {
    var self = this;

    BaseZipCodeDialog.call(self);
  };

  KakaoZipCodeDialog.prototype = Object.create(BaseZipCodeDialog.prototype);
  KakaoZipCodeDialog.constructor = KakaoZipCodeDialog;

  KakaoZipCodeDialog.prototype.open = function (callback) {
    var self = this;

    BaseZipCodeDialog.prototype.open.call(self);

    self.callback = callback;

    self._openDaumPostCodeDialog();
  };

  KakaoZipCodeDialog.prototype._openDaumPostCodeDialog = function () {
    var self = this,
      fullAddress,
      extraAddress;

    new daum.Postcode({
      oncomplete: function oncomplete(data) {
        // 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분.
        // 각 주소의 노출 규칙에 따라 주소를 조합한다.
        // 내려오는 변수가 값이 없는 경우엔 공백('')값을 가지므로, 이를 참고하여 분기 한다.
        fullAddress = data.address; // 최종 주소 변수
        extraAddress = ""; // 조합형 주소 변수

        // 기본 주소가 도로명 타입일때 조합한다.
        if (data.addressType === "R") {
          //법정동명이 있을 경우 추가한다.
          if (data.bname !== "") {
            extraAddress += data.bname;
          }
          // 건물명이 있을 경우 추가한다.
          if (data.buildingName !== "") {
            extraAddress += extraAddress !== "" ? ", " + data.buildingName : data.buildingName;
          }
          // 조합형주소의 유무에 따라 양쪽에 괄호를 추가하여 최종 주소를 만든다.
          fullAddress += extraAddress !== "" ? " (" + extraAddress + ")" : "";

          data.street = fullAddress;
        }

        if ($.type(self.callback) === "function") {
          self.callback.call(self, data);
        }

        // 창 닫기
        self.close();
      },
      width: "100%",
      height: "100%",
      maxSuggestItems: 5
    }).embed(self._$postCodeContent[0]);
  };

  var NHCZipCodeDialog = function NHCZipCodeDialog(element, options) {
    var self = this;

    BaseZipCodeDialog.call(self, element, options);
  };

  NHCZipCodeDialog.prototype = Object.create(BaseZipCodeDialog.prototype);
  NHCZipCodeDialog.constructor = NHCZipCodeDialog;

  NHCZipCodeDialog.prototype.open = function (callback) {
    var self = this,
      $contentWrap,
      $searchInput;

    BaseZipCodeDialog.prototype.open.call(self);

    if (self._$postCodeContent.find(".nhc-juso-wrapper").length === 0) {
      $contentWrap = $(
      '<div class="nhc-juso-wrapper">' +
      '<div class="search_box_form">' +
      '<a class="btn_search" href="#"></a>' +
      "</div>" +
      '<div class="juso_content">' +
      '<div class="search_box">' +
      "<div>" +
      "<p>- 도로명, 지번, 건물명으로 통합검색이 가능합니다.</p>\n" +
      "<p>&nbsp;&nbsp;예) 국제금융로8길, 여의도동, NH농협캐피탈빌딩</p>\n" +
      '<p><b>※ 도로명, 지번 구분이 없는 경우, <span style="color:red">도로명 주소</span> 우선 적용</b></p>\n' +
      "</div>" +
      "</div>" +
      "</div>" +
      '<div class="page_num">' +
      '<button class="prev_page"></button>' +
      '<span class="current">1</span>' +
      '<span class="end"> </span>' +
      '<button class="next_page"></button>' +
      "</div>");

      $searchInput = $('<input type="textbox" placeholder="예) 국제금융로8길, NH농협캐피탈빌딩">').addClass(
      "dews-ui-textbox address_input");


      self._$postCodeContent.append($contentWrap);
      $contentWrap.find(".search_box_form").prepend($searchInput);

      self.textbox = dews.ui.textbox($searchInput);
      self._$searchButton = $contentWrap.find(".btn_search");
      self._$searchInput = $searchInput;

      self._$prevPage = self._$postCodeContent.find(".prev_page");
      self._$nextPage = self._$postCodeContent.find(".next_page");

      self._$searchInput.focus();

      self._bindEvent();
    }

    self.callback = callback;
  };

  NHCZipCodeDialog.prototype.close = function () {
    var self = this;

    self._$postCodeContent.find(".nhc-juso-wrapper").detach();
    self._$postCodeContent.find(".page_num").detach();

    BaseZipCodeDialog.prototype.close.call(self);
  };

  NHCZipCodeDialog.prototype._bindEvent = function () {
    var self = this;

    self._$searchInput.on("keydown", function (e) {
      if (e.keyCode === 13) {
        self.searchZipcode();
      }
    });

    self._$searchButton.on("click", function (e) {
      self.searchZipcode();
    });

    self._$prevPage.on("click", function (e) {
      self._prevPage();
    });

    self._$nextPage.on("click", function (e) {
      self._nextPage();
    });
  };

  NHCZipCodeDialog.prototype._prevPage = function () {
    var self = this,
      currentPage;

    currentPage = parseInt(self._$postCodeContent.find("span.current").text());

    if (currentPage > 1) {
      self.getAddressList(self.textbox.text(), currentPage - 1);
      self._$postCodeContent.find(".current").text(currentPage - 1);
      self._$postCodeContent.find(".juso_content").scrollTop(0);
    }
  };
  NHCZipCodeDialog.prototype._nextPage = function () {
    var self = this,
      currentPage,
      endPage;

    currentPage = parseInt(self._$postCodeContent.find("span.current").text());
    endPage = parseInt(self._$postCodeContent.find("span.end").text());

    if (currentPage < endPage) {
      self.getAddressList(self.textbox.text(), currentPage + 1);
      self._$postCodeContent.find(".current").text(currentPage + 1);
      self._$postCodeContent.find(".juso_content").scrollTop(0);
    }
  };

  NHCZipCodeDialog.prototype.searchZipcode = function () {
    var self = this,
      searchKeyword;

    searchKeyword = self.textbox.text();

    if (searchKeyword) {
      self.getAddressList(searchKeyword, 1);
    } else {
      alert(dews.localize.get("검색어를 입력해주세요.", "dews_검색어를 입력해주세요."));
      return false;
    }
  };

  NHCZipCodeDialog.prototype.getAddressList = function (keyword, pageNum) {
    var self = this;

    // ajax 호출
    dews.api.
    get(dews.url.getApiUrl("CM", "PostService", "zipcode"), {
      async: false,
      data: {
        indexWord: keyword,
        pageNum: pageNum
      }
    }).
    done(function (data) {
      var addressList = data;

      if (addressList && addressList.juso) {
        var juso = addressList.juso;
        var html = "<table class='load_table'><tbody>";

        for (var i = 0; i < juso.length; i++) {
          html += i !== juso.length - 1 ? "<tr>" : "<tr class='end'>";
          html += "<td><ul>";
          html += "<p class='code'><span class='zipcode'>" + juso[i].sectionNum + "</span></p>";
          html +=
          "<a class='roadaddr' data-addr-type= 'R' data-section-num='" +
          juso[i].sectionNum +
          "' data-street-addr='" +
          juso[i].roadAddr1 +
          juso[i].roadAddr2 +
          "' data-jibun-addr='" +
          juso[i].jibunAddr +
          "'><dl><dt class='tit_address'>도로명</dt>";
          html +=
          "<dd><span class='roadAddr1'>" +
          juso[i].roadAddr1 +
          juso[i].roadAddr2 +
          "</span></dd></dl></a>";
          html +=
          "<a class='jibunaddr' data-addr-type= 'J'  data-section-num='" +
          juso[i].sectionNum +
          "' data-street-addr='" +
          juso[i].roadAddr1 +
          juso[i].roadAddr2 +
          "' data-jibun-addr='" +
          juso[i].jibunAddr +
          "'\"><dl><dt class='tit_address'>지번</dt><dd><span class=''>";
          html += juso[i].jibunAddr + "</span></dd></dl></a>";

          if (juso[i].relatedJibun) {
            for (var j = 0; j < juso[i].relatedJibun.length; j++) {
              html +=
              "<a class='related search_sub' data-addr-type= 'J' data-section-num='" +
              juso[i].sectionNum +
              "' data-street-addr='" +
              juso[i].roadAddr1 +
              juso[i].roadAddr2 +
              "' data-jibun-addr='" +
              juso[i].relatedJibun[j] +
              "'>";
              html +=
              j > 0 ?
              "<span class='link_fold hidden'>관련지번</span>" :
              "<span class='link_fold'>관련지번</span>";
              html += "<span class=''>" + juso[i].relatedJibun[j] + "</span></a>";
            }
          }
        }

        html += "</ul></td></tr>";
        html += "</tbody></table>";

        if (self._$postCodeContent.find(".content_juso").length === 0) {
          self._$postCodeContent.
          find(".juso_content").
          append($('<div class="content_juso table"></div>'));
        }

        self._$postCodeContent.find(".page_num").addClass("on");
        self._$postCodeContent.find(".page_num>.current").text(pageNum);
        self._$postCodeContent.find(".page_num>.end").text(addressList.totalPage);

        self._$postCodeContent.find(".content_juso").html(html);
        self._$postCodeContent.find(".search_none").detach();

        // 주소 클릭 시
        self._$postCodeContent.find(".roadaddr, .jibunaddr").on("click", function (e) {
          var $target,
            data = {};

          $target = $(e.currentTarget);
          data.roadAddress = $target.data("street-addr");
          data.jibunAddress = $target.data("jibun-addr");
          data.addressType = $target.data("addr-type");
          data.zonecode = $target.data("section-num");

          if ($.type(self.callback) === "function") {
            self.callback.call(self, data);
          }

          self.close();
        });
      } else {
        if (self._$postCodeContent.find(".search_none").length === 0) {
          self._$postCodeContent.
          find(".juso_content").
          append(
          '<span class="search_none">검색결과가 없습니다. <br/> 검색어에 잘못된 철자가 없는지, 정확한 주소인지 다시 한번 확인해 주세요.</span>');

        }

        self._$postCodeContent.find(".content_juso").detach();
        self._$postCodeContent.find(".page_num").removeClass("on");
      }
    }).
    fail(function (e, xhr) {
      console.log(e);
    });
  };

  var LocalCodeDialog = function LocalCodeDialog(element, options) {
    var self = this;

    BaseZipCodeDialog.call(self, element, options);
  };

  LocalCodeDialog.prototype = Object.create(BaseZipCodeDialog.prototype);
  LocalCodeDialog.constructor = LocalCodeDialog;

  LocalCodeDialog.prototype.open = function (callback) {
    var self = this,
      dialog,
      $contentWrap,
      $cityDropdownlist,
      $guDropdownlist,
      $searchInput;

    dialog = dews.ui.dialog("zipcodedialog", {
      content: "",
      title: dews.localize.get("우편번호 검색", "dews_우편번호 검색"),
      width: 560,
      height: 548,
      buttons: "none"
    });
    dialog.open();
    dialog.dialog.wrapper.addClass("postcode-wrapper local");

    dialog.on("closed", function () {
      delete self.pager;
    });

    self._dialog = dialog;
    self._$postCodeContent = dialog.$content;

    if (self._$postCodeContent.find(".local-juso-wrapper").length === 0) {
      $contentWrap = $(
      '<div class="local-juso-wrapper">' +
      '<div class="search_box_form">' +
      '<button class="dews-ui-button btn_search dews-control-activate">' +
      dews.localize.get("검색", "dews_검색") +
      "</button>" +
      "<p>" +
      dews.localize.get(
      "시, 도를 선택하고 지번 및 도로명을 입력 후 검색을 눌러주세요.",
      "dews_시, 도를 선택하고 지번 및 도로명을 입력 후 검색을 눌러주세요.") +

      "</p>" +
      "</div>" +
      '<div class="juso_content">' +
      '<div class="search_box">' +
      "<p>" +
      dews.localize.get("검색결과 ", "dews_검색결과") +
      "&nbsp<span></span>&nbsp" +
      dews.localize.get("건", "dews_건") +
      "</p>" +
      "<div>" +
      '<span class="search_img"></span>\n' +
      "<p>" +
      dews.localize.get("검색어를 입력해주세요.", "dews_검색어를 입력해주세요.") +
      "</p>\n" +
      '<span class="search_content">' +
      dews.localize.get(
      "시/도와 시군구 선택 후 검색어를 입력하셔야 \n 검색이 가능합니다.",
      "dews_시/도와 시군구 선택 후 검색어를 입력하셔야 검색이 가능합니다.") +

      "</span>" +
      "</div>" +
      "</div>" +
      '<div class="content_juso">' +
      '<table class="load_table"></table>' +
      "</div>" +
      "</div>" +
      '<div class="page_num">' +
      '<div id="pager"></div>' +
      "</div>");

      $cityDropdownlist = $(
      '<select id="city_ddl"  data-dews-data-url="~/api/CM/DzPostService/v2/listSiDo" data-dews-value-field="code" data-dews-text-field="value"></select>').
      addClass("dews-ui-dropdownlist city_ddl");
      $guDropdownlist = $(
      '<select id="gu_ddl" data-dews-data-url="~/api/CM/DzPostService/vㄱ2/listSggNm" data-dews-value-field="code" data-dews-text-field="value"></select>').
      addClass("dews-ui-dropdownlist gu_ddl");
      $searchInput = $('<input type="textbox" placeholder="예) 판교역로 235, 분당주공, 삼평동 681">').addClass(
      "dews-ui-textbox address_input");


      $contentWrap.find(".search_box_form").prepend($cityDropdownlist);
      $cityDropdownlist.after($guDropdownlist);
      $guDropdownlist.after($searchInput);

      self.cityDdl = dews.ui.dropdownlist($cityDropdownlist);
      self.guDdl = dews.ui.dropdownlist($guDropdownlist);
      self.textbox = dews.ui.textbox($searchInput);
      self._$searchButton = $contentWrap.find(".btn_search");
      self._$searchInput = $searchInput;

      self._bindEvent();

      // self._$postCodeContent.append($contentWrap);
      $(".dews-dialog-contents", self._$postCodeContent).append($contentWrap);
      self.cityDdl.focus();
    }

    self.callback = callback;
  };

  LocalCodeDialog.prototype.close = function () {
    var self = this;

    self._dialog.close();
    delete self.pager;
  };

  LocalCodeDialog.prototype._bindEvent = function () {
    var self = this;

    self._$searchInput.on("keydown", function (e) {
      if (e.keyCode === 13) {
        self._searchZipcode();
      }
    });

    self._$searchButton.on("click", function (e) {
      self._searchZipcode();
    });

    self.cityDdl.on("dataBound", function (e) {
      dews.api.
      get(dews.url.getApiUrl("CM", "DzPostService/v2", "listSggNm"), {
        data: {
          siNm: e.sender.text()
        }
      }).
      done(function (data) {
        self.guDdl.setDataSource(data);
      });
    });

    // PD1C-1323 세종특별자치시 선택 후, 데이터 조회 안되는 현상 수정
    // 시군구 데이터가 없을 경우, 시군구 드랍다운리스트 disable 적용
    // 시군구 데이터 없어도, 키워드 검색 가능하도록 적용
    self.cityDdl.on("change", function (e) {
      dews.api.
      get(dews.url.getApiUrl("CM", "DzPostService/v2", "listSggNm"), {
        data: {
          siNm: e.sender.text()
        }
      }).
      done(function (data) {
        if (data) {
          self.guDdl.setDataSource(data);
          self.guDdl.select(0);
          if (data.length == 2 && data[1].value == null) {
            self.guDdl.enable(false);
            self._nodata = true;
            return;
          }
          self._nodata = false;
          self.guDdl.enable(true);
        }
      });
    });
  };

  LocalCodeDialog.prototype._clickPage = function () {
    var self = this;

    self.pager.on("change", function (e) {
      self._getAddressList(e.page);
    });
  };

  LocalCodeDialog.prototype._searchZipcode = function () {
    var self = this,
      searchKeyword = self.textbox.text().trim();

    if (self.cityDdl.select() === 0) {
      dews.alert(dews.localize.get("시/도를 선택하세요.", "dews_시/도를 선택하세요."));
      return false;
    } else if (self.guDdl.select() === 0 && !self._nodata) {
      dews.alert(dews.localize.get("시군구를 선택하세요.", "dews_시군구를 선택하세요."));
      return false;
    }

    if (searchKeyword) {
      self._getAddressList(1, true);
    } else {
      dews.alert(dews.localize.get("검색어를 입력해주세요.", "dews_검색어를 입력해주세요."));
      return false;
    }
  };

  LocalCodeDialog.prototype._getAddressList = function (pageNum, state) {
    var self = this;

    // ajax 호출
    dews.api.
    get(dews.url.getApiUrl("CM", "DzPostService/v2", "listAddr"), {
      async: false,
      data: {
        siNm: self.cityDdl.text(),
        sggNm: !self._nodata ? self.guDdl.text() : null,
        keyword: self.textbox.text(),
        count: 5,
        page: pageNum
      }
    }).
    done(function (data) {
      var addressList = data;

      self._$postCodeContent.find(".search_box").addClass("result");
      self._$postCodeContent.find(".juso_content>.content_juso").addClass("table");

      if (addressList && addressList.list.length > 0) {
        var list = addressList.list;
        var html =
        "<thead><tr><th>" +
        dews.localize.get("우편번호", "dews_우편번호") +
        "</th><th>" +
        dews.localize.get("주소", "dews_주소") +
        "</th></tr></thead>" +
        "<tbody>";

        for (var i = 0; i < list.length; i++) {
          html += i !== list.length - 1 ? "<tr>" : "<tr class='end'>";
          html += "<td><ul>";
          html += "<p class='code'><span class='zipcode'>" + list[i].post_no + "</span></p></ul></td>";
          html +=
          "<td><ul><a class='roadaddr' data-dews-addr-type= 'R' data-dews-zipcode='" +
          list[i].post_no +
          "' data-dews-street-addr='" +
          list[i].road_addr +
          "' data-dews-jibun-addr='" +
          list[i].lot_addr +
          "'><dl><dt class='tit_address roadaddr'>도로명</dt>";
          html += "<dd><span class='roadAddr'>" + list[i].road_addr + "</span></dd></dl></a>";
          html +=
          "<a class='jibunaddr' data-dews-addr-type= 'J'  data-dews-zipcode='" +
          list[i].post_no +
          "' data-dews-street-addr='" +
          list[i].road_addr +
          "' data-dews-jibun-addr='" +
          list[i].lot_addr +
          "'\"><dl><dt class='tit_address jibunaddr'>지번</dt><dd><span class='jibunAddr'>";
          html += list[i].lot_addr + "</span></dd></dl></a>";
        }

        html += "</ul></td></tr></tbody>";

        self._$postCodeContent.find(".content_juso>.load_table").html(html);
        self._$postCodeContent.find(".juso_content>.search_box").removeClass("search_none");
        self._$postCodeContent.find(".juso_content>.content_juso").addClass("table");
        self._$postCodeContent.find(".search_box>p>span").html(addressList.total);
        self._$postCodeContent.find(".page_num").css("display", "inline-block");

        if (pageNum === 1 && state) {
          var pagerOptions = {
            total: Math.ceil(parseInt(addressList.total) / 5),
            buttonCount:
            parseInt(addressList.total) / 5 > 10 ? 10 : Math.ceil(parseInt(addressList.total) / 5)
          };
          if (!self.pager) {
            self.pager = dews.ui.simplepager($("#pager", self._$postCodeContent), pagerOptions);
            self._clickPage();
          } else {
            self.pager.setOptions(pagerOptions);
            self.pager.setPage(1);
          }
        }

        if (list.length > 5) {
          self._$postCodeContent.find(".juso_content>.content_juso").removeClass("border_none");
        } else {
          self._$postCodeContent.find(".juso_content>.content_juso").addClass("border_none");
        }

        // 주소 클릭 시
        self._$postCodeContent.find(".roadAddr, .jibunAddr").on("click", function (e) {
          var $target,
            data = {};
          $target = $(e.currentTarget).closest("a");

          data.roadAddress = $target.data("dews-street-addr");
          data.jibunAddress = $target.data("dews-jibun-addr");
          data.addressType = $target.data("dews-addr-type");
          data.zonecode = $target.data("dews-zipcode");

          self.close();

          if ($.type(self.callback) === "function") {
            self.callback.call(self, data);
          }
        });

        // 마우스 오버 시
        self._$postCodeContent.find(".roadAddr, .jibunAddr").hover(
        function (e) {
          var $target = $(e.currentTarget).closest("a");
          $target.closest("td").siblings("td").find("span.zipcode").addClass("hover");
          $target.closest("tr").addClass("selected");
        },
        function (e) {
          var $target = $(e.currentTarget);
          $target.closest("td").siblings("td").find("span.zipcode").removeClass("hover");
          $target.closest("tr").removeClass("selected");
        });

      } else {
        self._$postCodeContent.find(".juso_content>.search_box").addClass("search_none");
        self._$postCodeContent.find(".juso_content>.content_juso").removeClass("border_none");
        self._$postCodeContent.
        find(".juso_content>.search_box>div>p").
        html(
        dews.localize.get("검색결과가 없습니다.", "dews_검색결과가 없습니다.") +
        "<br/>" +
        dews.localize.get(
        "검색어를 다시 한번 확인해 주세요.",
        "dews_검색어를 다시 한번 확인해 주세요."));


        self._$postCodeContent.find(".search_box>p>span").html(0);
        self._$postCodeContent.find(".load_table>thead,tbody").detach();
        self._$postCodeContent.find(".page_num").css("display", "none");
      }
    }).
    fail(function (e, xhr) {
      console.log(e);
    });
  };
})(jQuery, window.dews);


/**
 * 우편번호 피커
 * 기존 우편번호 피커를 기반으로 새로 작성되었습니다.
 *
 * **ZipCodePicker : 우편번호피커 메인 클래스**
 *   _ZipCodeDialog : 우편번호피커 우편번호 선택 다이얼로그 클래스
 *       open()  : 다이얼로그를 여는 메소드
 *       close() : 다이얼로그를 닫는 메소드
 *   _ZipCodePickerButtonGroup : 우편번호피커 내의 버튼 그룹 클래스
 *       showButton() : 버튼들을 보여주는 메소드
 *       hideButton() : 버튼들을 감추는 메소드
 */
(function ($, dews) {
  // 기본 옵션
  var defaultOptions = {
    addressType: "street"
  };

  var ZipCodePicker = function ZipCodePicker(element, options) {
    var self = this;

    self.options = $.extend(true, {}, defaultOptions, options);
    self._$element = $(element);
    if (dews.ui.dialogPage) {
      self._$addressElement = $("#" + self.options.addressBind, dews.ui.dialogPage.$content);
    } else if (dews.ui.page) {
      self._$addressElement = $("#" + self.options.addressBind, dews.ui.page.$content);
    } else {
      self._$addressElement = $("#" + self.options.addressBind, $(document));
    }
    self._render();
    self._setEventHandling();
    setUserGuideAPI(self._$element);

    self._activate();
  };

  /**
   * 우편번호피커를 그리는 메소드
   *
   * @private
   */
  ZipCodePicker.prototype._render = function () {
    var self = this,
      $element = self._$element;

    // 우편번호 입력 상자 생성
    self.inputDialog = dews.ui.zipcodedialog();

    // 컨테이너 생성
    self._$wrapper = self._createContainer();

    // 버튼 그룹 생성
    self.innerButtonGroup = new ZipCodePicker._ZipCodePickerButtonGroup(
    $element,
    function () {
      self.open();
    },
    function () {
      self.clearData();
    });

    // kendo-ui 스타일 오버라이드 클래스
    $element.addClass("k-style-override");

    // 기본 상태 설정
    self._setState();
  };
  /**
   * ZipCodePicker의 옵션을 바꾸는 메소드
   * @param options 새로운 옵션
   * @private
   */
  ZipCodePicker.prototype._changeOption = function (options) {
    var self = this;

    // 옵션을 재정의한다
    $.extend(self.options, options);

    if (dews.ui.dialogPage) {
      self._$addressElement = $("#" + self.options.addressBind, dews.ui.dialogPage.$content);
    } else if (dews.ui.page) {
      self._$addressElement = $("#" + self.options.addressBind, dews.ui.page.$content);
    } else {
      self._$addressElement = $("#" + self.options.addressBind, $(document));
    }

    // 우편번호 입력 상자 재생성
    self.inputDialog = dews.ui.zipcodedialog();
  };

  /**
   * 우편번호피커의 이벤트들을 핸들링하는 메소드
   * @return {jQuery} 우편번호피커를 감싸고 있는 JQuery 객체
   * @private
   */
  ZipCodePicker.prototype._setEventHandling = function () {
    var self = this,
      setData,
      $element = self._$element;

    // setData 이벤트 핸들링
    setData = self.options.setData;
    if (setData && $.isFunction(setData)) {
      self.on("setData", setData);
    }

    // 더블클릭 이벤트 핸들링
    $element.on("dblclick", function (e) {
      if (!$element.hasClass("readonly")) {
        self.open();
      }
    });

    // 단축키 이벤트 핸들링
    $element.on("keydown", function (e) {
      if (!$element.hasClass("readonly")) {
        if ($element.is(":enabled") && e.keyCode === 115) {
          self.open();
          e.stopPropagation();
          e.preventDefault();
        }
      }
    });

    // 값 변경 시 글자 수에 따라 버튼을 변경
    $element.on("change", function (e) {
      self.innerButtonGroup.showButton();
    });

    $element.on("focusin", function (e) {
      $element.parent().addClass("dews-state-focused");
    });

    $element.on("focusout", function (e) {
      $element.parent().removeClass("dews-state-focused");
    });
  };
  /**
   * 우편번호피커의 기본 상태를 설정하는 메소드
   * @private
   */
  ZipCodePicker.prototype._setState = function () {
    var self = this,
      $el = self._$element,
      $wrapper = self._$wrapper;

    if ($el.hasClass("disabled")) {
      self.disable(true);
    }

    if ($el.hasClass("required")) {
      $wrapper.addClass("dews-state-required");
    }

    if ($el.hasClass("readonly")) {
      $wrapper.addClass("dews-state-readonly");
      self.innerButtonGroup._$searchButton.prop("disabled", true);
    }
  };
  /**
   * 우편번호피커를 감싸는 컨테이너를 만드는 메소드
   * @private
   */
  ZipCodePicker.prototype._createContainer = function () {
    var self = this,
      $el = self._$element,
      $wrapper = $("<span />").addClass("dews-zipcodepicker-wrapper dews-control k-textbox");

    if ($el.attr("style")) {
      var matches;

      matches = $el.attr("style").match(/width:([^;]+);?/i);
      if (matches && matches.length > 0) {
        $wrapper.css("width", $.trim(matches[1]));
        $el.css("width", "100%");
      }
    }

    // 클래스와 프로퍼티 일치 작업
    if ($el.prop("disabled") && !$el.hasClass("disabled")) {
      $el.addClass("disabled");
    } else if ($el.hasClass("disabled") && !$el.prop("disabled")) {
      $el.prop("disabled", true);
    }

    if ($el.prop("readonly") && !$el.hasClass("readonly")) {
      $el.addClass("readonly");
    } else if ($el.hasClass("readonly") && !$el.prop("readonly")) {
      $el.prop("readonly", true);
    }

    if ($el.attr("id")) {
      $wrapper.attr("id", $el.attr("id") + "-wrapper");
    }

    $el.wrap($wrapper);

    if (!$el.hasClass("dews-ui-zipcodepicker")) {
      $el.addClass("dews-ui-zipcodepicker");
    }

    if (!$el.attr("name") && $el.attr("id")) {
      // 코드피커 요소에 id는 지정되어 있는데 name이 지정되어 있지 않으면 name을 id와 동일하게 설정한다.
      $el.attr("name", $el.attr("id"));
    }

    $el.prop("readonly", true);

    return $el.parent(".dews-zipcodepicker-wrapper");
  };

  /**
   * @deprecated 이전 버전 호환성 코드입니다.
   * 우편번호 입력 다이얼로그를 여는 메소드
   * @private
   */
  ZipCodePicker.prototype._triggerZipCodeDialog = function () {
    var self = this;
    self.open();
  };
  /**
   * @deprecated 이전 버전 호환성 코드입니다.
   * 버튼을 새로 생성하는 메소드
   * @private
   */
  ZipCodePicker.prototype._createButton = function () {};
  /**
   * @deprecated 이전 버전 호환성 코드입니다.
   * 버튼을 제거하는 메소드
   * @private
   */
  ZipCodePicker.prototype._removeButton = function () {};
  /**
   * 우편번호피커의 값을 설정하거나 가져옵니다.
   * @param {string} value 설정할 우편번호 피커 값 (생략하면 현재 우편번호피커의 값을 반환합니다.)
   * @returns {string} 현재 우편번호피커 값
   */
  ZipCodePicker.prototype.value = function (value) {
    var self = this,
      $element = self._$element;

    if (value) {
      $element.val(value);
      $element.trigger("change");
    } else if (value === "") {
      $element.val("");

      if (self.options.addressBind) {
        if ($element.attr("data-dews-address-bind") === $("input#" + self.options.addressBind).attr("id")) {
          self._$addressElement.val("");
        }
      }

      self.innerButtonGroup._showSearchButton();
    }

    return $element.val();
  };

  /**
   * 우편번호피커의 값을 비웁니다.
   */
  ZipCodePicker.prototype.clearData = function () {
    var self = this,
      $element = self._$element;

    // 우편번호피커 값 비움
    $element.val("");

    if (self.options.addressBind) {
      if ($element.attr("data-dews-address-bind") === $("input#" + self.options.addressBind).attr("id")) {
        self._$addressElement.val("");
      }
    }

    // change 이벤트
    $element.trigger("change");
    $element.trigger("_change");

    self.focus();
  };
  /**
   * 우편번호피커 다이얼로그를 여는 메소드
   */
  ZipCodePicker.prototype.open = function () {
    var self = this,
      callback = function callback(data) {
        if (typeof data !== "undefinded") {
          self.setData(data);
        }
      };

    self.inputDialog.open(callback);
  };

  /**
   * 우편번호다이얼로그에서 값 선택 시 우편번호피커에 값 설정
   */
  ZipCodePicker.prototype.setData = function (data) {
    var self = this,
      $zipCodePicker = self._$element,
      $zipCodePickerAddress = self._$addressElement,
      options = self.options,
      setDataEvent,
      roadAddress = data.roadAddress,
      jibunAddress = data.jibunAddress;

    // 5글자의 새 우편번호
    $zipCodePicker.val(data.zonecode);

    // 주소 필드가 있는 경우 주소 정보를 입력
    if ($zipCodePickerAddress) {
      if (options.addressType === "street") {
        // 다음 우편번호 서비스에서 지번주소에 매핑된 도로명 주소가 여러개 일 경우 roadAddress 가 빈문자열로 반환
        if (roadAddress === "" && data.autoRoadAddress) {
          roadAddress = data.autoRoadAddress;
        }

        $zipCodePickerAddress.val(roadAddress);
      } else if (options.addressType === "jibun") {
        // 다음 우편번호 서비스에서 도로명에 매핑된 지번 주소가 여러개 일 경우 jibunAddress 가 빈문자열로 반환
        if (jibunAddress === "" && data.autoJibunAddress) {
          jibunAddress = data.autoJibunAddress;
        }

        $zipCodePickerAddress.val(jibunAddress);
      } else if (options.addressType === "userselect") {
        if (data.userSelectedType === "R") {
          $zipCodePickerAddress.val(roadAddress);
        } else {
          $zipCodePickerAddress.val(jibunAddress);
        }
      }
    }

    // change 이벤트
    $zipCodePicker.trigger("_change");
    $zipCodePicker.trigger("change");

    // setData 이벤트
    data.zipcode = data.zonecode;
    data.jibun = jibunAddress || data.autoJibunAddress || ""; // 다음 우편번호 서비스에서 도로명에 매핑된 지번 주소가 여러개 일 경우, jibunAddress = '' 이므로
    data.street = roadAddress || data.autoRoadAddress || ""; // 다음 우편번호 서비스에서 지번주소에 매핑된 도로명 주소가 여러개 일 경우, roadAddress = '' 이므로

    if (!data.userSelectedType) {
      data.userSelectedType = data.addressType;
    }

    setDataEvent = new $.Event("setData", data);
    $zipCodePicker.trigger(setDataEvent);

    $zipCodePicker.focus();
  };

  /**
   * 호환성 맞춰주기 위함
   */
  ZipCodePicker.prototype.disable = function (value) {
    var self = this;

    if (typeof value === "boolean") {
      self.enable(!value);
    } else {
      return !self.enable();
    }
  };
  /**
   * 우편번호피커를 enable 처리하는 메소드
   * @param {boolean} value disabled 여부 (기본 값 입력 시 현재 값 반환)
   * @returns {boolean} 현재 disabled 여부
   */
  ZipCodePicker.prototype.enable = function (value) {
    var self = this,
      $element = self._$element,
      enabled;

    enabled = !$element.prop("disabled");

    if (typeof value !== "undefined") {
      if (!value) {
        self._setDisabled();
        self.innerButtonGroup.hideButton();
      } else {
        self._removeDisabled();
        self.innerButtonGroup.showButton();
      }
    } else {
      return enabled;
    }
  };

  /**
   * 우편번호피커의 visible 여부를 가져옵니다.
   * @returns {boolean}
   * @private
   */
  ZipCodePicker.prototype._visibleCheckFromPanel = function () {
    var self = this,
      $ctrl = self._$element,
      isVisible = $ctrl.closest(".dews-zipcodepicker-wrapper").css("display") !== "none";

    return isVisible;
  };

  /**
   * 우편번호피커의 required 상태 설정 및 해제합니다.
   * @param {boolean} required 상태값
   */
  ZipCodePicker.prototype.required = function (value) {
    var self = this;
    var $element = self._$element;
    var $wrapper = self._$wrapper;

    if (typeof value === "undefined") {
      return $element.hasClass("required");
    } else if (value === true) {
      if (!$wrapper.hasClass("dews-state-required")) {
        $wrapper.addClass("dews-state-required");
      }
      if (!$wrapper.hasClass("required")) {
        $wrapper.addClass("required");
      }
      if (!$element.hasClass("dews-state-required")) {
        $element.addClass("dews-state-required");
      }
      if (!$element.hasClass("required")) {
        $element.addClass("required");
      }
    } else if (value === false) {
      if ($wrapper.hasClass("dews-state-required")) {
        $wrapper.removeClass("dews-state-required");
      }
      if ($wrapper.hasClass("required")) {
        $wrapper.removeClass("required");
      }

      if ($element.hasClass("dews-state-required")) {
        $element.removeClass("dews-state-required");
      }
      if ($element.hasClass("required")) {
        $element.removeClass("required");
      }
    }
  };

  ZipCodePicker.prototype.readonly = function (value) {
    var self = this,
      $element = self._$element;

    if (typeof value === "undefined") {
      // 값 가져가기
      value = $element.hasClass("readonly");
    } else {
      // 읽기 전용 설정
      if (value) {
        if (!$element.hasClass("readonly")) {
          $element.addClass("readonly");
          $element.parent().addClass("dews-state-readonly");
          self.innerButtonGroup._$clearButton.css("display", "none");
          self.innerButtonGroup._$searchButton.prop("disabled", true);
        }
        if (!$element.prop("readonly")) {
          self.innerButtonGroup._$clearButton.css("display", "none");
          self.innerButtonGroup._$searchButton.prop("disabled", true);
        }
      } else {
        if ($element.hasClass("readonly")) {
          $element.removeClass("readonly");
          $element.parent().removeClass("dews-state-readonly");
          self.innerButtonGroup._$searchButton.prop("disabled", false);

          if (self.value()) {
            self.innerButtonGroup._$clearButton.css("display", "inline-block");
          }
        }
        if ($element.prop("readonly")) {
          self.innerButtonGroup._$searchButton.prop("disabled", false);

          if (self.value()) {
            self.innerButtonGroup._$clearButton.css("display", "inline-block");
          }
        }
      }
    }

    return value;
  };

  ZipCodePicker.prototype.raiseEvent = function (event) {
    var self = this,
      eventArray = ["setData"];

    try {
      if (eventArray.indexOf(event) !== -1) {
        if (event === "change") {
          self._$element.trigger("_change");
        } else {
          self._$element.trigger(event);
        }
      } else {
        throw "제공하지않는 이벤트 타입입니다.";
      }
    } catch (e) {
      console.log(e);
    }
  };

  /**
   * DEWS 객체에 직접 이벤트 핸들러를 등록합니다.
   */
  ZipCodePicker.prototype.on = function () {
    var self = this;
    var $el = self._$element;
    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    }
    $el.on.apply($el, arguments);
  };
  /**
   * DEWS 객체에 직접 등록한 이벤트 핸들러를 해제합니다.
   */
  ZipCodePicker.prototype.off = function () {
    var self = this;
    var $el = self._$element;
    if (arguments[0] === "change") {
      Array.prototype.splice.call(arguments, 0, 1, "_change");
    }
    $el.off.apply($el, arguments);
  };

  ZipCodePicker.prototype.validate = function () {
    var self = this;
    return !!self._$element.val();
  };

  ZipCodePicker.prototype.bindFromPanel = function (data) {
    var self = this,
      $element = self._$element;
    var column;

    if (data) {
      column = $element.data("dews-bind-column") || $element.attr("id");

      if (column && data.hasOwnProperty(column)) {
        self.value(data[column] || "");
      }
    }
  };

  ZipCodePicker.prototype.serializeForPanel = function () {
    var self = this,
      $element = self._$element;
    var column, data;

    column = $element.data("dews-bind-column") || $element.attr("id");

    if (column) {
      data = {};
      data[column] = self.value();
    }

    return data;
  };

  ZipCodePicker.prototype.applyPanelFocus = function (requiredCheck) {
    var self = this,
      $element = self._$element;

    $element.on("keydown", function (e) {
      if (e.keyCode === 13 && (e.shiftKey || e.ctrlKey || e.altKey) && $element.is(":enabled")) {
        e.preventDefault();
      } else if (e.keyCode === 9 && e.shiftKey) {
        e.preventDefault();

        var evt = new $.Event("beforeFocus");
        evt.control = self;

        $element.trigger(evt);
      } else if (e.keyCode === 9 || e.keyCode === 13 && $element.is(":enabled")) {
        if (e.keyCode === 9) {
          //tab키 기본동작 막기
          e.preventDefault();
        }
        if (e.keyCode === 13 && requiredCheck && $element.hasClass("required")) {
          if (self.validate()) {
            var evt = new $.Event("nextFocus");
            evt.control = self;

            $element.trigger(evt);
          }
        } else {
          var evt = new $.Event("nextFocus");
          evt.control = self;

          $element.trigger(evt);
        }
      }
    });
    $element.on("setData", function () {
      var evt = new $.Event("nextFocus");
      evt.control = self;

      $element.trigger(evt);
    });
  };

  ZipCodePicker.prototype.focus = function () {
    var self = this,
      $element = self._$element;
    $element.focus();
  };

  ZipCodePicker.prototype.canFocusable = function () {
    var self = this,
      $element = self._$element;
    return !$element.hasClass("readonly") && $element.is(":visible") && $element.is(":enabled");
  };

  /**
   * 컨트롤을 비활성화 상태로 만듭니다.
   * @private
   */
  ZipCodePicker.prototype._setDisabled = function () {
    var self = this,
      $el = self._$element,
      $wrapper = self._$wrapper;

    if (!$wrapper.hasClass("dews-state-disabled")) {
      $wrapper.addClass("dews-state-disabled");
    }
    if (!$wrapper.hasClass("disabled")) {
      $wrapper.addClass("disabled");
    }

    $el.prop("disabled", true);

    if (!$el.hasClass("dews-state-disabled")) {
      $el.addClass("dews-state-disabled");
    }
    if (!$el.hasClass("disabled")) {
      $el.addClass("disabled");
    }
  };
  /**
   * 컨트롤을 활성화 상태로 돌립니다.
   * @private
   */
  ZipCodePicker.prototype._removeDisabled = function () {
    var self = this,
      $el = self._$element,
      $wrapper = self._$wrapper;

    if ($wrapper.hasClass("dews-state-disabled")) {
      $wrapper.removeClass("dews-state-disabled");
    }
    if ($wrapper.hasClass("disabled")) {
      $wrapper.removeClass("disabled");
    }

    $el.prop("disabled", false);

    if ($el.hasClass("dews-state-disabled")) {
      $el.removeClass("dews-state-disabled");
    }
    if ($el.hasClass("disabled")) {
      $el.removeClass("disabled");
    }

    // 비우기 버튼 다시그림
    $el.trigger("change");
  };
  /**
   * 우편번호피커 컨트롤을 활성화 시킵니다.
   * @private
   */
  ZipCodePicker.prototype._activate = function () {
    var self = this,
      $el = self._$element;

    if (!$el.hasClass("dews-control-activate")) {
      $el.addClass("dews-control-activate");
    }
  };

  /**
   * 우편코드피커 컨트롤 display none 하여 숨기는 API
   */
  ZipCodePicker.prototype.hide = function () {
    var self = this;

    if (!(self._$wrapper.css("display") === "none")) {
      self._$wrapper.css("display", "none");
    }
  };

  /**
   * 우편코드피커 컨트롤 display inline-block 하여 보이도록 하는 API
   */
  ZipCodePicker.prototype.show = function () {
    var self = this;

    if (self._$wrapper.css("display") === "none") {
      self._$wrapper.css("display", "inline-block");
    }
  };

  /**
   * 우편번호피커에 포함된 버튼 그룹 객체
   * @param $zipCodePicker 버튼 그룹을 가지는 우편번호 피커 JQuery 객체
   * @param searchButtonCallback 검색 버튼을 눌렀을 때 실행될 함수
   * @param clearButtonCallback 비우기 버튼을 눌렀을 때 실행될 함수
   * @private
   */
  ZipCodePicker._ZipCodePickerButtonGroup = function ($zipCodePicker, searchButtonCallback, clearButtonCallback) {
    var self = this;

    self._$zipCodePicker = $zipCodePicker;
    self._searchButtonCallback = searchButtonCallback;
    self._clearButtonCallback = clearButtonCallback;
    self._createButtons();

    // 기본 버튼 노출 처리
    self.showButton();
  };
  /**
   * 우편번호피커의 버튼들을 생성하는 함수
   * @private
   */
  ZipCodePicker._ZipCodePickerButtonGroup.prototype._createButtons = function () {
    var self = this,
      $zipCodePicker = self._$zipCodePicker,
      $searchButton,
      $clearButton;

    // 검색 버튼
    $searchButton = $('<button type="button"></button>').addClass("dews-zipcodepicker-button icon-search");

    // 우편번호피커 Input박스 뒤에 버튼을 추가
    $zipCodePicker.after($searchButton);
    self._$searchButton = $searchButton;

    $searchButton.on("click", function (e) {
      self._searchButtonCallback();
    });

    // 비우기 버튼
    $clearButton = $('<button type="button"></button>').addClass("dews-zipcodepicker-button icon-clear");

    $zipCodePicker.after($clearButton);
    self._$clearButton = $clearButton;

    $clearButton.on("click", function (e) {
      self._clearButtonCallback();
    });
  };
  /**
   * 비우기 버튼을 보여주는 메소드
   */
  ZipCodePicker._ZipCodePickerButtonGroup.prototype._showClearButton = function () {
    var self = this;
    self._$clearButton.show();
    self._$searchButton.hide();
  };
  /**
   * 검색 버튼을 보여주는 메소드
   */
  ZipCodePicker._ZipCodePickerButtonGroup.prototype._showSearchButton = function () {
    var self = this;
    self._$searchButton.show();
    self._$clearButton.hide();
  };
  /**
   * 모든 버튼을 감추는 메소드
   */
  ZipCodePicker._ZipCodePickerButtonGroup.prototype.hideButton = function () {
    var self = this;
    self._$searchButton.hide();
    self._$clearButton.hide();
  };
  /**
   * 현재 상태에 따라 검색/비우기 버튼을 보여주는 메소드
   */
  ZipCodePicker._ZipCodePickerButtonGroup.prototype.showButton = function () {
    var self = this;

    if (self._$zipCodePicker.prop("disabled")) {
      self.hideButton();
    } else {
      if (self._$zipCodePicker.val().length > 0) {
        !self._$zipCodePicker.hasClass("readonly") && !self._$zipCodePicker.hasClass("disabled") ?
        self._showClearButton() :
        self.hideButton();
      } else {
        self._showSearchButton();
      }
    }
  };

  /**
   * 주기간피커 컨트롤 자동화 인쇄 관련 데이터 추출
   * @return {*} 값이 설정 된 경우 Object 반환, 없는 경우 undefined 반환
   * @private
   */
  ZipCodePicker.prototype._getPrintData = function () {
    var self = this,
      $el = $(self._$element),
      data;

    if (self.value()) {
      data = {
        id: $el.attr("id"),
        text: self.value()
      };
    }

    return data;
  };

  /**
   * 시용자 가이드를 위한 API 를 추가합니다.
   * @param $element 대상 jQuery 요소
   */
  function setUserGuideAPI($element) {
    $element.on("focus", function () {
      if (dews.ui.page && dews.ui.page.hasUserGuide) {
        if ($.isFunction(dews.ui.page.focusGuideItem) && $element.attr("id")) {
          dews.ui.page.focusGuideItem("#" + $element.attr("id"));
        }
      }
    });
  }

  /**
   * 우편번호피커 HTML에 설정되어 있는 옵션을 얻어오는 함수
   * @param $element 우편번호 피커 JQuery 객체
   * @returns {{addressType, addressBind}}
   */
  function getZipCodePickerOptions($element) {
    return {
      addressType: $element.data("dews-address-type"),
      addressBind: $element.data("dews-address-bind")
    };
  }

  $.extend(true, dews, {
    /**
     * @namespace
     */
    ui: {
      /**
       * 지정한 요소를 우편번호피커로 만들거나 가져옵니다.
       * @param {string|jQuery} selector 우편번호피커로 만들 셀렉터 또는 jQuery 객체
       * @param {object} options 우편번호피커 옵션
       * @returns {object|Array} 우편번호피커 인스턴스
       */
      zipcodepicker: function zipcodepicker(selector, options) {
        var $el, picker;

        if (selector instanceof jQuery) {
          $el = selector;
        } else if ($.type(selector) === "string") {
          $el = $(selector);
        }

        if ($.type($el) === "undefined") {
          return;
        }

        $el.each(function () {
          var element = this,
            $element = $(element),
            option;

          if ($element.data("dews-control")) {
            picker = $element.data("dews-control");

            if (options) {
              picker._changeOption(options);
            }
          } else {
            if (!$element.hasClass("dews-ui-zipcodepicker")) {
              $element.addClass("dews-ui-zipcodepicker");
            }
            if (!$element.hasClass("dews-form-control")) {
              $element.addClass("dews-form-control");
            }

            option = $.extend(true, {}, getZipCodePickerOptions($element), options);

            picker = new ZipCodePicker(element, option);

            $element.data("dews-control", picker);
          }
        });

        return picker;
      }
    }
  });

  dews.ui.addControlInitializer("zipcodepicker", function (target) {
    var $container;

    if (target instanceof jQuery) {
      $container = target;
    } else if ($.type(target) === "string") {
      $container = $(target);
    } else {
      $container = $(document);
    }

    dews.ui.zipcodepicker($(".dews-ui-zipcodepicker", $container));
  });
})(jQuery, window.dews);


/*
 * 대시보드 위젯 리피트
 */
(function ($, dews, kendo) {
  /**
   * 대시보드 위젯 리피트 옵션
   * @param opt 스크립트에서 받아온 옵션
   * @return {{autoBind: boolean, template: string}}
   */
  function getOptions(opt) {
    var options = {
      autoBind: true,
      template: "",
      listType: "list-compound"
    };

    options = $.extend(true, {}, options, opt);

    return options;
  }

  /**
   * 대시보드 위젯 리피트
   * @param $el 대시보드 위젯 리피트 jQuery 객체
   * @param options 대시보드 위젯 리피트 옵션
   * @return {Repeat} 대시보드 위젯 리피트 객체
   * @constructor
   */
  var Repeat = function Repeat($el, options) {
    var self = this;

    self.$element = $el;
    self.options = getOptions(options);
    self._bindEvent();
    self._initControl();

    return self;
  };

  /**
   * 대시보드 위젯 리피트 컨트롤 생성
   * @private
   */
  Repeat.prototype._initControl = function () {
    var self = this;

    self.$element.empty();

    if (self.options.headerTemplate) {
      self.$element.append($(self.options.headerTemplate));
    }

    if (self.$element.find("> ul").length === 0) {
      var ul = $("<ul></ul>").addClass(self.options.listType);
      self.$element.append(ul);
    }

    if (self.options.autoBind && self.options.dataSource) {
      var dataSource = self.options.dataSource;

      if (dataSource.data().length !== 0) {
        self._renderData();
      } else {
        dataSource.read().done(function (result) {
          self._renderData();
        });
      }
    }
  };

  /**
   * 리피터 내용 렌더링
   * @private
   */
  Repeat.prototype._renderData = function () {
    var self = this;

    var params = {
      repeat: self,
      row: {
        data: self.options.dataSource.data()
      }
    };

    var dataBound = new $.Event("dataBound", params);
    self.$element.trigger(dataBound);

    var dataSource = self.options.dataSource;

    $.each(dataSource.data(), function (idx, data) {
      var template = kendo.template(self.options.template);
      self.$element.find("> ." + self.options.listType.trim()).append($(template(data)));
    });

    if (
    self.$element &&
    self.$element.closest(".dews-widget") &&
    self.$element.closest(".dews-widget").data("dews-control"))
    {
      self.$element.closest(".dews-widget").data("dews-control").options.tabItem.masonry.masonry();
    }
  };

  /**
   * 대시보드 위젯 리피트 이벤트
   * @private
   */
  Repeat.prototype._bindEvent = function () {
    var self = this;

    self.$element.on("dataBound", function (e) {
      if (self.options.dataBound && $.type(self.options.dataBound) === "function") {
        self.options.dataBound.call(self, e);
      }
    });
  };

  /**
   * 대시보드 위젯 리피트 데이터소스 변경
   * @param dataSource
   */
  Repeat.prototype.setDataSource = function (dataSource) {
    var self = this;

    self.options.dataSource = dataSource;
    self._initControl();
  };

  $.extend(true, dews, {
    widget: {
      repeat: function repeat(selector, options) {
        var $el, repeat;

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector);
        }

        if ($.type(selector) === "undefined") {
          return;
        }

        $el.each(function () {
          var $this = $(this),
            control;

          control = $this.data("dews-control");

          if (!control) {
            if (!$this.hasClass("dews-widget-repeat")) {
              $this.addClass("dews-widget-repeat");
            }

            if (!$this.hasClass("dews-widget-list")) {
              $this.addClass("dews-widget-list");
            }

            if (!$this.hasClass("dews-widget-control")) {
              $this.addClass("dews-widget-control");
            }

            control = new Repeat($this, options);

            $this.addClass("dews-control-activate");
            $this.data("dews-control", control);
          }

          repeat = control;
        });

        return repeat;
      }
    }
  });
})(jQuery, window.dews, window.kendo);


/*
 * 대시보드 위젯 테이블
 */
(function ($, dews, kendo) {
  /**
   * 옵션 설정
   * @param opt 스크립트에서 받아온 옵션
   */
  function getOptions(opt) {
    var options = {
      autoBind: true
    };

    return $.extend(true, {}, options, opt);
  }

  /**
   * 대시보드 위젯 테이블
   * @param $el 대시보드 위젯 태이블 jQuery 객체
   * @param opt 대시보드 위젯 테이블 옵션
   * @return {Table} 대시보드 위젯 테이블 객체
   * @constructor
   */
  var Table = function Table($el, opt) {
    var self = this;

    self.$element = $el;
    self.options = getOptions(opt);

    self._bindEvent();
    self._initControl();

    return self;
  };

  /**
   * 대시보드 위젯 테이블 컨트롤 생성
   * @private
   */
  Table.prototype._initControl = function () {
    var self = this;

    self.$element.empty();

    if (self.$element.parent(".list-border-wrap").length === 0) {
      self.$element.wrap('<div class="list-border-wrap"></div>');
    }

    self.$colgroup = $("<colgroup></colgroup>");
    self.$thead = $("<thead><tr></tr></thead>");
    self.$tbody = $("<tbody></tbody>");

    self.$element.append(self.$colgroup);
    self.$element.append(self.$thead);
    self.$element.append(self.$tbody);

    if (self.options.columns) {
      $.each(self.options.columns, function (idx, item) {
        var width = item.width || "auto";
        self.$colgroup.append($('<col style="width:' + width + '">'));
        self.$thead.find("tr").append($('<th scope="col">' + item.title + "</th>"));
      });

      if (self.options.dataSource) {
        if (self.options.dataSource.data().length === 0) {
          self.options.dataSource.read().done(function (reuslt) {
            self._renderData();
          });
        } else {
          self._renderData();
        }
      }
    }
  };

  /**
   * 대시보드 위젯 테이블 바디 영역 렌더링
   * @private
   */
  Table.prototype._renderData = function () {
    var self = this;

    var params = {
      table: self,
      row: {
        data: self.options.dataSource.data()
      }
    };

    $.each(self.options.dataSource.data(), function (idx, item) {
      var tr = $("<tr></tr>");
      $.each(self.options.columns, function (index, column) {
        var data = item[column["field"]];
        var align = "";
        if (column.formats && column.formats.type) {
          var format;
          switch (column.formats.type.toLowerCase()) {
            case "number":
              if (column.formats.predefined === true) {
                if ($.type(column.formats.preFormat) === "undefined") {
                  column.formats.preFormat = column.formats.format;
                }
                var preDefinedFormat = dews.getPreDefinedFormat(column.formats);

                if (preDefinedFormat) {
                  column.formats.format = preDefinedFormat;
                } else {
                  column.formats.format = "#,##0.##";
                }
              }

              format = column.formats.format || "#,###";
              data = dews.number.format(data, format);
              break;
            case "mask":
              format = column.formats.format;
              data = dews.string.mask(data, format);
              break;
            case "date":
              if (column.formats.predefined === true) {
                if ($.type(column.formats.preFormat) === "undefined") {
                  column.formats.preFormat = column.formats.format;
                }
                var preDefinedFormat = dews.getPreDefinedFormat(column.formats);

                if (preDefinedFormat) {
                  column.formats.format = preDefinedFormat;
                } else {
                  column.formats.format = "#,##0.##";
                }
              }

              format = column.formats.format || dews._environments.formats.dateFormat;
              data = kendo.toString(kendo.parseDate(data, "yyyyMMdd"), format);
              break;}

        }

        if (column.align) {
          switch (column.align.toLowerCase()) {
            case "left":
              align = "txt-left";
              break;
            case "right":
              align = "txt-right";
              break;}

        }
        tr.append($('<td class="' + align + '">' + data + "</td>"));
      });
      self.$tbody.append(tr);
    });

    var dataBound = new $.Event("dataBound", params);
    self.$element.trigger(dataBound);

    if (
    self.$element &&
    self.$element.closest(".dews-widget") &&
    self.$element.closest(".dews-widget").data("dews-control"))
    {
      self.$element.closest(".dews-widget").data("dews-control").options.tabItem.masonry.masonry();
    }
  };

  /**
   * 대시보드 위젯 테이블 이벤트 정의
   * @private
   */
  Table.prototype._bindEvent = function () {
    var self = this;

    self.$element.on("dataBound", function (e) {
      if (self.options.dataBound && $.type(self.options.dataBound) === "function") {
        self.options.dataBound.call(self, e);
      }
    });
  };

  /**
   * 대시보드 위젯 테이블 데이터소스 정의
   * @param dataSource 데이터소스 객체
   */
  Table.prototype.setDataSource = function (dataSource) {
    var self = this;

    self.options.dataSource = dataSource;
    self._initControl();
  };

  /**
   * 대시보드 위젯 테이블 컬럼 정의
   * @param columns 컬럼 객체
   */
  Table.prototype.setColumns = function (columns) {
    var self = this;

    self.options.columns = columns;
    self._initControl();
  };

  $.extend(true, dews, {
    widget: {
      table: function table(selector, options) {
        var $el, table;

        if (selector instanceof jQuery) {
          $el = selector;
        } else {
          $el = $(selector);
        }

        if ($.type(selector) === "undefined") {
          return;
        }

        $el.each(function () {
          var $this = $(this),
            control;

          control = $this.data("dews-control");

          if (!control) {
            if (!$this.hasClass("dews-widget-table")) {
              $this.addClass("dews-widget-table");
            }

            if (!$this.hasClass("dews-widget-control")) {
              $this.addClass("dews-widget-control");
            }

            control = new Table($this, options);

            $this.addClass("dews-control-activate");
            $this.data("dews-control", control);
          }

          table = control;
        });

        return table;
      }
    }
  });
})(jQuery, window.dews, window.kendo);


(function (dews) {
  // 생성자
  function DialogEtcFilter(title, dataType, data, etcComponent, etcComponentFormat) {
    this._title = "";
    this._dataType = dataType;
    this._data = data;
    this._component = etcComponent;
    this._componentFormat = etcComponentFormat;

    if (title !== undefined && title !== null && title !== "") {
      this._title = " (" + title + ")";
    }
  }

  // 타입에 따른 드롭다운리스트에 적용 할 조건 데이터를 반환하는 함수
  DialogEtcFilter.prototype._createConditionList = function (dataType) {
    var conditionList = [];

    conditionList.push({ value: "e", text: "=" });
    conditionList.push({ value: "ne", text: "<>" });
    conditionList.push({ value: "gt", text: ">" }); // greater than
    conditionList.push({ value: "gtoet", text: ">=" }); // greater than or equal to
    conditionList.push({ value: "lt", text: "<" }); // less than
    conditionList.push({ value: "ltoet", text: "<=" }); // less than or equal to

    if (dataType !== "date" && dataType !== "month" && dataType !== "time" && dataType !== "number") {
      conditionList.push({
        value: "sc",
        text: dews.localize.get("시작 문자", "dews_시작 문자")
      }); // starting character
      conditionList.push({
        value: "scte",
        text: dews.localize.get("제외 할 시작 문자", "dews_제외 할 시작 문자")
      }); // starting character to exclude
      conditionList.push({
        value: "ec",
        text: dews.localize.get("끝 문자", "dews_끝 문자")
      }); // end character
      conditionList.push({
        value: "ecte",
        text: dews.localize.get("제외 할 끝 문자", "dews_제외 할 끝 문자")
      }); // end character to exclude
      conditionList.push({
        value: "i",
        text: dews.localize.get("포함", "dews_포함")
      }); // include
      conditionList.push({
        value: "ni",
        text: dews.localize.get("포함하지 않음", "dews_포함하지 않음")
      }); // not included
    }

    return conditionList;
  };

  // 레이어 Html 가져오기
  DialogEtcFilter.prototype._getLayerHtml = function () {
    var valueFormat = "";
    if (this._componentFormat) {
      valueFormat = ' data-dews-format="' + this._componentFormat + '"';
    }

    var html =
    '<div class="dews-dialog-contents-area">\n' +
    '  <div class="dews-form-panel-subtitle grid-filter-title">\n' +
    '    <span class="dews-form-panel-text">' +
    dews.localize.get("찾을 조건", "dews_찾을 조건") +
    this._title +
    "</span>\n" +
    "  </div>\n" +
    "  \n" +
    '  <div class="dews-grid-etc-filter">\n' +
    "    <p>\n" +
    '      <select class="dews-grid-etc-filter-dropdown1"></select>\n' +
    '      <input type="text" class="dews-ui-' +
    this._component +
    ' dews-grid-etc-filter-value1"' +
    valueFormat +
    ">\n" +
    "    </p>\n" +
    "    <p>\n" +
    '      <input type="radio" id="rdo_and" name="etc_dialog_radio" class="dews-ui-radio" value="and" checked="checked">\n' +
    '      <label for="rdo_and">' +
    dews.localize.get("그리고", "dews_그리고") +
    "</label>\n" +
    '      <input type="radio" id="rdo_or" name="etc_dialog_radio" class="dews-ui-radio" value="or">\n' +
    '      <label for="rdo_or">' +
    dews.localize.get("또는", "dews_또는") +
    "</label>\n" +
    "    </p>\n" +
    "    <p>\n" +
    '      <select class="dews-grid-etc-filter-dropdown2"></select>\n' +
    '      <input type="text" class="dews-ui-' +
    this._component +
    ' dews-grid-etc-filter-value2"' +
    valueFormat +
    ">\n" +
    "    </p>\n" +
    "  </div>\n" +
    "</div>";

    return html;
  };

  // 이벤트 전파 - ok
  DialogEtcFilter.prototype._onEventOk = function (data) {
    var event = new $.Event("ok");
    event.etcData = data;
    $(this).trigger(event);
  };

  // 필터 레이어를 연다.
  DialogEtcFilter.prototype.open = function () {
    var self = this;
    var type = this._dataType;

    // 필터 레이어 HTML 가져오기
    var layerHtml = this._getLayerHtml();

    var dialog = dews.ui.dialog("etc_filter_layer_dialog", {
      content: layerHtml,
      title: dews.localize.get("기타 필터", "dews_기타 필터"),
      size: "medium",
      width: 465,
      height: 255,
      buttons: "applyAndClose",
      open: function open() {
        dews.ready(function () {
          var dropdown1 = dews.ui.dropdownlist($(".dews-grid-etc-filter-dropdown1"), {
            dataValueField: "value",
            dataTextField: "text",
            useNumkey: false
          });
          var dropdown2 = dews.ui.dropdownlist($(".dews-grid-etc-filter-dropdown2"), {
            dataValueField: "value",
            dataTextField: "text",
            useNumkey: false
          });
          var v1control = dialog.$content.
          find(".dews-grid-etc-filter-value1.dews-control-activate").
          data("dewsControl");
          var v2control = dialog.$content.
          find(".dews-grid-etc-filter-value2.dews-control-activate").
          data("dewsControl");
          var conditionList = self._createConditionList(type);

          dropdown1.setDataSource(conditionList);
          dropdown2.setDataSource(conditionList);

          // 기타 필터 데이터 입력
          var etcData = self._data;
          if (etcData) {
            if (v1control.element.hasClass("dews-ui-textbox")) {
              v1control.text(etcData.value1);
            } else {
              v1control.value(etcData.value1);
            }
            if (v2control.element.hasClass("dews-ui-textbox")) {
              v2control.text(etcData.value2);
            } else {
              v2control.value(etcData.value2);
            }
            dropdown1.value(etcData.condition1);
            dropdown2.value(etcData.condition2);
            $("#rdo_" + etcData.logicOp + "").attr("checked", true);
          }
        });
      }
    });

    // 다이얼로그 오픈
    dialog.open();

    // 기타 필터 다이얼로그로 포커스
    dialog._kendoWindow.bind("activate", function () {
      dialog.$content.focus();
    });

    // 적용 버튼 눌렀을 때
    dialog.buttons.ok.on("click", function () {
      var etcFilterOpenButton = $(".dews-grid-filter-button");
      var v1control = dialog.$content.
      find(".dews-grid-etc-filter-value1.dews-control-activate").
      data("dewsControl");
      var v2control = dialog.$content.
      find(".dews-grid-etc-filter-value2.dews-control-activate").
      data("dewsControl");
      var logicOp = dialog.$content.find("input:radio[name='etc_dialog_radio']:checked").val();
      var dropdown1control = dialog.$content.
      find(".dews-grid-etc-filter-dropdown1.dews-control-activate").
      data("dewsControl");
      var dropdown2control = dialog.$content.
      find(".dews-grid-etc-filter-dropdown2.dews-control-activate").
      data("dewsControl");
      var tooltipOptions = {
        type: "normal",
        text: dews.localize.get("값을 입력하세요", "dews_값을 입력하세요"),
        fadeOutTime: 1000,
        position: "top"
      };

      // 기타 필터 레이어 값1, 값2에 없을 경우 툴팁
      if (!v1control.text()) {
        dews.ui.tooltip.show(v1control.element, tooltipOptions);
        return false;
      }
      if (!v2control.text()) {
        dews.ui.tooltip.show(v2control.element, tooltipOptions);
        return false;
      }

      // 기타 필터 적용 되었을 경우 "selected" 클래스 추가
      if (etcFilterOpenButton.length > 0) {
        etcFilterOpenButton.addClass("selected");
      }

      var value1, value2;

      if (v1control.element.hasClass("dews-ui-textbox")) {
        value1 = v1control.text();
      } else {
        value1 = v1control.value();
      }
      if (v2control.element.hasClass("dews-ui-textbox")) {
        value2 = v2control.text();
      } else {
        value2 = v2control.value();
      }

      var data = {
        filterName: "etc_filter",
        logicOp: logicOp,
        value1: value1,
        value2: value2,
        condition1: dropdown1control.value(),
        condition2: dropdown2control.value()
      };

      self._onEventOk(data);
      dialog.ok();
    });

    return dialog;
  };

  // 외부에서 접근할 수 있도록 추가
  $.extend(true, dews, {
    fn: {
      dialog: {
        etcFilter: DialogEtcFilter
      }
    }
  });
})(window.dews || {});var


GridNoteService = /*#__PURE__*/function () {"use strict";function GridNoteService() {_classCallCheck(this, GridNoteService);}_createClass(GridNoteService, [{ key: "getNoteList", value:
    function getNoteList(key, gridCd, menuCd) {
      var $dfd = $.Deferred();

      // 메모 조회
      dews.api.
      get(dews.url.getApiUrl("CM", "GridNoteService", "gridNoteData"), {
        data: {
          gridNoteKeyCode: key,
          gridCode: gridCd,
          menuCode: menuCd
        }
      }).
      done(function (result) {var _result$noteList;
        var list = (_result$noteList = result.noteList) === null || _result$noteList === void 0 ? void 0 : _result$noteList.filter(function (note) {
          return note.noteText;
        });

        $dfd.resolve(list);
      });

      return $dfd;
    } }, { key: "saveNote", value:

    function saveNote(model) {
      var $dfd = $.Deferred();

      dews.api.
      post(dews.url.getApiUrl("CM", "GridNoteService", "gridNoteSave"), {
        data: {
          gridNoteDataModel: JSON.stringify(model)
        }
      }).
      done(function (data) {
        $dfd.resolve(data);
      });

      return $dfd;
    } }, { key: "deleteNote", value:

    function deleteNote(model, all) {
      var $dfd = $.Deferred();

      dews.api.
      post(dews.url.getApiUrl("CM", "GridNoteService", "gridNoteDelete"), {
        data: {
          gridNoteModelList: JSON.stringify(model),
          deleteType: all ? "all" : ""
        }
      }).
      done(function (data) {
        $dfd.resolve(data);
      });

      return $dfd;
    } }, { key: "saveColor", value:

    function saveColor(model) {
      var $dfd = $.Deferred();

      dews.api.
      post(dews.url.getApiUrl("CM", "GridNoteService", "gridColorLineSave"), {
        data: {
          gridNoteModel: JSON.stringify(model)
        }
      }).
      done(function () {
        $dfd.resolve();
      });

      return $dfd;
    } }, { key: "getColor", value:

    function getColor(key, gridCd, menuCd) {
      var $dfd = $.Deferred();

      dews.api.
      get(dews.url.getApiUrl("CM", "GridNoteService", "gridNoteData"), {
        data: {
          gridNoteKeyCode: key,
          gridCode: gridCd,
          menuCode: menuCd
        }
      }).
      done(function (result) {return $dfd.resolve(result.glcCode);});

      return $dfd;
    } }, { key: "getColorUse", value:

    function getColorUse(gridCd, menuCd) {
      var $dfd = $.Deferred();

      dews.api.
      get(dews.url.getApiUrl("CM", "GridNoteService", "gridList"), {
        data: {
          gridCode: gridCd,
          menuCode: menuCd
        }
      }).
      done(function (result) {
        if (result[0]) {
          // 초기 설정 시에 컬러 활성화 유무 값이 null
          if (result[0].glcUseYn === null) {
            $dfd.resolve(true);
          }

          $dfd.resolve(result[0].glcUseYn === "Y");
        }
      });

      return $dfd;
    } }]);return GridNoteService;}();



(function (dews) {
  // 생성자
  function LayerFilter(userTarget, userOptions) {
    // 초기화
    this._init();
    // 타겟 정보
    this._target = $.extend(true, this._target, userTarget);
    // 옵션 생성
    this._options = $.extend(true, this._options, userOptions);
  }

  LayerFilter.prototype._init = function () {
    // 대상 컴포넌트
    this._target = {
      component: null,
      dataType: "string",
      // 그리드나 트리그리드 정보
      gridInfo: {
        column: null
      }
    };
    // 옵션 (기본 옵션 + 사용자 옵션)
    this._options = {
      left: 250,
      top: 100,
      width: 400,
      visible: true,
      // 자동으로 닫히는지 여부
      autoClose: true
    };
    // 컴포넌트 리스트를 가지고 있는 객체
    this._layerComponents = {
      // 레이어
      $layer: null,
      // 레이어 그리드
      grid: null,
      // 버튼들
      buttons: {
        // 기타 필터 버튼
        $etcFilter: null,
        // 필터 해제 버튼
        $clear: null,
        // 필터 해제 버튼 객체(?) (selector 아님)
        clear: null,
        // 저장 버튼
        $save: null,
        // 추가 버튼
        $addRow: null,
        // 유저 팁 버튼
        $userTip: null,
        // not 체크 버튼
        $notCheckBox: null,
        // not 값
        $notValue: null,
        // 빈 값 제외 체크 버튼
        $emptyCheckBox: null
      },
      // 기타 필터 다이얼로그
      etcFilter: {
        // 다이얼로그
        dialog: null,
        // 버튼들
        buttons: {}
      }
    };
    // 기타 필터 데이터
    this._etcData = undefined;
    // 기본 조건 값
    this._defaultCondition = "e";
    // 지원되는 조건 값
    this._supportCondition = ["e", "gt", "gtoet", "lt", "ltoet", "r", "sc", "ec", "i", "ev"];
    // 저장 버튼 보이기 여부
    this._isVisibleSaveButton = false;
  };

  // 타입에 따른 드롭다운리스트에 적용 할 조건 데이터를 반환하는 함수
  LayerFilter.prototype._createConditionList = function (dataType) {
    var conditionList = [];

    conditionList.push({ value: "e", text: "=" });
    // conditionList.push({value: 'ne', text: '<>'}); // 2021-12-30 필터 고도화 작업으로 삭제
    conditionList.push({ value: "gt", text: ">" }); // greater than
    conditionList.push({ value: "gtoet", text: ">=" }); // greater than or equal to
    conditionList.push({ value: "lt", text: "<" }); // less than
    conditionList.push({ value: "ltoet", text: "<=" }); // less than or equal to

    if (dataType === "date" || dataType === "month" || dataType === "time" || dataType === "number") {
      conditionList.push({
        value: "r",
        text: dews.localize.get("범위", "dews_범위")
      }); // range
    } else {
      conditionList.push({
        value: "sc",
        text: dews.localize.get("시작 문자", "dews_시작 문자")
      }); // starting character
      // conditionList.push({value: 'scte', text: dews.localize.get('제외 할 시작 문자', 'dews_제외 할 시작 문자')}); // starting character to exclude // 2021-12-30 필터 고도화 작업으로 삭제
      conditionList.push({
        value: "ec",
        text: dews.localize.get("끝 문자", "dews_끝 문자")
      }); // end character
      // conditionList.push({value: 'ecte', text: dews.localize.get('제외 할 끝 문자', 'dews_제외 할 끝 문자')}); // end character to exclude // 2021-12-30 필터 고도화 작업으로 삭제
      conditionList.push({
        value: "i",
        text: dews.localize.get("포함", "dews_포함")
      }); // include
      // conditionList.push({value: 'ni', text: dews.localize.get('포함하지 않음', 'dews_포함하지 않음')}); // not included // 2021-12-30 필터 고도화 작업으로 삭제
    }

    conditionList.push({
      value: "ev",
      text: dews.localize.get("빈 값", "dews_빈 값")
    }); //empty value
    // conditionList.push({value: 'ebv', text: dews.localize.get('빈 값 제외', 'dews_빈 값 제외')}); // exclude blank values // 2021-12-30 필터 고도화 작업으로 삭제

    return conditionList;
  };

  // 레이어 Html 가져오기
  LayerFilter.prototype.$_getLayer = function () {
    return $(".dews-grid-user-filter-layer");
  };

  // 레이어 Html 가져오기
  LayerFilter.prototype._getLayerHtml = function () {
    var dataType = this._target.dataType; // 데이터 타입

    var html =
    '<div class="dews-grid-user-filter-layer" tabindex="0">\n' +
    '  <div class="dews-grid-user-filter">\n' +
    '    <div class="grid-user-filter-contents">\n' +
    '      <div class="dews-button-group dews-grid-filter-button-group">\n' +
    '        <button class="dews-ui-button dews-filterClear-button ico-filterClear ico-left" disabled="disabled">' +
    dews.localize.get("필터해제", "dews_필터해제") +
    "</button>\n";

    if (this._isVisibleSaveButton) {
      html +=
      '        <button class="dews-ui-button dews-grid-filter-layer-save">' +
      dews.localize.get("저장", "dews_저장") +
      "</button>\n";
    }

    html +=
    '        <button class="dews-ui-button dews-grid-filter-layer-addRow">' +
    dews.localize.get("추가", "dews_추가") +
    "</button>\n" +
    "      </div>\n" +
    '      <div id="__filter_layer_grid__" class="dews-ui-grid"></div>\n' +
    '      <div class="dews-grid-filter-condition">\n' +
    '       <div class="dews-grid-filter-condition-not">\n' +
    '        <span class="dews-grid-filter-checkbox">\n' +
    '           <input type="checkbox" id="chk-not" class="dews-ui-checkbox">\n' +
    '           <label id="chk-not-label">제외 조건</label>\n' +
    "        </span>\n" +
    '        <input id="not-value" type="text" class="dews-ui-textbox" maxLength="100" placeholder="값을 콤마(,)로 구분하여 입력하세요.">' +
    "       </div>\n" +
    "       <div>\n" +
    '        <span class="dews-grid-filter-checkbox">\n' +
    '           <input type="checkbox" id="chk-empty-price" class="dews-ui-checkbox">\n' +
    '           <label id="chk-empty-price-label">빈값 제외</label>\n' +
    "        </span>\n" +
    "       </div>\n" +
    "      </div>\n" +
    "      \n" +
    '      <div class="dews-grid-filter-button-wrapper">\n' +
    '        <button class="dews-grid-filter-button" type="button"><span class="filter-text">' +
    dews.localize.get("기타 필터", "dews_기타 필터") +
    '</span><span class="apply">' +
    dews.localize.get("적용중", "dews_적용중") +
    "</span>" +
    "</button>\n" +
    "      </div>\n" +
    '      <div class="dews-grid-filter-usertip">\n' +
    '       <button class="">사용 Tip</button>\n' +
    '       <div class="usertip-text">\n' +
    "           <span>Not(제외 조건) 설정 방법</span>\n" +
    "              <ul>\n";

    // 데이터 타입에 따른 사용 Tip
    if (dataType === "date" || dataType === "month" || dataType === "time") {
      html +=
      "                <li>· 1자 이상 100자 이내 입력 가능</li>\n" +
      "                <li>· 동일하지 않는 값 설정 시 Date/Time 형식에 맞게 입력</li>\n";
    } else if (dataType === "number") {
      html +=
      "                <li>· 1자 이상 100자 이내 입력 가능</li>\n" +
      "                <li>· 동일하지 않는 값 설정 시 숫자만 입력</li>\n";
    } else {
      html +=
      "                <li>· 1자 이상 100자 이내 입력 가능</li>\n" +
      "                <li>· 인사 : 동일하지 않는 문자 설정 시 단어만 입력</li>\n" +
      "                <li>· 인사* : 제외할 시작 문자 설정 시 우측* 입력</li>\n" +
      "                <li>· *인사 : 제외할 끝 문자 설정 시 *좌측 입력</li>\n" +
      "                <li>· *인사*: 포함하지 않는 문자 설정 시 *좌/우* 입력</li>\n";
    }

    html +=
    "              </ul>\n" +
    "           <span>단축키 사용 방법</span>\n" +
    "              <ul>\n" +
    "                <li>· 추가 (Ins, Shift+Enter), 삭제 (Del), 초기화 (F8)</li>\n" +
    "              </ul>\n" +
    "       </div>\n" +
    "      </div>\n" +
    "    </div>\n" +
    "  </div>\n" +
    "</div>";

    return html;
  };

  // 아이템 체크 유효성 검사
  LayerFilter.prototype._layerGridRowDataValidate = function (itemIndex) {
    var layerGrid = this._layerComponents.grid; // 필터 그리드
    var layerRealGrid = layerGrid._grid; // 필터 리얼그리드 객체
    var rowValues = layerRealGrid.getValues(itemIndex); // 행 값
    var condition = rowValues.condition; // 조건
    var value1 = rowValues.value1; // 값1
    var value2 = rowValues.value2; // 값2
    var tooltipOpt = {
      type: "normal",
      text: dews.localize.get("값을 입력하세요", "dews_값을 입력하세요"),
      position: "top"
    };

    // 주석 정리 필요
    if (condition === "r") {
      if (value1 !== 0 && !value1) {
        layerGrid.showTooltip(itemIndex, "value1", tooltipOpt);
        layerRealGrid.checkItem(itemIndex, false, false, true);
        return false;
      } else if (value2 !== 0 && !value2) {
        layerGrid.showTooltip(itemIndex, "value2", tooltipOpt);
        layerRealGrid.checkItem(itemIndex, false, false, true);
        return false;
      }
    } else {
      if (condition !== "ev" && condition !== "ebv") {
        if (value1 !== 0 && !value1) {
          layerGrid.showTooltip(itemIndex, "value1", tooltipOpt);
          layerRealGrid.checkItem(itemIndex, false, false, true);
          return false;
        }
      }
    }

    return true;
  };

  // '필터 해제' 버튼 enable 상태 변경
  LayerFilter.prototype._setEnableClearFilterButton = function () {
    var enable = false;

    // 기타 필터에서 필터해제 버튼 활성화 여부 체크
    if (this._etcData) {
      enable = true;
    }

    // 필터 그리드에서 필터해제 버튼 활성화 여부 체크
    var layerGrid = this._layerComponents.grid;
    var layerRealGrid = layerGrid._grid;
    var checkCount = layerRealGrid.getCheckedItems().length;

    if (checkCount > 0) {
      enable = true;
    }

    // Not 필터가 활성화 되어 있는지 여부
    var $layerCheckNot = this._layerComponents.buttons.$notCheckBox;
    if ($layerCheckNot.is(":checked")) {
      enable = true;
    }

    // Empty 필터가 활성화 되어 있는지 여부
    var $layerCheckEmptyPrice = this._layerComponents.buttons.$emptyCheckBox;
    if ($layerCheckEmptyPrice.is(":checked")) {
      enable = true;
    }

    var layerBtnClearFilter = this._layerComponents.buttons.clearFilter;
    layerBtnClearFilter.enable(enable);
  };

  // 필터 해제
  LayerFilter.prototype._clearFilter = function () {
    this._clearGridFilter();
    this._clearEtcFilter();
    this._clearNotFilter();
    this._clearEmptyFilter();
  };

  // 그리드 필터 체크 해제
  LayerFilter.prototype._clearGridFilter = function () {
    this._layerGridCheckAll(false);

    // '필터 해제' 버튼 enable 상태 변경
    this._setEnableClearFilterButton();
  };

  // 기타 필터 삭제
  LayerFilter.prototype._clearEtcFilter = function () {
    var $layerBtnEtcFilter = this._layerComponents.buttons.$etcFilter;

    // 기타 필터 버튼 셀렉트 클래스 삭제
    $layerBtnEtcFilter.removeClass("selected");

    // 기타 필터 데이터 삭제
    this._etcData = undefined;

    // '필터 해제' 버튼 enable 상태 변경
    this._setEnableClearFilterButton();
  };

  // Not 필터 삭제
  LayerFilter.prototype._clearNotFilter = function () {
    var $layerCheckNot = this._layerComponents.buttons.$notCheckBox;
    // 체크 해제
    $layerCheckNot.prop("checked", false);

    // '필터 해제' 버튼 enable 상태 변경
    this._setEnableClearFilterButton();
  };

  // 빈 값 제외 필터 삭제
  LayerFilter.prototype._clearEmptyFilter = function () {
    var $layerCheckEmptyPrice = this._layerComponents.buttons.$emptyCheckBox;
    // 체크 해제
    $layerCheckEmptyPrice.prop("checked", false);

    // '필터 해제' 버튼 enable 상태 변경
    this._setEnableClearFilterButton();
  };

  // 필터 그리드 전체 체크 설정
  LayerFilter.prototype._layerGridCheckAll = function (checked) {
    var layerGrid = this._layerComponents.grid;
    var layerRealGrid = layerGrid._grid;

    layerRealGrid.setAllCheck(checked);
    layerRealGrid.checkAll(checked, false, false, false);
  };

  // 필터 그리드 전체 체크 설정
  LayerFilter.prototype._layerGridCheckAllVerify = function () {
    var layerGrid = this._layerComponents.grid;
    var totalDataLength = layerGrid.dataItems().length;
    var totalCheckLength = layerGrid.getCheckedRows().length;

    if (totalCheckLength === 0) {
      this._layerGridCheckAll(false);
    } else if (totalDataLength === totalCheckLength) {
      this._layerGridCheckAll(true);
    }
  };

  // 필터 그리드 데이터를 가져옵니다.
  LayerFilter.prototype._getFilterGridData = function () {
    var self = this;
    var layerGrid = this._layerComponents.grid; // 필터 그리드
    var layerRealGrid = layerGrid._grid; // 필터 리얼그리드
    // 수정 중인 행 커밋
    layerGrid.commitCell();

    // 파라미터로 넘길 필터 데이터 생성
    var filterData = [];
    $.each(layerGrid.dataItems(), function (idx, data) {
      var dataIndex = layerGrid.getDataIndexFromItemIndex(idx);
      var isChecked = layerGrid.isCheckedRow(dataIndex);

      // 만약 예외처리로 인해 컨디션 값이 없으면 기본 값으로 처리함
      var condition = data["condition"];
      if (!condition) {
        condition = self._defaultCondition;
        layerRealGrid.setValue(idx, "condition", condition);
      }

      var filterName = data["filterName"];
      if (!filterName) {
        filterName = self._getFilterName();
        layerRealGrid.setValue(idx, "filterName", filterName);
      }

      // 사용자가 전체 데이터를 원하거나 | 체크된 데이터 = 둘 중 하나만 만족하면 푸시
      filterData.push({
        condition: condition,
        value1: data["value1"],
        value2: data["value2"],
        filterName: filterName,
        checked: isChecked
      });
    });

    return filterData;
  };

  // 레이어 창이 액티브 클래스를 가지고 있는지 여부
  LayerFilter.prototype._hasActivate = function () {
    // 레이어 셀렉터
    var $layer = this._layerComponents.$layer;
    return $layer.hasClass("activate");
  };

  // 레이어 창 액티브
  LayerFilter.prototype._activate = function () {
    if (this._hasActivate() === false) {
      // 레이어 셀렉터
      var $layer = this._layerComponents.$layer;

      // 윈도우 이벤트 추가 - 필터 레이어 외 영역 클릭시 -> 레이어 닫기
      $(window).on("mousedown", this._closeEventListener.bind(this));

      // 윈도우 이벤트 추가 - 브라우저 리사이즈 할 경우 -> 레이어 닫기
      $(window).on("resize", this._closeEventListener.bind(this));

      $layer.focus();
      $layer.addClass("activate");
    }
  };

  // 레이어 창 액티브 제거
  LayerFilter.prototype._deactivate = function () {
    if (this._hasActivate()) {
      // 레이어 셀렉터
      var $layer = this._layerComponents.$layer;

      // 윈도우 이벤트 제거
      $(window).off("mousedown");
      $(window).off("resize");

      $layer.removeClass("activate");
    }
  };

  // 랜덤 필터 이름 가져오기
  LayerFilter.prototype._getFilterName = function () {
    function NtoS(n) {
      return n.toString().padStart(2, "0");
    }

    function sleep(delay) {
      var start = new Date().getTime();
      while (new Date().getTime() < start + delay);
    }

    // 10ms 딜레이
    // 이유: 필터 이름은 다 달라야 한다.
    sleep(10);

    var now = new Date();
    var nowString =
    NtoS(now.getFullYear()) +
    NtoS(now.getMonth() + 1) +
    NtoS(now.getDate()) +
    NtoS(now.getHours()) +
    NtoS(now.getMinutes()) +
    NtoS(now.getSeconds()) +
    NtoS(now.getMilliseconds());

    return "filter_" + nowString;
  };

  // 필터 닫기 이벤트 리스너
  LayerFilter.prototype._closeEventListener = function (e) {
    if (this._hasActivate()) {
      if (e.type === "mousedown") {
        if (
        !$(e.target).hasClass("dews-grid-user-filter-layer") &&
        $(e.target).closest(".dews-grid-user-filter-layer").length === 0 &&
        $(e.target).closest("body").length > 0)
        {
          this.close();
        }
      } else if (e.type === "resize") {
        this.close();
      }
    }
  };

  // 이벤트 전파 - dataChanged
  LayerFilter.prototype._onEventDataChanged = function () {
    // 이벤트 생성
    var evt = new $.Event("dataChanged");
    // 공통 이벤트 파라미터 셋팅
    this._setEventCommonParameter(evt);
    // 이벤트 전파
    $(this).trigger(evt);

    // '필터 해제' 버튼 enable 상태 변경
    this._setEnableClearFilterButton();
  };

  // 이벤트 전파 - save
  LayerFilter.prototype._onEventSave = function () {
    // 이벤트 생성
    var evt = new $.Event("save");
    // 공통 이벤트 파라미터 셋팅
    this._setEventCommonParameter(evt);
    // 이벤트 전파
    $(this).trigger(evt);
  };

  // 이벤트 전파 - close
  LayerFilter.prototype._onEventClose = function () {
    // 이벤트 생성
    var evt = new $.Event("closed");
    // 이벤트 전파
    $(this).trigger(evt);
  };

  // 이벤트 전파에 필요한 공통 파라미터
  LayerFilter.prototype._setEventCommonParameter = function (evt) {
    var filterGridData = this._getFilterGridData();
    var $notCheckBox = this._layerComponents.buttons.$notCheckBox;
    var $notValue = this._layerComponents.buttons.$notValue;
    var $emptyCheckBox = this._layerComponents.buttons.$emptyCheckBox;

    // 레이어
    evt.layer = this;
    // 그리드 필터 데이터
    evt.filterData = filterGridData;
    // 기타 필터 데이터
    evt.filterEtcData = this._etcData;
    // not 제외 체크 여부
    evt.isCheckNot = $notCheckBox.is(":checked");
    // not 제외 데이터 (배열)
    {
      var notText = $notValue.val();
      var notArray = [];

      // 값이 있을 때만 파싱함
      if (notText !== undefined && notText !== null && notText !== "") {
        notArray = notText.split(",");
        // 양쪽 공백 제거
        $.each(notArray, function (idx, value) {
          notArray[idx] = value.trim();
        });
      }

      evt.notData = notArray;
    }
    // 빈 값 제외 체크 여부
    evt.isCheckEmpty = $emptyCheckBox.is(":checked");
  };

  // 필터 창 오픈시 기본 옵션
  LayerFilter.prototype._getOpenDefaultOption = function () {
    return {
      general: {
        // 컬럼 필드 이름
        field: undefined,
        // 컬럼 이름
        title: undefined
      },
      // 그리드 필터 옵션
      grid: {
        // 초기 데이터
        data: undefined,
        // 필터 에디터
        editor: undefined,
        // 필터 포맷
        formats: undefined,
        // 두 번째 필드가 보일지 여부
        isVisibleValue2: false,
        // 정렬
        align: "left"
      },
      // Not 제외
      not: {
        check: false,
        data: undefined
      },
      // 빈 값 제외
      empty: {
        check: false
      },
      // 기타 필터 옵션
      etc: {
        // 초기 데이터
        data: undefined,
        // 기타 필드 컴포넌트
        etcComponent: undefined,
        // 기타 필드 컴포넌트 포맷
        etcComponentFormat: undefined
      },
      // 저장 버튼 보일지 여부
      isVisibleSaveButton: false
    };
  };

  // 필터 레이어 css 창 오픈시 기본 옵션
  LayerFilter.prototype._initLayer = function () {
    var $layer = this._layerComponents.$layer;
    $layer.css("left", 0);
    $layer.css("top", 0);

    // 레이어 크기
    $layer.css("width", this._options.width);

    // 다이얼로그 페이지라면...
    if (dews.ui.dialogPage) {
      // zIndex 변경
      $layer.css("zIndex", parseInt(dews.ui.dialogPage._kendoWindow.wrapper.css("zIndex")) + 2);
    }

    // 레이어 숨김
    $layer.hide();
  };

  // 필터 레이어 css 창 오픈시 기본 옵션
  LayerFilter.prototype._setLayerPositionAndSize = function () {
    var $layer = this._layerComponents.$layer;

    // 필터 레이어창 우측 상단 포인트(1시 방향) 위치
    var layerPointTR = this._options.left + this._options.width;

    // 윈도우 가로 영역보다 크면
    if (layerPointTR > $(window).width()) {
      $layer.css("right", 0);
      $layer.css("left", "");
    } else {
      $layer.css("right", "");
      $layer.css("left", this._options.left);
    }

    // 필터 레이어창 좌측 하단 포인트(1시 방향) 위치
    var layerPointBL = this._options.top + $layer.height();

    // 윈도우 세로 영역보다 크면
    if (layerPointBL > $(window).height()) {
      $layer.css("bottom", 0);
      $layer.css("top", "");
    } else {
      $layer.css("bottom", "");
      $layer.css("top", this._options.top);
    }

    // 레이어 크기
    $layer.css("width", this._options.width);

    // 레이어 숨김 여부 옵션
    if (this._options.visible === false) {
      $layer.hide();
    } else {
      $layer.show();
    }
  };

  // 필터 레이어 열기
  LayerFilter.prototype.open = function (userOption) {
    var self = this;
    var defaultOption = this._getOpenDefaultOption(); // 기본 옵션 가져오기
    var option = $.extend(true, {}, defaultOption, userOption); // 옵션 병합

    // 저장 버튼 보일지 여부
    this._isVisibleSaveButton = option.isVisibleSaveButton;

    // 그리드 필터 유효성 검사
    if (option.grid.data) {
      $.each(option.grid.data, function (idx, data) {
        // 지원하지 않는 조건이 있으면 기본 값으로 변경
        if (self._supportCondition.indexOf(data.condition) !== -1 === false) {
          data.condition = self._defaultCondition;
        }
      });
    }

    // 필터 레이어 HTML 가져오기
    var layerHtml = this._getLayerHtml();
    // 바디에 추가
    $(document.body).append($(layerHtml));

    // 레이어 셀렉터
    var $layer = this._layerComponents.$layer = this.$_getLayer();
    this._initLayer();

    var dataType = this._target.dataType; // 데이터 타입

    dews.ready(function () {
      // 레이어 버튼들
      var $layerBtnEtcFilter = $(".dews-grid-filter-button");
      var $layerBtnClearFilter = $(".dews-filterClear-button");
      var $layerBtnSave = $(".dews-grid-filter-layer-save");
      var $layerBtnAddRow = $(".dews-grid-filter-layer-addRow");
      var layerBtnClearFilter = $layerBtnClearFilter.data("dewsControl");
      var $layerBtnUserTip = $(".dews-grid-filter-usertip > button");

      // 컴포넌트 전역 변수에 대입
      self._layerComponents.buttons.$etcFilter = $layerBtnEtcFilter;
      self._layerComponents.buttons.$clearFilter = $layerBtnClearFilter;
      self._layerComponents.buttons.$save = $layerBtnSave;
      self._layerComponents.buttons.$addRow = $layerBtnAddRow;
      self._layerComponents.buttons.$userTip = $layerBtnUserTip;
      self._layerComponents.buttons.clearFilter = layerBtnClearFilter;

      // dataSource 초기화
      var layerGridDatasource = dews.ui.dataSource("layerGridDatasource", {
        grid: true,
        data: option.grid.data ? option.grid.data : [],
        schema: {
          model: {
            id: "layerGridField",
            fields: [
            { field: "condition" },
            { field: "value1" },
            { field: "value2" },
            { field: "delete" },
            { field: "filterName" }]

          }
        }
      });

      // 조건 리스트 가져오기
      var conditionList = self._createConditionList(dataType);
      var ddlDataSource = dews.ui.dataSource("ddlDataSource", {
        data: conditionList
      });

      // 데이터 수정 조건 추가
      if (option.grid.editor) {
        option.grid.editor.editable = function (e) {
          if (e.cell.field === "value1") {
            return !(e.row.data.condition === "ev" || e.row.data.condition === "ebv");
          } else if (e.cell.field === "value2") {
            if (e.row.data.condition === "r") {
              return true;
            } else if (e.row.data.condition === "ev" || e.row.data.condition === "ebv") {
              return false;
            } else {
              return false;
            }
          }
        };
      }

      // 레이어 그리드 컬럼 정보
      var layerGridColumns = [
      {
        field: "condition",
        title: dews.localize.get("조건", "dews_조건"),
        width: 55, //90,
        align: "left",
        editor: {
          type: "dropdown",
          dataSource: ddlDataSource,
          dataValueField: "value",
          dataTextField: "text",
          editable: function editable() {
            if (self._isVisible === false) {
              return false;
            } else {
              return true;
            }
          }
        }
      },
      {
        field: "value1",
        title: dews.localize.get("값", "dews_값") + "1",
        width: 80, //110,
        align: option.grid.align,
        editor: option.grid.editor,
        formats: option.grid.formats,
        style: function style(e) {
          if (e.row.data.condition !== "r") {
            if (e.row.data.condition === "ev" || e.row.data.condition === "ebv") {
              return { background: "#f5f5f5" };
            }
          } else {
            return { background: "#ffffff" };
          }
        }
      },
      {
        field: "value2",
        title: dews.localize.get("값", "dews_값") + "2",
        width: 80, //110,
        align: option.grid.align,
        editor: option.grid.editor,
        formats: option.grid.formats,
        visible: option.grid.isVisibleValue2,
        style: function style(e) {
          if (e.row.data.condition !== "r") {
            return { background: "#f5f5f5" };
          } else {
            return { background: "#ffffff" };
          }
        }
      },
      {
        field: "delete",
        title: dews.localize.get("삭제", "dews_삭제"),
        width: 30, //40
        editable: false,
        editor: {
          type: "button",
          buttonWidth: 21,
          buttonHeight: 21,
          basicImg: dews._environments.scriptBase + "realgrid/assets/sbtn-del-normal.png", // 기본 상태일 경우 이미지
          hoverImg: dews._environments.scriptBase + "realgrid/assets/sbtn-del-over.png", // 마우스 hover 이미지
          clickImg: dews._environments.scriptBase + "realgrid/assets/sbtn-del-click.png", // 마우스로 클릭시 이미지
          click: function click(e) {
            var layerGrid = e.grid;
            layerGrid.removeRow(e.row.index);

            // 행 삭제한 후, 레이어 그리드 전체 체크 유효성 검사
            self._layerGridCheckAllVerify();

            // 데이터 변경 이벤트 전파
            self._onEventDataChanged();
          }
        }
      }];


      // 필터 그리드 초기화
      var $layerGrid = dews.ui.grid($("#__filter_layer_grid__"), {
        dataSource: layerGridDatasource,
        height: 133,
        filter: false,
        selectable: true,
        rowNo: false,
        editable: true,
        editSkip: true,
        context: {
          fixed: false,
          filter: false
        },
        columns: layerGridColumns,
        // 셀이 수정된 이후 발생하는 이벤트
        save: function save(e) {
          var layerGrid = e.grid; // 필터 그리드
          var layerRealGrid = layerGrid._grid; // 필터 리얼그리드 객체
          var cellFieldName = e.cell.field; // 변경된 셀 필드
          var condition = e.row.data.condition;

          // 필드 이름에 따른 수행
          if (cellFieldName === "condition") {
            // 수정된 필드가 조건인 경우
            // 조건에 따른 값 변경
            if (condition === "ev" || condition === "ebv") {
              layerRealGrid.setValue(e.row.index, "value1", null);
              layerRealGrid.setValue(e.row.index, "value2", null);
            } else if (condition !== "r") {
              layerRealGrid.setValue(e.row.index, "value2", null);
            }
          } else if (cellFieldName === "value2") {
            // 수정된 필드가 value2인 경우
            if (condition === "r") {
              // 1이 2보다 클 경우 툴팁 보여줌
              if (e.row.data.value1 > e.row.data.value2) {
                var tooltipText;
                var dataType = self._target.dataType;

                if (dataType === "number") {
                  tooltipText = dews.localize.get(
                  "값2에 설정한 값이 값1에 입력한 값 보다 작습니다.",
                  "dews_값2에 설정한 값이 값1에 입력한 값 보다 작습니다.");

                } else if (dataType === "date") {
                  tooltipText = dews.localize.get(
                  "값2에 설정한 값이 값1에 입력한 값 보다 이전 입니다..",
                  "dews_값2에 설정한 값이 값1에 입력한 값 보다 이전 입니다.");

                }

                // 값 변경
                layerRealGrid.setValue(e.row.index, "value2", null);

                // 툴탑 표시
                layerGrid.showTooltip(e.row.index, "value2", {
                  type: "normal",
                  text: tooltipText,
                  position: "top"
                });
              }
            }
          }

          var dataIndex = layerRealGrid.getDataRow(e.row.index); // dataIndex
          var isCheckedRow = layerRealGrid.isCheckedRow(dataIndex); // 체크 여부

          // 체크 상태에서 유효성검사
          if (isCheckedRow) {
            // 유효성검사에 걸리면 리턴
            if (self._layerGridRowDataValidate(e.row.index) === false) {
              return;
            }
          }

          // 유효성검사에 통과한 3개 필드에 대해서만 이벤트 전파
          if (cellFieldName === "condition" || cellFieldName === "value1" || cellFieldName === "value2") {
            // 데이터 변경 이벤트 전파
            self._onEventDataChanged();
          }
        },
        // 데이터를 붙여넣기한 후 발생하는 이벤트
        pasted: function pasted(e) {
          var layerGrid = e.grid; // 필터 그리드
          var layerRealGrid = layerGrid._grid; // 필터 리얼그리드 객체

          for (var i = 0; i < e.rows.length; i++) {
            var dataIndex = layerRealGrid.getDataRow(e.rows[i]);
            var itemIndex = layerRealGrid.getItemIndex(dataIndex);
            var rowData = layerGrid.dataItem(itemIndex);
            var condition = rowData["condition"];

            // 조건이 없다면 기본 값으로 대입
            if (!condition) {
              condition = self._defaultCondition;
              layerRealGrid.setValue(itemIndex, "condition", condition);
            }

            // 필터 이름이 없다면 생성
            var filterName = rowData["filterName"];
            if (!filterName) {
              filterName = self._getFilterName();
              layerRealGrid.setValue(itemIndex, "filterName", filterName);
            }

            // 복사 데이터를 루프 돌면서 특정 조건에 대해 값 변경
            for (var j = 0; j < e.columns.length; j++) {
              // 복사한 컬럼 필드명
              var pastedColumnFieldName = e.columns[j];

              // 컨디션이 아니라면
              if (pastedColumnFieldName !== "condition") {
                if (condition === "ev" || condition === "ebv") {
                  layerRealGrid.setValue(itemIndex, pastedColumnFieldName, null);
                } else if (condition !== "r") {
                  if (pastedColumnFieldName === "value2") {
                    layerRealGrid.setValue(itemIndex, pastedColumnFieldName, null);
                  }
                }
              } else {
                if (condition === "ev" || condition === "ebv") {
                  layerRealGrid.setValue(itemIndex, "value1", null);
                  layerRealGrid.setValue(itemIndex, "value2", null);
                } else if (condition !== "r") {
                  layerRealGrid.setValue(itemIndex, "value2", null);
                }
              }
            }
          }

          // 데이터 변경 이벤트 전파
          self._onEventDataChanged();
        },
        // 키 다운 이벤트
        keyDown: function keyDown(e) {
          var grid = $layerGrid;

          // 필터 레이어 그리드에서 에디터 상태가 아닐 경우 ESC 눌렀을 때 필터 레이어가 닫힘
          if (e.keyCode === 27 && $.type(grid.getEditCellValue()) === "undefined") {
            self.close();
            e.preventDefault();
            return;
          }

          // Ins Key - 라인 추가
          // Shift + Enter : 라인 추가
          if (e.keyCode == 45 || e.shift && e.keyCode == 13) {
            $layerBtnAddRow.trigger("click");
            e.preventDefault();
            return;
          }

          // Del Key - 라인 삭제
          if (e.keyCode == 46) {
            // Delete 키는 수정 중인 데이터가 있거나 그 데이터 값이 빈 값이라면 removeRow를 하지 않음
            if (grid.getEditCellValue() || grid.getEditCellValue() == "") {
              return;
            } else {
              // 삭제 이벤트
              grid.columns["delete"].editor.click(e);
              e.preventDefault();
              return;
            }
          }

          // F8 Key - 초기화
          if (e.keyCode == 119) {
            grid.dataSource.data([]);
            // 데이터 변경 이벤트 전파
            self._onEventDataChanged();
            e.preventDefault();
            return;
          }
        }
      });
      var layerRealGrid = $layerGrid._grid;

      // 컴포넌트 전역 변수에 대입
      self._layerComponents.grid = $layerGrid;

      // 필터 리얼그리드 API 추가 / 이벤트 등록
      // 붙여넣기 할 경우 생성되지 않은 행에는 자동으로 행을 생성 하지 못하게 설정 (체크 상태일 경우 값 영역에 복사를 할 때 없는 행에 대한 데이터를 추가 하는 시점을 찾기 힘듬, editable function 일 경우에 붙여넣기 가능 여부 판단 힘듬)
      // 각 행 마다 onEditRowPasted 발생하도록 설정
      layerRealGrid.setPasteOptions({ eventEachRow: true });

      // 필터 리얼그리드 체크
      layerRealGrid.onItemChecked = function (grid, itemIndex, isChecked) {
        if (isChecked) {
          // 체크 가능한지 유효성 검사
          if (!self._layerGridRowDataValidate(itemIndex)) {
            return false;
          }
          // 기타 필터가 설정 되어 잇을 경우 기타 필터 해제
          if (self._etcData) {
            // 기타 필터 제거
            self._clearEtcFilter();
          }
        }

        // 필터 그리드 전체 데이터 루프 돌아서 체크 상태인지 확인
        var layerGridDataCount = $layerGrid.dataItems().length;
        var checkCount = layerRealGrid.getCheckedItems().length;

        if (checkCount === layerGridDataCount) {
          // 체크 카운트가 데이터 전체 개수랑 같으면 그리드 헤더도 체크
          layerRealGrid.setAllCheck(true);
        } else if (checkCount < layerGridDataCount) {
          // 반대로, 체크 카운트가 데이터 전체 개수보다 작으면 그리드 헤더도 언체크
          layerRealGrid.setAllCheck(false);
        }

        // 데이터 변경 이벤트 전파
        self._onEventDataChanged();
      };

      // 필터 리얼그리드 전체 체크
      layerRealGrid.onItemAllChecked = function (grid, isAllChecked) {
        var layerGridDataItems = $layerGrid.dataItems();

        // All 체크한 경우
        if (isAllChecked) {
          // 기타 필터가 설정 되어 잇을 경우 기타 필터 해제
          if (self._etcData) {
            // 기타 필터 제거
            self._clearEtcFilter();
          }

          // 첫번째 검증에 걸린 인덱스
          var firstValidateFalseIndex = -1;

          // 값 입력 안했을 경우를 확인하기 위해 루프
          for (var i = 0; i < layerGridDataItems.length; i++) {
            var validate = self._layerGridRowDataValidate(i);

            // 검증에 실패했으면서, -1 일때만 대입함
            if (validate === false && firstValidateFalseIndex === -1) {
              firstValidateFalseIndex = i;
            }
          }

          // 검증에 걸린 인덱스가 있는 경우
          if (firstValidateFalseIndex > -1) {
            // 해당 Row로 이동
            $layerGrid.select(firstValidateFalseIndex);
          }
        }

        // 헤더에 있는 체크박스 체크 여부
        layerRealGrid.setAllCheck(isAllChecked);

        // 데이터 변경 이벤트 전파
        self._onEventDataChanged();
      };

      // 레이어 버튼 - 추가
      $layerBtnAddRow.on("click", function () {
        var itemIndex = $layerGrid.select();
        // 선택된 행이 없으면 포커스
        if (itemIndex < 0) {
          $layerGrid.setFocus();
        }

        // 행 추가
        $layerGrid.addRow({ editing: false });

        itemIndex = $layerGrid.select();
        var dataIndex = $layerGrid.getDataIndexFromItemIndex(itemIndex);

        if (dataIndex > -1) {
          var filterName = self._getFilterName();

          // 행 업데이트
          layerRealGrid.setValue(itemIndex, "condition", self._defaultCondition);
          layerRealGrid.setValue(itemIndex, "filterName", filterName);
        }

        // 데이터 변경 이벤트 전파
        self._onEventDataChanged();
      });

      // 레이어 버튼 - 기타 필터
      $layerBtnEtcFilter.on("click", function () {
        // 레이어 활성화
        self._deactivate();

        var etcFilter = new dews.fn.dialog.etcFilter(
        option.general.title,
        dataType,
        self._etcData,
        option.etc.etcComponent,
        option.etc.etcComponentFormat);

        var etcFilterDialog = etcFilter.open();

        // OK 버튼 눌렀을 때 이벤트
        $(etcFilter).on("ok", function (e) {
          // 그리드 필터 해제
          self._clearGridFilter();
          // Not 필터 해제
          self._clearNotFilter();
          // Empty 필터 해제
          self._clearEmptyFilter();

          // 기타 필터 값 셋팅
          self._etcData = e.etcData;

          // 데이터 변경 이벤트 전파
          self._onEventDataChanged();
        });

        // 기타 필터 레이어가 닫히고 필터 레이어로 포커스 이동
        etcFilterDialog.on("closed", function () {
          // 레이어 활성화
          self._activate();
        });
      });

      // 레이어 버튼 - 필터 해제
      $layerBtnClearFilter.on("click", function () {
        // 모든 필터 해제
        self._clearFilter();

        // 데이터 변경 이벤트 전파
        self._onEventDataChanged();
      });

      // 레이어 버튼 - 저장
      $layerBtnSave.on("click", function () {
        // save 이벤트 전파
        self._onEventSave();
      });

      // Not 체크박스 및 라벨 이벤트
      var $layerCheckNot = $("#chk-not");
      var $layerCheckNotLabel = $("#chk-not-label");
      var $layerNotValue = $("#not-value");

      self._layerComponents.buttons.$notCheckBox = $layerCheckNot;
      self._layerComponents.buttons.$notValue = $layerNotValue;

      // 'Not' 체크박스 이벤트
      $layerCheckNot.on("click", function () {
        // 기타 필터 제거
        self._clearEtcFilter();

        // 데이터 변경 이벤트 전파
        self._onEventDataChanged();
      });

      // 'Not' 라벨 이벤트
      $layerCheckNotLabel.on("click", function () {
        // 체크박스를 클릭한 것 처럼
        $layerCheckNot.click();
      });

      // 'Not' 라벨 값 이벤트
      $layerNotValue.on("keyup", function () {
        // 데이터 변경 이벤트 전파
        self._onEventDataChanged();
      });
      $layerNotValue.on("paste", function (e) {
        var content = "";

        try {
          var oriEvt = e.originalEvent;

          var oClipboardData = oriEvt.clipboardData;
          var eClipboardData = e.clipboardData;
          var wClipboardData = window.clipboardData;

          if (oClipboardData && oClipboardData.getData) {
            content = oClipboardData.getData("text");
          } else if (eClipboardData && eClipboardData.getData) {
            content = eClipboardData.getData("text/plain");
          } else if (wClipboardData && wClipboardData.getData) {
            content = wClipboardData.getData("Text");
          }

          // 구분자인 콤마로 변경
          content = content.replace(/\r\n/gi, ",");

          // 텍스트 적용
          // 오리지널 값
          var oriValue = $layerNotValue.val();
          // 커서 위치
          var cursorPos = $layerNotValue.prop("selectionStart");
          // 커서 위치 기준 앞 값
          var valueBefore = oriValue.substring(0, cursorPos);
          // 커서 위치 기준 뒤 값
          var valueAfter = oriValue.substring(cursorPos, oriValue.length);

          // 텍스트 병합
          var valueMerge = valueBefore + content + valueAfter;
          // 적용
          $layerNotValue.val(valueMerge);

          // 커서 위치 셋팅
          $layerNotValue.prop("selectionEnd", valueBefore.length + content.length);

          // 데이터 변경 이벤트 전파
          self._onEventDataChanged();

          // 복사 취소
          e.preventDefault();
        } catch (e) {

          // 캐치 떨어지면 아무것도 안함
        }});
      $layerNotValue.on("mousedown", function (e) {
        e.stopPropagation();
      });

      // 빈 값 제외 체크박스 및 라벨 이벤트
      var $layerCheckEmptyPrice = $("#chk-empty-price");
      var $layerCheckEmptyPriceLabel = $("#chk-empty-price-label");

      self._layerComponents.buttons.$emptyCheckBox = $layerCheckEmptyPrice;

      // '빈 값 제외' 체크박스 이벤트
      $layerCheckEmptyPrice.on("click", function () {
        // 기타 필터 제거
        self._clearEtcFilter();

        // 데이터 변경 이벤트 전파
        self._onEventDataChanged();
      });

      // '빈 값 제외' 라벨 이벤트 - Not
      $layerCheckEmptyPriceLabel.on("click", function () {
        // 체크박스를 클릭한 것 처럼
        $layerCheckEmptyPrice.click();
      });

      // 유저 팁 버튼 클릭 이벤트
      $layerBtnUserTip.on("click", function () {
        if ($layerBtnUserTip.hasClass("open")) {
          $layerBtnUserTip.removeClass("open");
        } else {
          $layerBtnUserTip.addClass("open");
        }

        // 레이어 위치 및 크기 적용
        self._setLayerPositionAndSize();
      });

      // 레이어 이벤트 - 키 버튼 누를 때
      $layer.on("keydown", function (e) {
        // ESC 버튼 눌렀을 때 창 닫음
        if (self._hasActivate() && e.keyCode === 27) {
          self.close();
        }
      });

      // 필터 레이어 드래그 이벤트
      var pos1 = 0,
        pos2 = 0,
        pos3 = 0,
        pos4 = 0;
      $layer.on("mousedown", function (e) {
        e = e || window.event;
        // e.preventDefault(); // [PD1C-3017] 필터 기능 제외조건 입력 불가 오류 수정
        // get the mouse cursor position at startup:
        pos3 = e.clientX;
        pos4 = e.clientY;

        // 드래그 이동 중
        $(window).on("mousemove", function (e) {
          e = e || window.event;
          e.preventDefault();
          // calculate the new cursor position:
          pos1 = pos3 - e.clientX;
          pos2 = pos4 - e.clientY;
          pos3 = e.clientX;
          pos4 = e.clientY;
          // set the element's new position:
          $layer.css({
            top: $layer.offset().top - pos2,
            left: $layer.offset().left - pos1
          });
        });

        // 드래그 종료
        $(window).on("mouseup", function () {
          $(window).off("mouseup");
          $(window).off("mousemove");
        });
      });

      // open시 받은 파라미터로 기본 값 셋팅
      // 기타 필터 기본 셋팅
      self._etcData = option.etc.data;

      // Not 제외 데이터 기본 셋팅
      $layerNotValue.val(option.not.data);

      // 기타 필터 여부에 따른 분기 기본 셋팅
      if (option.etc.data) {
        $layerBtnEtcFilter.addClass("selected");
      } else {
        // 그리드 필터 기본 셋팅 (그리드 데이터는 상위 코드에 dataSource 참조)
        if (option.grid.data) {
          $.each(option.grid.data, function (idx, data) {
            if (data.checked) {
              layerRealGrid.checkRow(idx, true, false, false);
            }
          });
        }

        // Not 제외 기본 셋팅
        if (option.not.check === true) {
          $layerCheckNot.prop("checked", true);
        }

        // 빈 값 제외 기본 셋팅
        if (option.empty.check === true) {
          $layerCheckEmptyPrice.prop("checked", true);
        }
      }

      // '필터 해제' 버튼 enable 상태 변경
      self._setEnableClearFilterButton();

      setTimeout(function () {
        // 레이어 위치 및 크기 적용
        self._setLayerPositionAndSize();
        // 레이어 활성화
        self._activate();
      });
    });

    // 트리거 (뭔지 모르겠다;)
    $(document).trigger("inituicontrols", [".dews-grid-user-filter-layer", undefined, false]);
  };

  // 필터 레이어를 닫는다.
  LayerFilter.prototype.close = function (closeForce) {
    /* autoClose가 false이면 레이어가 이벤트에 의해 자동으로 닫히지 않는다.
     * 사용자가 강제로 호출해서 닫아야 하는데, 이 때 closeForce 파라미터에 true 주면 된다.
     */
    if (_typeof(closeForce) === undefined && this._options.autoClose === false) return;

    // 비활성화
    this._deactivate();

    // 레이어 삭제
    this._layerComponents.$layer.remove();

    // 초기화
    this._init();

    this._onEventClose();
  };

  // 외부에서 접근할 수 있도록 추가
  $.extend(true, dews, {
    fn: {
      layer: {
        filter: LayerFilter
      }
    }
  });
})(window.dews || {});var


PivotStyleService = /*#__PURE__*/function () {"use strict";function PivotStyleService() {_classCallCheck(this, PivotStyleService);}_createClass(PivotStyleService, [{ key: "loadStyle", value:
    // 로그인한 사용자가 해당 피벗 그리드에 저장한 스타일을 조회
    function loadStyle(key, keyword, users) {
      var $dfd = $.Deferred();
      var data = {
        keyword: null, // 	스타일 아이디 혹은 스타일명 검색 (필수 값 X)
        users: users // 	검색 유저 ID 리스트 (필수 값 X)
      };

      if (_typeof(keyword) == "object" && keyword !== null) {
        keyword.forEach(function (k) {
          data.keyword = k;
          loadAPI(key, data);
        });
      } else if (typeof keyword === "string") {
        data.keyword = keyword;
        loadAPI(key, data);
      } else {
        loadAPI(key, data);
      }

      function loadAPI(key, data) {
        dews.api.
        get(
        dews.url.getApiUrl("CM", "PivotStyleService", "load/".concat(key.moduleCD, "/").concat(key.menuCD, "/").concat(key.gridID)),
        {
          async: false,
          data: data
        }).

        done(function (result) {
          $dfd.resolve(result);
        });
      }

      return $dfd;
    }

    // 로그인한 사용자가 현재 피벗 그리드 스타일을 저장
  }, { key: "saveStyle", value: function saveStyle(key, styleNm, styleState) {
      var $dfd = $.Deferred();

      dews.api.
      post(dews.url.getApiUrl("CM", "PivotStyleService", "save/".concat(key.moduleCD, "/").concat(key.menuCD, "/").concat(key.gridID)), {
        data: {
          styleNm: styleNm, // 스타일명 (필수 값)
          allf: styleState // 스타일 상태 (필수 값)    // TODO 파라미터명 변경 필요
        }
      }).
      done(function (result) {
        $dfd.resolve(result);
      });

      return $dfd;
    }

    // 로그인한 사용자가 선택한 피벗 그리드 스타일을 삭제
  }, { key: "delStyle", value: function delStyle(key, removeList) {
      var $dfd = $.Deferred();

      dews.api.
      post(dews.url.getApiUrl("CM", "PivotStyleService", "remove/".concat(key.moduleCD, "/").concat(key.menuCD, "/").concat(key.gridID)), {
        data: {
          removeIdList: removeList // 삭제할 스타일 ID 리스트
        }
      }).
      done(function (result) {
        $dfd.resolve(result);
      });

      return $dfd;
    }

    // 피벗 그리드 스타일 가져오기를 할 때, 사용되는 해당 메뉴를 사용할 수 있는 유저 정보 조회
  }, { key: "checkUser", value: function checkUser(menuCD) {
      var $dfd = $.Deferred();

      dews.api.
      get(dews.url.getApiUrl("CM", "PivotStyleService", "selectUserList/".concat(menuCD)), {
        data: {}
      }).
      done(function (result) {
        $dfd.resolve(result);
      });

      return $dfd;
    } }]);return PivotStyleService;}();



(function (dews) {
  function Util() {
    return this;
  }

  Util.newGuid = function () {
    function s4() {
      return Math.floor((1 + Math.random()) * 0x10000).
      toString(16).
      substring(1);
    }
    return s4() + s4() + "-" + s4() + "-" + s4() + "-" + s4() + "-" + s4() + s4() + s4();
  };

  Util.jti = function () {var _dews$ui$page13, _dews$ui$page13$user;
    return (_dews$ui$page13 = dews.ui.page) === null || _dews$ui$page13 === void 0 ? void 0 : (_dews$ui$page13$user = _dews$ui$page13.user) === null || _dews$ui$page13$user === void 0 ? void 0 : _dews$ui$page13$user.jti.replace(/-/gi, "");
  };
  Util.iv = function () {
    return "F12D0716502CB55BDD5653A58E240247";
  };

  Util.enCodeAES256 = function (str) {
    var cipher = CryptoJS.AES.encrypt(str, CryptoJS.enc.Utf8.parse(Util.jti()), {
      iv: CryptoJS.enc.Hex.parse(Util.iv()),
      padding: CryptoJS.pad.Pkcs7,
      mode: CryptoJS.mode.CBC
    });
    return cipher.toString();
  },
  // 외부에서 접근할 수 있도록 추가
  dews = $.extend(true, dews, {
    fn: {
      util: Util
    }
  });
})(window.dews || {});
//# sourceMappingURL=dews.ui.js.map
